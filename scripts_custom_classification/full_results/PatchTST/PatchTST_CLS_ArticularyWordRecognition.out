Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.33219575881958
Epoch: 1, Steps: 18 | Train Loss: 2.259 Vali Loss: 0.501 Vali Acc: 0.860 Test Loss: 0.501 Test Acc: 0.860
Validation loss decreased (inf --> -0.859995).  Saving model ...
Epoch: 2 cost time: 1.8241777420043945
Epoch: 2, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.273 Vali Acc: 0.917 Test Loss: 0.273 Test Acc: 0.917
Validation loss decreased (-0.859995 --> -0.916664).  Saving model ...
Epoch: 3 cost time: 2.105471134185791
Epoch: 3, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.282 Vali Acc: 0.920 Test Loss: 0.282 Test Acc: 0.920
Validation loss decreased (-0.916664 --> -0.919997).  Saving model ...
Epoch: 4 cost time: 2.288602352142334
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.278 Vali Acc: 0.940 Test Loss: 0.278 Test Acc: 0.940
Validation loss decreased (-0.919997 --> -0.939997).  Saving model ...
Epoch: 5 cost time: 2.2477104663848877
Epoch: 5, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.292 Vali Acc: 0.953 Test Loss: 0.292 Test Acc: 0.953
Validation loss decreased (-0.939997 --> -0.953330).  Saving model ...
Epoch: 6 cost time: 2.652639865875244
Epoch: 6, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.460 Vali Acc: 0.933 Test Loss: 0.460 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5266125202178955
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.353 Vali Acc: 0.937 Test Loss: 0.353 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4308409690856934
Epoch: 8, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.763 Vali Acc: 0.890 Test Loss: 0.763 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5313477516174316
Epoch: 9, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.853 Vali Acc: 0.887 Test Loss: 0.853 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.25453782081604
Epoch: 10, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.004 Vali Acc: 0.863 Test Loss: 1.004 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.085879325866699
Epoch: 11, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.458 Vali Acc: 0.827 Test Loss: 1.458 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1495068073272705
Epoch: 12, Steps: 18 | Train Loss: 0.291 Vali Loss: 0.500 Vali Acc: 0.927 Test Loss: 0.500 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.008711814880371
Epoch: 13, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.866 Vali Acc: 0.930 Test Loss: 0.866 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.120508909225464
Epoch: 14, Steps: 18 | Train Loss: 0.386 Vali Loss: 2.730 Vali Acc: 0.873 Test Loss: 2.730 Test Acc: 0.873
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.1891298294067383
Epoch: 15, Steps: 18 | Train Loss: 0.342 Vali Loss: 0.955 Vali Acc: 0.930 Test Loss: 0.955 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 2471833
model size : 11.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4818599224090576
Epoch: 1, Steps: 18 | Train Loss: 2.538 Vali Loss: 0.749 Vali Acc: 0.883 Test Loss: 0.749 Test Acc: 0.883
Validation loss decreased (inf --> -0.883326).  Saving model ...
Epoch: 2 cost time: 2.1274991035461426
Epoch: 2, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.218 Vali Acc: 0.920 Test Loss: 0.218 Test Acc: 0.920
Validation loss decreased (-0.883326 --> -0.919998).  Saving model ...
Epoch: 3 cost time: 2.3769538402557373
Epoch: 3, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.919998 --> -0.949998).  Saving model ...
Epoch: 4 cost time: 1.8584296703338623
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
Validation loss decreased (-0.949998 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.757723093032837
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3585894107818604
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.293731927871704
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.001096248626709
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9219520092010498
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 1.8099195957183838
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 1.5753843784332275
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 1.1979143619537354
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 2.1371848583221436
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 2.5927741527557373
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 2.6269102096557617
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 2.9276270866394043
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 2.597142457962036
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 2.985553026199341
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 2.6614842414855957
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.4888665676116943
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.841773509979248
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.2443218231201172
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 2.2469921112060547
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 2.208937883377075
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 1.230229139328003
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 1.280947208404541
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 1.4863009452819824
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.2646358013153076
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.4617421627044678
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.5904531478881836
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2851498126983643
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.4886984825134277
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.6318035125732422
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.7779412269592285
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.7753679752349854
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.799067735671997
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4058494567871094
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3484699726104736
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4082648754119873
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2928085327148438
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4638197422027588
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.689929723739624
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.3804147243499756
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.806947946548462
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.523984670639038
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.4048709869384766
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.06974196434021
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1754086017608643
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.0427439212799072
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.1570255756378174
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.6055288314819336
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.4965083599090576
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3755340576171875
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.7131552696228027
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.6510820388793945
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.4997947216033936
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.200662612915039
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.2708401679992676
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.3603851795196533
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.7944576740264893
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.412764310836792
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.288987159729004
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.382925271987915
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.3148033618927002
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.2333147525787354
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 1.398345947265625
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 1.3025872707366943
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.4633519649505615
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.363436222076416
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.4038136005401611
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.513209342956543
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 2.424867630004883
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 2.3150646686553955
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 2.596389055252075
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 2.6184606552124023
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 2.4443225860595703
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 2.5222220420837402
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1435545
model size : 7.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8621294498443604
Epoch: 1, Steps: 18 | Train Loss: 2.796 Vali Loss: 1.134 Vali Acc: 0.877 Test Loss: 1.134 Test Acc: 0.877
Validation loss decreased (inf --> -0.876655).  Saving model ...
Epoch: 2 cost time: 2.5261051654815674
Epoch: 2, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.226 Vali Acc: 0.927 Test Loss: 0.226 Test Acc: 0.927
Validation loss decreased (-0.876655 --> -0.926664).  Saving model ...
Epoch: 3 cost time: 2.5503547191619873
Epoch: 3, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
Validation loss decreased (-0.926664 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.9703257083892822
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.963 Test Loss: 0.106 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.9217147827148438
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.812474250793457
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.8068773746490479
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.209198236465454
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.101957082748413
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9369556903839111
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8791992664337158
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.086247682571411
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0759212970733643
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.333179473876953
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.4341654777526855
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.422908067703247
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.321423053741455
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1281678676605225
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1090329
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.471447229385376
Epoch: 1, Steps: 18 | Train Loss: 2.875 Vali Loss: 1.532 Vali Acc: 0.797 Test Loss: 1.532 Test Acc: 0.797
Validation loss decreased (inf --> -0.796651).  Saving model ...
Epoch: 2 cost time: 1.9899542331695557
Epoch: 2, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.249 Vali Acc: 0.940 Test Loss: 0.249 Test Acc: 0.940
Validation loss decreased (-0.796651 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 2.0095574855804443
Epoch: 3, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.939998 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.9902918338775635
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9912688732147217
Epoch: 5, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.064419746398926
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.9910850524902344
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.163783550262451
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.153139352798462
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.4163382053375244
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.2402689456939697
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.218338966369629
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.0690793991088867
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.313990831375122
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.551295518875122
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.527745246887207
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.562086820602417
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3615517616271973
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3279061317443848
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3625125885009766
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0867528915405273
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1586475372314453
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.0634591579437256
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.9080820083618164
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.4089913368225098
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 3.1245954036712646
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.967073917388916
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4620938301086426
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.957034111022949
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.915766716003418
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2377350330352783
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.477663040161133
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.690993547439575
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.5924265384674072
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.3442635536193848
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 918041
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6387557983398438
Epoch: 1, Steps: 18 | Train Loss: 3.028 Vali Loss: 1.841 Vali Acc: 0.717 Test Loss: 1.841 Test Acc: 0.717
Validation loss decreased (inf --> -0.716648).  Saving model ...
Epoch: 2 cost time: 2.6256237030029297
Epoch: 2, Steps: 18 | Train Loss: 0.996 Vali Loss: 0.361 Vali Acc: 0.930 Test Loss: 0.361 Test Acc: 0.930
Validation loss decreased (-0.716648 --> -0.929996).  Saving model ...
Epoch: 3 cost time: 2.564544677734375
Epoch: 3, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (-0.929996 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.9607210159301758
Epoch: 4, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.9675703048706055
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.7613966464996338
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.8826196193695068
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.9435503482818604
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3126561641693115
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2916982173919678
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3513102531433105
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 2.487253189086914
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 2.397400140762329
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 2.567251682281494
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2588682174682617
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 2.2533915042877197
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.945432424545288
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 2.280771255493164
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.964599609375
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0065627098083496
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9442498683929443
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 2.2360727787017822
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 2.3595311641693115
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 2.127171754837036
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.7507171630859375
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8187637329101562
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8766570091247559
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 2.468398332595825
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 3.169342279434204
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4085025787353516
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.2180850505828857
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.203604221343994
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 3.039869546890259
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 2.8165416717529297
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 3.030482053756714
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.2901480197906494
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.133523941040039
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 3.2341716289520264
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.153594970703125
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.444620132446289
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 3.2919321060180664
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.9252562522888184
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.9845387935638428
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.958163022994995
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.729408025741577
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.770209789276123
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.5913100242614746
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.798182487487793
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 3.500681161880493
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.5928585529327393
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.8534116744995117
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 3.8847525119781494
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 4.113595485687256
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 4.132659196853638
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 3.8661868572235107
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 3.3811793327331543
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 3.239133834838867
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 3.414573907852173
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.4660558700561523
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 3.6230249404907227
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 3.512383460998535
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 3.6900668144226074
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 3.6493265628814697
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 3.349825143814087
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 3.287071704864502
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 3.607532262802124
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 3.3769311904907227
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.368203639984131
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 3.276526689529419
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 3.2307281494140625
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 3.1851425170898438
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 3.3794469833374023
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.401442527770996
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 3.0542101860046387
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 2.8569283485412598
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 2.9790399074554443
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 3.2785096168518066
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 3.226581335067749
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 3.1537742614746094
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 3.307600259780884
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 3.2141802310943604
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 3.220266103744507
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 3.169027328491211
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 3.0628628730773926
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 3.216275930404663
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 3.1029794216156006
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 2.99833345413208
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 3.2227885723114014
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 3.194815158843994
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 2.979382276535034
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 3.5882608890533447
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 3.179725408554077
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 3.8426756858825684
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 3.822223663330078
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 3.5574893951416016
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 3.7978713512420654
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 3.4741413593292236
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 3.227023124694824
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 3.6151628494262695
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 3.2324862480163574
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 774937
model size : 5.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.119555950164795
Epoch: 1, Steps: 18 | Train Loss: 3.122 Vali Loss: 2.163 Vali Acc: 0.647 Test Loss: 2.163 Test Acc: 0.647
Validation loss decreased (inf --> -0.646645).  Saving model ...
Epoch: 2 cost time: 3.226069450378418
Epoch: 2, Steps: 18 | Train Loss: 1.363 Vali Loss: 0.565 Vali Acc: 0.947 Test Loss: 0.565 Test Acc: 0.947
Validation loss decreased (-0.646645 --> -0.946661).  Saving model ...
Epoch: 3 cost time: 3.554893970489502
Epoch: 3, Steps: 18 | Train Loss: 0.293 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.946661 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 3.2719058990478516
Epoch: 4, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 2.8604557514190674
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.440241575241089
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 2.9866654872894287
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.913794994354248
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 3.210907220840454
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.961592674255371
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 3.3075215816497803
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2511651515960693
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 3.1600558757781982
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 3.310248613357544
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 3.3574187755584717
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.632103204727173
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 3.536931037902832
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 3.453789472579956
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.294238328933716
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.964184045791626
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.0835092067718506
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.5364811420440674
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.0406112670898438
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9553449153900146
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 3.6631665229797363
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 3.7999894618988037
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.925844430923462
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.594942331314087
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.855415105819702
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 3.5893383026123047
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 3.6370108127593994
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 3.916832685470581
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.9829962253570557
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 3.63218355178833
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.746528148651123
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 3.6177287101745605
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 3.138932704925537
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 3.5952858924865723
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.6620805263519287
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.4178287982940674
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.022632837295532
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.820390224456787
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 3.1959052085876465
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 4.104792356491089
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 3.803115129470825
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.3662867546081543
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.96319317817688
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 4.04272985458374
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 3.850698947906494
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 3.0990445613861084
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 3.0405781269073486
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.1420421600341797
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 3.604403018951416
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 3.299675464630127
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.931011915206909
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 3.0793020725250244
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 3.5483174324035645
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 3.2251412868499756
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.245919704437256
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.2272825241088867
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.930741310119629
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 3.482814073562622
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 3.4919869899749756
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 3.5293591022491455
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 3.75549578666687
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.731614351272583
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 3.8047657012939453
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.6382551193237305
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 3.6684188842773438
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.134631872177124
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.693359375
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 2.830406427383423
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.8632466793060303
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.2661690711975098
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 3.7274820804595947
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 3.3897979259490967
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.5331270694732666
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 3.666063070297241
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 3.1213369369506836
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 2.7726545333862305
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 3.0395314693450928
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 3.6294052600860596
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 3.3514301776885986
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 3.25673508644104
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 3.4764816761016846
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 3.0085391998291016
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 3.044032573699951
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 3.3246443271636963
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 3.142772674560547
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 3.784498453140259
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 3.547729253768921
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 3.862946033477783
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 3.6445200443267822
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 3.496143102645874
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 3.712571859359741
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 3.5808019638061523
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 3.2883474826812744
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 3.833991289138794
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 660633
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.38828182220459
Epoch: 1, Steps: 18 | Train Loss: 3.101 Vali Loss: 2.193 Vali Acc: 0.627 Test Loss: 2.193 Test Acc: 0.627
Validation loss decreased (inf --> -0.626645).  Saving model ...
Epoch: 2 cost time: 3.1950888633728027
Epoch: 2, Steps: 18 | Train Loss: 1.402 Vali Loss: 0.617 Vali Acc: 0.927 Test Loss: 0.617 Test Acc: 0.927
Validation loss decreased (-0.626645 --> -0.926661).  Saving model ...
Epoch: 3 cost time: 2.7615973949432373
Epoch: 3, Steps: 18 | Train Loss: 0.337 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
Validation loss decreased (-0.926661 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 3.064223051071167
Epoch: 4, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4661004543304443
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 3.514538049697876
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 3.8327555656433105
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4471585750579834
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 3.3516297340393066
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 3.6512675285339355
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 3.9079840183258057
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 12 cost time: 4.067134141921997
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.819063663482666
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 4.077918529510498
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.845956325531006
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.335132122039795
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 3.5581648349761963
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 4.189565181732178
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.748861789703369
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.2828257083892822
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 2.670553684234619
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 2.863271951675415
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 2.6225509643554688
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0648066997528076
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 3.185875654220581
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 3.4372119903564453
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.6718995571136475
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.8138604164123535
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 3.969060182571411
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 3.8908755779266357
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 4.090874433517456
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 3.714862823486328
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 3.6224727630615234
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 3.8653311729431152
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 3.522484540939331
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 3.3853135108947754
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 2.60772967338562
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.7969970703125
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 2.8867855072021484
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.0625572204589844
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 3.3304948806762695
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.154116153717041
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.2223730087280273
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.5791006088256836
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.447129726409912
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 3.5500142574310303
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.390608549118042
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 3.2159948348999023
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 3.1777186393737793
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 2.918674945831299
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 2.6962485313415527
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 3.1639254093170166
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 53 cost time: 3.0972883701324463
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.9043967723846436
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 3.308558225631714
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 3.4290988445281982
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 3.6256487369537354
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 3.692687749862671
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 59 cost time: 3.7764570713043213
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.5147557258605957
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 61 cost time: 3.41911244392395
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 3.7862842082977295
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 3.50167179107666
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 64 cost time: 3.7470405101776123
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 65 cost time: 3.5237317085266113
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.3605902194976807
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.3158352375030518
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 68 cost time: 3.214607000350952
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 69 cost time: 3.292536497116089
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 70 cost time: 3.171166181564331
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 71 cost time: 3.207063674926758
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 72 cost time: 3.1894662380218506
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 73 cost time: 3.2352325916290283
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 74 cost time: 3.3519749641418457
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 75 cost time: 3.698047399520874
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 76 cost time: 3.501593828201294
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 3.6032726764678955
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.2646520137786865
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 3.537341594696045
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 80 cost time: 3.3087620735168457
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 3.380218029022217
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 3.3483076095581055
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 83 cost time: 3.418954610824585
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 3.4889323711395264
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 85 cost time: 3.2726495265960693
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 2.992245674133301
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 2.8671045303344727
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 3.0200154781341553
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 3.089829683303833
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 3.356947183609009
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 3.2777223587036133
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 3.2543656826019287
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 3.107612371444702
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 94 cost time: 3.262695789337158
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 3.1201205253601074
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 3.402068853378296
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 3.1679134368896484
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 98 cost time: 2.829233407974243
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 3.3338117599487305
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 3.325596809387207
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 632729
model size : 4.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.820196628570557
Epoch: 1, Steps: 18 | Train Loss: 2.208 Vali Loss: 0.495 Vali Acc: 0.847 Test Loss: 0.495 Test Acc: 0.847
Validation loss decreased (inf --> -0.846662).  Saving model ...
Epoch: 2 cost time: 4.524621486663818
Epoch: 2, Steps: 18 | Train Loss: 0.203 Vali Loss: 0.249 Vali Acc: 0.913 Test Loss: 0.249 Test Acc: 0.913
Validation loss decreased (-0.846662 --> -0.913331).  Saving model ...
Epoch: 3 cost time: 3.987572431564331
Epoch: 3, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.591 Vali Acc: 0.877 Test Loss: 0.591 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.269789218902588
Epoch: 4, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.856 Vali Acc: 0.863 Test Loss: 0.856 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9851369857788086
Epoch: 5, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.425 Vali Acc: 0.923 Test Loss: 0.425 Test Acc: 0.923
Validation loss decreased (-0.913331 --> -0.923329).  Saving model ...
Epoch: 6 cost time: 4.359386205673218
Epoch: 6, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.906 Vali Acc: 0.877 Test Loss: 0.906 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.421598196029663
Epoch: 7, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.638 Vali Acc: 0.927 Test Loss: 0.638 Test Acc: 0.927
Validation loss decreased (-0.923329 --> -0.926660).  Saving model ...
Epoch: 8 cost time: 4.6679041385650635
Epoch: 8, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.824 Vali Acc: 0.913 Test Loss: 0.824 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.588964939117432
Epoch: 9, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.708 Vali Acc: 0.893 Test Loss: 0.708 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.437245845794678
Epoch: 10, Steps: 18 | Train Loss: 0.029 Vali Loss: 1.060 Vali Acc: 0.873 Test Loss: 1.060 Test Acc: 0.873
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.556466102600098
Epoch: 11, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.803 Vali Acc: 0.910 Test Loss: 0.803 Test Acc: 0.910
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.322365999221802
Epoch: 12, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.277 Vali Acc: 0.953 Test Loss: 0.277 Test Acc: 0.953
Validation loss decreased (-0.926660 --> -0.953331).  Saving model ...
Epoch: 13 cost time: 5.373745918273926
Epoch: 13, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.400 Vali Acc: 0.937 Test Loss: 0.400 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.752357721328735
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.649 Vali Acc: 0.930 Test Loss: 0.649 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.520916938781738
Epoch: 15, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.495 Vali Acc: 0.943 Test Loss: 0.495 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.645431995391846
Epoch: 16, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.610171794891357
Epoch: 17, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.745019912719727
Epoch: 18, Steps: 18 | Train Loss: 0.013 Vali Loss: 3.083 Vali Acc: 0.760 Test Loss: 3.083 Test Acc: 0.760
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.071376323699951
Epoch: 19, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.826 Vali Acc: 0.873 Test Loss: 1.826 Test Acc: 0.873
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.152377605438232
Epoch: 20, Steps: 18 | Train Loss: 0.208 Vali Loss: 2.036 Vali Acc: 0.880 Test Loss: 2.036 Test Acc: 0.880
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.309994697570801
Epoch: 21, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.354 Vali Acc: 0.903 Test Loss: 1.354 Test Acc: 0.903
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.198964595794678
Epoch: 22, Steps: 18 | Train Loss: 0.229 Vali Loss: 1.448 Vali Acc: 0.890 Test Loss: 1.448 Test Acc: 0.890
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 2373145
model size : 11.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.523265361785889
Epoch: 1, Steps: 18 | Train Loss: 2.519 Vali Loss: 0.912 Vali Acc: 0.843 Test Loss: 0.912 Test Acc: 0.843
Validation loss decreased (inf --> -0.843324).  Saving model ...
Epoch: 2 cost time: 4.250508785247803
Epoch: 2, Steps: 18 | Train Loss: 0.340 Vali Loss: 0.263 Vali Acc: 0.920 Test Loss: 0.263 Test Acc: 0.920
Validation loss decreased (-0.843324 --> -0.919997).  Saving model ...
Epoch: 3 cost time: 4.709474563598633
Epoch: 3, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.919997 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 4.821709394454956
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.09977650642395
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.293990612030029
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.179975509643555
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.179027318954468
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.127763748168945
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.963 Test Loss: 0.125 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.421873569488525
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.960 Test Loss: 0.123 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.031266450881958
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.266201734542847
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.432457685470581
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.963 Test Loss: 0.120 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 1336857
model size : 7.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.297593355178833
Epoch: 1, Steps: 18 | Train Loss: 2.703 Vali Loss: 1.200 Vali Acc: 0.877 Test Loss: 1.200 Test Acc: 0.877
Validation loss decreased (inf --> -0.876655).  Saving model ...
Epoch: 2 cost time: 4.770648717880249
Epoch: 2, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
Validation loss decreased (-0.876655 --> -0.936664).  Saving model ...
Epoch: 3 cost time: 4.712276935577393
Epoch: 3, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
Validation loss decreased (-0.936664 --> -0.959999).  Saving model ...
Epoch: 4 cost time: 4.949813604354858
Epoch: 4, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.959999 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 4.886715412139893
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.963 Test Loss: 0.116 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.9162163734436035
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 4.867480516433716
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 5.014119625091553
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 4.946892499923706
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 4.885197401046753
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.590036392211914
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 4.8304808139801025
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 4.506187915802002
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 3.8699796199798584
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 3.6275758743286133
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 4.669392347335815
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 4.406130790710449
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 4.821958780288696
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.977602005004883
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 4.836376905441284
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 21 cost time: 4.943734645843506
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.743788003921509
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 23 cost time: 4.332550287246704
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 24 cost time: 4.446998357772827
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.44799542427063
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8621060848236084
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 27 cost time: 3.837669610977173
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 28 cost time: 3.5045177936553955
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.973333 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 3.479482412338257
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0886943340301514
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.264050245285034
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.436406373977661
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.214871644973755
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.4148268699646
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.507505416870117
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.45327091217041
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.358810186386108
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.226718187332153
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 991641
model size : 6.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.218789339065552
Epoch: 1, Steps: 18 | Train Loss: 2.935 Vali Loss: 1.546 Vali Acc: 0.837 Test Loss: 1.546 Test Acc: 0.837
Validation loss decreased (inf --> -0.836651).  Saving model ...
Epoch: 2 cost time: 3.4854862689971924
Epoch: 2, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.429 Vali Acc: 0.920 Test Loss: 0.429 Test Acc: 0.920
Validation loss decreased (-0.836651 --> -0.919996).  Saving model ...
Epoch: 3 cost time: 3.808534860610962
Epoch: 3, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.919996 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 3.9679784774780273
Epoch: 4, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 4.128392457962036
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 4.27604079246521
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.1591246128082275
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.972027540206909
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 3.9777376651763916
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.835097312927246
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.030540704727173
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9953601360321045
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.225079298019409
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.3740410804748535
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.449504613876343
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.663092374801636
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.485989809036255
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.536746501922607
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 819353
model size : 5.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.768422603607178
Epoch: 1, Steps: 18 | Train Loss: 2.949 Vali Loss: 1.803 Vali Acc: 0.767 Test Loss: 1.803 Test Acc: 0.767
Validation loss decreased (inf --> -0.766649).  Saving model ...
Epoch: 2 cost time: 4.4686949253082275
Epoch: 2, Steps: 18 | Train Loss: 0.940 Vali Loss: 0.331 Vali Acc: 0.957 Test Loss: 0.331 Test Acc: 0.957
Validation loss decreased (-0.766649 --> -0.956663).  Saving model ...
Epoch: 3 cost time: 4.22881293296814
Epoch: 3, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 4.269434452056885
Epoch: 4, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 3.958667516708374
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 4.506946325302124
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 4.412602424621582
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 4.159210681915283
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.50186824798584
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.193453788757324
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.211204767227173
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.302854776382446
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.634824275970459
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.701937437057495
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.239608287811279
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.005616664886475
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.056630611419678
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 676249
model size : 5.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 6.673445463180542
Epoch: 1, Steps: 18 | Train Loss: 3.252 Vali Loss: 2.216 Vali Acc: 0.617 Test Loss: 2.216 Test Acc: 0.617
Validation loss decreased (inf --> -0.616645).  Saving model ...
Epoch: 2 cost time: 5.040006399154663
Epoch: 2, Steps: 18 | Train Loss: 1.428 Vali Loss: 0.589 Vali Acc: 0.920 Test Loss: 0.589 Test Acc: 0.920
Validation loss decreased (-0.616645 --> -0.919994).  Saving model ...
Epoch: 3 cost time: 5.06328272819519
Epoch: 3, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
Validation loss decreased (-0.919994 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 4.362606763839722
Epoch: 4, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.953331 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 3.717355728149414
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 3.4701225757598877
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 3.3461546897888184
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 3.9308414459228516
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.35273551940918
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.209897041320801
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 4.347574949264526
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 4.287165641784668
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 4.130843877792358
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 3.9773051738739014
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 3.4444479942321777
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.197100639343262
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.021192312240601
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 4.056293964385986
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 4.108442544937134
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.4161641597747803
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.923990249633789
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.503253221511841
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 3.051631450653076
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 3.460002899169922
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6702253818511963
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 3.943711757659912
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 4.196721076965332
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 4.218166351318359
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.924417734146118
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.885930061340332
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 3.6095550060272217
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.456327438354492
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 3.7008204460144043
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.536902904510498
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 3.702704668045044
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 3.5227713584899902
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 3.1892778873443604
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 4.128414869308472
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.079418897628784
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 4.4313061237335205
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 4.108105421066284
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.7832589149475098
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.7346434593200684
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.6119015216827393
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 4.339892148971558
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 4.216284513473511
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.9182698726654053
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 3.758234739303589
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 3.557371139526367
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 3.174455165863037
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 2.3273205757141113
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.7700841426849365
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 3.5229647159576416
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 3.7683238983154297
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 3.779326915740967
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 4.20237135887146
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 4.14171028137207
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 4.109548091888428
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 4.031827211380005
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 3.910125255584717
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 3.6879942417144775
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 3.600219488143921
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 3.603166341781616
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 64 cost time: 3.740372896194458
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 65 cost time: 3.018251657485962
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 66 cost time: 3.1815476417541504
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 3.3606767654418945
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 3.638437271118164
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 3.822702646255493
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 3.9371914863586426
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 3.885923147201538
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 3.788464307785034
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 3.9665374755859375
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 4.113667249679565
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 75 cost time: 3.9971694946289062
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 76 cost time: 3.905665874481201
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 77 cost time: 3.847576141357422
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 3.7692458629608154
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 3.1887965202331543
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 3.1077327728271484
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 3.1938469409942627
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 3.421196222305298
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 83 cost time: 2.753634452819824
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.4784352779388428
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.843661069869995
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 86 cost time: 3.0432913303375244
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 3.1084985733032227
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 88 cost time: 3.5937366485595703
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 89 cost time: 3.4176394939422607
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 3.479827880859375
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 91 cost time: 3.1926116943359375
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 2.9821760654449463
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 3.4036455154418945
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 3.7345452308654785
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 3.5581295490264893
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 96 cost time: 3.0341405868530273
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 2.5698676109313965
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 2.805219888687134
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 3.1001429557800293
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 3.201937437057495
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 561945
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.966817855834961
Epoch: 1, Steps: 18 | Train Loss: 3.056 Vali Loss: 2.163 Vali Acc: 0.603 Test Loss: 2.163 Test Acc: 0.603
Validation loss decreased (inf --> -0.603312).  Saving model ...
Epoch: 2 cost time: 2.940718412399292
Epoch: 2, Steps: 18 | Train Loss: 1.388 Vali Loss: 0.618 Vali Acc: 0.937 Test Loss: 0.618 Test Acc: 0.937
Validation loss decreased (-0.603312 --> -0.936660).  Saving model ...
Epoch: 3 cost time: 3.071909189224243
Epoch: 3, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.936660 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 2.9258527755737305
Epoch: 4, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.9368479251861572
Epoch: 5, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.7943994998931885
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 2.3629510402679443
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9707114696502686
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2084507942199707
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.11503267288208
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 3.065890073776245
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 3.2779533863067627
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.3748269081115723
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.206743001937866
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 3.327131986618042
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.2320711612701416
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 3.004495143890381
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 3.2176337242126465
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.950530529022217
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.837665557861328
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 3.0936739444732666
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 3.285778045654297
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8949501514434814
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 3.1089255809783936
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9447195529937744
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 2.748488187789917
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 3.0085949897766113
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 2.962327241897583
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0421910285949707
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.0677874088287354
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.0671632289886475
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.8631398677825928
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 2.8245396614074707
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.8302650451660156
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 2.9468822479248047
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 3.3397433757781982
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 3.1306233406066895
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.207440137863159
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 3.1995527744293213
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.8829662799835205
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 3.360339403152466
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 2.5970664024353027
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.701950788497925
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.7728962898254395
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 3.211684226989746
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.1226401329040527
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.1959304809570312
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 3.4288175106048584
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 3.266382932662964
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 3.33797550201416
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 3.32853102684021
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 3.2725918292999268
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.2793166637420654
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 3.185699939727783
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 3.0835964679718018
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 3.008937120437622
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 3.092581272125244
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 3.3830199241638184
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.155724287033081
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.9918243885040283
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 3.04260516166687
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 3.424602746963501
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 3.246598243713379
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 3.3912787437438965
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 3.297342300415039
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 3.2973101139068604
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 3.12104868888855
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 3.0490405559539795
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 3.1038663387298584
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.027200222015381
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 2.8664844036102295
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.791555643081665
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 3.314516067504883
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 3.9249064922332764
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 3.888047218322754
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 3.7174010276794434
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 3.820197820663452
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 3.878960132598877
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 3.8832712173461914
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 3.5771090984344482
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 534041
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.926434755325317
Epoch: 1, Steps: 18 | Train Loss: 2.251 Vali Loss: 0.421 Vali Acc: 0.887 Test Loss: 0.421 Test Acc: 0.887
Validation loss decreased (inf --> -0.886662).  Saving model ...
Epoch: 2 cost time: 4.044689655303955
Epoch: 2, Steps: 18 | Train Loss: 0.211 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.886662 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 3.892326831817627
Epoch: 3, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.457 Vali Acc: 0.910 Test Loss: 0.457 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8930630683898926
Epoch: 4, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.387 Vali Acc: 0.917 Test Loss: 0.387 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.868603229522705
Epoch: 5, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.714 Vali Acc: 0.907 Test Loss: 0.714 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.052216529846191
Epoch: 6, Steps: 18 | Train Loss: 0.055 Vali Loss: 1.525 Vali Acc: 0.867 Test Loss: 1.525 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.071186780929565
Epoch: 7, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.669 Vali Acc: 0.903 Test Loss: 0.669 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6638946533203125
Epoch: 8, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.697 Vali Acc: 0.913 Test Loss: 0.697 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.5627503395080566
Epoch: 9, Steps: 18 | Train Loss: 0.051 Vali Loss: 1.021 Vali Acc: 0.897 Test Loss: 1.021 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.8380932807922363
Epoch: 10, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.838 Vali Acc: 0.903 Test Loss: 0.838 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.9009342193603516
Epoch: 11, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.621 Vali Acc: 0.920 Test Loss: 0.621 Test Acc: 0.920
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.077029228210449
Epoch: 12, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.582 Vali Acc: 0.907 Test Loss: 0.582 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9433333333333334
model parameter : 2323801
model size : 11.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.665992021560669
Epoch: 1, Steps: 18 | Train Loss: 2.531 Vali Loss: 0.757 Vali Acc: 0.893 Test Loss: 0.757 Test Acc: 0.893
Validation loss decreased (inf --> -0.893326).  Saving model ...
Epoch: 2 cost time: 3.7747318744659424
Epoch: 2, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
Validation loss decreased (-0.893326 --> -0.899997).  Saving model ...
Epoch: 3 cost time: 3.7530622482299805
Epoch: 3, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.899997 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 3.9166219234466553
Epoch: 4, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 3.5407304763793945
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.947 Test Loss: 0.217 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4589147567749023
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 3.7636401653289795
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.617100954055786
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.670590877532959
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7587409019470215
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.5973496437072754
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.653799057006836
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.9425549507141113
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.9181153774261475
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.821497917175293
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.882967710494995
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1287513
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.7655675411224365
Epoch: 1, Steps: 18 | Train Loss: 2.818 Vali Loss: 1.297 Vali Acc: 0.870 Test Loss: 1.297 Test Acc: 0.870
Validation loss decreased (inf --> -0.869987).  Saving model ...
Epoch: 2 cost time: 3.595745325088501
Epoch: 2, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.216 Vali Acc: 0.953 Test Loss: 0.216 Test Acc: 0.953
Validation loss decreased (-0.869987 --> -0.953331).  Saving model ...
Epoch: 3 cost time: 3.501657724380493
Epoch: 3, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 3.4553465843200684
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 3.180634021759033
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 3.202986001968384
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.226956844329834
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.529813289642334
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 3.623699903488159
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 3.5932416915893555
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 3.542869806289673
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 3.346306800842285
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 3.32019305229187
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 3.385446310043335
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 3.4126667976379395
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 3.3836114406585693
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.432818651199341
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.381251811981201
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.339228630065918
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.268876314163208
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.092639207839966
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.184380531311035
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.1250016689300537
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.707484006881714
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.8585541248321533
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 942297
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.536498785018921
Epoch: 1, Steps: 18 | Train Loss: 2.897 Vali Loss: 1.584 Vali Acc: 0.737 Test Loss: 1.584 Test Acc: 0.737
Validation loss decreased (inf --> -0.736651).  Saving model ...
Epoch: 2 cost time: 3.561940908432007
Epoch: 2, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.275 Vali Acc: 0.940 Test Loss: 0.275 Test Acc: 0.940
Validation loss decreased (-0.736651 --> -0.939997).  Saving model ...
Epoch: 3 cost time: 3.5529284477233887
Epoch: 3, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.186 Vali Acc: 0.940 Test Loss: 0.186 Test Acc: 0.940
Validation loss decreased (-0.939997 --> -0.939998).  Saving model ...
Epoch: 4 cost time: 3.3892762660980225
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
Validation loss decreased (-0.939998 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 3.446230411529541
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 3.4836466312408447
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2493155002593994
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2938601970672607
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 3.353410005569458
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 3.214212417602539
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8911476135253906
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.277449607849121
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.250817060470581
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 3.282238245010376
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.215790271759033
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.451953887939453
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.4595789909362793
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.376373529434204
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.3986027240753174
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 3.1326608657836914
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 3.115231513977051
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.858774423599243
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.307579755783081
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2200820446014404
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.4328248500823975
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 3.322375774383545
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 3.3641903400421143
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.276094436645508
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 3.4225094318389893
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3630807399749756
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 3.6495797634124756
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 3.1863200664520264
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.6970129013061523
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.525921106338501
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 3.7273921966552734
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.5486607551574707
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.634859561920166
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.680356502532959
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.388596773147583
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.317470073699951
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.1687967777252197
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.848754644393921
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.011815309524536
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.0020713806152344
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 770009
model size : 5.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.100927829742432
Epoch: 1, Steps: 18 | Train Loss: 2.921 Vali Loss: 1.790 Vali Acc: 0.767 Test Loss: 1.790 Test Acc: 0.767
Validation loss decreased (inf --> -0.766649).  Saving model ...
Epoch: 2 cost time: 3.3999271392822266
Epoch: 2, Steps: 18 | Train Loss: 0.964 Vali Loss: 0.347 Vali Acc: 0.963 Test Loss: 0.347 Test Acc: 0.963
Validation loss decreased (-0.766649 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 3.1640820503234863
Epoch: 3, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 3.1568684577941895
Epoch: 4, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 3.363065004348755
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 3.2343249320983887
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2869086265563965
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0667734146118164
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1378443241119385
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.233452796936035
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.809725284576416
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9184887409210205
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 3.113591432571411
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.9753544330596924
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.9494214057922363
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.7170169353485107
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.5903701782226562
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.81156325340271
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.0726325511932373
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.072176933288574
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.473886251449585
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5364038944244385
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.0318570137023926
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5863404273986816
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.642392873764038
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.7890868186950684
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.77131724357605
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 3.187352180480957
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1747283935546875
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2817165851593018
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5311777591705322
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.219451665878296
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.3121278285980225
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.3931260108947754
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 3.166295051574707
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 3.622957944869995
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 3.3026466369628906
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.84580135345459
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.2498421669006348
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 3.360604763031006
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 3.237290382385254
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.197413921356201
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.725269317626953
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.1674439907073975
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.0121004581451416
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.167356252670288
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.2174453735351562
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.3027732372283936
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.964434862136841
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.1119792461395264
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 626905
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.069910764694214
Epoch: 1, Steps: 18 | Train Loss: 2.971 Vali Loss: 2.042 Vali Acc: 0.657 Test Loss: 2.042 Test Acc: 0.657
Validation loss decreased (inf --> -0.656646).  Saving model ...
Epoch: 2 cost time: 2.9886724948883057
Epoch: 2, Steps: 18 | Train Loss: 1.272 Vali Loss: 0.542 Vali Acc: 0.953 Test Loss: 0.542 Test Acc: 0.953
Validation loss decreased (-0.656646 --> -0.953328).  Saving model ...
Epoch: 3 cost time: 2.9770359992980957
Epoch: 3, Steps: 18 | Train Loss: 0.285 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
Validation loss decreased (-0.953328 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 2.513667583465576
Epoch: 4, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.9963417053222656
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 3.019721746444702
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 2.7843809127807617
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 2.7535746097564697
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 3.4072630405426025
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 3.18636155128479
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 3.004800319671631
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.290285110473633
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.116133689880371
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 2.864567756652832
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 2.8282670974731445
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.215433359146118
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.230804920196533
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 2.482477903366089
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 2.610872268676758
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 3.0345630645751953
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.831944227218628
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.325883388519287
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 2.853285312652588
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 2.382375478744507
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 3.144212007522583
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9374804496765137
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 3.014700412750244
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 2.699105978012085
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 2.449197769165039
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 2.700679302215576
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 2.661700487136841
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 2.9895644187927246
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.0725932121276855
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 2.84643816947937
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 2.8432071208953857
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 2.810547113418579
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 2.920130729675293
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 2.9404122829437256
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.009955883026123
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.133553981781006
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 3.0537173748016357
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 3.239264965057373
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 3.3768458366394043
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.802950859069824
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 3.0074102878570557
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 2.875166893005371
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 2.6397881507873535
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 3.0422825813293457
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 3.037458658218384
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 2.5709118843078613
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 2.66101336479187
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 2.2879278659820557
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.087477684020996
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 2.9364681243896484
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 2.940387487411499
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.41147780418396
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 3.198878049850464
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 3.194201946258545
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 3.143146276473999
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.1200313568115234
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.875885486602783
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.514913558959961
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 2.1592845916748047
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 2.7492196559906006
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 2.799337863922119
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.9396426677703857
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 3.2885963916778564
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.978921413421631
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.9841578006744385
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 3.042771100997925
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.940086603164673
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 3.209624767303467
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.6650092601776123
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 3.2430737018585205
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 3.1570796966552734
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 3.482287645339966
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.8342742919921875
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 3.007434606552124
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 2.8208537101745605
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 3.088428020477295
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 3.3156895637512207
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 3.167048454284668
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 3.0380654335021973
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.863333225250244
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.912978172302246
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 3.0496816635131836
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 3.5835483074188232
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 3.3327972888946533
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 3.076561689376831
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 3.346576690673828
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 3.2289578914642334
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 3.3355441093444824
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 3.3808226585388184
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 3.094280481338501
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 3.3678174018859863
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 2.972411632537842
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 3.0764594078063965
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 3.063457727432251
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 3.074209213256836
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 3.070882558822632
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 512601
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.064050674438477
Epoch: 1, Steps: 18 | Train Loss: 3.087 Vali Loss: 2.132 Vali Acc: 0.640 Test Loss: 2.132 Test Acc: 0.640
Validation loss decreased (inf --> -0.639979).  Saving model ...
Epoch: 2 cost time: 3.0974793434143066
Epoch: 2, Steps: 18 | Train Loss: 1.397 Vali Loss: 0.592 Vali Acc: 0.950 Test Loss: 0.592 Test Acc: 0.950
Validation loss decreased (-0.639979 --> -0.949994).  Saving model ...
Epoch: 3 cost time: 3.2428884506225586
Epoch: 3, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.949994 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 3.03110671043396
Epoch: 4, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 3.281816005706787
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.097407341003418
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.6710386276245117
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 3.080278158187866
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.921478748321533
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 3.01920747756958
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.751131296157837
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.7487831115722656
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.987116813659668
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.731235980987549
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.898486852645874
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0533218383789062
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.866701126098633
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7326838970184326
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7944374084472656
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.844870090484619
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.7075295448303223
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm128_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 484697
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.040026664733887
Epoch: 1, Steps: 18 | Train Loss: 2.555 Vali Loss: 0.770 Vali Acc: 0.873 Test Loss: 0.770 Test Acc: 0.873
Validation loss decreased (inf --> -0.873326).  Saving model ...
Epoch: 2 cost time: 3.173917293548584
Epoch: 2, Steps: 18 | Train Loss: 0.315 Vali Loss: 0.248 Vali Acc: 0.927 Test Loss: 0.248 Test Acc: 0.927
Validation loss decreased (-0.873326 --> -0.926664).  Saving model ...
Epoch: 3 cost time: 3.1896212100982666
Epoch: 3, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.225 Vali Acc: 0.927 Test Loss: 0.225 Test Acc: 0.927
Validation loss decreased (-0.926664 --> -0.926664).  Saving model ...
Epoch: 4 cost time: 3.111098051071167
Epoch: 4, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
Validation loss decreased (-0.926664 --> -0.943331).  Saving model ...
Epoch: 5 cost time: 3.092430353164673
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0271239280700684
Epoch: 6, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
Validation loss decreased (-0.943331 --> -0.959998).  Saving model ...
Epoch: 7 cost time: 3.2170143127441406
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.265406370162964
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0673727989196777
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2178702354431152
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1401026248931885
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.960 Test Loss: 0.179 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0784313678741455
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.150345802307129
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.086191177368164
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 15 cost time: 3.2270302772521973
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 16 cost time: 3.2677721977233887
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 17 cost time: 3.2852516174316406
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 18 cost time: 3.404770612716675
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 19 cost time: 3.455536127090454
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 20 cost time: 3.432873249053955
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 21 cost time: 3.4747352600097656
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 22 cost time: 3.6931540966033936
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 23 cost time: 3.668306350708008
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 24 cost time: 3.324354887008667
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 25 cost time: 3.243185043334961
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 26 cost time: 3.508932590484619
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 27 cost time: 3.403679847717285
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 28 cost time: 3.3296806812286377
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.1712851524353027
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 30 cost time: 3.406906843185425
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 31 cost time: 3.3842029571533203
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 32 cost time: 3.335625410079956
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 33 cost time: 3.5074377059936523
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 34 cost time: 3.3239214420318604
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.1986265182495117
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 36 cost time: 3.3145406246185303
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 37 cost time: 3.267038583755493
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.2876391410827637
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 39 cost time: 3.423286199569702
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 40 cost time: 3.2929704189300537
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 41 cost time: 3.146371841430664
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 42 cost time: 3.137892723083496
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.2918403148651123
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 44 cost time: 3.0690176486968994
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.928978204727173
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 46 cost time: 3.1309382915496826
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 47 cost time: 3.4268128871917725
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 48 cost time: 3.5191164016723633
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 49 cost time: 3.3289096355438232
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 50 cost time: 3.33648419380188
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 51 cost time: 3.2230796813964844
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 52 cost time: 3.3691415786743164
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 53 cost time: 3.46618390083313
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 3.5093905925750732
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 55 cost time: 3.432478666305542
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 56 cost time: 3.3805298805236816
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 57 cost time: 3.4463753700256348
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 58 cost time: 3.4727704524993896
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 59 cost time: 3.4187493324279785
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 3.2397613525390625
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 61 cost time: 3.3789138793945312
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 62 cost time: 3.5490503311157227
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 63 cost time: 3.663907289505005
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 3.5356881618499756
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 3.459444522857666
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 66 cost time: 3.66915225982666
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 67 cost time: 3.1910359859466553
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 3.2562708854675293
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 69 cost time: 3.6196227073669434
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 3.2585439682006836
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 71 cost time: 3.505265474319458
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 72 cost time: 3.299858570098877
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 73 cost time: 3.4284791946411133
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 74 cost time: 3.596259117126465
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 75 cost time: 3.5493104457855225
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 3.335301160812378
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 77 cost time: 3.2930562496185303
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 78 cost time: 3.51841402053833
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 79 cost time: 3.5210816860198975
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 3.4602365493774414
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 3.6084694862365723
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 3.373030662536621
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 83 cost time: 3.4862492084503174
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 3.3616814613342285
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 3.374032974243164
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 86 cost time: 3.451237916946411
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 87 cost time: 3.4823098182678223
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 3.5731616020202637
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 89 cost time: 3.4791698455810547
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 90 cost time: 3.296755790710449
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 3.339184522628784
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 92 cost time: 3.4925129413604736
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 3.381953716278076
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 94 cost time: 3.4786744117736816
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 95 cost time: 3.5841829776763916
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 3.3735053539276123
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 97 cost time: 3.339777946472168
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 98 cost time: 3.116403579711914
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 3.4108734130859375
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 100 cost time: 3.2345924377441406
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 1187161
model size : 5.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.7649383544921875
Epoch: 1, Steps: 18 | Train Loss: 2.857 Vali Loss: 1.556 Vali Acc: 0.780 Test Loss: 1.556 Test Acc: 0.780
Validation loss decreased (inf --> -0.779984).  Saving model ...
Epoch: 2 cost time: 2.9737367630004883
Epoch: 2, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
Validation loss decreased (-0.779984 --> -0.933331).  Saving model ...
Epoch: 3 cost time: 3.1324877738952637
Epoch: 3, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.933331 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 3.2875399589538574
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.147897481918335
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.969999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 2.9522135257720947
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.918309211730957
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8995559215545654
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.386563539505005
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.074315071105957
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0166728496551514
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1068010330200195
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.1082663536071777
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9450395107269287
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9085090160369873
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 669017
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.546107053756714
Epoch: 1, Steps: 18 | Train Loss: 3.053 Vali Loss: 2.018 Vali Acc: 0.757 Test Loss: 2.018 Test Acc: 0.757
Validation loss decreased (inf --> -0.756646).  Saving model ...
Epoch: 2 cost time: 2.797646999359131
Epoch: 2, Steps: 18 | Train Loss: 1.243 Vali Loss: 0.480 Vali Acc: 0.917 Test Loss: 0.480 Test Acc: 0.917
Validation loss decreased (-0.756646 --> -0.916662).  Saving model ...
Epoch: 3 cost time: 1.9207985401153564
Epoch: 3, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.182 Vali Acc: 0.947 Test Loss: 0.182 Test Acc: 0.947
Validation loss decreased (-0.916662 --> -0.946665).  Saving model ...
Epoch: 4 cost time: 2.6650257110595703
Epoch: 4, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.946665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.883505344390869
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.718047857284546
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.758817434310913
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.9336471557617188
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.6273257732391357
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.416973114013672
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.4475414752960205
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.2964766025543213
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.6015400886535645
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.743319034576416
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.6300148963928223
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6348986625671387
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.8437883853912354
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8645212650299072
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.752687454223633
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9306092262268066
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.97574520111084
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.6259634494781494
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 2.509355068206787
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6222012042999268
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4488062858581543
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 2.5032098293304443
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.495198965072632
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8411877155303955
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.8249893188476562
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.7026689052581787
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 2.883796215057373
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 2.7255189418792725
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.288757085800171
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4554219245910645
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.936333656311035
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.9502978324890137
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.9694881439208984
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.9668591022491455
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.6056971549987793
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.8342065811157227
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.8943064212799072
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 496409
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.255068063735962
Epoch: 1, Steps: 18 | Train Loss: 3.137 Vali Loss: 2.353 Vali Acc: 0.600 Test Loss: 2.353 Test Acc: 0.600
Validation loss decreased (inf --> -0.599976).  Saving model ...
Epoch: 2 cost time: 2.3867878913879395
Epoch: 2, Steps: 18 | Train Loss: 1.629 Vali Loss: 0.774 Vali Acc: 0.947 Test Loss: 0.774 Test Acc: 0.947
Validation loss decreased (-0.599976 --> -0.946659).  Saving model ...
Epoch: 3 cost time: 2.45422101020813
Epoch: 3, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
Validation loss decreased (-0.946659 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 2.659444808959961
Epoch: 4, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.162 Vali Acc: 0.953 Test Loss: 0.162 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2614078521728516
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.956664 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 3.224027156829834
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.9126553535461426
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 3.232961893081665
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.471754550933838
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.708742380142212
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 3.3623409271240234
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.800227165222168
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9531445503234863
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.303771734237671
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.8081533908843994
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.5338544845581055
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.5841012001037598
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 2.607477903366089
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.524120330810547
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.193530559539795
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2025251388549805
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.330357313156128
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.790602445602417
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.0268590450286865
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.94343900680542
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8191347122192383
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7711501121520996
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.7101032733917236
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.905651092529297
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 3.4184951782226562
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 2.8571269512176514
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.689985990524292
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.6519124507904053
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.162224769592285
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.293781280517578
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 3.1262335777282715
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 3.397084951400757
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 2.96549916267395
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.0420327186584473
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.8394715785980225
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.911990165710449
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.2615416049957275
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.157634973526001
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.836934804916382
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.7837631702423096
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 3.0138158798217773
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 3.0113108158111572
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 3.028951406478882
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 3.0082216262817383
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.932750940322876
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.843534469604492
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.077970027923584
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 2.8613150119781494
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 3.087334394454956
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 3.25342059135437
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.39900541305542
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 3.1870880126953125
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 3.307516098022461
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 3.685082197189331
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 3.3494982719421387
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 2.9865036010742188
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 2.6582274436950684
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.565891742706299
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.665468454360962
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.844010829925537
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 3.1136183738708496
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.951146364212036
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 3.0004019737243652
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 2.999774932861328
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 3.0204601287841797
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 3.0287389755249023
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 410265
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3556768894195557
Epoch: 1, Steps: 18 | Train Loss: 3.164 Vali Loss: 2.468 Vali Acc: 0.473 Test Loss: 2.468 Test Acc: 0.473
Validation loss decreased (inf --> -0.473309).  Saving model ...
Epoch: 2 cost time: 1.6490514278411865
Epoch: 2, Steps: 18 | Train Loss: 1.875 Vali Loss: 1.009 Vali Acc: 0.903 Test Loss: 1.009 Test Acc: 0.903
Validation loss decreased (-0.473309 --> -0.903323).  Saving model ...
Epoch: 3 cost time: 1.6688013076782227
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.315 Vali Acc: 0.960 Test Loss: 0.315 Test Acc: 0.960
Validation loss decreased (-0.903323 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 1.7277109622955322
Epoch: 4, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.7343804836273193
Epoch: 5, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.5561699867248535
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6104660034179688
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.6118700504302979
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.570744514465332
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.5877363681793213
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.560347318649292
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.6245126724243164
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.569542407989502
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.6215989589691162
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.659757137298584
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.6304678916931152
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.5226414203643799
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.483003854751587
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.5665006637573242
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.6701397895812988
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.5187106132507324
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.622586727142334
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.6407461166381836
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.7588047981262207
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.5486652851104736
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.7121186256408691
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.7549004554748535
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.708418607711792
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.709813117980957
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8708295822143555
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6648013591766357
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8039851188659668
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.6673049926757812
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.7195911407470703
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.695847749710083
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 2.0564424991607666
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.9317710399627686
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.968080997467041
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.9669339656829834
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.7737696170806885
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9645578861236572
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.9834225177764893
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.9464619159698486
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.0116448402404785
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.7257838249206543
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.5921716690063477
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.582561731338501
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.5861003398895264
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.5596487522125244
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6702091693878174
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.8831946849822998
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.9346425533294678
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.7078382968902588
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.673945426940918
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.7064313888549805
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.7090702056884766
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.7199432849884033
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.6666302680969238
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.5748469829559326
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.6409482955932617
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.8124117851257324
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.7266037464141846
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.841203212738037
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.6811132431030273
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.6552374362945557
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.7230043411254883
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.8611443042755127
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.7022953033447266
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.5993165969848633
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.8021016120910645
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.988825798034668
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.7781481742858887
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.6972408294677734
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.586601972579956
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.6356143951416016
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.7151591777801514
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.6023430824279785
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.8558411598205566
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.7056660652160645
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.8388011455535889
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.5233871936798096
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.7083303928375244
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.7170326709747314
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.681276559829712
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.816985845565796
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.6458301544189453
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.7306833267211914
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.983475685119629
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.8148462772369385
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.8778536319732666
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.7432861328125
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.9295294284820557
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.870354175567627
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.9283254146575928
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.9889838695526123
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.662501573562622
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 2.0343713760375977
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.7656245231628418
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.768723726272583
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.63905668258667
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 338713
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.676633596420288
Epoch: 1, Steps: 18 | Train Loss: 3.147 Vali Loss: 2.662 Vali Acc: 0.337 Test Loss: 2.662 Test Acc: 0.337
Validation loss decreased (inf --> -0.336640).  Saving model ...
Epoch: 2 cost time: 1.5609357357025146
Epoch: 2, Steps: 18 | Train Loss: 2.185 Vali Loss: 1.445 Vali Acc: 0.860 Test Loss: 1.445 Test Acc: 0.860
Validation loss decreased (-0.336640 --> -0.859986).  Saving model ...
Epoch: 3 cost time: 1.4316978454589844
Epoch: 3, Steps: 18 | Train Loss: 1.028 Vali Loss: 0.537 Vali Acc: 0.947 Test Loss: 0.537 Test Acc: 0.947
Validation loss decreased (-0.859986 --> -0.946661).  Saving model ...
Epoch: 4 cost time: 1.5460641384124756
Epoch: 4, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.260 Vali Acc: 0.940 Test Loss: 0.260 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6139788627624512
Epoch: 5, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
Validation loss decreased (-0.946661 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 1.5004034042358398
Epoch: 6, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.3680078983306885
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.5944373607635498
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.523993968963623
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.5357975959777832
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.579965353012085
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.691103458404541
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6298563480377197
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.5850458145141602
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.5790009498596191
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.6063072681427002
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.6007678508758545
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.7114460468292236
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.6366095542907715
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.5684566497802734
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.8016493320465088
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.5973379611968994
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.5502281188964844
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.5181779861450195
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.4888153076171875
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.5549826622009277
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.472303867340088
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.5095465183258057
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.4565765857696533
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.408034086227417
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.5106563568115234
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6003828048706055
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6092207431793213
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.5929715633392334
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4013586044311523
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7268595695495605
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.4690923690795898
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.5630903244018555
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.5985064506530762
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4780285358428955
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4593510627746582
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.614990472793579
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.488962173461914
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5341236591339111
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4971404075622559
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.492734670639038
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.5758724212646484
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.7485072612762451
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 281561
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.3423759937286377
Epoch: 1, Steps: 18 | Train Loss: 3.326 Vali Loss: 2.831 Vali Acc: 0.227 Test Loss: 2.831 Test Acc: 0.227
Validation loss decreased (inf --> -0.226638).  Saving model ...
Epoch: 2 cost time: 1.5177719593048096
Epoch: 2, Steps: 18 | Train Loss: 2.326 Vali Loss: 1.591 Vali Acc: 0.843 Test Loss: 1.591 Test Acc: 0.843
Validation loss decreased (-0.226638 --> -0.843317).  Saving model ...
Epoch: 3 cost time: 1.579347848892212
Epoch: 3, Steps: 18 | Train Loss: 1.167 Vali Loss: 0.611 Vali Acc: 0.937 Test Loss: 0.611 Test Acc: 0.937
Validation loss decreased (-0.843317 --> -0.936661).  Saving model ...
Epoch: 4 cost time: 1.6215825080871582
Epoch: 4, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.256 Vali Acc: 0.960 Test Loss: 0.256 Test Acc: 0.960
Validation loss decreased (-0.936661 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 1.5209333896636963
Epoch: 5, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.407238483428955
Epoch: 6, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.5618705749511719
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.3732216358184814
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.4792027473449707
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.3956782817840576
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.481398105621338
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.4543590545654297
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.4228765964508057
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.4379780292510986
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.4147186279296875
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.329911470413208
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.4347996711730957
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.426037311553955
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.4366576671600342
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.4590973854064941
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.4117703437805176
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 1.4348170757293701
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.3624556064605713
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.5418622493743896
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.4113597869873047
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5103349685668945
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.52109956741333
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4268441200256348
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5430240631103516
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4088740348815918
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.504634141921997
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.6009552478790283
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.5556018352508545
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.5390548706054688
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5005829334259033
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.4791240692138672
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 37 cost time: 1.588336706161499
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 38 cost time: 1.5398907661437988
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5967938899993896
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 40 cost time: 1.3433573246002197
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4391064643859863
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 42 cost time: 1.4153685569763184
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 43 cost time: 1.5169708728790283
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3019351959228516
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3917624950408936
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 46 cost time: 1.4908554553985596
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 47 cost time: 1.562896490097046
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 48 cost time: 1.634723424911499
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.666675329208374
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 50 cost time: 1.4674320220947266
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 51 cost time: 1.5176072120666504
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.4323639869689941
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 53 cost time: 1.5745079517364502
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 54 cost time: 1.3539509773254395
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.3876643180847168
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.699512004852295
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 57 cost time: 1.535069227218628
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 58 cost time: 1.4395782947540283
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4593455791473389
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 60 cost time: 1.5346932411193848
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 61 cost time: 1.4567530155181885
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 62 cost time: 1.4035146236419678
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 63 cost time: 1.3450641632080078
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.5193471908569336
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 65 cost time: 1.4039812088012695
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 66 cost time: 1.6076271533966064
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.4772217273712158
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.4203944206237793
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.408782958984375
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.5717973709106445
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.4569196701049805
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 72 cost time: 1.3283851146697998
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 73 cost time: 1.4497253894805908
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 74 cost time: 1.4897615909576416
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 75 cost time: 1.4704172611236572
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 76 cost time: 1.436551570892334
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.6497836112976074
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.3293321132659912
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 79 cost time: 1.5366809368133545
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 80 cost time: 1.3817083835601807
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 81 cost time: 1.5232727527618408
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 82 cost time: 1.4879393577575684
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 83 cost time: 1.3864762783050537
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.4616155624389648
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.5425634384155273
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.6680374145507812
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 87 cost time: 1.5634055137634277
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.5490565299987793
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.799140214920044
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.6870462894439697
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 91 cost time: 1.7202441692352295
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 92 cost time: 1.7985858917236328
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 93 cost time: 1.8917920589447021
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 94 cost time: 1.7118325233459473
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.6450092792510986
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.6787645816802979
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 1.608478307723999
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 1.7964942455291748
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 1.6982710361480713
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 100 cost time: 1.9701638221740723
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 267609
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.870989561080933
Epoch: 1, Steps: 18 | Train Loss: 2.501 Vali Loss: 0.828 Vali Acc: 0.863 Test Loss: 0.828 Test Acc: 0.863
Validation loss decreased (inf --> -0.863325).  Saving model ...
Epoch: 2 cost time: 2.7130210399627686
Epoch: 2, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.217 Vali Acc: 0.947 Test Loss: 0.217 Test Acc: 0.947
Validation loss decreased (-0.863325 --> -0.946664).  Saving model ...
Epoch: 3 cost time: 2.441506862640381
Epoch: 3, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.946664 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 2.655127763748169
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6707286834716797
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.735790729522705
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.722977638244629
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8826444149017334
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7610697746276855
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.549175262451172
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8090782165527344
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.674118995666504
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.678194761276245
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1137625
model size : 5.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.683911323547363
Epoch: 1, Steps: 18 | Train Loss: 2.879 Vali Loss: 1.498 Vali Acc: 0.793 Test Loss: 1.498 Test Acc: 0.793
Validation loss decreased (inf --> -0.793318).  Saving model ...
Epoch: 2 cost time: 2.7227485179901123
Epoch: 2, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.245 Vali Acc: 0.960 Test Loss: 0.245 Test Acc: 0.960
Validation loss decreased (-0.793318 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 2.9309005737304688
Epoch: 3, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 2.758168935775757
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 2.765653133392334
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.600412130355835
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.549686908721924
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.723053216934204
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.5064644813537598
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.3518307209014893
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.308025598526001
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.497694969177246
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.784949541091919
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7443296909332275
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.244405746459961
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.07671856880188
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0688459873199463
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1285409927368164
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.003915786743164
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3323118686676025
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 619481
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.878524303436279
Epoch: 1, Steps: 18 | Train Loss: 3.073 Vali Loss: 2.034 Vali Acc: 0.720 Test Loss: 2.034 Test Acc: 0.720
Validation loss decreased (inf --> -0.719980).  Saving model ...
Epoch: 2 cost time: 3.241567611694336
Epoch: 2, Steps: 18 | Train Loss: 1.205 Vali Loss: 0.463 Vali Acc: 0.927 Test Loss: 0.463 Test Acc: 0.927
Validation loss decreased (-0.719980 --> -0.926662).  Saving model ...
Epoch: 3 cost time: 3.271566867828369
Epoch: 3, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.926662 --> -0.933331).  Saving model ...
Epoch: 4 cost time: 3.3724231719970703
Epoch: 4, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.933331 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 3.2417774200439453
Epoch: 5, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 3.1525793075561523
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2738845348358154
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.426018476486206
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 2.428169012069702
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 2.393342971801758
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 2.5664212703704834
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 2.9413375854492188
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 3.4535138607025146
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 3.621140480041504
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 3.181455135345459
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.1991052627563477
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 3.135301113128662
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 3.1428754329681396
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.613252639770508
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7604942321777344
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.986041307449341
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3321542739868164
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6228549480438232
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3070297241210938
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.986649990081787
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.92901611328125
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.147571325302124
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.067840814590454
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 446873
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.764626502990723
Epoch: 1, Steps: 18 | Train Loss: 3.061 Vali Loss: 2.237 Vali Acc: 0.573 Test Loss: 2.237 Test Acc: 0.573
Validation loss decreased (inf --> -0.573311).  Saving model ...
Epoch: 2 cost time: 2.3886330127716064
Epoch: 2, Steps: 18 | Train Loss: 1.519 Vali Loss: 0.707 Vali Acc: 0.917 Test Loss: 0.707 Test Acc: 0.917
Validation loss decreased (-0.573311 --> -0.916660).  Saving model ...
Epoch: 3 cost time: 2.8305861949920654
Epoch: 3, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.212 Vali Acc: 0.960 Test Loss: 0.212 Test Acc: 0.960
Validation loss decreased (-0.916660 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 2.476944923400879
Epoch: 4, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 2.783334970474243
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 2.7781145572662354
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.4445104598999023
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.72760272026062
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.420513153076172
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.6058590412139893
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.7755210399627686
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.691324472427368
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.0168888568878174
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6682491302490234
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.7959868907928467
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.937288999557495
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.7932181358337402
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 2.705982208251953
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.771160364151001
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.677402973175049
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.566828489303589
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.629054307937622
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3344881534576416
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.329716682434082
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4330146312713623
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 2.7376315593719482
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 2.575063467025757
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 2.8147783279418945
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.650758981704712
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 2.7605996131896973
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.7474935054779053
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4872500896453857
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.640658140182495
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 2.39823055267334
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.437969923019409
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.621802806854248
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.5081443786621094
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.484107494354248
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 2.4609551429748535
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 2.5004565715789795
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.525799036026001
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.538801908493042
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 2.6200573444366455
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 2.4920783042907715
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.5421411991119385
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.999204158782959
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.729898691177368
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 2.4506001472473145
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.548271417617798
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6583328247070312
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.3238887786865234
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.7222352027893066
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.0882649421691895
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.9396188259124756
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.407533645629883
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.134341239929199
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.5279786586761475
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 2.4923129081726074
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 2.1902434825897217
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.482670545578003
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.374901294708252
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.7320923805236816
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.8101625442504883
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.9564003944396973
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 2.1096410751342773
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.177300214767456
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.9837708473205566
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 2.179471969604492
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.1311910152435303
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 2.066981077194214
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 2.8202176094055176
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 2.8812389373779297
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 2.7889959812164307
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 2.905212163925171
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 2.9864392280578613
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 3.4220144748687744
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 3.434390068054199
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 3.2931814193725586
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 3.2905964851379395
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 3.1383938789367676
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 2.9446160793304443
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 360729
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.288102626800537
Epoch: 1, Steps: 18 | Train Loss: 3.144 Vali Loss: 2.411 Vali Acc: 0.500 Test Loss: 2.411 Test Acc: 0.500
Validation loss decreased (inf --> -0.499976).  Saving model ...
Epoch: 2 cost time: 1.446640968322754
Epoch: 2, Steps: 18 | Train Loss: 1.804 Vali Loss: 0.981 Vali Acc: 0.917 Test Loss: 0.981 Test Acc: 0.917
Validation loss decreased (-0.499976 --> -0.916657).  Saving model ...
Epoch: 3 cost time: 1.3652503490447998
Epoch: 3, Steps: 18 | Train Loss: 0.610 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
Validation loss decreased (-0.916657 --> -0.929997).  Saving model ...
Epoch: 4 cost time: 1.4243576526641846
Epoch: 4, Steps: 18 | Train Loss: 0.156 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.929997 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.3839259147644043
Epoch: 5, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.616600513458252
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.5539023876190186
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5244526863098145
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3355717658996582
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.592231035232544
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.5015652179718018
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6385927200317383
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.4886503219604492
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3596208095550537
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.4300904273986816
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4609599113464355
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.4614872932434082
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.572737455368042
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.6441731452941895
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.7182974815368652
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.5371737480163574
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.263681173324585
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.2210874557495117
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.3740386962890625
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.644662618637085
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.710489273071289
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4439456462860107
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.3773884773254395
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.289513111114502
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3164618015289307
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3372435569763184
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3903987407684326
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.431776762008667
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.4735760688781738
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.3139357566833496
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.5808465480804443
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.445171594619751
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.685420036315918
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.9496371746063232
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.8695368766784668
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8546431064605713
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.7629773616790771
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.919508457183838
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6371572017669678
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.8789703845977783
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.8865127563476562
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.5764451026916504
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.670450210571289
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.6583154201507568
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7484102249145508
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.722320795059204
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.799339771270752
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.7959353923797607
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.8066463470458984
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.8340325355529785
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.6725506782531738
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.6744558811187744
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.6526331901550293
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4989514350891113
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.5707056522369385
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2528157234191895
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.237043857574463
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.3609042167663574
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.5045721530914307
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.3967788219451904
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.3334577083587646
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.5165948867797852
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.3840844631195068
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.2841904163360596
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.2771368026733398
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.3788442611694336
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.469820499420166
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.434903621673584
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.4450736045837402
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.433779001235962
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.3327696323394775
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.511641025543213
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.4553897380828857
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.5302534103393555
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.32374906539917
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.3774604797363281
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.436671495437622
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.6235895156860352
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.3688340187072754
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.3716273307800293
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.3148448467254639
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.0913565158843994
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.3648655414581299
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.7240619659423828
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.6535074710845947
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.8132219314575195
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.730179786682129
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.789280652999878
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.800227165222168
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.6103613376617432
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.6644062995910645
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.8269951343536377
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.649278163909912
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 1.77559232711792
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.6105973720550537
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 289177
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6091504096984863
Epoch: 1, Steps: 18 | Train Loss: 3.224 Vali Loss: 2.709 Vali Acc: 0.317 Test Loss: 2.709 Test Acc: 0.317
Validation loss decreased (inf --> -0.316640).  Saving model ...
Epoch: 2 cost time: 1.672607421875
Epoch: 2, Steps: 18 | Train Loss: 2.199 Vali Loss: 1.478 Vali Acc: 0.860 Test Loss: 1.478 Test Acc: 0.860
Validation loss decreased (-0.316640 --> -0.859985).  Saving model ...
Epoch: 3 cost time: 1.9085147380828857
Epoch: 3, Steps: 18 | Train Loss: 1.057 Vali Loss: 0.575 Vali Acc: 0.937 Test Loss: 0.575 Test Acc: 0.937
Validation loss decreased (-0.859985 --> -0.936661).  Saving model ...
Epoch: 4 cost time: 1.7860352993011475
Epoch: 4, Steps: 18 | Train Loss: 0.357 Vali Loss: 0.251 Vali Acc: 0.953 Test Loss: 0.251 Test Acc: 0.953
Validation loss decreased (-0.936661 --> -0.953331).  Saving model ...
Epoch: 5 cost time: 1.6989469528198242
Epoch: 5, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.6906116008758545
Epoch: 6, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.7408010959625244
Epoch: 7, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.6684634685516357
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.567826509475708
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.7837367057800293
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.8160948753356934
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.7937982082366943
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.5144431591033936
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.8094637393951416
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.599278211593628
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.59187650680542
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7018108367919922
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.7134759426116943
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8366398811340332
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.7529494762420654
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.668325662612915
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6721138954162598
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.7508258819580078
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.738111972808838
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.6127855777740479
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.779320478439331
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.7851104736328125
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.9693219661712646
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.7708351612091064
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.9175610542297363
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.6900300979614258
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.663292407989502
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9106440544128418
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.616161823272705
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.748262643814087
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.6306779384613037
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.8219468593597412
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.916177749633789
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.7790992259979248
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.8532166481018066
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.7058067321777344
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.8338394165039062
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 1.805229902267456
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.7616491317749023
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7126944065093994
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6322786808013916
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6531732082366943
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.6003894805908203
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.5157053470611572
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7907524108886719
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.859647512435913
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.849778413772583
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.8139846324920654
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.8000447750091553
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.7998764514923096
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.7322123050689697
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.8256287574768066
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.7840015888214111
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.6704206466674805
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.6891605854034424
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.615243673324585
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.5838587284088135
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.4960482120513916
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.432149887084961
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.650784969329834
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.7458505630493164
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.9227938652038574
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.918071985244751
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.7836472988128662
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.7051124572753906
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.775498390197754
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.7242627143859863
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.7528905868530273
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.8784856796264648
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.6993160247802734
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 1.6878728866577148
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.687026023864746
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 1.7244067192077637
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.6218230724334717
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.7312967777252197
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.6961448192596436
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.678161859512329
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.6004972457885742
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.632035255432129
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.6317942142486572
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.5263621807098389
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.5332086086273193
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 1.9128215312957764
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.6133215427398682
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.7879366874694824
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.925865650177002
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.8615984916687012
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 93 cost time: 1.8041355609893799
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.9905920028686523
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.922102451324463
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.7431118488311768
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 1.848724603652954
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.932194709777832
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.8295888900756836
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.8291950225830078
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 232025
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.659359931945801
Epoch: 1, Steps: 18 | Train Loss: 3.191 Vali Loss: 2.677 Vali Acc: 0.327 Test Loss: 2.677 Test Acc: 0.327
Validation loss decreased (inf --> -0.326640).  Saving model ...
Epoch: 2 cost time: 1.7088215351104736
Epoch: 2, Steps: 18 | Train Loss: 2.177 Vali Loss: 1.486 Vali Acc: 0.850 Test Loss: 1.486 Test Acc: 0.850
Validation loss decreased (-0.326640 --> -0.849985).  Saving model ...
Epoch: 3 cost time: 1.7681071758270264
Epoch: 3, Steps: 18 | Train Loss: 1.063 Vali Loss: 0.565 Vali Acc: 0.953 Test Loss: 0.565 Test Acc: 0.953
Validation loss decreased (-0.849985 --> -0.953328).  Saving model ...
Epoch: 4 cost time: 1.8773589134216309
Epoch: 4, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.241 Vali Acc: 0.967 Test Loss: 0.241 Test Acc: 0.967
Validation loss decreased (-0.953328 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 1.521916389465332
Epoch: 5, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.9066805839538574
Epoch: 6, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.7953855991363525
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6860547065734863
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.4604339599609375
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.4471070766448975
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.428175449371338
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.8128409385681152
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.107365131378174
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.045478105545044
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.010897397994995
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.9201130867004395
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.9401285648345947
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 2.211090087890625
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9645922183990479
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.0381760597229004
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.044788360595703
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.8024497032165527
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.770416021347046
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.7307486534118652
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.7112104892730713
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6854581832885742
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8107490539550781
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.771317720413208
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.7657883167266846
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8206183910369873
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.7856783866882324
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.9320645332336426
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.9428374767303467
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.9673218727111816
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.855546474456787
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.8893649578094482
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.881639003753662
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.8102052211761475
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.8004906177520752
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8389778137207031
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.5784144401550293
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.846531867980957
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.7941718101501465
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.814704179763794
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.7677452564239502
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.80816650390625
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.7907671928405762
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.7835397720336914
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.878803014755249
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.797609567642212
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.9184741973876953
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.824753999710083
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.6698973178863525
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.9309029579162598
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.7918250560760498
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.6414756774902344
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.8044242858886719
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.8824050426483154
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.8290398120880127
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.7605533599853516
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.9344801902770996
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.9850420951843262
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.9886345863342285
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.1080708503723145
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.9440762996673584
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.9886267185211182
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.8154616355895996
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.7448861598968506
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.5884816646575928
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.7341971397399902
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.7387208938598633
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.9761581420898438
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.8403851985931396
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.8210783004760742
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.9871745109558105
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.913741111755371
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.8953850269317627
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.7984209060668945
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.774399995803833
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.7643606662750244
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.541011095046997
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.886627197265625
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.968947410583496
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.863377332687378
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.9922358989715576
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.9191763401031494
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.9964489936828613
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.890141487121582
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.8505690097808838
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.8615200519561768
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 1.8921394348144531
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 2.0313174724578857
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 1.9442501068115234
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 1.8340551853179932
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 218073
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.5463738441467285
Epoch: 1, Steps: 18 | Train Loss: 2.591 Vali Loss: 0.826 Vali Acc: 0.883 Test Loss: 0.826 Test Acc: 0.883
Validation loss decreased (inf --> -0.883325).  Saving model ...
Epoch: 2 cost time: 2.827613353729248
Epoch: 2, Steps: 18 | Train Loss: 0.284 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.883325 --> -0.929997).  Saving model ...
Epoch: 3 cost time: 2.742032289505005
Epoch: 3, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
Validation loss decreased (-0.929997 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 2.5248069763183594
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.012802839279175
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4556257724761963
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.262 Vali Acc: 0.947 Test Loss: 0.262 Test Acc: 0.947
Validation loss decreased (-0.943331 --> -0.946664).  Saving model ...
Epoch: 7 cost time: 3.16453218460083
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.960 Test Loss: 0.233 Test Acc: 0.960
Validation loss decreased (-0.946664 --> -0.959998).  Saving model ...
Epoch: 8 cost time: 3.3909523487091064
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.299 Vali Acc: 0.953 Test Loss: 0.299 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.083118200302124
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9910433292388916
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2656126022338867
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 12 cost time: 2.763352394104004
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.963 Test Loss: 0.206 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 13 cost time: 3.6157336235046387
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 14 cost time: 3.852238893508911
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 4.018049478530884
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 3.3206405639648438
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 17 cost time: 3.194812059402466
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.784320116043091
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.1157448291778564
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8323023319244385
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.347062587738037
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.8845221996307373
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.5766711235046387
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.712674140930176
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.6381897926330566
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.038648843765259
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 1112857
model size : 5.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.72351336479187
Epoch: 1, Steps: 18 | Train Loss: 2.946 Vali Loss: 1.545 Vali Acc: 0.847 Test Loss: 1.545 Test Acc: 0.847
Validation loss decreased (inf --> -0.846651).  Saving model ...
Epoch: 2 cost time: 2.962390422821045
Epoch: 2, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
Validation loss decreased (-0.846651 --> -0.936664).  Saving model ...
Epoch: 3 cost time: 2.945665121078491
Epoch: 3, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.936664 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 2.983349561691284
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.953 Test Loss: 0.146 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6703782081604004
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 2.5615785121917725
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 3.0545175075531006
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.294602870941162
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.301974058151245
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.4595487117767334
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.483494281768799
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7565252780914307
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.456603765487671
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9364094734191895
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.927057981491089
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.7034084796905518
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8013741970062256
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.042222261428833
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.9026696681976318
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.265495538711548
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.9053852558135986
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2108044624328613
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.68925404548645
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4816837310791016
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.2564029693603516
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4746880531311035
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4217042922973633
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.157965660095215
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.3418631553649902
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.845247745513916
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.2246086597442627
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.6198666095733643
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.7487306594848633
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.1501824855804443
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 594713
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7831501960754395
Epoch: 1, Steps: 18 | Train Loss: 2.925 Vali Loss: 1.955 Vali Acc: 0.737 Test Loss: 1.955 Test Acc: 0.737
Validation loss decreased (inf --> -0.736647).  Saving model ...
Epoch: 2 cost time: 1.8577382564544678
Epoch: 2, Steps: 18 | Train Loss: 1.175 Vali Loss: 0.486 Vali Acc: 0.953 Test Loss: 0.486 Test Acc: 0.953
Validation loss decreased (-0.736647 --> -0.953328).  Saving model ...
Epoch: 3 cost time: 2.3791351318359375
Epoch: 3, Steps: 18 | Train Loss: 0.243 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.046881914138794
Epoch: 4, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.953328 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 2.117800712585449
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 2.6824254989624023
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.1413068771362305
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.362335681915283
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 3.561727523803711
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 3.554978132247925
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5669548511505127
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.305565118789673
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.5353622436523438
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.105354070663452
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2646944522857666
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9808759689331055
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.4267160892486572
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.903844118118286
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.6692333221435547
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.804804801940918
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 3.789332866668701
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.666844129562378
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.936840295791626
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 3.5978341102600098
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.873551607131958
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.5525383949279785
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.9806430339813232
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.557551383972168
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0189499855041504
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.998314619064331
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.342114210128784
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 3.2190632820129395
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.4113645553588867
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.2027859687805176
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 3.4883058071136475
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 3.6417300701141357
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.609370231628418
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4237592220306396
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 3.275385856628418
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 3.0909061431884766
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 3.3168132305145264
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 3.205695867538452
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.0034430027008057
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.3328442573547363
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.3223867416381836
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.492751359939575
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.590620756149292
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.54533314704895
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 3.4718387126922607
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 3.198240041732788
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 3.0371553897857666
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 2.860654354095459
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 3.443674087524414
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.176593780517578
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 3.140922784805298
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 3.576115131378174
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 3.377436637878418
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 3.4318156242370605
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 3.6794044971466064
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 3.4615159034729004
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 3.33083438873291
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 422105
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.875788688659668
Epoch: 1, Steps: 18 | Train Loss: 3.046 Vali Loss: 2.336 Vali Acc: 0.623 Test Loss: 2.336 Test Acc: 0.623
Validation loss decreased (inf --> -0.623310).  Saving model ...
Epoch: 2 cost time: 2.8399605751037598
Epoch: 2, Steps: 18 | Train Loss: 1.613 Vali Loss: 0.810 Vali Acc: 0.930 Test Loss: 0.810 Test Acc: 0.930
Validation loss decreased (-0.623310 --> -0.929992).  Saving model ...
Epoch: 3 cost time: 4.2688517570495605
Epoch: 3, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.236 Vali Acc: 0.967 Test Loss: 0.236 Test Acc: 0.967
Validation loss decreased (-0.929992 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 3.915347099304199
Epoch: 4, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 3.6158294677734375
Epoch: 5, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 3.588850498199463
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 3.6278767585754395
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 3.896501302719116
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 3.6151716709136963
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 3.942004680633545
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.75374174118042
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.541550874710083
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6913721561431885
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.752110004425049
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.076461315155029
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.331430435180664
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.230527400970459
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.223025798797607
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.018353462219238
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 3.943474531173706
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 4.333126783370972
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 4.248637437820435
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.059502124786377
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 3.6445205211639404
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1335291862487793
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 3.440398693084717
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.080676794052124
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.54716420173645
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.380756139755249
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.856879472732544
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.6769323348999023
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.8726305961608887
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.882446050643921
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.3749074935913086
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.6866419315338135
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 335961
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.622065782546997
Epoch: 1, Steps: 18 | Train Loss: 3.088 Vali Loss: 2.434 Vali Acc: 0.503 Test Loss: 2.434 Test Acc: 0.503
Validation loss decreased (inf --> -0.503309).  Saving model ...
Epoch: 2 cost time: 1.8507542610168457
Epoch: 2, Steps: 18 | Train Loss: 1.850 Vali Loss: 1.042 Vali Acc: 0.903 Test Loss: 1.042 Test Acc: 0.903
Validation loss decreased (-0.503309 --> -0.903323).  Saving model ...
Epoch: 3 cost time: 1.8370563983917236
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.340 Vali Acc: 0.960 Test Loss: 0.340 Test Acc: 0.960
Validation loss decreased (-0.903323 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 1.7822232246398926
Epoch: 4, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.9106457233428955
Epoch: 5, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.025156259536743
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.005643606185913
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.0036120414733887
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9660048484802246
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9090776443481445
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.8467729091644287
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.712411642074585
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.8885798454284668
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.901252031326294
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.8704094886779785
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.9087409973144531
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.844191551208496
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8052008152008057
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.849297046661377
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.8431525230407715
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.887174367904663
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 1.8092052936553955
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.8265385627746582
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.8893558979034424
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9860188961029053
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.8730461597442627
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.914137363433838
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.9562814235687256
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.8765480518341064
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.7541553974151611
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.4317235946655273
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.8689360618591309
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 33 cost time: 1.722233533859253
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.67561674118042
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 35 cost time: 1.6911513805389404
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8875746726989746
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 37 cost time: 1.8605637550354004
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 38 cost time: 1.8499267101287842
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 39 cost time: 1.8110411167144775
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9193894863128662
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.968338966369629
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.017765760421753
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.9569623470306396
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 44 cost time: 1.8852596282958984
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 45 cost time: 1.8701221942901611
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 46 cost time: 1.7433433532714844
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 47 cost time: 1.906707525253296
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.8751049041748047
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.8908298015594482
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.7229413986206055
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 51 cost time: 1.890557050704956
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.7253499031066895
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.8658227920532227
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 54 cost time: 1.7522268295288086
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 55 cost time: 1.6627967357635498
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 56 cost time: 1.5730562210083008
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 57 cost time: 1.855595350265503
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.888585090637207
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 59 cost time: 1.9757153987884521
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 60 cost time: 1.9830000400543213
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.8110344409942627
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 62 cost time: 1.8721332550048828
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.797140121459961
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 64 cost time: 1.7081382274627686
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 65 cost time: 1.7768750190734863
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 66 cost time: 1.804309368133545
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 67 cost time: 1.8845210075378418
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 68 cost time: 1.6308848857879639
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 69 cost time: 1.833617925643921
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.733827829360962
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.8893742561340332
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 72 cost time: 1.7929410934448242
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.7617416381835938
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 74 cost time: 1.7153308391571045
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.690373420715332
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.8625972270965576
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 77 cost time: 1.7024435997009277
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.8201277256011963
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 79 cost time: 1.8881855010986328
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 80 cost time: 1.7761483192443848
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.7456490993499756
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 82 cost time: 1.8325421810150146
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.7906568050384521
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.7376794815063477
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.850597620010376
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.9187045097351074
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.8164310455322266
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.8094048500061035
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.7771234512329102
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 90 cost time: 1.8716349601745605
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 91 cost time: 1.9466521739959717
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.8564624786376953
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 93 cost time: 1.7235729694366455
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 94 cost time: 1.800976037979126
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 95 cost time: 1.7523455619812012
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.7323830127716064
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 97 cost time: 1.6407864093780518
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 98 cost time: 1.761131763458252
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.9124362468719482
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.8590950965881348
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 264409
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.775764226913452
Epoch: 1, Steps: 18 | Train Loss: 3.276 Vali Loss: 2.732 Vali Acc: 0.250 Test Loss: 2.732 Test Acc: 0.250
Validation loss decreased (inf --> -0.249973).  Saving model ...
Epoch: 2 cost time: 2.0369043350219727
Epoch: 2, Steps: 18 | Train Loss: 2.294 Vali Loss: 1.511 Vali Acc: 0.853 Test Loss: 1.511 Test Acc: 0.853
Validation loss decreased (-0.249973 --> -0.853318).  Saving model ...
Epoch: 3 cost time: 2.0101699829101562
Epoch: 3, Steps: 18 | Train Loss: 1.124 Vali Loss: 0.597 Vali Acc: 0.947 Test Loss: 0.597 Test Acc: 0.947
Validation loss decreased (-0.853318 --> -0.946661).  Saving model ...
Epoch: 4 cost time: 1.9311392307281494
Epoch: 4, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.251 Vali Acc: 0.967 Test Loss: 0.251 Test Acc: 0.967
Validation loss decreased (-0.946661 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 1.9114794731140137
Epoch: 5, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.8217151165008545
Epoch: 6, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.8287699222564697
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.7898547649383545
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9042901992797852
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4681577682495117
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.6494882106781006
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.755281686782837
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.7517263889312744
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.7435595989227295
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.870744228363037
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.9572796821594238
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9149515628814697
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.8976495265960693
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.6473007202148438
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6986346244812012
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.7935960292816162
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.7872917652130127
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.6917495727539062
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.5410544872283936
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.83866286277771
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.8051536083221436
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.533982753753662
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.641922950744629
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.8134503364562988
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.7800836563110352
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.9343461990356445
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 2.0824999809265137
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8906641006469727
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.8349673748016357
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.7880566120147705
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.8783793449401855
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.8872482776641846
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 2.035999298095703
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.789034128189087
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.6180534362792969
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.6187398433685303
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5057222843170166
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.7929210662841797
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.9018335342407227
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.916438102722168
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.9471714496612549
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.9182348251342773
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.9268457889556885
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8462562561035156
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.8979005813598633
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9060888290405273
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.8687458038330078
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.9440374374389648
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 2.002453565597534
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.880441665649414
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 2.057682991027832
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.7361469268798828
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.8896896839141846
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.841360330581665
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.8336360454559326
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.9464857578277588
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.9751112461090088
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.9470467567443848
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.8898258209228516
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 2.0464351177215576
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 2.0848588943481445
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.0171923637390137
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.8535044193267822
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 2.090463399887085
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.8132987022399902
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.6892671585083008
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.0055689811706543
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 2.050079345703125
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 2.002974033355713
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.8618109226226807
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 2.0407159328460693
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.860321283340454
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.925128698348999
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 2.00655460357666
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.904284954071045
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 2.044393301010132
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 2.0848159790039062
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 2.0726497173309326
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.7524421215057373
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.9246935844421387
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.907022476196289
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 2.0109541416168213
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.9321346282958984
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.8628363609313965
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.7694063186645508
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.7292914390563965
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.7498407363891602
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 1.8197200298309326
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.9555673599243164
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 2.021735668182373
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.957047939300537
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 2.0420515537261963
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.786602258682251
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.5621342658996582
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.9546349048614502
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 207257
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1966681480407715
Epoch: 1, Steps: 18 | Train Loss: 3.150 Vali Loss: 2.683 Vali Acc: 0.327 Test Loss: 2.683 Test Acc: 0.327
Validation loss decreased (inf --> -0.326640).  Saving model ...
Epoch: 2 cost time: 1.500401496887207
Epoch: 2, Steps: 18 | Train Loss: 2.164 Vali Loss: 1.478 Vali Acc: 0.847 Test Loss: 1.478 Test Acc: 0.847
Validation loss decreased (-0.326640 --> -0.846652).  Saving model ...
Epoch: 3 cost time: 1.7700228691101074
Epoch: 3, Steps: 18 | Train Loss: 1.114 Vali Loss: 0.637 Vali Acc: 0.933 Test Loss: 0.637 Test Acc: 0.933
Validation loss decreased (-0.846652 --> -0.933327).  Saving model ...
Epoch: 4 cost time: 1.654308795928955
Epoch: 4, Steps: 18 | Train Loss: 0.414 Vali Loss: 0.272 Vali Acc: 0.967 Test Loss: 0.272 Test Acc: 0.967
Validation loss decreased (-0.933327 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 1.7329156398773193
Epoch: 5, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7624115943908691
Epoch: 6, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.7769384384155273
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.6964013576507568
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.7666029930114746
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.596428632736206
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.7052478790283203
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7673377990722656
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.528259038925171
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.525315523147583
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8533296585083008
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.735889196395874
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.5790109634399414
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.8204128742218018
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.7250781059265137
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.671351671218872
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.6195719242095947
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.700967788696289
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5231924057006836
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6967923641204834
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.611342191696167
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5825490951538086
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.5513243675231934
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.5295956134796143
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6388614177703857
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.545241117477417
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.5901715755462646
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.5281968116760254
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.7431421279907227
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6983814239501953
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.7736146450042725
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7406067848205566
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.6219606399536133
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.6943635940551758
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.7661821842193604
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.7993290424346924
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.4210739135742188
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.482060194015503
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.5514416694641113
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6279444694519043
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.4465620517730713
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.6334006786346436
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.5271060466766357
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4719502925872803
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.8205199241638184
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.6433210372924805
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.6876130104064941
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.7148516178131104
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.7144341468811035
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.6482653617858887
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.8918864727020264
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.4364585876464844
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.6833112239837646
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.598449468612671
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.7167859077453613
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.6036674976348877
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.734222173690796
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.5809199810028076
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.7518844604492188
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.7719364166259766
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.787323236465454
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.8707456588745117
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 1.6591076850891113
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.53709077835083
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.7504470348358154
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.806945562362671
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.8543875217437744
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.8087306022644043
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.6611323356628418
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.6581213474273682
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.7183001041412354
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 1.64896559715271
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 1.7303571701049805
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 78 cost time: 1.7325682640075684
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.750619649887085
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.6868598461151123
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.5777661800384521
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.6696434020996094
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.6721813678741455
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 1.8034632205963135
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.6532413959503174
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 1.794736623764038
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 87 cost time: 1.555793285369873
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 88 cost time: 1.693993330001831
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.794637680053711
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.6702067852020264
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 91 cost time: 1.6045057773590088
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 92 cost time: 1.717193841934204
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.764557123184204
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.6745524406433105
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 95 cost time: 1.727006196975708
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.6784968376159668
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.60652756690979
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 1.496922254562378
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 1.5985052585601807
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 100 cost time: 1.6009531021118164
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm64_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 193305
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8952856063842773
Epoch: 1, Steps: 18 | Train Loss: 2.909 Vali Loss: 1.502 Vali Acc: 0.780 Test Loss: 1.502 Test Acc: 0.780
Validation loss decreased (inf --> -0.779985).  Saving model ...
Epoch: 2 cost time: 1.9476795196533203
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 0.284 Vali Acc: 0.940 Test Loss: 0.284 Test Acc: 0.940
Validation loss decreased (-0.779985 --> -0.939997).  Saving model ...
Epoch: 3 cost time: 1.967668056488037
Epoch: 3, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.150 Vali Acc: 0.953 Test Loss: 0.150 Test Acc: 0.953
Validation loss decreased (-0.939997 --> -0.953332).  Saving model ...
Epoch: 4 cost time: 2.1375231742858887
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.953332 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.0750041007995605
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0399458408355713
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 2.049345016479492
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.956770420074463
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.9387145042419434
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.9485197067260742
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0732316970825195
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9701628684997559
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.9735791683197021
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.0198843479156494
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.0524356365203857
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.9780082702636719
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.9964168071746826
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.092961549758911
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.0497262477874756
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2821969985961914
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.1123950481414795
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.096904754638672
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.9518687725067139
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.8683557510375977
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.0000579357147217
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.9292099475860596
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9180409908294678
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.8108036518096924
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.8388278484344482
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.8855986595153809
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8810622692108154
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9209198951721191
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.818664312362671
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.7755413055419922
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.9724335670471191
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.9297549724578857
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.9169414043426514
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.0875420570373535
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.006028413772583
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9710922241210938
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.9720580577850342
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.9763143062591553
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.0234997272491455
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.9734432697296143
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.9315319061279297
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.8512122631072998
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.8134522438049316
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.8880836963653564
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8493866920471191
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.982365608215332
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9548797607421875
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 2.0038928985595703
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 2.074235439300537
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.0668654441833496
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 2.0259501934051514
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.061976432800293
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.0361578464508057
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 2.081433057785034
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.1036088466644287
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.934499740600586
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.8573198318481445
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.787238597869873
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.913358449935913
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.8623607158660889
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.8505067825317383
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.8807642459869385
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.9701228141784668
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.793534278869629
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.9766690731048584
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.9166836738586426
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.9353182315826416
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 2.10847544670105
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.7507846355438232
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.111997127532959
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.9769845008850098
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 2.0325865745544434
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 2.04021954536438
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.069868564605713
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 2.0476276874542236
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 2.006849527359009
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.8629624843597412
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 2.0490386486053467
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.9527192115783691
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.9354908466339111
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.211899757385254
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 2.1929874420166016
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 2.0075132846832275
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 2.1152780055999756
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 2.2125892639160156
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 2.044036388397217
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.9759373664855957
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 2.1267096996307373
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 2.1601595878601074
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.850426197052002
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 1.815850019454956
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 581689
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.754682540893555
Epoch: 1, Steps: 18 | Train Loss: 3.198 Vali Loss: 2.324 Vali Acc: 0.517 Test Loss: 2.324 Test Acc: 0.517
Validation loss decreased (inf --> -0.516643).  Saving model ...
Epoch: 2 cost time: 2.9398701190948486
Epoch: 2, Steps: 18 | Train Loss: 1.568 Vali Loss: 0.722 Vali Acc: 0.930 Test Loss: 0.722 Test Acc: 0.930
Validation loss decreased (-0.516643 --> -0.929993).  Saving model ...
Epoch: 3 cost time: 2.8976449966430664
Epoch: 3, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
Validation loss decreased (-0.929993 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 2.8104400634765625
Epoch: 4, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 2.8804070949554443
Epoch: 5, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.956665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 2.816319465637207
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.719900131225586
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.7198355197906494
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.598550796508789
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.8194966316223145
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.79451584815979
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.714156150817871
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7400693893432617
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7336912155151367
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8866777420043945
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6190719604492188
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0109403133392334
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.8202524185180664
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6787941455841064
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.952683925628662
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9490768909454346
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.7194459438323975
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.976119041442871
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.94282603263855
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.787395477294922
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.88124942779541
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.6717398166656494
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.754321336746216
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8264150619506836
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 2.576540946960449
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 2.8306844234466553
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 2.668564558029175
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 2.881619691848755
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 2.7351012229919434
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 2.671743392944336
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.072099208831787
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.4551162719726562
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.4905266761779785
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.4299497604370117
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.3491649627685547
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.3019614219665527
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 2.7932868003845215
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.0701241493225098
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.604346513748169
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 2.3154585361480713
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.6689951419830322
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.764051914215088
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.8475100994110107
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 2.5972297191619873
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 2.6530680656433105
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 2.2449560165405273
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 2.047898054122925
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 2.3949759006500244
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 2.272083282470703
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 2.513672113418579
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.422879695892334
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 2.4190049171447754
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 2.6971595287323
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.601029872894287
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.472371816635132
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 2.7025578022003174
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 2.3852858543395996
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 2.706897735595703
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.4916698932647705
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.621466636657715
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.5614001750946045
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 2.3052501678466797
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 2.0445892810821533
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.9853382110595703
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.375608205795288
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.8018622398376465
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.375356912612915
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 2.1790072917938232
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.950986623764038
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.439577341079712
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 2.346165180206299
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 2.192263603210449
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.3529534339904785
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 2.2198078632354736
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 2.469670295715332
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 2.4464168548583984
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 2.3177642822265625
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 2.2294163703918457
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 2.4587767124176025
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 2.1245038509368896
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 2.3722293376922607
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.355574607849121
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 2.079972982406616
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 2.404794454574585
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 2.305044174194336
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 2.364849090576172
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 2.318723440170288
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 2.0245604515075684
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.9033277034759521
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 2.1579782962799072
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 2.2511391639709473
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 2.398685932159424
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 2.435189962387085
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 2.2982256412506104
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 2.292965888977051
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 322617
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4767074584960938
Epoch: 1, Steps: 18 | Train Loss: 3.249 Vali Loss: 2.648 Vali Acc: 0.363 Test Loss: 2.648 Test Acc: 0.363
Validation loss decreased (inf --> -0.363307).  Saving model ...
Epoch: 2 cost time: 1.4829177856445312
Epoch: 2, Steps: 18 | Train Loss: 2.083 Vali Loss: 1.234 Vali Acc: 0.900 Test Loss: 1.234 Test Acc: 0.900
Validation loss decreased (-0.363307 --> -0.899988).  Saving model ...
Epoch: 3 cost time: 1.6535520553588867
Epoch: 3, Steps: 18 | Train Loss: 0.775 Vali Loss: 0.385 Vali Acc: 0.960 Test Loss: 0.385 Test Acc: 0.960
Validation loss decreased (-0.899988 --> -0.959996).  Saving model ...
Epoch: 4 cost time: 1.443098783493042
Epoch: 4, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4820504188537598
Epoch: 5, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.959996 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.4736011028289795
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.425119400024414
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.573143720626831
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3230156898498535
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.3684871196746826
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.5189309120178223
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.529921293258667
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.4622218608856201
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.5866518020629883
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.4415631294250488
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.455338478088379
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.3312408924102783
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.3611702919006348
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.4422268867492676
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.4051964282989502
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.402327537536621
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.5269923210144043
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.368591547012329
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.468721866607666
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.4662806987762451
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.4570910930633545
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.4749038219451904
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5287630558013916
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5255556106567383
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4479351043701172
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.421645164489746
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.4371452331542969
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.4981138706207275
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.5592961311340332
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.4086322784423828
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3418269157409668
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.372377872467041
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.3757908344268799
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.397629737854004
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4747655391693115
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4688992500305176
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.5641939640045166
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.534452199935913
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.6631782054901123
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.5250940322875977
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.5281908512115479
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.6225676536560059
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.5762147903442383
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.5840842723846436
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.5102052688598633
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.592233419418335
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.6236395835876465
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.6313056945800781
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.7322776317596436
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.7437498569488525
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.5547242164611816
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.7159790992736816
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.5554640293121338
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.7007744312286377
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.6493346691131592
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.680661678314209
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.5333082675933838
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.5620722770690918
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.573634386062622
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.5940330028533936
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 1.5998904705047607
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 1.681060552597046
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.6384661197662354
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.7129018306732178
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.7682857513427734
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.554394245147705
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.6434226036071777
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 1.6465065479278564
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.4870545864105225
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.4584131240844727
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 1.4952824115753174
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.4963150024414062
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.5533721446990967
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.5492842197418213
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.7805452346801758
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 1.5594372749328613
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 1.5712425708770752
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.5173110961914062
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.625436782836914
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 85 cost time: 1.9848308563232422
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 1.887603998184204
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 2.0785980224609375
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.908308744430542
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 2.1051933765411377
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 2.203827381134033
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 2.1154088973999023
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 2.072827100753784
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 2.0540108680725098
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 1.9096083641052246
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 2.089674472808838
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 96 cost time: 1.9103443622589111
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 97 cost time: 1.8105628490447998
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.1485941410064697
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 2.068250894546509
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 2.2108325958251953
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 236313
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.1631019115448
Epoch: 1, Steps: 18 | Train Loss: 3.237 Vali Loss: 2.702 Vali Acc: 0.327 Test Loss: 2.702 Test Acc: 0.327
Validation loss decreased (inf --> -0.326640).  Saving model ...
Epoch: 2 cost time: 1.9934701919555664
Epoch: 2, Steps: 18 | Train Loss: 2.385 Vali Loss: 1.666 Vali Acc: 0.817 Test Loss: 1.666 Test Acc: 0.817
Validation loss decreased (-0.326640 --> -0.816650).  Saving model ...
Epoch: 3 cost time: 1.9337265491485596
Epoch: 3, Steps: 18 | Train Loss: 1.263 Vali Loss: 0.696 Vali Acc: 0.933 Test Loss: 0.696 Test Acc: 0.933
Validation loss decreased (-0.816650 --> -0.933326).  Saving model ...
Epoch: 4 cost time: 2.0322811603546143
Epoch: 4, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.281 Vali Acc: 0.953 Test Loss: 0.281 Test Acc: 0.953
Validation loss decreased (-0.933326 --> -0.953331).  Saving model ...
Epoch: 5 cost time: 2.0382304191589355
Epoch: 5, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.9264659881591797
Epoch: 6, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 2.1183114051818848
Epoch: 7, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9642391204833984
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.049255609512329
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.86025071144104
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.2669360637664795
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9051332473754883
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8488337993621826
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7448556423187256
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.92893385887146
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2032310962677
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.031923532485962
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0085182189941406
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6189944744110107
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.2389557361602783
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.044639825820923
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.093278408050537
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 2.1584343910217285
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.2227020263671875
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.037928342819214
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.035828113555908
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.950418472290039
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 2.200791835784912
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.9538500308990479
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 2.0287973880767822
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.034897565841675
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9890999794006348
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.021658420562744
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.8802974224090576
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.6923248767852783
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.921205759048462
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8318309783935547
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.745985746383667
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.2070417404174805
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.8329424858093262
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0961039066314697
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9416024684906006
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.8293085098266602
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.926180362701416
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.902991533279419
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 2.1725101470947266
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 2.13246750831604
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 2.0759117603302
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 2.2163689136505127
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.1715779304504395
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.876981258392334
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 2.1800954341888428
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.9894437789916992
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 2.1676056385040283
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.936086893081665
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.0737199783325195
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 2.1275384426116943
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.109428882598877
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 2.2694923877716064
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 2.3046152591705322
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.8765249252319336
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.8895554542541504
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.840829849243164
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.7958714962005615
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 2.1167008876800537
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.8492050170898438
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.8998358249664307
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.9517605304718018
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.7213480472564697
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.8043360710144043
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.8723273277282715
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 2.2434511184692383
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.8492319583892822
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.959540843963623
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.9487700462341309
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.8014662265777588
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.0105581283569336
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 2.018669605255127
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.8429033756256104
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 2.0328614711761475
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.8375990390777588
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.9813051223754883
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 2.1032371520996094
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 2.016887664794922
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 2.2667508125305176
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.6603336334228516
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 2.0984179973602295
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.9871869087219238
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 2.101682186126709
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 2.0347673892974854
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.8152220249176025
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.693070888519287
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.8464300632476807
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.762810230255127
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.907604694366455
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 2.0296149253845215
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.7161815166473389
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.0352494716644287
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 2.0130016803741455
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.82779860496521
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 193241
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.717332601547241
Epoch: 1, Steps: 18 | Train Loss: 3.325 Vali Loss: 2.864 Vali Acc: 0.197 Test Loss: 2.864 Test Acc: 0.197
Validation loss decreased (inf --> -0.196638).  Saving model ...
Epoch: 2 cost time: 2.1792802810668945
Epoch: 2, Steps: 18 | Train Loss: 2.519 Vali Loss: 1.805 Vali Acc: 0.787 Test Loss: 1.805 Test Acc: 0.787
Validation loss decreased (-0.196638 --> -0.786649).  Saving model ...
Epoch: 3 cost time: 1.7993419170379639
Epoch: 3, Steps: 18 | Train Loss: 1.415 Vali Loss: 0.798 Vali Acc: 0.933 Test Loss: 0.798 Test Acc: 0.933
Validation loss decreased (-0.786649 --> -0.933325).  Saving model ...
Epoch: 4 cost time: 1.7340075969696045
Epoch: 4, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.334 Vali Acc: 0.967 Test Loss: 0.334 Test Acc: 0.967
Validation loss decreased (-0.933325 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.9994432926177979
Epoch: 5, Steps: 18 | Train Loss: 0.215 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.7715535163879395
Epoch: 6, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 2.069952964782715
Epoch: 7, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.77219557762146
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.7705974578857422
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.933506965637207
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.7708885669708252
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.768570899963379
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.9045028686523438
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6466708183288574
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.8328087329864502
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.642463207244873
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.7813241481781006
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 2.260551691055298
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.8461174964904785
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.7732253074645996
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.4724757671356201
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.5703480243682861
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.629673957824707
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.7806649208068848
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.670527458190918
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 2.1179392337799072
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.7532951831817627
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.9254765510559082
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.1038482189178467
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.8839569091796875
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.7578120231628418
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.7678806781768799
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.943772792816162
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.833841323852539
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.8243114948272705
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.7727479934692383
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.8675754070281982
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.8179187774658203
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.7081577777862549
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.899158239364624
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0845234394073486
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.9634983539581299
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.7980186939239502
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9899351596832275
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.9597156047821045
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.835130214691162
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.8712210655212402
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.9376046657562256
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.8637769222259521
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.9372992515563965
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.4736788272857666
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.4617328643798828
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.283262014389038
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.5066289901733398
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.5914649963378906
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.5661201477050781
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.8004744052886963
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.8060693740844727
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.8105418682098389
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.598663330078125
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.5702462196350098
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.6297993659973145
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.0288259983062744
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 2.0568957328796387
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.6066231727600098
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.6367745399475098
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.6423444747924805
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.9935414791107178
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.553670883178711
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.6055688858032227
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.5355393886566162
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.4871623516082764
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.3502638339996338
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.7114028930664062
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.6841046810150146
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.723229169845581
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.5927848815917969
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.737384557723999
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.8140285015106201
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.8524425029754639
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.518648624420166
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.6548364162445068
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.6222107410430908
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.900057315826416
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.81600022315979
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.7685608863830566
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.697049856185913
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 1.4456157684326172
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 1.4069836139678955
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.467761754989624
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.5927295684814453
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.8204386234283447
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 1.8646645545959473
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.959143877029419
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.6230010986328125
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 1.7239196300506592
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 1.893522024154663
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.9815614223480225
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.6490070819854736
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.9580237865447998
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 157465
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6981186866760254
Epoch: 1, Steps: 18 | Train Loss: 3.294 Vali Loss: 2.983 Vali Acc: 0.113 Test Loss: 2.983 Test Acc: 0.113
Validation loss decreased (inf --> -0.113304).  Saving model ...
Epoch: 2 cost time: 1.5510568618774414
Epoch: 2, Steps: 18 | Train Loss: 2.738 Vali Loss: 2.252 Vali Acc: 0.650 Test Loss: 2.252 Test Acc: 0.650
Validation loss decreased (-0.113304 --> -0.649977).  Saving model ...
Epoch: 3 cost time: 1.559157371520996
Epoch: 3, Steps: 18 | Train Loss: 1.917 Vali Loss: 1.367 Vali Acc: 0.870 Test Loss: 1.367 Test Acc: 0.870
Validation loss decreased (-0.649977 --> -0.869986).  Saving model ...
Epoch: 4 cost time: 1.7823021411895752
Epoch: 4, Steps: 18 | Train Loss: 1.165 Vali Loss: 0.681 Vali Acc: 0.937 Test Loss: 0.681 Test Acc: 0.937
Validation loss decreased (-0.869986 --> -0.936660).  Saving model ...
Epoch: 5 cost time: 1.719125747680664
Epoch: 5, Steps: 18 | Train Loss: 0.520 Vali Loss: 0.353 Vali Acc: 0.953 Test Loss: 0.353 Test Acc: 0.953
Validation loss decreased (-0.936660 --> -0.953330).  Saving model ...
Epoch: 6 cost time: 1.6640126705169678
Epoch: 6, Steps: 18 | Train Loss: 0.232 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
Validation loss decreased (-0.953330 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 1.5620415210723877
Epoch: 7, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.9144155979156494
Epoch: 8, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.868129014968872
Epoch: 9, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.6217036247253418
Epoch: 10, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7796521186828613
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.685723066329956
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.6572117805480957
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.7767751216888428
Epoch: 14, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.946406602859497
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.8251497745513916
Epoch: 16, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.7835707664489746
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.7675461769104004
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.9264633655548096
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.8324143886566162
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.7744150161743164
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.9025213718414307
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.8259329795837402
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.916930913925171
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.8182604312896729
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.5789949893951416
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.9385581016540527
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.791374683380127
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.4670119285583496
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.929616928100586
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.802138328552246
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.6656560897827148
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.8046696186065674
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.843768835067749
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.8211166858673096
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.7524502277374268
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.8241608142852783
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.04585599899292
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.5006859302520752
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.5716218948364258
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.387643575668335
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.356605052947998
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 1.6452052593231201
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 2.103501558303833
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.9622135162353516
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.889404296875
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.689107894897461
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 2.0446202754974365
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.8149187564849854
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.9423725605010986
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.8912959098815918
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 2.0267696380615234
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.761042594909668
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.7696545124053955
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.7609572410583496
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.7077116966247559
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.68929123878479
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.477423906326294
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.8258652687072754
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.8849432468414307
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.109043836593628
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.6370561122894287
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.927699089050293
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.6166577339172363
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.9334254264831543
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.8173623085021973
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.6874570846557617
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.693319320678711
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.575986385345459
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.645472526550293
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.649899959564209
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.812612533569336
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.5119030475616455
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.8496370315551758
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.3855462074279785
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.880016565322876
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.962641954421997
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.6670558452606201
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.8293843269348145
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.8583385944366455
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.8834176063537598
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 1.6857540607452393
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.725888729095459
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.8967628479003906
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.61224365234375
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.9013330936431885
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.4084632396697998
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.6991395950317383
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 1.843066930770874
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.6368672847747803
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.9395296573638916
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.7979555130004883
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.366297721862793
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.3960139751434326
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.4423496723175049
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.370999813079834
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 1.4817256927490234
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.820702314376831
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.6177880764007568
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.4184560775756836
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 128889
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.602573871612549
Epoch: 1, Steps: 18 | Train Loss: 3.352 Vali Loss: 3.023 Vali Acc: 0.127 Test Loss: 3.023 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 1.5632586479187012
Epoch: 2, Steps: 18 | Train Loss: 2.822 Vali Loss: 2.337 Vali Acc: 0.533 Test Loss: 2.337 Test Acc: 0.533
Validation loss decreased (-0.126636 --> -0.533310).  Saving model ...
Epoch: 3 cost time: 1.7134997844696045
Epoch: 3, Steps: 18 | Train Loss: 2.030 Vali Loss: 1.481 Vali Acc: 0.810 Test Loss: 1.481 Test Acc: 0.810
Validation loss decreased (-0.533310 --> -0.809985).  Saving model ...
Epoch: 4 cost time: 1.9496703147888184
Epoch: 4, Steps: 18 | Train Loss: 1.158 Vali Loss: 0.794 Vali Acc: 0.917 Test Loss: 0.794 Test Acc: 0.917
Validation loss decreased (-0.809985 --> -0.916659).  Saving model ...
Epoch: 5 cost time: 1.6595633029937744
Epoch: 5, Steps: 18 | Train Loss: 0.551 Vali Loss: 0.419 Vali Acc: 0.953 Test Loss: 0.419 Test Acc: 0.953
Validation loss decreased (-0.916659 --> -0.953329).  Saving model ...
Epoch: 6 cost time: 1.6000854969024658
Epoch: 6, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.265 Vali Acc: 0.960 Test Loss: 0.265 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 1.9518423080444336
Epoch: 7, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 8 cost time: 1.6186423301696777
Epoch: 8, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.5150418281555176
Epoch: 9, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 1.5296807289123535
Epoch: 10, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 1.4635541439056396
Epoch: 11, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.6036531925201416
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.4765968322753906
Epoch: 13, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.5068731307983398
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5931382179260254
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.5923638343811035
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.7299597263336182
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.788949966430664
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.534895658493042
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.3893637657165527
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.5673096179962158
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.765010118484497
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.7931621074676514
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.504347324371338
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.3044307231903076
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.5303211212158203
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.7356925010681152
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.6082768440246582
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6213326454162598
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.5150134563446045
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.550981044769287
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.7398769855499268
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.8140771389007568
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.6666779518127441
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.6195387840270996
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4385490417480469
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.902045488357544
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.4997692108154297
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.4414420127868652
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.4325764179229736
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.5526065826416016
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.4991443157196045
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.6234476566314697
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.5888113975524902
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.4694135189056396
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.6153171062469482
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.7001237869262695
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5425398349761963
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.7509346008300781
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7775211334228516
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.4514505863189697
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.5823590755462646
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.4914321899414062
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.377537488937378
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.6099700927734375
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.5084350109100342
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.6329946517944336
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.4460487365722656
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.4182462692260742
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.5338988304138184
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.6160087585449219
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.5030901432037354
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.763620138168335
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.7053651809692383
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.7123887538909912
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.6062545776367188
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.768639326095581
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.5206761360168457
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.652237892150879
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.7017076015472412
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.7291908264160156
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.46354079246521
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.6180737018585205
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.5542073249816895
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.614687204360962
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.6649205684661865
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.5061984062194824
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.4669642448425293
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.3724379539489746
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.48272705078125
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.80214262008667
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 2.084425210952759
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 2.094414234161377
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.7154169082641602
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.8864097595214844
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 2.275505781173706
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 2.2604784965515137
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 2.011087417602539
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 1.908280849456787
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.9127612113952637
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 2.1023218631744385
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 2.137284517288208
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 2.0596513748168945
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.9738733768463135
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.8983242511749268
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 1.9308443069458008
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 2.0901365280151367
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 2.025437831878662
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 2.153562545776367
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.9251737594604492
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 121913
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.129791975021362
Epoch: 1, Steps: 18 | Train Loss: 2.835 Vali Loss: 1.598 Vali Acc: 0.763 Test Loss: 1.598 Test Acc: 0.763
Validation loss decreased (inf --> -0.763317).  Saving model ...
Epoch: 2 cost time: 2.080662488937378
Epoch: 2, Steps: 18 | Train Loss: 0.836 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
Validation loss decreased (-0.763317 --> -0.936663).  Saving model ...
Epoch: 3 cost time: 2.19771671295166
Epoch: 3, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.936663 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 2.0622572898864746
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 2.218830108642578
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4731810092926025
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 2.4450786113739014
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4408106803894043
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.317728281021118
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.2420787811279297
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.8808844089508057
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 2.048231840133667
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 2.146432399749756
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 2.166560411453247
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 2.2488837242126465
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 2.35013484954834
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 2.2958168983459473
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 2.194098949432373
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3590035438537598
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.676316261291504
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 2.5763909816741943
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 2.1980419158935547
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 2.304565191268921
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 2.3803937435150146
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 2.312821865081787
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 2.6639442443847656
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6069767475128174
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 2.4011833667755127
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 2.167159080505371
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 2.2811877727508545
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 2.2073302268981934
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.2904181480407715
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 2.0017621517181396
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9348640441894531
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.14970064163208
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 2.4296250343322754
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.2496113777160645
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.4012742042541504
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.9653754234313965
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.8144080638885498
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.8651018142700195
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.9869790077209473
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.1595661640167236
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 2.2178258895874023
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 2.3667168617248535
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 2.143650531768799
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.3861515522003174
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 48 cost time: 2.228445291519165
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 49 cost time: 2.4373295307159424
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 50 cost time: 2.053001880645752
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 51 cost time: 2.2220630645751953
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 52 cost time: 2.1410412788391113
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 53 cost time: 2.3380322456359863
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.091095447540283
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 55 cost time: 2.226168394088745
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.1794137954711914
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 57 cost time: 2.232492685317993
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 58 cost time: 2.102999448776245
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.324572801589966
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 60 cost time: 2.240974187850952
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 61 cost time: 2.307629346847534
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 62 cost time: 2.2669572830200195
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.5168204307556152
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.1567935943603516
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.4277689456939697
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 2.3410756587982178
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.53377366065979
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 2.2562789916992188
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 2.4184625148773193
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 2.2682063579559326
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 2.2648751735687256
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 556729
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.70431923866272
Epoch: 1, Steps: 18 | Train Loss: 3.140 Vali Loss: 2.321 Vali Acc: 0.590 Test Loss: 2.321 Test Acc: 0.590
Validation loss decreased (inf --> -0.589977).  Saving model ...
Epoch: 2 cost time: 4.014298677444458
Epoch: 2, Steps: 18 | Train Loss: 1.590 Vali Loss: 0.725 Vali Acc: 0.953 Test Loss: 0.725 Test Acc: 0.953
Validation loss decreased (-0.589977 --> -0.953326).  Saving model ...
Epoch: 3 cost time: 3.7300097942352295
Epoch: 3, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.235 Vali Acc: 0.953 Test Loss: 0.235 Test Acc: 0.953
Validation loss decreased (-0.953326 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 3.590404748916626
Epoch: 4, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.953331 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 3.4708786010742188
Epoch: 5, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 3.604929208755493
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 3.4207041263580322
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3783178329467773
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 3.7584307193756104
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 3.2380011081695557
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 3.5797958374023438
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 3.6867988109588623
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 3.290686845779419
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.797559976577759
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.002912521362305
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 3.1703600883483887
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 2.529205322265625
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 2.320361614227295
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 2.584721565246582
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 3.22090220451355
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 3.463114023208618
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 3.4464197158813477
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 3.4468135833740234
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 3.557471990585327
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4238340854644775
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.7798964977264404
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 2.3914196491241455
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 2.8428826332092285
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0116631984710693
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.030892848968506
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.228464365005493
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.1249988079071045
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.4687750339508057
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.062577247619629
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 3.5033230781555176
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.163740396499634
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.494661331176758
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.90494704246521
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.6465542316436768
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.682086706161499
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 3.18515944480896
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 2.8626465797424316
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 3.295048713684082
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.870450496673584
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 2.2676620483398438
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 2.8342125415802
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 2.7115938663482666
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 2.453486442565918
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 2.543431043624878
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.7468550205230713
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.892528533935547
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 3.226717233657837
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.8398168087005615
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 3.017402410507202
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 3.3714048862457275
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 3.541722297668457
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 3.308199405670166
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 3.4467873573303223
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.6792657375335693
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 2.2378852367401123
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.900291919708252
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.90205979347229
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.9337730407714844
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 3.358175754547119
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 297657
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2105424404144287
Epoch: 1, Steps: 18 | Train Loss: 3.238 Vali Loss: 2.566 Vali Acc: 0.400 Test Loss: 2.566 Test Acc: 0.400
Validation loss decreased (inf --> -0.399974).  Saving model ...
Epoch: 2 cost time: 1.8474538326263428
Epoch: 2, Steps: 18 | Train Loss: 2.034 Vali Loss: 1.172 Vali Acc: 0.877 Test Loss: 1.172 Test Acc: 0.877
Validation loss decreased (-0.399974 --> -0.876655).  Saving model ...
Epoch: 3 cost time: 1.2969989776611328
Epoch: 3, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.384 Vali Acc: 0.963 Test Loss: 0.384 Test Acc: 0.963
Validation loss decreased (-0.876655 --> -0.963329).  Saving model ...
Epoch: 4 cost time: 1.874572992324829
Epoch: 4, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9948251247406006
Epoch: 5, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.758333683013916
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.8234448432922363
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.8638880252838135
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.5951776504516602
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.7066221237182617
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.539311408996582
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.5900828838348389
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.589327096939087
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.4667108058929443
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.577857494354248
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4653916358947754
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.5475547313690186
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.3563156127929688
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.7391667366027832
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.749945878982544
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6246042251586914
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6315233707427979
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.681856393814087
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.4985628128051758
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.5873069763183594
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4547679424285889
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.577627182006836
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6023693084716797
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6436638832092285
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6104991436004639
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.5874238014221191
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.536520004272461
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.6169025897979736
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.4925572872161865
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.574524164199829
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5565879344940186
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.468996524810791
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 2.0404322147369385
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.96368408203125
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.8614943027496338
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.5948610305786133
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.7784504890441895
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.689969539642334
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.6025166511535645
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.7879531383514404
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9222986698150635
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.9326839447021484
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.848430871963501
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.7964818477630615
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.897134780883789
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.4293310642242432
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.660456895828247
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.9954822063446045
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.7020683288574219
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.8461127281188965
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.886049509048462
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 2.043750286102295
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.8899133205413818
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4950222969055176
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.9530231952667236
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.8115086555480957
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.8280491828918457
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.8791913986206055
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.9443769454956055
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.8350830078125
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.6040706634521484
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.7776691913604736
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.94034743309021
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.9870920181274414
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.831329345703125
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.8510398864746094
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.604536533355713
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.8441102504730225
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.841611385345459
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.7735910415649414
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.899810552597046
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.8602020740509033
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.844470739364624
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.8816497325897217
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.8809282779693604
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.5658271312713623
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.3002665042877197
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.56858229637146
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.469935417175293
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.830904483795166
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.6112122535705566
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.6885738372802734
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 2.136807680130005
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.799516201019287
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.7438607215881348
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.854496955871582
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.5505907535552979
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.2475075721740723
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 2.006699562072754
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.6456239223480225
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 1.7929127216339111
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.7884221076965332
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 2.124725341796875
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 1.806140661239624
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.8547804355621338
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 211353
model size : 1.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4537901878356934
Epoch: 1, Steps: 18 | Train Loss: 3.247 Vali Loss: 2.797 Vali Acc: 0.247 Test Loss: 2.797 Test Acc: 0.247
Validation loss decreased (inf --> -0.246639).  Saving model ...
Epoch: 2 cost time: 1.7566213607788086
Epoch: 2, Steps: 18 | Train Loss: 2.450 Vali Loss: 1.746 Vali Acc: 0.813 Test Loss: 1.746 Test Acc: 0.813
Validation loss decreased (-0.246639 --> -0.813316).  Saving model ...
Epoch: 3 cost time: 1.6247055530548096
Epoch: 3, Steps: 18 | Train Loss: 1.328 Vali Loss: 0.744 Vali Acc: 0.943 Test Loss: 0.744 Test Acc: 0.943
Validation loss decreased (-0.813316 --> -0.943326).  Saving model ...
Epoch: 4 cost time: 1.7314457893371582
Epoch: 4, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.309 Vali Acc: 0.957 Test Loss: 0.309 Test Acc: 0.957
Validation loss decreased (-0.943326 --> -0.956664).  Saving model ...
Epoch: 5 cost time: 1.4827921390533447
Epoch: 5, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.5823283195495605
Epoch: 6, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.8016908168792725
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.794321060180664
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.8438727855682373
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.544691562652588
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.7635884284973145
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.4406697750091553
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.578028678894043
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.494642734527588
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.4814462661743164
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.5469388961791992
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.4192471504211426
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.451855182647705
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.5519795417785645
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.749014139175415
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.5335729122161865
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.9052274227142334
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7561826705932617
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.5164618492126465
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.7619380950927734
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.8499424457550049
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9672877788543701
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.9343078136444092
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.922652006149292
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.914435863494873
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.7715322971343994
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6104905605316162
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.68428635597229
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.7965068817138672
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.6362190246582031
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.7276690006256104
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.4938724040985107
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.8743007183074951
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.46805739402771
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.747096300125122
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.587510108947754
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.613887071609497
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.566786527633667
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.562612533569336
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.7214937210083008
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.6775178909301758
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.8128061294555664
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 168281
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7931320667266846
Epoch: 1, Steps: 18 | Train Loss: 3.198 Vali Loss: 2.796 Vali Acc: 0.230 Test Loss: 2.796 Test Acc: 0.230
Validation loss decreased (inf --> -0.229972).  Saving model ...
Epoch: 2 cost time: 1.530686378479004
Epoch: 2, Steps: 18 | Train Loss: 2.445 Vali Loss: 1.855 Vali Acc: 0.773 Test Loss: 1.855 Test Acc: 0.773
Validation loss decreased (-0.229972 --> -0.773315).  Saving model ...
Epoch: 3 cost time: 1.8391659259796143
Epoch: 3, Steps: 18 | Train Loss: 1.478 Vali Loss: 0.884 Vali Acc: 0.937 Test Loss: 0.884 Test Acc: 0.937
Validation loss decreased (-0.773315 --> -0.936658).  Saving model ...
Epoch: 4 cost time: 1.6640219688415527
Epoch: 4, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.378 Vali Acc: 0.960 Test Loss: 0.378 Test Acc: 0.960
Validation loss decreased (-0.936658 --> -0.959996).  Saving model ...
Epoch: 5 cost time: 1.577134370803833
Epoch: 5, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.206 Vali Acc: 0.970 Test Loss: 0.206 Test Acc: 0.970
Validation loss decreased (-0.959996 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.6657376289367676
Epoch: 6, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.5782530307769775
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6238842010498047
Epoch: 8, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.849722146987915
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.5803732872009277
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.5774824619293213
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.7845978736877441
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.674886703491211
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7536017894744873
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.6492376327514648
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.682135820388794
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7253401279449463
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7375786304473877
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.6816346645355225
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.5429224967956543
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.7165815830230713
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6831326484680176
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.3674137592315674
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.5829274654388428
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.476883888244629
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.5123326778411865
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.5249648094177246
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.6479451656341553
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.8138573169708252
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.6714468002319336
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.6326348781585693
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.4732160568237305
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.673816204071045
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.7509729862213135
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.9330658912658691
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.7364869117736816
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.619446039199829
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.5463252067565918
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.6930828094482422
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.7684972286224365
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.552633285522461
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4574718475341797
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3927645683288574
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.5981683731079102
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.4351706504821777
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.6040623188018799
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.6743929386138916
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.443793773651123
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.4873442649841309
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.6047046184539795
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.5396676063537598
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.7094924449920654
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.7907767295837402
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.932600498199463
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.646202564239502
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.4974966049194336
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.5393106937408447
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.4311168193817139
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.4533302783966064
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.4599378108978271
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.5772428512573242
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.6143536567687988
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.644944429397583
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.6051225662231445
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.6873376369476318
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.777000904083252
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.773500919342041
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.7077550888061523
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.5385890007019043
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.6253972053527832
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.7119619846343994
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.710442304611206
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.6259288787841797
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.8252520561218262
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.5308454036712646
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.4468653202056885
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.6016056537628174
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.4728569984436035
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.4012196063995361
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.6141443252563477
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.6003055572509766
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.982781171798706
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.8619194030761719
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.6815612316131592
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.6025965213775635
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.942246913909912
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.6980476379394531
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.9833307266235352
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 2.0140347480773926
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 2.106497049331665
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 2.0406250953674316
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.751373291015625
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.941258192062378
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.744217872619629
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.7230267524719238
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.7502546310424805
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 1.6852412223815918
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.835587978363037
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.805837631225586
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.9225294589996338
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 132505
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6577017307281494
Epoch: 1, Steps: 18 | Train Loss: 3.221 Vali Loss: 2.944 Vali Acc: 0.190 Test Loss: 2.944 Test Acc: 0.190
Validation loss decreased (inf --> -0.189971).  Saving model ...
Epoch: 2 cost time: 1.7387669086456299
Epoch: 2, Steps: 18 | Train Loss: 2.748 Vali Loss: 2.231 Vali Acc: 0.600 Test Loss: 2.231 Test Acc: 0.600
Validation loss decreased (-0.189971 --> -0.599978).  Saving model ...
Epoch: 3 cost time: 1.6677954196929932
Epoch: 3, Steps: 18 | Train Loss: 1.959 Vali Loss: 1.412 Vali Acc: 0.850 Test Loss: 1.412 Test Acc: 0.850
Validation loss decreased (-0.599978 --> -0.849986).  Saving model ...
Epoch: 4 cost time: 1.6440556049346924
Epoch: 4, Steps: 18 | Train Loss: 1.114 Vali Loss: 0.737 Vali Acc: 0.947 Test Loss: 0.737 Test Acc: 0.947
Validation loss decreased (-0.849986 --> -0.946659).  Saving model ...
Epoch: 5 cost time: 1.5574581623077393
Epoch: 5, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.403 Vali Acc: 0.957 Test Loss: 0.403 Test Acc: 0.957
Validation loss decreased (-0.946659 --> -0.956663).  Saving model ...
Epoch: 6 cost time: 1.729163408279419
Epoch: 6, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.261 Vali Acc: 0.967 Test Loss: 0.261 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 1.822281837463379
Epoch: 7, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8378233909606934
Epoch: 8, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.6690728664398193
Epoch: 9, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8614754676818848
Epoch: 10, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7898554801940918
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.692988634109497
Epoch: 12, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.7749886512756348
Epoch: 13, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.828385591506958
Epoch: 14, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9513897895812988
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.8392443656921387
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.9474706649780273
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.814622163772583
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.7493603229522705
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.831369400024414
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.9998149871826172
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.545046091079712
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.5008876323699951
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.0467026233673096
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.8871736526489258
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.8187661170959473
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.6690089702606201
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.4325385093688965
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.3378067016601562
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.5057356357574463
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4463419914245605
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.7688302993774414
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.5057003498077393
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.733365774154663
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.4362859725952148
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.6794579029083252
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.7254064083099365
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.689626932144165
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.6949245929718018
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.6108169555664062
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.5884716510772705
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.7910125255584717
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.872798204421997
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6071300506591797
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.7278144359588623
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.577756643295288
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.8243625164031982
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.7092328071594238
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.5373163223266602
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.52531099319458
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.5937795639038086
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.6221230030059814
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.7082972526550293
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.4513750076293945
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4730536937713623
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.361480951309204
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.4409620761871338
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.330695390701294
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.3763134479522705
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.4563419818878174
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.6795251369476318
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.5693447589874268
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.7287771701812744
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.5550050735473633
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.7239892482757568
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.7084619998931885
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.555614948272705
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.6325337886810303
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.9424269199371338
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.801318883895874
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.560981035232544
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.7600224018096924
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.405278205871582
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.626338243484497
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.445012092590332
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.571073055267334
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.6432301998138428
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.4887721538543701
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.4211580753326416
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.4334697723388672
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.3364002704620361
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.6120285987854004
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.5198028087615967
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.5313334465026855
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.7115044593811035
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.5081942081451416
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.6675808429718018
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.5728745460510254
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.606407642364502
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.5788183212280273
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.7808175086975098
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.592261791229248
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.4277637004852295
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.4190483093261719
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.6954967975616455
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.3183531761169434
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.2778913974761963
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.613710641860962
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 1.5760037899017334
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.7107837200164795
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 103929
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.577035427093506
Epoch: 1, Steps: 18 | Train Loss: 3.295 Vali Loss: 3.014 Vali Acc: 0.137 Test Loss: 3.014 Test Acc: 0.137
Validation loss decreased (inf --> -0.136637).  Saving model ...
Epoch: 2 cost time: 1.533933162689209
Epoch: 2, Steps: 18 | Train Loss: 2.794 Vali Loss: 2.338 Vali Acc: 0.510 Test Loss: 2.338 Test Acc: 0.510
Validation loss decreased (-0.136637 --> -0.509977).  Saving model ...
Epoch: 3 cost time: 1.549523115158081
Epoch: 3, Steps: 18 | Train Loss: 2.089 Vali Loss: 1.534 Vali Acc: 0.813 Test Loss: 1.534 Test Acc: 0.813
Validation loss decreased (-0.509977 --> -0.813318).  Saving model ...
Epoch: 4 cost time: 1.6741671562194824
Epoch: 4, Steps: 18 | Train Loss: 1.253 Vali Loss: 0.845 Vali Acc: 0.907 Test Loss: 0.845 Test Acc: 0.907
Validation loss decreased (-0.813318 --> -0.906658).  Saving model ...
Epoch: 5 cost time: 1.3421432971954346
Epoch: 5, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.451 Vali Acc: 0.963 Test Loss: 0.451 Test Acc: 0.963
Validation loss decreased (-0.906658 --> -0.963329).  Saving model ...
Epoch: 6 cost time: 1.46140456199646
Epoch: 6, Steps: 18 | Train Loss: 0.297 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 1.830552339553833
Epoch: 7, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.7548856735229492
Epoch: 8, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4414074420928955
Epoch: 9, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.2947418689727783
Epoch: 10, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5095207691192627
Epoch: 11, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.403228521347046
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2953345775604248
Epoch: 13, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.4663984775543213
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.6217949390411377
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.3975424766540527
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3992280960083008
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.3062875270843506
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6031196117401123
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6635384559631348
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6942706108093262
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.5983891487121582
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.5617079734802246
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.3497087955474854
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.4427332878112793
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.3868348598480225
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.3390607833862305
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.381943702697754
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2386012077331543
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.280188798904419
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.2694578170776367
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.2817039489746094
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.4097723960876465
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.28572678565979
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.3769011497497559
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.5649609565734863
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.4928834438323975
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.2659735679626465
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.4323477745056152
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.239316701889038
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.4610652923583984
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.5364668369293213
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.4684545993804932
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.5639686584472656
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.5468924045562744
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.3410420417785645
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3491976261138916
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.2102596759796143
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.2943191528320312
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.3081841468811035
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.5621795654296875
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.5180091857910156
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.8384735584259033
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.836174488067627
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.5478434562683105
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.5261366367340088
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.7864906787872314
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.8564214706420898
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.7051057815551758
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.77620267868042
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.814305305480957
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.5316503047943115
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.6694512367248535
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.7948966026306152
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.781083583831787
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.620323657989502
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.7095630168914795
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.6098463535308838
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.6525187492370605
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.3802316188812256
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.6963894367218018
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.768834114074707
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.6887505054473877
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.8029429912567139
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.7521026134490967
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.678276538848877
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.907726526260376
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.8214566707611084
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.7866899967193604
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.8178954124450684
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.8261933326721191
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.6048061847686768
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 83 cost time: 1.927839756011963
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.7942447662353516
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 85 cost time: 1.8341543674468994
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.703418254852295
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.5864300727844238
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.8776953220367432
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.8130691051483154
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.760582685470581
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 1.7470145225524902
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 1.6214244365692139
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 1.8411929607391357
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 1.723724603652954
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 96953
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.2351813316345215
Epoch: 1, Steps: 18 | Train Loss: 2.809 Vali Loss: 1.485 Vali Acc: 0.817 Test Loss: 1.485 Test Acc: 0.817
Validation loss decreased (inf --> -0.816652).  Saving model ...
Epoch: 2 cost time: 3.5969552993774414
Epoch: 2, Steps: 18 | Train Loss: 0.780 Vali Loss: 0.317 Vali Acc: 0.927 Test Loss: 0.317 Test Acc: 0.927
Validation loss decreased (-0.816652 --> -0.926664).  Saving model ...
Epoch: 3 cost time: 2.517946720123291
Epoch: 3, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
Validation loss decreased (-0.926664 --> -0.949998).  Saving model ...
Epoch: 4 cost time: 2.4736127853393555
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.949998 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 2.6415185928344727
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 3.2465298175811768
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.125138759613037
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8274881839752197
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.102476119995117
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9599573612213135
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7425286769866943
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9286677837371826
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.2832422256469727
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.940763473510742
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.136014938354492
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 544249
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.4972193241119385
Epoch: 1, Steps: 18 | Train Loss: 3.106 Vali Loss: 2.215 Vali Acc: 0.667 Test Loss: 2.215 Test Acc: 0.667
Validation loss decreased (inf --> -0.666645).  Saving model ...
Epoch: 2 cost time: 2.8959810733795166
Epoch: 2, Steps: 18 | Train Loss: 1.528 Vali Loss: 0.695 Vali Acc: 0.933 Test Loss: 0.695 Test Acc: 0.933
Validation loss decreased (-0.666645 --> -0.933326).  Saving model ...
Epoch: 3 cost time: 3.0655524730682373
Epoch: 3, Steps: 18 | Train Loss: 0.418 Vali Loss: 0.229 Vali Acc: 0.970 Test Loss: 0.229 Test Acc: 0.970
Validation loss decreased (-0.933326 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 2.72770357131958
Epoch: 4, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.310333251953125
Epoch: 5, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 2.283212184906006
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.2990612983703613
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.1211588382720947
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.959059715270996
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 3.297553539276123
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.922550678253174
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6655256748199463
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8228037357330322
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.916078567504883
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.38596773147583
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.8395657539367676
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.8679370880126953
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 3.238355875015259
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9872493743896484
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.0222671031951904
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8284690380096436
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 3.002902030944824
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 3.347208261489868
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5560035705566406
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.570678949356079
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8902671337127686
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 2.9808809757232666
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 2.8146185874938965
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.8199102878570557
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 3.1553971767425537
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.088087320327759
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 2.695629358291626
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 2.7004213333129883
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 3.2997934818267822
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.912893295288086
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 3.0212416648864746
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 2.863194704055786
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 2.814403772354126
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 2.455036163330078
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.504225254058838
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.341832160949707
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 2.9551095962524414
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.742335796356201
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 2.7035024166107178
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.1386120319366455
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.944579601287842
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.104154586791992
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.0705690383911133
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.1207644939422607
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.2800259590148926
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.989422559738159
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 2.859104871749878
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.872185707092285
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 3.0383596420288086
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 3.1740076541900635
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 2.809235095977783
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 2.5836708545684814
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.5094711780548096
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.7738940715789795
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 3.0765395164489746
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.8341877460479736
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 2.908337354660034
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 2.7531495094299316
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 2.8480045795440674
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.877481460571289
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 2.931438684463501
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 2.940669059753418
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.7671854496002197
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.6043903827667236
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 2.5856051445007324
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.755643129348755
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 2.4331533908843994
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 2.233001947402954
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.37988543510437
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 2.453312397003174
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 2.607109546661377
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 2.723451614379883
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.6260197162628174
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 2.602898120880127
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 2.4816598892211914
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 2.6889028549194336
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 2.609135389328003
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 2.282825231552124
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 2.4342567920684814
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 2.667621374130249
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 2.661591053009033
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 2.4109184741973877
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 2.391742467880249
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 89 cost time: 2.3260889053344727
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 2.3625235557556152
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 2.5836145877838135
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 2.475558042526245
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 2.7813520431518555
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 2.346813678741455
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 2.4202539920806885
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 2.398644208908081
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 2.2971749305725098
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 98 cost time: 2.4448370933532715
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 99 cost time: 2.5470433235168457
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 2.449946403503418
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 285177
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6860556602478027
Epoch: 1, Steps: 18 | Train Loss: 3.244 Vali Loss: 2.648 Vali Acc: 0.423 Test Loss: 2.648 Test Acc: 0.423
Validation loss decreased (inf --> -0.423307).  Saving model ...
Epoch: 2 cost time: 1.4012451171875
Epoch: 2, Steps: 18 | Train Loss: 2.094 Vali Loss: 1.346 Vali Acc: 0.870 Test Loss: 1.346 Test Acc: 0.870
Validation loss decreased (-0.423307 --> -0.869987).  Saving model ...
Epoch: 3 cost time: 1.771925687789917
Epoch: 3, Steps: 18 | Train Loss: 0.919 Vali Loss: 0.474 Vali Acc: 0.953 Test Loss: 0.474 Test Acc: 0.953
Validation loss decreased (-0.869987 --> -0.953329).  Saving model ...
Epoch: 4 cost time: 1.5568063259124756
Epoch: 4, Steps: 18 | Train Loss: 0.272 Vali Loss: 0.223 Vali Acc: 0.960 Test Loss: 0.223 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.4680206775665283
Epoch: 5, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.319246768951416
Epoch: 6, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.3491368293762207
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.8856093883514404
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.399873971939087
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.644688367843628
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.563169240951538
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.5859766006469727
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.361520528793335
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3779423236846924
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.654076337814331
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.4203376770019531
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.5155036449432373
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6333246231079102
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.5461068153381348
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.4825811386108398
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.8646228313446045
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.924351453781128
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.8033287525177002
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9143760204315186
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.515404224395752
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.9061803817749023
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.446242094039917
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.5211920738220215
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6493136882781982
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7369680404663086
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.040699005126953
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.4326364994049072
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.529583215713501
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5047078132629395
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.7132713794708252
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.632305383682251
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.7495765686035156
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.7525758743286133
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.8063855171203613
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.6112656593322754
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.7319624423980713
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.825596809387207
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.753350019454956
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6337862014770508
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.5760889053344727
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.501622200012207
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2610039710998535
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.455580711364746
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.5680694580078125
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.7668406963348389
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.6243903636932373
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.711268663406372
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.6406729221343994
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.7336127758026123
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.8202269077301025
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 2.018665313720703
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.7047216892242432
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.638002872467041
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.5957863330841064
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.6798689365386963
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.575394630432129
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.336578607559204
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.3878123760223389
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.6258635520935059
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.7489128112792969
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.5290322303771973
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.746072769165039
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.702742576599121
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.5850918292999268
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.6042225360870361
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.669567584991455
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.836256504058838
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.879150152206421
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.9304673671722412
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.7461204528808594
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.7037246227264404
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.4064295291900635
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.4178426265716553
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.706181526184082
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.5796167850494385
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.6097455024719238
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.5167312622070312
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.7025823593139648
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 1.6762566566467285
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.7540292739868164
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.653982162475586
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 1.648526906967163
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.8445210456848145
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.7360749244689941
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.756547451019287
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.7526946067810059
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.7747528553009033
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.977351427078247
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.739509105682373
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.665785551071167
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.539468765258789
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.5859382152557373
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.5636272430419922
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.6520192623138428
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.847440481185913
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 198873
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6966633796691895
Epoch: 1, Steps: 18 | Train Loss: 3.250 Vali Loss: 2.754 Vali Acc: 0.323 Test Loss: 2.754 Test Acc: 0.323
Validation loss decreased (inf --> -0.323306).  Saving model ...
Epoch: 2 cost time: 1.7052011489868164
Epoch: 2, Steps: 18 | Train Loss: 2.343 Vali Loss: 1.666 Vali Acc: 0.810 Test Loss: 1.666 Test Acc: 0.810
Validation loss decreased (-0.323306 --> -0.809983).  Saving model ...
Epoch: 3 cost time: 1.5890085697174072
Epoch: 3, Steps: 18 | Train Loss: 1.290 Vali Loss: 0.744 Vali Acc: 0.923 Test Loss: 0.744 Test Acc: 0.923
Validation loss decreased (-0.809983 --> -0.923326).  Saving model ...
Epoch: 4 cost time: 1.620473861694336
Epoch: 4, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.326 Vali Acc: 0.947 Test Loss: 0.326 Test Acc: 0.947
Validation loss decreased (-0.923326 --> -0.946663).  Saving model ...
Epoch: 5 cost time: 1.562849998474121
Epoch: 5, Steps: 18 | Train Loss: 0.178 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.946663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.5586941242218018
Epoch: 6, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.4902873039245605
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.6232216358184814
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.568636417388916
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6096858978271484
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5525996685028076
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.560335397720337
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.501904010772705
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6000456809997559
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.465289831161499
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.6343660354614258
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.7317655086517334
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.7997946739196777
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.5741045475006104
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.5580718517303467
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.6674106121063232
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5465378761291504
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5348868370056152
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.4724907875061035
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.4875717163085938
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5019011497497559
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.4894733428955078
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.3814783096313477
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.2921557426452637
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.9819972515106201
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.9340929985046387
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.7283494472503662
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.8232462406158447
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.7332797050476074
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.8751087188720703
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.923961877822876
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.6844346523284912
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8224387168884277
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.7758190631866455
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.90083646774292
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.6358599662780762
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.8096752166748047
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8652713298797607
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.6469652652740479
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6905028820037842
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.9104886054992676
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.0295937061309814
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6402912139892578
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.6138885021209717
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.7027359008789062
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.5230507850646973
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.593130111694336
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.8269298076629639
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.6900198459625244
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.8678359985351562
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.023427963256836
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.77150297164917
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.5522241592407227
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.916496992111206
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.7671740055084229
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.7827398777008057
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.7844765186309814
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.7064361572265625
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.6888437271118164
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.8484389781951904
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 1.723696231842041
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.8359241485595703
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.5368196964263916
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.6837100982666016
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.6336643695831299
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.6708288192749023
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.5947997570037842
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 1.6093552112579346
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.6333420276641846
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 1.6354119777679443
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 1.7208285331726074
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.6950232982635498
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.7751364707946777
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.7162301540374756
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.9101755619049072
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.7937726974487305
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.6256062984466553
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.636343240737915
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.6671998500823975
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 1.6460044384002686
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 155801
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6767165660858154
Epoch: 1, Steps: 18 | Train Loss: 3.288 Vali Loss: 2.847 Vali Acc: 0.180 Test Loss: 2.847 Test Acc: 0.180
Validation loss decreased (inf --> -0.179972).  Saving model ...
Epoch: 2 cost time: 1.69761323928833
Epoch: 2, Steps: 18 | Train Loss: 2.479 Vali Loss: 1.891 Vali Acc: 0.757 Test Loss: 1.891 Test Acc: 0.757
Validation loss decreased (-0.179972 --> -0.756648).  Saving model ...
Epoch: 3 cost time: 1.7722575664520264
Epoch: 3, Steps: 18 | Train Loss: 1.510 Vali Loss: 0.951 Vali Acc: 0.920 Test Loss: 0.951 Test Acc: 0.920
Validation loss decreased (-0.756648 --> -0.919990).  Saving model ...
Epoch: 4 cost time: 1.7153003215789795
Epoch: 4, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
Validation loss decreased (-0.919990 --> -0.949996).  Saving model ...
Epoch: 5 cost time: 1.589468002319336
Epoch: 5, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5888614654541016
Epoch: 6, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
Validation loss decreased (-0.949996 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 1.4891276359558105
Epoch: 7, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5570712089538574
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.6467576026916504
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.6108829975128174
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.523033618927002
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.499009609222412
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.558906078338623
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3320741653442383
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.438499927520752
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.5281455516815186
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.4866554737091064
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.5282704830169678
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.5627937316894531
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.61220383644104
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5409009456634521
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5876405239105225
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.5585980415344238
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.5506744384765625
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.6834206581115723
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.527721643447876
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.4992544651031494
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.6503455638885498
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.6204328536987305
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.431584119796753
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.3459093570709229
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.425553321838379
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.5264878273010254
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5903761386871338
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.571512222290039
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.673436164855957
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.4495952129364014
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5133190155029297
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.572192668914795
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.531590461730957
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4446072578430176
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.5698790550231934
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.6451780796051025
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.5328052043914795
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3557848930358887
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4728238582611084
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 120025
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.264369487762451
Epoch: 1, Steps: 18 | Train Loss: 3.230 Vali Loss: 2.962 Vali Acc: 0.177 Test Loss: 2.962 Test Acc: 0.177
Validation loss decreased (inf --> -0.176637).  Saving model ...
Epoch: 2 cost time: 1.5543015003204346
Epoch: 2, Steps: 18 | Train Loss: 2.800 Vali Loss: 2.322 Vali Acc: 0.593 Test Loss: 2.322 Test Acc: 0.593
Validation loss decreased (-0.176637 --> -0.593310).  Saving model ...
Epoch: 3 cost time: 1.5980298519134521
Epoch: 3, Steps: 18 | Train Loss: 2.036 Vali Loss: 1.556 Vali Acc: 0.883 Test Loss: 1.556 Test Acc: 0.883
Validation loss decreased (-0.593310 --> -0.883318).  Saving model ...
Epoch: 4 cost time: 1.5233302116394043
Epoch: 4, Steps: 18 | Train Loss: 1.311 Vali Loss: 0.871 Vali Acc: 0.923 Test Loss: 0.871 Test Acc: 0.923
Validation loss decreased (-0.883318 --> -0.923325).  Saving model ...
Epoch: 5 cost time: 1.6117398738861084
Epoch: 5, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.923325 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 1.4803030490875244
Epoch: 6, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.282 Vali Acc: 0.957 Test Loss: 0.282 Test Acc: 0.957
Validation loss decreased (-0.949995 --> -0.956664).  Saving model ...
Epoch: 7 cost time: 1.4792110919952393
Epoch: 7, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 1.5413153171539307
Epoch: 8, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 9 cost time: 1.5634303092956543
Epoch: 9, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 1.581749439239502
Epoch: 10, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 1.445406436920166
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 1.507429838180542
Epoch: 12, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 1.3983042240142822
Epoch: 13, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.237990379333496
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5407111644744873
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.5984792709350586
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.6474318504333496
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.6620533466339111
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.5667531490325928
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.659635066986084
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.5994391441345215
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.619062900543213
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.4743297100067139
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.7362844944000244
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.5722887516021729
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.654933214187622
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.602149248123169
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7251996994018555
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6075470447540283
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7328414916992188
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.823880672454834
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.7239606380462646
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.7526006698608398
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.6256005764007568
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.8349316120147705
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.752079725265503
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.846193790435791
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.7038180828094482
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.8800065517425537
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.5711560249328613
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.6204137802124023
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6996443271636963
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.6652374267578125
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.5935344696044922
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.4925148487091064
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.481107234954834
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.7552995681762695
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3944976329803467
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.4911980628967285
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.6198277473449707
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.8094635009765625
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.5371592044830322
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.646766185760498
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.6531360149383545
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.5922186374664307
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.560366153717041
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.6503350734710693
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.588221788406372
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.4884617328643799
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.5323505401611328
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.6813905239105225
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.5281634330749512
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.3026227951049805
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.4837374687194824
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.3443663120269775
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 1.4798152446746826
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.5894320011138916
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.4971108436584473
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.7890403270721436
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.6640794277191162
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 1.757310390472412
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.6969702243804932
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.7026903629302979
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 1.969163179397583
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 1.856893539428711
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 1.8917295932769775
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 1.851729154586792
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.9498217105865479
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 1.864952564239502
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 1.8710525035858154
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 1.8719472885131836
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.8158376216888428
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.7130928039550781
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.8855359554290771
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.970813274383545
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 1.878633737564087
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 2.012127637863159
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 88 cost time: 1.8969178199768066
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 89 cost time: 1.9444522857666016
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 2.019976854324341
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 91 cost time: 1.9724740982055664
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.9574034214019775
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.9154324531555176
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 94 cost time: 1.8681995868682861
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 95 cost time: 1.9478461742401123
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.810333013534546
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.8965458869934082
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 98 cost time: 1.8472208976745605
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 99 cost time: 1.7718021869659424
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.769301176071167
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 91449
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4329400062561035
Epoch: 1, Steps: 18 | Train Loss: 3.416 Vali Loss: 3.128 Vali Acc: 0.073 Test Loss: 3.128 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 1.8970913887023926
Epoch: 2, Steps: 18 | Train Loss: 2.950 Vali Loss: 2.501 Vali Acc: 0.463 Test Loss: 2.501 Test Acc: 0.463
Validation loss decreased (-0.073302 --> -0.463308).  Saving model ...
Epoch: 3 cost time: 1.8345484733581543
Epoch: 3, Steps: 18 | Train Loss: 2.281 Vali Loss: 1.738 Vali Acc: 0.797 Test Loss: 1.738 Test Acc: 0.797
Validation loss decreased (-0.463308 --> -0.796649).  Saving model ...
Epoch: 4 cost time: 1.8703296184539795
Epoch: 4, Steps: 18 | Train Loss: 1.445 Vali Loss: 0.999 Vali Acc: 0.907 Test Loss: 0.999 Test Acc: 0.907
Validation loss decreased (-0.796649 --> -0.906657).  Saving model ...
Epoch: 5 cost time: 1.7185416221618652
Epoch: 5, Steps: 18 | Train Loss: 0.792 Vali Loss: 0.526 Vali Acc: 0.947 Test Loss: 0.526 Test Acc: 0.947
Validation loss decreased (-0.906657 --> -0.946661).  Saving model ...
Epoch: 6 cost time: 1.8775935173034668
Epoch: 6, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.293 Vali Acc: 0.960 Test Loss: 0.293 Test Acc: 0.960
Validation loss decreased (-0.946661 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 1.9597110748291016
Epoch: 7, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.7844338417053223
Epoch: 8, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.7969717979431152
Epoch: 9, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.7973558902740479
Epoch: 10, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.7745182514190674
Epoch: 11, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.5790956020355225
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.5689473152160645
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6925890445709229
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.5383868217468262
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.7211146354675293
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.6544992923736572
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.6525673866271973
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.7211191654205322
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.793147087097168
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.723761796951294
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.6951489448547363
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.6647379398345947
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.732804775238037
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.7414145469665527
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.7503678798675537
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.907252311706543
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.8511075973510742
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6034071445465088
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.6238889694213867
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.61482834815979
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.6711854934692383
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.7621345520019531
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.8516762256622314
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.810988426208496
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.73372483253479
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.7100870609283447
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.8690693378448486
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.8518977165222168
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.9798502922058105
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.9056575298309326
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.777500867843628
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.8629522323608398
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8366336822509766
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.9045178890228271
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.6248242855072021
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.614833116531372
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8517887592315674
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.4217743873596191
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.7146222591400146
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.3674261569976807
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.6809208393096924
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.577319860458374
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.8038721084594727
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.7947049140930176
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.0228960514068604
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.9145052433013916
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 2.06314754486084
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.8225834369659424
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 2.145984172821045
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 2.0108602046966553
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.7798688411712646
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.7456603050231934
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.7129251956939697
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 2.0137360095977783
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.8470571041107178
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.8769562244415283
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 68 cost time: 1.7375431060791016
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 69 cost time: 2.0884411334991455
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.8536953926086426
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.8980646133422852
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.7197036743164062
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.8645365238189697
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.9686651229858398
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.6465816497802734
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.6052701473236084
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.4834985733032227
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.7480108737945557
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm32_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 84473
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8301475048065186
Epoch: 1, Steps: 18 | Train Loss: 3.129 Vali Loss: 2.322 Vali Acc: 0.583 Test Loss: 2.322 Test Acc: 0.583
Validation loss decreased (inf --> -0.583310).  Saving model ...
Epoch: 2 cost time: 2.069962978363037
Epoch: 2, Steps: 18 | Train Loss: 1.679 Vali Loss: 0.738 Vali Acc: 0.903 Test Loss: 0.738 Test Acc: 0.903
Validation loss decreased (-0.583310 --> -0.903326).  Saving model ...
Epoch: 3 cost time: 2.116752862930298
Epoch: 3, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.225 Vali Acc: 0.970 Test Loss: 0.225 Test Acc: 0.970
Validation loss decreased (-0.903326 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 2.1461453437805176
Epoch: 4, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 2.204387903213501
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1877779960632324
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 2.2145638465881348
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 2.003713607788086
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 2.061966896057129
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 2.183556079864502
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.114269733428955
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.168820858001709
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.9380109310150146
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9893152713775635
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.837026596069336
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.909876823425293
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0823493003845215
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 2.0240941047668457
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.133908271789551
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 2.227975606918335
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 2.1828699111938477
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 2.38594388961792
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 2.1651132106781006
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 2.310753345489502
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 2.1272480487823486
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 2.3561601638793945
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 2.18717360496521
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 2.2617974281311035
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 2.182061195373535
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0636608600616455
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 2.067929744720459
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0021462440490723
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1212549209594727
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.074723243713379
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 2.276099681854248
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 2.367766857147217
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 2.0982930660247803
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.9694323539733887
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9944121837615967
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.925863265991211
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.14206862449646
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.1892380714416504
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 2.1200499534606934
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.0550265312194824
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.2409605979919434
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 2.369072437286377
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.942854404449463
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.8831357955932617
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.9260306358337402
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.8444023132324219
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.0150082111358643
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.104546546936035
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.9999666213989258
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.0242416858673096
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.914313793182373
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.107891798019409
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.9594244956970215
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 2.0199508666992188
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.8093135356903076
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.8480415344238281
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.876589298248291
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.8856022357940674
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.8578476905822754
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.9193096160888672
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.7674720287322998
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 2.1094913482666016
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.8910574913024902
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 2.0155892372131348
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.1773500442504883
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.226024866104126
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.920471429824829
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 2.025041103363037
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.9275197982788086
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.8308768272399902
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 2.066439628601074
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.7667346000671387
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.9482896327972412
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 288169
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4192984104156494
Epoch: 1, Steps: 18 | Train Loss: 3.266 Vali Loss: 2.749 Vali Acc: 0.257 Test Loss: 2.749 Test Acc: 0.257
Validation loss decreased (inf --> -0.256639).  Saving model ...
Epoch: 2 cost time: 1.7818326950073242
Epoch: 2, Steps: 18 | Train Loss: 2.343 Vali Loss: 1.553 Vali Acc: 0.860 Test Loss: 1.553 Test Acc: 0.860
Validation loss decreased (-0.256639 --> -0.859984).  Saving model ...
Epoch: 3 cost time: 1.8450968265533447
Epoch: 3, Steps: 18 | Train Loss: 1.131 Vali Loss: 0.567 Vali Acc: 0.953 Test Loss: 0.567 Test Acc: 0.953
Validation loss decreased (-0.859984 --> -0.953328).  Saving model ...
Epoch: 4 cost time: 1.7586205005645752
Epoch: 4, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.246 Vali Acc: 0.967 Test Loss: 0.246 Test Acc: 0.967
Validation loss decreased (-0.953328 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 1.721644401550293
Epoch: 5, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.5967133045196533
Epoch: 6, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.5376195907592773
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.6519291400909424
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.7394936084747314
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.5826294422149658
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.5504014492034912
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.7896802425384521
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7341160774230957
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8742976188659668
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7248566150665283
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.7294135093688965
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.6846787929534912
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8922052383422852
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.7718207836151123
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8681678771972656
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.759345293045044
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.7391786575317383
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.7741410732269287
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.065201759338379
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.885063648223877
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.67445707321167
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.9240591526031494
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.983609676361084
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.957108974456787
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.8892700672149658
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.8752403259277344
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.948798418045044
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.8918774127960205
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 2.0466809272766113
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.950514554977417
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.115029811859131
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9693264961242676
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.9231579303741455
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.7687249183654785
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.891742467880249
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8664321899414062
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.9293544292449951
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 2.0997684001922607
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.853365421295166
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.6053738594055176
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.7470049858093262
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.6683177947998047
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.719038963317871
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.9440710544586182
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.8940021991729736
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8142871856689453
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.8801262378692627
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.767963171005249
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.9576919078826904
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.8785998821258545
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.795426845550537
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.6978659629821777
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.8108086585998535
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.9020411968231201
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.9673848152160645
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.9311795234680176
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.7026281356811523
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.6458208560943604
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.6516454219818115
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.6735541820526123
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.6247787475585938
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.8818840980529785
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 158633
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5193307399749756
Epoch: 1, Steps: 18 | Train Loss: 3.337 Vali Loss: 2.995 Vali Acc: 0.157 Test Loss: 2.995 Test Acc: 0.157
Validation loss decreased (inf --> -0.156637).  Saving model ...
Epoch: 2 cost time: 1.7591218948364258
Epoch: 2, Steps: 18 | Train Loss: 2.758 Vali Loss: 2.205 Vali Acc: 0.627 Test Loss: 2.205 Test Acc: 0.627
Validation loss decreased (-0.156637 --> -0.626645).  Saving model ...
Epoch: 3 cost time: 1.8325762748718262
Epoch: 3, Steps: 18 | Train Loss: 1.808 Vali Loss: 1.149 Vali Acc: 0.890 Test Loss: 1.149 Test Acc: 0.890
Validation loss decreased (-0.626645 --> -0.889989).  Saving model ...
Epoch: 4 cost time: 1.882002830505371
Epoch: 4, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.476 Vali Acc: 0.957 Test Loss: 0.476 Test Acc: 0.957
Validation loss decreased (-0.889989 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 1.7988905906677246
Epoch: 5, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.257 Vali Acc: 0.960 Test Loss: 0.257 Test Acc: 0.960
Validation loss decreased (-0.956662 --> -0.959997).  Saving model ...
Epoch: 6 cost time: 1.8442277908325195
Epoch: 6, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7266082763671875
Epoch: 7, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.7979981899261475
Epoch: 8, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.6321125030517578
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.7233467102050781
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 1.7097537517547607
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 1.67402982711792
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.78108811378479
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.8866755962371826
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.7370858192443848
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.7008695602416992
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.7152235507965088
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.6594264507293701
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.666346788406372
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.6588234901428223
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.7416141033172607
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.8413398265838623
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.6012191772460938
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.744016170501709
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.7400708198547363
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.5574965476989746
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.700014591217041
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.7049956321716309
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6138381958007812
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.402766227722168
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.733445405960083
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.7531933784484863
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.732023000717163
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.6692304611206055
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.630967378616333
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.6395645141601562
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.7526354789733887
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.7006428241729736
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.8020474910736084
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6807632446289062
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.7154717445373535
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.7290642261505127
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.622387170791626
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.6986401081085205
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.6750507354736328
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6216709613800049
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.5947175025939941
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5767018795013428
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.719184160232544
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.6484146118164062
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.6502494812011719
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.7691669464111328
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.6322920322418213
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.7162604331970215
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.535226821899414
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.837177038192749
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.6671175956726074
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.6551053524017334
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.4998798370361328
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.5836198329925537
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.6559278964996338
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.6784672737121582
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.7508816719055176
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.6231305599212646
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.658799648284912
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.6940546035766602
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.702685832977295
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.7468154430389404
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.7090482711791992
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.7859728336334229
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.6244988441467285
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 1.633906602859497
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 1.5104291439056396
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.5686862468719482
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.7504091262817383
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.6326706409454346
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.54461669921875
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.5661125183105469
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 1.5348434448242188
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 1.7563869953155518
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.738175630569458
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.8620498180389404
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.8401706218719482
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 84 cost time: 1.79931640625
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.7390954494476318
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.8686561584472656
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 87 cost time: 1.8454859256744385
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 2.012028932571411
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.811950445175171
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.7811503410339355
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.8997395038604736
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.8558320999145508
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.717848539352417
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.8564927577972412
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.8223371505737305
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 96 cost time: 1.9157681465148926
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.8129117488861084
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.937591791152954
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 99 cost time: 1.7726762294769287
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 100 cost time: 1.86497163772583
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 115481
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.351292371749878
Epoch: 1, Steps: 18 | Train Loss: 3.312 Vali Loss: 2.999 Vali Acc: 0.147 Test Loss: 2.999 Test Acc: 0.147
Validation loss decreased (inf --> -0.146637).  Saving model ...
Epoch: 2 cost time: 1.774484634399414
Epoch: 2, Steps: 18 | Train Loss: 2.806 Vali Loss: 2.338 Vali Acc: 0.570 Test Loss: 2.338 Test Acc: 0.570
Validation loss decreased (-0.146637 --> -0.569977).  Saving model ...
Epoch: 3 cost time: 1.7243242263793945
Epoch: 3, Steps: 18 | Train Loss: 2.098 Vali Loss: 1.499 Vali Acc: 0.867 Test Loss: 1.499 Test Acc: 0.867
Validation loss decreased (-0.569977 --> -0.866652).  Saving model ...
Epoch: 4 cost time: 1.682736873626709
Epoch: 4, Steps: 18 | Train Loss: 1.194 Vali Loss: 0.794 Vali Acc: 0.937 Test Loss: 0.794 Test Acc: 0.937
Validation loss decreased (-0.866652 --> -0.936659).  Saving model ...
Epoch: 5 cost time: 1.7645001411437988
Epoch: 5, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.398 Vali Acc: 0.957 Test Loss: 0.398 Test Acc: 0.957
Validation loss decreased (-0.936659 --> -0.956663).  Saving model ...
Epoch: 6 cost time: 1.833310842514038
Epoch: 6, Steps: 18 | Train Loss: 0.268 Vali Loss: 0.247 Vali Acc: 0.967 Test Loss: 0.247 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 1.794417381286621
Epoch: 7, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8820006847381592
Epoch: 8, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.6970012187957764
Epoch: 9, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.7190182209014893
Epoch: 10, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.55289888381958
Epoch: 11, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8375921249389648
Epoch: 12, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.910440444946289
Epoch: 13, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.7304213047027588
Epoch: 14, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.696692943572998
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.7763972282409668
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.7518408298492432
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.73014235496521
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6618540287017822
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.5993897914886475
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.7142486572265625
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.547555685043335
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.584028720855713
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3918030261993408
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.683258056640625
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.620635986328125
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.7196111679077148
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.5108411312103271
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.7132799625396729
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.8709704875946045
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.74643874168396
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7149300575256348
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8319637775421143
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.5836453437805176
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.7477824687957764
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.8206734657287598
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.539564609527588
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.6494152545928955
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.643716812133789
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.558377742767334
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6908164024353027
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.6816232204437256
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.523303508758545
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.5346403121948242
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.6219351291656494
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7343769073486328
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.6673872470855713
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.5545499324798584
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.685459852218628
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.6167070865631104
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.7344279289245605
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.5798282623291016
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.701995611190796
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.4543697834014893
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.5741491317749023
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.5527019500732422
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.6341290473937988
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.6473150253295898
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.5053296089172363
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.5312473773956299
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.49979829788208
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.7030746936798096
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.6333281993865967
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.649383544921875
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.6534454822540283
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.7072336673736572
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.5732645988464355
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.6870982646942139
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.6213583946228027
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.677267074584961
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.4293129444122314
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.5449178218841553
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.5914347171783447
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.4859910011291504
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.6553428173065186
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.5752837657928467
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.5146417617797852
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.5440866947174072
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.5953152179718018
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.473057746887207
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.5885398387908936
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.5789318084716797
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.5807948112487793
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.619903326034546
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.5447075366973877
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.647667646408081
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.3877394199371338
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.5586597919464111
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.5322535037994385
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.533684492111206
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.4409780502319336
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.5048861503601074
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 1.514204502105713
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.582608938217163
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.6248018741607666
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.5386884212493896
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.56880784034729
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.6840054988861084
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.5845146179199219
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.6042897701263428
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 93945
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1084377765655518
Epoch: 1, Steps: 18 | Train Loss: 3.337 Vali Loss: 3.101 Vali Acc: 0.137 Test Loss: 3.101 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 1.4367380142211914
Epoch: 2, Steps: 18 | Train Loss: 2.905 Vali Loss: 2.548 Vali Acc: 0.377 Test Loss: 2.548 Test Acc: 0.377
Validation loss decreased (-0.136636 --> -0.376641).  Saving model ...
Epoch: 3 cost time: 1.3548352718353271
Epoch: 3, Steps: 18 | Train Loss: 2.271 Vali Loss: 1.813 Vali Acc: 0.727 Test Loss: 1.813 Test Acc: 0.727
Validation loss decreased (-0.376641 --> -0.726649).  Saving model ...
Epoch: 4 cost time: 1.5084340572357178
Epoch: 4, Steps: 18 | Train Loss: 1.517 Vali Loss: 1.100 Vali Acc: 0.867 Test Loss: 1.100 Test Acc: 0.867
Validation loss decreased (-0.726649 --> -0.866656).  Saving model ...
Epoch: 5 cost time: 1.5628809928894043
Epoch: 5, Steps: 18 | Train Loss: 0.860 Vali Loss: 0.613 Vali Acc: 0.947 Test Loss: 0.613 Test Acc: 0.947
Validation loss decreased (-0.866656 --> -0.946661).  Saving model ...
Epoch: 6 cost time: 1.4751818180084229
Epoch: 6, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.362 Vali Acc: 0.967 Test Loss: 0.362 Test Acc: 0.967
Validation loss decreased (-0.946661 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 1.2613060474395752
Epoch: 7, Steps: 18 | Train Loss: 0.256 Vali Loss: 0.259 Vali Acc: 0.967 Test Loss: 0.259 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 1.6369919776916504
Epoch: 8, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.206 Vali Acc: 0.973 Test Loss: 0.206 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 9 cost time: 1.5263147354125977
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.173 Vali Acc: 0.977 Test Loss: 0.173 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.5361297130584717
Epoch: 10, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.7001302242279053
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6133527755737305
Epoch: 12, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.5792715549468994
Epoch: 13, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.923208475112915
Epoch: 14, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.9395174980163574
Epoch: 15, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8990719318389893
Epoch: 16, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8145420551300049
Epoch: 17, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.8363137245178223
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.9162836074829102
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.792052984237671
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.863748550415039
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.796644687652588
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.7794623374938965
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.720865249633789
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.9063825607299805
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.815643310546875
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.9220726490020752
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.8558032512664795
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.8399040699005127
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.830029010772705
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.8000423908233643
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.9192397594451904
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.8808138370513916
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.8031206130981445
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.8601601123809814
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.8884413242340088
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.8224129676818848
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.6345880031585693
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.7530279159545898
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.7092335224151611
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8154101371765137
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.8685181140899658
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 1.7066612243652344
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.8206970691680908
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.7627758979797363
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.883613109588623
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.9241337776184082
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.7361688613891602
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.8579394817352295
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.9006731510162354
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.8911349773406982
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.9817235469818115
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.7888617515563965
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.3065736293792725
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.5076730251312256
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.5005261898040771
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.4817531108856201
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.911863088607788
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.6439979076385498
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.8692641258239746
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.8963909149169922
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.8554463386535645
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.8427190780639648
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.8893299102783203
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.6913487911224365
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.728872537612915
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.8123128414154053
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.6806299686431885
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 2.002295732498169
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.921443223953247
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.835341215133667
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.7743470668792725
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.9683201313018799
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.7024626731872559
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.769904375076294
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.6491456031799316
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.8670055866241455
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.6491899490356445
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.7246487140655518
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.7896556854248047
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.828707218170166
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.5645554065704346
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.6217522621154785
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.6392359733581543
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.5347166061401367
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.8232855796813965
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.7732782363891602
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 1.7880377769470215
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 1.897618293762207
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.697890281677246
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.6374330520629883
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.8700358867645264
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.6835827827453613
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.692366123199463
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.485673189163208
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.7017173767089844
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.9238643646240234
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.6493542194366455
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.6906585693359375
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.714043378829956
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 76057
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0109505653381348
Epoch: 1, Steps: 18 | Train Loss: 3.285 Vali Loss: 3.153 Vali Acc: 0.070 Test Loss: 3.153 Test Acc: 0.070
Validation loss decreased (inf --> -0.069968).  Saving model ...
Epoch: 2 cost time: 1.465527057647705
Epoch: 2, Steps: 18 | Train Loss: 3.006 Vali Loss: 2.753 Vali Acc: 0.293 Test Loss: 2.753 Test Acc: 0.293
Validation loss decreased (-0.069968 --> -0.293306).  Saving model ...
Epoch: 3 cost time: 1.341186285018921
Epoch: 3, Steps: 18 | Train Loss: 2.501 Vali Loss: 2.189 Vali Acc: 0.573 Test Loss: 2.189 Test Acc: 0.573
Validation loss decreased (-0.293306 --> -0.573311).  Saving model ...
Epoch: 4 cost time: 1.430182933807373
Epoch: 4, Steps: 18 | Train Loss: 1.998 Vali Loss: 1.560 Vali Acc: 0.807 Test Loss: 1.560 Test Acc: 0.807
Validation loss decreased (-0.573311 --> -0.806651).  Saving model ...
Epoch: 5 cost time: 1.359281063079834
Epoch: 5, Steps: 18 | Train Loss: 1.289 Vali Loss: 1.016 Vali Acc: 0.900 Test Loss: 1.016 Test Acc: 0.900
Validation loss decreased (-0.806651 --> -0.899990).  Saving model ...
Epoch: 6 cost time: 1.4185025691986084
Epoch: 6, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.639 Vali Acc: 0.933 Test Loss: 0.639 Test Acc: 0.933
Validation loss decreased (-0.899990 --> -0.933327).  Saving model ...
Epoch: 7 cost time: 1.6628193855285645
Epoch: 7, Steps: 18 | Train Loss: 0.462 Vali Loss: 0.425 Vali Acc: 0.960 Test Loss: 0.425 Test Acc: 0.960
Validation loss decreased (-0.933327 --> -0.959996).  Saving model ...
Epoch: 8 cost time: 1.6582529544830322
Epoch: 8, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.316 Vali Acc: 0.963 Test Loss: 0.316 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 1.4712843894958496
Epoch: 9, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 1.427541971206665
Epoch: 10, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.225 Vali Acc: 0.970 Test Loss: 0.225 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 1.6718955039978027
Epoch: 11, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 1.5503430366516113
Epoch: 12, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 1.4807019233703613
Epoch: 13, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 1.6790311336517334
Epoch: 14, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 1.452317476272583
Epoch: 15, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 1.545459508895874
Epoch: 16, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 1.613215684890747
Epoch: 17, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 1.6138660907745361
Epoch: 18, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 1.4028472900390625
Epoch: 19, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 1.3894727230072021
Epoch: 20, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 1.5907726287841797
Epoch: 21, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 1.4605515003204346
Epoch: 22, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.4783070087432861
Epoch: 23, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.4569530487060547
Epoch: 24, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.4974913597106934
Epoch: 25, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.4575531482696533
Epoch: 26, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.3042876720428467
Epoch: 27, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.3283002376556396
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.6212785243988037
Epoch: 29, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.567777395248413
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.4435069561004639
Epoch: 31, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.474935531616211
Epoch: 32, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.359893798828125
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.3206961154937744
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.6561293601989746
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.7325091361999512
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.7028782367706299
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.5649797916412354
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.6220386028289795
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.4890038967132568
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.4336917400360107
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.538616418838501
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.76542329788208
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.0298430919647217
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.6986110210418701
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.6827936172485352
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.7845337390899658
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.4479830265045166
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.5809762477874756
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4370832443237305
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.3865282535552979
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.661670207977295
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.529477596282959
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.5706398487091064
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.7292046546936035
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.585618257522583
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.8679783344268799
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.6670873165130615
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.6690943241119385
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.61885666847229
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.470686912536621
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.5324757099151611
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.510221242904663
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.6733415126800537
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.6732511520385742
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.6467258930206299
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.4994900226593018
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.6915736198425293
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.6054718494415283
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.6208593845367432
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.679232120513916
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.605220079421997
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.5851831436157227
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.4385595321655273
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.5281624794006348
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.5182538032531738
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.4245119094848633
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.4872825145721436
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.4604332447052002
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.9367353916168213
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.826078176498413
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 1.7832908630371094
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.9483723640441895
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.5983479022979736
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.8868701457977295
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.8392715454101562
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.6908910274505615
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.8228709697723389
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.9096176624298096
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.629058599472046
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.7578802108764648
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.8121614456176758
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.8179221153259277
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.7841722965240479
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.8727543354034424
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.7893519401550293
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 1.6471667289733887
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.9096825122833252
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.9265317916870117
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.6166505813598633
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 61769
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.211670160293579
Epoch: 1, Steps: 18 | Train Loss: 3.454 Vali Loss: 3.215 Vali Acc: 0.083 Test Loss: 3.215 Test Acc: 0.083
Validation loss decreased (inf --> -0.083301).  Saving model ...
Epoch: 2 cost time: 1.7322654724121094
Epoch: 2, Steps: 18 | Train Loss: 3.158 Vali Loss: 2.828 Vali Acc: 0.253 Test Loss: 2.828 Test Acc: 0.253
Validation loss decreased (-0.083301 --> -0.253305).  Saving model ...
Epoch: 3 cost time: 1.749668836593628
Epoch: 3, Steps: 18 | Train Loss: 2.702 Vali Loss: 2.308 Vali Acc: 0.577 Test Loss: 2.308 Test Acc: 0.577
Validation loss decreased (-0.253305 --> -0.576644).  Saving model ...
Epoch: 4 cost time: 1.7049574851989746
Epoch: 4, Steps: 18 | Train Loss: 2.153 Vali Loss: 1.706 Vali Acc: 0.787 Test Loss: 1.706 Test Acc: 0.787
Validation loss decreased (-0.576644 --> -0.786650).  Saving model ...
Epoch: 5 cost time: 1.5321319103240967
Epoch: 5, Steps: 18 | Train Loss: 1.554 Vali Loss: 1.157 Vali Acc: 0.883 Test Loss: 1.157 Test Acc: 0.883
Validation loss decreased (-0.786650 --> -0.883322).  Saving model ...
Epoch: 6 cost time: 1.7187063694000244
Epoch: 6, Steps: 18 | Train Loss: 0.984 Vali Loss: 0.743 Vali Acc: 0.930 Test Loss: 0.743 Test Acc: 0.930
Validation loss decreased (-0.883322 --> -0.929993).  Saving model ...
Epoch: 7 cost time: 1.699760913848877
Epoch: 7, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.498 Vali Acc: 0.947 Test Loss: 0.498 Test Acc: 0.947
Validation loss decreased (-0.929993 --> -0.946662).  Saving model ...
Epoch: 8 cost time: 1.614013433456421
Epoch: 8, Steps: 18 | Train Loss: 0.368 Vali Loss: 0.356 Vali Acc: 0.957 Test Loss: 0.356 Test Acc: 0.957
Validation loss decreased (-0.946662 --> -0.956663).  Saving model ...
Epoch: 9 cost time: 1.6951544284820557
Epoch: 9, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.282 Vali Acc: 0.960 Test Loss: 0.282 Test Acc: 0.960
Validation loss decreased (-0.956663 --> -0.959997).  Saving model ...
Epoch: 10 cost time: 1.659703016281128
Epoch: 10, Steps: 18 | Train Loss: 0.177 Vali Loss: 0.236 Vali Acc: 0.963 Test Loss: 0.236 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 1.7320215702056885
Epoch: 11, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 12 cost time: 1.7873570919036865
Epoch: 12, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 1.7622132301330566
Epoch: 13, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.5835530757904053
Epoch: 14, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.6802716255187988
Epoch: 15, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.8157844543457031
Epoch: 16, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.5582301616668701
Epoch: 17, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.6702156066894531
Epoch: 18, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.7036244869232178
Epoch: 19, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.6954431533813477
Epoch: 20, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.5840392112731934
Epoch: 21, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.4505302906036377
Epoch: 22, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.3709168434143066
Epoch: 23, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.3818418979644775
Epoch: 24, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.3049585819244385
Epoch: 25, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.3875846862792969
Epoch: 26, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.5856046676635742
Epoch: 27, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.4956254959106445
Epoch: 28, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.603182077407837
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.5328068733215332
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.4900622367858887
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.6077497005462646
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.5095584392547607
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.7266795635223389
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.6065521240234375
Epoch: 35, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.7154858112335205
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.457322597503662
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.6331086158752441
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.430657148361206
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.6972272396087646
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.6644036769866943
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.7079670429229736
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.462005615234375
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.6316735744476318
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.5141651630401611
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.6038568019866943
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.4077224731445312
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.4789602756500244
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.4213643074035645
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.4744861125946045
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.4311175346374512
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.6118311882019043
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.4487419128417969
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.6558992862701416
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.5538952350616455
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.5077223777770996
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.5331594944000244
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.6897649765014648
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.711951732635498
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.8330802917480469
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.7637965679168701
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 62 cost time: 1.6838321685791016
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 63 cost time: 1.4973828792572021
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 64 cost time: 1.7354710102081299
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 65 cost time: 1.5821082592010498
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.5188884735107422
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.701969861984253
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 68 cost time: 1.527113914489746
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.5786387920379639
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.511103630065918
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.5235810279846191
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.4975085258483887
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.7492892742156982
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.5860874652862549
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.6423704624176025
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.801673412322998
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.6412270069122314
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 58281
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.478602647781372
Epoch: 1, Steps: 18 | Train Loss: 3.206 Vali Loss: 2.460 Vali Acc: 0.490 Test Loss: 2.460 Test Acc: 0.490
Validation loss decreased (inf --> -0.489975).  Saving model ...
Epoch: 2 cost time: 1.7594432830810547
Epoch: 2, Steps: 18 | Train Loss: 1.905 Vali Loss: 0.916 Vali Acc: 0.927 Test Loss: 0.916 Test Acc: 0.927
Validation loss decreased (-0.489975 --> -0.926658).  Saving model ...
Epoch: 3 cost time: 1.7804455757141113
Epoch: 3, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.268 Vali Acc: 0.963 Test Loss: 0.268 Test Acc: 0.963
Validation loss decreased (-0.926658 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.9202513694763184
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.963331 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.8012430667877197
Epoch: 5, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7784423828125
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.924180269241333
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0271995067596436
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7416789531707764
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7681424617767334
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.695941686630249
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6756954193115234
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5567834377288818
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6836395263671875
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 275497
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.133941888809204
Epoch: 1, Steps: 18 | Train Loss: 3.210 Vali Loss: 2.777 Vali Acc: 0.290 Test Loss: 2.777 Test Acc: 0.290
Validation loss decreased (inf --> -0.289972).  Saving model ...
Epoch: 2 cost time: 1.6479990482330322
Epoch: 2, Steps: 18 | Train Loss: 2.309 Vali Loss: 1.620 Vali Acc: 0.820 Test Loss: 1.620 Test Acc: 0.820
Validation loss decreased (-0.289972 --> -0.819984).  Saving model ...
Epoch: 3 cost time: 1.6364095211029053
Epoch: 3, Steps: 18 | Train Loss: 1.171 Vali Loss: 0.650 Vali Acc: 0.930 Test Loss: 0.650 Test Acc: 0.930
Validation loss decreased (-0.819984 --> -0.929993).  Saving model ...
Epoch: 4 cost time: 1.764314889907837
Epoch: 4, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.282 Vali Acc: 0.947 Test Loss: 0.282 Test Acc: 0.947
Validation loss decreased (-0.929993 --> -0.946664).  Saving model ...
Epoch: 5 cost time: 1.5420992374420166
Epoch: 5, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.946664 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.7412300109863281
Epoch: 6, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.637169599533081
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.6282157897949219
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.6757168769836426
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.634279727935791
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.597517490386963
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.6088883876800537
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.699340581893921
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.721463680267334
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.6568527221679688
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.5426537990570068
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.7529375553131104
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.585235834121704
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.4893674850463867
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.5311980247497559
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.6279377937316895
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.8261528015136719
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.8870811462402344
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.8120718002319336
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.700984001159668
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.5854671001434326
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.5778861045837402
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.7639248371124268
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.7276968955993652
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.7703356742858887
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.7763309478759766
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.801889181137085
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.6431243419647217
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.5134804248809814
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.6234745979309082
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.556614875793457
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.5770812034606934
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.627795696258545
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7537217140197754
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.689225435256958
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.6484074592590332
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.7717704772949219
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5305583477020264
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5419433116912842
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.6008853912353516
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6453568935394287
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.7124757766723633
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.7256648540496826
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.5614798069000244
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.690425157546997
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.731879472732544
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.6022021770477295
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.8872981071472168
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.7283976078033447
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.5449438095092773
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.9198203086853027
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.7405738830566406
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.7753894329071045
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.6627240180969238
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.668229579925537
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.8242990970611572
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.8588159084320068
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.8743164539337158
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.9203953742980957
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.7487328052520752
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.892256259918213
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.9306809902191162
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.9675805568695068
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.9375078678131104
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.937889575958252
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 1.9915392398834229
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 1.9659109115600586
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.6886425018310547
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 2.023367166519165
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 1.5826029777526855
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 1.9172921180725098
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 1.8586761951446533
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.748213291168213
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 1.818518877029419
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.8251309394836426
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 1.5236179828643799
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.972841739654541
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.616668939590454
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 84 cost time: 1.8120830059051514
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.9936556816101074
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.8218719959259033
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.906376600265503
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.9428346157073975
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 89 cost time: 1.6528842449188232
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 2.0071587562561035
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.748335838317871
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 92 cost time: 1.9568195343017578
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.6048188209533691
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.4816842079162598
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 1.5394105911254883
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 1.5075898170471191
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 1.6974618434906006
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 1.7781455516815186
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 1.750441312789917
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 100 cost time: 1.9471964836120605
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 145961
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.316006660461426
Epoch: 1, Steps: 18 | Train Loss: 3.401 Vali Loss: 3.027 Vali Acc: 0.123 Test Loss: 3.027 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 1.4157171249389648
Epoch: 2, Steps: 18 | Train Loss: 2.778 Vali Loss: 2.293 Vali Acc: 0.613 Test Loss: 2.293 Test Acc: 0.613
Validation loss decreased (-0.123303 --> -0.613310).  Saving model ...
Epoch: 3 cost time: 1.6370060443878174
Epoch: 3, Steps: 18 | Train Loss: 1.969 Vali Loss: 1.396 Vali Acc: 0.883 Test Loss: 1.396 Test Acc: 0.883
Validation loss decreased (-0.613310 --> -0.883319).  Saving model ...
Epoch: 4 cost time: 1.609755516052246
Epoch: 4, Steps: 18 | Train Loss: 1.080 Vali Loss: 0.680 Vali Acc: 0.930 Test Loss: 0.680 Test Acc: 0.930
Validation loss decreased (-0.883319 --> -0.929993).  Saving model ...
Epoch: 5 cost time: 1.630655288696289
Epoch: 5, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.346 Vali Acc: 0.960 Test Loss: 0.346 Test Acc: 0.960
Validation loss decreased (-0.929993 --> -0.959997).  Saving model ...
Epoch: 6 cost time: 1.4807121753692627
Epoch: 6, Steps: 18 | Train Loss: 0.190 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.686208724975586
Epoch: 7, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.8390398025512695
Epoch: 8, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.5623118877410889
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.788597583770752
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.5735728740692139
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.5945887565612793
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.4057536125183105
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3898656368255615
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.832756757736206
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5062808990478516
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5654323101043701
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.4361178874969482
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.7045471668243408
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5678706169128418
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4955613613128662
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3908586502075195
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.6123895645141602
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.60477614402771
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.395395040512085
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.3883907794952393
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.385737419128418
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.4672632217407227
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.5012998580932617
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.4779491424560547
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.5068657398223877
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6193208694458008
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.460259199142456
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5643739700317383
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4776279926300049
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6634132862091064
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.5726497173309326
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5740180015563965
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6472358703613281
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.703758716583252
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.7510497570037842
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.4987859725952148
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6582539081573486
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.4694163799285889
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.4741976261138916
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4136335849761963
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.447244644165039
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.4862210750579834
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.3690552711486816
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.4675276279449463
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.646690845489502
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.57869553565979
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.5019962787628174
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.4917550086975098
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 102809
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.414846658706665
Epoch: 1, Steps: 18 | Train Loss: 3.266 Vali Loss: 2.991 Vali Acc: 0.140 Test Loss: 2.991 Test Acc: 0.140
Validation loss decreased (inf --> -0.139970).  Saving model ...
Epoch: 2 cost time: 1.3207664489746094
Epoch: 2, Steps: 18 | Train Loss: 2.773 Vali Loss: 2.326 Vali Acc: 0.587 Test Loss: 2.326 Test Acc: 0.587
Validation loss decreased (-0.139970 --> -0.586643).  Saving model ...
Epoch: 3 cost time: 1.3181915283203125
Epoch: 3, Steps: 18 | Train Loss: 2.054 Vali Loss: 1.504 Vali Acc: 0.853 Test Loss: 1.504 Test Acc: 0.853
Validation loss decreased (-0.586643 --> -0.853318).  Saving model ...
Epoch: 4 cost time: 1.5077626705169678
Epoch: 4, Steps: 18 | Train Loss: 1.196 Vali Loss: 0.787 Vali Acc: 0.923 Test Loss: 0.787 Test Acc: 0.923
Validation loss decreased (-0.853318 --> -0.923325).  Saving model ...
Epoch: 5 cost time: 1.3630633354187012
Epoch: 5, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.408 Vali Acc: 0.937 Test Loss: 0.408 Test Acc: 0.937
Validation loss decreased (-0.923325 --> -0.936663).  Saving model ...
Epoch: 6 cost time: 1.4181849956512451
Epoch: 6, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
Validation loss decreased (-0.936663 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 1.407456636428833
Epoch: 7, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.5930285453796387
Epoch: 8, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5060827732086182
Epoch: 9, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.429677963256836
Epoch: 10, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.576979637145996
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.5888831615447998
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4448738098144531
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.2413227558135986
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.310926914215088
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.3190641403198242
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.3192169666290283
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.3787269592285156
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2998783588409424
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4100141525268555
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5502896308898926
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6875784397125244
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.6409642696380615
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.3696544170379639
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.3962438106536865
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.3598213195800781
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.322558879852295
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.454874038696289
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.5272161960601807
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.442857265472412
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.394515037536621
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.4375698566436768
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.378920316696167
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.3447012901306152
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6056792736053467
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.4884026050567627
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.6197538375854492
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.6286423206329346
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.5444300174713135
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.4616785049438477
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.5361113548278809
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.5287625789642334
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.562302589416504
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.5207653045654297
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.5302720069885254
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.4419384002685547
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.2264678478240967
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.2364258766174316
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.2764878273010254
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.2987635135650635
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.4440929889678955
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.5339221954345703
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.3818023204803467
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.4694266319274902
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.4704110622406006
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.515805959701538
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.5070288181304932
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.553175926208496
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.4660484790802002
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.4623384475708008
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.435476541519165
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.507267713546753
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.4536185264587402
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.476513385772705
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.3512365818023682
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 1.469191074371338
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.4794714450836182
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.489729881286621
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.7587974071502686
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.813202142715454
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.7362711429595947
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 1.817641258239746
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 1.7568271160125732
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 1.6694345474243164
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.7180769443511963
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.6595649719238281
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.7298791408538818
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.6913230419158936
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.6114299297332764
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.8296775817871094
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.7354156970977783
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 1.6021816730499268
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 1.838942289352417
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.875058889389038
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 85 cost time: 1.6291770935058594
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 1.6401035785675049
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 87 cost time: 1.676943302154541
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.6372265815734863
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.6325807571411133
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 90 cost time: 1.6681435108184814
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 91 cost time: 1.660336971282959
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.6884446144104004
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.79864501953125
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.6799299716949463
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.6588149070739746
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 96 cost time: 1.6810097694396973
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 97 cost time: 1.572305679321289
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 98 cost time: 1.7024962902069092
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.7098631858825684
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.503185510635376
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 81273
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.664651393890381
Epoch: 1, Steps: 18 | Train Loss: 3.426 Vali Loss: 3.183 Vali Acc: 0.057 Test Loss: 3.183 Test Acc: 0.057
Validation loss decreased (inf --> -0.056635).  Saving model ...
Epoch: 2 cost time: 1.4207179546356201
Epoch: 2, Steps: 18 | Train Loss: 2.964 Vali Loss: 2.663 Vali Acc: 0.330 Test Loss: 2.663 Test Acc: 0.330
Validation loss decreased (-0.056635 --> -0.329973).  Saving model ...
Epoch: 3 cost time: 1.677847146987915
Epoch: 3, Steps: 18 | Train Loss: 2.408 Vali Loss: 1.970 Vali Acc: 0.683 Test Loss: 1.970 Test Acc: 0.683
Validation loss decreased (-0.329973 --> -0.683314).  Saving model ...
Epoch: 4 cost time: 1.501593828201294
Epoch: 4, Steps: 18 | Train Loss: 1.664 Vali Loss: 1.252 Vali Acc: 0.873 Test Loss: 1.252 Test Acc: 0.873
Validation loss decreased (-0.683314 --> -0.873321).  Saving model ...
Epoch: 5 cost time: 1.564579725265503
Epoch: 5, Steps: 18 | Train Loss: 0.973 Vali Loss: 0.711 Vali Acc: 0.933 Test Loss: 0.711 Test Acc: 0.933
Validation loss decreased (-0.873321 --> -0.933326).  Saving model ...
Epoch: 6 cost time: 1.6390063762664795
Epoch: 6, Steps: 18 | Train Loss: 0.528 Vali Loss: 0.416 Vali Acc: 0.953 Test Loss: 0.416 Test Acc: 0.953
Validation loss decreased (-0.933326 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 1.4790165424346924
Epoch: 7, Steps: 18 | Train Loss: 0.267 Vali Loss: 0.276 Vali Acc: 0.967 Test Loss: 0.276 Test Acc: 0.967
Validation loss decreased (-0.953329 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 1.7012064456939697
Epoch: 8, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.5367562770843506
Epoch: 9, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 1.4946269989013672
Epoch: 10, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.4939727783203125
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.5549595355987549
Epoch: 12, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.6410527229309082
Epoch: 13, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.3395726680755615
Epoch: 14, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.6583571434020996
Epoch: 15, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 1.6284947395324707
Epoch: 16, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.5908937454223633
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5265519618988037
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.4376130104064941
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.6553058624267578
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.5048658847808838
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.3795192241668701
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.3295507431030273
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.4648427963256836
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.2871253490447998
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.276538610458374
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.5373485088348389
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.601104974746704
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6759731769561768
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.8213646411895752
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.5669124126434326
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.642146348953247
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.6186532974243164
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.581000804901123
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.5007662773132324
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.6456711292266846
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.4736194610595703
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4746830463409424
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.5596511363983154
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.4175348281860352
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.4204447269439697
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.601273775100708
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.4152114391326904
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.5566673278808594
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6423962116241455
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.5747478008270264
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.4192681312561035
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3915364742279053
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3897225856781006
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.2309184074401855
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.3994722366333008
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.6691877841949463
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.8118743896484375
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.5946803092956543
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.4646449089050293
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.4290361404418945
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.7281720638275146
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.423738718032837
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.4319517612457275
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.48630690574646
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.5950031280517578
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.5106925964355469
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.5495855808258057
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.5607268810272217
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.6242833137512207
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 1.5443572998046875
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 1.4875710010528564
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.4079303741455078
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 1.7103748321533203
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.4971325397491455
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 1.5256001949310303
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 1.4600131511688232
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.5114107131958008
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.2615163326263428
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 1.422943115234375
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.3535592555999756
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.4360740184783936
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.452700138092041
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.5628514289855957
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 1.3264362812042236
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 1.579526424407959
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 1.3724443912506104
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 1.4041974544525146
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.3541507720947266
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.4406449794769287
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 1.4203660488128662
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 87 cost time: 1.615797519683838
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 88 cost time: 1.7574946880340576
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.5032336711883545
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 90 cost time: 1.4465208053588867
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 91 cost time: 1.335923671722412
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 92 cost time: 1.4425146579742432
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.5070266723632812
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 94 cost time: 1.4167277812957764
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 95 cost time: 1.5081665515899658
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 96 cost time: 1.4419596195220947
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 97 cost time: 1.639554500579834
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.4273896217346191
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 1.4450225830078125
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.4473464488983154
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 63385
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.003523588180542
Epoch: 1, Steps: 18 | Train Loss: 3.331 Vali Loss: 3.158 Vali Acc: 0.100 Test Loss: 3.158 Test Acc: 0.100
Validation loss decreased (inf --> -0.099968).  Saving model ...
Epoch: 2 cost time: 1.3263955116271973
Epoch: 2, Steps: 18 | Train Loss: 3.039 Vali Loss: 2.797 Vali Acc: 0.260 Test Loss: 2.797 Test Acc: 0.260
Validation loss decreased (-0.099968 --> -0.259972).  Saving model ...
Epoch: 3 cost time: 1.3335685729980469
Epoch: 3, Steps: 18 | Train Loss: 2.636 Vali Loss: 2.299 Vali Acc: 0.520 Test Loss: 2.299 Test Acc: 0.520
Validation loss decreased (-0.259972 --> -0.519977).  Saving model ...
Epoch: 4 cost time: 1.2971339225769043
Epoch: 4, Steps: 18 | Train Loss: 2.072 Vali Loss: 1.715 Vali Acc: 0.780 Test Loss: 1.715 Test Acc: 0.780
Validation loss decreased (-0.519977 --> -0.779983).  Saving model ...
Epoch: 5 cost time: 1.2524025440216064
Epoch: 5, Steps: 18 | Train Loss: 1.506 Vali Loss: 1.164 Vali Acc: 0.890 Test Loss: 1.164 Test Acc: 0.890
Validation loss decreased (-0.779983 --> -0.889988).  Saving model ...
Epoch: 6 cost time: 1.309391736984253
Epoch: 6, Steps: 18 | Train Loss: 0.963 Vali Loss: 0.729 Vali Acc: 0.953 Test Loss: 0.729 Test Acc: 0.953
Validation loss decreased (-0.889988 --> -0.953326).  Saving model ...
Epoch: 7 cost time: 1.364142656326294
Epoch: 7, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.460 Vali Acc: 0.963 Test Loss: 0.460 Test Acc: 0.963
Validation loss decreased (-0.953326 --> -0.963329).  Saving model ...
Epoch: 8 cost time: 1.403773546218872
Epoch: 8, Steps: 18 | Train Loss: 0.340 Vali Loss: 0.322 Vali Acc: 0.973 Test Loss: 0.322 Test Acc: 0.973
Validation loss decreased (-0.963329 --> -0.973330).  Saving model ...
Epoch: 9 cost time: 1.4398014545440674
Epoch: 9, Steps: 18 | Train Loss: 0.205 Vali Loss: 0.256 Vali Acc: 0.977 Test Loss: 0.256 Test Acc: 0.977
Validation loss decreased (-0.973330 --> -0.976664).  Saving model ...
Epoch: 10 cost time: 1.4852423667907715
Epoch: 10, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.214 Vali Acc: 0.977 Test Loss: 0.214 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.452749252319336
Epoch: 11, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.183 Vali Acc: 0.977 Test Loss: 0.183 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.526787519454956
Epoch: 12, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.5670244693756104
Epoch: 13, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.3204216957092285
Epoch: 14, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.983 Test Loss: 0.143 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.417492389678955
Epoch: 15, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4207634925842285
Epoch: 16, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5795109272003174
Epoch: 17, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4312076568603516
Epoch: 18, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3248398303985596
Epoch: 19, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.5364010334014893
Epoch: 20, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.3605611324310303
Epoch: 21, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.3357188701629639
Epoch: 22, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4165325164794922
Epoch: 23, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.7613253593444824
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.7194528579711914
Epoch: 25, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.5736565589904785
Epoch: 26, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.795670986175537
Epoch: 27, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.6652531623840332
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.4888367652893066
Epoch: 29, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.7830345630645752
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.5458364486694336
Epoch: 31, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.6840274333953857
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.8291513919830322
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.534761667251587
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.6136481761932373
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.5865530967712402
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.6683690547943115
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.929746150970459
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.4862511157989502
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.4065489768981934
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.5589656829833984
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.338498830795288
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5292105674743652
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.4969604015350342
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.6832947731018066
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.7255935668945312
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.5317108631134033
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.4028429985046387
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.635061264038086
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.6319398880004883
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.4054319858551025
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.632176399230957
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.5412237644195557
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.6910264492034912
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.652552604675293
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.7385566234588623
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.6429047584533691
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.5631778240203857
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.5549049377441406
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.6688439846038818
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.6027898788452148
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.3893074989318848
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.6471154689788818
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.5780107975006104
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.5223469734191895
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.6987099647521973
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.5248832702636719
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.6177046298980713
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.7053554058074951
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.3375158309936523
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.6414759159088135
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.4914789199829102
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.6577651500701904
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 74 cost time: 1.6101386547088623
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.6756176948547363
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.7144334316253662
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.6745202541351318
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.3970937728881836
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.6296515464782715
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 80 cost time: 1.494964361190796
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 81 cost time: 1.7362194061279297
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 82 cost time: 1.2674775123596191
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 83 cost time: 1.1869843006134033
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 84 cost time: 1.2777364253997803
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 85 cost time: 1.2107877731323242
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.2989141941070557
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 87 cost time: 1.3676552772521973
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 88 cost time: 1.5158851146697998
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.5676064491271973
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.3478646278381348
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 91 cost time: 1.6311357021331787
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 92 cost time: 1.383208990097046
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 93 cost time: 1.4212114810943604
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 94 cost time: 1.529625654220581
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 95 cost time: 1.3455986976623535
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 96 cost time: 1.357619285583496
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 97 cost time: 1.6041531562805176
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 98 cost time: 1.4327640533447266
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 99 cost time: 1.4714102745056152
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.6295113563537598
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 49097
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.864375591278076
Epoch: 1, Steps: 18 | Train Loss: 3.325 Vali Loss: 3.194 Vali Acc: 0.087 Test Loss: 3.194 Test Acc: 0.087
Validation loss decreased (inf --> -0.086635).  Saving model ...
Epoch: 2 cost time: 1.563457727432251
Epoch: 2, Steps: 18 | Train Loss: 3.128 Vali Loss: 2.825 Vali Acc: 0.277 Test Loss: 2.825 Test Acc: 0.277
Validation loss decreased (-0.086635 --> -0.276638).  Saving model ...
Epoch: 3 cost time: 1.4694199562072754
Epoch: 3, Steps: 18 | Train Loss: 2.683 Vali Loss: 2.349 Vali Acc: 0.523 Test Loss: 2.349 Test Acc: 0.523
Validation loss decreased (-0.276638 --> -0.523310).  Saving model ...
Epoch: 4 cost time: 1.3087174892425537
Epoch: 4, Steps: 18 | Train Loss: 2.129 Vali Loss: 1.798 Vali Acc: 0.747 Test Loss: 1.798 Test Acc: 0.747
Validation loss decreased (-0.523310 --> -0.746649).  Saving model ...
Epoch: 5 cost time: 1.4753954410552979
Epoch: 5, Steps: 18 | Train Loss: 1.588 Vali Loss: 1.256 Vali Acc: 0.843 Test Loss: 1.256 Test Acc: 0.843
Validation loss decreased (-0.746649 --> -0.843321).  Saving model ...
Epoch: 6 cost time: 1.485032320022583
Epoch: 6, Steps: 18 | Train Loss: 1.049 Vali Loss: 0.825 Vali Acc: 0.897 Test Loss: 0.825 Test Acc: 0.897
Validation loss decreased (-0.843321 --> -0.896658).  Saving model ...
Epoch: 7 cost time: 1.4089934825897217
Epoch: 7, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.544 Vali Acc: 0.943 Test Loss: 0.544 Test Acc: 0.943
Validation loss decreased (-0.896658 --> -0.943328).  Saving model ...
Epoch: 8 cost time: 1.352121114730835
Epoch: 8, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.377 Vali Acc: 0.957 Test Loss: 0.377 Test Acc: 0.957
Validation loss decreased (-0.943328 --> -0.956663).  Saving model ...
Epoch: 9 cost time: 1.2810783386230469
Epoch: 9, Steps: 18 | Train Loss: 0.253 Vali Loss: 0.298 Vali Acc: 0.963 Test Loss: 0.298 Test Acc: 0.963
Validation loss decreased (-0.956663 --> -0.963330).  Saving model ...
Epoch: 10 cost time: 1.3039734363555908
Epoch: 10, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.249 Vali Acc: 0.967 Test Loss: 0.249 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 11 cost time: 1.2643077373504639
Epoch: 11, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 1.2268481254577637
Epoch: 12, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1959683895111084
Epoch: 13, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 1.3791067600250244
Epoch: 14, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 1.5447962284088135
Epoch: 15, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 1.4454867839813232
Epoch: 16, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 1.315993070602417
Epoch: 17, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.4100017547607422
Epoch: 18, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1468074321746826
Epoch: 19, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.377439260482788
Epoch: 20, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.353353500366211
Epoch: 21, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.5536096096038818
Epoch: 22, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.3974263668060303
Epoch: 23, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.4156858921051025
Epoch: 24, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.4358868598937988
Epoch: 25, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.6122009754180908
Epoch: 26, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.3917582035064697
Epoch: 27, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.3807828426361084
Epoch: 28, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.395918607711792
Epoch: 29, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.618346929550171
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.3696327209472656
Epoch: 31, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.2132899761199951
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.284848928451538
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.1932010650634766
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.1518757343292236
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.3312039375305176
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.5599322319030762
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.1946218013763428
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.3236825466156006
Epoch: 39, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.2936131954193115
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.4053394794464111
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.4749696254730225
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.5241615772247314
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.1973042488098145
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.2926158905029297
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.2989261150360107
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.3139870166778564
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.670839548110962
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.2972919940948486
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.2908482551574707
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.4443492889404297
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.32037353515625
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.592991590499878
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.4566218852996826
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.3807196617126465
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.4593665599822998
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.4410245418548584
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.3518455028533936
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.445732831954956
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.3535120487213135
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.2820031642913818
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.1418898105621338
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.183319330215454
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.1951582431793213
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.2972166538238525
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.3685574531555176
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.4176547527313232
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.3860020637512207
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.2833759784698486
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.4250147342681885
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.40376615524292
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.3173508644104004
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.305755376815796
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.317488670349121
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.4276905059814453
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.4184722900390625
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.4541654586791992
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.2913942337036133
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.2410571575164795
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.2540457248687744
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.2234783172607422
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.4136269092559814
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.3612070083618164
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.480036973953247
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.2797951698303223
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.3742103576660156
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.334728717803955
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.3590474128723145
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.4517123699188232
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.333221197128296
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.4268183708190918
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.3732130527496338
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 93 cost time: 1.3245348930358887
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.2528448104858398
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.2339246273040771
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 1.194075107574463
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 1.3411610126495361
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.3464438915252686
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.2147891521453857
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.4119417667388916
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 45609
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.707963466644287
Epoch: 1, Steps: 18 | Train Loss: 3.219 Vali Loss: 2.458 Vali Acc: 0.530 Test Loss: 2.458 Test Acc: 0.530
Validation loss decreased (inf --> -0.529975).  Saving model ...
Epoch: 2 cost time: 1.0083918571472168
Epoch: 2, Steps: 18 | Train Loss: 1.775 Vali Loss: 0.960 Vali Acc: 0.923 Test Loss: 0.960 Test Acc: 0.923
Validation loss decreased (-0.529975 --> -0.923324).  Saving model ...
Epoch: 3 cost time: 2.3423454761505127
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.365 Vali Acc: 0.917 Test Loss: 0.365 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.366572141647339
Epoch: 4, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
Validation loss decreased (-0.923324 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 2.5739123821258545
Epoch: 5, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2760746479034424
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.3022522926330566
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 2.233219623565674
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 2.3953070640563965
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 3.145066738128662
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7953078746795654
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.203296184539795
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7548892498016357
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.05708384513855
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7815656661987305
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.777012348175049
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.988352060317993
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1587774753570557
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.985323190689087
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 269161
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1837546825408936
Epoch: 1, Steps: 18 | Train Loss: 3.323 Vali Loss: 2.761 Vali Acc: 0.307 Test Loss: 2.761 Test Acc: 0.307
Validation loss decreased (inf --> -0.306639).  Saving model ...
Epoch: 2 cost time: 1.4867713451385498
Epoch: 2, Steps: 18 | Train Loss: 2.312 Vali Loss: 1.633 Vali Acc: 0.870 Test Loss: 1.633 Test Acc: 0.870
Validation loss decreased (-0.306639 --> -0.869984).  Saving model ...
Epoch: 3 cost time: 1.6450810432434082
Epoch: 3, Steps: 18 | Train Loss: 1.197 Vali Loss: 0.689 Vali Acc: 0.940 Test Loss: 0.689 Test Acc: 0.940
Validation loss decreased (-0.869984 --> -0.939993).  Saving model ...
Epoch: 4 cost time: 1.5190224647521973
Epoch: 4, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.296 Vali Acc: 0.963 Test Loss: 0.296 Test Acc: 0.963
Validation loss decreased (-0.939993 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.5109362602233887
Epoch: 5, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
Validation loss decreased (-0.963330 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.627964973449707
Epoch: 6, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.5369107723236084
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.341212272644043
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.6594421863555908
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.525148868560791
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.6436536312103271
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.588550329208374
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7662734985351562
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6626665592193604
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5970933437347412
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.3897793292999268
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6225240230560303
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.615818738937378
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.5533874034881592
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.7416300773620605
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.2710864543914795
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6860451698303223
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.5315945148468018
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7080578804016113
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4393503665924072
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.2480030059814453
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.3301820755004883
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.3512508869171143
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.462449312210083
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.513171672821045
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3614368438720703
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.563762903213501
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5825929641723633
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4356770515441895
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4887731075286865
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.5362606048583984
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.492950677871704
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.4346330165863037
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.4945578575134277
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.44588041305542
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.5809698104858398
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.3910541534423828
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.1133809089660645
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1084270477294922
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.07021164894104
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.952284574508667
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0366356372833252
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0086233615875244
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.0991220474243164
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.1072509288787842
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.0073761940002441
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1579985618591309
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.5681908130645752
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.5192248821258545
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.361297607421875
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.3307981491088867
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.3888006210327148
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.3843944072723389
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.56038236618042
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.529552936553955
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.4586598873138428
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.607269048690796
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.4685280323028564
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.4771122932434082
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.553117275238037
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.3135173320770264
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.3471381664276123
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.3369934558868408
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.437173843383789
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.5480844974517822
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.4466278553009033
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.4191584587097168
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.5575251579284668
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.3677961826324463
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.4422407150268555
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.4301884174346924
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.3360495567321777
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.2775707244873047
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.2627148628234863
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.2627811431884766
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.3452730178833008
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.2504403591156006
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.2819740772247314
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.453369379043579
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.3843138217926025
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.5273773670196533
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.3015661239624023
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.3383772373199463
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.3602759838104248
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.5242528915405273
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.4499976634979248
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.4569103717803955
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.328563928604126
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.3438584804534912
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.46673583984375
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 1.2615516185760498
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.3152945041656494
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 1.322763442993164
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 139625
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7646265029907227
Epoch: 1, Steps: 18 | Train Loss: 3.356 Vali Loss: 3.006 Vali Acc: 0.117 Test Loss: 3.006 Test Acc: 0.117
Validation loss decreased (inf --> -0.116637).  Saving model ...
Epoch: 2 cost time: 1.3358395099639893
Epoch: 2, Steps: 18 | Train Loss: 2.749 Vali Loss: 2.176 Vali Acc: 0.633 Test Loss: 2.176 Test Acc: 0.633
Validation loss decreased (-0.116637 --> -0.633312).  Saving model ...
Epoch: 3 cost time: 1.243025302886963
Epoch: 3, Steps: 18 | Train Loss: 1.855 Vali Loss: 1.315 Vali Acc: 0.873 Test Loss: 1.315 Test Acc: 0.873
Validation loss decreased (-0.633312 --> -0.873320).  Saving model ...
Epoch: 4 cost time: 1.262751817703247
Epoch: 4, Steps: 18 | Train Loss: 1.007 Vali Loss: 0.654 Vali Acc: 0.933 Test Loss: 0.654 Test Acc: 0.933
Validation loss decreased (-0.873320 --> -0.933327).  Saving model ...
Epoch: 5 cost time: 1.3203017711639404
Epoch: 5, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.330 Vali Acc: 0.963 Test Loss: 0.330 Test Acc: 0.963
Validation loss decreased (-0.933327 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 1.2686758041381836
Epoch: 6, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.217 Vali Acc: 0.960 Test Loss: 0.217 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3187963962554932
Epoch: 7, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.5299274921417236
Epoch: 8, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.4367585182189941
Epoch: 9, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.4027273654937744
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4310543537139893
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.3886492252349854
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.4440300464630127
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.4111976623535156
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.3980979919433594
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.387460708618164
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.24973464012146
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.3864521980285645
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.3310279846191406
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.2611382007598877
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.353269338607788
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.161848545074463
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.1776552200317383
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2000598907470703
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.3706459999084473
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.3970234394073486
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.300715684890747
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.3112843036651611
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.3167674541473389
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.3892333507537842
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.3752501010894775
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.3118572235107422
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.497363567352295
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.600825309753418
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.5839498043060303
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5224943161010742
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.420109748840332
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.5888640880584717
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.5337908267974854
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.4781875610351562
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.5630903244018555
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5705833435058594
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.4542710781097412
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.5632646083831787
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.478766918182373
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.6065623760223389
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.565995454788208
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.326589584350586
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.4335432052612305
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.3642594814300537
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.4633162021636963
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.431779146194458
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.404721975326538
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.2904703617095947
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.362396478652954
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.3954288959503174
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.2973883152008057
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.345916748046875
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.8304502964019775
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.6610932350158691
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.3995487689971924
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 96473
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8005573749542236
Epoch: 1, Steps: 18 | Train Loss: 3.269 Vali Loss: 2.964 Vali Acc: 0.187 Test Loss: 2.964 Test Acc: 0.187
Validation loss decreased (inf --> -0.186637).  Saving model ...
Epoch: 2 cost time: 1.5815911293029785
Epoch: 2, Steps: 18 | Train Loss: 2.752 Vali Loss: 2.327 Vali Acc: 0.613 Test Loss: 2.327 Test Acc: 0.613
Validation loss decreased (-0.186637 --> -0.613310).  Saving model ...
Epoch: 3 cost time: 1.5944197177886963
Epoch: 3, Steps: 18 | Train Loss: 2.075 Vali Loss: 1.560 Vali Acc: 0.833 Test Loss: 1.560 Test Acc: 0.833
Validation loss decreased (-0.613310 --> -0.833318).  Saving model ...
Epoch: 4 cost time: 1.5135555267333984
Epoch: 4, Steps: 18 | Train Loss: 1.299 Vali Loss: 0.889 Vali Acc: 0.930 Test Loss: 0.889 Test Acc: 0.930
Validation loss decreased (-0.833318 --> -0.929991).  Saving model ...
Epoch: 5 cost time: 1.381415843963623
Epoch: 5, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.478 Vali Acc: 0.943 Test Loss: 0.478 Test Acc: 0.943
Validation loss decreased (-0.929991 --> -0.943329).  Saving model ...
Epoch: 6 cost time: 1.5098836421966553
Epoch: 6, Steps: 18 | Train Loss: 0.319 Vali Loss: 0.282 Vali Acc: 0.960 Test Loss: 0.282 Test Acc: 0.960
Validation loss decreased (-0.943329 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 1.2219483852386475
Epoch: 7, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 1.685753583908081
Epoch: 8, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.4803540706634521
Epoch: 9, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4287898540496826
Epoch: 10, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.6104230880737305
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.19718337059021
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2641029357910156
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2464258670806885
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2235403060913086
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4269607067108154
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2821083068847656
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3743915557861328
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.207026720046997
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.469618797302246
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.52889084815979
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5304319858551025
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4018645286560059
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3066351413726807
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.2467949390411377
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3154911994934082
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.3066298961639404
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4888684749603271
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.345639944076538
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.3486368656158447
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.342031717300415
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.2141847610473633
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.262486457824707
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.370314121246338
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3562901020050049
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.235081672668457
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.1581482887268066
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.2724034786224365
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.2169063091278076
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.333988904953003
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3887763023376465
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.3138980865478516
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2148783206939697
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.478402853012085
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3163964748382568
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.3902027606964111
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.163679599761963
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.2711234092712402
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.1955175399780273
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.198556661605835
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2063207626342773
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.3153905868530273
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.2241270542144775
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2503421306610107
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.3686316013336182
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.2817671298980713
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.248986005783081
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2909021377563477
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.3354895114898682
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.346785545349121
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.315732717514038
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.3186171054840088
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.325296401977539
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.2249770164489746
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.2463860511779785
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 1.2392165660858154
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 1.3766586780548096
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.4173939228057861
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.4545786380767822
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.333587408065796
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.2461175918579102
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.2809252738952637
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.2877576351165771
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.36183500289917
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.2318065166473389
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.2156198024749756
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.5304145812988281
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.2769432067871094
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.3213913440704346
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.453263759613037
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.2309792041778564
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.3631196022033691
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.382908821105957
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.3274152278900146
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.3411893844604492
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.3797268867492676
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.3297743797302246
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.4983572959899902
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.3937222957611084
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.3641448020935059
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.4712674617767334
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.366814136505127
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.3596501350402832
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.3658850193023682
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.322596788406372
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.3640024662017822
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.3679726123809814
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.4209792613983154
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 1.3423922061920166
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.474402666091919
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 74937
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1227529048919678
Epoch: 1, Steps: 18 | Train Loss: 3.342 Vali Loss: 3.097 Vali Acc: 0.110 Test Loss: 3.097 Test Acc: 0.110
Validation loss decreased (inf --> -0.109969).  Saving model ...
Epoch: 2 cost time: 1.3976027965545654
Epoch: 2, Steps: 18 | Train Loss: 2.973 Vali Loss: 2.607 Vali Acc: 0.397 Test Loss: 2.607 Test Acc: 0.397
Validation loss decreased (-0.109969 --> -0.396641).  Saving model ...
Epoch: 3 cost time: 1.284414529800415
Epoch: 3, Steps: 18 | Train Loss: 2.412 Vali Loss: 1.965 Vali Acc: 0.717 Test Loss: 1.965 Test Acc: 0.717
Validation loss decreased (-0.396641 --> -0.716647).  Saving model ...
Epoch: 4 cost time: 1.5724081993103027
Epoch: 4, Steps: 18 | Train Loss: 1.720 Vali Loss: 1.275 Vali Acc: 0.850 Test Loss: 1.275 Test Acc: 0.850
Validation loss decreased (-0.716647 --> -0.849987).  Saving model ...
Epoch: 5 cost time: 1.3202834129333496
Epoch: 5, Steps: 18 | Train Loss: 1.051 Vali Loss: 0.729 Vali Acc: 0.940 Test Loss: 0.729 Test Acc: 0.940
Validation loss decreased (-0.849987 --> -0.939993).  Saving model ...
Epoch: 6 cost time: 1.4045605659484863
Epoch: 6, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.433 Vali Acc: 0.953 Test Loss: 0.433 Test Acc: 0.953
Validation loss decreased (-0.939993 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 1.4256515502929688
Epoch: 7, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.282 Vali Acc: 0.967 Test Loss: 0.282 Test Acc: 0.967
Validation loss decreased (-0.953329 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 1.7508456707000732
Epoch: 8, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.220 Vali Acc: 0.963 Test Loss: 0.220 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5801470279693604
Epoch: 9, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 1.5811851024627686
Epoch: 10, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.6889126300811768
Epoch: 11, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.549738883972168
Epoch: 12, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.5427651405334473
Epoch: 13, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.4895977973937988
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 1.7784521579742432
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 1.8131017684936523
Epoch: 16, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 1.7563621997833252
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 2.0002880096435547
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.9826149940490723
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.5558099746704102
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.8584539890289307
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.6133081912994385
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.723330020904541
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.6822829246520996
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.5506742000579834
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.7407481670379639
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.7357773780822754
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.9046261310577393
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.759270191192627
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.8601353168487549
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.6686928272247314
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.7151556015014648
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.8457450866699219
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.7802331447601318
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 2.130120038986206
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 2.15079402923584
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.8830771446228027
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.9808223247528076
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.6877760887145996
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.6260862350463867
Epoch: 40, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.829561471939087
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.5704255104064941
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.9525327682495117
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.7858812808990479
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.67002534866333
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.904412031173706
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.754824161529541
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.542179822921753
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.8519690036773682
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.4837214946746826
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.5416648387908936
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.762561321258545
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.6091399192810059
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.5641019344329834
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.5835967063903809
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.4925549030303955
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.5286314487457275
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.706343412399292
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.7484300136566162
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.6936800479888916
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.525252342224121
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.5163846015930176
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.6432287693023682
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.6341378688812256
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.7234783172607422
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.5829675197601318
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.5078186988830566
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.4949736595153809
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.519714593887329
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.4635484218597412
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.4319159984588623
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.6337709426879883
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.7059812545776367
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.5279541015625
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.5756585597991943
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.4365019798278809
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.411914587020874
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.5106146335601807
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.326869249343872
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.570937156677246
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.4242918491363525
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.4192087650299072
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.3401780128479004
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.7588610649108887
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.722790002822876
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.4657971858978271
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 1.5191166400909424
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.6422276496887207
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.8152661323547363
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.8409154415130615
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.8151888847351074
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.6212055683135986
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 1.2916502952575684
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.3916871547698975
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.6183738708496094
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.6320819854736328
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.5116345882415771
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.3415825366973877
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.3215360641479492
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.5006356239318848
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 57049
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.250723361968994
Epoch: 1, Steps: 18 | Train Loss: 3.298 Vali Loss: 3.093 Vali Acc: 0.063 Test Loss: 3.093 Test Acc: 0.063
Validation loss decreased (inf --> -0.063302).  Saving model ...
Epoch: 2 cost time: 1.395137071609497
Epoch: 2, Steps: 18 | Train Loss: 2.966 Vali Loss: 2.694 Vali Acc: 0.323 Test Loss: 2.694 Test Acc: 0.323
Validation loss decreased (-0.063302 --> -0.323306).  Saving model ...
Epoch: 3 cost time: 1.2914800643920898
Epoch: 3, Steps: 18 | Train Loss: 2.549 Vali Loss: 2.203 Vali Acc: 0.610 Test Loss: 2.203 Test Acc: 0.610
Validation loss decreased (-0.323306 --> -0.609978).  Saving model ...
Epoch: 4 cost time: 1.3276171684265137
Epoch: 4, Steps: 18 | Train Loss: 2.047 Vali Loss: 1.645 Vali Acc: 0.833 Test Loss: 1.645 Test Acc: 0.833
Validation loss decreased (-0.609978 --> -0.833317).  Saving model ...
Epoch: 5 cost time: 1.2286384105682373
Epoch: 5, Steps: 18 | Train Loss: 1.477 Vali Loss: 1.124 Vali Acc: 0.917 Test Loss: 1.124 Test Acc: 0.917
Validation loss decreased (-0.833317 --> -0.916655).  Saving model ...
Epoch: 6 cost time: 1.2846248149871826
Epoch: 6, Steps: 18 | Train Loss: 0.972 Vali Loss: 0.721 Vali Acc: 0.947 Test Loss: 0.721 Test Acc: 0.947
Validation loss decreased (-0.916655 --> -0.946659).  Saving model ...
Epoch: 7 cost time: 1.368743896484375
Epoch: 7, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.470 Vali Acc: 0.957 Test Loss: 0.470 Test Acc: 0.957
Validation loss decreased (-0.946659 --> -0.956662).  Saving model ...
Epoch: 8 cost time: 1.419095516204834
Epoch: 8, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.334 Vali Acc: 0.967 Test Loss: 0.334 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966663).  Saving model ...
Epoch: 9 cost time: 1.2832438945770264
Epoch: 9, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.256 Vali Acc: 0.970 Test Loss: 0.256 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969997).  Saving model ...
Epoch: 10 cost time: 1.3137571811676025
Epoch: 10, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.217 Vali Acc: 0.970 Test Loss: 0.217 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 1.3159193992614746
Epoch: 11, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.187 Vali Acc: 0.973 Test Loss: 0.187 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 1.319101095199585
Epoch: 12, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.4719574451446533
Epoch: 13, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.4440722465515137
Epoch: 14, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 1.3724780082702637
Epoch: 15, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4216578006744385
Epoch: 16, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3658950328826904
Epoch: 17, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2846672534942627
Epoch: 18, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1327733993530273
Epoch: 19, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.2243726253509521
Epoch: 20, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.111311912536621
Epoch: 21, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.197767734527588
Epoch: 22, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.208571195602417
Epoch: 23, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3776216506958008
Epoch: 24, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3424012660980225
Epoch: 25, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.629568338394165
Epoch: 26, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4339125156402588
Epoch: 27, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3937392234802246
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2540748119354248
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.3674421310424805
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3759713172912598
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3027660846710205
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3896424770355225
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.5427274703979492
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3518612384796143
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3345069885253906
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.573336124420166
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4867117404937744
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.484349012374878
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.2557957172393799
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.2501733303070068
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2877709865570068
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 1.233504295349121
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.3536474704742432
Epoch: 44, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.325526475906372
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.3906943798065186
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.2783503532409668
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.3996565341949463
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.312549114227295
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.325756311416626
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.3707776069641113
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.3873262405395508
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.2907147407531738
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.377237319946289
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.436378002166748
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.2639527320861816
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.4244434833526611
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.2574653625488281
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.5260546207427979
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.3278768062591553
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.4586682319641113
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.2706913948059082
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.3211913108825684
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.3745276927947998
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.3580436706542969
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.2740504741668701
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.433574914932251
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.4243056774139404
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.506908655166626
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.5780432224273682
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.3660638332366943
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.5338430404663086
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.4685306549072266
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.3338632583618164
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.4229228496551514
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.3559463024139404
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.3527982234954834
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.5554702281951904
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.4820506572723389
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.4328944683074951
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.5155038833618164
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 1.50471830368042
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.5871493816375732
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.6137537956237793
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.5345683097839355
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.43479585647583
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.243396520614624
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 1.333531141281128
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.4452571868896484
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.456066370010376
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.444173812866211
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.526625394821167
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 93 cost time: 1.406886100769043
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.3271336555480957
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.4031894207000732
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 1.396789312362671
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 1.4353270530700684
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.4949533939361572
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.4818084239959717
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.487236499786377
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 42761
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6543872356414795
Epoch: 1, Steps: 18 | Train Loss: 3.381 Vali Loss: 3.195 Vali Acc: 0.043 Test Loss: 3.195 Test Acc: 0.043
Validation loss decreased (inf --> -0.043301).  Saving model ...
Epoch: 2 cost time: 1.5863604545593262
Epoch: 2, Steps: 18 | Train Loss: 3.110 Vali Loss: 2.832 Vali Acc: 0.267 Test Loss: 2.832 Test Acc: 0.267
Validation loss decreased (-0.043301 --> -0.266638).  Saving model ...
Epoch: 3 cost time: 1.7381162643432617
Epoch: 3, Steps: 18 | Train Loss: 2.735 Vali Loss: 2.333 Vali Acc: 0.580 Test Loss: 2.333 Test Acc: 0.580
Validation loss decreased (-0.266638 --> -0.579977).  Saving model ...
Epoch: 4 cost time: 1.4515352249145508
Epoch: 4, Steps: 18 | Train Loss: 2.223 Vali Loss: 1.769 Vali Acc: 0.773 Test Loss: 1.769 Test Acc: 0.773
Validation loss decreased (-0.579977 --> -0.773316).  Saving model ...
Epoch: 5 cost time: 1.48677396774292
Epoch: 5, Steps: 18 | Train Loss: 1.592 Vali Loss: 1.218 Vali Acc: 0.887 Test Loss: 1.218 Test Acc: 0.887
Validation loss decreased (-0.773316 --> -0.886654).  Saving model ...
Epoch: 6 cost time: 1.5868031978607178
Epoch: 6, Steps: 18 | Train Loss: 1.019 Vali Loss: 0.795 Vali Acc: 0.943 Test Loss: 0.795 Test Acc: 0.943
Validation loss decreased (-0.886654 --> -0.943325).  Saving model ...
Epoch: 7 cost time: 1.454289436340332
Epoch: 7, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.511 Vali Acc: 0.970 Test Loss: 0.511 Test Acc: 0.970
Validation loss decreased (-0.943325 --> -0.969995).  Saving model ...
Epoch: 8 cost time: 1.5311167240142822
Epoch: 8, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.362 Vali Acc: 0.970 Test Loss: 0.362 Test Acc: 0.970
Validation loss decreased (-0.969995 --> -0.969996).  Saving model ...
Epoch: 9 cost time: 1.684558391571045
Epoch: 9, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.275 Vali Acc: 0.973 Test Loss: 0.275 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 1.3513762950897217
Epoch: 10, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.223 Vali Acc: 0.977 Test Loss: 0.223 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976664).  Saving model ...
Epoch: 11 cost time: 1.746886968612671
Epoch: 11, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.192 Vali Acc: 0.977 Test Loss: 0.192 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.453641653060913
Epoch: 12, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 1.5526344776153564
Epoch: 13, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 14 cost time: 1.6698296070098877
Epoch: 14, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.6055047512054443
Epoch: 15, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.5506665706634521
Epoch: 16, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.749570608139038
Epoch: 17, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.6978058815002441
Epoch: 18, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3719208240509033
Epoch: 19, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.7058935165405273
Epoch: 20, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.561765193939209
Epoch: 21, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.389418601989746
Epoch: 22, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.471001386642456
Epoch: 23, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.4392659664154053
Epoch: 24, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.6873950958251953
Epoch: 25, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.4929218292236328
Epoch: 26, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.578995943069458
Epoch: 27, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.6000571250915527
Epoch: 28, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.4358618259429932
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5878832340240479
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4789273738861084
Epoch: 31, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.4240820407867432
Epoch: 32, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.2345492839813232
Epoch: 33, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.35921049118042
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.3053410053253174
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.666599988937378
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.8077383041381836
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.5279357433319092
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.295511245727539
Epoch: 39, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.300490140914917
Epoch: 40, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.3411290645599365
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.3859233856201172
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 1.5815322399139404
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.4941649436950684
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.4809095859527588
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.395387887954712
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.4194128513336182
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4199960231781006
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.4581661224365234
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.624589204788208
Epoch: 50, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.5263960361480713
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.426645040512085
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.355867862701416
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.3412230014801025
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.2729852199554443
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.2539379596710205
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.5992190837860107
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.5036861896514893
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4865763187408447
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.6384365558624268
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.568401575088501
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.4564208984375
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.8980090618133545
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.5899658203125
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.299854040145874
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.5138256549835205
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.3925273418426514
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.4569776058197021
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.751218318939209
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.687361240386963
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.4505488872528076
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.6740715503692627
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.495213508605957
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.6111910343170166
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.9974143505096436
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.5996959209442139
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.307936191558838
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.256136178970337
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.3560025691986084
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.546013355255127
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.8417084217071533
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 1.792240858078003
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.5862610340118408
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.6758286952972412
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.750880479812622
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.492011308670044
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.6379973888397217
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.4294116497039795
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 1.5996441841125488
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.57505464553833
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.983 Test Loss: 0.055 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.532822608947754
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.7489898204803467
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 93 cost time: 1.606557846069336
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.519242525100708
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.4658920764923096
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 1.601604700088501
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.4873497486114502
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.4662518501281738
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.053 Vali Acc: 0.983 Test Loss: 0.053 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.37363862991333
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.053 Vali Acc: 0.983 Test Loss: 0.053 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.5091917514801025
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.053 Vali Acc: 0.983 Test Loss: 0.053 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el3_dm16_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 39273
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.655736923217773
Epoch: 1, Steps: 18 | Train Loss: 2.109 Vali Loss: 0.516 Vali Acc: 0.843 Test Loss: 0.516 Test Acc: 0.843
Validation loss decreased (inf --> -0.843328).  Saving model ...
Epoch: 2 cost time: 3.186891555786133
Epoch: 2, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.382 Vali Acc: 0.890 Test Loss: 0.382 Test Acc: 0.890
Validation loss decreased (-0.843328 --> -0.889996).  Saving model ...
Epoch: 3 cost time: 3.0352866649627686
Epoch: 3, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.354 Vali Acc: 0.937 Test Loss: 0.354 Test Acc: 0.937
Validation loss decreased (-0.889996 --> -0.936663).  Saving model ...
Epoch: 4 cost time: 2.9009177684783936
Epoch: 4, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.276 Vali Acc: 0.957 Test Loss: 0.276 Test Acc: 0.957
Validation loss decreased (-0.936663 --> -0.956664).  Saving model ...
Epoch: 5 cost time: 2.6192450523376465
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.433 Vali Acc: 0.913 Test Loss: 0.433 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3507635593414307
Epoch: 6, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.528 Vali Acc: 0.917 Test Loss: 0.528 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9116098880767822
Epoch: 7, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.580 Vali Acc: 0.920 Test Loss: 0.580 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8140738010406494
Epoch: 8, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.802 Vali Acc: 0.883 Test Loss: 0.802 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9605419635772705
Epoch: 9, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.161 Vali Acc: 0.870 Test Loss: 1.161 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.094831943511963
Epoch: 10, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.466 Vali Acc: 0.877 Test Loss: 1.466 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.1146554946899414
Epoch: 11, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.205 Vali Acc: 0.897 Test Loss: 1.205 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.966996431350708
Epoch: 12, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.641 Vali Acc: 0.860 Test Loss: 1.641 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9462268352508545
Epoch: 13, Steps: 18 | Train Loss: 0.197 Vali Loss: 1.642 Vali Acc: 0.877 Test Loss: 1.642 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.0903921127319336
Epoch: 14, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.529 Vali Acc: 0.907 Test Loss: 1.529 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 2339353
model size : 11.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.683311939239502
Epoch: 1, Steps: 18 | Train Loss: 2.490 Vali Loss: 0.741 Vali Acc: 0.870 Test Loss: 0.741 Test Acc: 0.870
Validation loss decreased (inf --> -0.869993).  Saving model ...
Epoch: 2 cost time: 2.3064653873443604
Epoch: 2, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
Validation loss decreased (-0.869993 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 2.3344340324401855
Epoch: 3, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.943331 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 2.0847835540771484
Epoch: 4, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.064016103744507
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.1547129154205322
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.035940408706665
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
Validation loss decreased (-0.976666 --> -0.986666).  Saving model ...
Epoch: 8 cost time: 1.9990177154541016
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.147676467895508
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9443321228027344
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.675255537033081
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.788651466369629
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0602991580963135
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.060285806655884
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1406688690185547
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2499818801879883
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9073748588562012
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 1303065
model size : 7.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.377575397491455
Epoch: 1, Steps: 18 | Train Loss: 2.728 Vali Loss: 1.148 Vali Acc: 0.880 Test Loss: 1.148 Test Acc: 0.880
Validation loss decreased (inf --> -0.879989).  Saving model ...
Epoch: 2 cost time: 1.7771711349487305
Epoch: 2, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
Validation loss decreased (-0.879989 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 1.6332638263702393
Epoch: 3, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6334216594696045
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.943331 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.9986488819122314
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.816148281097412
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9708399772644043
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9179234504699707
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9851465225219727
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9108057022094727
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.061230421066284
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9804832935333252
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0353052616119385
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7461111545562744
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 957849
model size : 6.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6779816150665283
Epoch: 1, Steps: 18 | Train Loss: 2.888 Vali Loss: 1.515 Vali Acc: 0.863 Test Loss: 1.515 Test Acc: 0.863
Validation loss decreased (inf --> -0.863318).  Saving model ...
Epoch: 2 cost time: 1.9924020767211914
Epoch: 2, Steps: 18 | Train Loss: 0.663 Vali Loss: 0.247 Vali Acc: 0.957 Test Loss: 0.247 Test Acc: 0.957
Validation loss decreased (-0.863318 --> -0.956664).  Saving model ...
Epoch: 3 cost time: 2.324524402618408
Epoch: 3, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.173 Vali Acc: 0.947 Test Loss: 0.173 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.117504835128784
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.956664 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 2.0256574153900146
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.140808343887329
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.381687879562378
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.2095696926116943
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.0930399894714355
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8923733234405518
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8257966041564941
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0548908710479736
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.9757580757141113
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.210420846939087
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.2174479961395264
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3243861198425293
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3301515579223633
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1255452632904053
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.174001455307007
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.269390344619751
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.398043394088745
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.107851266860962
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0293891429901123
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.890610933303833
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 785561
model size : 5.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7823305130004883
Epoch: 1, Steps: 18 | Train Loss: 2.950 Vali Loss: 1.777 Vali Acc: 0.747 Test Loss: 1.777 Test Acc: 0.747
Validation loss decreased (inf --> -0.746649).  Saving model ...
Epoch: 2 cost time: 1.939889669418335
Epoch: 2, Steps: 18 | Train Loss: 0.921 Vali Loss: 0.306 Vali Acc: 0.963 Test Loss: 0.306 Test Acc: 0.963
Validation loss decreased (-0.746649 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 1.8967351913452148
Epoch: 3, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.159597396850586
Epoch: 4, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.963330 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 2.176253080368042
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 2.0166680812835693
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.093651294708252
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.168569564819336
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8992981910705566
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9311885833740234
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7629950046539307
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.1181349754333496
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7183301448822021
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.734884262084961
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.0383377075195312
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1387572288513184
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.1993346214294434
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.280883550643921
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2745697498321533
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.433591842651367
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2794742584228516
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.504399061203003
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.216623544692993
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.188159227371216
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 2.333986282348633
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1377177238464355
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3113491535186768
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2688755989074707
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.011669158935547
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1299941539764404
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.408289670944214
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.4726760387420654
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.2159504890441895
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.2987782955169678
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 642457
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7564001083374023
Epoch: 1, Steps: 18 | Train Loss: 3.055 Vali Loss: 2.177 Vali Acc: 0.640 Test Loss: 2.177 Test Acc: 0.640
Validation loss decreased (inf --> -0.639978).  Saving model ...
Epoch: 2 cost time: 2.3315699100494385
Epoch: 2, Steps: 18 | Train Loss: 1.331 Vali Loss: 0.599 Vali Acc: 0.940 Test Loss: 0.599 Test Acc: 0.940
Validation loss decreased (-0.639978 --> -0.939994).  Saving model ...
Epoch: 3 cost time: 2.6779978275299072
Epoch: 3, Steps: 18 | Train Loss: 0.320 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.939994 --> -0.949998).  Saving model ...
Epoch: 4 cost time: 2.3005619049072266
Epoch: 4, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.949998 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 2.208516836166382
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.2996327877044678
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.199320077896118
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.9990370273590088
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.1040751934051514
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7562618255615234
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.985694169998169
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.0171215534210205
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.110278606414795
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.226638078689575
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.233126163482666
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.4424219131469727
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.497828722000122
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2149627208709717
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.085437059402466
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.123619318008423
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.9309446811676025
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9569091796875
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7982077598571777
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8648207187652588
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0213229656219482
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.089000940322876
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2586843967437744
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.2268998622894287
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.1882917881011963
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0921740531921387
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.3148722648620605
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 2.3366165161132812
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2196359634399414
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 2.1451680660247803
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 2.2298998832702637
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 2.201822280883789
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.083538055419922
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.9236643314361572
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.8627779483795166
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.478426694869995
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 2.2976629734039307
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.9981608390808105
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.049948215484619
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.135077953338623
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.4331939220428467
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.4037396907806396
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.257352113723755
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.3537278175354004
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.4582889080047607
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.4089114665985107
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.2528390884399414
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 528153
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.002235651016235
Epoch: 1, Steps: 18 | Train Loss: 3.198 Vali Loss: 2.249 Vali Acc: 0.607 Test Loss: 2.249 Test Acc: 0.607
Validation loss decreased (inf --> -0.606644).  Saving model ...
Epoch: 2 cost time: 1.8517091274261475
Epoch: 2, Steps: 18 | Train Loss: 1.411 Vali Loss: 0.623 Vali Acc: 0.937 Test Loss: 0.623 Test Acc: 0.937
Validation loss decreased (-0.606644 --> -0.936660).  Saving model ...
Epoch: 3 cost time: 1.9230711460113525
Epoch: 3, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.208 Vali Acc: 0.967 Test Loss: 0.208 Test Acc: 0.967
Validation loss decreased (-0.936660 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.5585651397705078
Epoch: 4, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0086019039154053
Epoch: 5, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.1240394115448
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 2.1287336349487305
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9516537189483643
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.038090705871582
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.223867177963257
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.932124137878418
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.7499282360076904
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.5829734802246094
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.5527119636535645
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.0660653114318848
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.0779693126678467
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.914703369140625
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.9426445960998535
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.9408831596374512
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.9544084072113037
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.9592151641845703
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.9119977951049805
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.9866158962249756
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0385663509368896
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7856686115264893
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.5792245864868164
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8332045078277588
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.8938593864440918
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.933194875717163
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 2.0479137897491455
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.9091992378234863
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.6585679054260254
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.8964829444885254
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 2.0881428718566895
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.993342638015747
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.0996146202087402
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.9630882740020752
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.328402042388916
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6058158874511719
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6102449893951416
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.789306402206421
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 2.000699281692505
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 2.0935747623443604
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.0940022468566895
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.8990013599395752
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.9641551971435547
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.9885797500610352
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.140557050704956
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.8665440082550049
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.8941352367401123
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.7761554718017578
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.408719778060913
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.8157930374145508
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.582261562347412
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.9176263809204102
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.9000575542449951
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.111825942993164
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.975599765777588
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.88816499710083
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.881680965423584
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.6012258529663086
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.9245193004608154
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.8543298244476318
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.6983487606048584
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.3953642845153809
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.4407219886779785
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.8019037246704102
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.5699946880340576
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.787175178527832
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.9608643054962158
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.9464654922485352
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 500249
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.307251691818237
Epoch: 1, Steps: 18 | Train Loss: 2.222 Vali Loss: 0.692 Vali Acc: 0.770 Test Loss: 0.692 Test Acc: 0.770
Validation loss decreased (inf --> -0.769993).  Saving model ...
Epoch: 2 cost time: 2.498617172241211
Epoch: 2, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.825 Vali Acc: 0.850 Test Loss: 0.825 Test Acc: 0.850
Validation loss decreased (-0.769993 --> -0.849992).  Saving model ...
Epoch: 3 cost time: 1.8963422775268555
Epoch: 3, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.466 Vali Acc: 0.913 Test Loss: 0.466 Test Acc: 0.913
Validation loss decreased (-0.849992 --> -0.913329).  Saving model ...
Epoch: 4 cost time: 2.3938755989074707
Epoch: 4, Steps: 18 | Train Loss: 0.357 Vali Loss: 0.474 Vali Acc: 0.893 Test Loss: 0.474 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9091641902923584
Epoch: 5, Steps: 18 | Train Loss: 0.109 Vali Loss: 1.192 Vali Acc: 0.873 Test Loss: 1.192 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.65834903717041
Epoch: 6, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.466 Vali Acc: 0.920 Test Loss: 0.466 Test Acc: 0.920
Validation loss decreased (-0.913329 --> -0.919995).  Saving model ...
Epoch: 7 cost time: 2.654233932495117
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.943 Vali Acc: 0.887 Test Loss: 0.943 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7542502880096436
Epoch: 8, Steps: 18 | Train Loss: 0.051 Vali Loss: 1.243 Vali Acc: 0.873 Test Loss: 1.243 Test Acc: 0.873
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0561752319335938
Epoch: 9, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.449 Vali Acc: 0.947 Test Loss: 0.449 Test Acc: 0.947
Validation loss decreased (-0.919995 --> -0.946662).  Saving model ...
Epoch: 10 cost time: 2.783318042755127
Epoch: 10, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.750 Vali Acc: 0.933 Test Loss: 0.750 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.654073476791382
Epoch: 11, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.151 Vali Acc: 0.913 Test Loss: 1.151 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8116586208343506
Epoch: 12, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.590 Vali Acc: 0.943 Test Loss: 0.590 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5770649909973145
Epoch: 13, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.493 Vali Acc: 0.947 Test Loss: 0.493 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1386115550994873
Epoch: 14, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.624 Vali Acc: 0.950 Test Loss: 0.624 Test Acc: 0.950
Validation loss decreased (-0.946662 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 2.8426616191864014
Epoch: 15, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.735 Vali Acc: 0.910 Test Loss: 0.735 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8384881019592285
Epoch: 16, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.676 Vali Acc: 0.913 Test Loss: 0.676 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.2058191299438477
Epoch: 17, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.862 Vali Acc: 0.903 Test Loss: 0.862 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0893959999084473
Epoch: 18, Steps: 18 | Train Loss: 0.234 Vali Loss: 2.194 Vali Acc: 0.893 Test Loss: 2.194 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.3025076389312744
Epoch: 19, Steps: 18 | Train Loss: 0.340 Vali Loss: 0.763 Vali Acc: 0.947 Test Loss: 0.763 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1997344493865967
Epoch: 20, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.913 Vali Acc: 0.940 Test Loss: 0.913 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.227494478225708
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 1.357 Vali Acc: 0.910 Test Loss: 1.357 Test Acc: 0.910
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0838701725006104
Epoch: 22, Steps: 18 | Train Loss: 0.023 Vali Loss: 1.211 Vali Acc: 0.903 Test Loss: 1.211 Test Acc: 0.903
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.1130809783935547
Epoch: 23, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.458 Vali Acc: 0.900 Test Loss: 1.458 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.6029303073883057
Epoch: 24, Steps: 18 | Train Loss: 0.050 Vali Loss: 1.797 Vali Acc: 0.893 Test Loss: 1.797 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.95
model parameter : 2273561
model size : 11.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.681157112121582
Epoch: 1, Steps: 18 | Train Loss: 2.451 Vali Loss: 0.744 Vali Acc: 0.900 Test Loss: 0.744 Test Acc: 0.900
Validation loss decreased (inf --> -0.899993).  Saving model ...
Epoch: 2 cost time: 3.038201332092285
Epoch: 2, Steps: 18 | Train Loss: 0.267 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 3.2398364543914795
Epoch: 3, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.949998 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 3.4990856647491455
Epoch: 4, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4129323959350586
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 3.5893867015838623
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.947 Test Loss: 0.175 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.480893135070801
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.392821788787842
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.313 Vali Acc: 0.923 Test Loss: 0.313 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.476173162460327
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3252813816070557
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.159837007522583
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8568217754364014
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.07670259475708
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.550534963607788
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.679002285003662
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1237273
model size : 7.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.670865774154663
Epoch: 1, Steps: 18 | Train Loss: 2.700 Vali Loss: 1.155 Vali Acc: 0.897 Test Loss: 1.155 Test Acc: 0.897
Validation loss decreased (inf --> -0.896655).  Saving model ...
Epoch: 2 cost time: 3.298332691192627
Epoch: 2, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
Validation loss decreased (-0.896655 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 3.0248422622680664
Epoch: 3, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.917 Test Loss: 0.267 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.30708646774292
Epoch: 4, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 3.6892080307006836
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.499913454055786
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0386905670166016
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 3.181081533432007
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.524930715560913
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 3.9230120182037354
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4585611820220947
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4550721645355225
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.656475782394409
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7504665851593018
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.415440559387207
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.6463286876678467
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.7939109802246094
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4159607887268066
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.2357912063598633
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 892057
model size : 5.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.4422712326049805
Epoch: 1, Steps: 18 | Train Loss: 2.940 Vali Loss: 1.566 Vali Acc: 0.797 Test Loss: 1.566 Test Acc: 0.797
Validation loss decreased (inf --> -0.796651).  Saving model ...
Epoch: 2 cost time: 3.161033868789673
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.278 Vali Acc: 0.957 Test Loss: 0.278 Test Acc: 0.957
Validation loss decreased (-0.796651 --> -0.956664).  Saving model ...
Epoch: 3 cost time: 3.254823923110962
Epoch: 3, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.172 Vali Acc: 0.947 Test Loss: 0.172 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3081493377685547
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 3.082275390625
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 2.9796407222747803
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 2.627340078353882
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.7692482471466064
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7929184436798096
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.887216806411743
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.7124714851379395
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.9171743392944336
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 3.292099714279175
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 2.810659885406494
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 2.7856924533843994
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8003089427948
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 3.061490058898926
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2252249717712402
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 3.1598103046417236
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.147434711456299
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9840617179870605
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.194333076477051
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.82663631439209
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.158106565475464
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1389198303222656
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.308835983276367
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 2.528752088546753
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 2.478544235229492
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 2.410987615585327
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 3.2266883850097656
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 3.031625986099243
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.0241641998291016
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.2764456272125244
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.1839656829833984
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.201857089996338
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.869877338409424
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.0058088302612305
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.3724749088287354
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 2.9120428562164307
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.786576509475708
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.5262699127197266
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.8824424743652344
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.887861728668213
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.0825603008270264
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 3.225984573364258
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.22007417678833
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 3.234468460083008
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 3.184049367904663
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 719769
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.698888778686523
Epoch: 1, Steps: 18 | Train Loss: 2.886 Vali Loss: 1.720 Vali Acc: 0.817 Test Loss: 1.720 Test Acc: 0.817
Validation loss decreased (inf --> -0.816649).  Saving model ...
Epoch: 2 cost time: 3.0572879314422607
Epoch: 2, Steps: 18 | Train Loss: 0.898 Vali Loss: 0.333 Vali Acc: 0.953 Test Loss: 0.333 Test Acc: 0.953
Validation loss decreased (-0.816649 --> -0.953330).  Saving model ...
Epoch: 3 cost time: 3.0939793586730957
Epoch: 3, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.256 Vali Acc: 0.940 Test Loss: 0.256 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.033811092376709
Epoch: 4, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.953330 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 3.3803839683532715
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1118531227111816
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4077200889587402
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 3.3696444034576416
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 3.4889187812805176
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 3.428790330886841
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2636640071868896
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.506524085998535
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 3.3891334533691406
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.648181915283203
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 3.221545696258545
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 3.2808077335357666
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0478875637054443
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4986541271209717
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3452789783477783
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9158437252044678
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.73819899559021
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4833743572235107
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3955461978912354
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.547581195831299
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.352647066116333
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 2.367893934249878
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.391859769821167
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 3.1374475955963135
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.875892162322998
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 2.8292300701141357
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 2.7738888263702393
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.2445528507232666
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.420402765274048
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.598201036453247
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.6697449684143066
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.7851743698120117
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.0056262016296387
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.787729263305664
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.982454776763916
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.6275954246520996
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 576665
model size : 4.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.505223751068115
Epoch: 1, Steps: 18 | Train Loss: 3.064 Vali Loss: 2.151 Vali Acc: 0.647 Test Loss: 2.151 Test Acc: 0.647
Validation loss decreased (inf --> -0.646645).  Saving model ...
Epoch: 2 cost time: 2.511741876602173
Epoch: 2, Steps: 18 | Train Loss: 1.353 Vali Loss: 0.579 Vali Acc: 0.950 Test Loss: 0.579 Test Acc: 0.950
Validation loss decreased (-0.646645 --> -0.949994).  Saving model ...
Epoch: 3 cost time: 2.3647351264953613
Epoch: 3, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
Validation loss decreased (-0.949994 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 2.3217556476593018
Epoch: 4, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.145 Vali Acc: 0.953 Test Loss: 0.145 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2116124629974365
Epoch: 5, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 2.1574573516845703
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.124462604522705
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.3120858669281006
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.466796636581421
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.829210042953491
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6471915245056152
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.7105374336242676
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.7877848148345947
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.7311551570892334
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.605996608734131
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.6007370948791504
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.2974140644073486
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8968684673309326
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.400416374206543
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.4532275199890137
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.668811559677124
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.46343994140625
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4928877353668213
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6111056804656982
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.484555721282959
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6453983783721924
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.818032741546631
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.879373550415039
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.776900053024292
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 2.698181629180908
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 2.465210199356079
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.844193458557129
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 3.13339900970459
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 3.102882146835327
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 3.119249105453491
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.987950325012207
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 2.850101947784424
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 2.854257106781006
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.9490809440612793
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 3.1416378021240234
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 3.2895607948303223
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 3.258660316467285
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.1619184017181396
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.866515636444092
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.8965718746185303
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 2.9180409908294678
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.7703394889831543
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.9416422843933105
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.846473217010498
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 2.4542019367218018
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.3678810596466064
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 3.0314719676971436
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 3.147406816482544
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 3.110069513320923
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.956901788711548
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.8829925060272217
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.7876505851745605
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.9260659217834473
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 3.0335922241210938
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 2.962871551513672
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.478255271911621
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 2.9018568992614746
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 2.877563714981079
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 2.418060302734375
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 2.7706353664398193
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 2.830446481704712
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 2.7429420948028564
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.8206584453582764
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.8400914669036865
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 2.947206735610962
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.944777727127075
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 2.7869231700897217
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.7410471439361572
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 2.820307493209839
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 2.133444309234619
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 2.234894275665283
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 2.6853277683258057
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.487908124923706
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 2.4237136840820312
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 2.5532801151275635
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 2.467334508895874
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 2.7859840393066406
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 2.946657180786133
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 3.0023207664489746
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 3.0375118255615234
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 2.991729259490967
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 3.0192458629608154
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 2.718149423599243
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 2.1055495738983154
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 2.6561968326568604
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 2.7034056186676025
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 2.585927963256836
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 462361
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.054448366165161
Epoch: 1, Steps: 18 | Train Loss: 3.188 Vali Loss: 2.269 Vali Acc: 0.583 Test Loss: 2.269 Test Acc: 0.583
Validation loss decreased (inf --> -0.583311).  Saving model ...
Epoch: 2 cost time: 2.863297700881958
Epoch: 2, Steps: 18 | Train Loss: 1.512 Vali Loss: 0.660 Vali Acc: 0.940 Test Loss: 0.660 Test Acc: 0.940
Validation loss decreased (-0.583311 --> -0.939993).  Saving model ...
Epoch: 3 cost time: 2.7924818992614746
Epoch: 3, Steps: 18 | Train Loss: 0.362 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.939993 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 3.102308511734009
Epoch: 4, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.792145252227783
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.160987377166748
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.987781047821045
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.743222951889038
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 3.0646450519561768
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.7661285400390625
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.998685598373413
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 3.0914547443389893
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8062195777893066
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 3.2521965503692627
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 3.0424137115478516
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 3.0197606086730957
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 3.248586654663086
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.034968376159668
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 3.2708144187927246
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.125655174255371
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1299190521240234
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 3.1609346866607666
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.657487154006958
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.5574066638946533
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.3144989013671875
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.319941520690918
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.475795269012451
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.8699445724487305
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.954817056655884
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.2352538108825684
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 3.206364870071411
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 3.12984037399292
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 3.072913408279419
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.071504592895508
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 3.1895947456359863
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.184380054473877
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.109924554824829
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 3.087073564529419
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 2.8835344314575195
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.5348353385925293
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 2.4559223651885986
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 2.2836263179779053
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.7212090492248535
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.8909733295440674
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 2.832242965698242
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 2.919766664505005
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 3.069054126739502
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 2.9444165229797363
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.7499897480010986
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.827200174331665
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.765547275543213
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 2.7741401195526123
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 2.6815013885498047
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 2.652056932449341
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.542517900466919
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.826303482055664
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.6735692024230957
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.4640915393829346
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.84181547164917
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 2.883784055709839
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 2.9144275188446045
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 2.8941991329193115
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 2.7089996337890625
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.5244359970092773
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 2.7226622104644775
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 2.18359637260437
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 2.647157669067383
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 2.645020008087158
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.495934247970581
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 2.6007068157196045
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 2.6614792346954346
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 2.3840558528900146
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 2.510255813598633
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 2.6077136993408203
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.6672956943511963
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.4793553352355957
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 2.511079788208008
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 2.6432831287384033
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 2.7317726612091064
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 2.6091935634613037
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 2.6359477043151855
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 2.561011791229248
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.836656093597412
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 2.328183889389038
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 2.3013789653778076
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 2.1814942359924316
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 2.6673481464385986
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 2.5672733783721924
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 2.753276824951172
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 2.744105339050293
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 2.6733243465423584
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 2.589749574661255
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 2.8538246154785156
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 434457
model size : 4.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.360122919082642
Epoch: 1, Steps: 18 | Train Loss: 2.135 Vali Loss: 0.441 Vali Acc: 0.873 Test Loss: 0.441 Test Acc: 0.873
Validation loss decreased (inf --> -0.873329).  Saving model ...
Epoch: 2 cost time: 2.512126922607422
Epoch: 2, Steps: 18 | Train Loss: 0.181 Vali Loss: 0.484 Vali Acc: 0.880 Test Loss: 0.484 Test Acc: 0.880
Validation loss decreased (-0.873329 --> -0.879995).  Saving model ...
Epoch: 3 cost time: 2.976546049118042
Epoch: 3, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.399 Vali Acc: 0.897 Test Loss: 0.399 Test Acc: 0.897
Validation loss decreased (-0.879995 --> -0.896663).  Saving model ...
Epoch: 4 cost time: 2.8159117698669434
Epoch: 4, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.566 Vali Acc: 0.880 Test Loss: 0.566 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9910879135131836
Epoch: 5, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.715 Vali Acc: 0.890 Test Loss: 0.715 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.880625009536743
Epoch: 6, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.843 Vali Acc: 0.877 Test Loss: 0.843 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.902501106262207
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.787 Vali Acc: 0.913 Test Loss: 0.787 Test Acc: 0.913
Validation loss decreased (-0.896663 --> -0.913325).  Saving model ...
Epoch: 8 cost time: 3.0406100749969482
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 1.041 Vali Acc: 0.890 Test Loss: 1.041 Test Acc: 0.890
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.582331418991089
Epoch: 9, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.287 Vali Acc: 0.863 Test Loss: 1.287 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6715588569641113
Epoch: 10, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.312 Vali Acc: 0.877 Test Loss: 1.312 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.516808032989502
Epoch: 11, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.269 Vali Acc: 0.887 Test Loss: 1.269 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5375397205352783
Epoch: 12, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.829 Vali Acc: 0.930 Test Loss: 0.829 Test Acc: 0.930
Validation loss decreased (-0.913325 --> -0.929992).  Saving model ...
Epoch: 13 cost time: 2.9233503341674805
Epoch: 13, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.982 Vali Acc: 0.920 Test Loss: 0.982 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7296297550201416
Epoch: 14, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.482 Vali Acc: 0.890 Test Loss: 1.482 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9893674850463867
Epoch: 15, Steps: 18 | Train Loss: 0.310 Vali Loss: 0.884 Vali Acc: 0.890 Test Loss: 0.884 Test Acc: 0.890
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.172193765640259
Epoch: 16, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.657 Vali Acc: 0.940 Test Loss: 0.657 Test Acc: 0.940
Validation loss decreased (-0.929992 --> -0.939993).  Saving model ...
Epoch: 17 cost time: 3.0709147453308105
Epoch: 17, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.856 Vali Acc: 0.927 Test Loss: 0.856 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1980457305908203
Epoch: 18, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.488 Vali Acc: 0.900 Test Loss: 1.488 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.965759515762329
Epoch: 19, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.930 Vali Acc: 0.923 Test Loss: 0.930 Test Acc: 0.923
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8109400272369385
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.705 Vali Acc: 0.930 Test Loss: 0.705 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.7192933559417725
Epoch: 21, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.803 Vali Acc: 0.937 Test Loss: 0.803 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.30094313621521
Epoch: 22, Steps: 18 | Train Loss: 0.020 Vali Loss: 1.084 Vali Acc: 0.903 Test Loss: 1.084 Test Acc: 0.903
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.184345006942749
Epoch: 23, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.289 Vali Acc: 0.897 Test Loss: 1.289 Test Acc: 0.897
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.3860719203948975
Epoch: 24, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.101 Vali Acc: 0.933 Test Loss: 1.101 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.490497589111328
Epoch: 25, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.935 Vali Acc: 0.930 Test Loss: 0.935 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.4871041774749756
Epoch: 26, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.941 Vali Acc: 0.943 Test Loss: 0.941 Test Acc: 0.943
Validation loss decreased (-0.939993 --> -0.943324).  Saving model ...
Epoch: 27 cost time: 3.604482412338257
Epoch: 27, Steps: 18 | Train Loss: 0.041 Vali Loss: 1.477 Vali Acc: 0.933 Test Loss: 1.477 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.172450542449951
Epoch: 28, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.691 Vali Acc: 0.953 Test Loss: 0.691 Test Acc: 0.953
Validation loss decreased (-0.943324 --> -0.953326).  Saving model ...
Epoch: 29 cost time: 3.3094217777252197
Epoch: 29, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.019 Vali Acc: 0.937 Test Loss: 1.019 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.4724981784820557
Epoch: 30, Steps: 18 | Train Loss: 0.183 Vali Loss: 0.895 Vali Acc: 0.947 Test Loss: 0.895 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.797609329223633
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.967 Test Loss: 0.606 Test Acc: 0.967
Validation loss decreased (-0.953326 --> -0.966661).  Saving model ...
Epoch: 32 cost time: 3.5137877464294434
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.963 Test Loss: 0.659 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.445073127746582
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.963 Test Loss: 0.673 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.3250198364257812
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.957 Test Loss: 0.667 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.7903597354888916
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.960 Test Loss: 0.674 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.615527391433716
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.960 Test Loss: 0.673 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.4614992141723633
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.960 Test Loss: 0.668 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.5117907524108887
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.960 Test Loss: 0.661 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.7960245609283447
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.960 Test Loss: 0.671 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.6753931045532227
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.963 Test Loss: 0.670 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.4864749908447266
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.960 Test Loss: 0.658 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 2240665
model size : 11.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 5.408037185668945
Epoch: 1, Steps: 18 | Train Loss: 2.491 Vali Loss: 0.813 Vali Acc: 0.877 Test Loss: 0.813 Test Acc: 0.877
Validation loss decreased (inf --> -0.876659).  Saving model ...
Epoch: 2 cost time: 2.9808809757232666
Epoch: 2, Steps: 18 | Train Loss: 0.322 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
Validation loss decreased (-0.876659 --> -0.943331).  Saving model ...
Epoch: 3 cost time: 2.1634562015533447
Epoch: 3, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.234 Vali Acc: 0.940 Test Loss: 0.234 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3715789318084717
Epoch: 4, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
Validation loss decreased (-0.943331 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 2.505258083343506
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.5272679328918457
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.757718563079834
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2106680870056152
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6150777339935303
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.021982431411743
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2475717067718506
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1641178131103516
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.167088270187378
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.3005659580230713
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.249283790588379
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1204377
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.106491804122925
Epoch: 1, Steps: 18 | Train Loss: 2.784 Vali Loss: 1.278 Vali Acc: 0.873 Test Loss: 1.278 Test Acc: 0.873
Validation loss decreased (inf --> -0.873321).  Saving model ...
Epoch: 2 cost time: 2.64697527885437
Epoch: 2, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.403 Vali Acc: 0.873 Test Loss: 0.403 Test Acc: 0.873
Validation loss decreased (-0.873321 --> -0.873329).  Saving model ...
Epoch: 3 cost time: 2.8078196048736572
Epoch: 3, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
Validation loss decreased (-0.873329 --> -0.936665).  Saving model ...
Epoch: 4 cost time: 2.7334225177764893
Epoch: 4, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.936665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.88981032371521
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 2.874405860900879
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.963 Test Loss: 0.117 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6817610263824463
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 2.8215439319610596
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 9 cost time: 2.411602258682251
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 10 cost time: 2.826794385910034
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7091004848480225
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6825268268585205
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.527679204940796
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.548398971557617
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.894012212753296
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8208465576171875
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.8590259552001953
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.970782518386841
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.1133646965026855
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 859161
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.950693130493164
Epoch: 1, Steps: 18 | Train Loss: 2.823 Vali Loss: 1.519 Vali Acc: 0.860 Test Loss: 1.519 Test Acc: 0.860
Validation loss decreased (inf --> -0.859985).  Saving model ...
Epoch: 2 cost time: 2.5431511402130127
Epoch: 2, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.294 Vali Acc: 0.953 Test Loss: 0.294 Test Acc: 0.953
Validation loss decreased (-0.859985 --> -0.953330).  Saving model ...
Epoch: 3 cost time: 2.264249324798584
Epoch: 3, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.953330 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 2.220510482788086
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.293647289276123
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5007266998291016
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 2.487494707107544
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 2.493034601211548
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 2.580737829208374
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 2.762502670288086
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 2.4506008625030518
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 2.592663526535034
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 2.63070011138916
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 2.583263874053955
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2290761470794678
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 2.4475114345550537
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 2.3884599208831787
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 2.1489059925079346
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 2.2212674617767334
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 2.403545379638672
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2782280445098877
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 2.3528897762298584
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 2.477907657623291
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.3691890239715576
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.2707138061523438
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.325483798980713
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2543044090270996
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.3226282596588135
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.347817897796631
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3429229259490967
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.5617575645446777
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.5872678756713867
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.3467535972595215
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.4610347747802734
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.4061334133148193
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.456800937652588
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.0902154445648193
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.4015095233917236
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 686873
model size : 5.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.018730163574219
Epoch: 1, Steps: 18 | Train Loss: 2.993 Vali Loss: 1.812 Vali Acc: 0.790 Test Loss: 1.812 Test Acc: 0.790
Validation loss decreased (inf --> -0.789982).  Saving model ...
Epoch: 2 cost time: 2.5524168014526367
Epoch: 2, Steps: 18 | Train Loss: 0.953 Vali Loss: 0.367 Vali Acc: 0.940 Test Loss: 0.367 Test Acc: 0.940
Validation loss decreased (-0.789982 --> -0.939996).  Saving model ...
Epoch: 3 cost time: 2.4953317642211914
Epoch: 3, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.939996 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 2.6017630100250244
Epoch: 4, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.9491634368896484
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.624439001083374
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.871180534362793
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8294243812561035
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 2.5153913497924805
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.6761412620544434
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.6825621128082275
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.4602444171905518
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.7250823974609375
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.7640843391418457
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.0602176189422607
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7918262481689453
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5446269512176514
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.25930118560791
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2532196044921875
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.202986717224121
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2687909603118896
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.329718828201294
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.431227684020996
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5017030239105225
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 543769
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.215946435928345
Epoch: 1, Steps: 18 | Train Loss: 3.049 Vali Loss: 2.154 Vali Acc: 0.663 Test Loss: 2.154 Test Acc: 0.663
Validation loss decreased (inf --> -0.663312).  Saving model ...
Epoch: 2 cost time: 2.5922152996063232
Epoch: 2, Steps: 18 | Train Loss: 1.296 Vali Loss: 0.607 Vali Acc: 0.940 Test Loss: 0.607 Test Acc: 0.940
Validation loss decreased (-0.663312 --> -0.939994).  Saving model ...
Epoch: 3 cost time: 2.3796472549438477
Epoch: 3, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
Validation loss decreased (-0.939994 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 2.66273832321167
Epoch: 4, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4958269596099854
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 2.286757469177246
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 2.2030885219573975
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.2315456867218018
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.2077622413635254
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4047298431396484
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.47395658493042
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.309072971343994
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4268383979797363
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2911288738250732
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0928823947906494
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.313929319381714
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.486638069152832
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.5270121097564697
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.5383503437042236
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.268613576889038
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.3237903118133545
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.1174211502075195
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.2092697620391846
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.2732293605804443
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.413207769393921
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.472921848297119
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3557541370391846
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.491865634918213
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.537188768386841
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 2.4654316902160645
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 2.4951655864715576
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.5511858463287354
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 2.5715246200561523
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.4228055477142334
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.324859380722046
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.3151800632476807
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.295815944671631
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.0739991664886475
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.3310770988464355
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.2140140533447266
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.4140100479125977
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.1118123531341553
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 429465
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.4724624156951904
Epoch: 1, Steps: 18 | Train Loss: 3.092 Vali Loss: 2.185 Vali Acc: 0.560 Test Loss: 2.185 Test Acc: 0.560
Validation loss decreased (inf --> -0.559978).  Saving model ...
Epoch: 2 cost time: 1.609466791152954
Epoch: 2, Steps: 18 | Train Loss: 1.427 Vali Loss: 0.648 Vali Acc: 0.940 Test Loss: 0.648 Test Acc: 0.940
Validation loss decreased (-0.559978 --> -0.939994).  Saving model ...
Epoch: 3 cost time: 1.65156888961792
Epoch: 3, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
Validation loss decreased (-0.939994 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.7868037223815918
Epoch: 4, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.6729795932769775
Epoch: 5, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966666).  Saving model ...
Epoch: 6 cost time: 1.7534065246582031
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.966666 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6588695049285889
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8686883449554443
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.8381316661834717
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.907233715057373
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.9400091171264648
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.1953399181365967
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.0482046604156494
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.9034526348114014
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.790985345840454
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.826777696609497
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8797659873962402
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.7835800647735596
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6740403175354004
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.7352569103240967
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.0879502296447754
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.9861626625061035
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.073394536972046
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.253657341003418
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9306390285491943
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9888522624969482
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8372976779937744
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.77630615234375
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.8180766105651855
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.8374786376953125
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 2.1727166175842285
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 2.2146713733673096
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 2.3862268924713135
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.753031015396118
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 2.378770112991333
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 2.6295864582061768
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.5110716819763184
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 2.6267316341400146
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 2.6648061275482178
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.243901491165161
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 2.2723002433776855
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 2.591472625732422
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.3052902221679688
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.7504308223724365
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 2.330702066421509
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 2.4090654850006104
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 2.641996145248413
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.3333234786987305
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 2.4869394302368164
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.5715818405151367
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 2.3258700370788574
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.795691967010498
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.593116283416748
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.7928907871246338
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.7326035499572754
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.070110321044922
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.3634676933288574
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 2.1990859508514404
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 2.449756383895874
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.406316041946411
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 2.2795941829681396
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 2.297145128250122
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 2.502016544342041
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.1010026931762695
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.219054937362671
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.185817003250122
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 2.241856575012207
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 2.185460329055786
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 2.348890781402588
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 2.5185534954071045
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 2.053311347961426
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 2.0230813026428223
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm128_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 401561
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.2201666831970215
Epoch: 1, Steps: 18 | Train Loss: 2.539 Vali Loss: 0.778 Vali Acc: 0.870 Test Loss: 0.778 Test Acc: 0.870
Validation loss decreased (inf --> -0.869992).  Saving model ...
Epoch: 2 cost time: 2.7889277935028076
Epoch: 2, Steps: 18 | Train Loss: 0.300 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.869992 --> -0.929998).  Saving model ...
Epoch: 3 cost time: 2.9651851654052734
Epoch: 3, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
Validation loss decreased (-0.929998 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 2.6758956909179688
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 2.530691385269165
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6697676181793213
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.960 Test Loss: 0.188 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9174399375915527
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 2.7281651496887207
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 2.7319791316986084
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 2.7115674018859863
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 2.6768569946289062
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 2.477146625518799
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 2.515479803085327
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 14 cost time: 2.4756782054901123
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 2.538278341293335
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 2.444681406021118
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 2.7125213146209717
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 2.6822621822357178
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 2.5884125232696533
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 2.5403707027435303
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 2.6168243885040283
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 2.4068143367767334
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 2.454542875289917
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 2.4286956787109375
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 2.7059895992279053
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 2.511240005493164
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 2.588073253631592
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 2.6768136024475098
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 2.6468451023101807
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 2.6088192462921143
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 2.6022629737854004
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 2.4396564960479736
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 2.639284610748291
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 2.665440320968628
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 2.4613473415374756
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.5195353031158447
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 2.55979061126709
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 2.528830051422119
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 2.7193403244018555
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 2.461817502975464
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 41 cost time: 2.584573268890381
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.5969395637512207
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 43 cost time: 2.5431954860687256
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.4043822288513184
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 45 cost time: 2.3478450775146484
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 46 cost time: 2.336256742477417
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 47 cost time: 2.542297124862671
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 48 cost time: 2.416372060775757
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 49 cost time: 2.430267333984375
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 50 cost time: 2.5186257362365723
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.6140177249908447
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 52 cost time: 2.662717819213867
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.363659143447876
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.5164828300476074
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 55 cost time: 2.380549192428589
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 56 cost time: 2.413177251815796
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 57 cost time: 2.7188377380371094
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 58 cost time: 2.6866719722747803
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 59 cost time: 2.4702680110931396
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.5465517044067383
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.760024070739746
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.721129894256592
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 63 cost time: 2.5546324253082275
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.5739948749542236
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.5741536617279053
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.804929494857788
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 67 cost time: 2.8643836975097656
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 68 cost time: 2.4116621017456055
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 69 cost time: 2.317870616912842
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 70 cost time: 2.3890326023101807
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.5435662269592285
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.5712361335754395
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 73 cost time: 2.505467414855957
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 74 cost time: 2.628142833709717
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.523271083831787
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.5480833053588867
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 77 cost time: 2.832655429840088
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 2.532336473464966
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 79 cost time: 2.684041738510132
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 2.6370038986206055
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 2.849008560180664
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 2.6145970821380615
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 83 cost time: 2.3425369262695312
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 2.5251271724700928
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 2.3291757106781006
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 86 cost time: 2.486201524734497
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 2.510268449783325
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 2.5640721321105957
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 89 cost time: 2.576993227005005
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 2.5068962574005127
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 2.6657378673553467
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 92 cost time: 2.650930404663086
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 2.6068246364593506
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 94 cost time: 2.4886136054992676
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 95 cost time: 2.4859306812286377
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 96 cost time: 2.6027352809906006
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 97 cost time: 2.4340109825134277
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 2.355355739593506
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 99 cost time: 2.4697282314300537
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 100 cost time: 2.6853652000427246
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1137177
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.044519662857056
Epoch: 1, Steps: 18 | Train Loss: 2.862 Vali Loss: 1.491 Vali Acc: 0.813 Test Loss: 1.491 Test Acc: 0.813
Validation loss decreased (inf --> -0.813318).  Saving model ...
Epoch: 2 cost time: 2.580463171005249
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.233 Vali Acc: 0.960 Test Loss: 0.233 Test Acc: 0.960
Validation loss decreased (-0.813318 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 2.4044907093048096
Epoch: 3, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 2.230863571166992
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4356327056884766
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.950 Test Loss: 0.146 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5242159366607666
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.1452698707580566
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.3068222999572754
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.535583972930908
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1392343044281006
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.9731507301330566
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.5847339630126953
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 2.3593010902404785
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.0228755474090576
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.163499116897583
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.075697422027588
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.9531333446502686
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.8611586093902588
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.4024817943573
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.227219820022583
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.320887565612793
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.0559089183807373
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2672178745269775
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.0750272274017334
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.243041753768921
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.9934031963348389
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.9002346992492676
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.129885196685791
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.985551118850708
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.001315116882324
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.2326626777648926
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.1941184997558594
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.097522258758545
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9593734741210938
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.06406831741333
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.948420763015747
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 619033
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.5620968341827393
Epoch: 1, Steps: 18 | Train Loss: 3.122 Vali Loss: 2.069 Vali Acc: 0.717 Test Loss: 2.069 Test Acc: 0.717
Validation loss decreased (inf --> -0.716646).  Saving model ...
Epoch: 2 cost time: 2.3228554725646973
Epoch: 2, Steps: 18 | Train Loss: 1.267 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.716646 --> -0.949995).  Saving model ...
Epoch: 3 cost time: 2.312084674835205
Epoch: 3, Steps: 18 | Train Loss: 0.197 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
Validation loss decreased (-0.949995 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 2.3392674922943115
Epoch: 4, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
Validation loss decreased (-0.953331 --> -0.966666).  Saving model ...
Epoch: 5 cost time: 2.101360321044922
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.966666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 2.0442283153533936
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4330945014953613
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.929704189300537
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.244277238845825
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2964677810668945
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.2863383293151855
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9741926193237305
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8959753513336182
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.138098955154419
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.79909348487854
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9071834087371826
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3941333293914795
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0014495849609375
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0982513427734375
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2490811347961426
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 446425
model size : 2.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.677725315093994
Epoch: 1, Steps: 18 | Train Loss: 3.106 Vali Loss: 2.334 Vali Acc: 0.563 Test Loss: 2.334 Test Acc: 0.563
Validation loss decreased (inf --> -0.563310).  Saving model ...
Epoch: 2 cost time: 2.1278328895568848
Epoch: 2, Steps: 18 | Train Loss: 1.636 Vali Loss: 0.780 Vali Acc: 0.913 Test Loss: 0.780 Test Acc: 0.913
Validation loss decreased (-0.563310 --> -0.913326).  Saving model ...
Epoch: 3 cost time: 2.4434731006622314
Epoch: 3, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
Validation loss decreased (-0.913326 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 2.4529731273651123
Epoch: 4, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 2.3926010131835938
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 2.5931806564331055
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.2516839504241943
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.3369059562683105
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.3550782203674316
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4337520599365234
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.4062464237213135
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5372400283813477
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.416633129119873
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4582996368408203
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.3037970066070557
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.4154186248779297
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.2975149154663086
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 2.290044069290161
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.263462781906128
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.212724447250366
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.504709005355835
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.292524576187134
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 2.560610771179199
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 2.3968968391418457
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.3694894313812256
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 2.332921028137207
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 2.36112904548645
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.286536693572998
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.3091273307800293
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.1319496631622314
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.128593921661377
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.1716256141662598
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 2.119105100631714
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 2.1823487281799316
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 2.1775288581848145
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 2.2502691745758057
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 2.1465649604797363
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.128561496734619
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.1726648807525635
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 2.0821242332458496
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 2.2089600563049316
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0903632640838623
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 2.067467451095581
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 2.2051315307617188
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 2.1486401557922363
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.2914626598358154
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.1240086555480957
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 2.1228890419006348
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.291919231414795
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 2.144747734069824
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.10097599029541
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.907270908355713
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.8124008178710938
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.7867746353149414
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.101471424102783
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.008867025375366
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.2274107933044434
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.1921114921569824
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.9787023067474365
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 2.1272435188293457
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 2.3070130348205566
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.060880184173584
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 2.2236762046813965
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 2.29597806930542
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 2.175475835800171
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.0320122241973877
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 2.137810230255127
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 2.231299877166748
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.29193377494812
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 2.3255252838134766
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 2.028258800506592
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 2.2670798301696777
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 2.2755606174468994
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 2.433337450027466
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.133432149887085
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.279815196990967
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 2.3421359062194824
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 2.345623254776001
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 2.020991802215576
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 2.1606099605560303
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 2.0891268253326416
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 2.0828471183776855
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 2.232516050338745
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 2.2107787132263184
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 2.1220993995666504
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 2.4202394485473633
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 2.4028255939483643
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 2.093282461166382
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 2.269477605819702
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 2.101411819458008
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 2.069481372833252
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 2.315526008605957
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 2.1110615730285645
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.9919991493225098
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.7752189636230469
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.8068439960479736
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.822913646697998
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 2.0815131664276123
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 2.381176471710205
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 2.3983075618743896
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 360281
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2478744983673096
Epoch: 1, Steps: 18 | Train Loss: 3.119 Vali Loss: 2.390 Vali Acc: 0.543 Test Loss: 2.390 Test Acc: 0.543
Validation loss decreased (inf --> -0.543309).  Saving model ...
Epoch: 2 cost time: 1.3391976356506348
Epoch: 2, Steps: 18 | Train Loss: 1.753 Vali Loss: 0.939 Vali Acc: 0.913 Test Loss: 0.939 Test Acc: 0.913
Validation loss decreased (-0.543309 --> -0.913324).  Saving model ...
Epoch: 3 cost time: 1.336012363433838
Epoch: 3, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.297 Vali Acc: 0.960 Test Loss: 0.297 Test Acc: 0.960
Validation loss decreased (-0.913324 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 1.3092756271362305
Epoch: 4, Steps: 18 | Train Loss: 0.159 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.3243646621704102
Epoch: 5, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.0496490001678467
Epoch: 6, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.3813607692718506
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.4537477493286133
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.5069243907928467
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3229303359985352
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3820865154266357
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2394509315490723
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.1819477081298828
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.368476390838623
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3744711875915527
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.2245397567749023
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.2719359397888184
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.2521307468414307
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3399767875671387
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.2637763023376465
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.2476966381072998
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.484539270401001
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.404846429824829
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4188129901885986
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.312070369720459
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.212538242340088
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.2772529125213623
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.1807141304016113
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.4057278633117676
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.4854540824890137
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.2967028617858887
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.1974434852600098
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2939152717590332
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.2688324451446533
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.2515628337860107
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.2988808155059814
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.3217737674713135
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.2813899517059326
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.35471510887146
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.5174992084503174
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3950622081756592
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.268547773361206
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.316375494003296
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.237565279006958
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.245081901550293
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.3742084503173828
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.3653557300567627
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.2320992946624756
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4657201766967773
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.2635457515716553
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.3182625770568848
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3514583110809326
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.228395938873291
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.334167242050171
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3979570865631104
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.3016517162322998
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.1966774463653564
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.2871153354644775
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.263962745666504
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.477461814880371
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.350278377532959
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.3335919380187988
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.490356206893921
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3656706809997559
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.511735200881958
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.456477165222168
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.585606575012207
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.4489312171936035
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.5066492557525635
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.5609259605407715
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.4084439277648926
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.3025259971618652
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.3544352054595947
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.464538335800171
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.3229765892028809
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.3320543766021729
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.1575922966003418
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.3206164836883545
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.3135960102081299
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.506932258605957
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.471663475036621
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.4184036254882812
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.4353787899017334
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.2374675273895264
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.2266910076141357
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.3751599788665771
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.424896478652954
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.369542121887207
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.396486520767212
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.4043400287628174
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.2243213653564453
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.2862780094146729
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 1.4181971549987793
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.3824148178100586
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.4391224384307861
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.3339953422546387
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 1.3482286930084229
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 1.2587175369262695
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 1.3209655284881592
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.3088908195495605
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 288729
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0287086963653564
Epoch: 1, Steps: 18 | Train Loss: 3.202 Vali Loss: 2.670 Vali Acc: 0.357 Test Loss: 2.670 Test Acc: 0.357
Validation loss decreased (inf --> -0.356640).  Saving model ...
Epoch: 2 cost time: 1.313835859298706
Epoch: 2, Steps: 18 | Train Loss: 2.210 Vali Loss: 1.425 Vali Acc: 0.850 Test Loss: 1.425 Test Acc: 0.850
Validation loss decreased (-0.356640 --> -0.849986).  Saving model ...
Epoch: 3 cost time: 1.1928324699401855
Epoch: 3, Steps: 18 | Train Loss: 1.020 Vali Loss: 0.551 Vali Acc: 0.953 Test Loss: 0.551 Test Acc: 0.953
Validation loss decreased (-0.849986 --> -0.953328).  Saving model ...
Epoch: 4 cost time: 1.114180088043213
Epoch: 4, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.258 Vali Acc: 0.957 Test Loss: 0.258 Test Acc: 0.957
Validation loss decreased (-0.953328 --> -0.956664).  Saving model ...
Epoch: 5 cost time: 1.282716989517212
Epoch: 5, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.956664 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.2274296283721924
Epoch: 6, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.167165994644165
Epoch: 7, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.2079250812530518
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.2848870754241943
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3512954711914062
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.3211870193481445
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2740962505340576
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.205287218093872
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3502707481384277
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1778638362884521
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2681477069854736
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.31477952003479
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.252471685409546
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.239302396774292
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.2453482151031494
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.2319869995117188
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.19559645652771
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2362232208251953
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.2003533840179443
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3187816143035889
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.3936452865600586
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2394719123840332
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2949891090393066
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.227457046508789
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.196523666381836
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.3201353549957275
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3994770050048828
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.2639994621276855
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.3061914443969727
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2379744052886963
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.2214844226837158
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.3710887432098389
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.3201642036437988
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2324769496917725
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3788912296295166
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2667269706726074
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2663607597351074
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2574200630187988
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2123405933380127
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2888054847717285
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3338687419891357
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.2935361862182617
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2138934135437012
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.296724796295166
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.345487117767334
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.243452548980713
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3333053588867188
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.214508056640625
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2004687786102295
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.2136707305908203
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2882964611053467
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2723751068115234
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.2905642986297607
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2224690914154053
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.2637767791748047
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.1378557682037354
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.3500640392303467
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.3663997650146484
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.3399443626403809
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.3033525943756104
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.2851791381835938
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2801659107208252
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1876575946807861
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.2614080905914307
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.2473783493041992
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.3505973815917969
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.3495147228240967
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.2224342823028564
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.4827113151550293
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.2828700542449951
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.3591599464416504
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.3496999740600586
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.408597707748413
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.3342106342315674
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.265627145767212
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.3740081787109375
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.3599257469177246
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.2792484760284424
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.2204794883728027
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.144540786743164
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.2100629806518555
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.3636667728424072
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.29054856300354
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.3575668334960938
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.2930731773376465
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.3709590435028076
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.3243613243103027
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 1.2223076820373535
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.23478102684021
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.158397912979126
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.2634942531585693
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.1841213703155518
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.390033483505249
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.3359243869781494
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 1.3667831420898438
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 231577
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.872377395629883
Epoch: 1, Steps: 18 | Train Loss: 3.200 Vali Loss: 2.661 Vali Acc: 0.347 Test Loss: 2.661 Test Acc: 0.347
Validation loss decreased (inf --> -0.346640).  Saving model ...
Epoch: 2 cost time: 1.2052867412567139
Epoch: 2, Steps: 18 | Train Loss: 2.249 Vali Loss: 1.445 Vali Acc: 0.857 Test Loss: 1.445 Test Acc: 0.857
Validation loss decreased (-0.346640 --> -0.856652).  Saving model ...
Epoch: 3 cost time: 1.225067377090454
Epoch: 3, Steps: 18 | Train Loss: 1.054 Vali Loss: 0.570 Vali Acc: 0.957 Test Loss: 0.570 Test Acc: 0.957
Validation loss decreased (-0.856652 --> -0.956661).  Saving model ...
Epoch: 4 cost time: 1.2346432209014893
Epoch: 4, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.252 Vali Acc: 0.960 Test Loss: 0.252 Test Acc: 0.960
Validation loss decreased (-0.956661 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 1.2623522281646729
Epoch: 5, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.1703014373779297
Epoch: 6, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2488441467285156
Epoch: 7, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.246100664138794
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.187572956085205
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.381223201751709
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.0800254344940186
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1616106033325195
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.1466078758239746
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1541509628295898
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1490466594696045
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1295063495635986
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2337608337402344
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2491464614868164
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2631874084472656
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1831161975860596
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.190293312072754
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.041609287261963
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 217625
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.8153188228607178
Epoch: 1, Steps: 18 | Train Loss: 2.492 Vali Loss: 0.825 Vali Acc: 0.827 Test Loss: 0.825 Test Acc: 0.827
Validation loss decreased (inf --> -0.826658).  Saving model ...
Epoch: 2 cost time: 2.1833009719848633
Epoch: 2, Steps: 18 | Train Loss: 0.321 Vali Loss: 0.307 Vali Acc: 0.910 Test Loss: 0.307 Test Acc: 0.910
Validation loss decreased (-0.826658 --> -0.909997).  Saving model ...
Epoch: 3 cost time: 1.9846315383911133
Epoch: 3, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
Validation loss decreased (-0.909997 --> -0.936664).  Saving model ...
Epoch: 4 cost time: 2.1103434562683105
Epoch: 4, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (-0.936664 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.9203855991363525
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.9885985851287842
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.265376091003418
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.953 Test Loss: 0.178 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9783167839050293
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.228055000305176
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.935730218887329
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 11 cost time: 2.266756057739258
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 2.0042760372161865
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 2.2188007831573486
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 14 cost time: 2.032515048980713
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 1.9758169651031494
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 2.1325526237487793
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 2.0654261112213135
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 2.0823466777801514
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.9666476249694824
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.7501590251922607
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.7468082904815674
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 1.8793768882751465
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 1.9161677360534668
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 2.114197254180908
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 2.037356376647949
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0345821380615234
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8595118522644043
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 2.145329236984253
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 1.9041690826416016
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 1.9341435432434082
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 2.1256048679351807
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 1.8164644241333008
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 33 cost time: 2.077501058578491
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 34 cost time: 1.917243480682373
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9321296215057373
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 36 cost time: 1.9517524242401123
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1208369731903076
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 38 cost time: 2.155467987060547
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 39 cost time: 1.9916398525238037
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.044328451156616
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 41 cost time: 2.2914347648620605
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 42 cost time: 2.055816650390625
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 43 cost time: 2.262162208557129
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.4045379161834717
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 45 cost time: 2.0142898559570312
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.434466600418091
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.37125301361084
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.439392566680908
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 49 cost time: 2.4095547199249268
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 50 cost time: 2.068500518798828
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 51 cost time: 2.08127760887146
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.2090983390808105
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 2.1724276542663574
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.270683526992798
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.1643588542938232
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.309359550476074
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.063115119934082
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 2.0736806392669678
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.9490108489990234
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.116292715072632
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.097886323928833
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 2.115506649017334
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 2.1898045539855957
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.244600534439087
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 2.1380183696746826
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 2.213602066040039
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 2.191135883331299
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 2.1403067111968994
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 2.191171169281006
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 2.227269172668457
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.128117799758911
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 2.11958646774292
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 2.220480442047119
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.1680920124053955
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 2.0932486057281494
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 2.290536403656006
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 2.094850778579712
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 2.2182610034942627
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 2.118791341781616
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 2.1610519886016846
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 2.259004592895508
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 2.0363950729370117
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 2.118940591812134
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 2.143322229385376
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 2.0207200050354004
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 2.256154775619507
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 2.1259403228759766
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 2.2211380004882812
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 2.3323545455932617
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 2.2146546840667725
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 2.0908901691436768
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 2.030996799468994
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 2.0649027824401855
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 2.2556300163269043
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 2.2178893089294434
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 2.2243926525115967
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 2.150305986404419
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 2.1638545989990234
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 2.2809605598449707
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 2.232865571975708
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1104153
model size : 5.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.013426303863525
Epoch: 1, Steps: 18 | Train Loss: 2.840 Vali Loss: 1.551 Vali Acc: 0.773 Test Loss: 1.551 Test Acc: 0.773
Validation loss decreased (inf --> -0.773318).  Saving model ...
Epoch: 2 cost time: 2.1568048000335693
Epoch: 2, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.328 Vali Acc: 0.933 Test Loss: 0.328 Test Acc: 0.933
Validation loss decreased (-0.773318 --> -0.933330).  Saving model ...
Epoch: 3 cost time: 2.3550281524658203
Epoch: 3, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.936665).  Saving model ...
Epoch: 4 cost time: 2.162144899368286
Epoch: 4, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.219663619995117
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.936665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 2.2950618267059326
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3219096660614014
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 2.268167734146118
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 2.141146659851074
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 2.154874324798584
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 2.1777331829071045
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2261884212493896
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.314523220062256
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 2.1813929080963135
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 2.3483316898345947
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 2.2028706073760986
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2362635135650635
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1787986755371094
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2879478931427
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2029473781585693
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.2468526363372803
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.316419839859009
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.1345937252044678
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1991474628448486
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.181171178817749
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 586009
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9592931270599365
Epoch: 1, Steps: 18 | Train Loss: 3.061 Vali Loss: 2.001 Vali Acc: 0.680 Test Loss: 2.001 Test Acc: 0.680
Validation loss decreased (inf --> -0.679980).  Saving model ...
Epoch: 2 cost time: 2.183242082595825
Epoch: 2, Steps: 18 | Train Loss: 1.114 Vali Loss: 0.446 Vali Acc: 0.943 Test Loss: 0.446 Test Acc: 0.943
Validation loss decreased (-0.679980 --> -0.943329).  Saving model ...
Epoch: 3 cost time: 2.2191522121429443
Epoch: 3, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.943329 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 2.115670919418335
Epoch: 4, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 2.092617988586426
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.0134856700897217
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.9975578784942627
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.4090542793273926
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.2044806480407715
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.1347360610961914
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.271944284439087
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1621127128601074
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.15456485748291
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.3085544109344482
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2468512058258057
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.3701674938201904
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.8599870204925537
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.7706222534179688
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1133930683135986
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.9555881023406982
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.912999153137207
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.9934847354888916
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8904294967651367
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7222247123718262
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.7967021465301514
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.800205945968628
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8310856819152832
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.831169843673706
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8412785530090332
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6161315441131592
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.471364974975586
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.631805181503296
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9941561222076416
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7143921852111816
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 413401
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.114694118499756
Epoch: 1, Steps: 18 | Train Loss: 3.160 Vali Loss: 2.268 Vali Acc: 0.650 Test Loss: 2.268 Test Acc: 0.650
Validation loss decreased (inf --> -0.649977).  Saving model ...
Epoch: 2 cost time: 1.824063777923584
Epoch: 2, Steps: 18 | Train Loss: 1.576 Vali Loss: 0.716 Vali Acc: 0.927 Test Loss: 0.716 Test Acc: 0.927
Validation loss decreased (-0.649977 --> -0.926660).  Saving model ...
Epoch: 3 cost time: 1.7271533012390137
Epoch: 3, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.241 Vali Acc: 0.963 Test Loss: 0.241 Test Acc: 0.963
Validation loss decreased (-0.926660 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.6120805740356445
Epoch: 4, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.9535527229309082
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7597463130950928
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.9037892818450928
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7653582096099854
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.8321664333343506
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.7553887367248535
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.708528757095337
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.826840877532959
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.6948463916778564
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.7186579704284668
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.6922731399536133
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.6224913597106934
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.8142726421356201
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.7253217697143555
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9326953887939453
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8584027290344238
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.8300609588623047
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.9880890846252441
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.890509843826294
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9558916091918945
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8132779598236084
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.741729497909546
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0158236026763916
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6760954856872559
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.970198631286621
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7393412590026855
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7204666137695312
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9181749820709229
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 327257
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.698402166366577
Epoch: 1, Steps: 18 | Train Loss: 3.128 Vali Loss: 2.441 Vali Acc: 0.517 Test Loss: 2.441 Test Acc: 0.517
Validation loss decreased (inf --> -0.516642).  Saving model ...
Epoch: 2 cost time: 1.116318941116333
Epoch: 2, Steps: 18 | Train Loss: 1.812 Vali Loss: 0.987 Vali Acc: 0.917 Test Loss: 0.987 Test Acc: 0.917
Validation loss decreased (-0.516642 --> -0.916657).  Saving model ...
Epoch: 3 cost time: 1.1422054767608643
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.323 Vali Acc: 0.957 Test Loss: 0.323 Test Acc: 0.957
Validation loss decreased (-0.916657 --> -0.956663).  Saving model ...
Epoch: 4 cost time: 1.1008689403533936
Epoch: 4, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.1223955154418945
Epoch: 5, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.127547264099121
Epoch: 6, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.967 Test Loss: 0.122 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1431334018707275
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9909474849700928
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0453989505767822
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.0111491680145264
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.0368635654449463
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1152679920196533
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1180360317230225
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1015992164611816
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.1370790004730225
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2036008834838867
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0430233478546143
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1609323024749756
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2054967880249023
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.2182579040527344
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.2241864204406738
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.167698621749878
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.212756633758545
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.186743974685669
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2071819305419922
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1727252006530762
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2256810665130615
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.152764081954956
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.178049087524414
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.1567649841308594
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1905701160430908
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.1989402770996094
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.2047743797302246
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.213834285736084
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.0798616409301758
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.133903980255127
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.107611894607544
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.206481695175171
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.16813325881958
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0750057697296143
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1203813552856445
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.127338171005249
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.1540098190307617
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.2135369777679443
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.2634716033935547
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.1495320796966553
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.1849699020385742
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.2619719505310059
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.1529817581176758
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1597092151641846
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0837485790252686
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1209988594055176
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.0909247398376465
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.079444408416748
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.212674856185913
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1693835258483887
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.2225048542022705
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.2064130306243896
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2066950798034668
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.1744072437286377
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1849157810211182
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.1130688190460205
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.1282117366790771
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.1092283725738525
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 255705
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.809809923171997
Epoch: 1, Steps: 18 | Train Loss: 3.257 Vali Loss: 2.716 Vali Acc: 0.310 Test Loss: 2.716 Test Acc: 0.310
Validation loss decreased (inf --> -0.309973).  Saving model ...
Epoch: 2 cost time: 1.1887428760528564
Epoch: 2, Steps: 18 | Train Loss: 2.237 Vali Loss: 1.487 Vali Acc: 0.850 Test Loss: 1.487 Test Acc: 0.850
Validation loss decreased (-0.309973 --> -0.849985).  Saving model ...
Epoch: 3 cost time: 1.073509693145752
Epoch: 3, Steps: 18 | Train Loss: 1.072 Vali Loss: 0.607 Vali Acc: 0.957 Test Loss: 0.607 Test Acc: 0.957
Validation loss decreased (-0.849985 --> -0.956661).  Saving model ...
Epoch: 4 cost time: 1.1442596912384033
Epoch: 4, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.269 Vali Acc: 0.967 Test Loss: 0.269 Test Acc: 0.967
Validation loss decreased (-0.956661 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 1.1122753620147705
Epoch: 5, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.221088171005249
Epoch: 6, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.1310880184173584
Epoch: 7, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.1047937870025635
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.1144652366638184
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.206519603729248
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.1634743213653564
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1356799602508545
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1158356666564941
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1178607940673828
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2144880294799805
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.2419617176055908
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.1791093349456787
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1845386028289795
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1572487354278564
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.1588306427001953
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.2349729537963867
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.2354388236999512
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1430332660675049
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1818451881408691
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.1671159267425537
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.2217075824737549
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1375751495361328
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.110771894454956
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.2223327159881592
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.172839879989624
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.1118433475494385
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0537278652191162
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1330010890960693
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.1639134883880615
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1751468181610107
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2905914783477783
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1354012489318848
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.108034372329712
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.20817232131958
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.234661340713501
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1114411354064941
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.168539047241211
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.1863839626312256
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.1397333145141602
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.1627819538116455
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1682796478271484
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.2516651153564453
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.169602870941162
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2596065998077393
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2319200038909912
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.2122159004211426
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.1861469745635986
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2122952938079834
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.1883840560913086
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.1657638549804688
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.2225756645202637
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.2640867233276367
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.1531872749328613
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.2776579856872559
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0827598571777344
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.1902976036071777
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.1726186275482178
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.1692931652069092
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.1942083835601807
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.192765235900879
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.202650547027588
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.1070377826690674
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.249023675918579
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.2109968662261963
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.3043420314788818
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.208512783050537
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.2122950553894043
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.2809619903564453
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.2253243923187256
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.1939318180084229
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.1417529582977295
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.0882904529571533
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.0837318897247314
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.1440794467926025
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.2117254734039307
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.1446294784545898
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.1253647804260254
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.0706126689910889
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.1451504230499268
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.1190452575683594
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.1667768955230713
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.084287166595459
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.2225701808929443
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.0583457946777344
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 1.1106541156768799
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.9970555305480957
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.1205518245697021
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.2042691707611084
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.140423059463501
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.196312665939331
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.108670949935913
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.0685145854949951
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.088808536529541
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.1359429359436035
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.0789093971252441
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 198553
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.962679624557495
Epoch: 1, Steps: 18 | Train Loss: 3.242 Vali Loss: 2.663 Vali Acc: 0.333 Test Loss: 2.663 Test Acc: 0.333
Validation loss decreased (inf --> -0.333307).  Saving model ...
Epoch: 2 cost time: 1.0497376918792725
Epoch: 2, Steps: 18 | Train Loss: 2.249 Vali Loss: 1.456 Vali Acc: 0.880 Test Loss: 1.456 Test Acc: 0.880
Validation loss decreased (-0.333307 --> -0.879985).  Saving model ...
Epoch: 3 cost time: 1.0952868461608887
Epoch: 3, Steps: 18 | Train Loss: 1.104 Vali Loss: 0.573 Vali Acc: 0.963 Test Loss: 0.573 Test Acc: 0.963
Validation loss decreased (-0.879985 --> -0.963328).  Saving model ...
Epoch: 4 cost time: 1.033815860748291
Epoch: 4, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.243 Vali Acc: 0.970 Test Loss: 0.243 Test Acc: 0.970
Validation loss decreased (-0.963328 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.0703420639038086
Epoch: 5, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0461232662200928
Epoch: 6, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.0793914794921875
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.0966649055480957
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0854723453521729
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.1313745975494385
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.0787544250488281
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.0546455383300781
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1487903594970703
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.215393304824829
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.0208966732025146
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1167175769805908
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0379219055175781
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9622550010681152
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0552217960357666
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0339112281799316
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.0526275634765625
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.165358543395996
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0556280612945557
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0396034717559814
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0862760543823242
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1498792171478271
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1484193801879883
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.1026225090026855
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.1141903400421143
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0760529041290283
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1881670951843262
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.1447157859802246
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.1053786277770996
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.1254427433013916
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0961344242095947
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.2450096607208252
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.083873987197876
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.1195180416107178
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.0703563690185547
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.094330072402954
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.1851856708526611
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1430268287658691
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.1461422443389893
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2662055492401123
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0361645221710205
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.1315233707427979
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1872012615203857
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.13643217086792
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.1185312271118164
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1248242855072021
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.123255968093872
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.005570888519287
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.020524024963379
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.9587814807891846
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.0559089183807373
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0241527557373047
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1939170360565186
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.193760633468628
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.1392440795898438
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2010822296142578
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.1007091999053955
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.1897556781768799
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.009495735168457
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 64 cost time: 1.1424376964569092
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.198645830154419
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.163966178894043
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.1170101165771484
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.0826609134674072
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.038461685180664
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.143484354019165
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.1645970344543457
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.0976829528808594
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.1378710269927979
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 74 cost time: 1.2334203720092773
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 75 cost time: 1.1464529037475586
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 76 cost time: 1.172623634338379
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 77 cost time: 1.208280324935913
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.2297558784484863
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.1548097133636475
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 80 cost time: 1.1037254333496094
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.2297160625457764
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.0519824028015137
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.1951112747192383
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.1096827983856201
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.26072359085083
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 86 cost time: 1.1726868152618408
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 87 cost time: 1.1286516189575195
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 88 cost time: 1.213658094406128
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 89 cost time: 1.2221286296844482
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.0926318168640137
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 91 cost time: 1.1411020755767822
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.1684188842773438
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.234590768814087
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.2571508884429932
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.1537058353424072
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 96 cost time: 1.1221544742584229
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 97 cost time: 1.165771484375
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 98 cost time: 1.1780259609222412
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.1412017345428467
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 100 cost time: 1.1429009437561035
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 184601
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.109645843505859
Epoch: 1, Steps: 18 | Train Loss: 2.493 Vali Loss: 0.795 Vali Acc: 0.843 Test Loss: 0.795 Test Acc: 0.843
Validation loss decreased (inf --> -0.843325).  Saving model ...
Epoch: 2 cost time: 2.4580423831939697
Epoch: 2, Steps: 18 | Train Loss: 0.291 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
Validation loss decreased (-0.843325 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 2.4517791271209717
Epoch: 3, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
Validation loss decreased (-0.953332 --> -0.959999).  Saving model ...
Epoch: 4 cost time: 2.429154634475708
Epoch: 4, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.210 Vali Acc: 0.953 Test Loss: 0.210 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5434250831604004
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.5457663536071777
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.27071213722229
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.251528024673462
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 2.2272160053253174
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4225685596466064
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 2.4573841094970703
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.58328914642334
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 2.5258748531341553
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.4010009765625
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.4150454998016357
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.461216926574707
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.5408828258514404
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.623426914215088
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.3849105834960938
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.6163153648376465
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.589240074157715
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4443702697753906
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 2.504599094390869
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3575425148010254
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.362875461578369
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.5000977516174316
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.3893609046936035
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.456878900527954
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3375370502471924
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.381216526031494
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.4712278842926025
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.66438889503479
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.5474298000335693
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.4610228538513184
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.42791748046875
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.47976016998291
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1087641
model size : 5.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.743723154067993
Epoch: 1, Steps: 18 | Train Loss: 2.841 Vali Loss: 1.556 Vali Acc: 0.810 Test Loss: 1.556 Test Acc: 0.810
Validation loss decreased (inf --> -0.809984).  Saving model ...
Epoch: 2 cost time: 1.898979902267456
Epoch: 2, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.318 Vali Acc: 0.947 Test Loss: 0.318 Test Acc: 0.947
Validation loss decreased (-0.809984 --> -0.946663).  Saving model ...
Epoch: 3 cost time: 1.9158756732940674
Epoch: 3, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.946663 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.911912202835083
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8967547416687012
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.8916010856628418
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.960 Test Loss: 0.147 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9766812324523926
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.149172067642212
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3025271892547607
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3415915966033936
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.298954486846924
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.311121940612793
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.528111696243286
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.265235662460327
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.356250047683716
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.7795963287353516
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.236506700515747
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 2.4192237854003906
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.181523084640503
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.0181944370269775
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.7775506973266602
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.8684933185577393
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.8586292266845703
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.8023767471313477
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 2.216583013534546
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1766016483306885
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1624414920806885
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.772392988204956
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.4304490089416504
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.4921693801879883
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.7709550857543945
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.448991298675537
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.8929624557495117
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9183557033538818
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7781376838684082
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6499571800231934
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 2.1789491176605225
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 2.217155933380127
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 2.305619955062866
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 1.8499698638916016
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 1.721954345703125
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.760328769683838
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9299368858337402
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 1.9120233058929443
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 2.2206532955169678
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 2.2157928943634033
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.9069058895111084
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5315942764282227
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 49 cost time: 1.9617526531219482
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.9943172931671143
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 51 cost time: 1.9097199440002441
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.983583927154541
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.8682372570037842
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 54 cost time: 1.5997939109802246
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 55 cost time: 1.7787463665008545
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 56 cost time: 1.7613990306854248
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.8862314224243164
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.0833852291107178
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 2.020153284072876
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 2.124253511428833
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 2.17055082321167
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.9382045269012451
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.630885362625122
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 64 cost time: 1.574540138244629
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.8433902263641357
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.8739042282104492
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 2.1387598514556885
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 2.131812572479248
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.9008266925811768
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.741518259048462
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.5404860973358154
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 2.193765640258789
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 2.116394519805908
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 569497
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.7646355628967285
Epoch: 1, Steps: 18 | Train Loss: 3.074 Vali Loss: 2.044 Vali Acc: 0.710 Test Loss: 2.044 Test Acc: 0.710
Validation loss decreased (inf --> -0.709980).  Saving model ...
Epoch: 2 cost time: 2.085869789123535
Epoch: 2, Steps: 18 | Train Loss: 1.223 Vali Loss: 0.494 Vali Acc: 0.967 Test Loss: 0.494 Test Acc: 0.967
Validation loss decreased (-0.709980 --> -0.966662).  Saving model ...
Epoch: 3 cost time: 2.0262467861175537
Epoch: 3, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0148489475250244
Epoch: 4, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.966662 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 2.0164778232574463
Epoch: 5, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.734006643295288
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.785865306854248
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.128931999206543
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0276308059692383
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8676257133483887
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7885143756866455
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7749688625335693
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.1114773750305176
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.0749740600585938
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.2026302814483643
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2659389972686768
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.095513343811035
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 2.0791409015655518
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8783364295959473
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.9680142402648926
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9966850280761719
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.183434247970581
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 2.111997127532959
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.957153081893921
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1672356128692627
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.077004909515381
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 2.0198073387145996
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 2.1235249042510986
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 2.067721366882324
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 2.1056532859802246
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0292673110961914
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.261681079864502
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 2.1244046688079834
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 2.0954575538635254
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.125990152359009
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 2.0191805362701416
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9286632537841797
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.0095815658569336
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.2557380199432373
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.2845897674560547
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 2.0160140991210938
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9196131229400635
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8111176490783691
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7237234115600586
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.0125844478607178
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.104400396347046
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.0691134929656982
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.870466947555542
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.954662561416626
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.026308536529541
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 396889
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.475416421890259
Epoch: 1, Steps: 18 | Train Loss: 3.104 Vali Loss: 2.295 Vali Acc: 0.553 Test Loss: 2.295 Test Acc: 0.553
Validation loss decreased (inf --> -0.553310).  Saving model ...
Epoch: 2 cost time: 1.9731757640838623
Epoch: 2, Steps: 18 | Train Loss: 1.586 Vali Loss: 0.778 Vali Acc: 0.927 Test Loss: 0.778 Test Acc: 0.927
Validation loss decreased (-0.553310 --> -0.926659).  Saving model ...
Epoch: 3 cost time: 2.054680347442627
Epoch: 3, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.237 Vali Acc: 0.967 Test Loss: 0.237 Test Acc: 0.967
Validation loss decreased (-0.926659 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 2.1503283977508545
Epoch: 4, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0726065635681152
Epoch: 5, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.0157172679901123
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 2.048261880874634
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.044968366622925
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 2.140591621398926
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.214341640472412
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1243910789489746
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.136021852493286
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 2.182720184326172
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.987217664718628
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.9698350429534912
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.3048946857452393
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.0675156116485596
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.2179133892059326
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1653363704681396
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1331493854522705
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.0435941219329834
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.218010663986206
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.178691864013672
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.2065234184265137
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.110858917236328
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 2.080378293991089
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0987515449523926
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.165024757385254
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9859724044799805
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.9813311100006104
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 2.008469581604004
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.8743336200714111
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.507877826690674
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4727635383605957
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.127514600753784
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2721168994903564
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.2677597999572754
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 2.39910888671875
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 2.480274200439453
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.607605457305908
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 2.60871958732605
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 2.495349645614624
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.398130416870117
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.357276201248169
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.4845283031463623
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.6223340034484863
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.684298276901245
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.10506010055542
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.154010534286499
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.2368905544281006
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.3689005374908447
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.3392434120178223
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 310745
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7352981567382812
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.493 Vali Acc: 0.507 Test Loss: 2.493 Test Acc: 0.507
Validation loss decreased (inf --> -0.506642).  Saving model ...
Epoch: 2 cost time: 1.2014343738555908
Epoch: 2, Steps: 18 | Train Loss: 1.820 Vali Loss: 1.035 Vali Acc: 0.907 Test Loss: 1.035 Test Acc: 0.907
Validation loss decreased (-0.506642 --> -0.906656).  Saving model ...
Epoch: 3 cost time: 1.3510560989379883
Epoch: 3, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.336 Vali Acc: 0.963 Test Loss: 0.336 Test Acc: 0.963
Validation loss decreased (-0.906656 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 1.2141168117523193
Epoch: 4, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.3453869819641113
Epoch: 5, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3660876750946045
Epoch: 6, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2586448192596436
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.1370980739593506
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.1749732494354248
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.2257390022277832
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1372981071472168
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.19454026222229
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1074635982513428
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.9968714714050293
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.12977933883667
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1327462196350098
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.2081818580627441
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1637794971466064
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.0625088214874268
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0423192977905273
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1193273067474365
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1710765361785889
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1267504692077637
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1593239307403564
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0818829536437988
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.120833396911621
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.1627001762390137
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.2262802124023438
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.2603404521942139
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.274233341217041
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3032822608947754
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.359882116317749
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.2800037860870361
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2657310962677002
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2077479362487793
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1365153789520264
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0730688571929932
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1188075542449951
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.0325477123260498
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.0801646709442139
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1333692073822021
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.0313475131988525
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.018995761871338
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1657779216766357
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0170392990112305
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.1890912055969238
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.411811351776123
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2300970554351807
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.1156947612762451
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.0844395160675049
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1710436344146729
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.0633625984191895
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0439765453338623
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.168708086013794
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0940892696380615
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.3012678623199463
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.2418444156646729
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.3498058319091797
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.2215051651000977
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.1407039165496826
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.0535457134246826
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.1905903816223145
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.081247329711914
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.1345419883728027
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.1696860790252686
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.145021915435791
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.2797813415527344
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.1634979248046875
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.2091083526611328
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.0833015441894531
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 0.9961979389190674
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.0130021572113037
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 0.9841194152832031
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.0722410678863525
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.0655457973480225
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.1257898807525635
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.1860454082489014
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.141352653503418
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.1506717205047607
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.1255872249603271
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.237381935119629
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.2180883884429932
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.1648457050323486
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.0719304084777832
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.052056074142456
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.0484118461608887
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.06718111038208
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.0102334022521973
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.1637022495269775
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.093400478363037
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.124572992324829
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.1472911834716797
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.1632750034332275
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 1.1595442295074463
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.0874464511871338
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.0206544399261475
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.007777214050293
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 0.9018168449401855
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.2574214935302734
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.185197114944458
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 239193
model size : 2.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.635476589202881
Epoch: 1, Steps: 18 | Train Loss: 3.202 Vali Loss: 2.679 Vali Acc: 0.313 Test Loss: 2.679 Test Acc: 0.313
Validation loss decreased (inf --> -0.313307).  Saving model ...
Epoch: 2 cost time: 1.1102769374847412
Epoch: 2, Steps: 18 | Train Loss: 2.195 Vali Loss: 1.469 Vali Acc: 0.847 Test Loss: 1.469 Test Acc: 0.847
Validation loss decreased (-0.313307 --> -0.846652).  Saving model ...
Epoch: 3 cost time: 1.1108438968658447
Epoch: 3, Steps: 18 | Train Loss: 1.059 Vali Loss: 0.590 Vali Acc: 0.923 Test Loss: 0.590 Test Acc: 0.923
Validation loss decreased (-0.846652 --> -0.923327).  Saving model ...
Epoch: 4 cost time: 1.1154148578643799
Epoch: 4, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.257 Vali Acc: 0.963 Test Loss: 0.257 Test Acc: 0.963
Validation loss decreased (-0.923327 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 1.0792467594146729
Epoch: 5, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.1242482662200928
Epoch: 6, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.103783369064331
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.0920028686523438
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1620101928710938
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1481707096099854
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.1023025512695312
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.1186330318450928
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.1192834377288818
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1542632579803467
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1203107833862305
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1177101135253906
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1067616939544678
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0950307846069336
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.1271090507507324
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1042993068695068
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.15972900390625
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0389280319213867
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.037578821182251
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0998094081878662
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.122319221496582
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0320684909820557
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0504224300384521
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.0582728385925293
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.161790132522583
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.1516203880310059
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1467933654785156
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.1358182430267334
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.174349069595337
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0683488845825195
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.1387262344360352
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1678147315979004
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.0901134014129639
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.092714786529541
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.1000134944915771
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.0517339706420898
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.061079978942871
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.1402454376220703
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.143784999847412
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0885250568389893
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0280258655548096
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.0653626918792725
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.0820896625518799
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.053642749786377
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.09716796875
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.0729856491088867
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.1490890979766846
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.060805320739746
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0205366611480713
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.102233648300171
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.977 Test Loss: 0.068 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.080979585647583
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 0.980963945388794
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.0386884212493896
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.140700340270996
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.103257417678833
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.1020536422729492
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.130460262298584
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.124230146408081
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1103999614715576
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.0694386959075928
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.0881516933441162
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 66 cost time: 1.1033315658569336
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1147634983062744
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.977 Test Loss: 0.067 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0975775718688965
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 1.1456527709960938
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.043701410293579
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 1.0520286560058594
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.0506103038787842
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.977 Test Loss: 0.066 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0750911235809326
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 1.0251290798187256
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 1.1099097728729248
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.0669927597045898
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 1.1051585674285889
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 78 cost time: 1.1032805442810059
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.977 Test Loss: 0.065 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.0626685619354248
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.073293924331665
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.078768014907837
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.0913546085357666
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.1249041557312012
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.0531103610992432
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.0899138450622559
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.0118112564086914
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 1.1312966346740723
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.1315176486968994
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.2121429443359375
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.2946383953094482
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.3613536357879639
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.330815315246582
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.2981345653533936
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.2421891689300537
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.977 Test Loss: 0.064 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.228076696395874
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.2818801403045654
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.2508330345153809
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.2444312572479248
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.425459384918213
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.3036024570465088
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 182041
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7432615756988525
Epoch: 1, Steps: 18 | Train Loss: 3.241 Vali Loss: 2.812 Vali Acc: 0.257 Test Loss: 2.812 Test Acc: 0.257
Validation loss decreased (inf --> -0.256639).  Saving model ...
Epoch: 2 cost time: 1.3499290943145752
Epoch: 2, Steps: 18 | Train Loss: 2.255 Vali Loss: 1.564 Vali Acc: 0.827 Test Loss: 1.564 Test Acc: 0.827
Validation loss decreased (-0.256639 --> -0.826651).  Saving model ...
Epoch: 3 cost time: 1.4810354709625244
Epoch: 3, Steps: 18 | Train Loss: 1.167 Vali Loss: 0.635 Vali Acc: 0.943 Test Loss: 0.635 Test Acc: 0.943
Validation loss decreased (-0.826651 --> -0.943327).  Saving model ...
Epoch: 4 cost time: 1.3048760890960693
Epoch: 4, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.273 Vali Acc: 0.973 Test Loss: 0.273 Test Acc: 0.973
Validation loss decreased (-0.943327 --> -0.973331).  Saving model ...
Epoch: 5 cost time: 1.3855226039886475
Epoch: 5, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4649736881256104
Epoch: 6, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.340235710144043
Epoch: 7, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.2723362445831299
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3206799030303955
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.4065032005310059
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3682506084442139
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.359889268875122
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.386770486831665
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1775999069213867
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2410023212432861
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.3133268356323242
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.3285017013549805
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.328106164932251
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.13226318359375
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.2273740768432617
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.2372777462005615
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.192396640777588
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.3758087158203125
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.2626948356628418
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.350109338760376
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.2911429405212402
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.3609416484832764
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.8038196563720703
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.2028956413269043
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.214766502380371
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.131758213043213
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.1823744773864746
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2961719036102295
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3002374172210693
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.1365323066711426
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.310131311416626
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.3136093616485596
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.2965242862701416
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.3322060108184814
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.340726375579834
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.2397379875183105
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1672587394714355
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.1486315727233887
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1692469120025635
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.096637487411499
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0778589248657227
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2727608680725098
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2503063678741455
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1986548900604248
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2973554134368896
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.409209966659546
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.2418155670166016
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.346113681793213
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.313725471496582
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.332089900970459
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.3726801872253418
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.3341865539550781
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.4640791416168213
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.293569564819336
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.2890732288360596
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1375980377197266
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.206613302230835
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.2579305171966553
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2352197170257568
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.2424283027648926
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.209531545639038
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.2997961044311523
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.2018539905548096
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.134800910949707
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.2408416271209717
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.2094597816467285
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.2708768844604492
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.1990714073181152
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.2257511615753174
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1667346954345703
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.2217743396759033
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.2641804218292236
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.2683091163635254
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.2492692470550537
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.3067078590393066
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.393242359161377
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.2799782752990723
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.387718677520752
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.3277010917663574
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.3533077239990234
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 1.1891000270843506
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 1.178964376449585
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.197916030883789
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.2749176025390625
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.2520475387573242
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.2743422985076904
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.206779956817627
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.3051650524139404
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.2927334308624268
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 95 cost time: 1.260230302810669
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.3026905059814453
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.2941772937774658
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.3638200759887695
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.363219976425171
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 1.241743564605713
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm64_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 168089
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.340693235397339
Epoch: 1, Steps: 18 | Train Loss: 2.809 Vali Loss: 1.393 Vali Acc: 0.843 Test Loss: 1.393 Test Acc: 0.843
Validation loss decreased (inf --> -0.843319).  Saving model ...
Epoch: 2 cost time: 1.6956026554107666
Epoch: 2, Steps: 18 | Train Loss: 0.640 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
Validation loss decreased (-0.843319 --> -0.956664).  Saving model ...
Epoch: 3 cost time: 1.5599632263183594
Epoch: 3, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.956664 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.6539552211761475
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.550994634628296
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.501901388168335
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.658789873123169
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5706818103790283
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3327744007110596
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4428322315216064
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.495697021484375
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.5870468616485596
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.5808448791503906
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6174440383911133
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5710105895996094
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6669132709503174
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.762547492980957
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6265919208526611
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6387157440185547
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6391584873199463
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.624286413192749
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.642744541168213
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5351207256317139
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6486899852752686
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7009015083312988
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5769243240356445
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.6538724899291992
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8070988655090332
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.808037519454956
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.7950811386108398
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.8023905754089355
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6706392765045166
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.712611198425293
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.6777653694152832
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6709604263305664
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7334961891174316
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.631685495376587
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6458740234375
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.5811476707458496
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6295502185821533
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.5885772705078125
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6310205459594727
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5843863487243652
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6846544742584229
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6540942192077637
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.6286194324493408
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.7656078338623047
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.6719636917114258
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.69317626953125
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.7005336284637451
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 560665
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.9481265544891357
Epoch: 1, Steps: 18 | Train Loss: 3.079 Vali Loss: 2.186 Vali Acc: 0.660 Test Loss: 2.186 Test Acc: 0.660
Validation loss decreased (inf --> -0.659978).  Saving model ...
Epoch: 2 cost time: 2.077016592025757
Epoch: 2, Steps: 18 | Train Loss: 1.455 Vali Loss: 0.626 Vali Acc: 0.953 Test Loss: 0.626 Test Acc: 0.953
Validation loss decreased (-0.659978 --> -0.953327).  Saving model ...
Epoch: 3 cost time: 1.9194223880767822
Epoch: 3, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.220 Vali Acc: 0.947 Test Loss: 0.220 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.150742769241333
Epoch: 4, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.953327 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 2.218655586242676
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3160741329193115
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 2.1494805812835693
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.366532802581787
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 2.270296812057495
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 2.1460509300231934
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 2.3126723766326904
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.1087512969970703
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.1963722705841064
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.0378575325012207
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8477983474731445
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 2.4251596927642822
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 2.34122896194458
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 2.3200290203094482
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.3365797996520996
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.391029119491577
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.448402166366577
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.111060857772827
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 2.075942277908325
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.9653997421264648
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.0640077590942383
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.285412311553955
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.186741828918457
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9662117958068848
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.4127280712127686
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.2278566360473633
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.3646974563598633
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 2.1727757453918457
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 2.342895746231079
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.3386168479919434
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 2.316772699356079
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.2413523197174072
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.2497332096099854
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.15472674369812
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 2.0763280391693115
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 2.489454507827759
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 2.653832197189331
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 2.8755362033843994
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.7759649753570557
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 2.8018171787261963
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.744748115539551
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.750932455062866
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.8129966259002686
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.5139365196228027
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.5381321907043457
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.54194712638855
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.641757011413574
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.822202444076538
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 2.1898720264434814
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 2.2891507148742676
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 2.1950738430023193
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 2.1758389472961426
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 2.5545201301574707
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 2.4344656467437744
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 2.669318914413452
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.540266513824463
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.4474706649780273
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 2.4711625576019287
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 2.460545063018799
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 2.5669400691986084
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 2.4664134979248047
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 2.086211681365967
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 2.5770368576049805
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 2.773472309112549
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 2.754817008972168
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 2.444979667663574
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 2.4722607135772705
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 2.6594886779785156
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 2.6869025230407715
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 2.1306955814361572
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.9260339736938477
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 2.287468433380127
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 2.2778916358947754
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 2.592543601989746
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 2.5763025283813477
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 2.4336512088775635
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 2.442230463027954
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 2.4157655239105225
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 301593
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.076019287109375
Epoch: 1, Steps: 18 | Train Loss: 3.251 Vali Loss: 2.622 Vali Acc: 0.430 Test Loss: 2.622 Test Acc: 0.430
Validation loss decreased (inf --> -0.429974).  Saving model ...
Epoch: 2 cost time: 1.3993887901306152
Epoch: 2, Steps: 18 | Train Loss: 2.040 Vali Loss: 1.194 Vali Acc: 0.913 Test Loss: 1.194 Test Acc: 0.913
Validation loss decreased (-0.429974 --> -0.913321).  Saving model ...
Epoch: 3 cost time: 1.4744999408721924
Epoch: 3, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.374 Vali Acc: 0.960 Test Loss: 0.374 Test Acc: 0.960
Validation loss decreased (-0.913321 --> -0.959996).  Saving model ...
Epoch: 4 cost time: 1.4323511123657227
Epoch: 4, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 1.3172073364257812
Epoch: 5, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.2632899284362793
Epoch: 6, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.2512943744659424
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.3281269073486328
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.348022222518921
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.4544360637664795
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.4016618728637695
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.3699653148651123
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4205853939056396
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3648788928985596
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.3512320518493652
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.3045284748077393
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 1.4833364486694336
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 1.229029655456543
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.1454942226409912
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 1.2190337181091309
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.2188043594360352
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 1.1648333072662354
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.2450339794158936
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.3239881992340088
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.354318618774414
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.4515235424041748
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3693013191223145
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.39631986618042
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.345508098602295
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.364900827407837
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.4055936336517334
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.270984172821045
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.2244765758514404
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.1993539333343506
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2355637550354004
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.2676544189453125
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.214724063873291
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.275285005569458
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.2865431308746338
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.2640628814697266
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.3692009449005127
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.4823997020721436
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.343306303024292
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3874132633209229
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3272337913513184
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.3012642860412598
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.3112761974334717
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1819212436676025
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.317704677581787
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.2250263690948486
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.2508764266967773
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3369715213775635
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.1810178756713867
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.0589218139648438
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.38216233253479
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.3025586605072021
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.358808994293213
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.2855048179626465
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2671058177947998
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.2415895462036133
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.263249158859253
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1454102993011475
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.3356819152832031
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.450533151626587
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.2161290645599365
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.3051750659942627
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.3474678993225098
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.3067986965179443
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1302030086517334
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.3175830841064453
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.1888065338134766
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.310347557067871
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.1310174465179443
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.0702362060546875
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.2483043670654297
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.1034324169158936
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.0821080207824707
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.1141951084136963
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.1445388793945312
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1309537887573242
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.123699426651001
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 1.214285135269165
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.0930488109588623
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.9924297332763672
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 0.988999605178833
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.1855297088623047
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.288661003112793
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.315087080001831
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.211822271347046
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.2315607070922852
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.123323678970337
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.0699052810668945
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.2266578674316406
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.185007095336914
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.1466290950775146
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 1.2268328666687012
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 1.2762503623962402
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 1.2714920043945312
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 1.280632495880127
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 1.2494938373565674
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 215289
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5079452991485596
Epoch: 1, Steps: 18 | Train Loss: 3.266 Vali Loss: 2.810 Vali Acc: 0.273 Test Loss: 2.810 Test Acc: 0.273
Validation loss decreased (inf --> -0.273305).  Saving model ...
Epoch: 2 cost time: 1.013742208480835
Epoch: 2, Steps: 18 | Train Loss: 2.445 Vali Loss: 1.744 Vali Acc: 0.780 Test Loss: 1.744 Test Acc: 0.780
Validation loss decreased (-0.273305 --> -0.779983).  Saving model ...
Epoch: 3 cost time: 1.0281012058258057
Epoch: 3, Steps: 18 | Train Loss: 1.266 Vali Loss: 0.756 Vali Acc: 0.927 Test Loss: 0.756 Test Acc: 0.927
Validation loss decreased (-0.779983 --> -0.926659).  Saving model ...
Epoch: 4 cost time: 1.1243512630462646
Epoch: 4, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.322 Vali Acc: 0.957 Test Loss: 0.322 Test Acc: 0.957
Validation loss decreased (-0.926659 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 1.0717387199401855
Epoch: 5, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.1066648960113525
Epoch: 6, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.8335905075073242
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.1763668060302734
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.1450812816619873
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.254821538925171
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1168537139892578
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1751055717468262
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1532509326934814
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0913832187652588
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.1639909744262695
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1079435348510742
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1936087608337402
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1593623161315918
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0141592025756836
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.2044692039489746
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.184269666671753
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1974713802337646
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0603857040405273
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.1772360801696777
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.1584644317626953
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1341288089752197
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1876494884490967
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.1243314743041992
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.1027812957763672
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.1325197219848633
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1131954193115234
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.0617632865905762
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2384190559387207
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.146845817565918
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.143080472946167
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.1283588409423828
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.356001377105713
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.246950626373291
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.18133544921875
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.1412503719329834
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.1398146152496338
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.348085880279541
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.3121716976165771
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.2076399326324463
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.140005350112915
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.2039134502410889
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.28086519241333
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.3527820110321045
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.204289197921753
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2348737716674805
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.2316288948059082
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.310485601425171
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.3261680603027344
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.270606279373169
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2551767826080322
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1836693286895752
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.2695086002349854
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.2597696781158447
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2056796550750732
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.2456212043762207
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.2043142318725586
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.3644304275512695
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.377399206161499
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.354036808013916
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.1626777648925781
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.1653356552124023
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.3374049663543701
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.2532517910003662
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 1.2872974872589111
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.2725708484649658
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.337188720703125
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 1.3919463157653809
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.205101490020752
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.2188172340393066
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 1.0336339473724365
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.1645407676696777
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.1693596839904785
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.3211462497711182
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 1.3097476959228516
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1509878635406494
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.2211923599243164
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.1857173442840576
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 1.1750128269195557
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.2754926681518555
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 85 cost time: 1.289538860321045
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 1.138307809829712
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 87 cost time: 1.236443042755127
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.2749285697937012
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 89 cost time: 1.1605803966522217
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 90 cost time: 1.2179512977600098
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 91 cost time: 1.3133292198181152
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.4200124740600586
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 93 cost time: 1.3957209587097168
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.2845289707183838
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.3147454261779785
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.2217795848846436
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.5023090839385986
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 98 cost time: 1.3984689712524414
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.1911790370941162
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 100 cost time: 1.4647507667541504
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 172217
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5796473026275635
Epoch: 1, Steps: 18 | Train Loss: 3.278 Vali Loss: 2.868 Vali Acc: 0.247 Test Loss: 2.868 Test Acc: 0.247
Validation loss decreased (inf --> -0.246638).  Saving model ...
Epoch: 2 cost time: 1.1135640144348145
Epoch: 2, Steps: 18 | Train Loss: 2.446 Vali Loss: 1.846 Vali Acc: 0.747 Test Loss: 1.846 Test Acc: 0.747
Validation loss decreased (-0.246638 --> -0.746648).  Saving model ...
Epoch: 3 cost time: 1.1345329284667969
Epoch: 3, Steps: 18 | Train Loss: 1.427 Vali Loss: 0.863 Vali Acc: 0.930 Test Loss: 0.863 Test Acc: 0.930
Validation loss decreased (-0.746648 --> -0.929991).  Saving model ...
Epoch: 4 cost time: 1.1671464443206787
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.367 Vali Acc: 0.963 Test Loss: 0.367 Test Acc: 0.963
Validation loss decreased (-0.929991 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.2207543849945068
Epoch: 5, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.2285082340240479
Epoch: 6, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.339724063873291
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2227377891540527
Epoch: 8, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.2621638774871826
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.2713024616241455
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.2526044845581055
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2507498264312744
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.2638089656829834
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.2534890174865723
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.1919071674346924
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.1577928066253662
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.168578863143921
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.2034943103790283
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.2505979537963867
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3230891227722168
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.1503703594207764
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.2220709323883057
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.2453739643096924
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.172499418258667
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2976176738739014
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.273284912109375
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.276017665863037
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.2071027755737305
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.2024097442626953
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.1138484477996826
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1159727573394775
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.185013771057129
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1287846565246582
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.1091375350952148
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.194150686264038
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.2395312786102295
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.1919348239898682
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.2432427406311035
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.249140977859497
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.2510156631469727
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.3158199787139893
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.2177603244781494
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.2203788757324219
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.1395235061645508
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.2007348537445068
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.1826763153076172
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.085134744644165
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.1788108348846436
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.2360942363739014
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.279496192932129
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.1963763236999512
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2747724056243896
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.3089699745178223
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.2123348712921143
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.1742794513702393
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.2405102252960205
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.1769986152648926
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.2354304790496826
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.2744081020355225
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.1616630554199219
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.980 Test Loss: 0.063 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.9018208980560303
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.1754024028778076
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1275031566619873
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.1387853622436523
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.083702564239502
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.1464779376983643
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.0507948398590088
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.051952600479126
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1893935203552246
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.1758372783660889
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.1672461032867432
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1755774021148682
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.2084758281707764
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.1538856029510498
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.1593551635742188
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.09136962890625
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.031207799911499
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.0979211330413818
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.9793803691864014
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.0256192684173584
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 1.0287036895751953
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.0535399913787842
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.1849260330200195
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.1093521118164062
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.0452041625976562
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.0819664001464844
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.0323166847229004
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.1278836727142334
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.110584020614624
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 1.1243205070495605
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 1.1480538845062256
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.1279113292694092
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.1262941360473633
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.1360256671905518
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.0870656967163086
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.023486614227295
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.1195485591888428
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 1.1497018337249756
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 1.0452516078948975
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.0732665061950684
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 136441
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.732870101928711
Epoch: 1, Steps: 18 | Train Loss: 3.242 Vali Loss: 2.955 Vali Acc: 0.170 Test Loss: 2.955 Test Acc: 0.170
Validation loss decreased (inf --> -0.169970).  Saving model ...
Epoch: 2 cost time: 1.11910080909729
Epoch: 2, Steps: 18 | Train Loss: 2.728 Vali Loss: 2.212 Vali Acc: 0.657 Test Loss: 2.212 Test Acc: 0.657
Validation loss decreased (-0.169970 --> -0.656645).  Saving model ...
Epoch: 3 cost time: 1.0285789966583252
Epoch: 3, Steps: 18 | Train Loss: 1.883 Vali Loss: 1.361 Vali Acc: 0.923 Test Loss: 1.361 Test Acc: 0.923
Validation loss decreased (-0.656645 --> -0.923320).  Saving model ...
Epoch: 4 cost time: 1.1645565032958984
Epoch: 4, Steps: 18 | Train Loss: 1.133 Vali Loss: 0.706 Vali Acc: 0.943 Test Loss: 0.706 Test Acc: 0.943
Validation loss decreased (-0.923320 --> -0.943326).  Saving model ...
Epoch: 5 cost time: 1.0336883068084717
Epoch: 5, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.376 Vali Acc: 0.960 Test Loss: 0.376 Test Acc: 0.960
Validation loss decreased (-0.943326 --> -0.959996).  Saving model ...
Epoch: 6 cost time: 1.1276531219482422
Epoch: 6, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.235 Vali Acc: 0.970 Test Loss: 0.235 Test Acc: 0.970
Validation loss decreased (-0.959996 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.056159496307373
Epoch: 7, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.0316503047943115
Epoch: 8, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.2125823497772217
Epoch: 9, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.2170627117156982
Epoch: 10, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.1730647087097168
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.2483446598052979
Epoch: 12, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.298520565032959
Epoch: 13, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.2305138111114502
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.324852705001831
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.3479106426239014
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1657862663269043
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.3223206996917725
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.223933219909668
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.2772128582000732
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.2383637428283691
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3010616302490234
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.21783447265625
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0794878005981445
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.2417893409729004
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.2630784511566162
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.136270523071289
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.2682318687438965
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.247114896774292
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2526252269744873
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.215320110321045
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.1894457340240479
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.1890487670898438
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.173159122467041
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1870605945587158
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.2236120700836182
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.1610329151153564
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.2264111042022705
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.2564549446105957
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.2108113765716553
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3095676898956299
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.3698859214782715
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.3774547576904297
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2482962608337402
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.2645378112792969
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.3160266876220703
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.3572416305541992
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.266749620437622
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.226146936416626
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.2711176872253418
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.3167760372161865
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.286180019378662
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3193933963775635
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.308774471282959
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.2697768211364746
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.4656167030334473
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.4185376167297363
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.2976353168487549
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.327643871307373
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.379666805267334
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.3455491065979004
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.2277238368988037
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.2631559371948242
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2162015438079834
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.1932666301727295
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.3382854461669922
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.339867353439331
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.3207013607025146
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.3516392707824707
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.2609293460845947
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.2960364818572998
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.3471834659576416
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.3537945747375488
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.2949738502502441
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 107865
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.897111654281616
Epoch: 1, Steps: 18 | Train Loss: 3.290 Vali Loss: 2.973 Vali Acc: 0.143 Test Loss: 2.973 Test Acc: 0.143
Validation loss decreased (inf --> -0.143304).  Saving model ...
Epoch: 2 cost time: 1.287123680114746
Epoch: 2, Steps: 18 | Train Loss: 2.737 Vali Loss: 2.316 Vali Acc: 0.560 Test Loss: 2.316 Test Acc: 0.560
Validation loss decreased (-0.143304 --> -0.559977).  Saving model ...
Epoch: 3 cost time: 1.3223869800567627
Epoch: 3, Steps: 18 | Train Loss: 1.994 Vali Loss: 1.507 Vali Acc: 0.840 Test Loss: 1.507 Test Acc: 0.840
Validation loss decreased (-0.559977 --> -0.839985).  Saving model ...
Epoch: 4 cost time: 1.2717788219451904
Epoch: 4, Steps: 18 | Train Loss: 1.210 Vali Loss: 0.818 Vali Acc: 0.930 Test Loss: 0.818 Test Acc: 0.930
Validation loss decreased (-0.839985 --> -0.929992).  Saving model ...
Epoch: 5 cost time: 1.3656947612762451
Epoch: 5, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.438 Vali Acc: 0.957 Test Loss: 0.438 Test Acc: 0.957
Validation loss decreased (-0.929992 --> -0.956662).  Saving model ...
Epoch: 6 cost time: 1.311722755432129
Epoch: 6, Steps: 18 | Train Loss: 0.287 Vali Loss: 0.269 Vali Acc: 0.963 Test Loss: 0.269 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 1.3384137153625488
Epoch: 7, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 1.3208141326904297
Epoch: 8, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979998).  Saving model ...
Epoch: 9 cost time: 1.2005860805511475
Epoch: 9, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.145 Vali Acc: 0.983 Test Loss: 0.145 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.2060344219207764
Epoch: 10, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.2733829021453857
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2166593074798584
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.3020920753479004
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.204169511795044
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.21940016746521
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.282444715499878
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.297269344329834
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2722818851470947
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3102304935455322
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.3193018436431885
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.290358066558838
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.2469000816345215
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.2841684818267822
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.2714433670043945
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.4108195304870605
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.3669185638427734
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.4052693843841553
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.320241928100586
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.3588087558746338
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.305629014968872
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.3062529563903809
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.312427043914795
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.4042680263519287
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.1732110977172852
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.335160493850708
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 1.4113521575927734
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.3444600105285645
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.3861165046691895
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.353121280670166
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.1628594398498535
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.258753776550293
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3322663307189941
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 1.3483624458312988
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.3347384929656982
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.284710168838501
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.2514865398406982
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.2499489784240723
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.3268332481384277
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.3047595024108887
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.260399580001831
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.2293105125427246
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.239708423614502
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.2666726112365723
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.2807114124298096
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.3333330154418945
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.3586056232452393
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3981564044952393
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.4017987251281738
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.2623088359832764
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.3461105823516846
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.2569060325622559
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.3249397277832031
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.3354368209838867
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.347383737564087
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.2863731384277344
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.2238173484802246
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.2043821811676025
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.2784395217895508
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.1899442672729492
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.2469482421875
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.2883081436157227
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.3222708702087402
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.44258713722229
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.3644232749938965
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.4875409603118896
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.3680598735809326
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.3529877662658691
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.4812839031219482
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 79 cost time: 1.2428257465362549
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1543679237365723
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 81 cost time: 1.185523509979248
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.268514633178711
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 83 cost time: 1.1580111980438232
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 84 cost time: 1.231095314025879
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 85 cost time: 1.1817047595977783
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.1900105476379395
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.2744758129119873
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.3450541496276855
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.328887701034546
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.418306827545166
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 1.2871103286743164
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 92 cost time: 1.3764281272888184
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 93 cost time: 1.4341793060302734
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 94 cost time: 1.3993687629699707
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.4379689693450928
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 1.3821847438812256
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 97 cost time: 1.3266489505767822
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.3921139240264893
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 99 cost time: 1.2596092224121094
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 100 cost time: 1.2375404834747314
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 100889
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0467734336853027
Epoch: 1, Steps: 18 | Train Loss: 2.794 Vali Loss: 1.527 Vali Acc: 0.780 Test Loss: 1.527 Test Acc: 0.780
Validation loss decreased (inf --> -0.779985).  Saving model ...
Epoch: 2 cost time: 1.6250226497650146
Epoch: 2, Steps: 18 | Train Loss: 0.813 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
Validation loss decreased (-0.779985 --> -0.936663).  Saving model ...
Epoch: 3 cost time: 1.5865123271942139
Epoch: 3, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.256 Vali Acc: 0.940 Test Loss: 0.256 Test Acc: 0.940
Validation loss decreased (-0.936663 --> -0.939997).  Saving model ...
Epoch: 4 cost time: 1.5628409385681152
Epoch: 4, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.939997 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.502807378768921
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4694609642028809
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5259265899658203
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.5345659255981445
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5812723636627197
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5179500579833984
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4281413555145264
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4621672630310059
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.5185644626617432
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6732141971588135
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6096253395080566
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.6088063716888428
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.5535168647766113
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.5618395805358887
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5401499271392822
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.592219591140747
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6132073402404785
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4229693412780762
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5113365650177002
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.306063175201416
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4770457744598389
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6482634544372559
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3068175315856934
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 544025
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.6941521167755127
Epoch: 1, Steps: 18 | Train Loss: 3.154 Vali Loss: 2.269 Vali Acc: 0.577 Test Loss: 2.269 Test Acc: 0.577
Validation loss decreased (inf --> -0.576644).  Saving model ...
Epoch: 2 cost time: 1.930060863494873
Epoch: 2, Steps: 18 | Train Loss: 1.576 Vali Loss: 0.738 Vali Acc: 0.923 Test Loss: 0.738 Test Acc: 0.923
Validation loss decreased (-0.576644 --> -0.923326).  Saving model ...
Epoch: 3 cost time: 1.9171056747436523
Epoch: 3, Steps: 18 | Train Loss: 0.414 Vali Loss: 0.236 Vali Acc: 0.963 Test Loss: 0.236 Test Acc: 0.963
Validation loss decreased (-0.923326 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 2.1363155841827393
Epoch: 4, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.144885778427124
Epoch: 5, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 2.0583207607269287
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8007566928863525
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.497349739074707
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.6610889434814453
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.8589980602264404
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 2.0848641395568848
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.1268672943115234
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7771246433258057
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.0447041988372803
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.977970838546753
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.396547317504883
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.166062831878662
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 2.2848761081695557
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.078869104385376
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.8419911861419678
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 2.0209248065948486
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.759155511856079
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.6311712265014648
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 2.137712001800537
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1076223850250244
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1901872158050537
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4070956707000732
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1754298210144043
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.013874053955078
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.8593924045562744
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9010913372039795
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 2.121324300765991
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.269559621810913
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.9951403141021729
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.725571870803833
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8252646923065186
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.9428739547729492
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9156949520111084
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 2.0628113746643066
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.9760465621948242
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0146329402923584
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 2.13687801361084
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 2.229387044906616
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.9375462532043457
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 2.0828230381011963
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.014599561691284
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.917543888092041
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.9599504470825195
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.6519207954406738
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.957322597503662
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 2.017277956008911
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.1360576152801514
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 2.135655164718628
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.8997187614440918
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.0828914642333984
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.01170015335083
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 2.1176564693450928
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 2.0464093685150146
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.8465561866760254
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.7037813663482666
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 284953
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.770439624786377
Epoch: 1, Steps: 18 | Train Loss: 3.203 Vali Loss: 2.528 Vali Acc: 0.457 Test Loss: 2.528 Test Acc: 0.457
Validation loss decreased (inf --> -0.456641).  Saving model ...
Epoch: 2 cost time: 1.322904109954834
Epoch: 2, Steps: 18 | Train Loss: 1.986 Vali Loss: 1.203 Vali Acc: 0.890 Test Loss: 1.203 Test Acc: 0.890
Validation loss decreased (-0.456641 --> -0.889988).  Saving model ...
Epoch: 3 cost time: 1.2628846168518066
Epoch: 3, Steps: 18 | Train Loss: 0.780 Vali Loss: 0.419 Vali Acc: 0.963 Test Loss: 0.419 Test Acc: 0.963
Validation loss decreased (-0.889988 --> -0.963329).  Saving model ...
Epoch: 4 cost time: 1.2347874641418457
Epoch: 4, Steps: 18 | Train Loss: 0.217 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.270164966583252
Epoch: 5, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.2834367752075195
Epoch: 6, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2859885692596436
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.3854711055755615
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2675323486328125
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.401381254196167
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.1606192588806152
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.1593186855316162
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.144960641860962
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.1081695556640625
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.2790215015411377
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8508443832397461
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.1376004219055176
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1812684535980225
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.095421552658081
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.1118552684783936
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.1366324424743652
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0870132446289062
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1801025867462158
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.072103500366211
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.1816747188568115
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.0655121803283691
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.1909899711608887
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.218479871749878
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1590068340301514
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2569878101348877
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.154860258102417
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.089120864868164
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1380605697631836
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1564791202545166
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2101140022277832
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1051547527313232
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1173009872436523
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2190380096435547
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1752843856811523
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.172560453414917
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.1464858055114746
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.2149455547332764
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.1309781074523926
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.2260847091674805
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.0514168739318848
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1539921760559082
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1653187274932861
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.1201183795928955
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.1177210807800293
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.1336669921875
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.0713708400726318
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0479466915130615
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.148177146911621
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.2762868404388428
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.1159718036651611
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1549010276794434
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.2636067867279053
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.188774585723877
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.2049994468688965
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.133155107498169
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0945560932159424
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1273548603057861
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1279757022857666
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.2370946407318115
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.120863914489746
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.1955759525299072
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.2077112197875977
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.2260830402374268
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.141775131225586
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.1180200576782227
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.2408676147460938
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.1458723545074463
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.191371202468872
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.2220451831817627
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.148744821548462
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.117769718170166
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.1837158203125
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.1700377464294434
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.1943867206573486
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.1763315200805664
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.1086890697479248
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.1586785316467285
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.1625747680664062
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.080749273300171
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.124229907989502
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.1068382263183594
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.1608965396881104
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.0739688873291016
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.130669355392456
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.143519639968872
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.1439790725708008
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.2140963077545166
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 1.1509778499603271
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.1218080520629883
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.0909996032714844
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.1596946716308594
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.1342144012451172
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.2683942317962646
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.1260879039764404
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.083275556564331
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 198649
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.618506908416748
Epoch: 1, Steps: 18 | Train Loss: 3.352 Vali Loss: 2.938 Vali Acc: 0.180 Test Loss: 2.938 Test Acc: 0.180
Validation loss decreased (inf --> -0.179971).  Saving model ...
Epoch: 2 cost time: 1.090519666671753
Epoch: 2, Steps: 18 | Train Loss: 2.550 Vali Loss: 1.886 Vali Acc: 0.760 Test Loss: 1.886 Test Acc: 0.760
Validation loss decreased (-0.179971 --> -0.759981).  Saving model ...
Epoch: 3 cost time: 1.1595747470855713
Epoch: 3, Steps: 18 | Train Loss: 1.381 Vali Loss: 0.853 Vali Acc: 0.947 Test Loss: 0.853 Test Acc: 0.947
Validation loss decreased (-0.759981 --> -0.946658).  Saving model ...
Epoch: 4 cost time: 1.1139307022094727
Epoch: 4, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.350 Vali Acc: 0.963 Test Loss: 0.350 Test Acc: 0.963
Validation loss decreased (-0.946658 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.0515305995941162
Epoch: 5, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.0579679012298584
Epoch: 6, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0851078033447266
Epoch: 7, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0939948558807373
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.0042462348937988
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.098464012145996
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0000193119049072
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.130828857421875
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.200960397720337
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1939284801483154
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.182739019393921
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.120530605316162
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0609519481658936
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1010808944702148
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 155577
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5686776638031006
Epoch: 1, Steps: 18 | Train Loss: 3.317 Vali Loss: 2.892 Vali Acc: 0.143 Test Loss: 2.892 Test Acc: 0.143
Validation loss decreased (inf --> -0.143304).  Saving model ...
Epoch: 2 cost time: 1.0200369358062744
Epoch: 2, Steps: 18 | Train Loss: 2.524 Vali Loss: 1.993 Vali Acc: 0.790 Test Loss: 1.993 Test Acc: 0.790
Validation loss decreased (-0.143304 --> -0.789980).  Saving model ...
Epoch: 3 cost time: 1.0714349746704102
Epoch: 3, Steps: 18 | Train Loss: 1.587 Vali Loss: 1.051 Vali Acc: 0.923 Test Loss: 1.051 Test Acc: 0.923
Validation loss decreased (-0.789980 --> -0.923323).  Saving model ...
Epoch: 4 cost time: 1.042003870010376
Epoch: 4, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.472 Vali Acc: 0.943 Test Loss: 0.472 Test Acc: 0.943
Validation loss decreased (-0.923323 --> -0.943329).  Saving model ...
Epoch: 5 cost time: 1.1373870372772217
Epoch: 5, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.242 Vali Acc: 0.970 Test Loss: 0.242 Test Acc: 0.970
Validation loss decreased (-0.943329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.1534945964813232
Epoch: 6, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.1612987518310547
Epoch: 7, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1485671997070312
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.1374523639678955
Epoch: 9, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.172348976135254
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1759419441223145
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2411246299743652
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1777896881103516
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.140049934387207
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1230120658874512
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1687912940979004
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1477859020233154
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1281816959381104
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.151428461074829
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0543160438537598
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2096202373504639
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 119801
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2566661834716797
Epoch: 1, Steps: 18 | Train Loss: 3.284 Vali Loss: 2.978 Vali Acc: 0.163 Test Loss: 2.978 Test Acc: 0.163
Validation loss decreased (inf --> -0.163304).  Saving model ...
Epoch: 2 cost time: 1.0119199752807617
Epoch: 2, Steps: 18 | Train Loss: 2.750 Vali Loss: 2.277 Vali Acc: 0.563 Test Loss: 2.277 Test Acc: 0.563
Validation loss decreased (-0.163304 --> -0.563311).  Saving model ...
Epoch: 3 cost time: 1.0016133785247803
Epoch: 3, Steps: 18 | Train Loss: 1.959 Vali Loss: 1.472 Vali Acc: 0.847 Test Loss: 1.472 Test Acc: 0.847
Validation loss decreased (-0.563311 --> -0.846652).  Saving model ...
Epoch: 4 cost time: 1.1028611660003662
Epoch: 4, Steps: 18 | Train Loss: 1.165 Vali Loss: 0.794 Vali Acc: 0.937 Test Loss: 0.794 Test Acc: 0.937
Validation loss decreased (-0.846652 --> -0.936659).  Saving model ...
Epoch: 5 cost time: 1.0605123043060303
Epoch: 5, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.409 Vali Acc: 0.967 Test Loss: 0.409 Test Acc: 0.967
Validation loss decreased (-0.936659 --> -0.966663).  Saving model ...
Epoch: 6 cost time: 1.0190770626068115
Epoch: 6, Steps: 18 | Train Loss: 0.263 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969997).  Saving model ...
Epoch: 7 cost time: 1.0118629932403564
Epoch: 7, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.0215098857879639
Epoch: 8, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.0770001411437988
Epoch: 9, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.086371660232544
Epoch: 10, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0342237949371338
Epoch: 11, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 1.0641915798187256
Epoch: 12, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.0225889682769775
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.095433235168457
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9920897483825684
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.089066743850708
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.088453769683838
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9953484535217285
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9738082885742188
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0012741088867188
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.0410313606262207
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0695137977600098
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0485970973968506
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0709240436553955
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0658824443817139
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.9989480972290039
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0887606143951416
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.1319515705108643
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.0266709327697754
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.9926986694335938
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.05684232711792
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.124211072921753
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.1035735607147217
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.02480149269104
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.0871481895446777
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.9899499416351318
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.1886675357818604
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0910322666168213
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0433998107910156
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0118279457092285
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1065685749053955
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0438265800476074
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.0140187740325928
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0562515258789062
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.05277681350708
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.0666327476501465
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.1504883766174316
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.9825625419616699
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.122035026550293
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1429195404052734
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0716214179992676
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0054173469543457
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.9399893283843994
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.9476072788238525
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.0149626731872559
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.0385375022888184
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.0374724864959717
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.0518364906311035
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0657579898834229
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0585196018218994
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.1620898246765137
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.062958002090454
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0589864253997803
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.0584805011749268
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9985268115997314
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.0248043537139893
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0753228664398193
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.0686798095703125
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.0551986694335938
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.018223762512207
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.095940113067627
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.0809807777404785
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.1072719097137451
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.0807852745056152
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.0628478527069092
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.0913846492767334
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9806575775146484
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.9632773399353027
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.1123032569885254
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 1.1095776557922363
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 1.2054743766784668
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.0624210834503174
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.09796142578125
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.0751769542694092
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.1866626739501953
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.0984301567077637
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.0645015239715576
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 0.9517917633056641
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.9794421195983887
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.9995193481445312
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.1209440231323242
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.097597360610962
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.0470948219299316
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 1.0346205234527588
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 1.0952839851379395
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 1.1034069061279297
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 1.1839900016784668
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.1310937404632568
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.114821195602417
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 1.1203687191009521
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 91225
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4663262367248535
Epoch: 1, Steps: 18 | Train Loss: 3.274 Vali Loss: 3.004 Vali Acc: 0.130 Test Loss: 3.004 Test Acc: 0.130
Validation loss decreased (inf --> -0.129970).  Saving model ...
Epoch: 2 cost time: 1.146120548248291
Epoch: 2, Steps: 18 | Train Loss: 2.767 Vali Loss: 2.355 Vali Acc: 0.567 Test Loss: 2.355 Test Acc: 0.567
Validation loss decreased (-0.129970 --> -0.566643).  Saving model ...
Epoch: 3 cost time: 1.1374471187591553
Epoch: 3, Steps: 18 | Train Loss: 2.032 Vali Loss: 1.565 Vali Acc: 0.840 Test Loss: 1.565 Test Acc: 0.840
Validation loss decreased (-0.566643 --> -0.839984).  Saving model ...
Epoch: 4 cost time: 1.122591495513916
Epoch: 4, Steps: 18 | Train Loss: 1.230 Vali Loss: 0.869 Vali Acc: 0.910 Test Loss: 0.869 Test Acc: 0.910
Validation loss decreased (-0.839984 --> -0.909991).  Saving model ...
Epoch: 5 cost time: 1.1613926887512207
Epoch: 5, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.909991 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 1.1375091075897217
Epoch: 6, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.271 Vali Acc: 0.967 Test Loss: 0.271 Test Acc: 0.967
Validation loss decreased (-0.949995 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 1.0461452007293701
Epoch: 7, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.0459697246551514
Epoch: 8, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.1246297359466553
Epoch: 9, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1560847759246826
Epoch: 10, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.1298012733459473
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.0629239082336426
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.1974437236785889
Epoch: 13, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1026170253753662
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.1413960456848145
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0918903350830078
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2058000564575195
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.073429822921753
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.1274197101593018
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1264708042144775
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.1370844841003418
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0467493534088135
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0899121761322021
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.2838127613067627
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0652954578399658
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.1583337783813477
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.1236133575439453
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.0786397457122803
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.1905646324157715
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0909314155578613
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1509649753570557
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.142310380935669
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.1307079792022705
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.1752820014953613
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1269075870513916
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.200556993484497
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.1443638801574707
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.1255278587341309
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.1290972232818604
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.1209635734558105
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.113630771636963
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.219817876815796
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.0878195762634277
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.292607069015503
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.136441946029663
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.1553115844726562
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.098823070526123
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.1032133102416992
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2023181915283203
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.148329257965088
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.1422154903411865
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1201672554016113
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.0617146492004395
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.0163908004760742
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.0486316680908203
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.1236648559570312
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.2312960624694824
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.0104076862335205
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.075087070465088
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.1545648574829102
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.1171271800994873
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.0734429359436035
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.250988245010376
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.139909029006958
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.1832635402679443
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.1093428134918213
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1170780658721924
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.2781741619110107
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.0761582851409912
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.2158727645874023
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.2054173946380615
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.1664948463439941
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.155583143234253
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.1525580883026123
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.1375315189361572
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.1508841514587402
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.265770435333252
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.2079105377197266
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.2247154712677002
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.1438233852386475
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.0651638507843018
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.1625497341156006
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.072634220123291
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.0968270301818848
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.2036998271942139
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.1624960899353027
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.1258747577667236
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.0732700824737549
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 1.2257099151611328
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 1.1229593753814697
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 1.0879275798797607
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 1.1933693885803223
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 93 cost time: 1.106534719467163
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 94 cost time: 1.1346189975738525
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.1352262496948242
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 1.143061876296997
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 1.0979063510894775
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.145399570465088
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.1889352798461914
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.157283067703247
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 84249
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.440066337585449
Epoch: 1, Steps: 18 | Train Loss: 2.838 Vali Loss: 1.523 Vali Acc: 0.743 Test Loss: 1.523 Test Acc: 0.743
Validation loss decreased (inf --> -0.743318).  Saving model ...
Epoch: 2 cost time: 2.0629336833953857
Epoch: 2, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.283 Vali Acc: 0.957 Test Loss: 0.283 Test Acc: 0.957
Validation loss decreased (-0.743318 --> -0.956664).  Saving model ...
Epoch: 3 cost time: 2.1126410961151123
Epoch: 3, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 2.0784826278686523
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 5 cost time: 2.037947177886963
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.0008020401000977
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 2.1482255458831787
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1626839637756348
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.069862127304077
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.099205493927002
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8829972743988037
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6810362339019775
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9096176624298096
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8557236194610596
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.9179320335388184
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0062789916992188
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0321710109710693
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2285196781158447
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1472814083099365
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.001970052719116
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0105690956115723
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.080796241760254
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0200035572052
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.041964292526245
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 535705
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.323618173599243
Epoch: 1, Steps: 18 | Train Loss: 3.093 Vali Loss: 2.273 Vali Acc: 0.553 Test Loss: 2.273 Test Acc: 0.553
Validation loss decreased (inf --> -0.553311).  Saving model ...
Epoch: 2 cost time: 1.7075867652893066
Epoch: 2, Steps: 18 | Train Loss: 1.533 Vali Loss: 0.729 Vali Acc: 0.937 Test Loss: 0.729 Test Acc: 0.937
Validation loss decreased (-0.553311 --> -0.936659).  Saving model ...
Epoch: 3 cost time: 1.6509456634521484
Epoch: 3, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.245 Vali Acc: 0.957 Test Loss: 0.245 Test Acc: 0.957
Validation loss decreased (-0.936659 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 1.60113525390625
Epoch: 4, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8768482208251953
Epoch: 5, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.956664 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.612440824508667
Epoch: 6, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.5860021114349365
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.4184701442718506
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.539276361465454
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7581100463867188
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.6297650337219238
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.7463128566741943
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.724421501159668
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.675163745880127
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.7085316181182861
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.8256862163543701
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.4165935516357422
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.5986430644989014
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.491342544555664
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9125957489013672
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7275416851043701
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7550256252288818
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.6130430698394775
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7818043231964111
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7993862628936768
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.8151555061340332
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6167259216308594
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7746829986572266
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.6081266403198242
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.535280704498291
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6959559917449951
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6946525573730469
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.6824309825897217
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.7632544040679932
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9568278789520264
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8398265838623047
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.717393398284912
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.2634220123291016
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.7910585403442383
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8727695941925049
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.8531689643859863
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8453149795532227
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5737411975860596
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.840346097946167
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.8988442420959473
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8419880867004395
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.558443546295166
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.5749175548553467
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.7876825332641602
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.8842573165893555
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.6119041442871094
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.64652681350708
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.591174602508545
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5558643341064453
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.8295111656188965
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.6846625804901123
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.3274788856506348
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.6018340587615967
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 276633
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.60141921043396
Epoch: 1, Steps: 18 | Train Loss: 3.197 Vali Loss: 2.633 Vali Acc: 0.390 Test Loss: 2.633 Test Acc: 0.390
Validation loss decreased (inf --> -0.389974).  Saving model ...
Epoch: 2 cost time: 0.9799952507019043
Epoch: 2, Steps: 18 | Train Loss: 2.151 Vali Loss: 1.321 Vali Acc: 0.853 Test Loss: 1.321 Test Acc: 0.853
Validation loss decreased (-0.389974 --> -0.853320).  Saving model ...
Epoch: 3 cost time: 0.9997806549072266
Epoch: 3, Steps: 18 | Train Loss: 0.879 Vali Loss: 0.471 Vali Acc: 0.950 Test Loss: 0.471 Test Acc: 0.950
Validation loss decreased (-0.853320 --> -0.949995).  Saving model ...
Epoch: 4 cost time: 1.0033206939697266
Epoch: 4, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.230 Vali Acc: 0.967 Test Loss: 0.230 Test Acc: 0.967
Validation loss decreased (-0.949995 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 0.9948720932006836
Epoch: 5, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.966664 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.9700326919555664
Epoch: 6, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0480906963348389
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.0904672145843506
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9964864253997803
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.048896312713623
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9520502090454102
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9951498508453369
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0356714725494385
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.0364701747894287
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.0199000835418701
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9885571002960205
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.821552038192749
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2695770263671875
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.1011497974395752
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.083961009979248
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.2276349067687988
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0523808002471924
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2091500759124756
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.0773944854736328
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0603487491607666
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0531704425811768
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.1205222606658936
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.0939915180206299
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.0758428573608398
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.0922410488128662
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.1154110431671143
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.1037349700927734
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2407727241516113
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0630974769592285
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 0.9924490451812744
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1249663829803467
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 1.0750751495361328
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0110468864440918
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.114809513092041
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.063060998916626
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.1189522743225098
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.1112167835235596
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1537904739379883
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.116666316986084
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.0294098854064941
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.0601191520690918
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.27439284324646
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1297590732574463
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0492804050445557
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0502500534057617
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.1146690845489502
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.0472412109375
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.071944236755371
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.1016466617584229
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.079021692276001
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0502188205718994
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.1145851612091064
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.1340692043304443
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1179888248443604
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.1178934574127197
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.0457878112792969
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.0454940795898438
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.0438601970672607
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.0734567642211914
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0880722999572754
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.1008172035217285
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.0493865013122559
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.0737440586090088
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.0720860958099365
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.1485991477966309
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.182199239730835
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.2268657684326172
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.2052159309387207
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.13651704788208
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.118459701538086
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.1445550918579102
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.0954201221466064
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.039731502532959
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.0316190719604492
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1279010772705078
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.165389060974121
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 1.1431963443756104
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.0479986667633057
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.1599931716918945
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.115579605102539
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.0805771350860596
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.0582778453826904
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.0174999237060547
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.0667872428894043
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.0250046253204346
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.0527441501617432
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.0610918998718262
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.1227540969848633
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.2068753242492676
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.130579948425293
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.0993537902832031
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 1.1483683586120605
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 1.0392436981201172
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.15380859375
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.094275951385498
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 190329
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5942330360412598
Epoch: 1, Steps: 18 | Train Loss: 3.206 Vali Loss: 2.790 Vali Acc: 0.253 Test Loss: 2.790 Test Acc: 0.253
Validation loss decreased (inf --> -0.253305).  Saving model ...
Epoch: 2 cost time: 1.1887872219085693
Epoch: 2, Steps: 18 | Train Loss: 2.330 Vali Loss: 1.692 Vali Acc: 0.830 Test Loss: 1.692 Test Acc: 0.830
Validation loss decreased (-0.253305 --> -0.829983).  Saving model ...
Epoch: 3 cost time: 1.0645830631256104
Epoch: 3, Steps: 18 | Train Loss: 1.254 Vali Loss: 0.771 Vali Acc: 0.937 Test Loss: 0.771 Test Acc: 0.937
Validation loss decreased (-0.829983 --> -0.936659).  Saving model ...
Epoch: 4 cost time: 1.0887174606323242
Epoch: 4, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.327 Vali Acc: 0.957 Test Loss: 0.327 Test Acc: 0.957
Validation loss decreased (-0.936659 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 1.1349763870239258
Epoch: 5, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.0357046127319336
Epoch: 6, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.1255087852478027
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0525827407836914
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.0808091163635254
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.036625623703003
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0568454265594482
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.115577220916748
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.105499267578125
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.1654901504516602
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.2286174297332764
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0679724216461182
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0610849857330322
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0424401760101318
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.1115822792053223
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0501818656921387
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.120948076248169
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0907487869262695
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0851984024047852
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0673580169677734
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.2345540523529053
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.052506923675537
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.102107048034668
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0486373901367188
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.1389508247375488
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0441787242889404
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1053152084350586
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.0640809535980225
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.0878171920776367
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0762760639190674
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.0689210891723633
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1664259433746338
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0830109119415283
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.179455280303955
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.164773941040039
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1691765785217285
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.118403673171997
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.0827689170837402
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.0453100204467773
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.106172800064087
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.1228039264678955
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0427687168121338
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0395264625549316
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.1134819984436035
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.0908269882202148
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.1253726482391357
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.1264073848724365
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.1394670009613037
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.1090776920318604
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0711712837219238
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7677168846130371
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.149949073791504
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0617287158966064
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.0763189792633057
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1301589012145996
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.0701520442962646
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0628128051757812
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.0864479541778564
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.028667688369751
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.9671814441680908
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0882880687713623
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0742120742797852
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.1184630393981934
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9560744762420654
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.0701334476470947
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.0152873992919922
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.0716931819915771
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.025571346282959
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.1155107021331787
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 147257
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.421339988708496
Epoch: 1, Steps: 18 | Train Loss: 3.307 Vali Loss: 2.866 Vali Acc: 0.213 Test Loss: 2.866 Test Acc: 0.213
Validation loss decreased (inf --> -0.213305).  Saving model ...
Epoch: 2 cost time: 1.1241650581359863
Epoch: 2, Steps: 18 | Train Loss: 2.531 Vali Loss: 1.937 Vali Acc: 0.743 Test Loss: 1.937 Test Acc: 0.743
Validation loss decreased (-0.213305 --> -0.743314).  Saving model ...
Epoch: 3 cost time: 0.9110867977142334
Epoch: 3, Steps: 18 | Train Loss: 1.583 Vali Loss: 1.021 Vali Acc: 0.917 Test Loss: 1.021 Test Acc: 0.917
Validation loss decreased (-0.743314 --> -0.916656).  Saving model ...
Epoch: 4 cost time: 1.009026050567627
Epoch: 4, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.467 Vali Acc: 0.957 Test Loss: 0.467 Test Acc: 0.957
Validation loss decreased (-0.916656 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 0.9848339557647705
Epoch: 5, Steps: 18 | Train Loss: 0.310 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.9631786346435547
Epoch: 6, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8934957981109619
Epoch: 7, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.9519846439361572
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.980809211730957
Epoch: 9, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.016664981842041
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0274293422698975
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.0486364364624023
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9853894710540771
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.039407730102539
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.1098620891571045
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0501999855041504
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9967799186706543
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9705698490142822
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0115668773651123
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0325202941894531
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.0054006576538086
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.9792778491973877
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9896235466003418
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0579338073730469
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.9533648490905762
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0335049629211426
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0388689041137695
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.0595922470092773
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.93947434425354
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0096375942230225
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.9825360774993896
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.9769220352172852
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.9981951713562012
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.958812952041626
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.946864128112793
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.0253276824951172
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9759056568145752
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.9519937038421631
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.0380191802978516
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.015618085861206
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.9977445602416992
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.031888723373413
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.026780128479004
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.0085246562957764
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.9659314155578613
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.034881591796875
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.9976773262023926
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0690960884094238
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.0588228702545166
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.960824728012085
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0227577686309814
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.016913652420044
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.01774001121521
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 0.9216194152832031
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0383262634277344
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 0.9368047714233398
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 0.9812147617340088
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.0276083946228027
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.0412731170654297
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 0.7509937286376953
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.020963191986084
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0147874355316162
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.0253934860229492
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 1.0248520374298096
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.0083482265472412
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.0568428039550781
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.0845837593078613
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 0.9954588413238525
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.0638988018035889
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.0667259693145752
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.9754767417907715
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.059920072555542
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.0476174354553223
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.0794882774353027
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.9747707843780518
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.0037646293640137
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.0761024951934814
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 111481
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.474066972732544
Epoch: 1, Steps: 18 | Train Loss: 3.316 Vali Loss: 2.931 Vali Acc: 0.197 Test Loss: 2.931 Test Acc: 0.197
Validation loss decreased (inf --> -0.196637).  Saving model ...
Epoch: 2 cost time: 1.081345558166504
Epoch: 2, Steps: 18 | Train Loss: 2.757 Vali Loss: 2.249 Vali Acc: 0.663 Test Loss: 2.249 Test Acc: 0.663
Validation loss decreased (-0.196637 --> -0.663311).  Saving model ...
Epoch: 3 cost time: 1.0664331912994385
Epoch: 3, Steps: 18 | Train Loss: 2.024 Vali Loss: 1.452 Vali Acc: 0.880 Test Loss: 1.452 Test Acc: 0.880
Validation loss decreased (-0.663311 --> -0.879985).  Saving model ...
Epoch: 4 cost time: 1.0045888423919678
Epoch: 4, Steps: 18 | Train Loss: 1.233 Vali Loss: 0.790 Vali Acc: 0.940 Test Loss: 0.790 Test Acc: 0.940
Validation loss decreased (-0.879985 --> -0.939992).  Saving model ...
Epoch: 5 cost time: 0.9935860633850098
Epoch: 5, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.417 Vali Acc: 0.960 Test Loss: 0.417 Test Acc: 0.960
Validation loss decreased (-0.939992 --> -0.959996).  Saving model ...
Epoch: 6 cost time: 1.0153663158416748
Epoch: 6, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.256 Vali Acc: 0.973 Test Loss: 0.256 Test Acc: 0.973
Validation loss decreased (-0.959996 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 0.946134090423584
Epoch: 7, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.193 Vali Acc: 0.973 Test Loss: 0.193 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 1.078998327255249
Epoch: 8, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9948515892028809
Epoch: 9, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0414032936096191
Epoch: 10, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.022050142288208
Epoch: 11, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.1265208721160889
Epoch: 12, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.2616219520568848
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.129021406173706
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0713045597076416
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0375354290008545
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.047105073928833
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8478963375091553
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8499486446380615
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8947396278381348
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8649883270263672
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7752707004547119
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8871111869812012
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8889255523681641
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8783085346221924
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9988319873809814
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.0293755531311035
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.045882225036621
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.9862191677093506
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.0765256881713867
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.0946719646453857
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.0875980854034424
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1096928119659424
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.0452775955200195
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.135528564453125
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.1025331020355225
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.1121406555175781
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.0777935981750488
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.1648669242858887
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0803391933441162
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.059964656829834
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.0330357551574707
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.0836107730865479
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.0692672729492188
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.1979684829711914
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2040786743164062
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.01542067527771
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.0652124881744385
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.0491225719451904
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.1379683017730713
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.0904560089111328
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0188329219818115
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.2059190273284912
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.0327579975128174
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1618049144744873
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.13352370262146
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.111311912536621
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9815788269042969
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9823594093322754
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.9962890148162842
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.0330703258514404
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0715303421020508
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1378436088562012
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.1081247329711914
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.094254732131958
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.104480266571045
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.0941479206085205
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.024155616760254
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.049964189529419
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.039764165878296
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.9913325309753418
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 0.9877481460571289
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.0539591312408447
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.1040997505187988
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.1101977825164795
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.0779621601104736
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.0912985801696777
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.0544660091400146
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.0982592105865479
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.0223851203918457
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.135284662246704
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.0932221412658691
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.0456652641296387
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.0867950916290283
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.0160369873046875
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.0375211238861084
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.0191400051116943
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.0757780075073242
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 0.9944570064544678
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.028871774673462
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.0244140625
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.0849895477294922
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.9956033229827881
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 1.0185742378234863
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 1.0351881980895996
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.9943704605102539
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.014866590499878
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 1.0441381931304932
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 82905
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.488355875015259
Epoch: 1, Steps: 18 | Train Loss: 3.241 Vali Loss: 2.999 Vali Acc: 0.140 Test Loss: 2.999 Test Acc: 0.140
Validation loss decreased (inf --> -0.139970).  Saving model ...
Epoch: 2 cost time: 1.1472463607788086
Epoch: 2, Steps: 18 | Train Loss: 2.726 Vali Loss: 2.366 Vali Acc: 0.490 Test Loss: 2.366 Test Acc: 0.490
Validation loss decreased (-0.139970 --> -0.489976).  Saving model ...
Epoch: 3 cost time: 1.1497793197631836
Epoch: 3, Steps: 18 | Train Loss: 2.062 Vali Loss: 1.616 Vali Acc: 0.797 Test Loss: 1.616 Test Acc: 0.797
Validation loss decreased (-0.489976 --> -0.796651).  Saving model ...
Epoch: 4 cost time: 1.1347377300262451
Epoch: 4, Steps: 18 | Train Loss: 1.393 Vali Loss: 0.942 Vali Acc: 0.920 Test Loss: 0.942 Test Acc: 0.920
Validation loss decreased (-0.796651 --> -0.919991).  Saving model ...
Epoch: 5 cost time: 1.087834358215332
Epoch: 5, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.511 Vali Acc: 0.960 Test Loss: 0.511 Test Acc: 0.960
Validation loss decreased (-0.919991 --> -0.959995).  Saving model ...
Epoch: 6 cost time: 1.0389533042907715
Epoch: 6, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.299 Vali Acc: 0.970 Test Loss: 0.299 Test Acc: 0.970
Validation loss decreased (-0.959995 --> -0.969997).  Saving model ...
Epoch: 7 cost time: 1.0358622074127197
Epoch: 7, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.157813549041748
Epoch: 8, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.016850471496582
Epoch: 9, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1056475639343262
Epoch: 10, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.1338410377502441
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 1.0896685123443604
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0752842426300049
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1050913333892822
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.0633673667907715
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.098585844039917
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0656120777130127
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1111106872558594
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1001207828521729
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.028754711151123
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8367722034454346
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.069108247756958
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9082028865814209
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.0361461639404297
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.033236026763916
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9771173000335693
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9999613761901855
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.0252323150634766
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.944737434387207
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.04683256149292
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.0334110260009766
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9859890937805176
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1210684776306152
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.1085350513458252
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.0067367553710938
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.051558494567871
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.9787895679473877
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.029639482498169
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.0286598205566406
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.9266018867492676
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.9700510501861572
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9942672252655029
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9802350997924805
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0124454498291016
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.9976708889007568
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.9427909851074219
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.0355920791625977
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.004164457321167
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0789895057678223
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.083547592163086
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.8395164012908936
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.0598835945129395
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.0342340469360352
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9867479801177979
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.0799839496612549
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.0021085739135742
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.0317680835723877
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9804999828338623
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.9516448974609375
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.0031659603118896
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0530157089233398
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0459208488464355
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.002950668334961
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 0.9690885543823242
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.131378173828125
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.0498807430267334
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 0.9547526836395264
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1331236362457275
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.965395450592041
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 0.9638321399688721
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.934596061706543
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9977147579193115
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 0.9409635066986084
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 0.9903073310852051
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.053170919418335
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.0255067348480225
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 0.9932956695556641
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 0.9860997200012207
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.0118510723114014
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.9812920093536377
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.0183513164520264
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.9578208923339844
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.1848700046539307
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.0349705219268799
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.1219334602355957
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.06691575050354
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.1518149375915527
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 1.0807287693023682
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 1.119950532913208
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.1142821311950684
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.112067461013794
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.0607547760009766
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.0289063453674316
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 1.0841703414916992
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.0113365650177002
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 1.0494892597198486
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.024683952331543
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.1050105094909668
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.1819798946380615
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 1.1039605140686035
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm32_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 75929
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9524996280670166
Epoch: 1, Steps: 18 | Train Loss: 3.089 Vali Loss: 2.397 Vali Acc: 0.507 Test Loss: 2.397 Test Acc: 0.507
Validation loss decreased (inf --> -0.506643).  Saving model ...
Epoch: 2 cost time: 1.3224258422851562
Epoch: 2, Steps: 18 | Train Loss: 1.712 Vali Loss: 0.826 Vali Acc: 0.947 Test Loss: 0.826 Test Acc: 0.947
Validation loss decreased (-0.506643 --> -0.946658).  Saving model ...
Epoch: 3 cost time: 1.3060615062713623
Epoch: 3, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.249 Vali Acc: 0.963 Test Loss: 0.249 Test Acc: 0.963
Validation loss decreased (-0.946658 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.2670907974243164
Epoch: 4, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2353167533874512
Epoch: 5, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.963331 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.4002878665924072
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.275697946548462
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.2697577476501465
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.2313411235809326
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.3304593563079834
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.3276128768920898
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.4326565265655518
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.3975245952606201
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.322136640548706
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.412588357925415
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.3143887519836426
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.392336368560791
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.3409013748168945
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.256502628326416
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.404700756072998
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.4468882083892822
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3978710174560547
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.3227348327636719
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.322127342224121
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.3216588497161865
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.2939720153808594
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.384700059890747
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.343360185623169
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4013621807098389
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.4001483917236328
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.3554301261901855
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4484939575195312
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3064029216766357
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3339338302612305
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.30399489402771
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.398465871810913
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3586924076080322
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.403625249862671
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.3984534740447998
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 1.487729549407959
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 1.3797295093536377
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3539533615112305
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.337341070175171
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 1.224562168121338
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3167026042938232
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 1.320298671722412
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3507840633392334
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 48 cost time: 1.3934941291809082
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 49 cost time: 1.3518948554992676
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4221217632293701
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 51 cost time: 1.4706385135650635
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 52 cost time: 1.3452460765838623
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3897125720977783
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.3727355003356934
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.4158425331115723
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 56 cost time: 1.5563244819641113
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.563812017440796
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.418985366821289
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 59 cost time: 1.5364809036254883
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 60 cost time: 1.4180693626403809
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.3710482120513916
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.4207282066345215
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 63 cost time: 1.3908631801605225
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.380241870880127
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.3916325569152832
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.4124274253845215
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.459360122680664
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.366654872894287
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.325073480606079
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.2364699840545654
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.355384349822998
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.2525749206542969
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 278553
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.361325979232788
Epoch: 1, Steps: 18 | Train Loss: 3.248 Vali Loss: 2.769 Vali Acc: 0.283 Test Loss: 2.769 Test Acc: 0.283
Validation loss decreased (inf --> -0.283306).  Saving model ...
Epoch: 2 cost time: 1.0890607833862305
Epoch: 2, Steps: 18 | Train Loss: 2.286 Vali Loss: 1.591 Vali Acc: 0.847 Test Loss: 1.591 Test Acc: 0.847
Validation loss decreased (-0.283306 --> -0.846651).  Saving model ...
Epoch: 3 cost time: 1.0482654571533203
Epoch: 3, Steps: 18 | Train Loss: 1.204 Vali Loss: 0.645 Vali Acc: 0.917 Test Loss: 0.645 Test Acc: 0.917
Validation loss decreased (-0.846651 --> -0.916660).  Saving model ...
Epoch: 4 cost time: 1.0487263202667236
Epoch: 4, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.267 Vali Acc: 0.963 Test Loss: 0.267 Test Acc: 0.963
Validation loss decreased (-0.916660 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 1.1128287315368652
Epoch: 5, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0178887844085693
Epoch: 6, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.963331 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.9681968688964844
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.0432240962982178
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.141833782196045
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 0.9825189113616943
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.0758273601531982
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.1371042728424072
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.2111992835998535
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.0603106021881104
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.9835360050201416
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.051239013671875
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.050915002822876
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.0373859405517578
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.1235003471374512
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.050753116607666
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.143695592880249
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.071894884109497
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.0823948383331299
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.0569441318511963
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.0250091552734375
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.0611155033111572
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0861198902130127
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.0122466087341309
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.1443486213684082
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0796732902526855
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.097001075744629
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.0721755027770996
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.1097164154052734
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 0.9767162799835205
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.0275211334228516
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.98587965965271
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9892637729644775
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.017946720123291
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.0671274662017822
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.9912872314453125
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 0.992189884185791
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.0162179470062256
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 1.0174551010131836
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.0559403896331787
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9256753921508789
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1124327182769775
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.041316032409668
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0317742824554443
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 0.9928069114685059
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.0557360649108887
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.0697247982025146
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0163230895996094
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0573396682739258
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0711133480072021
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.1312930583953857
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0383684635162354
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.087183952331543
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.003089189529419
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.0945162773132324
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.049499273300171
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.0815834999084473
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.133239507675171
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.1939098834991455
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.1379640102386475
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.1522581577301025
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.1431617736816406
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0858078002929688
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.1058547496795654
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.119471788406372
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.1897542476654053
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.1802096366882324
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.0957722663879395
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.1140873432159424
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.072666883468628
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1927766799926758
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.0873985290527344
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.126251459121704
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.2115583419799805
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.2101771831512451
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.1128275394439697
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.1948387622833252
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.043135166168213
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.0896804332733154
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.0393576622009277
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.191328525543213
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.0657451152801514
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.0700554847717285
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 1.0677857398986816
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 1.1369993686676025
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 1.0273411273956299
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.121422290802002
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.0656061172485352
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 93 cost time: 1.1521663665771484
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 1.1596617698669434
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 1.196406602859497
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.2654485702514648
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 1.2937827110290527
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 1.2826502323150635
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 1.1854801177978516
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 1.1825547218322754
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 149017
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7104225158691406
Epoch: 1, Steps: 18 | Train Loss: 3.244 Vali Loss: 2.864 Vali Acc: 0.233 Test Loss: 2.864 Test Acc: 0.233
Validation loss decreased (inf --> -0.233305).  Saving model ...
Epoch: 2 cost time: 1.1214191913604736
Epoch: 2, Steps: 18 | Train Loss: 2.649 Vali Loss: 2.115 Vali Acc: 0.673 Test Loss: 2.115 Test Acc: 0.673
Validation loss decreased (-0.233305 --> -0.673312).  Saving model ...
Epoch: 3 cost time: 1.1603519916534424
Epoch: 3, Steps: 18 | Train Loss: 1.848 Vali Loss: 1.237 Vali Acc: 0.860 Test Loss: 1.237 Test Acc: 0.860
Validation loss decreased (-0.673312 --> -0.859988).  Saving model ...
Epoch: 4 cost time: 1.2310638427734375
Epoch: 4, Steps: 18 | Train Loss: 0.981 Vali Loss: 0.597 Vali Acc: 0.940 Test Loss: 0.597 Test Acc: 0.940
Validation loss decreased (-0.859988 --> -0.939994).  Saving model ...
Epoch: 5 cost time: 1.1264076232910156
Epoch: 5, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.316 Vali Acc: 0.953 Test Loss: 0.316 Test Acc: 0.953
Validation loss decreased (-0.939994 --> -0.953330).  Saving model ...
Epoch: 6 cost time: 1.129314661026001
Epoch: 6, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.953330 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.318082571029663
Epoch: 7, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.264007568359375
Epoch: 8, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.0992324352264404
Epoch: 9, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.1620330810546875
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.0729215145111084
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.158951759338379
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1491622924804688
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.32879638671875
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3355400562286377
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2094571590423584
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1320464611053467
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1718547344207764
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.1604204177856445
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.085326910018921
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.9877679347991943
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0855035781860352
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0577116012573242
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0175893306732178
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.1156487464904785
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.1502315998077393
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0258128643035889
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.0687131881713867
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.072075605392456
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.113157033920288
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0060884952545166
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1968932151794434
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1479077339172363
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.046698808670044
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.1202392578125
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1028835773468018
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.084000825881958
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.1025238037109375
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.151944875717163
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0831999778747559
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.0992074012756348
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.0918693542480469
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.0894577503204346
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0152411460876465
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1408398151397705
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1374876499176025
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0414345264434814
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.0661883354187012
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0430629253387451
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9672732353210449
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.021977424621582
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0876951217651367
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0966432094573975
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.1159114837646484
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.1092088222503662
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.076291799545288
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.9788205623626709
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0202782154083252
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.0854439735412598
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0989806652069092
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.0275022983551025
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.1106634140014648
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.1079332828521729
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.138399600982666
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.1430010795593262
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.122826099395752
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.1548497676849365
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.1418449878692627
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2350234985351562
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.3440742492675781
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.2686336040496826
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.2036621570587158
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.149548053741455
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.2490298748016357
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.2248470783233643
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.1962745189666748
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.1638071537017822
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.1654791831970215
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.1678705215454102
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.2393970489501953
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.2088234424591064
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.2073707580566406
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 1.2271959781646729
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.2690558433532715
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.0732715129852295
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.106248140335083
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 1.1305263042449951
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 1.1556613445281982
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 1.0596303939819336
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 1.0475997924804688
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.9986324310302734
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 1.2683820724487305
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 1.1727659702301025
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.2457194328308105
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.1361618041992188
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.109576940536499
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.1262929439544678
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.9742567539215088
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.1669318675994873
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.136232852935791
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 105865
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5589590072631836
Epoch: 1, Steps: 18 | Train Loss: 3.319 Vali Loss: 3.035 Vali Acc: 0.093 Test Loss: 3.035 Test Acc: 0.093
Validation loss decreased (inf --> -0.093303).  Saving model ...
Epoch: 2 cost time: 1.1597669124603271
Epoch: 2, Steps: 18 | Train Loss: 2.785 Vali Loss: 2.373 Vali Acc: 0.513 Test Loss: 2.373 Test Acc: 0.513
Validation loss decreased (-0.093303 --> -0.513310).  Saving model ...
Epoch: 3 cost time: 1.0919203758239746
Epoch: 3, Steps: 18 | Train Loss: 2.037 Vali Loss: 1.560 Vali Acc: 0.827 Test Loss: 1.560 Test Acc: 0.827
Validation loss decreased (-0.513310 --> -0.826651).  Saving model ...
Epoch: 4 cost time: 1.156041145324707
Epoch: 4, Steps: 18 | Train Loss: 1.255 Vali Loss: 0.843 Vali Acc: 0.933 Test Loss: 0.843 Test Acc: 0.933
Validation loss decreased (-0.826651 --> -0.933325).  Saving model ...
Epoch: 5 cost time: 1.2958381175994873
Epoch: 5, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.457 Vali Acc: 0.947 Test Loss: 0.457 Test Acc: 0.947
Validation loss decreased (-0.933325 --> -0.946662).  Saving model ...
Epoch: 6 cost time: 1.0833017826080322
Epoch: 6, Steps: 18 | Train Loss: 0.280 Vali Loss: 0.278 Vali Acc: 0.960 Test Loss: 0.278 Test Acc: 0.960
Validation loss decreased (-0.946662 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 1.1649229526519775
Epoch: 7, Steps: 18 | Train Loss: 0.140 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 1.1997840404510498
Epoch: 8, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.1319222450256348
Epoch: 9, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.172832727432251
Epoch: 10, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.1757099628448486
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1543781757354736
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.1513373851776123
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.1753273010253906
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.1085145473480225
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.0956239700317383
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.0872623920440674
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.1311469078063965
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.1811127662658691
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.1057312488555908
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.1944584846496582
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.305238962173462
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.1088001728057861
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.0789613723754883
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.114356279373169
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.3599629402160645
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.1724255084991455
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.2242343425750732
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.232668399810791
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.162508487701416
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 1.1619994640350342
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.2007486820220947
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.1821656227111816
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 1.1343581676483154
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 1.2812650203704834
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 1.2029685974121094
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.164501667022705
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2054908275604248
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.122610330581665
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 1.153468370437622
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 41 cost time: 1.1556179523468018
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 42 cost time: 1.2344448566436768
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2465717792510986
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 44 cost time: 1.22975754737854
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 45 cost time: 1.2387166023254395
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 46 cost time: 1.253417730331421
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 47 cost time: 1.259042739868164
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 48 cost time: 1.2516367435455322
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 49 cost time: 1.1340932846069336
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 50 cost time: 1.2146203517913818
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.250309944152832
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2373878955841064
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2101242542266846
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 54 cost time: 1.3552138805389404
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1822667121887207
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.250859260559082
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 57 cost time: 1.240415334701538
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 58 cost time: 1.2063355445861816
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1316564083099365
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.1949820518493652
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2330958843231201
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.217651128768921
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 63 cost time: 1.1680209636688232
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 64 cost time: 1.211454153060913
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 65 cost time: 1.2919509410858154
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 66 cost time: 1.3849577903747559
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 67 cost time: 1.347538709640503
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 68 cost time: 1.3659133911132812
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 69 cost time: 1.312748670578003
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 70 cost time: 1.3217189311981201
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 71 cost time: 1.2983839511871338
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 72 cost time: 1.310234785079956
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 73 cost time: 1.1977097988128662
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.3407049179077148
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 75 cost time: 1.2841062545776367
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 76 cost time: 1.2770583629608154
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.2428538799285889
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.2374560832977295
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.2784180641174316
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.2805531024932861
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.217419147491455
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 82 cost time: 1.2936756610870361
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 83 cost time: 1.409787654876709
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.237236499786377
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 85 cost time: 1.4084084033966064
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 1.4209415912628174
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 87 cost time: 1.35111403465271
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 88 cost time: 1.3775312900543213
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 89 cost time: 1.3912086486816406
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 1.3495445251464844
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.4238405227661133
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.3641760349273682
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.2774097919464111
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 94 cost time: 1.2333929538726807
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 95 cost time: 1.1692557334899902
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 1.207960844039917
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 97 cost time: 1.2360668182373047
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.1898698806762695
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.352783441543579
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 100 cost time: 1.3281724452972412
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 84329
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.681917190551758
Epoch: 1, Steps: 18 | Train Loss: 3.416 Vali Loss: 3.157 Vali Acc: 0.127 Test Loss: 3.157 Test Acc: 0.127
Validation loss decreased (inf --> -0.126635).  Saving model ...
Epoch: 2 cost time: 1.3278393745422363
Epoch: 2, Steps: 18 | Train Loss: 3.037 Vali Loss: 2.609 Vali Acc: 0.453 Test Loss: 2.609 Test Acc: 0.453
Validation loss decreased (-0.126635 --> -0.453307).  Saving model ...
Epoch: 3 cost time: 1.212151288986206
Epoch: 3, Steps: 18 | Train Loss: 2.318 Vali Loss: 1.885 Vali Acc: 0.693 Test Loss: 1.885 Test Acc: 0.693
Validation loss decreased (-0.453307 --> -0.693314).  Saving model ...
Epoch: 4 cost time: 1.3710308074951172
Epoch: 4, Steps: 18 | Train Loss: 1.629 Vali Loss: 1.151 Vali Acc: 0.887 Test Loss: 1.151 Test Acc: 0.887
Validation loss decreased (-0.693314 --> -0.886655).  Saving model ...
Epoch: 5 cost time: 1.1678390502929688
Epoch: 5, Steps: 18 | Train Loss: 0.884 Vali Loss: 0.638 Vali Acc: 0.940 Test Loss: 0.638 Test Acc: 0.940
Validation loss decreased (-0.886655 --> -0.939994).  Saving model ...
Epoch: 6 cost time: 1.1873490810394287
Epoch: 6, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.379 Vali Acc: 0.960 Test Loss: 0.379 Test Acc: 0.960
Validation loss decreased (-0.939994 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 1.1216504573822021
Epoch: 7, Steps: 18 | Train Loss: 0.219 Vali Loss: 0.256 Vali Acc: 0.967 Test Loss: 0.256 Test Acc: 0.967
Validation loss decreased (-0.959996 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 1.128234624862671
Epoch: 8, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.1259396076202393
Epoch: 9, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.165865182876587
Epoch: 10, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.2521476745605469
Epoch: 11, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.287930965423584
Epoch: 12, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.2968394756317139
Epoch: 13, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.312537670135498
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.331028938293457
Epoch: 15, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.2701315879821777
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3061461448669434
Epoch: 17, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.425987720489502
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3344371318817139
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.2768409252166748
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.4098079204559326
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.306732416152954
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.3590562343597412
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.2693126201629639
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.257871150970459
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.2564208507537842
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.2568528652191162
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.2561461925506592
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.1927464008331299
Epoch: 29, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.2346208095550537
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.294346809387207
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.2304000854492188
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.247044563293457
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.2411136627197266
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.4321858882904053
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.3472721576690674
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3541700839996338
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.3035862445831299
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.2882511615753174
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.143233060836792
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.2639448642730713
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.3103604316711426
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.2319676876068115
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2711782455444336
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.229146957397461
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.9501113891601562
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.3062758445739746
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.240401029586792
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.086467981338501
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.1613974571228027
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.0862667560577393
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.218916416168213
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1217467784881592
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1568832397460938
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2135474681854248
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.166365146636963
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2483203411102295
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1564257144927979
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.0888288021087646
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.2182543277740479
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 66441
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5952839851379395
Epoch: 1, Steps: 18 | Train Loss: 3.382 Vali Loss: 3.221 Vali Acc: 0.063 Test Loss: 3.221 Test Acc: 0.063
Validation loss decreased (inf --> -0.063301).  Saving model ...
Epoch: 2 cost time: 1.0643138885498047
Epoch: 2, Steps: 18 | Train Loss: 3.092 Vali Loss: 2.866 Vali Acc: 0.227 Test Loss: 2.866 Test Acc: 0.227
Validation loss decreased (-0.063301 --> -0.226638).  Saving model ...
Epoch: 3 cost time: 1.0987718105316162
Epoch: 3, Steps: 18 | Train Loss: 2.672 Vali Loss: 2.382 Vali Acc: 0.583 Test Loss: 2.382 Test Acc: 0.583
Validation loss decreased (-0.226638 --> -0.583310).  Saving model ...
Epoch: 4 cost time: 1.0679254531860352
Epoch: 4, Steps: 18 | Train Loss: 2.206 Vali Loss: 1.804 Vali Acc: 0.827 Test Loss: 1.804 Test Acc: 0.827
Validation loss decreased (-0.583310 --> -0.826649).  Saving model ...
Epoch: 5 cost time: 1.1503510475158691
Epoch: 5, Steps: 18 | Train Loss: 1.631 Vali Loss: 1.237 Vali Acc: 0.900 Test Loss: 1.237 Test Acc: 0.900
Validation loss decreased (-0.826649 --> -0.899988).  Saving model ...
Epoch: 6 cost time: 1.0980465412139893
Epoch: 6, Steps: 18 | Train Loss: 1.023 Vali Loss: 0.788 Vali Acc: 0.950 Test Loss: 0.788 Test Acc: 0.950
Validation loss decreased (-0.899988 --> -0.949992).  Saving model ...
Epoch: 7 cost time: 1.1230392456054688
Epoch: 7, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.497 Vali Acc: 0.960 Test Loss: 0.497 Test Acc: 0.960
Validation loss decreased (-0.949992 --> -0.959995).  Saving model ...
Epoch: 8 cost time: 1.1045482158660889
Epoch: 8, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.349 Vali Acc: 0.960 Test Loss: 0.349 Test Acc: 0.960
Validation loss decreased (-0.959995 --> -0.959997).  Saving model ...
Epoch: 9 cost time: 1.2034475803375244
Epoch: 9, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.259 Vali Acc: 0.973 Test Loss: 0.259 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 1.1323699951171875
Epoch: 10, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.218 Vali Acc: 0.973 Test Loss: 0.218 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 11 cost time: 0.9740457534790039
Epoch: 11, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 1.0261383056640625
Epoch: 12, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.170 Vali Acc: 0.977 Test Loss: 0.170 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.9716215133666992
Epoch: 13, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.158 Vali Acc: 0.980 Test Loss: 0.158 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 14 cost time: 1.0091640949249268
Epoch: 14, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.980 Test Loss: 0.147 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9951801300048828
Epoch: 15, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9290127754211426
Epoch: 16, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0230863094329834
Epoch: 17, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1635973453521729
Epoch: 18, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.0798335075378418
Epoch: 19, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.0781886577606201
Epoch: 20, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.073122501373291
Epoch: 21, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0430870056152344
Epoch: 22, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0924644470214844
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9675149917602539
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.0827438831329346
Epoch: 25, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.1193416118621826
Epoch: 26, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.117680311203003
Epoch: 27, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.0335838794708252
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0918455123901367
Epoch: 29, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.122431755065918
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.2081952095031738
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.1315255165100098
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1080949306488037
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.1081032752990723
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.060680627822876
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9894924163818359
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0696320533752441
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.082230806350708
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.101970911026001
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.024625301361084
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.030285358428955
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.0247771739959717
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0867986679077148
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 1.036207914352417
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.072516679763794
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0036027431488037
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.072876214981079
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9943137168884277
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.1551005840301514
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2383027076721191
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.151261329650879
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.2559285163879395
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.1919925212860107
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.149214744567871
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1279723644256592
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.1036763191223145
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.129387617111206
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.128920078277588
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.1175286769866943
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1385314464569092
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.1371920108795166
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.0855834484100342
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.1557374000549316
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.2011659145355225
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.1704134941101074
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.109565019607544
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.2671644687652588
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.169753074645996
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1879315376281738
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.1436564922332764
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.2680487632751465
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.2720091342926025
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 1.3097131252288818
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 1.3460710048675537
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.2254400253295898
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.2317874431610107
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.149308204650879
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.1875791549682617
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.108546495437622
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 1.2109546661376953
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.2018706798553467
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.1181957721710205
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.2329778671264648
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 1.22932767868042
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.2526347637176514
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 1.1893322467803955
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 1.3328142166137695
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.269338607788086
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.355402946472168
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 1.1429569721221924
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.1341462135314941
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 92 cost time: 1.165921688079834
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 93 cost time: 1.1394593715667725
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.2792866230010986
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.165632724761963
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 1.2141830921173096
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 1.1971487998962402
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.1303684711456299
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 1.2809813022613525
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 1.2009799480438232
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 52153
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5580947399139404
Epoch: 1, Steps: 18 | Train Loss: 3.430 Vali Loss: 3.235 Vali Acc: 0.067 Test Loss: 3.235 Test Acc: 0.067
Validation loss decreased (inf --> -0.066634).  Saving model ...
Epoch: 2 cost time: 1.2479147911071777
Epoch: 2, Steps: 18 | Train Loss: 3.151 Vali Loss: 2.865 Vali Acc: 0.237 Test Loss: 2.865 Test Acc: 0.237
Validation loss decreased (-0.066634 --> -0.236638).  Saving model ...
Epoch: 3 cost time: 1.2049508094787598
Epoch: 3, Steps: 18 | Train Loss: 2.712 Vali Loss: 2.360 Vali Acc: 0.570 Test Loss: 2.360 Test Acc: 0.570
Validation loss decreased (-0.236638 --> -0.569976).  Saving model ...
Epoch: 4 cost time: 1.2101898193359375
Epoch: 4, Steps: 18 | Train Loss: 2.177 Vali Loss: 1.788 Vali Acc: 0.790 Test Loss: 1.788 Test Acc: 0.790
Validation loss decreased (-0.569976 --> -0.789982).  Saving model ...
Epoch: 5 cost time: 1.1141793727874756
Epoch: 5, Steps: 18 | Train Loss: 1.571 Vali Loss: 1.238 Vali Acc: 0.890 Test Loss: 1.238 Test Acc: 0.890
Validation loss decreased (-0.789982 --> -0.889988).  Saving model ...
Epoch: 6 cost time: 1.1736714839935303
Epoch: 6, Steps: 18 | Train Loss: 1.069 Vali Loss: 0.806 Vali Acc: 0.943 Test Loss: 0.806 Test Acc: 0.943
Validation loss decreased (-0.889988 --> -0.943325).  Saving model ...
Epoch: 7 cost time: 1.1147620677947998
Epoch: 7, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.526 Vali Acc: 0.957 Test Loss: 0.526 Test Acc: 0.957
Validation loss decreased (-0.943325 --> -0.956661).  Saving model ...
Epoch: 8 cost time: 1.0682454109191895
Epoch: 8, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.368 Vali Acc: 0.970 Test Loss: 0.368 Test Acc: 0.970
Validation loss decreased (-0.956661 --> -0.969996).  Saving model ...
Epoch: 9 cost time: 1.1849195957183838
Epoch: 9, Steps: 18 | Train Loss: 0.245 Vali Loss: 0.289 Vali Acc: 0.970 Test Loss: 0.289 Test Acc: 0.970
Validation loss decreased (-0.969996 --> -0.969997).  Saving model ...
Epoch: 10 cost time: 1.144089698791504
Epoch: 10, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.242 Vali Acc: 0.973 Test Loss: 0.242 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 11 cost time: 1.2063376903533936
Epoch: 11, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 1.114513635635376
Epoch: 12, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.193 Vali Acc: 0.973 Test Loss: 0.193 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 13 cost time: 1.198362112045288
Epoch: 13, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.173 Vali Acc: 0.977 Test Loss: 0.173 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.1803858280181885
Epoch: 14, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.160 Vali Acc: 0.980 Test Loss: 0.160 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 15 cost time: 1.1761984825134277
Epoch: 15, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 16 cost time: 1.1457626819610596
Epoch: 16, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.176743984222412
Epoch: 17, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1554837226867676
Epoch: 18, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.1622388362884521
Epoch: 19, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.1414384841918945
Epoch: 20, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.087754249572754
Epoch: 21, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.138392448425293
Epoch: 22, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.1688029766082764
Epoch: 23, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.1864345073699951
Epoch: 24, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.191676139831543
Epoch: 25, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.2335290908813477
Epoch: 26, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.165123701095581
Epoch: 27, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.0984058380126953
Epoch: 28, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.1842586994171143
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.2164804935455322
Epoch: 30, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.097790002822876
Epoch: 31, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.1060562133789062
Epoch: 32, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.1011333465576172
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.105616807937622
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 1.205871820449829
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.2038168907165527
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 1.1304421424865723
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.1461353302001953
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.1308183670043945
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 1.1618947982788086
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 1.1478583812713623
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2814030647277832
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 1.2414991855621338
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 1.2607991695404053
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 1.1333544254302979
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.104884386062622
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.0562145709991455
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.0843865871429443
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.1622881889343262
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 1.0993995666503906
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.1032090187072754
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.125035285949707
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.1664907932281494
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.093679666519165
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.0620074272155762
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.1434826850891113
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.1721165180206299
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.1033296585083008
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 0.8748204708099365
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.065028429031372
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.2652385234832764
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.004589319229126
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.0685052871704102
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.1376914978027344
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.0922110080718994
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.024543285369873
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0901765823364258
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.0848095417022705
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.092404842376709
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.1229939460754395
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 1.0537316799163818
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.0432193279266357
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0468335151672363
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 1.0971684455871582
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.0175869464874268
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.0688650608062744
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 1.066389560699463
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 1.1111466884613037
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 1.0578312873840332
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.1236588954925537
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 1.058304786682129
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.9816179275512695
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 1.0957269668579102
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.1294817924499512
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 1.0945708751678467
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 1.000614881515503
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 1.040130615234375
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 0.9259703159332275
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 0.8923451900482178
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.9601795673370361
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 91 cost time: 1.030303716659546
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.1165218353271484
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 93 cost time: 0.9446635246276855
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.1182889938354492
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.1117606163024902
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.9875881671905518
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.0889272689819336
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 1.0609161853790283
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.0578958988189697
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.0471529960632324
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 48665
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.682766914367676
Epoch: 1, Steps: 18 | Train Loss: 3.178 Vali Loss: 2.438 Vali Acc: 0.603 Test Loss: 2.438 Test Acc: 0.603
Validation loss decreased (inf --> -0.603309).  Saving model ...
Epoch: 2 cost time: 1.214268684387207
Epoch: 2, Steps: 18 | Train Loss: 1.837 Vali Loss: 0.985 Vali Acc: 0.933 Test Loss: 0.985 Test Acc: 0.933
Validation loss decreased (-0.603309 --> -0.933323).  Saving model ...
Epoch: 3 cost time: 1.2134287357330322
Epoch: 3, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.312 Vali Acc: 0.957 Test Loss: 0.312 Test Acc: 0.957
Validation loss decreased (-0.933323 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 1.22719407081604
Epoch: 4, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.1619393825531006
Epoch: 5, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.959998 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.2820181846618652
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1128828525543213
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1863558292388916
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.129866600036621
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1606810092926025
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3970766067504883
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.419154167175293
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4233736991882324
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.403205156326294
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2578063011169434
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 270105
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.843748092651367
Epoch: 1, Steps: 18 | Train Loss: 3.193 Vali Loss: 2.686 Vali Acc: 0.383 Test Loss: 2.686 Test Acc: 0.383
Validation loss decreased (inf --> -0.383306).  Saving model ...
Epoch: 2 cost time: 1.18088698387146
Epoch: 2, Steps: 18 | Train Loss: 2.240 Vali Loss: 1.529 Vali Acc: 0.823 Test Loss: 1.529 Test Acc: 0.823
Validation loss decreased (-0.383306 --> -0.823318).  Saving model ...
Epoch: 3 cost time: 1.1944129467010498
Epoch: 3, Steps: 18 | Train Loss: 1.085 Vali Loss: 0.602 Vali Acc: 0.960 Test Loss: 0.602 Test Acc: 0.960
Validation loss decreased (-0.823318 --> -0.959994).  Saving model ...
Epoch: 4 cost time: 1.2276642322540283
Epoch: 4, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
Validation loss decreased (-0.959994 --> -0.973331).  Saving model ...
Epoch: 5 cost time: 1.0930242538452148
Epoch: 5, Steps: 18 | Train Loss: 0.143 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.076235055923462
Epoch: 6, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.1025264263153076
Epoch: 7, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.1205272674560547
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1725566387176514
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.198364496231079
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1594693660736084
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1246140003204346
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1851770877838135
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1026725769042969
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0724000930786133
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2310919761657715
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3630540370941162
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.2637112140655518
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.372894525527954
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.1060798168182373
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.066222906112671
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.1401169300079346
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1757256984710693
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.011136531829834
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.226252794265747
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1659495830535889
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.089500904083252
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1744415760040283
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2052159309387207
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.053370475769043
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.133985996246338
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.294980525970459
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.127781629562378
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 140569
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.392571449279785
Epoch: 1, Steps: 18 | Train Loss: 3.316 Vali Loss: 3.047 Vali Acc: 0.157 Test Loss: 3.047 Test Acc: 0.157
Validation loss decreased (inf --> -0.156636).  Saving model ...
Epoch: 2 cost time: 1.1497259140014648
Epoch: 2, Steps: 18 | Train Loss: 2.742 Vali Loss: 2.297 Vali Acc: 0.600 Test Loss: 2.297 Test Acc: 0.600
Validation loss decreased (-0.156636 --> -0.599977).  Saving model ...
Epoch: 3 cost time: 1.2248129844665527
Epoch: 3, Steps: 18 | Train Loss: 1.907 Vali Loss: 1.389 Vali Acc: 0.870 Test Loss: 1.389 Test Acc: 0.870
Validation loss decreased (-0.599977 --> -0.869986).  Saving model ...
Epoch: 4 cost time: 1.2554709911346436
Epoch: 4, Steps: 18 | Train Loss: 1.013 Vali Loss: 0.679 Vali Acc: 0.937 Test Loss: 0.679 Test Acc: 0.937
Validation loss decreased (-0.869986 --> -0.936660).  Saving model ...
Epoch: 5 cost time: 1.1555352210998535
Epoch: 5, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.333 Vali Acc: 0.963 Test Loss: 0.333 Test Acc: 0.963
Validation loss decreased (-0.936660 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 1.1423299312591553
Epoch: 6, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 1.023022174835205
Epoch: 7, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0345458984375
Epoch: 8, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0215201377868652
Epoch: 9, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1606435775756836
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0399725437164307
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.1094720363616943
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.066481590270996
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1423296928405762
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.096238613128662
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2833364009857178
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1905784606933594
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0498542785644531
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.1109769344329834
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1359937191009521
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.0993547439575195
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.1455752849578857
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.170487880706787
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.1125822067260742
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0883522033691406
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0739459991455078
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0373375415802002
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.088296890258789
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.136214256286621
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.1146798133850098
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1386570930480957
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1008801460266113
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.1519663333892822
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.1017003059387207
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.1442840099334717
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.1695587635040283
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.139087438583374
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.079078197479248
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.1039488315582275
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0022523403167725
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.0937480926513672
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.1060352325439453
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.1202776432037354
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.1458244323730469
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.134899616241455
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1688203811645508
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.181509256362915
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.101011037826538
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.036388874053955
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.0881550312042236
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0555419921875
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.094900369644165
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.1109554767608643
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1070630550384521
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.0389587879180908
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0909206867218018
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0917701721191406
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1850576400756836
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.039306640625
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.1791048049926758
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.1337800025939941
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.086942195892334
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.0475947856903076
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.0414061546325684
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.1380228996276855
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.1105661392211914
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.0901870727539062
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.075502872467041
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.1068029403686523
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.085944414138794
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.1045002937316895
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.1707432270050049
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.0994994640350342
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.0674314498901367
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.0100393295288086
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.0520131587982178
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.0226612091064453
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.046781301498413
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.9938333034515381
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.9747211933135986
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.9936728477478027
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 1.0530314445495605
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 1.026810884475708
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 1.1490416526794434
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.1057312488555908
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 1.0136919021606445
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 1.0071797370910645
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.0420985221862793
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.0109341144561768
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.0819246768951416
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.0021641254425049
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.000537395477295
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.9992880821228027
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 1.1195766925811768
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 1.0668656826019287
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.0793139934539795
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 0.9686987400054932
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 1.1520800590515137
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 0.9886624813079834
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.0885121822357178
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 97417
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.466533899307251
Epoch: 1, Steps: 18 | Train Loss: 3.338 Vali Loss: 2.998 Vali Acc: 0.180 Test Loss: 2.998 Test Acc: 0.180
Validation loss decreased (inf --> -0.179970).  Saving model ...
Epoch: 2 cost time: 0.9962887763977051
Epoch: 2, Steps: 18 | Train Loss: 2.798 Vali Loss: 2.336 Vali Acc: 0.597 Test Loss: 2.336 Test Acc: 0.597
Validation loss decreased (-0.179970 --> -0.596643).  Saving model ...
Epoch: 3 cost time: 1.099778175354004
Epoch: 3, Steps: 18 | Train Loss: 2.066 Vali Loss: 1.551 Vali Acc: 0.853 Test Loss: 1.551 Test Acc: 0.853
Validation loss decreased (-0.596643 --> -0.853318).  Saving model ...
Epoch: 4 cost time: 0.9764628410339355
Epoch: 4, Steps: 18 | Train Loss: 1.253 Vali Loss: 0.881 Vali Acc: 0.930 Test Loss: 0.881 Test Acc: 0.930
Validation loss decreased (-0.853318 --> -0.929991).  Saving model ...
Epoch: 5 cost time: 0.9428205490112305
Epoch: 5, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.483 Vali Acc: 0.930 Test Loss: 0.483 Test Acc: 0.930
Validation loss decreased (-0.929991 --> -0.929995).  Saving model ...
Epoch: 6 cost time: 1.0788977146148682
Epoch: 6, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.287 Vali Acc: 0.957 Test Loss: 0.287 Test Acc: 0.957
Validation loss decreased (-0.929995 --> -0.956664).  Saving model ...
Epoch: 7 cost time: 0.9941868782043457
Epoch: 7, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9863812923431396
Epoch: 8, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 9 cost time: 1.0924384593963623
Epoch: 9, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963332).  Saving model ...
Epoch: 10 cost time: 1.0081188678741455
Epoch: 10, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0579807758331299
Epoch: 11, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0418381690979004
Epoch: 12, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0233895778656006
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.962862491607666
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9468803405761719
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.9626502990722656
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.1130554676055908
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.0831272602081299
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.108879566192627
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.076028823852539
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.101729393005371
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0832138061523438
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.039703130722046
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.9926319122314453
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.008866310119629
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.0382416248321533
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.0460331439971924
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.1822993755340576
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.1168367862701416
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.2016544342041016
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 1.1424520015716553
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.074315071105957
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.0951392650604248
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.079507827758789
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.133256435394287
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 1.1754059791564941
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 1.1255414485931396
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 1.1051404476165771
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 1.0890800952911377
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.118588924407959
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0795974731445312
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 42 cost time: 1.0784406661987305
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0475800037384033
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 44 cost time: 1.0120320320129395
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 45 cost time: 1.0238633155822754
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1139874458312988
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 47 cost time: 1.0984117984771729
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2000348567962646
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 49 cost time: 1.1605525016784668
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 50 cost time: 1.1466925144195557
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 51 cost time: 1.1127068996429443
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 52 cost time: 1.0225317478179932
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 53 cost time: 1.1200037002563477
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 54 cost time: 1.0603158473968506
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.121927261352539
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0889685153961182
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 57 cost time: 1.063533067703247
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 58 cost time: 1.1421709060668945
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1122324466705322
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.1317484378814697
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.1177897453308105
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.1769235134124756
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0451536178588867
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.2096874713897705
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.0470104217529297
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.0474903583526611
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.093355655670166
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.0748014450073242
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.0715632438659668
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.0370256900787354
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.1045525074005127
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 75881
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6664879322052
Epoch: 1, Steps: 18 | Train Loss: 3.360 Vali Loss: 3.059 Vali Acc: 0.100 Test Loss: 3.059 Test Acc: 0.100
Validation loss decreased (inf --> -0.099969).  Saving model ...
Epoch: 2 cost time: 1.0822298526763916
Epoch: 2, Steps: 18 | Train Loss: 2.875 Vali Loss: 2.518 Vali Acc: 0.437 Test Loss: 2.518 Test Acc: 0.437
Validation loss decreased (-0.099969 --> -0.436641).  Saving model ...
Epoch: 3 cost time: 1.0890612602233887
Epoch: 3, Steps: 18 | Train Loss: 2.287 Vali Loss: 1.823 Vali Acc: 0.783 Test Loss: 1.823 Test Acc: 0.783
Validation loss decreased (-0.436641 --> -0.783315).  Saving model ...
Epoch: 4 cost time: 1.1370298862457275
Epoch: 4, Steps: 18 | Train Loss: 1.575 Vali Loss: 1.132 Vali Acc: 0.920 Test Loss: 1.132 Test Acc: 0.920
Validation loss decreased (-0.783315 --> -0.919989).  Saving model ...
Epoch: 5 cost time: 1.0853562355041504
Epoch: 5, Steps: 18 | Train Loss: 0.874 Vali Loss: 0.631 Vali Acc: 0.960 Test Loss: 0.631 Test Acc: 0.960
Validation loss decreased (-0.919989 --> -0.959994).  Saving model ...
Epoch: 6 cost time: 1.0933771133422852
Epoch: 6, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.371 Vali Acc: 0.967 Test Loss: 0.371 Test Acc: 0.967
Validation loss decreased (-0.959994 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 1.0399820804595947
Epoch: 7, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.250 Vali Acc: 0.970 Test Loss: 0.250 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.9780771732330322
Epoch: 8, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973331).  Saving model ...
Epoch: 9 cost time: 1.0083773136138916
Epoch: 9, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.050551414489746
Epoch: 10, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0308148860931396
Epoch: 11, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.9652690887451172
Epoch: 12, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.152388334274292
Epoch: 13, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.080944299697876
Epoch: 14, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.05924391746521
Epoch: 15, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0744433403015137
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0950331687927246
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0751960277557373
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.041975975036621
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.1220612525939941
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.1026289463043213
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0651350021362305
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0774738788604736
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.0411949157714844
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.1025550365447998
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.011549711227417
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.1286792755126953
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.0214030742645264
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0893549919128418
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.0673868656158447
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.154393196105957
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.0042028427124023
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.0563161373138428
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.083019733428955
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 1.0758633613586426
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.0867204666137695
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2049436569213867
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0173625946044922
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0936717987060547
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1748192310333252
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.089885950088501
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1133108139038086
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.053748369216919
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.04972243309021
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0931956768035889
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 57993
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.394831657409668
Epoch: 1, Steps: 18 | Train Loss: 3.340 Vali Loss: 3.171 Vali Acc: 0.077 Test Loss: 3.171 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 0.983748197555542
Epoch: 2, Steps: 18 | Train Loss: 3.083 Vali Loss: 2.825 Vali Acc: 0.240 Test Loss: 2.825 Test Acc: 0.240
Validation loss decreased (-0.076635 --> -0.239972).  Saving model ...
Epoch: 3 cost time: 1.111417293548584
Epoch: 3, Steps: 18 | Train Loss: 2.725 Vali Loss: 2.362 Vali Acc: 0.520 Test Loss: 2.362 Test Acc: 0.520
Validation loss decreased (-0.239972 --> -0.519976).  Saving model ...
Epoch: 4 cost time: 1.0533349514007568
Epoch: 4, Steps: 18 | Train Loss: 2.189 Vali Loss: 1.830 Vali Acc: 0.743 Test Loss: 1.830 Test Acc: 0.743
Validation loss decreased (-0.519976 --> -0.743315).  Saving model ...
Epoch: 5 cost time: 1.039548635482788
Epoch: 5, Steps: 18 | Train Loss: 1.646 Vali Loss: 1.282 Vali Acc: 0.887 Test Loss: 1.282 Test Acc: 0.887
Validation loss decreased (-0.743315 --> -0.886654).  Saving model ...
Epoch: 6 cost time: 1.1024396419525146
Epoch: 6, Steps: 18 | Train Loss: 1.103 Vali Loss: 0.835 Vali Acc: 0.940 Test Loss: 0.835 Test Acc: 0.940
Validation loss decreased (-0.886654 --> -0.939992).  Saving model ...
Epoch: 7 cost time: 1.0534272193908691
Epoch: 7, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.541 Vali Acc: 0.950 Test Loss: 0.541 Test Acc: 0.950
Validation loss decreased (-0.939992 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 1.099055290222168
Epoch: 8, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.369 Vali Acc: 0.967 Test Loss: 0.369 Test Acc: 0.967
Validation loss decreased (-0.949995 --> -0.966663).  Saving model ...
Epoch: 9 cost time: 1.1136646270751953
Epoch: 9, Steps: 18 | Train Loss: 0.238 Vali Loss: 0.274 Vali Acc: 0.970 Test Loss: 0.274 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969997).  Saving model ...
Epoch: 10 cost time: 0.9090061187744141
Epoch: 10, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.231 Vali Acc: 0.970 Test Loss: 0.231 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7531485557556152
Epoch: 11, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.203 Vali Acc: 0.973 Test Loss: 0.203 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 0.9284369945526123
Epoch: 12, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.9489719867706299
Epoch: 13, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.9519290924072266
Epoch: 14, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.9010896682739258
Epoch: 15, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.9283308982849121
Epoch: 16, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.9414980411529541
Epoch: 17, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.9514636993408203
Epoch: 18, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 1.0035643577575684
Epoch: 19, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 1.0095329284667969
Epoch: 20, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9985823631286621
Epoch: 21, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0296638011932373
Epoch: 22, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9518659114837646
Epoch: 23, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.0119726657867432
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9525630474090576
Epoch: 25, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9659745693206787
Epoch: 26, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9360432624816895
Epoch: 27, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.0128474235534668
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.9589126110076904
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.0755751132965088
Epoch: 30, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.9871835708618164
Epoch: 31, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9725692272186279
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9266252517700195
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.0507662296295166
Epoch: 34, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9686002731323242
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.06781005859375
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.9047136306762695
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.9353253841400146
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.007016658782959
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.1451268196105957
Epoch: 40, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.9799749851226807
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.076446533203125
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.9357922077178955
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.9754776954650879
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.005734920501709
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.0325255393981934
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.9894661903381348
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.9890215396881104
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.9405794143676758
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.9930086135864258
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.016683578491211
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.0387754440307617
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.0880126953125
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.0327095985412598
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.0980443954467773
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.9489061832427979
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.9774067401885986
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.89898681640625
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.9312558174133301
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.9408059120178223
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.0131216049194336
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.9982800483703613
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.0774829387664795
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.0389299392700195
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.9597060680389404
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.9762954711914062
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.0127360820770264
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.9831552505493164
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 0.9581873416900635
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9543318748474121
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.0150601863861084
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.0988550186157227
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.101853609085083
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.0568630695343018
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 0.9663872718811035
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.1012318134307861
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.0492031574249268
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.0868632793426514
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.044996738433838
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.1199698448181152
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 0.9947996139526367
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.043565034866333
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.048600435256958
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 0.9352812767028809
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.008500576019287
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.1017558574676514
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.1090786457061768
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.0781686305999756
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.0663056373596191
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.1140267848968506
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.0080254077911377
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.073629379272461
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 1.0250177383422852
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.146150827407837
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.1148040294647217
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.0527212619781494
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.086810827255249
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.0789124965667725
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 1.0531527996063232
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.980 Test Loss: 0.065 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.105940818786621
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 43705
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3490946292877197
Epoch: 1, Steps: 18 | Train Loss: 3.304 Vali Loss: 3.124 Vali Acc: 0.090 Test Loss: 3.124 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 1.1267335414886475
Epoch: 2, Steps: 18 | Train Loss: 3.015 Vali Loss: 2.784 Vali Acc: 0.273 Test Loss: 2.784 Test Acc: 0.273
Validation loss decreased (-0.089969 --> -0.273305).  Saving model ...
Epoch: 3 cost time: 1.103503704071045
Epoch: 3, Steps: 18 | Train Loss: 2.628 Vali Loss: 2.332 Vali Acc: 0.503 Test Loss: 2.332 Test Acc: 0.503
Validation loss decreased (-0.273305 --> -0.503310).  Saving model ...
Epoch: 4 cost time: 0.9586954116821289
Epoch: 4, Steps: 18 | Train Loss: 2.099 Vali Loss: 1.811 Vali Acc: 0.743 Test Loss: 1.811 Test Acc: 0.743
Validation loss decreased (-0.503310 --> -0.743315).  Saving model ...
Epoch: 5 cost time: 1.0236217975616455
Epoch: 5, Steps: 18 | Train Loss: 1.607 Vali Loss: 1.301 Vali Acc: 0.867 Test Loss: 1.301 Test Acc: 0.867
Validation loss decreased (-0.743315 --> -0.866654).  Saving model ...
Epoch: 6 cost time: 1.0860352516174316
Epoch: 6, Steps: 18 | Train Loss: 1.103 Vali Loss: 0.875 Vali Acc: 0.933 Test Loss: 0.875 Test Acc: 0.933
Validation loss decreased (-0.866654 --> -0.933325).  Saving model ...
Epoch: 7 cost time: 1.1315393447875977
Epoch: 7, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.588 Vali Acc: 0.953 Test Loss: 0.588 Test Acc: 0.953
Validation loss decreased (-0.933325 --> -0.953327).  Saving model ...
Epoch: 8 cost time: 1.0445520877838135
Epoch: 8, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.407 Vali Acc: 0.967 Test Loss: 0.407 Test Acc: 0.967
Validation loss decreased (-0.953327 --> -0.966663).  Saving model ...
Epoch: 9 cost time: 0.9505174160003662
Epoch: 9, Steps: 18 | Train Loss: 0.271 Vali Loss: 0.315 Vali Acc: 0.967 Test Loss: 0.315 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 0.9814214706420898
Epoch: 10, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.251 Vali Acc: 0.977 Test Loss: 0.251 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976664).  Saving model ...
Epoch: 11 cost time: 0.9935290813446045
Epoch: 11, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9862251281738281
Epoch: 12, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0180723667144775
Epoch: 13, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.0139296054840088
Epoch: 14, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 15 cost time: 1.1018414497375488
Epoch: 15, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 16 cost time: 1.0723998546600342
Epoch: 16, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9504902362823486
Epoch: 17, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0559661388397217
Epoch: 18, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.0509188175201416
Epoch: 19, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.058321237564087
Epoch: 20, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0665621757507324
Epoch: 21, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0569396018981934
Epoch: 22, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0511772632598877
Epoch: 23, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.018242359161377
Epoch: 24, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 0.9778242111206055
Epoch: 25, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.0961079597473145
Epoch: 26, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.005324125289917
Epoch: 27, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.9133753776550293
Epoch: 28, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.0937504768371582
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.0020403861999512
Epoch: 30, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1025071144104004
Epoch: 31, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.082653284072876
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.1203210353851318
Epoch: 33, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 0.9691224098205566
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 1.0549206733703613
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.0113346576690674
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 0.9909791946411133
Epoch: 37, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 0.9531922340393066
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.008763074874878
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 1.0401129722595215
Epoch: 40, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 0.9980154037475586
Epoch: 41, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 1.123852252960205
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 1.0486602783203125
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 1.096329689025879
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 1.083064079284668
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 0.9146015644073486
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 47 cost time: 0.9290862083435059
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 48 cost time: 1.0184457302093506
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 49 cost time: 0.9703130722045898
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 50 cost time: 1.0428931713104248
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.0262908935546875
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.057896614074707
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.0799474716186523
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.0217068195343018
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.1553771495819092
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.0759212970733643
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.0975983142852783
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 0.9677598476409912
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9595193862915039
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.0279426574707031
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 0.9973795413970947
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.0301105976104736
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.0897204875946045
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.1008718013763428
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.063899278640747
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0367684364318848
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.0432262420654297
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 0.9065966606140137
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.0594403743743896
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.025282621383667
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 0.9183545112609863
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 0.9347960948944092
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 0.9748420715332031
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 0.9687538146972656
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 0.9664747714996338
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 0.9687538146972656
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.0041000843048096
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.9877865314483643
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.022639274597168
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 0.9916770458221436
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 0.9880762100219727
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.0019617080688477
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.986966609954834
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 0.9862082004547119
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 0.9914591312408447
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 0.9707746505737305
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.0655882358551025
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 1.0173025131225586
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 1.0337188243865967
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.9726295471191406
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.0407803058624268
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.0179107189178467
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 1.0068447589874268
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 0.9450991153717041
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 0.9878513813018799
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 0.8212699890136719
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 97 cost time: 0.9996993541717529
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.9669599533081055
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 1.0839006900787354
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.9735755920410156
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 40217
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.1673507690429688
Epoch: 1, Steps: 18 | Train Loss: 3.154 Vali Loss: 2.430 Vali Acc: 0.503 Test Loss: 2.430 Test Acc: 0.503
Validation loss decreased (inf --> -0.503309).  Saving model ...
Epoch: 2 cost time: 1.2984752655029297
Epoch: 2, Steps: 18 | Train Loss: 1.838 Vali Loss: 0.995 Vali Acc: 0.933 Test Loss: 0.995 Test Acc: 0.933
Validation loss decreased (-0.503309 --> -0.933323).  Saving model ...
Epoch: 3 cost time: 1.5409915447235107
Epoch: 3, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.371 Vali Acc: 0.937 Test Loss: 0.371 Test Acc: 0.937
Validation loss decreased (-0.933323 --> -0.936663).  Saving model ...
Epoch: 4 cost time: 1.7680811882019043
Epoch: 4, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
Validation loss decreased (-0.936663 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.5531671047210693
Epoch: 5, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5068607330322266
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4331319332122803
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.6008353233337402
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.5653724670410156
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.738020420074463
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.5913515090942383
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.5039782524108887
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9157419204711914
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.5831027030944824
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.473773717880249
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4400734901428223
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.6414530277252197
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7386136054992676
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.578155517578125
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6969363689422607
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3124501705169678
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.8299925327301025
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.8831679821014404
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.9562714099884033
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.8232247829437256
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.855440616607666
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.7734904289245605
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.0913312435150146
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.9910883903503418
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7329578399658203
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8034858703613281
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8039462566375732
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.9776115417480469
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.942155361175537
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.82183837890625
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.7529487609863281
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.678227424621582
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6065726280212402
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 265881
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5318455696105957
Epoch: 1, Steps: 18 | Train Loss: 3.292 Vali Loss: 2.794 Vali Acc: 0.260 Test Loss: 2.794 Test Acc: 0.260
Validation loss decreased (inf --> -0.259972).  Saving model ...
Epoch: 2 cost time: 1.0512034893035889
Epoch: 2, Steps: 18 | Train Loss: 2.343 Vali Loss: 1.669 Vali Acc: 0.847 Test Loss: 1.669 Test Acc: 0.847
Validation loss decreased (-0.259972 --> -0.846650).  Saving model ...
Epoch: 3 cost time: 1.089996337890625
Epoch: 3, Steps: 18 | Train Loss: 1.230 Vali Loss: 0.733 Vali Acc: 0.950 Test Loss: 0.733 Test Acc: 0.950
Validation loss decreased (-0.846650 --> -0.949993).  Saving model ...
Epoch: 4 cost time: 1.1016302108764648
Epoch: 4, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.331 Vali Acc: 0.957 Test Loss: 0.331 Test Acc: 0.957
Validation loss decreased (-0.949993 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 1.0419812202453613
Epoch: 5, Steps: 18 | Train Loss: 0.237 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
Validation loss decreased (-0.956663 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 1.0165293216705322
Epoch: 6, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.987816572189331
Epoch: 7, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.0767858028411865
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.9964613914489746
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9991378784179688
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.010878562927246
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0763661861419678
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9763510227203369
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9952793121337891
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9411547183990479
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0452144145965576
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9769797325134277
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0502872467041016
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.980125904083252
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.98392653465271
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.117570161819458
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0319743156433105
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0704405307769775
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.208531379699707
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.0855464935302734
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.0998034477233887
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.0783414840698242
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.066300868988037
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0506861209869385
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.047987461090088
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.0241167545318604
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.0444107055664062
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.1216812133789062
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.1119439601898193
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.0036711692810059
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.0642802715301514
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9785776138305664
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0332777500152588
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.0367565155029297
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.0290424823760986
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0136940479278564
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.074735403060913
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.017744779586792
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.0722262859344482
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.041076421737671
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.0747339725494385
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.107166051864624
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.1932103633880615
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1250338554382324
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.048865556716919
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.9758548736572266
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.0350079536437988
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.0268950462341309
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.9973680973052979
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0354361534118652
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.0922377109527588
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0305688381195068
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.0663766860961914
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.0017788410186768
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0559852123260498
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.0201740264892578
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.0701076984405518
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0617313385009766
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0871195793151855
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1303884983062744
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.0577659606933594
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.0128042697906494
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.1011137962341309
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 136345
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.635265588760376
Epoch: 1, Steps: 18 | Train Loss: 3.274 Vali Loss: 2.905 Vali Acc: 0.220 Test Loss: 2.905 Test Acc: 0.220
Validation loss decreased (inf --> -0.219971).  Saving model ...
Epoch: 2 cost time: 0.9487221240997314
Epoch: 2, Steps: 18 | Train Loss: 2.716 Vali Loss: 2.148 Vali Acc: 0.657 Test Loss: 2.148 Test Acc: 0.657
Validation loss decreased (-0.219971 --> -0.656645).  Saving model ...
Epoch: 3 cost time: 0.995863676071167
Epoch: 3, Steps: 18 | Train Loss: 1.870 Vali Loss: 1.326 Vali Acc: 0.900 Test Loss: 1.326 Test Acc: 0.900
Validation loss decreased (-0.656645 --> -0.899987).  Saving model ...
Epoch: 4 cost time: 0.9677114486694336
Epoch: 4, Steps: 18 | Train Loss: 1.067 Vali Loss: 0.708 Vali Acc: 0.910 Test Loss: 0.708 Test Acc: 0.910
Validation loss decreased (-0.899987 --> -0.909993).  Saving model ...
Epoch: 5 cost time: 1.0640130043029785
Epoch: 5, Steps: 18 | Train Loss: 0.465 Vali Loss: 0.364 Vali Acc: 0.953 Test Loss: 0.364 Test Acc: 0.953
Validation loss decreased (-0.909993 --> -0.953330).  Saving model ...
Epoch: 6 cost time: 1.0783424377441406
Epoch: 6, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.223 Vali Acc: 0.953 Test Loss: 0.223 Test Acc: 0.953
Validation loss decreased (-0.953330 --> -0.953331).  Saving model ...
Epoch: 7 cost time: 0.9877078533172607
Epoch: 7, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.9528660774230957
Epoch: 8, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 0.9491977691650391
Epoch: 9, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.937152624130249
Epoch: 10, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0216057300567627
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1076524257659912
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 1.007204294204712
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.0302622318267822
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9662909507751465
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.064650058746338
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0008924007415771
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.024167537689209
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0929627418518066
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0558149814605713
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.10197114944458
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0544135570526123
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0050349235534668
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.9795331954956055
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.9998784065246582
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0958964824676514
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.017319917678833
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.9770646095275879
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.9840986728668213
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.0321557521820068
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0267553329467773
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1085493564605713
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1213879585266113
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.089205265045166
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.0578181743621826
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.0457680225372314
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0433952808380127
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1747758388519287
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9499247074127197
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0418460369110107
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.0537173748016357
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.9591898918151855
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.0964465141296387
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.078641414642334
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.0957965850830078
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.0376944541931152
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0122628211975098
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.9388062953948975
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.018165111541748
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9912502765655518
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.012063980102539
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.0184733867645264
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.0874443054199219
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0736939907073975
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.0316290855407715
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.9459433555603027
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.0472228527069092
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.019770622253418
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.156566858291626
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.029806137084961
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1628930568695068
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0128543376922607
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.1413350105285645
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.1264538764953613
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.1167807579040527
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.1042170524597168
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.0720274448394775
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.1564271450042725
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.0162978172302246
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.0160636901855469
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.0289463996887207
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.1933374404907227
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.0415184497833252
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.1428906917572021
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.9994895458221436
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.9184176921844482
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 1.0570857524871826
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 1.0938184261322021
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.0865228176116943
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.0445396900177002
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 1.2043688297271729
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 1.0869708061218262
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 93193
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6157660484313965
Epoch: 1, Steps: 18 | Train Loss: 3.264 Vali Loss: 3.018 Vali Acc: 0.170 Test Loss: 3.018 Test Acc: 0.170
Validation loss decreased (inf --> -0.169970).  Saving model ...
Epoch: 2 cost time: 1.0419204235076904
Epoch: 2, Steps: 18 | Train Loss: 2.787 Vali Loss: 2.380 Vali Acc: 0.547 Test Loss: 2.380 Test Acc: 0.547
Validation loss decreased (-0.169970 --> -0.546643).  Saving model ...
Epoch: 3 cost time: 1.0907316207885742
Epoch: 3, Steps: 18 | Train Loss: 2.129 Vali Loss: 1.652 Vali Acc: 0.857 Test Loss: 1.652 Test Acc: 0.857
Validation loss decreased (-0.546643 --> -0.856650).  Saving model ...
Epoch: 4 cost time: 1.057854413986206
Epoch: 4, Steps: 18 | Train Loss: 1.369 Vali Loss: 0.975 Vali Acc: 0.927 Test Loss: 0.975 Test Acc: 0.927
Validation loss decreased (-0.856650 --> -0.926657).  Saving model ...
Epoch: 5 cost time: 1.0511014461517334
Epoch: 5, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.534 Vali Acc: 0.953 Test Loss: 0.534 Test Acc: 0.953
Validation loss decreased (-0.926657 --> -0.953328).  Saving model ...
Epoch: 6 cost time: 1.121309757232666
Epoch: 6, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0912137031555176
Epoch: 7, Steps: 18 | Train Loss: 0.189 Vali Loss: 0.218 Vali Acc: 0.967 Test Loss: 0.218 Test Acc: 0.967
Validation loss decreased (-0.953328 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 1.0210583209991455
Epoch: 8, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.055753231048584
Epoch: 9, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 1.1424832344055176
Epoch: 10, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 1.08685302734375
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 1.0922799110412598
Epoch: 12, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.0737621784210205
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.152806282043457
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 1.0393941402435303
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0966901779174805
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0869004726409912
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0430338382720947
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.1009769439697266
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0381836891174316
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.091336727142334
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.1802961826324463
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.1351449489593506
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0994226932525635
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1368484497070312
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0421547889709473
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.1312992572784424
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.036618709564209
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.9978852272033691
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1631407737731934
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.0560414791107178
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.0775575637817383
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.156656265258789
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.100860595703125
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.1251370906829834
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.0940742492675781
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0763907432556152
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.0325732231140137
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.092998743057251
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.067669153213501
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.0345649719238281
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1864938735961914
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1009681224822998
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.1536476612091064
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0892457962036133
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2342314720153809
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0608019828796387
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 1.1505169868469238
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.1589007377624512
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.2092316150665283
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1695032119750977
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.0936720371246338
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.1067748069763184
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.1305744647979736
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.1813750267028809
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0663886070251465
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1319730281829834
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.092738151550293
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.1246592998504639
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 1.068356990814209
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.1010699272155762
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.201338529586792
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.0765326023101807
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.077436923980713
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.0156235694885254
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.0497984886169434
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.0892133712768555
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 1.1797466278076172
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.0184688568115234
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.0501227378845215
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 71657
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5111985206604004
Epoch: 1, Steps: 18 | Train Loss: 3.377 Vali Loss: 3.156 Vali Acc: 0.087 Test Loss: 3.156 Test Acc: 0.087
Validation loss decreased (inf --> -0.086635).  Saving model ...
Epoch: 2 cost time: 1.0257976055145264
Epoch: 2, Steps: 18 | Train Loss: 3.040 Vali Loss: 2.699 Vali Acc: 0.340 Test Loss: 2.699 Test Acc: 0.340
Validation loss decreased (-0.086635 --> -0.339973).  Saving model ...
Epoch: 3 cost time: 1.0662007331848145
Epoch: 3, Steps: 18 | Train Loss: 2.488 Vali Loss: 2.095 Vali Acc: 0.693 Test Loss: 2.095 Test Acc: 0.693
Validation loss decreased (-0.339973 --> -0.693312).  Saving model ...
Epoch: 4 cost time: 1.006256341934204
Epoch: 4, Steps: 18 | Train Loss: 1.812 Vali Loss: 1.397 Vali Acc: 0.917 Test Loss: 1.397 Test Acc: 0.917
Validation loss decreased (-0.693312 --> -0.916653).  Saving model ...
Epoch: 5 cost time: 1.0408406257629395
Epoch: 5, Steps: 18 | Train Loss: 1.163 Vali Loss: 0.812 Vali Acc: 0.957 Test Loss: 0.812 Test Acc: 0.957
Validation loss decreased (-0.916653 --> -0.956659).  Saving model ...
Epoch: 6 cost time: 1.0208404064178467
Epoch: 6, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.464 Vali Acc: 0.970 Test Loss: 0.464 Test Acc: 0.970
Validation loss decreased (-0.956659 --> -0.969995).  Saving model ...
Epoch: 7 cost time: 0.9814927577972412
Epoch: 7, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.299 Vali Acc: 0.970 Test Loss: 0.299 Test Acc: 0.970
Validation loss decreased (-0.969995 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 1.091628074645996
Epoch: 8, Steps: 18 | Train Loss: 0.187 Vali Loss: 0.218 Vali Acc: 0.977 Test Loss: 0.218 Test Acc: 0.977
Validation loss decreased (-0.969997 --> -0.976664).  Saving model ...
Epoch: 9 cost time: 1.0438272953033447
Epoch: 9, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.0090711116790771
Epoch: 10, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9344067573547363
Epoch: 11, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0002388954162598
Epoch: 12, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.9730994701385498
Epoch: 13, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 1.0054082870483398
Epoch: 14, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0006062984466553
Epoch: 15, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8902723789215088
Epoch: 16, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.018599033355713
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0341851711273193
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0008785724639893
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.9402306079864502
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0150578022003174
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.060924768447876
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.022343635559082
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9782013893127441
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.9740133285522461
Epoch: 25, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.0527923107147217
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0177574157714844
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0352749824523926
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1211678981781006
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0687775611877441
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.172954797744751
Epoch: 31, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.062941312789917
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.139481782913208
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0507094860076904
Epoch: 34, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0776584148406982
Epoch: 35, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 53769
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.794705867767334
Epoch: 1, Steps: 18 | Train Loss: 3.376 Vali Loss: 3.203 Vali Acc: 0.053 Test Loss: 3.203 Test Acc: 0.053
Validation loss decreased (inf --> -0.053301).  Saving model ...
Epoch: 2 cost time: 0.9782323837280273
Epoch: 2, Steps: 18 | Train Loss: 3.141 Vali Loss: 2.814 Vali Acc: 0.230 Test Loss: 2.814 Test Acc: 0.230
Validation loss decreased (-0.053301 --> -0.229972).  Saving model ...
Epoch: 3 cost time: 1.0094261169433594
Epoch: 3, Steps: 18 | Train Loss: 2.641 Vali Loss: 2.313 Vali Acc: 0.527 Test Loss: 2.313 Test Acc: 0.527
Validation loss decreased (-0.229972 --> -0.526644).  Saving model ...
Epoch: 4 cost time: 1.0232834815979004
Epoch: 4, Steps: 18 | Train Loss: 2.097 Vali Loss: 1.751 Vali Acc: 0.783 Test Loss: 1.751 Test Acc: 0.783
Validation loss decreased (-0.526644 --> -0.783316).  Saving model ...
Epoch: 5 cost time: 1.06107759475708
Epoch: 5, Steps: 18 | Train Loss: 1.572 Vali Loss: 1.212 Vali Acc: 0.893 Test Loss: 1.212 Test Acc: 0.893
Validation loss decreased (-0.783316 --> -0.893321).  Saving model ...
Epoch: 6 cost time: 1.0216679573059082
Epoch: 6, Steps: 18 | Train Loss: 1.037 Vali Loss: 0.801 Vali Acc: 0.933 Test Loss: 0.801 Test Acc: 0.933
Validation loss decreased (-0.893321 --> -0.933325).  Saving model ...
Epoch: 7 cost time: 0.9804706573486328
Epoch: 7, Steps: 18 | Train Loss: 0.631 Vali Loss: 0.521 Vali Acc: 0.947 Test Loss: 0.521 Test Acc: 0.947
Validation loss decreased (-0.933325 --> -0.946661).  Saving model ...
Epoch: 8 cost time: 1.0363585948944092
Epoch: 8, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.371 Vali Acc: 0.963 Test Loss: 0.371 Test Acc: 0.963
Validation loss decreased (-0.946661 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 1.0771615505218506
Epoch: 9, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.288 Vali Acc: 0.963 Test Loss: 0.288 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963330).  Saving model ...
Epoch: 10 cost time: 1.092961072921753
Epoch: 10, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.243 Vali Acc: 0.963 Test Loss: 0.243 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 0.9835333824157715
Epoch: 11, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.206 Vali Acc: 0.970 Test Loss: 0.206 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 1.0104010105133057
Epoch: 12, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 1.0892388820648193
Epoch: 13, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 0.9358086585998535
Epoch: 14, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.0755321979522705
Epoch: 15, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0899224281311035
Epoch: 16, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.196474552154541
Epoch: 17, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 1.099632978439331
Epoch: 18, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0582480430603027
Epoch: 19, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 1.0287683010101318
Epoch: 20, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 1.2068469524383545
Epoch: 21, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.113581895828247
Epoch: 22, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.1330368518829346
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.046159267425537
Epoch: 24, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0736174583435059
Epoch: 25, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1667611598968506
Epoch: 26, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9312031269073486
Epoch: 27, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0019981861114502
Epoch: 28, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0177741050720215
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0287225246429443
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0773015022277832
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.0469961166381836
Epoch: 32, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.0768609046936035
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.9954566955566406
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0786168575286865
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.0535032749176025
Epoch: 36, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.0410182476043701
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.0657708644866943
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.9800312519073486
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.0966577529907227
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.0798015594482422
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.0796067714691162
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.0667414665222168
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.0050859451293945
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.0002708435058594
Epoch: 45, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.073608636856079
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.9688241481781006
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.0510621070861816
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.0929865837097168
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.0982096195220947
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.0659492015838623
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.0591859817504883
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.1372933387756348
Epoch: 53, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.131519079208374
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.9708037376403809
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.0452587604522705
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.0803778171539307
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.0448381900787354
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.0975673198699951
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.0521745681762695
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0082008838653564
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.0304207801818848
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.0332396030426025
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.1106557846069336
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.0628502368927002
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.104677677154541
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.069026231765747
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.008019208908081
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.032526969909668
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.0505850315093994
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.0241796970367432
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.0751683712005615
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 1.049856185913086
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 1.0983633995056152
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.138552188873291
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.051079511642456
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 0.9767913818359375
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.960059404373169
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.0921709537506104
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.0818061828613281
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.0227291584014893
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 0.984417200088501
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 0.9908452033996582
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.1227796077728271
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.0780770778656006
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.0261931419372559
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.0610604286193848
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.0485568046569824
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.061645746231079
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 0.9986391067504883
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.0270984172821045
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.0360593795776367
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.9754848480224609
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.0272130966186523
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 1.021923542022705
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.0504224300384521
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.1008498668670654
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.0188660621643066
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 0.9121131896972656
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.0296192169189453
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 39481
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.442227840423584
Epoch: 1, Steps: 18 | Train Loss: 3.373 Vali Loss: 3.216 Vali Acc: 0.080 Test Loss: 3.216 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 0.9598877429962158
Epoch: 2, Steps: 18 | Train Loss: 3.104 Vali Loss: 2.856 Vali Acc: 0.180 Test Loss: 2.856 Test Acc: 0.180
Validation loss decreased (-0.079968 --> -0.179971).  Saving model ...
Epoch: 3 cost time: 0.8572051525115967
Epoch: 3, Steps: 18 | Train Loss: 2.719 Vali Loss: 2.382 Vali Acc: 0.500 Test Loss: 2.382 Test Acc: 0.500
Validation loss decreased (-0.179971 --> -0.499976).  Saving model ...
Epoch: 4 cost time: 1.0898633003234863
Epoch: 4, Steps: 18 | Train Loss: 2.194 Vali Loss: 1.831 Vali Acc: 0.800 Test Loss: 1.831 Test Acc: 0.800
Validation loss decreased (-0.499976 --> -0.799982).  Saving model ...
Epoch: 5 cost time: 0.8953535556793213
Epoch: 5, Steps: 18 | Train Loss: 1.649 Vali Loss: 1.300 Vali Acc: 0.893 Test Loss: 1.300 Test Acc: 0.893
Validation loss decreased (-0.799982 --> -0.893320).  Saving model ...
Epoch: 6 cost time: 0.9453966617584229
Epoch: 6, Steps: 18 | Train Loss: 1.110 Vali Loss: 0.859 Vali Acc: 0.927 Test Loss: 0.859 Test Acc: 0.927
Validation loss decreased (-0.893320 --> -0.926658).  Saving model ...
Epoch: 7 cost time: 0.9431343078613281
Epoch: 7, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.561 Vali Acc: 0.937 Test Loss: 0.561 Test Acc: 0.937
Validation loss decreased (-0.926658 --> -0.936661).  Saving model ...
Epoch: 8 cost time: 1.027923822402954
Epoch: 8, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.385 Vali Acc: 0.960 Test Loss: 0.385 Test Acc: 0.960
Validation loss decreased (-0.936661 --> -0.959996).  Saving model ...
Epoch: 9 cost time: 0.9535703659057617
Epoch: 9, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.293 Vali Acc: 0.963 Test Loss: 0.293 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 10 cost time: 0.971968412399292
Epoch: 10, Steps: 18 | Train Loss: 0.181 Vali Loss: 0.241 Vali Acc: 0.970 Test Loss: 0.241 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.9743759632110596
Epoch: 11, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.207 Vali Acc: 0.970 Test Loss: 0.207 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.9141597747802734
Epoch: 12, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.8745312690734863
Epoch: 13, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.9220619201660156
Epoch: 14, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9353852272033691
Epoch: 15, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.9524445533752441
Epoch: 16, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9215023517608643
Epoch: 17, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9110424518585205
Epoch: 18, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9189412593841553
Epoch: 19, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.9371616840362549
Epoch: 20, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8801572322845459
Epoch: 21, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0127232074737549
Epoch: 22, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.9373204708099365
Epoch: 23, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9944207668304443
Epoch: 24, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9672427177429199
Epoch: 25, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9228715896606445
Epoch: 26, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7597403526306152
Epoch: 27, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.9179327487945557
Epoch: 28, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.932978630065918
Epoch: 29, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9276759624481201
Epoch: 30, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9121212959289551
Epoch: 31, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.9269123077392578
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.9665818214416504
Epoch: 33, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.910538911819458
Epoch: 34, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.9475431442260742
Epoch: 35, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.9255156517028809
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.9454593658447266
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9580268859863281
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9819402694702148
Epoch: 39, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9226634502410889
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.9242839813232422
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9006834030151367
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.9345428943634033
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.9242606163024902
Epoch: 44, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.9091932773590088
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.9271240234375
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.9522583484649658
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.7976293563842773
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 0.9427566528320312
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 0.9134912490844727
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9921441078186035
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.0168185234069824
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8926270008087158
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 1.0429978370666504
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 0.9626681804656982
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 1.1245009899139404
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 1.0788002014160156
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 1.0651438236236572
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0123531818389893
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 1.0484023094177246
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 1.101891040802002
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 1.0249478816986084
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.0435705184936523
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.079176902770996
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0808594226837158
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 0.9827768802642822
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 0.9875452518463135
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.03448486328125
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.068554401397705
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.0705478191375732
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 0.9993095397949219
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 1.0509674549102783
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 0.9890542030334473
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.0129303932189941
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 1.1441495418548584
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 1.101618766784668
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 77 cost time: 1.084885597229004
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 78 cost time: 1.1130452156066895
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 79 cost time: 1.0011937618255615
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 80 cost time: 1.0173707008361816
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 81 cost time: 1.0549430847167969
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 82 cost time: 0.9956083297729492
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.9914205074310303
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 84 cost time: 1.0470166206359863
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 85 cost time: 0.9914939403533936
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 86 cost time: 1.1362109184265137
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.109304666519165
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.0836865901947021
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.0815622806549072
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.1198835372924805
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 91 cost time: 1.0865609645843506
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 92 cost time: 1.0950441360473633
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.164928674697876
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 94 cost time: 1.0469131469726562
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.0719685554504395
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 96 cost time: 1.1045560836791992
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.1083984375
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 98 cost time: 1.1889874935150146
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 99 cost time: 1.1513237953186035
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 100 cost time: 0.9941821098327637
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el2_dm16_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 35993
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8343734741210938
Epoch: 1, Steps: 18 | Train Loss: 2.228 Vali Loss: 0.767 Vali Acc: 0.737 Test Loss: 0.767 Test Acc: 0.737
Validation loss decreased (inf --> -0.736659).  Saving model ...
Epoch: 2 cost time: 1.4325616359710693
Epoch: 2, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.294 Vali Acc: 0.920 Test Loss: 0.294 Test Acc: 0.920
Validation loss decreased (-0.736659 --> -0.919997).  Saving model ...
Epoch: 3 cost time: 1.4161996841430664
Epoch: 3, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.656 Vali Acc: 0.880 Test Loss: 0.656 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4283785820007324
Epoch: 4, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.356 Vali Acc: 0.937 Test Loss: 0.356 Test Acc: 0.937
Validation loss decreased (-0.919997 --> -0.936663).  Saving model ...
Epoch: 5 cost time: 1.5223171710968018
Epoch: 5, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.665 Vali Acc: 0.893 Test Loss: 0.665 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6053156852722168
Epoch: 6, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.552 Vali Acc: 0.920 Test Loss: 0.552 Test Acc: 0.920
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5413424968719482
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.576 Vali Acc: 0.927 Test Loss: 0.576 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3995106220245361
Epoch: 8, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.797 Vali Acc: 0.913 Test Loss: 0.797 Test Acc: 0.913
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6026458740234375
Epoch: 9, Steps: 18 | Train Loss: 0.062 Vali Loss: 1.137 Vali Acc: 0.877 Test Loss: 1.137 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5195794105529785
Epoch: 10, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.034 Vali Acc: 0.907 Test Loss: 1.034 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.547499179840088
Epoch: 11, Steps: 18 | Train Loss: 0.046 Vali Loss: 1.036 Vali Acc: 0.900 Test Loss: 1.036 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.539158582687378
Epoch: 12, Steps: 18 | Train Loss: 0.148 Vali Loss: 1.308 Vali Acc: 0.880 Test Loss: 1.308 Test Acc: 0.880
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4692370891571045
Epoch: 13, Steps: 18 | Train Loss: 0.226 Vali Loss: 1.023 Vali Acc: 0.897 Test Loss: 1.023 Test Acc: 0.897
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.622953176498413
Epoch: 14, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.074 Vali Acc: 0.907 Test Loss: 1.074 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9366666666666666
model parameter : 2206873
model size : 10.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7795286178588867
Epoch: 1, Steps: 18 | Train Loss: 2.433 Vali Loss: 0.710 Vali Acc: 0.890 Test Loss: 0.710 Test Acc: 0.890
Validation loss decreased (inf --> -0.889993).  Saving model ...
Epoch: 2 cost time: 1.062983512878418
Epoch: 2, Steps: 18 | Train Loss: 0.264 Vali Loss: 0.235 Vali Acc: 0.927 Test Loss: 0.235 Test Acc: 0.927
Validation loss decreased (-0.889993 --> -0.926664).  Saving model ...
Epoch: 3 cost time: 1.059746265411377
Epoch: 3, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.926664 --> -0.933331).  Saving model ...
Epoch: 4 cost time: 1.0762958526611328
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
Validation loss decreased (-0.933331 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.0219111442565918
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.960 Test Loss: 0.179 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1243653297424316
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.943 Test Loss: 0.288 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0490155220031738
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1808958053588867
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.947 Test Loss: 0.191 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1200597286224365
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.953 Test Loss: 0.211 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0896329879760742
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1530535221099854
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 1.183776617050171
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0858185291290283
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.264 Vali Acc: 0.957 Test Loss: 0.264 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1666266918182373
Epoch: 14, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.714 Vali Acc: 0.897 Test Loss: 0.714 Test Acc: 0.897
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.110152244567871
Epoch: 15, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.508 Vali Acc: 0.927 Test Loss: 0.508 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1004836559295654
Epoch: 16, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.650 Vali Acc: 0.903 Test Loss: 0.650 Test Acc: 0.903
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0737864971160889
Epoch: 17, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.339 Vali Acc: 0.947 Test Loss: 0.339 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1984069347381592
Epoch: 18, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.679 Vali Acc: 0.923 Test Loss: 0.679 Test Acc: 0.923
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0533487796783447
Epoch: 19, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.707 Vali Acc: 0.907 Test Loss: 0.707 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1643562316894531
Epoch: 20, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.007 Vali Acc: 0.893 Test Loss: 1.007 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.016169548034668
Epoch: 21, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.780 Vali Acc: 0.903 Test Loss: 0.780 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 1170585
model size : 6.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.535762310028076
Epoch: 1, Steps: 18 | Train Loss: 2.708 Vali Loss: 1.119 Vali Acc: 0.890 Test Loss: 1.119 Test Acc: 0.890
Validation loss decreased (inf --> -0.889989).  Saving model ...
Epoch: 2 cost time: 1.103407859802246
Epoch: 2, Steps: 18 | Train Loss: 0.470 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
Validation loss decreased (-0.889989 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.0571470260620117
Epoch: 3, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.119724988937378
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.0348577499389648
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.0101068019866943
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9693996906280518
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9564719200134277
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.061650276184082
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.0424671173095703
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9902117252349854
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9712944030761719
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0635528564453125
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9574048519134521
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0194499492645264
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0337493419647217
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9073116779327393
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0247035026550293
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0138134956359863
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 825369
model size : 5.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4051942825317383
Epoch: 1, Steps: 18 | Train Loss: 2.880 Vali Loss: 1.532 Vali Acc: 0.817 Test Loss: 1.532 Test Acc: 0.817
Validation loss decreased (inf --> -0.816651).  Saving model ...
Epoch: 2 cost time: 0.9834325313568115
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.285 Vali Acc: 0.947 Test Loss: 0.285 Test Acc: 0.947
Validation loss decreased (-0.816651 --> -0.946664).  Saving model ...
Epoch: 3 cost time: 0.933255672454834
Epoch: 3, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
Validation loss decreased (-0.946664 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 0.9140477180480957
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.9713830947875977
Epoch: 5, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.947 Test Loss: 0.175 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9616742134094238
Epoch: 6, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.9406287670135498
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.1435976028442383
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0990777015686035
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.0095114707946777
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9445786476135254
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9415056705474854
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9575080871582031
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9494915008544922
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0071628093719482
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.013016700744629
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9458844661712646
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9842038154602051
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9574954509735107
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0212829113006592
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.9083902835845947
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.016101598739624
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.952315092086792
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.9944651126861572
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.9800119400024414
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9638359546661377
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.9186947345733643
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0589256286621094
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.996973991394043
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0628700256347656
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.0491108894348145
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.0102014541625977
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.9776296615600586
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.9881424903869629
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.9583814144134521
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.9869387149810791
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0241880416870117
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9325389862060547
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.90836501121521
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.0702240467071533
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0413703918457031
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.9891226291656494
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.9663817882537842
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0202455520629883
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.0263803005218506
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9854669570922852
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.0801029205322266
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.9801812171936035
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 1.0143609046936035
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7661886215209961
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.122159481048584
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1527643203735352
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1413648128509521
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0308184623718262
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.1603002548217773
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1506626605987549
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.1147432327270508
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0840332508087158
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1476051807403564
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.0799758434295654
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.1200306415557861
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0477473735809326
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.030472993850708
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.055626392364502
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.0747835636138916
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0591554641723633
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.165860652923584
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.17924165725708
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.255507469177246
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 1.1866369247436523
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 1.1239349842071533
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 1.1187207698822021
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.1842000484466553
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.2170145511627197
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.1366708278656006
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.1280102729797363
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.017932415008545
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.14113450050354
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.127378225326538
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.0943419933319092
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 1.085315227508545
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.0836272239685059
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.122225046157837
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.1764881610870361
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.0644278526306152
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.0797381401062012
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 1.045257568359375
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.088111400604248
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.0550146102905273
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.111246109008789
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 1.1527118682861328
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.1206042766571045
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 1.1203274726867676
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 1.1341793537139893
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 1.2387375831604004
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 1.0790133476257324
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 1.1217310428619385
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 1.1608524322509766
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 1.1318981647491455
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 653081
model size : 4.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.449653387069702
Epoch: 1, Steps: 18 | Train Loss: 2.875 Vali Loss: 1.692 Vali Acc: 0.793 Test Loss: 1.692 Test Acc: 0.793
Validation loss decreased (inf --> -0.793316).  Saving model ...
Epoch: 2 cost time: 1.0580360889434814
Epoch: 2, Steps: 18 | Train Loss: 0.902 Vali Loss: 0.342 Vali Acc: 0.940 Test Loss: 0.342 Test Acc: 0.940
Validation loss decreased (-0.793316 --> -0.939997).  Saving model ...
Epoch: 3 cost time: 1.0599188804626465
Epoch: 3, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
Validation loss decreased (-0.939997 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.0792436599731445
Epoch: 4, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959999).  Saving model ...
Epoch: 5 cost time: 1.1339125633239746
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.0408384799957275
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.0266392230987549
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.1230385303497314
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.063227653503418
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0665009021759033
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0079011917114258
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.1625299453735352
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.03654146194458
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1429595947265625
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9813868999481201
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0873451232910156
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0783820152282715
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.099593162536621
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0331952571868896
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0390753746032715
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1137778759002686
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0654780864715576
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.078979253768921
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.1118061542510986
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0645194053649902
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0479435920715332
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.090402364730835
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.0604116916656494
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0628840923309326
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0673716068267822
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.124741792678833
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1101558208465576
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.141901969909668
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.045377254486084
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.0351686477661133
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.1521775722503662
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0736849308013916
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1127235889434814
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0536167621612549
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.1687817573547363
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0932636260986328
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0610089302062988
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.0721449851989746
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.0669965744018555
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.0495152473449707
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.1055738925933838
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.076223373413086
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.074272632598877
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0718028545379639
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0504746437072754
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.040421724319458
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0927016735076904
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0695226192474365
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9244081974029541
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.0206871032714844
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 509977
model size : 4.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4922945499420166
Epoch: 1, Steps: 18 | Train Loss: 3.035 Vali Loss: 2.098 Vali Acc: 0.720 Test Loss: 2.098 Test Acc: 0.720
Validation loss decreased (inf --> -0.719979).  Saving model ...
Epoch: 2 cost time: 0.9020609855651855
Epoch: 2, Steps: 18 | Train Loss: 1.271 Vali Loss: 0.566 Vali Acc: 0.947 Test Loss: 0.566 Test Acc: 0.947
Validation loss decreased (-0.719979 --> -0.946661).  Saving model ...
Epoch: 3 cost time: 1.0824675559997559
Epoch: 3, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
Validation loss decreased (-0.946661 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 0.981257438659668
Epoch: 4, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 0.9138829708099365
Epoch: 5, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.963 Test Loss: 0.118 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9323952198028564
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9255146980285645
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.0266849994659424
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.057258129119873
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9923784732818604
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9936628341674805
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.985339879989624
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9439182281494141
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0045769214630127
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1622610092163086
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.000605583190918
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9549226760864258
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.9974133968353271
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1632616519927979
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.0873324871063232
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0381228923797607
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9687204360961914
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0081250667572021
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9739727973937988
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9614644050598145
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0397686958312988
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8642251491546631
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.9798407554626465
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0406243801116943
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.0794689655303955
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 0.9568672180175781
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0353293418884277
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.084038257598877
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0007708072662354
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.08463454246521
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0096557140350342
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0189449787139893
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0286810398101807
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0064294338226318
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0301501750946045
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 395673
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4181454181671143
Epoch: 1, Steps: 18 | Train Loss: 3.064 Vali Loss: 2.152 Vali Acc: 0.633 Test Loss: 2.152 Test Acc: 0.633
Validation loss decreased (inf --> -0.633312).  Saving model ...
Epoch: 2 cost time: 0.8746986389160156
Epoch: 2, Steps: 18 | Train Loss: 1.387 Vali Loss: 0.620 Vali Acc: 0.937 Test Loss: 0.620 Test Acc: 0.937
Validation loss decreased (-0.633312 --> -0.936660).  Saving model ...
Epoch: 3 cost time: 0.9806396961212158
Epoch: 3, Steps: 18 | Train Loss: 0.334 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.936660 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.0270893573760986
Epoch: 4, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.0421688556671143
Epoch: 5, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.963 Test Loss: 0.123 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9936861991882324
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.9660904407501221
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8492231369018555
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.9039936065673828
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.8662126064300537
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0069937705993652
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9235420227050781
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.0079865455627441
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0123798847198486
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9414331912994385
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9476873874664307
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1193392276763916
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0113294124603271
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0618524551391602
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1005456447601318
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0633513927459717
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0055742263793945
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.107255220413208
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0192756652832031
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0845041275024414
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0694139003753662
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0433485507965088
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.0016558170318604
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.9902729988098145
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0212512016296387
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0560109615325928
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9374916553497314
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0001931190490723
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1083457469940186
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.099125623703003
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0448145866394043
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0385985374450684
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0797655582427979
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.032076358795166
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.044792890548706
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.1005237102508545
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.035125970840454
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1789441108703613
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.092395305633545
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.0512139797210693
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.937309980392456
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.0057966709136963
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0691182613372803
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0247044563293457
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.0677990913391113
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 1.1026628017425537
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 1.0911104679107666
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.0804243087768555
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0198266506195068
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.0019495487213135
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 1.0071353912353516
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.065427303314209
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.0432422161102295
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0025818347930908
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9783906936645508
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.064596176147461
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.0620603561401367
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.0740296840667725
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.0617766380310059
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.0283164978027344
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.075765609741211
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.0342848300933838
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 367769
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.047668695449829
Epoch: 1, Steps: 18 | Train Loss: 2.134 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
Validation loss decreased (inf --> -0.869996).  Saving model ...
Epoch: 2 cost time: 1.523407220840454
Epoch: 2, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.299 Vali Acc: 0.903 Test Loss: 0.299 Test Acc: 0.903
Validation loss decreased (-0.869996 --> -0.903330).  Saving model ...
Epoch: 3 cost time: 1.5406248569488525
Epoch: 3, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.443 Vali Acc: 0.917 Test Loss: 0.443 Test Acc: 0.917
Validation loss decreased (-0.903330 --> -0.916662).  Saving model ...
Epoch: 4 cost time: 1.5402345657348633
Epoch: 4, Steps: 18 | Train Loss: 0.305 Vali Loss: 0.523 Vali Acc: 0.880 Test Loss: 0.523 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5169343948364258
Epoch: 5, Steps: 18 | Train Loss: 0.065 Vali Loss: 1.047 Vali Acc: 0.880 Test Loss: 1.047 Test Acc: 0.880
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4043669700622559
Epoch: 6, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.667 Vali Acc: 0.917 Test Loss: 0.667 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.608752727508545
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.462 Vali Acc: 0.947 Test Loss: 0.462 Test Acc: 0.947
Validation loss decreased (-0.916662 --> -0.946662).  Saving model ...
Epoch: 8 cost time: 1.5976223945617676
Epoch: 8, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.479 Vali Acc: 0.930 Test Loss: 0.479 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6112186908721924
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.635 Vali Acc: 0.917 Test Loss: 0.635 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4196009635925293
Epoch: 10, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.518 Vali Acc: 0.943 Test Loss: 0.518 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5720500946044922
Epoch: 11, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.979 Vali Acc: 0.900 Test Loss: 0.979 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4451954364776611
Epoch: 12, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.860 Vali Acc: 0.917 Test Loss: 0.860 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4642341136932373
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 1.143 Vali Acc: 0.917 Test Loss: 1.143 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.570427656173706
Epoch: 14, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.191 Vali Acc: 0.893 Test Loss: 1.191 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.456331491470337
Epoch: 15, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.093 Vali Acc: 0.907 Test Loss: 1.093 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.508129596710205
Epoch: 16, Steps: 18 | Train Loss: 0.044 Vali Loss: 1.284 Vali Acc: 0.900 Test Loss: 1.284 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5682003498077393
Epoch: 17, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.257 Vali Acc: 0.907 Test Loss: 1.257 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9466666666666667
model parameter : 2173977
model size : 10.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8325376510620117
Epoch: 1, Steps: 18 | Train Loss: 2.579 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
Validation loss decreased (inf --> -0.849992).  Saving model ...
Epoch: 2 cost time: 1.3402695655822754
Epoch: 2, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
Validation loss decreased (-0.849992 --> -0.936664).  Saving model ...
Epoch: 3 cost time: 1.2629244327545166
Epoch: 3, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
Validation loss decreased (-0.936664 --> -0.949998).  Saving model ...
Epoch: 4 cost time: 1.3945765495300293
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (-0.949998 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.2700457572937012
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3757717609405518
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.1380255222320557
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.429067850112915
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.2391817569732666
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.2398052215576172
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.22511625289917
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.325679063796997
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2166638374328613
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.289283037185669
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3304579257965088
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.335531234741211
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3081114292144775
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2773370742797852
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3339180946350098
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1137689
model size : 6.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5257513523101807
Epoch: 1, Steps: 18 | Train Loss: 2.746 Vali Loss: 1.166 Vali Acc: 0.857 Test Loss: 1.166 Test Acc: 0.857
Validation loss decreased (inf --> -0.856655).  Saving model ...
Epoch: 2 cost time: 1.2490503787994385
Epoch: 2, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.236 Vali Acc: 0.947 Test Loss: 0.236 Test Acc: 0.947
Validation loss decreased (-0.856655 --> -0.946664).  Saving model ...
Epoch: 3 cost time: 1.0060768127441406
Epoch: 3, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.946664 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 1.180041790008545
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.038672924041748
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1201698780059814
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.200632095336914
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.097860336303711
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0803184509277344
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0907504558563232
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1245670318603516
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0135457515716553
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0863237380981445
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 792473
model size : 5.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4817516803741455
Epoch: 1, Steps: 18 | Train Loss: 2.804 Vali Loss: 1.504 Vali Acc: 0.840 Test Loss: 1.504 Test Acc: 0.840
Validation loss decreased (inf --> -0.839985).  Saving model ...
Epoch: 2 cost time: 1.1054439544677734
Epoch: 2, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.839985 --> -0.899996).  Saving model ...
Epoch: 3 cost time: 0.9395337104797363
Epoch: 3, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
Validation loss decreased (-0.899996 --> -0.953332).  Saving model ...
Epoch: 4 cost time: 1.1249382495880127
Epoch: 4, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.953332 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.8794705867767334
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.963 Test Loss: 0.107 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1376433372497559
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.9367985725402832
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9730701446533203
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8021266460418701
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.8410065174102783
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8698098659515381
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.874453067779541
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0410373210906982
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0660345554351807
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9978146553039551
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.980614423751831
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.040738821029663
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9672183990478516
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.130263328552246
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0979020595550537
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9507920742034912
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.948972225189209
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9253344535827637
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.098097324371338
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 620185
model size : 4.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6466856002807617
Epoch: 1, Steps: 18 | Train Loss: 2.968 Vali Loss: 1.799 Vali Acc: 0.797 Test Loss: 1.799 Test Acc: 0.797
Validation loss decreased (inf --> -0.796649).  Saving model ...
Epoch: 2 cost time: 1.0313634872436523
Epoch: 2, Steps: 18 | Train Loss: 0.951 Vali Loss: 0.370 Vali Acc: 0.943 Test Loss: 0.370 Test Acc: 0.943
Validation loss decreased (-0.796649 --> -0.943330).  Saving model ...
Epoch: 3 cost time: 0.9537532329559326
Epoch: 3, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.943330 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.1516461372375488
Epoch: 4, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0363788604736328
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0256447792053223
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.0664093494415283
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.118485450744629
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.0508148670196533
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.0237016677856445
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1562821865081787
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.983057975769043
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.1749324798583984
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.9840950965881348
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.027205228805542
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9164087772369385
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.9848887920379639
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0103423595428467
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9945504665374756
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1377785205841064
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1986606121063232
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1329703330993652
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.10221529006958
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1339366436004639
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.0908596515655518
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1229579448699951
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1935734748840332
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.1441595554351807
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.1449472904205322
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.109811544418335
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.229809045791626
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1652805805206299
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0954232215881348
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1835200786590576
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0571117401123047
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0487804412841797
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.026524305343628
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1455748081207275
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 477081
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.685497999191284
Epoch: 1, Steps: 18 | Train Loss: 3.084 Vali Loss: 2.166 Vali Acc: 0.603 Test Loss: 2.166 Test Acc: 0.603
Validation loss decreased (inf --> -0.603312).  Saving model ...
Epoch: 2 cost time: 1.3118770122528076
Epoch: 2, Steps: 18 | Train Loss: 1.328 Vali Loss: 0.602 Vali Acc: 0.953 Test Loss: 0.602 Test Acc: 0.953
Validation loss decreased (-0.603312 --> -0.953327).  Saving model ...
Epoch: 3 cost time: 1.2924823760986328
Epoch: 3, Steps: 18 | Train Loss: 0.358 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
Validation loss decreased (-0.953327 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.3155529499053955
Epoch: 4, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.1090855598449707
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3559753894805908
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.3729677200317383
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3628392219543457
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.347048282623291
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3747994899749756
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4051616191864014
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2803022861480713
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3613700866699219
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3330903053283691
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.336141586303711
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.2530667781829834
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3349246978759766
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.43524169921875
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.392143726348877
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3307969570159912
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3066966533660889
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2572450637817383
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3327696323394775
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2578909397125244
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.2559840679168701
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4232454299926758
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 1.367361068725586
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.3835937976837158
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.4735338687896729
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2859458923339844
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3473351001739502
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2626030445098877
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2157680988311768
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.3194916248321533
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.359337568283081
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3740570545196533
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.336336612701416
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 1.3860180377960205
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.3939235210418701
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 1.2358317375183105
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 1.2457795143127441
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 1.2718031406402588
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2971422672271729
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2937712669372559
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4043867588043213
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 1.3688154220581055
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.3669302463531494
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 1.294942855834961
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.352302074432373
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2539913654327393
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.2917776107788086
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 1.48350191116333
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 1.2503952980041504
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1653454303741455
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.3811023235321045
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.3443880081176758
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.3839364051818848
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.3964662551879883
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.0921893119812012
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.2972362041473389
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.3973829746246338
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.3101017475128174
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 362777
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.609752655029297
Epoch: 1, Steps: 18 | Train Loss: 2.998 Vali Loss: 2.111 Vali Acc: 0.693 Test Loss: 2.111 Test Acc: 0.693
Validation loss decreased (inf --> -0.693312).  Saving model ...
Epoch: 2 cost time: 1.2320446968078613
Epoch: 2, Steps: 18 | Train Loss: 1.359 Vali Loss: 0.598 Vali Acc: 0.960 Test Loss: 0.598 Test Acc: 0.960
Validation loss decreased (-0.693312 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 1.2256968021392822
Epoch: 3, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
Validation loss decreased (-0.959994 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.1891462802886963
Epoch: 4, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.3099191188812256
Epoch: 5, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.19793701171875
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.371948480606079
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.3444170951843262
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.336341381072998
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.3126413822174072
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.33565354347229
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.3239569664001465
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.3802978992462158
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.2577855587005615
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.2839210033416748
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.2364404201507568
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3216526508331299
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1503002643585205
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.2971243858337402
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.3534996509552002
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0084319114685059
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.1439025402069092
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0505671501159668
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1847975254058838
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.145658016204834
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.243506908416748
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.2467985153198242
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.2152645587921143
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.374704122543335
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.268399715423584
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.2442114353179932
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.113447904586792
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2269599437713623
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1038734912872314
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.162109136581421
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.182544469833374
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.3334355354309082
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.2358405590057373
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2406957149505615
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.215576171875
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.2220497131347656
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.033216953277588
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0644638538360596
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.070955753326416
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.199199914932251
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.2418830394744873
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.3542723655700684
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2631266117095947
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.253619909286499
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1470685005187988
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 1.1288013458251953
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.147665023803711
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 0.8225643634796143
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0926640033721924
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.2957816123962402
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.263213872909546
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.2092270851135254
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.2567970752716064
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9140090942382812
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.208508014678955
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.1664752960205078
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.1696596145629883
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 1.1887757778167725
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 1.230907678604126
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.173151969909668
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.2554662227630615
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.2045934200286865
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 1.2126739025115967
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.0855302810668945
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.1087305545806885
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.0644426345825195
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 1.153083324432373
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.1922328472137451
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.1976754665374756
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.1799430847167969
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.204310417175293
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.1681668758392334
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 334873
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9577407836914062
Epoch: 1, Steps: 18 | Train Loss: 2.034 Vali Loss: 0.498 Vali Acc: 0.880 Test Loss: 0.498 Test Acc: 0.880
Validation loss decreased (inf --> -0.879995).  Saving model ...
Epoch: 2 cost time: 1.553696870803833
Epoch: 2, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.879995 --> -0.933331).  Saving model ...
Epoch: 3 cost time: 1.616044282913208
Epoch: 3, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.552879810333252
Epoch: 4, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.547 Vali Acc: 0.903 Test Loss: 0.547 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0227563381195068
Epoch: 5, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6095829010009766
Epoch: 6, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.277 Vali Acc: 0.940 Test Loss: 0.277 Test Acc: 0.940
Validation loss decreased (-0.933331 --> -0.939997).  Saving model ...
Epoch: 7 cost time: 1.5771055221557617
Epoch: 7, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.473 Vali Acc: 0.933 Test Loss: 0.473 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4943382740020752
Epoch: 8, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.619 Vali Acc: 0.937 Test Loss: 0.619 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5558559894561768
Epoch: 9, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.575 Vali Acc: 0.940 Test Loss: 0.575 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.735762357711792
Epoch: 10, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.945 Vali Acc: 0.867 Test Loss: 1.945 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7392165660858154
Epoch: 11, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.471 Vali Acc: 0.860 Test Loss: 1.471 Test Acc: 0.860
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6650636196136475
Epoch: 12, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.216 Vali Acc: 0.913 Test Loss: 1.216 Test Acc: 0.913
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.642435073852539
Epoch: 13, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.250 Vali Acc: 0.917 Test Loss: 1.250 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5995044708251953
Epoch: 14, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.998 Vali Acc: 0.860 Test Loss: 1.998 Test Acc: 0.860
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5157899856567383
Epoch: 15, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.901 Vali Acc: 0.927 Test Loss: 0.901 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5982379913330078
Epoch: 16, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.640 Vali Acc: 0.903 Test Loss: 1.640 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.94
model parameter : 2157529
model size : 10.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9580159187316895
Epoch: 1, Steps: 18 | Train Loss: 2.558 Vali Loss: 0.872 Vali Acc: 0.790 Test Loss: 0.872 Test Acc: 0.790
Validation loss decreased (inf --> -0.789991).  Saving model ...
Epoch: 2 cost time: 1.343184232711792
Epoch: 2, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
Validation loss decreased (-0.789991 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 1.3467490673065186
Epoch: 3, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.3383944034576416
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3795018196105957
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.956665 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.3319780826568604
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.440692663192749
Epoch: 7, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.390 Vali Acc: 0.930 Test Loss: 0.390 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4976460933685303
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4422311782836914
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.953 Test Loss: 0.224 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4357326030731201
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2659616470336914
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3715486526489258
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.957 Test Loss: 0.200 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2730021476745605
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 14 cost time: 1.3420579433441162
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 1.380347490310669
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 1.4037091732025146
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 17 cost time: 1.4292283058166504
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 18 cost time: 1.4060819149017334
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 19 cost time: 1.418224811553955
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 20 cost time: 1.491318941116333
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 1.3292715549468994
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 1.296332597732544
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 1.457803726196289
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.3273236751556396
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.6973915100097656
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.5686886310577393
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.3794212341308594
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.4618797302246094
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.4708313941955566
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.3623366355895996
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 1.3443975448608398
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.4800770282745361
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.4216663837432861
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.2578933238983154
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.414161205291748
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.5057122707366943
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.4847183227539062
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.4282989501953125
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.2868497371673584
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.3783698081970215
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.3647923469543457
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.3983395099639893
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.3808951377868652
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.5038011074066162
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.5761041641235352
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.5231873989105225
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.408923864364624
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.525346040725708
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.3872106075286865
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.3751654624938965
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 1.4441606998443604
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 1.3442802429199219
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 1.2600908279418945
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 1.5053036212921143
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 1.517218828201294
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 1.4975268840789795
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 1.4942545890808105
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 1.2532474994659424
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 1.4313468933105469
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 1.4655132293701172
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 1.3757317066192627
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 1.3463094234466553
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 1.555964708328247
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 1.5635576248168945
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 1.5197794437408447
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 1.4873969554901123
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 1.4280760288238525
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 1.2744591236114502
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 1.2802469730377197
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 1.2399494647979736
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.3743617534637451
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.3960456848144531
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.417496681213379
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.4503779411315918
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 1.1831483840942383
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 1.180544137954712
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 1.1131081581115723
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 1.1804232597351074
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 1.1298677921295166
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 1.2310552597045898
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.2604403495788574
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 1.1913230419158936
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.23583984375
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.2961468696594238
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.3021893501281738
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.289902925491333
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.233170747756958
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 1.2644140720367432
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 1.1652522087097168
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 1.1852631568908691
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 1.151663064956665
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 1.1913230419158936
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 1.1589608192443848
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.0938611030578613
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.1198978424072266
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.1878833770751953
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.1468985080718994
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 0.9996592998504639
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 1.1584148406982422
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.2026631832122803
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1121241
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.305011510848999
Epoch: 1, Steps: 18 | Train Loss: 2.775 Vali Loss: 1.202 Vali Acc: 0.893 Test Loss: 1.202 Test Acc: 0.893
Validation loss decreased (inf --> -0.893321).  Saving model ...
Epoch: 2 cost time: 1.0443668365478516
Epoch: 2, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.313 Vali Acc: 0.897 Test Loss: 0.313 Test Acc: 0.897
Validation loss decreased (-0.893321 --> -0.896664).  Saving model ...
Epoch: 3 cost time: 1.0438554286956787
Epoch: 3, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.896664 --> -0.949998).  Saving model ...
Epoch: 4 cost time: 1.075810194015503
Epoch: 4, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9998817443847656
Epoch: 5, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.949998 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.9300274848937988
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.0501601696014404
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0232946872711182
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0793883800506592
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.0788459777832031
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0878393650054932
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.043760061264038
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0625693798065186
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0538859367370605
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0637760162353516
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9930808544158936
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0779170989990234
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0447087287902832
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0784308910369873
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 776025
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5208728313446045
Epoch: 1, Steps: 18 | Train Loss: 2.811 Vali Loss: 1.448 Vali Acc: 0.797 Test Loss: 1.448 Test Acc: 0.797
Validation loss decreased (inf --> -0.796652).  Saving model ...
Epoch: 2 cost time: 1.1619179248809814
Epoch: 2, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.274 Vali Acc: 0.957 Test Loss: 0.274 Test Acc: 0.957
Validation loss decreased (-0.796652 --> -0.956664).  Saving model ...
Epoch: 3 cost time: 1.0155541896820068
Epoch: 3, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.956664 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.03947114944458
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0580408573150635
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.0103161334991455
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.0314819812774658
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.1109986305236816
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.0717251300811768
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9835827350616455
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0676558017730713
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.748089075088501
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.002016544342041
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1315572261810303
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8894736766815186
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0194132328033447
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9246611595153809
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0524733066558838
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9912605285644531
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.998626708984375
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.1343581676483154
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.149454116821289
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0442793369293213
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1466968059539795
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1723496913909912
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1494262218475342
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1370208263397217
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1860888004302979
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.155616283416748
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.171762466430664
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 603737
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.414485216140747
Epoch: 1, Steps: 18 | Train Loss: 3.025 Vali Loss: 1.821 Vali Acc: 0.803 Test Loss: 1.821 Test Acc: 0.803
Validation loss decreased (inf --> -0.803315).  Saving model ...
Epoch: 2 cost time: 1.1242427825927734
Epoch: 2, Steps: 18 | Train Loss: 1.000 Vali Loss: 0.359 Vali Acc: 0.957 Test Loss: 0.359 Test Acc: 0.957
Validation loss decreased (-0.803315 --> -0.956663).  Saving model ...
Epoch: 3 cost time: 1.0522263050079346
Epoch: 3, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.051649570465088
Epoch: 4, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.956663 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.1260557174682617
Epoch: 5, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1014082431793213
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1369285583496094
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1392242908477783
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2576782703399658
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1395409107208252
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.1259698867797852
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.271284580230713
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.0684576034545898
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.1225676536560059
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.167578935623169
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1104826927185059
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1390447616577148
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1535906791687012
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0865516662597656
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.106062650680542
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0896344184875488
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.2051448822021484
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1203663349151611
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1457347869873047
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2137682437896729
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1584217548370361
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.158259630203247
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1191513538360596
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1646053791046143
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1770522594451904
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2019896507263184
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 460633
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.51537823677063
Epoch: 1, Steps: 18 | Train Loss: 3.063 Vali Loss: 2.045 Vali Acc: 0.703 Test Loss: 2.045 Test Acc: 0.703
Validation loss decreased (inf --> -0.703313).  Saving model ...
Epoch: 2 cost time: 1.076195478439331
Epoch: 2, Steps: 18 | Train Loss: 1.236 Vali Loss: 0.547 Vali Acc: 0.947 Test Loss: 0.547 Test Acc: 0.947
Validation loss decreased (-0.703313 --> -0.946661).  Saving model ...
Epoch: 3 cost time: 1.1401071548461914
Epoch: 3, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
Validation loss decreased (-0.946661 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.1653122901916504
Epoch: 4, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.0615923404693604
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.0693693161010742
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1197998523712158
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.1400198936462402
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.164224624633789
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1214790344238281
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.135746955871582
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.202315330505371
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2203080654144287
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1003515720367432
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1047396659851074
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1580109596252441
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1116058826446533
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1792805194854736
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.194124460220337
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.074375867843628
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.056523323059082
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 346329
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3446204662323
Epoch: 1, Steps: 18 | Train Loss: 3.001 Vali Loss: 2.098 Vali Acc: 0.657 Test Loss: 2.098 Test Acc: 0.657
Validation loss decreased (inf --> -0.656646).  Saving model ...
Epoch: 2 cost time: 1.0470185279846191
Epoch: 2, Steps: 18 | Train Loss: 1.386 Vali Loss: 0.621 Vali Acc: 0.943 Test Loss: 0.621 Test Acc: 0.943
Validation loss decreased (-0.656646 --> -0.943327).  Saving model ...
Epoch: 3 cost time: 1.064852237701416
Epoch: 3, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.218 Vali Acc: 0.963 Test Loss: 0.218 Test Acc: 0.963
Validation loss decreased (-0.943327 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.1028313636779785
Epoch: 4, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.0854671001434326
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.0596086978912354
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1198246479034424
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.0523741245269775
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1661326885223389
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.100337266921997
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0579962730407715
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.0999629497528076
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1143736839294434
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.100795030593872
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0475337505340576
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0146968364715576
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0700962543487549
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1151721477508545
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 1.0550761222839355
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0330686569213867
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1191954612731934
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 1.048335313796997
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.1617236137390137
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.0327274799346924
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 0.7183940410614014
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 0.9962334632873535
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 0.9604291915893555
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 0.9154226779937744
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.0195043087005615
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.0705757141113281
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0603010654449463
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0140669345855713
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 0.9952762126922607
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 1.0396604537963867
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0154240131378174
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0264437198638916
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9404640197753906
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9692668914794922
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 0.9927442073822021
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.028747320175171
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9526050090789795
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 0.9593157768249512
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 1.0206458568572998
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 0.8955976963043213
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 0.9246048927307129
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9539344310760498
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.0638668537139893
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 0.971599817276001
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 1.007856845855713
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9442200660705566
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9334719181060791
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0035395622253418
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 0.9734742641448975
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 0.9546387195587158
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 1.0335328578948975
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0134308338165283
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0268983840942383
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9481770992279053
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 1.0681040287017822
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1013977527618408
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9086663722991943
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.9845461845397949
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 0.9767229557037354
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.0442516803741455
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 1.038588523864746
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 1.0101780891418457
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 1.012800693511963
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9890594482421875
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 1.0047802925109863
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 1.0822656154632568
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.0101423263549805
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 72 cost time: 0.9707539081573486
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.943267822265625
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.1432185173034668
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.9462120532989502
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.9221696853637695
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 1.0173122882843018
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.9811134338378906
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 1.0187947750091553
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.0101876258850098
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.9691555500030518
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm128_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 318425
model size : 3.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5545296669006348
Epoch: 1, Steps: 18 | Train Loss: 2.587 Vali Loss: 0.788 Vali Acc: 0.880 Test Loss: 0.788 Test Acc: 0.880
Validation loss decreased (inf --> -0.879992).  Saving model ...
Epoch: 2 cost time: 1.3305232524871826
Epoch: 2, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.220 Vali Acc: 0.923 Test Loss: 0.220 Test Acc: 0.923
Validation loss decreased (-0.879992 --> -0.923331).  Saving model ...
Epoch: 3 cost time: 1.329094648361206
Epoch: 3, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.923331 --> -0.949998).  Saving model ...
Epoch: 4 cost time: 1.1844825744628906
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.953 Test Loss: 0.158 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953332).  Saving model ...
Epoch: 5 cost time: 1.2944023609161377
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2577908039093018
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 1.2276439666748047
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.963332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.3183903694152832
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3257396221160889
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.3027324676513672
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.2885544300079346
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.3016653060913086
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.3158583641052246
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.2974748611450195
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2818031311035156
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2836217880249023
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.2737882137298584
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2899010181427002
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3448035717010498
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2558319568634033
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3238730430603027
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3756368160247803
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2460658550262451
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2940990924835205
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2987170219421387
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2945616245269775
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1087193
model size : 5.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4917819499969482
Epoch: 1, Steps: 18 | Train Loss: 2.777 Vali Loss: 1.446 Vali Acc: 0.837 Test Loss: 1.446 Test Acc: 0.837
Validation loss decreased (inf --> -0.836652).  Saving model ...
Epoch: 2 cost time: 1.1884121894836426
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.267 Vali Acc: 0.960 Test Loss: 0.267 Test Acc: 0.960
Validation loss decreased (-0.836652 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 1.1692547798156738
Epoch: 3, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.149465560913086
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.2232937812805176
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.163320779800415
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1489017009735107
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.162121057510376
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2129018306732178
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0912446975708008
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1707744598388672
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2307229042053223
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.1660895347595215
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.1469736099243164
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.151890516281128
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.130730390548706
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.1522600650787354
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1391541957855225
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.115049123764038
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1260008811950684
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1643240451812744
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1561048030853271
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1638691425323486
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2015902996063232
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.171703815460205
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.188283920288086
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 569049
model size : 3.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5746686458587646
Epoch: 1, Steps: 18 | Train Loss: 3.087 Vali Loss: 2.029 Vali Acc: 0.717 Test Loss: 2.029 Test Acc: 0.717
Validation loss decreased (inf --> -0.716646).  Saving model ...
Epoch: 2 cost time: 1.1254961490631104
Epoch: 2, Steps: 18 | Train Loss: 1.146 Vali Loss: 0.483 Vali Acc: 0.927 Test Loss: 0.483 Test Acc: 0.927
Validation loss decreased (-0.716646 --> -0.926662).  Saving model ...
Epoch: 3 cost time: 1.1330444812774658
Epoch: 3, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
Validation loss decreased (-0.926662 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.1641829013824463
Epoch: 4, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.2547266483306885
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1048963069915771
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.12845778465271
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1079518795013428
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.07899808883667
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0901637077331543
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1093053817749023
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.1688079833984375
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1065576076507568
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0799181461334229
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1047520637512207
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.1000697612762451
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.157630443572998
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.2054054737091064
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.1422817707061768
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1707022190093994
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.170032262802124
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0817651748657227
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0824129581451416
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1378393173217773
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0991201400756836
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0992393493652344
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0815603733062744
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2075309753417969
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 396441
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5074312686920166
Epoch: 1, Steps: 18 | Train Loss: 3.027 Vali Loss: 2.309 Vali Acc: 0.563 Test Loss: 2.309 Test Acc: 0.563
Validation loss decreased (inf --> -0.563310).  Saving model ...
Epoch: 2 cost time: 1.1802864074707031
Epoch: 2, Steps: 18 | Train Loss: 1.553 Vali Loss: 0.776 Vali Acc: 0.930 Test Loss: 0.776 Test Acc: 0.930
Validation loss decreased (-0.563310 --> -0.929992).  Saving model ...
Epoch: 3 cost time: 1.1233923435211182
Epoch: 3, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.270 Vali Acc: 0.943 Test Loss: 0.270 Test Acc: 0.943
Validation loss decreased (-0.929992 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 1.1695334911346436
Epoch: 4, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
Validation loss decreased (-0.943331 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.1622447967529297
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.0461559295654297
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1286752223968506
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0867483615875244
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.051919937133789
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.066861629486084
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.0246357917785645
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9468786716461182
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.0450549125671387
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.9996066093444824
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9729795455932617
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0412883758544922
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9986646175384521
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.009009838104248
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0163147449493408
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.1102817058563232
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.9425230026245117
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.208336353302002
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0387191772460938
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0499062538146973
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0957026481628418
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0834674835205078
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0607280731201172
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9747509956359863
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.0931892395019531
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0480186939239502
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.072798490524292
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.114569902420044
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0459537506103516
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9643251895904541
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1390440464019775
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9165711402893066
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0438363552093506
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1594278812408447
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 310297
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2466728687286377
Epoch: 1, Steps: 18 | Train Loss: 3.107 Vali Loss: 2.430 Vali Acc: 0.540 Test Loss: 2.430 Test Acc: 0.540
Validation loss decreased (inf --> -0.539976).  Saving model ...
Epoch: 2 cost time: 0.743520975112915
Epoch: 2, Steps: 18 | Train Loss: 1.746 Vali Loss: 1.004 Vali Acc: 0.887 Test Loss: 1.004 Test Acc: 0.887
Validation loss decreased (-0.539976 --> -0.886657).  Saving model ...
Epoch: 3 cost time: 0.7556319236755371
Epoch: 3, Steps: 18 | Train Loss: 0.592 Vali Loss: 0.334 Vali Acc: 0.963 Test Loss: 0.334 Test Acc: 0.963
Validation loss decreased (-0.886657 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 0.735889196395874
Epoch: 4, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.8145010471343994
Epoch: 5, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.7252089977264404
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 0.7499716281890869
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7998230457305908
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7720592021942139
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7519240379333496
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 0.8253397941589355
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 0.8189554214477539
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8451759815216064
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.8839852809906006
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.6773326396942139
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8387527465820312
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.7395312786102295
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6958320140838623
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6917004585266113
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 0.7086396217346191
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.7153801918029785
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.8041017055511475
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 0.767824649810791
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.8149912357330322
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 0.7372500896453857
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 0.7898726463317871
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 0.7653694152832031
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 0.7808213233947754
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 0.7774631977081299
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 0.8077774047851562
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 0.8035237789154053
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 0.8777356147766113
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 0.9265584945678711
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8451621532440186
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8562803268432617
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8503997325897217
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8627443313598633
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 0.8795626163482666
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 0.9047584533691406
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.8086395263671875
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 0.8033542633056641
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 0.7990086078643799
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8374512195587158
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.857623815536499
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 0.8263125419616699
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 0.8613171577453613
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8912448883056641
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8227503299713135
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 0.8723766803741455
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8857743740081787
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8096828460693359
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8518080711364746
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7756288051605225
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 0.82651686668396
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8159129619598389
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.801034688949585
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7725307941436768
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 0.8416895866394043
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8498818874359131
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.877727746963501
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 0.8543577194213867
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 0.8542914390563965
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 0.8123588562011719
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8035063743591309
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7783210277557373
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 0.8372752666473389
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 0.7221477031707764
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 0.7280793190002441
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8002762794494629
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.8041448593139648
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7718710899353027
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.7723798751831055
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.8634700775146484
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.7860732078552246
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.8737943172454834
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.7519576549530029
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 0.8066976070404053
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 0.7997734546661377
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7691771984100342
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 0.8222033977508545
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 0.8567836284637451
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 0.8163280487060547
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8487966060638428
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.7955949306488037
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.8370118141174316
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.7930936813354492
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 87 cost time: 0.7724306583404541
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 0.8167996406555176
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.8251843452453613
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.8075551986694336
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.8196609020233154
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.799436092376709
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 93 cost time: 0.7976939678192139
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 0.8119232654571533
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 95 cost time: 0.8088951110839844
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 0.7832896709442139
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.8216712474822998
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.7719073295593262
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.8785772323608398
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 0.8837685585021973
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 238745
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2533786296844482
Epoch: 1, Steps: 18 | Train Loss: 3.159 Vali Loss: 2.631 Vali Acc: 0.423 Test Loss: 2.631 Test Acc: 0.423
Validation loss decreased (inf --> -0.423307).  Saving model ...
Epoch: 2 cost time: 0.7917370796203613
Epoch: 2, Steps: 18 | Train Loss: 2.135 Vali Loss: 1.414 Vali Acc: 0.870 Test Loss: 1.414 Test Acc: 0.870
Validation loss decreased (-0.423307 --> -0.869986).  Saving model ...
Epoch: 3 cost time: 0.7764320373535156
Epoch: 3, Steps: 18 | Train Loss: 1.005 Vali Loss: 0.575 Vali Acc: 0.957 Test Loss: 0.575 Test Acc: 0.957
Validation loss decreased (-0.869986 --> -0.956661).  Saving model ...
Epoch: 4 cost time: 0.8696718215942383
Epoch: 4, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.251 Vali Acc: 0.970 Test Loss: 0.251 Test Acc: 0.970
Validation loss decreased (-0.956661 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 0.7726655006408691
Epoch: 5, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.8266668319702148
Epoch: 6, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8058133125305176
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.8216805458068848
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.7513015270233154
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7998793125152588
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8360588550567627
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7647988796234131
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7584359645843506
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8284904956817627
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.753901481628418
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8094120025634766
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7610979080200195
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7964627742767334
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7944238185882568
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.842339277267456
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.819373607635498
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8525242805480957
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7586970329284668
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7768502235412598
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7688229084014893
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.769005298614502
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7636997699737549
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.774364709854126
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.775780200958252
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.7975103855133057
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7899401187896729
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.8312499523162842
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.85209059715271
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8359448909759521
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.8156342506408691
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7767515182495117
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.7904999256134033
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8351638317108154
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.761716365814209
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8746116161346436
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7904715538024902
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7675411701202393
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7699637413024902
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7199902534484863
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8046057224273682
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7923943996429443
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7747576236724854
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7949628829956055
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7382526397705078
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8199491500854492
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8769245147705078
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.7633528709411621
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7893567085266113
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7899289131164551
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.76239013671875
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.7330288887023926
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8670773506164551
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7957360744476318
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.8175251483917236
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7808704376220703
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.767970085144043
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.7778687477111816
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.7335691452026367
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.7358534336090088
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.7428348064422607
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 181593
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.299635171890259
Epoch: 1, Steps: 18 | Train Loss: 3.286 Vali Loss: 2.702 Vali Acc: 0.367 Test Loss: 2.702 Test Acc: 0.367
Validation loss decreased (inf --> -0.366640).  Saving model ...
Epoch: 2 cost time: 0.8029398918151855
Epoch: 2, Steps: 18 | Train Loss: 2.189 Vali Loss: 1.447 Vali Acc: 0.850 Test Loss: 1.447 Test Acc: 0.850
Validation loss decreased (-0.366640 --> -0.849986).  Saving model ...
Epoch: 3 cost time: 0.7902469635009766
Epoch: 3, Steps: 18 | Train Loss: 1.022 Vali Loss: 0.586 Vali Acc: 0.950 Test Loss: 0.586 Test Acc: 0.950
Validation loss decreased (-0.849986 --> -0.949994).  Saving model ...
Epoch: 4 cost time: 0.8421919345855713
Epoch: 4, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.265 Vali Acc: 0.963 Test Loss: 0.265 Test Acc: 0.963
Validation loss decreased (-0.949994 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 0.9033558368682861
Epoch: 5, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.8118314743041992
Epoch: 6, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.6734452247619629
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8260643482208252
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7870752811431885
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8701725006103516
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8611509799957275
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8333544731140137
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7720503807067871
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8711209297180176
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7655746936798096
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7537164688110352
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7821056842803955
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7516295909881592
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.87325119972229
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9393837451934814
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8150045871734619
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8702120780944824
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.789177656173706
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8343307971954346
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8435161113739014
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7703464031219482
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7719922065734863
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7810490131378174
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8023386001586914
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.7477176189422607
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7718777656555176
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7774577140808105
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.8099269866943359
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7258777618408203
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.8095247745513916
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7971508502960205
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.7452807426452637
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8002157211303711
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7794570922851562
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.7224640846252441
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7115967273712158
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7298836708068848
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.734238862991333
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.7538838386535645
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.8695943355560303
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.8600423336029053
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.9683818817138672
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8524127006530762
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.8696167469024658
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.8522098064422607
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8376061916351318
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.8055539131164551
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.8241591453552246
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.786198616027832
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 0.8407924175262451
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7458007335662842
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 0.7755882740020752
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 0.8489165306091309
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 0.7956407070159912
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 0.8947434425354004
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.879410982131958
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 0.8279426097869873
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8593919277191162
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 0.8938531875610352
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 0.8572077751159668
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.752239465713501
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 0.7724602222442627
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7705786228179932
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8295347690582275
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6299984455108643
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.7346029281616211
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6397325992584229
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 0.6065559387207031
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 0.6686828136444092
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7068281173706055
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.6527566909790039
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.6819610595703125
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 78 cost time: 0.7049283981323242
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 0.6596949100494385
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.6978645324707031
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.6210775375366211
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.6529300212860107
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.7750120162963867
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.7856647968292236
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.8090832233428955
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.8453702926635742
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 87 cost time: 0.9058232307434082
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8360490798950195
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.7730751037597656
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.8600454330444336
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.8231067657470703
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 92 cost time: 0.7729990482330322
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.7630147933959961
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.8250908851623535
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 95 cost time: 0.9353477954864502
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.8565552234649658
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 97 cost time: 0.9074814319610596
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 98 cost time: 0.7846658229827881
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.830568790435791
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.7539746761322021
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 167641
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6883978843688965
Epoch: 1, Steps: 18 | Train Loss: 2.424 Vali Loss: 0.743 Vali Acc: 0.867 Test Loss: 0.743 Test Acc: 0.867
Validation loss decreased (inf --> -0.866659).  Saving model ...
Epoch: 2 cost time: 1.1538970470428467
Epoch: 2, Steps: 18 | Train Loss: 0.247 Vali Loss: 0.293 Vali Acc: 0.897 Test Loss: 0.293 Test Acc: 0.897
Validation loss decreased (-0.866659 --> -0.896664).  Saving model ...
Epoch: 3 cost time: 1.1373255252838135
Epoch: 3, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
Validation loss decreased (-0.896664 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 1.1382112503051758
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.947 Test Loss: 0.209 Test Acc: 0.947
Validation loss decreased (-0.943331 --> -0.946665).  Saving model ...
Epoch: 5 cost time: 1.18556809425354
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.946665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.1556971073150635
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.19437575340271
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1806879043579102
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.188307285308838
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.0914921760559082
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.1214039325714111
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.165900468826294
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1483154296875
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0835552215576172
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.126335620880127
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1333391666412354
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.134136438369751
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.2446417808532715
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1494288444519043
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2031569480895996
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2646348476409912
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0908188819885254
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0976693630218506
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0532875061035156
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.036010980606079
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0620338916778564
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2176933288574219
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1813886165618896
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1895687580108643
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.216416358947754
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2131593227386475
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1082639694213867
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1580641269683838
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.173717975616455
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1070681
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6507456302642822
Epoch: 1, Steps: 18 | Train Loss: 2.858 Vali Loss: 1.542 Vali Acc: 0.747 Test Loss: 1.542 Test Acc: 0.747
Validation loss decreased (inf --> -0.746651).  Saving model ...
Epoch: 2 cost time: 1.145951271057129
Epoch: 2, Steps: 18 | Train Loss: 0.736 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
Validation loss decreased (-0.746651 --> -0.933330).  Saving model ...
Epoch: 3 cost time: 1.1652445793151855
Epoch: 3, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.197 Vali Acc: 0.947 Test Loss: 0.197 Test Acc: 0.947
Validation loss decreased (-0.933330 --> -0.946665).  Saving model ...
Epoch: 4 cost time: 1.095482349395752
Epoch: 4, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.946665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.1200213432312012
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.092041254043579
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.107982873916626
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.100405216217041
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.064500331878662
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.0377609729766846
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.0762794017791748
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.1021254062652588
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.12496018409729
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1411559581756592
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1461422443389893
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1351830959320068
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1165618896484375
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0657315254211426
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1154403686523438
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0969810485839844
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1967945098876953
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 552537
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.420642137527466
Epoch: 1, Steps: 18 | Train Loss: 2.958 Vali Loss: 1.907 Vali Acc: 0.773 Test Loss: 1.907 Test Acc: 0.773
Validation loss decreased (inf --> -0.773314).  Saving model ...
Epoch: 2 cost time: 0.9504735469818115
Epoch: 2, Steps: 18 | Train Loss: 1.134 Vali Loss: 0.490 Vali Acc: 0.943 Test Loss: 0.490 Test Acc: 0.943
Validation loss decreased (-0.773314 --> -0.943328).  Saving model ...
Epoch: 3 cost time: 0.9410219192504883
Epoch: 3, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.943328 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.056218147277832
Epoch: 4, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.9910457134246826
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 0.9833621978759766
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.9392223358154297
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9187479019165039
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.9219529628753662
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9763827323913574
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9242477416992188
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.874478816986084
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9559800624847412
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8873372077941895
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9745991230010986
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0480730533599854
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9277510643005371
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8706550598144531
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.9929647445678711
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.9521334171295166
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0216469764709473
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0053422451019287
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8498015403747559
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9220075607299805
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0607759952545166
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9980778694152832
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9969956874847412
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0341424942016602
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9904119968414307
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9057023525238037
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9497439861297607
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8462831974029541
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9021954536437988
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0959484577178955
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.040940284729004
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 379929
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4161429405212402
Epoch: 1, Steps: 18 | Train Loss: 3.094 Vali Loss: 2.273 Vali Acc: 0.670 Test Loss: 2.273 Test Acc: 0.670
Validation loss decreased (inf --> -0.669977).  Saving model ...
Epoch: 2 cost time: 1.0252394676208496
Epoch: 2, Steps: 18 | Train Loss: 1.506 Vali Loss: 0.748 Vali Acc: 0.923 Test Loss: 0.748 Test Acc: 0.923
Validation loss decreased (-0.669977 --> -0.923326).  Saving model ...
Epoch: 3 cost time: 0.9171843528747559
Epoch: 3, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.923326 --> -0.949997).  Saving model ...
Epoch: 4 cost time: 1.0282695293426514
Epoch: 4, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.949997 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.9192514419555664
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8187596797943115
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8525736331939697
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.016444206237793
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9722893238067627
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7678766250610352
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0634572505950928
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1296613216400146
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.031724214553833
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0501041412353516
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0962483882904053
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.181459903717041
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1085002422332764
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0609896183013916
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0548086166381836
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.042576551437378
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.1202945709228516
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0493614673614502
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1187052726745605
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.1716673374176025
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1392455101013184
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1519792079925537
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1416821479797363
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0731518268585205
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.160557746887207
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1303613185882568
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1772117614746094
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.09804368019104
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1074669361114502
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.112138271331787
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9753134250640869
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1420872211456299
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.155998706817627
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1518125534057617
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1981539726257324
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1284987926483154
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.125330924987793
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.0712707042694092
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.133551836013794
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.0727293491363525
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.1065597534179688
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.13309645652771
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0876374244689941
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.139301061630249
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0731661319732666
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0804533958435059
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1592254638671875
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0079755783081055
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0637235641479492
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 1.1331875324249268
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.189314365386963
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0648303031921387
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1508591175079346
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1935982704162598
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.1564440727233887
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.2102932929992676
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.1019279956817627
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.2364773750305176
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.080399751663208
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.1032633781433105
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 293785
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2032060623168945
Epoch: 1, Steps: 18 | Train Loss: 3.079 Vali Loss: 2.391 Vali Acc: 0.500 Test Loss: 2.391 Test Acc: 0.500
Validation loss decreased (inf --> -0.499976).  Saving model ...
Epoch: 2 cost time: 0.8194320201873779
Epoch: 2, Steps: 18 | Train Loss: 1.771 Vali Loss: 0.978 Vali Acc: 0.907 Test Loss: 0.978 Test Acc: 0.907
Validation loss decreased (-0.499976 --> -0.906657).  Saving model ...
Epoch: 3 cost time: 0.8060364723205566
Epoch: 3, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
Validation loss decreased (-0.906657 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 0.7793765068054199
Epoch: 4, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.7624006271362305
Epoch: 5, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.823052167892456
Epoch: 6, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.7880024909973145
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.8411242961883545
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8706936836242676
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8149101734161377
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8269457817077637
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8276877403259277
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.793248176574707
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7999346256256104
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8918282985687256
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8061695098876953
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8468608856201172
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7840440273284912
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7887461185455322
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7873871326446533
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8538453578948975
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7912933826446533
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8686063289642334
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8198893070220947
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8635833263397217
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.801724910736084
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7770264148712158
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8148727416992188
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8749315738677979
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8029448986053467
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5993907451629639
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7669122219085693
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7981269359588623
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7728114128112793
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7521743774414062
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8137569427490234
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8098461627960205
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.780548095703125
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7840092182159424
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7966513633728027
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7828176021575928
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7671844959259033
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.770632266998291
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7848911285400391
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.783703088760376
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.7708685398101807
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7473206520080566
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8130509853363037
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.7418460845947266
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.7242388725280762
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7398126125335693
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.793705940246582
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.7756550312042236
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.7275445461273193
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7319672107696533
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.8253498077392578
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.770714521408081
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7411315441131592
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7604429721832275
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7485361099243164
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.703223705291748
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.6841719150543213
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.7880373001098633
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.771256685256958
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.8055026531219482
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.7798879146575928
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 222233
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1694490909576416
Epoch: 1, Steps: 18 | Train Loss: 3.095 Vali Loss: 2.625 Vali Acc: 0.410 Test Loss: 2.625 Test Acc: 0.410
Validation loss decreased (inf --> -0.409974).  Saving model ...
Epoch: 2 cost time: 0.7098965644836426
Epoch: 2, Steps: 18 | Train Loss: 2.095 Vali Loss: 1.422 Vali Acc: 0.880 Test Loss: 1.422 Test Acc: 0.880
Validation loss decreased (-0.409974 --> -0.879986).  Saving model ...
Epoch: 3 cost time: 0.7814748287200928
Epoch: 3, Steps: 18 | Train Loss: 1.005 Vali Loss: 0.583 Vali Acc: 0.947 Test Loss: 0.583 Test Acc: 0.947
Validation loss decreased (-0.879986 --> -0.946661).  Saving model ...
Epoch: 4 cost time: 0.7466368675231934
Epoch: 4, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.266 Vali Acc: 0.967 Test Loss: 0.266 Test Acc: 0.967
Validation loss decreased (-0.946661 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 0.8062779903411865
Epoch: 5, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.7727909088134766
Epoch: 6, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8049755096435547
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.7794303894042969
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.910402774810791
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.963 Test Loss: 0.112 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8755357265472412
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8091471195220947
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7629468441009521
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8356127738952637
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7522647380828857
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.8398327827453613
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.752314567565918
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7956066131591797
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7775778770446777
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7722864151000977
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7815349102020264
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7448263168334961
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.815847635269165
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.967 Test Loss: 0.093 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8099355697631836
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.967 Test Loss: 0.095 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7604904174804688
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7500884532928467
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8318595886230469
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7681412696838379
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8458232879638672
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.908715009689331
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8627405166625977
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7851529121398926
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8107974529266357
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7945153713226318
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8463339805603027
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8306417465209961
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8561935424804688
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8056139945983887
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7923696041107178
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.792604923248291
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8154034614562988
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 165081
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0246217250823975
Epoch: 1, Steps: 18 | Train Loss: 3.247 Vali Loss: 2.703 Vali Acc: 0.300 Test Loss: 2.703 Test Acc: 0.300
Validation loss decreased (inf --> -0.299973).  Saving model ...
Epoch: 2 cost time: 0.7997605800628662
Epoch: 2, Steps: 18 | Train Loss: 2.166 Vali Loss: 1.480 Vali Acc: 0.857 Test Loss: 1.480 Test Acc: 0.857
Validation loss decreased (-0.299973 --> -0.856652).  Saving model ...
Epoch: 3 cost time: 0.8031911849975586
Epoch: 3, Steps: 18 | Train Loss: 1.062 Vali Loss: 0.600 Vali Acc: 0.950 Test Loss: 0.600 Test Acc: 0.950
Validation loss decreased (-0.856652 --> -0.949994).  Saving model ...
Epoch: 4 cost time: 0.8263335227966309
Epoch: 4, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.275 Vali Acc: 0.960 Test Loss: 0.275 Test Acc: 0.960
Validation loss decreased (-0.949994 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 0.8628826141357422
Epoch: 5, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.7644855976104736
Epoch: 6, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.7671122550964355
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.823479413986206
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8403706550598145
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7950732707977295
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7760570049285889
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8304555416107178
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8012702465057373
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8002598285675049
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7902131080627441
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7850046157836914
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7573657035827637
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7614021301269531
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7755298614501953
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7770562171936035
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8286111354827881
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8354930877685547
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8116662502288818
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7938508987426758
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7846958637237549
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.8322267532348633
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7933320999145508
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7587311267852783
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8077104091644287
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.875981330871582
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.805811882019043
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.8042087554931641
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.817725419998169
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7574858665466309
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.7749671936035156
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.8008022308349609
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.8331007957458496
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8214681148529053
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8508284091949463
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7881312370300293
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.029637098312378
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7969558238983154
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.7791118621826172
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8060572147369385
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7811412811279297
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.8243043422698975
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.8401587009429932
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8599910736083984
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.774315357208252
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7660565376281738
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.7835245132446289
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.8072431087493896
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.7930684089660645
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 0.7992062568664551
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8307795524597168
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.82224440574646
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7760000228881836
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.8292169570922852
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.836273193359375
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9061472415924072
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.775282621383667
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 0.7730653285980225
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7635695934295654
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7979893684387207
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 0.7449233531951904
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7652833461761475
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 0.7491602897644043
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 0.8112750053405762
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 0.8329625129699707
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 0.8442196846008301
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 0.7772641181945801
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 0.9183897972106934
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 0.8548698425292969
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 0.7694692611694336
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 0.8031113147735596
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7715849876403809
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.8392813205718994
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7934145927429199
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.77659010887146
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.6952722072601318
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 0.7697899341583252
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 0.725325345993042
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 0.7875990867614746
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 84 cost time: 0.8100824356079102
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 85 cost time: 0.7380325794219971
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.8782169818878174
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.7676255702972412
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.6937053203582764
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 89 cost time: 0.8043866157531738
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 90 cost time: 0.7800922393798828
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 91 cost time: 0.7101185321807861
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 92 cost time: 0.7233340740203857
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.783886194229126
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.7448668479919434
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.7010486125946045
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.7622082233428955
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 0.846355676651001
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 0.8570399284362793
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 0.7902581691741943
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 100 cost time: 0.7362880706787109
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 151129
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.541640520095825
Epoch: 1, Steps: 18 | Train Loss: 2.552 Vali Loss: 0.793 Vali Acc: 0.890 Test Loss: 0.793 Test Acc: 0.890
Validation loss decreased (inf --> -0.889992).  Saving model ...
Epoch: 2 cost time: 1.1209123134613037
Epoch: 2, Steps: 18 | Train Loss: 0.284 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
Validation loss decreased (-0.889992 --> -0.899997).  Saving model ...
Epoch: 3 cost time: 1.3111979961395264
Epoch: 3, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
Validation loss decreased (-0.899997 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 1.173276424407959
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.403 Vali Acc: 0.883 Test Loss: 0.403 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.857893705368042
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
Validation loss decreased (-0.943331 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.4320552349090576
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3322548866271973
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.343261480331421
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.940 Test Loss: 0.228 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3225653171539307
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2880117893218994
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 1.37062668800354
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.266685962677002
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.306523084640503
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 1.424354076385498
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 1.3106727600097656
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 1.296621561050415
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 1.3550105094909668
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 1.5299456119537354
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 1.2942559719085693
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 1.3357162475585938
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.304779291152954
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.3436791896820068
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.4330697059631348
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.3822956085205078
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.4187185764312744
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.311201810836792
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.315690517425537
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.440962553024292
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3873887062072754
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3108940124511719
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3980004787445068
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.2787175178527832
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.2722277641296387
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2666292190551758
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 1.3820185661315918
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 1.3818678855895996
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 1.290736436843872
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 1.349942922592163
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 1.497542142868042
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 40 cost time: 1.5516929626464844
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3189218044281006
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 42 cost time: 1.3846957683563232
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3414390087127686
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3107974529266357
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.409754753112793
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.4084599018096924
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.3878204822540283
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3137855529785156
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3299341201782227
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4071152210235596
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.3631596565246582
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1062425
model size : 5.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.520127296447754
Epoch: 1, Steps: 18 | Train Loss: 2.919 Vali Loss: 1.513 Vali Acc: 0.860 Test Loss: 1.513 Test Acc: 0.860
Validation loss decreased (inf --> -0.859985).  Saving model ...
Epoch: 2 cost time: 1.0379772186279297
Epoch: 2, Steps: 18 | Train Loss: 0.726 Vali Loss: 0.332 Vali Acc: 0.927 Test Loss: 0.332 Test Acc: 0.927
Validation loss decreased (-0.859985 --> -0.926663).  Saving model ...
Epoch: 3 cost time: 1.0564165115356445
Epoch: 3, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.926663 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.0886321067810059
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.1022639274597168
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.969999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.1879732608795166
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1494925022125244
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.1571621894836426
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.133495807647705
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.1047298908233643
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.1218152046203613
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1010916233062744
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0852901935577393
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.076425313949585
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1988201141357422
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1258301734924316
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2252554893493652
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1324124336242676
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1435623168945312
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1759271621704102
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 544281
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.599757194519043
Epoch: 1, Steps: 18 | Train Loss: 3.095 Vali Loss: 2.066 Vali Acc: 0.640 Test Loss: 2.066 Test Acc: 0.640
Validation loss decreased (inf --> -0.639979).  Saving model ...
Epoch: 2 cost time: 1.1008450984954834
Epoch: 2, Steps: 18 | Train Loss: 1.234 Vali Loss: 0.537 Vali Acc: 0.930 Test Loss: 0.537 Test Acc: 0.930
Validation loss decreased (-0.639979 --> -0.929995).  Saving model ...
Epoch: 3 cost time: 1.0943803787231445
Epoch: 3, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
Validation loss decreased (-0.929995 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.0729823112487793
Epoch: 4, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.8863229751586914
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.8305826187133789
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.9034807682037354
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9236631393432617
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.9294795989990234
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9043538570404053
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9100215435028076
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9137935638427734
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8566741943359375
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.9687316417694092
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.960637092590332
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8935608863830566
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.9001293182373047
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.038881540298462
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9123711585998535
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9059498310089111
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7946321964263916
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9477617740631104
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8789186477661133
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8718385696411133
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9464662075042725
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9103150367736816
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 371673
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.473205804824829
Epoch: 1, Steps: 18 | Train Loss: 3.009 Vali Loss: 2.276 Vali Acc: 0.627 Test Loss: 2.276 Test Acc: 0.627
Validation loss decreased (inf --> -0.626644).  Saving model ...
Epoch: 2 cost time: 0.964876651763916
Epoch: 2, Steps: 18 | Train Loss: 1.498 Vali Loss: 0.760 Vali Acc: 0.930 Test Loss: 0.760 Test Acc: 0.930
Validation loss decreased (-0.626644 --> -0.929992).  Saving model ...
Epoch: 3 cost time: 0.9117984771728516
Epoch: 3, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.265 Vali Acc: 0.963 Test Loss: 0.265 Test Acc: 0.963
Validation loss decreased (-0.929992 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 0.8991227149963379
Epoch: 4, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9357225894927979
Epoch: 5, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.9767570495605469
Epoch: 6, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.9367983341217041
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9087889194488525
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.899785041809082
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9457306861877441
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8691971302032471
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.026702642440796
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9083607196807861
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9018032550811768
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9196367263793945
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9997985363006592
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.981482982635498
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0689494609832764
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9066498279571533
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8918843269348145
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9248580932617188
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9366164207458496
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 285529
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.197359800338745
Epoch: 1, Steps: 18 | Train Loss: 3.087 Vali Loss: 2.451 Vali Acc: 0.517 Test Loss: 2.451 Test Acc: 0.517
Validation loss decreased (inf --> -0.516642).  Saving model ...
Epoch: 2 cost time: 0.7764413356781006
Epoch: 2, Steps: 18 | Train Loss: 1.797 Vali Loss: 1.015 Vali Acc: 0.927 Test Loss: 1.015 Test Acc: 0.927
Validation loss decreased (-0.516642 --> -0.926657).  Saving model ...
Epoch: 3 cost time: 0.7496273517608643
Epoch: 3, Steps: 18 | Train Loss: 0.595 Vali Loss: 0.339 Vali Acc: 0.967 Test Loss: 0.339 Test Acc: 0.967
Validation loss decreased (-0.926657 --> -0.966663).  Saving model ...
Epoch: 4 cost time: 0.7771706581115723
Epoch: 4, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.8047475814819336
Epoch: 5, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.7952983379364014
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8123183250427246
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7622511386871338
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7818465232849121
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7737517356872559
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.804410457611084
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7917819023132324
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7612097263336182
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.8057577610015869
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7712235450744629
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7480335235595703
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.806633472442627
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7402327060699463
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7612476348876953
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7699041366577148
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8100466728210449
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7353627681732178
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.756622314453125
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7692668437957764
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7759048938751221
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.789985179901123
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8270115852355957
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8147306442260742
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8046538829803467
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7836906909942627
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7840845584869385
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7880938053131104
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8386621475219727
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7947070598602295
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.8600013256072998
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7883520126342773
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7848186492919922
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8247964382171631
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7995264530181885
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.8539628982543945
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.8256566524505615
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8003170490264893
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.851438045501709
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.8188512325286865
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8417847156524658
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.7800819873809814
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7643368244171143
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7471368312835693
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.8413124084472656
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.8536698818206787
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.8433356285095215
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7769968509674072
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7872893810272217
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.7973732948303223
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.8407466411590576
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.7731750011444092
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.8386147022247314
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.8088276386260986
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8490869998931885
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8070895671844482
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8090329170227051
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.8480710983276367
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.7939774990081787
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8143792152404785
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.8188738822937012
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.7964494228363037
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.8018674850463867
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.7853763103485107
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8029532432556152
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.7816672325134277
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7880346775054932
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.7885158061981201
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7759299278259277
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.878746509552002
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7900502681732178
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.830711841583252
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.8216204643249512
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 78 cost time: 0.8039381504058838
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.790172815322876
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 80 cost time: 0.7928152084350586
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.7985970973968506
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.8114421367645264
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.8390653133392334
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.8596110343933105
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.7141880989074707
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.7611639499664307
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 87 cost time: 0.718153715133667
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 88 cost time: 0.7532927989959717
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 89 cost time: 0.7827789783477783
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.815300703048706
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.7979300022125244
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.8240904808044434
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.8324041366577148
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.8358359336853027
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.842125415802002
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.6884951591491699
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 97 cost time: 0.7207086086273193
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.6575453281402588
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.7399752140045166
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 100 cost time: 0.800816535949707
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 213977
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2109858989715576
Epoch: 1, Steps: 18 | Train Loss: 3.269 Vali Loss: 2.732 Vali Acc: 0.323 Test Loss: 2.732 Test Acc: 0.323
Validation loss decreased (inf --> -0.323306).  Saving model ...
Epoch: 2 cost time: 0.740393877029419
Epoch: 2, Steps: 18 | Train Loss: 2.205 Vali Loss: 1.495 Vali Acc: 0.817 Test Loss: 1.495 Test Acc: 0.817
Validation loss decreased (-0.323306 --> -0.816652).  Saving model ...
Epoch: 3 cost time: 0.7160294055938721
Epoch: 3, Steps: 18 | Train Loss: 1.068 Vali Loss: 0.620 Vali Acc: 0.967 Test Loss: 0.620 Test Acc: 0.967
Validation loss decreased (-0.816652 --> -0.966660).  Saving model ...
Epoch: 4 cost time: 0.700871467590332
Epoch: 4, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.295 Vali Acc: 0.967 Test Loss: 0.295 Test Acc: 0.967
Validation loss decreased (-0.966660 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 0.6994707584381104
Epoch: 5, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.7646563053131104
Epoch: 6, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7511289119720459
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.6933798789978027
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.7284228801727295
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7304608821868896
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.728632926940918
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7374815940856934
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.804832935333252
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7796285152435303
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8061690330505371
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7550718784332275
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6546111106872559
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7376718521118164
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7935221195220947
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7536685466766357
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.814410924911499
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7251436710357666
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8032932281494141
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7551307678222656
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7173635959625244
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7447233200073242
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.6708865165710449
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7189075946807861
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7067122459411621
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7256178855895996
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7070720195770264
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7250409126281738
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8438243865966797
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8136062622070312
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7441506385803223
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7500684261322021
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7735087871551514
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7306702136993408
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7637455463409424
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.7421903610229492
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 0.7371180057525635
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 0.7385051250457764
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7473151683807373
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7969686985015869
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6595487594604492
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8075780868530273
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 0.8434855937957764
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7558963298797607
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7348372936248779
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7840304374694824
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7609095573425293
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7492280006408691
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7671751976013184
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7879774570465088
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7799661159515381
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.7707791328430176
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 0.8043806552886963
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 0.8546102046966553
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 0.8276252746582031
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 0.826439619064331
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7906911373138428
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 0.8283061981201172
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7833514213562012
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8406543731689453
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8231220245361328
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.7839412689208984
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8612973690032959
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.8855953216552734
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 0.839590311050415
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8066220283508301
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 0.790550947189331
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9053134918212891
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 0.7516286373138428
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 0.8380289077758789
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 0.7973997592926025
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 0.7684118747711182
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7796344757080078
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.7717709541320801
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.8553066253662109
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.8129167556762695
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.8354232311248779
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.791283369064331
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.74381422996521
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.7715659141540527
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.8373725414276123
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 156825
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8973720073699951
Epoch: 1, Steps: 18 | Train Loss: 3.205 Vali Loss: 2.690 Vali Acc: 0.323 Test Loss: 2.690 Test Acc: 0.323
Validation loss decreased (inf --> -0.323306).  Saving model ...
Epoch: 2 cost time: 0.7436721324920654
Epoch: 2, Steps: 18 | Train Loss: 2.144 Vali Loss: 1.487 Vali Acc: 0.843 Test Loss: 1.487 Test Acc: 0.843
Validation loss decreased (-0.323306 --> -0.843318).  Saving model ...
Epoch: 3 cost time: 0.8239638805389404
Epoch: 3, Steps: 18 | Train Loss: 1.072 Vali Loss: 0.632 Vali Acc: 0.927 Test Loss: 0.632 Test Acc: 0.927
Validation loss decreased (-0.843318 --> -0.926660).  Saving model ...
Epoch: 4 cost time: 0.7631752490997314
Epoch: 4, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.288 Vali Acc: 0.953 Test Loss: 0.288 Test Acc: 0.953
Validation loss decreased (-0.926660 --> -0.953330).  Saving model ...
Epoch: 5 cost time: 0.784416675567627
Epoch: 5, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.953330 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.7847299575805664
Epoch: 6, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.7588715553283691
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.7517838478088379
Epoch: 8, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7737693786621094
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8211467266082764
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8131375312805176
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7966415882110596
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8574762344360352
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8330609798431396
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7897770404815674
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8290214538574219
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8176040649414062
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8324193954467773
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7817971706390381
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8405201435089111
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.882136344909668
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.769782304763794
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.8109385967254639
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.87331223487854
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7846465110778809
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7833590507507324
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7228219509124756
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.8792216777801514
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8904871940612793
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.7254657745361328
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.8303735256195068
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7744195461273193
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8221211433410645
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.798295259475708
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.8077120780944824
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8192465305328369
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.8674261569976807
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8254659175872803
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8056271076202393
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7610220909118652
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7914252281188965
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7954168319702148
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.8018245697021484
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.7947299480438232
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.8026437759399414
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.8084797859191895
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7620842456817627
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8611760139465332
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.724743127822876
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7754538059234619
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7337067127227783
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.8998568058013916
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.7593045234680176
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8418223857879639
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.780656099319458
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 0.7890725135803223
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 0.736464262008667
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7914121150970459
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8027536869049072
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7655267715454102
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 0.7634725570678711
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 0.8270256519317627
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 0.8370363712310791
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 0.7904987335205078
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8801097869873047
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.7777903079986572
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.7477061748504639
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.7668030261993408
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.7350223064422607
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.7179470062255859
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.7943005561828613
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.7959761619567871
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 0.807589054107666
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 0.7757751941680908
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7695720195770264
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 0.8226757049560547
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 0.8310322761535645
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7871768474578857
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 0.7676920890808105
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 0.7279536724090576
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.7773318290710449
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 0.7519137859344482
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.7330782413482666
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.7630167007446289
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.7268390655517578
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 0.726970911026001
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 87 cost time: 0.7844674587249756
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 88 cost time: 0.7731542587280273
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 89 cost time: 0.8324007987976074
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.8077948093414307
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.7438008785247803
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 92 cost time: 0.7331404685974121
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.7630085945129395
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 94 cost time: 0.844519853591919
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 95 cost time: 0.8180534839630127
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.770392894744873
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.7387833595275879
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 98 cost time: 0.7924139499664307
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 99 cost time: 0.7275106906890869
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.8147075176239014
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm64_nh16_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 142873
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3554863929748535
Epoch: 1, Steps: 18 | Train Loss: 2.938 Vali Loss: 1.479 Vali Acc: 0.847 Test Loss: 1.479 Test Acc: 0.847
Validation loss decreased (inf --> -0.846652).  Saving model ...
Epoch: 2 cost time: 0.9561121463775635
Epoch: 2, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.265 Vali Acc: 0.947 Test Loss: 0.265 Test Acc: 0.947
Validation loss decreased (-0.846652 --> -0.946664).  Saving model ...
Epoch: 3 cost time: 0.9663059711456299
Epoch: 3, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.181 Vali Acc: 0.947 Test Loss: 0.181 Test Acc: 0.947
Validation loss decreased (-0.946664 --> -0.946665).  Saving model ...
Epoch: 4 cost time: 0.9448831081390381
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.946665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.9202322959899902
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9274675846099854
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9626023769378662
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9525713920593262
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.9683680534362793
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9406826496124268
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.930699348449707
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.949270486831665
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9097702503204346
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.851459264755249
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9608509540557861
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0479154586791992
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0086865425109863
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0352089405059814
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.115785837173462
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0379204750061035
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0948107242584229
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0842604637145996
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0976347923278809
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.0223603248596191
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0754578113555908
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.0206358432769775
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0066969394683838
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0629103183746338
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1398353576660156
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0389955043792725
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1078426837921143
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9566102027893066
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.050614595413208
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.0397422313690186
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.019017219543457
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.033151388168335
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9065039157867432
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.156381607055664
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.128446102142334
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.109745740890503
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2533960342407227
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0273678302764893
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.067589521408081
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0722026824951172
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1561505794525146
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.100998878479004
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0574417114257812
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.002906084060669
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 539641
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4120888710021973
Epoch: 1, Steps: 18 | Train Loss: 3.058 Vali Loss: 2.189 Vali Acc: 0.647 Test Loss: 2.189 Test Acc: 0.647
Validation loss decreased (inf --> -0.646645).  Saving model ...
Epoch: 2 cost time: 1.0818521976470947
Epoch: 2, Steps: 18 | Train Loss: 1.417 Vali Loss: 0.641 Vali Acc: 0.943 Test Loss: 0.641 Test Acc: 0.943
Validation loss decreased (-0.646645 --> -0.943327).  Saving model ...
Epoch: 3 cost time: 1.1504817008972168
Epoch: 3, Steps: 18 | Train Loss: 0.379 Vali Loss: 0.249 Vali Acc: 0.957 Test Loss: 0.249 Test Acc: 0.957
Validation loss decreased (-0.943327 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 1.184699535369873
Epoch: 4, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.956664 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.2437596321105957
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.3936758041381836
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.3187880516052246
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9291701316833496
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.1975758075714111
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.1324379444122314
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.1666607856750488
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2145297527313232
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.2492327690124512
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1899538040161133
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2427237033843994
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.3233191967010498
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1151659488677979
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.2320916652679443
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2085657119750977
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.1795639991760254
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.1991581916809082
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.2888126373291016
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.2685868740081787
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.296161413192749
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2602293491363525
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0701916217803955
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.207848072052002
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.222754716873169
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2378640174865723
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1539356708526611
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.2373950481414795
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.1939353942871094
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.2294645309448242
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2152597904205322
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8220396041870117
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0082015991210938
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0494377613067627
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9800512790679932
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8988404273986816
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9299399852752686
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.0139384269714355
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2079648971557617
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.2332518100738525
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.888683557510376
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0087170600891113
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0248832702636719
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9988396167755127
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0487589836120605
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1739842891693115
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.170647144317627
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0990753173828125
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.0914435386657715
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 280569
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.197113275527954
Epoch: 1, Steps: 18 | Train Loss: 3.077 Vali Loss: 2.542 Vali Acc: 0.443 Test Loss: 2.542 Test Acc: 0.443
Validation loss decreased (inf --> -0.443308).  Saving model ...
Epoch: 2 cost time: 0.7819063663482666
Epoch: 2, Steps: 18 | Train Loss: 2.012 Vali Loss: 1.192 Vali Acc: 0.890 Test Loss: 1.192 Test Acc: 0.890
Validation loss decreased (-0.443308 --> -0.889988).  Saving model ...
Epoch: 3 cost time: 0.8018038272857666
Epoch: 3, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.397 Vali Acc: 0.967 Test Loss: 0.397 Test Acc: 0.967
Validation loss decreased (-0.889988 --> -0.966663).  Saving model ...
Epoch: 4 cost time: 0.7874906063079834
Epoch: 4, Steps: 18 | Train Loss: 0.201 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8206260204315186
Epoch: 5, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.966663 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.7462234497070312
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.8214459419250488
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.707566499710083
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.7667040824890137
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8265278339385986
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.8409700393676758
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8225159645080566
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8555972576141357
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7668976783752441
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8111507892608643
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7515404224395752
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8065087795257568
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7597639560699463
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7365596294403076
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7846100330352783
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.769212007522583
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.8351247310638428
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 0.8077168464660645
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.7169065475463867
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 0.8040614128112793
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 0.7370789051055908
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 0.8503077030181885
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 0.841569185256958
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 0.7085301876068115
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 0.7976546287536621
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 0.8025660514831543
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8776624202728271
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7799851894378662
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6457500457763672
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 0.7852354049682617
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 0.8246307373046875
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 0.7529613971710205
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 0.7916934490203857
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 0.837958574295044
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.8992063999176025
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8938400745391846
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 0.8529675006866455
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 0.8805027008056641
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8405652046203613
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 0.8171734809875488
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8155064582824707
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8260529041290283
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8221487998962402
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7771182060241699
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 0.808342456817627
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 0.8231511116027832
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 0.8581397533416748
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8062272071838379
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8937380313873291
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8641724586486816
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.7710368633270264
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.7882513999938965
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 0.8091695308685303
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 0.8695735931396484
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 0.8360841274261475
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 0.8115031719207764
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.862391471862793
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8662533760070801
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9389345645904541
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8794140815734863
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.8869190216064453
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.7505178451538086
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.8576641082763672
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.8537123203277588
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.8916630744934082
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 194265
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0954859256744385
Epoch: 1, Steps: 18 | Train Loss: 3.229 Vali Loss: 2.807 Vali Acc: 0.257 Test Loss: 2.807 Test Acc: 0.257
Validation loss decreased (inf --> -0.256639).  Saving model ...
Epoch: 2 cost time: 0.7215533256530762
Epoch: 2, Steps: 18 | Train Loss: 2.339 Vali Loss: 1.703 Vali Acc: 0.803 Test Loss: 1.703 Test Acc: 0.803
Validation loss decreased (-0.256639 --> -0.803316).  Saving model ...
Epoch: 3 cost time: 0.8125300407409668
Epoch: 3, Steps: 18 | Train Loss: 1.234 Vali Loss: 0.746 Vali Acc: 0.940 Test Loss: 0.746 Test Acc: 0.940
Validation loss decreased (-0.803316 --> -0.939993).  Saving model ...
Epoch: 4 cost time: 0.8255665302276611
Epoch: 4, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.320 Vali Acc: 0.957 Test Loss: 0.320 Test Acc: 0.957
Validation loss decreased (-0.939993 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 0.7492556571960449
Epoch: 5, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.956663 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.7927403450012207
Epoch: 6, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8392503261566162
Epoch: 7, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.8368451595306396
Epoch: 8, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.8623678684234619
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.9021949768066406
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.9796271324157715
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8871166706085205
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.7530953884124756
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.8487913608551025
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8425369262695312
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8370583057403564
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8234145641326904
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8230817317962646
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8780813217163086
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.838158369064331
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9220905303955078
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7952601909637451
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.798194169998169
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7821862697601318
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8228957653045654
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7832536697387695
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7939162254333496
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.853205680847168
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7776532173156738
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8346278667449951
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.854987382888794
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8570411205291748
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.8953759670257568
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.8586218357086182
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7801742553710938
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8070096969604492
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7891905307769775
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7942113876342773
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8402345180511475
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8352160453796387
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8715896606445312
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8285150527954102
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8818185329437256
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8360249996185303
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.8191497325897217
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.792755126953125
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7834053039550781
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.8090600967407227
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.8160178661346436
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7681725025177002
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.7755484580993652
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8788628578186035
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8685617446899414
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.856482982635498
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8194644451141357
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.7817025184631348
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.8040316104888916
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.9097490310668945
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.7670371532440186
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.7939646244049072
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8171768188476562
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8052926063537598
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8929660320281982
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.890955924987793
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.8278887271881104
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8697218894958496
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.79848313331604
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.7696254253387451
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 0.844902753829956
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7610294818878174
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8566949367523193
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.8239083290100098
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.8107955455780029
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.8330979347229004
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.8294200897216797
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 0.8026630878448486
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8298540115356445
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8135049343109131
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.8466048240661621
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.7697398662567139
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.7499699592590332
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.6790051460266113
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.8029313087463379
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.7192316055297852
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.827063798904419
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 0.7284655570983887
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 0.8437542915344238
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 0.7456495761871338
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 0.7328917980194092
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.787590503692627
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.7442491054534912
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.7151029109954834
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.6957039833068848
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.7697174549102783
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.7755076885223389
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.6131584644317627
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.7822141647338867
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.8542773723602295
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.6939973831176758
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.8021974563598633
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 151193
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1232821941375732
Epoch: 1, Steps: 18 | Train Loss: 3.159 Vali Loss: 2.792 Vali Acc: 0.243 Test Loss: 2.792 Test Acc: 0.243
Validation loss decreased (inf --> -0.243305).  Saving model ...
Epoch: 2 cost time: 0.7507467269897461
Epoch: 2, Steps: 18 | Train Loss: 2.443 Vali Loss: 1.814 Vali Acc: 0.770 Test Loss: 1.814 Test Acc: 0.770
Validation loss decreased (-0.243305 --> -0.769982).  Saving model ...
Epoch: 3 cost time: 0.6714985370635986
Epoch: 3, Steps: 18 | Train Loss: 1.384 Vali Loss: 0.889 Vali Acc: 0.937 Test Loss: 0.889 Test Acc: 0.937
Validation loss decreased (-0.769982 --> -0.936658).  Saving model ...
Epoch: 4 cost time: 0.7343180179595947
Epoch: 4, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.387 Vali Acc: 0.967 Test Loss: 0.387 Test Acc: 0.967
Validation loss decreased (-0.936658 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 0.7315013408660889
Epoch: 5, Steps: 18 | Train Loss: 0.231 Vali Loss: 0.214 Vali Acc: 0.967 Test Loss: 0.214 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.7617614269256592
Epoch: 6, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.7320072650909424
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.745877742767334
Epoch: 8, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.7210719585418701
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6880090236663818
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.7634232044219971
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.6945433616638184
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8196587562561035
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.706099271774292
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7159969806671143
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.727797269821167
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6873095035552979
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.5669896602630615
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7038092613220215
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7638742923736572
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8115053176879883
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.781346321105957
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6924331188201904
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7723128795623779
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7876260280609131
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7390360832214355
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7161734104156494
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7170321941375732
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7328605651855469
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7294921875
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7163863182067871
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7473318576812744
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7374899387359619
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8010010719299316
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7162814140319824
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7276535034179688
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7926285266876221
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7760233879089355
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8243699073791504
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7763893604278564
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7751419544219971
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7925992012023926
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.7684586048126221
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6986172199249268
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7899816036224365
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.7652847766876221
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7485067844390869
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7356767654418945
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7224564552307129
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7809805870056152
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7948801517486572
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.7768301963806152
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.8042426109313965
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.7402238845825195
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8024730682373047
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.748157262802124
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.7401721477508545
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.7112607955932617
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.7591054439544678
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.7745604515075684
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.8078052997589111
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8623039722442627
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7840671539306641
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.8093509674072266
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.7805600166320801
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.8414351940155029
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7794454097747803
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.784515380859375
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7746982574462891
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.7801456451416016
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8633177280426025
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7788834571838379
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.8378636837005615
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7914555072784424
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.8178713321685791
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.7814998626708984
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.8072459697723389
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.7945055961608887
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.7724604606628418
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 115417
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1013593673706055
Epoch: 1, Steps: 18 | Train Loss: 3.249 Vali Loss: 3.028 Vali Acc: 0.157 Test Loss: 3.028 Test Acc: 0.157
Validation loss decreased (inf --> -0.156636).  Saving model ...
Epoch: 2 cost time: 0.7626087665557861
Epoch: 2, Steps: 18 | Train Loss: 2.715 Vali Loss: 2.306 Vali Acc: 0.580 Test Loss: 2.306 Test Acc: 0.580
Validation loss decreased (-0.156636 --> -0.579977).  Saving model ...
Epoch: 3 cost time: 0.7716429233551025
Epoch: 3, Steps: 18 | Train Loss: 1.989 Vali Loss: 1.468 Vali Acc: 0.873 Test Loss: 1.468 Test Acc: 0.873
Validation loss decreased (-0.579977 --> -0.873319).  Saving model ...
Epoch: 4 cost time: 0.7689578533172607
Epoch: 4, Steps: 18 | Train Loss: 1.127 Vali Loss: 0.794 Vali Acc: 0.943 Test Loss: 0.794 Test Acc: 0.943
Validation loss decreased (-0.873319 --> -0.943325).  Saving model ...
Epoch: 5 cost time: 0.7547013759613037
Epoch: 5, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.414 Vali Acc: 0.967 Test Loss: 0.414 Test Acc: 0.967
Validation loss decreased (-0.943325 --> -0.966663).  Saving model ...
Epoch: 6 cost time: 0.7703578472137451
Epoch: 6, Steps: 18 | Train Loss: 0.268 Vali Loss: 0.251 Vali Acc: 0.967 Test Loss: 0.251 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 0.84816575050354
Epoch: 7, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8067190647125244
Epoch: 8, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.6959853172302246
Epoch: 9, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 0.736417293548584
Epoch: 10, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 0.7348978519439697
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.8080098628997803
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7079901695251465
Epoch: 13, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.7467241287231445
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7400579452514648
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7400131225585938
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8090107440948486
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8142127990722656
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7467899322509766
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7236599922180176
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7753331661224365
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7087314128875732
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7929024696350098
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8428113460540771
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7884345054626465
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7929551601409912
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.6217288970947266
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7335171699523926
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8238635063171387
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.7939877510070801
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.77069091796875
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.8164894580841064
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.7187871932983398
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7239103317260742
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8509752750396729
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7551248073577881
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.7158486843109131
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.7154490947723389
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.7983846664428711
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.7422606945037842
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7263333797454834
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.8319005966186523
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7201547622680664
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7152736186981201
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6811544895172119
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.728924036026001
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.721782922744751
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.7326161861419678
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.6946954727172852
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7672739028930664
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.7248311042785645
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.7311532497406006
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.7288811206817627
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 0.7878584861755371
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7866344451904297
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7552738189697266
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7981634140014648
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 0.674008846282959
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 0.7057843208312988
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 0.7079813480377197
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 0.7866687774658203
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7817590236663818
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 0.7068881988525391
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 0.7009625434875488
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.713773250579834
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7468233108520508
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7833006381988525
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7655088901519775
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.6712143421173096
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.7287204265594482
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.78006911277771
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.8034281730651855
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.7639584541320801
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.6868419647216797
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 86841
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.143270492553711
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 2.991 Vali Acc: 0.167 Test Loss: 2.991 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 0.5713751316070557
Epoch: 2, Steps: 18 | Train Loss: 2.821 Vali Loss: 2.298 Vali Acc: 0.567 Test Loss: 2.298 Test Acc: 0.567
Validation loss decreased (-0.166637 --> -0.566644).  Saving model ...
Epoch: 3 cost time: 0.8640303611755371
Epoch: 3, Steps: 18 | Train Loss: 2.059 Vali Loss: 1.536 Vali Acc: 0.823 Test Loss: 1.536 Test Acc: 0.823
Validation loss decreased (-0.566644 --> -0.823318).  Saving model ...
Epoch: 4 cost time: 0.764080286026001
Epoch: 4, Steps: 18 | Train Loss: 1.215 Vali Loss: 0.876 Vali Acc: 0.927 Test Loss: 0.876 Test Acc: 0.927
Validation loss decreased (-0.823318 --> -0.926658).  Saving model ...
Epoch: 5 cost time: 0.77069091796875
Epoch: 5, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.480 Vali Acc: 0.963 Test Loss: 0.480 Test Acc: 0.963
Validation loss decreased (-0.926658 --> -0.963329).  Saving model ...
Epoch: 6 cost time: 0.7702007293701172
Epoch: 6, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.281 Vali Acc: 0.970 Test Loss: 0.281 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969997).  Saving model ...
Epoch: 7 cost time: 0.7554652690887451
Epoch: 7, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 0.832442045211792
Epoch: 8, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.166 Vali Acc: 0.980 Test Loss: 0.166 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979998).  Saving model ...
Epoch: 9 cost time: 0.7582340240478516
Epoch: 9, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 10 cost time: 0.6849222183227539
Epoch: 10, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 0.7538535594940186
Epoch: 11, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7789819240570068
Epoch: 12, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 0.7267448902130127
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.7586550712585449
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.7906322479248047
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 0.8011484146118164
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.7803504467010498
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 0.7269542217254639
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 0.735304594039917
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 0.7017240524291992
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.7318241596221924
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.7708027362823486
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 0.6938362121582031
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.7435247898101807
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 0.8202099800109863
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7493112087249756
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 0.7873642444610596
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.7856297492980957
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 0.7771158218383789
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 0.8055481910705566
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 0.7891991138458252
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 0.7658815383911133
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 0.7726113796234131
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 0.8505077362060547
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 0.7572803497314453
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 0.720503568649292
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 0.7854087352752686
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 0.8065767288208008
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 0.7467789649963379
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.7706725597381592
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 0.861126184463501
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 0.825843334197998
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 0.7567858695983887
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 0.7993338108062744
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 0.7412419319152832
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 0.7632017135620117
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 0.7481470108032227
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7806487083435059
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 0.7898833751678467
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 0.7610187530517578
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 0.771120548248291
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 52 cost time: 0.8786540031433105
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 53 cost time: 0.7906525135040283
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 54 cost time: 0.8250908851623535
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 0.7970664501190186
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 56 cost time: 0.8263530731201172
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 57 cost time: 0.7943589687347412
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7517273426055908
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 0.7706863880157471
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 0.7721498012542725
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 0.7728180885314941
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 0.7529563903808594
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 63 cost time: 0.8448741436004639
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 0.7280702590942383
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 0.7388722896575928
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 0.7549512386322021
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 0.7613205909729004
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.771756649017334
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8132476806640625
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7839429378509521
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 0.8218588829040527
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 72 cost time: 0.7664587497711182
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 73 cost time: 0.7500922679901123
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 0.8180196285247803
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7705972194671631
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.7407891750335693
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.7665083408355713
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.7337501049041748
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 79 cost time: 0.7666120529174805
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8132531642913818
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.8955340385437012
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 0.7900173664093018
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 0.7942047119140625
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 0.7733969688415527
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 85 cost time: 0.8782126903533936
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 86 cost time: 0.8158848285675049
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.7740299701690674
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 88 cost time: 0.7452151775360107
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 0.7020118236541748
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 0.7426893711090088
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.770366907119751
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.7735769748687744
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.7831442356109619
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.7928111553192139
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.815093994140625
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 96 cost time: 0.7820615768432617
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.7933402061462402
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 0.6019301414489746
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 0.734489917755127
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 0.8321795463562012
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 79865
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2070860862731934
Epoch: 1, Steps: 18 | Train Loss: 2.779 Vali Loss: 1.407 Vali Acc: 0.880 Test Loss: 1.407 Test Acc: 0.880
Validation loss decreased (inf --> -0.879986).  Saving model ...
Epoch: 2 cost time: 0.7827732563018799
Epoch: 2, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
Validation loss decreased (-0.879986 --> -0.933330).  Saving model ...
Epoch: 3 cost time: 0.7568855285644531
Epoch: 3, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
Validation loss decreased (-0.933330 --> -0.953332).  Saving model ...
Epoch: 4 cost time: 0.8895666599273682
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.953332 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.7958078384399414
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8432824611663818
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.7931792736053467
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7856454849243164
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9175159931182861
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8111448287963867
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8730754852294922
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.770484447479248
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.788832426071167
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9858629703521729
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8970584869384766
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8151135444641113
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8305873870849609
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8822062015533447
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8663027286529541
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8306479454040527
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8316471576690674
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7244513034820557
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8177249431610107
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8709478378295898
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8645856380462646
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8274028301239014
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8346021175384521
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.813321590423584
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8890941143035889
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 531321
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4620471000671387
Epoch: 1, Steps: 18 | Train Loss: 3.112 Vali Loss: 2.206 Vali Acc: 0.603 Test Loss: 2.206 Test Acc: 0.603
Validation loss decreased (inf --> -0.603311).  Saving model ...
Epoch: 2 cost time: 0.8972501754760742
Epoch: 2, Steps: 18 | Train Loss: 1.473 Vali Loss: 0.721 Vali Acc: 0.923 Test Loss: 0.721 Test Acc: 0.923
Validation loss decreased (-0.603311 --> -0.923326).  Saving model ...
Epoch: 3 cost time: 0.9405207633972168
Epoch: 3, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.239 Vali Acc: 0.960 Test Loss: 0.239 Test Acc: 0.960
Validation loss decreased (-0.923326 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 0.9522180557250977
Epoch: 4, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.7728993892669678
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 0.8818001747131348
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.8207626342773438
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.7585945129394531
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9710938930511475
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9306299686431885
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.6633744239807129
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1047680377960205
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0658655166625977
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1074726581573486
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0153627395629883
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0275812149047852
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0359318256378174
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.159240961074829
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.17136812210083
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1103386878967285
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 272249
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.069924831390381
Epoch: 1, Steps: 18 | Train Loss: 3.123 Vali Loss: 2.487 Vali Acc: 0.490 Test Loss: 2.487 Test Acc: 0.490
Validation loss decreased (inf --> -0.489975).  Saving model ...
Epoch: 2 cost time: 0.7480933666229248
Epoch: 2, Steps: 18 | Train Loss: 1.952 Vali Loss: 1.176 Vali Acc: 0.877 Test Loss: 1.176 Test Acc: 0.877
Validation loss decreased (-0.489975 --> -0.876655).  Saving model ...
Epoch: 3 cost time: 0.7586817741394043
Epoch: 3, Steps: 18 | Train Loss: 0.791 Vali Loss: 0.426 Vali Acc: 0.957 Test Loss: 0.426 Test Acc: 0.957
Validation loss decreased (-0.876655 --> -0.956662).  Saving model ...
Epoch: 4 cost time: 0.7866322994232178
Epoch: 4, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.206 Vali Acc: 0.963 Test Loss: 0.206 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 0.7390537261962891
Epoch: 5, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.759558916091919
Epoch: 6, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.7638885974884033
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.8125150203704834
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.7351570129394531
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.7947177886962891
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7514121532440186
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8028371334075928
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.7575502395629883
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7699005603790283
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7611832618713379
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7769951820373535
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7435328960418701
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7648122310638428
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8251957893371582
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7738397121429443
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.778949499130249
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7662715911865234
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7504181861877441
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7674834728240967
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7769565582275391
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7541358470916748
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7702004909515381
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7449522018432617
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8094408512115479
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8078739643096924
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8359928131103516
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8614768981933594
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8808465003967285
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7965290546417236
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.8175797462463379
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8276009559631348
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8059630393981934
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.741065502166748
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7973370552062988
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.713151216506958
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7434124946594238
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7650444507598877
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7533912658691406
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7628774642944336
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.827324390411377
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8027217388153076
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8443620204925537
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7617392539978027
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.7931687831878662
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8128435611724854
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.7872633934020996
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.7904133796691895
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.7642126083374023
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7851381301879883
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.7906472682952881
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8040971755981445
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.8680717945098877
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.9186289310455322
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.7918431758880615
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8371076583862305
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7874321937561035
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.7905721664428711
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8345210552215576
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.8357388973236084
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.825678825378418
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.800175666809082
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.784217119216919
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.8457422256469727
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 185945
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.307990789413452
Epoch: 1, Steps: 18 | Train Loss: 3.295 Vali Loss: 2.811 Vali Acc: 0.263 Test Loss: 2.811 Test Acc: 0.263
Validation loss decreased (inf --> -0.263305).  Saving model ...
Epoch: 2 cost time: 0.774547815322876
Epoch: 2, Steps: 18 | Train Loss: 2.399 Vali Loss: 1.737 Vali Acc: 0.800 Test Loss: 1.737 Test Acc: 0.800
Validation loss decreased (-0.263305 --> -0.799983).  Saving model ...
Epoch: 3 cost time: 0.7446608543395996
Epoch: 3, Steps: 18 | Train Loss: 1.306 Vali Loss: 0.793 Vali Acc: 0.943 Test Loss: 0.793 Test Acc: 0.943
Validation loss decreased (-0.799983 --> -0.943325).  Saving model ...
Epoch: 4 cost time: 0.6886014938354492
Epoch: 4, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.329 Vali Acc: 0.960 Test Loss: 0.329 Test Acc: 0.960
Validation loss decreased (-0.943325 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 0.7041685581207275
Epoch: 5, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 0.7301983833312988
Epoch: 6, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.7506668567657471
Epoch: 7, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.7903316020965576
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.6837985515594482
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.6732916831970215
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7215065956115723
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7291808128356934
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.720956563949585
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.7796058654785156
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7532658576965332
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7608973979949951
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7122187614440918
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7096824645996094
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7260923385620117
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7713932991027832
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7693512439727783
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7473018169403076
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7719402313232422
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6811680793762207
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7419109344482422
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7246439456939697
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7266082763671875
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7180168628692627
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.7258005142211914
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5972397327423096
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7070684432983398
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7397916316986084
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.7283661365509033
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7135779857635498
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.7296490669250488
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7631022930145264
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.7076225280761719
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8122689723968506
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.7044641971588135
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.740703821182251
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7240641117095947
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6868314743041992
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6781809329986572
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7782957553863525
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.786931037902832
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7063093185424805
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.757131814956665
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7276582717895508
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 142873
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.204085350036621
Epoch: 1, Steps: 18 | Train Loss: 3.282 Vali Loss: 2.904 Vali Acc: 0.230 Test Loss: 2.904 Test Acc: 0.230
Validation loss decreased (inf --> -0.229971).  Saving model ...
Epoch: 2 cost time: 0.8049297332763672
Epoch: 2, Steps: 18 | Train Loss: 2.511 Vali Loss: 1.934 Vali Acc: 0.833 Test Loss: 1.934 Test Acc: 0.833
Validation loss decreased (-0.229971 --> -0.833314).  Saving model ...
Epoch: 3 cost time: 0.5948493480682373
Epoch: 3, Steps: 18 | Train Loss: 1.537 Vali Loss: 0.994 Vali Acc: 0.943 Test Loss: 0.994 Test Acc: 0.943
Validation loss decreased (-0.833314 --> -0.943323).  Saving model ...
Epoch: 4 cost time: 0.8203449249267578
Epoch: 4, Steps: 18 | Train Loss: 0.736 Vali Loss: 0.446 Vali Acc: 0.960 Test Loss: 0.446 Test Acc: 0.960
Validation loss decreased (-0.943323 --> -0.959996).  Saving model ...
Epoch: 5 cost time: 0.7990593910217285
Epoch: 5, Steps: 18 | Train Loss: 0.297 Vali Loss: 0.237 Vali Acc: 0.973 Test Loss: 0.237 Test Acc: 0.973
Validation loss decreased (-0.959996 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 0.8247523307800293
Epoch: 6, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.7628629207611084
Epoch: 7, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.7185029983520508
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.7798590660095215
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.7391924858093262
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.7207129001617432
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7834465503692627
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7584102153778076
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.762380838394165
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7513659000396729
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8021783828735352
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7734730243682861
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7616732120513916
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7161092758178711
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7434048652648926
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8358795642852783
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.8510603904724121
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7908248901367188
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7663450241088867
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7839531898498535
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.803135871887207
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8061487674713135
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8015789985656738
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7262165546417236
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7730393409729004
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7871031761169434
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7584407329559326
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.8293912410736084
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.8260414600372314
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7845151424407959
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.772392988204956
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8311746120452881
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.8089454174041748
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.8129332065582275
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.8159134387969971
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7636032104492188
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7918577194213867
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7932314872741699
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7355072498321533
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.762887716293335
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7679111957550049
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7706165313720703
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7189674377441406
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.8200900554656982
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.8120613098144531
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.7961535453796387
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.7834839820861816
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.786353588104248
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.7934143543243408
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7791874408721924
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.774972677230835
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7488663196563721
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.7621233463287354
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.7319803237915039
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7666444778442383
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7519006729125977
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.7636198997497559
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.7708718776702881
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.7325539588928223
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.7891037464141846
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.7769973278045654
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8016183376312256
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7436027526855469
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.7561352252960205
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.8045175075531006
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 0.786841869354248
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 0.7889118194580078
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 0.7589187622070312
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7713103294372559
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.747711181640625
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.8170127868652344
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.7814364433288574
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.8288698196411133
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 0.7383322715759277
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 0.7505269050598145
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 0.7966444492340088
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 0.7365868091583252
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.7599582672119141
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 0.7580831050872803
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.7357344627380371
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.7455034255981445
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.7580599784851074
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.7872681617736816
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.8159608840942383
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.773390531539917
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.8000264167785645
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 0.7828562259674072
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.7181363105773926
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.7219734191894531
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.72987961769104
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 0.6645586490631104
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.775742769241333
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.7758445739746094
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.7389309406280518
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 0.7252368927001953
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 107097
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2295901775360107
Epoch: 1, Steps: 18 | Train Loss: 3.358 Vali Loss: 3.109 Vali Acc: 0.093 Test Loss: 3.109 Test Acc: 0.093
Validation loss decreased (inf --> -0.093302).  Saving model ...
Epoch: 2 cost time: 0.6873438358306885
Epoch: 2, Steps: 18 | Train Loss: 2.851 Vali Loss: 2.396 Vali Acc: 0.480 Test Loss: 2.396 Test Acc: 0.480
Validation loss decreased (-0.093302 --> -0.479976).  Saving model ...
Epoch: 3 cost time: 0.7945046424865723
Epoch: 3, Steps: 18 | Train Loss: 2.058 Vali Loss: 1.583 Vali Acc: 0.820 Test Loss: 1.583 Test Acc: 0.820
Validation loss decreased (-0.479976 --> -0.819984).  Saving model ...
Epoch: 4 cost time: 0.7076213359832764
Epoch: 4, Steps: 18 | Train Loss: 1.249 Vali Loss: 0.878 Vali Acc: 0.943 Test Loss: 0.878 Test Acc: 0.943
Validation loss decreased (-0.819984 --> -0.943325).  Saving model ...
Epoch: 5 cost time: 0.760143518447876
Epoch: 5, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.468 Vali Acc: 0.963 Test Loss: 0.468 Test Acc: 0.963
Validation loss decreased (-0.943325 --> -0.963329).  Saving model ...
Epoch: 6 cost time: 0.6686298847198486
Epoch: 6, Steps: 18 | Train Loss: 0.324 Vali Loss: 0.284 Vali Acc: 0.973 Test Loss: 0.284 Test Acc: 0.973
Validation loss decreased (-0.963329 --> -0.973330).  Saving model ...
Epoch: 7 cost time: 0.7047519683837891
Epoch: 7, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.207 Vali Acc: 0.970 Test Loss: 0.207 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6247725486755371
Epoch: 8, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6208329200744629
Epoch: 9, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
Validation loss decreased (-0.973330 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.7365450859069824
Epoch: 10, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7039635181427002
Epoch: 11, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.7104732990264893
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.6858983039855957
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7273626327514648
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.807819128036499
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.786329984664917
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8591618537902832
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9291257858276367
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8211855888366699
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7946445941925049
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8212246894836426
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7377667427062988
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8225648403167725
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7610816955566406
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7876143455505371
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7721755504608154
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8312368392944336
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7497639656066895
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7554309368133545
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7871391773223877
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7809879779815674
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8036293983459473
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8216686248779297
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7504372596740723
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 0.7488925457000732
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 0.7545955181121826
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 0.8415508270263672
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 0.8267326354980469
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 0.786902666091919
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 0.8458168506622314
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 0.8542454242706299
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 0.7667417526245117
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 0.855541467666626
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 0.7622685432434082
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 0.8175384998321533
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8108978271484375
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.739875316619873
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 0.8633449077606201
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 0.8062307834625244
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 0.8510384559631348
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 51 cost time: 0.8364155292510986
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8194723129272461
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8282968997955322
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.814781904220581
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8680071830749512
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.8376672267913818
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.8124430179595947
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 58 cost time: 0.8340890407562256
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 59 cost time: 0.7918605804443359
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 60 cost time: 0.8175115585327148
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 61 cost time: 0.8212933540344238
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 62 cost time: 0.8111600875854492
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8061652183532715
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 0.8340868949890137
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8801543712615967
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 0.8498110771179199
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 0.8173348903656006
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8296942710876465
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 0.8117702007293701
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 0.8220126628875732
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8497114181518555
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.8240342140197754
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.794703483581543
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 74 cost time: 0.795525312423706
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7580564022064209
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 0.8161876201629639
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 0.8671541213989258
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 0.8494622707366943
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.8232817649841309
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.8507921695709229
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.9095597267150879
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.8124635219573975
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 0.86517333984375
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 0.8038654327392578
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.8408212661743164
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.8422584533691406
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.7660212516784668
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.8035986423492432
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.83530592918396
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.8337392807006836
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.8649914264678955
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.8846533298492432
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.9304244518280029
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 0.8555140495300293
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.8614859580993652
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.8459804058074951
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.827012300491333
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 0.89542555809021
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.841949462890625
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 0.8264358043670654
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 78521
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.354050874710083
Epoch: 1, Steps: 18 | Train Loss: 3.375 Vali Loss: 3.062 Vali Acc: 0.107 Test Loss: 3.062 Test Acc: 0.107
Validation loss decreased (inf --> -0.106636).  Saving model ...
Epoch: 2 cost time: 0.8560836315155029
Epoch: 2, Steps: 18 | Train Loss: 2.840 Vali Loss: 2.387 Vali Acc: 0.540 Test Loss: 2.387 Test Acc: 0.540
Validation loss decreased (-0.106636 --> -0.539976).  Saving model ...
Epoch: 3 cost time: 0.8472299575805664
Epoch: 3, Steps: 18 | Train Loss: 2.129 Vali Loss: 1.608 Vali Acc: 0.847 Test Loss: 1.608 Test Acc: 0.847
Validation loss decreased (-0.539976 --> -0.846651).  Saving model ...
Epoch: 4 cost time: 0.838681697845459
Epoch: 4, Steps: 18 | Train Loss: 1.309 Vali Loss: 0.930 Vali Acc: 0.920 Test Loss: 0.930 Test Acc: 0.920
Validation loss decreased (-0.846651 --> -0.919991).  Saving model ...
Epoch: 5 cost time: 0.8743202686309814
Epoch: 5, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.504 Vali Acc: 0.950 Test Loss: 0.504 Test Acc: 0.950
Validation loss decreased (-0.919991 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.7736058235168457
Epoch: 6, Steps: 18 | Train Loss: 0.322 Vali Loss: 0.288 Vali Acc: 0.963 Test Loss: 0.288 Test Acc: 0.963
Validation loss decreased (-0.949995 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.7896294593811035
Epoch: 7, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 0.7471318244934082
Epoch: 8, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8477234840393066
Epoch: 9, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8274569511413574
Epoch: 10, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8862221240997314
Epoch: 11, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.8229138851165771
Epoch: 12, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.8637087345123291
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8608214855194092
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8366649150848389
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8497183322906494
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8677518367767334
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7999966144561768
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7587428092956543
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.8237149715423584
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8132185935974121
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8336668014526367
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.799450159072876
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.828392505645752
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7967987060546875
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.750964879989624
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7988579273223877
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.8645858764648438
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8634028434753418
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.8754134178161621
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.8252944946289062
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.8351142406463623
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.8293025493621826
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.8590328693389893
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.8943185806274414
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.8305983543395996
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.9143259525299072
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8046524524688721
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.8023853302001953
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.8413922786712646
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.8021011352539062
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.8961429595947266
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.8574702739715576
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.7442111968994141
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.8379955291748047
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.8143222332000732
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7156081199645996
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8525030612945557
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.8805294036865234
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.8413212299346924
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.8414888381958008
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.7904257774353027
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.7955026626586914
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 0.7954773902893066
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 0.7320103645324707
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 0.8082413673400879
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.8856911659240723
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.8906588554382324
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.8719110488891602
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.8099930286407471
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.7753496170043945
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.8506138324737549
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8771393299102783
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8530325889587402
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7812550067901611
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.9307432174682617
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 0.8181777000427246
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8333160877227783
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7839310169219971
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.9038405418395996
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8103950023651123
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.822822093963623
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 0.8834197521209717
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 0.804581880569458
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 0.8150029182434082
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7350053787231445
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.652987003326416
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.8620011806488037
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 0.7996492385864258
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.7974786758422852
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 0.7996933460235596
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8494682312011719
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.7487235069274902
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 0.7539148330688477
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 0.7831544876098633
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7874565124511719
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 0.6979320049285889
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.7711043357849121
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 0.7572920322418213
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.8004274368286133
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 0.7601497173309326
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 0.8100688457489014
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.7766239643096924
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.82696533203125
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 0.8183269500732422
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.8331203460693359
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 0.8047356605529785
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 0.689385175704956
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.8029599189758301
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.7735555171966553
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 71545
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7042579650878906
Epoch: 1, Steps: 18 | Train Loss: 2.892 Vali Loss: 1.452 Vali Acc: 0.867 Test Loss: 1.452 Test Acc: 0.867
Validation loss decreased (inf --> -0.866652).  Saving model ...
Epoch: 2 cost time: 0.8206818103790283
Epoch: 2, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.328 Vali Acc: 0.940 Test Loss: 0.328 Test Acc: 0.940
Validation loss decreased (-0.866652 --> -0.939997).  Saving model ...
Epoch: 3 cost time: 1.1301546096801758
Epoch: 3, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
Validation loss decreased (-0.939997 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 1.2130279541015625
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.191 Vali Acc: 0.940 Test Loss: 0.191 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1504065990447998
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.3057820796966553
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2842144966125488
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.2568268775939941
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.217658281326294
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2494306564331055
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2488799095153809
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3793165683746338
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2231943607330322
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1915009021759033
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.196627140045166
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1713855266571045
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2959468364715576
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3468635082244873
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 527161
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5704870223999023
Epoch: 1, Steps: 18 | Train Loss: 3.021 Vali Loss: 2.194 Vali Acc: 0.653 Test Loss: 2.194 Test Acc: 0.653
Validation loss decreased (inf --> -0.653311).  Saving model ...
Epoch: 2 cost time: 1.0799410343170166
Epoch: 2, Steps: 18 | Train Loss: 1.414 Vali Loss: 0.721 Vali Acc: 0.937 Test Loss: 0.721 Test Acc: 0.937
Validation loss decreased (-0.653311 --> -0.936659).  Saving model ...
Epoch: 3 cost time: 1.0751914978027344
Epoch: 3, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.277 Vali Acc: 0.953 Test Loss: 0.277 Test Acc: 0.953
Validation loss decreased (-0.936659 --> -0.953331).  Saving model ...
Epoch: 4 cost time: 1.0896081924438477
Epoch: 4, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.195 Vali Acc: 0.940 Test Loss: 0.195 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.141394853591919
Epoch: 5, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.953331 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.2352092266082764
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.249875545501709
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2291476726531982
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2037897109985352
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1629643440246582
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.1891260147094727
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2281224727630615
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2463932037353516
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.2053256034851074
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.063537359237671
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.191990613937378
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.195115566253662
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1762983798980713
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2101027965545654
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1844980716705322
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3166460990905762
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.194814682006836
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2017083168029785
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1301853656768799
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0159087181091309
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1100454330444336
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0823757648468018
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 268089
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2845311164855957
Epoch: 1, Steps: 18 | Train Loss: 3.044 Vali Loss: 2.480 Vali Acc: 0.507 Test Loss: 2.480 Test Acc: 0.507
Validation loss decreased (inf --> -0.506642).  Saving model ...
Epoch: 2 cost time: 0.8007364273071289
Epoch: 2, Steps: 18 | Train Loss: 1.872 Vali Loss: 1.171 Vali Acc: 0.887 Test Loss: 1.171 Test Acc: 0.887
Validation loss decreased (-0.506642 --> -0.886655).  Saving model ...
Epoch: 3 cost time: 0.833064079284668
Epoch: 3, Steps: 18 | Train Loss: 0.819 Vali Loss: 0.435 Vali Acc: 0.957 Test Loss: 0.435 Test Acc: 0.957
Validation loss decreased (-0.886655 --> -0.956662).  Saving model ...
Epoch: 4 cost time: 0.853785514831543
Epoch: 4, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 0.8492956161499023
Epoch: 5, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.8497707843780518
Epoch: 6, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.8029582500457764
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7460193634033203
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8947162628173828
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.906264066696167
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8711094856262207
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9011263847351074
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.832819938659668
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7702507972717285
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7887980937957764
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8186788558959961
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7532165050506592
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7978360652923584
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8345556259155273
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9302644729614258
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8590090274810791
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.8341572284698486
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8251564502716064
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8564951419830322
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8768858909606934
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8435359001159668
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.889472484588623
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8283329010009766
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8400471210479736
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8703875541687012
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7842135429382324
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8105909824371338
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.871997594833374
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8058352470397949
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.8712239265441895
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8119125366210938
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8411662578582764
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7938411235809326
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8043978214263916
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8919534683227539
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.8592922687530518
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.8049757480621338
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7953047752380371
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.863677978515625
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6684408187866211
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.8353233337402344
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.828479528427124
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9321820735931396
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7660965919494629
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7840621471405029
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.796212911605835
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7685508728027344
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.790886640548706
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.8198108673095703
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.7848494052886963
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7847959995269775
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7716419696807861
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8102362155914307
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8480710983276367
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.780268669128418
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.7864317893981934
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.7613692283630371
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.7856590747833252
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8903403282165527
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.7517788410186768
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7844243049621582
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8493084907531738
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7793819904327393
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.8220424652099609
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.7946078777313232
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.7749698162078857
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.751227617263794
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.8685810565948486
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.7471129894256592
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 181785
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.08009672164917
Epoch: 1, Steps: 18 | Train Loss: 3.288 Vali Loss: 2.844 Vali Acc: 0.187 Test Loss: 2.844 Test Acc: 0.187
Validation loss decreased (inf --> -0.186638).  Saving model ...
Epoch: 2 cost time: 0.7651185989379883
Epoch: 2, Steps: 18 | Train Loss: 2.385 Vali Loss: 1.771 Vali Acc: 0.800 Test Loss: 1.771 Test Acc: 0.800
Validation loss decreased (-0.186638 --> -0.799982).  Saving model ...
Epoch: 3 cost time: 0.7750461101531982
Epoch: 3, Steps: 18 | Train Loss: 1.311 Vali Loss: 0.822 Vali Acc: 0.933 Test Loss: 0.822 Test Acc: 0.933
Validation loss decreased (-0.799982 --> -0.933325).  Saving model ...
Epoch: 4 cost time: 0.810809850692749
Epoch: 4, Steps: 18 | Train Loss: 0.526 Vali Loss: 0.370 Vali Acc: 0.957 Test Loss: 0.370 Test Acc: 0.957
Validation loss decreased (-0.933325 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 0.8452906608581543
Epoch: 5, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
Validation loss decreased (-0.956663 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.7785334587097168
Epoch: 6, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 0.7645835876464844
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 0.8089439868927002
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7204337120056152
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8008584976196289
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8446991443634033
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7842092514038086
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.780475378036499
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7687568664550781
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8016083240509033
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.840357780456543
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.763777494430542
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.757946252822876
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7667536735534668
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.6990365982055664
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7479205131530762
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8430633544921875
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7446684837341309
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7899127006530762
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.8100128173828125
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7554607391357422
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7971270084381104
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6248822212219238
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8017916679382324
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.8573760986328125
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.7904343605041504
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8030698299407959
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.778264045715332
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7634034156799316
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7736890316009521
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7939207553863525
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8263461589813232
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8450684547424316
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8471095561981201
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.8661513328552246
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8287172317504883
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8093066215515137
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8329050540924072
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8177134990692139
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.7879343032836914
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.6639857292175293
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7613146305084229
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.8330123424530029
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8774139881134033
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.8531343936920166
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.8438329696655273
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8023240566253662
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8861081600189209
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8307650089263916
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8765919208526611
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.837552547454834
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.8330230712890625
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.816950798034668
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.7938051223754883
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.8285121917724609
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 0.8732712268829346
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 0.812225341796875
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.8490591049194336
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8651659488677979
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8335905075073242
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.7956202030181885
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8877816200256348
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.8193943500518799
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 0.8313217163085938
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8689699172973633
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 0.8135290145874023
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7812252044677734
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 0.7513766288757324
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7826023101806641
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8126137256622314
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.7525355815887451
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.6808099746704102
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 78 cost time: 0.7342021465301514
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 0.6925139427185059
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.7664768695831299
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 0.8261070251464844
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 0.775869607925415
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 0.7218713760375977
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 84 cost time: 0.7599287033081055
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 85 cost time: 0.7712442874908447
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7745702266693115
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.7015149593353271
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.7294106483459473
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.7024064064025879
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.7280421257019043
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.730060338973999
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.7105467319488525
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.7158451080322266
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.7677078247070312
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 138713
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0574135780334473
Epoch: 1, Steps: 18 | Train Loss: 3.345 Vali Loss: 2.946 Vali Acc: 0.147 Test Loss: 2.946 Test Acc: 0.147
Validation loss decreased (inf --> -0.146637).  Saving model ...
Epoch: 2 cost time: 0.755903959274292
Epoch: 2, Steps: 18 | Train Loss: 2.555 Vali Loss: 1.998 Vali Acc: 0.750 Test Loss: 1.998 Test Acc: 0.750
Validation loss decreased (-0.146637 --> -0.749980).  Saving model ...
Epoch: 3 cost time: 0.781766414642334
Epoch: 3, Steps: 18 | Train Loss: 1.583 Vali Loss: 1.062 Vali Acc: 0.927 Test Loss: 1.062 Test Acc: 0.927
Validation loss decreased (-0.749980 --> -0.926656).  Saving model ...
Epoch: 4 cost time: 0.7594699859619141
Epoch: 4, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.480 Vali Acc: 0.957 Test Loss: 0.480 Test Acc: 0.957
Validation loss decreased (-0.926656 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 0.7358181476593018
Epoch: 5, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.244 Vali Acc: 0.973 Test Loss: 0.244 Test Acc: 0.973
Validation loss decreased (-0.956662 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 0.7665655612945557
Epoch: 6, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8068602085113525
Epoch: 7, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.8303124904632568
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7741482257843018
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7843894958496094
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.7930772304534912
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7980687618255615
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8116321563720703
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7493786811828613
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.724801778793335
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9035751819610596
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8039231300354004
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8492100238800049
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7583603858947754
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7132425308227539
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7456469535827637
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7932496070861816
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.748833417892456
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7608637809753418
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7482998371124268
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7409498691558838
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.71091628074646
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7944443225860596
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8579075336456299
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7259118556976318
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7300310134887695
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7385554313659668
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7727835178375244
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6765010356903076
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7151970863342285
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7768120765686035
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.6810712814331055
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.6970877647399902
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7372236251831055
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6701622009277344
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.6860666275024414
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7526195049285889
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.7219321727752686
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7754647731781006
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.8314664363861084
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7877943515777588
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7021009922027588
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.7761862277984619
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.7264025211334229
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7281684875488281
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.7341170310974121
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7334625720977783
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.7162654399871826
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.6791439056396484
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.7781333923339844
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.7756869792938232
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.7610692977905273
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7692210674285889
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7433891296386719
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7574141025543213
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.7369728088378906
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7315578460693359
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.7161703109741211
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6766085624694824
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7509615421295166
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.7902336120605469
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.781620979309082
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.7296180725097656
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7165548801422119
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.7349498271942139
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7122132778167725
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.6867377758026123
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.8974215984344482
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.6905715465545654
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 0.7050619125366211
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7775774002075195
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.815000057220459
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.6718716621398926
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6662800312042236
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.7783634662628174
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 0.7833492755889893
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7863516807556152
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.8582732677459717
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.7488710880279541
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.7555022239685059
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.7803380489349365
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.7809925079345703
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 0.7170138359069824
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7070572376251221
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 0.7184514999389648
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.731825590133667
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.7435722351074219
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.8182096481323242
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 0.8069334030151367
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.7300467491149902
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.7725310325622559
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 0.7686200141906738
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.7355437278747559
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.784113883972168
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.744614839553833
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 102937
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2173547744750977
Epoch: 1, Steps: 18 | Train Loss: 3.305 Vali Loss: 3.004 Vali Acc: 0.100 Test Loss: 3.004 Test Acc: 0.100
Validation loss decreased (inf --> -0.099970).  Saving model ...
Epoch: 2 cost time: 0.7616958618164062
Epoch: 2, Steps: 18 | Train Loss: 2.755 Vali Loss: 2.331 Vali Acc: 0.580 Test Loss: 2.331 Test Acc: 0.580
Validation loss decreased (-0.099970 --> -0.579977).  Saving model ...
Epoch: 3 cost time: 0.7460148334503174
Epoch: 3, Steps: 18 | Train Loss: 2.050 Vali Loss: 1.564 Vali Acc: 0.813 Test Loss: 1.564 Test Acc: 0.813
Validation loss decreased (-0.579977 --> -0.813318).  Saving model ...
Epoch: 4 cost time: 0.7605729103088379
Epoch: 4, Steps: 18 | Train Loss: 1.298 Vali Loss: 0.914 Vali Acc: 0.917 Test Loss: 0.914 Test Acc: 0.917
Validation loss decreased (-0.813318 --> -0.916658).  Saving model ...
Epoch: 5 cost time: 0.7583751678466797
Epoch: 5, Steps: 18 | Train Loss: 0.681 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
Validation loss decreased (-0.916658 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.7515907287597656
Epoch: 6, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.299 Vali Acc: 0.960 Test Loss: 0.299 Test Acc: 0.960
Validation loss decreased (-0.949995 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 0.802177906036377
Epoch: 7, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.7161452770233154
Epoch: 8, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.7680151462554932
Epoch: 9, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.7010958194732666
Epoch: 10, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.6930921077728271
Epoch: 11, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.7967679500579834
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7503025531768799
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8294112682342529
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.8051412105560303
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7889363765716553
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7447988986968994
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.747990608215332
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.788149356842041
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7800331115722656
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7051005363464355
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7435359954833984
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7487876415252686
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7396695613861084
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7040224075317383
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7659175395965576
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7193880081176758
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7490584850311279
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.7440295219421387
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7367870807647705
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.7446060180664062
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.6946334838867188
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.8633179664611816
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8529195785522461
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7176938056945801
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7573392391204834
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7700607776641846
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7778456211090088
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.7621669769287109
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.7342901229858398
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7665004730224609
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.780268669128418
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.7427995204925537
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.7366049289703369
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.7082247734069824
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.7112853527069092
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7487475872039795
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.7371375560760498
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.7828235626220703
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7242586612701416
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.7696771621704102
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.7839784622192383
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.795983076095581
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7556180953979492
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7378461360931396
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 0.7493391036987305
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.705430269241333
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 0.7363138198852539
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 0.8049073219299316
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7632172107696533
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8160207271575928
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.5825502872467041
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6837120056152344
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.672863245010376
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7372465133666992
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.7290623188018799
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7725248336791992
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.7043933868408203
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.732973575592041
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.8158314228057861
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6805307865142822
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 0.7252485752105713
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7085559368133545
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.6835823059082031
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.6825082302093506
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.6533398628234863
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.6993756294250488
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.6418905258178711
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.6482720375061035
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.6722841262817383
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.740100622177124
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 74361
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9946775436401367
Epoch: 1, Steps: 18 | Train Loss: 3.330 Vali Loss: 3.045 Vali Acc: 0.077 Test Loss: 3.045 Test Acc: 0.077
Validation loss decreased (inf --> -0.076636).  Saving model ...
Epoch: 2 cost time: 0.6874868869781494
Epoch: 2, Steps: 18 | Train Loss: 2.843 Vali Loss: 2.390 Vali Acc: 0.493 Test Loss: 2.390 Test Acc: 0.493
Validation loss decreased (-0.076636 --> -0.493309).  Saving model ...
Epoch: 3 cost time: 0.6792032718658447
Epoch: 3, Steps: 18 | Train Loss: 2.127 Vali Loss: 1.654 Vali Acc: 0.833 Test Loss: 1.654 Test Acc: 0.833
Validation loss decreased (-0.493309 --> -0.833317).  Saving model ...
Epoch: 4 cost time: 0.7033016681671143
Epoch: 4, Steps: 18 | Train Loss: 1.369 Vali Loss: 0.974 Vali Acc: 0.943 Test Loss: 0.974 Test Acc: 0.943
Validation loss decreased (-0.833317 --> -0.943324).  Saving model ...
Epoch: 5 cost time: 0.6657464504241943
Epoch: 5, Steps: 18 | Train Loss: 0.739 Vali Loss: 0.539 Vali Acc: 0.950 Test Loss: 0.539 Test Acc: 0.950
Validation loss decreased (-0.943324 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.7611138820648193
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.314 Vali Acc: 0.963 Test Loss: 0.314 Test Acc: 0.963
Validation loss decreased (-0.949995 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.6653594970703125
Epoch: 7, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.225 Vali Acc: 0.970 Test Loss: 0.225 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.7108099460601807
Epoch: 8, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7341439723968506
Epoch: 9, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.6714746952056885
Epoch: 10, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.6799600124359131
Epoch: 11, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.6884210109710693
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7158043384552002
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7047266960144043
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7308504581451416
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7286515235900879
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8366515636444092
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7316007614135742
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7272002696990967
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7094614505767822
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7029120922088623
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6733646392822266
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6725094318389893
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7097663879394531
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.6897883415222168
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7129950523376465
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7323825359344482
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7499854564666748
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7981023788452148
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7437806129455566
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7303190231323242
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7414195537567139
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7422130107879639
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7786624431610107
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7226147651672363
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7494590282440186
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7559514045715332
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7775142192840576
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7145037651062012
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7183542251586914
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7043709754943848
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7205045223236084
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7313485145568848
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.8381531238555908
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7815043926239014
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.7492871284484863
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7398045063018799
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.7561478614807129
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.7250194549560547
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.7611730098724365
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.7297053337097168
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.7457895278930664
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7116892337799072
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.7277491092681885
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.7202973365783691
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.7072885036468506
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.7772314548492432
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.7252445220947266
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7815639972686768
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.7571446895599365
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.7619047164916992
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.7452290058135986
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.7583153247833252
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.7469367980957031
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 65 cost time: 0.7739207744598389
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7089133262634277
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6980810165405273
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 0.7057723999023438
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7665603160858154
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 0.7325239181518555
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 71 cost time: 0.8274078369140625
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7438135147094727
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7639329433441162
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.739891767501831
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 75 cost time: 0.725801944732666
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 76 cost time: 0.7255377769470215
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 77 cost time: 0.7010126113891602
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 78 cost time: 0.689734935760498
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7300088405609131
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 0.6874399185180664
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 81 cost time: 0.6726579666137695
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 82 cost time: 0.7334542274475098
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 83 cost time: 0.7957844734191895
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 84 cost time: 0.805046558380127
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.8803608417510986
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.7430834770202637
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.7707021236419678
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.7739732265472412
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.7361593246459961
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.7090156078338623
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.7702882289886475
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.7278409004211426
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.7275888919830322
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm32_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 67385
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2574446201324463
Epoch: 1, Steps: 18 | Train Loss: 3.026 Vali Loss: 2.278 Vali Acc: 0.650 Test Loss: 2.278 Test Acc: 0.650
Validation loss decreased (inf --> -0.649977).  Saving model ...
Epoch: 2 cost time: 0.8599467277526855
Epoch: 2, Steps: 18 | Train Loss: 1.610 Vali Loss: 0.799 Vali Acc: 0.947 Test Loss: 0.799 Test Acc: 0.947
Validation loss decreased (-0.649977 --> -0.946659).  Saving model ...
Epoch: 3 cost time: 0.888024091720581
Epoch: 3, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.275 Vali Acc: 0.960 Test Loss: 0.275 Test Acc: 0.960
Validation loss decreased (-0.946659 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 0.9447674751281738
Epoch: 4, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 0.8694474697113037
Epoch: 5, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.9222548007965088
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.8813803195953369
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.9266257286071777
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.8761978149414062
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8989975452423096
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.8879821300506592
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9133923053741455
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9249193668365479
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9221417903900146
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9108433723449707
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9138631820678711
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8995685577392578
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.945728063583374
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.9016907215118408
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6819314956665039
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7985610961914062
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8041925430297852
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8643918037414551
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8544466495513916
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8202414512634277
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8013734817504883
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8715355396270752
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8720290660858154
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8041989803314209
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8626971244812012
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8841249942779541
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8025236129760742
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8196518421173096
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.8063745498657227
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8563776016235352
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7868218421936035
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8320062160491943
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7987031936645508
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8182332515716553
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7979378700256348
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.802201509475708
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.8474559783935547
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8327527046203613
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8658654689788818
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.879960298538208
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.8463544845581055
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8567540645599365
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7714741230010986
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8673951625823975
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8576095104217529
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.8108546733856201
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8560407161712646
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.8527824878692627
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8103907108306885
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8065106868743896
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8999581336975098
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8106060028076172
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.8213016986846924
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.851830244064331
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.9313087463378906
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.828148603439331
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.7929840087890625
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.7438931465148926
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.778308629989624
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7762742042541504
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8442633152008057
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7782330513000488
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.8461978435516357
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.8407559394836426
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.8298256397247314
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.9075374603271484
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.8751387596130371
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 268937
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9920847415924072
Epoch: 1, Steps: 18 | Train Loss: 3.220 Vali Loss: 2.759 Vali Acc: 0.317 Test Loss: 2.759 Test Acc: 0.317
Validation loss decreased (inf --> -0.316639).  Saving model ...
Epoch: 2 cost time: 0.7170166969299316
Epoch: 2, Steps: 18 | Train Loss: 2.354 Vali Loss: 1.651 Vali Acc: 0.820 Test Loss: 1.651 Test Acc: 0.820
Validation loss decreased (-0.316639 --> -0.819983).  Saving model ...
Epoch: 3 cost time: 0.7916722297668457
Epoch: 3, Steps: 18 | Train Loss: 1.237 Vali Loss: 0.709 Vali Acc: 0.927 Test Loss: 0.709 Test Acc: 0.927
Validation loss decreased (-0.819983 --> -0.926660).  Saving model ...
Epoch: 4 cost time: 0.8500378131866455
Epoch: 4, Steps: 18 | Train Loss: 0.473 Vali Loss: 0.310 Vali Acc: 0.967 Test Loss: 0.310 Test Acc: 0.967
Validation loss decreased (-0.926660 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 0.783435583114624
Epoch: 5, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7522983551025391
Epoch: 6, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.7364537715911865
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7532167434692383
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.7995083332061768
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7495217323303223
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.767420768737793
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8162992000579834
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7427380084991455
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8874306678771973
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7776615619659424
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8484482765197754
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7580740451812744
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.77219557762146
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7947080135345459
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7692980766296387
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8373639583587646
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8003857135772705
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8588414192199707
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7713525295257568
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.78961181640625
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7727110385894775
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 139401
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.05315899848938
Epoch: 1, Steps: 18 | Train Loss: 3.262 Vali Loss: 2.917 Vali Acc: 0.167 Test Loss: 2.917 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 0.7829892635345459
Epoch: 2, Steps: 18 | Train Loss: 2.642 Vali Loss: 2.187 Vali Acc: 0.707 Test Loss: 2.187 Test Acc: 0.707
Validation loss decreased (-0.166637 --> -0.706645).  Saving model ...
Epoch: 3 cost time: 0.7668216228485107
Epoch: 3, Steps: 18 | Train Loss: 1.839 Vali Loss: 1.338 Vali Acc: 0.893 Test Loss: 1.338 Test Acc: 0.893
Validation loss decreased (-0.706645 --> -0.893320).  Saving model ...
Epoch: 4 cost time: 0.7433831691741943
Epoch: 4, Steps: 18 | Train Loss: 1.000 Vali Loss: 0.675 Vali Acc: 0.953 Test Loss: 0.675 Test Acc: 0.953
Validation loss decreased (-0.893320 --> -0.953327).  Saving model ...
Epoch: 5 cost time: 0.7556428909301758
Epoch: 5, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.348 Vali Acc: 0.963 Test Loss: 0.348 Test Acc: 0.963
Validation loss decreased (-0.953327 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 0.7766649723052979
Epoch: 6, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.7480626106262207
Epoch: 7, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.7733383178710938
Epoch: 8, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.147 Vali Acc: 0.980 Test Loss: 0.147 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.7988510131835938
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.77555251121521
Epoch: 10, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8170521259307861
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7803902626037598
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7299726009368896
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7253103256225586
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7272539138793945
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7521553039550781
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6986908912658691
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7783150672912598
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7361056804656982
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7469320297241211
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7989580631256104
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7897534370422363
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7689871788024902
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7768969535827637
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7959623336791992
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7508876323699951
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7712092399597168
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.724041223526001
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8071327209472656
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7423326969146729
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7633390426635742
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.734539270401001
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.725456714630127
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.8364920616149902
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7501909732818604
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7568387985229492
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7861480712890625
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7756357192993164
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7496254444122314
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7367870807647705
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7895157337188721
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7548255920410156
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.7235274314880371
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7808022499084473
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8005690574645996
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7445459365844727
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.81778883934021
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.796715497970581
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.7420508861541748
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7766399383544922
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7261481285095215
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7710185050964355
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.767143726348877
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.691626787185669
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.748488187789917
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.7326266765594482
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7320740222930908
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.6390984058380127
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.7470474243164062
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7127225399017334
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7500114440917969
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.7152738571166992
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.731220006942749
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.7185101509094238
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.711132287979126
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.7631371021270752
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.710989236831665
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.754779577255249
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 0.7360000610351562
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.7240219116210938
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6887342929840088
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7155678272247314
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7399013042449951
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7256159782409668
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.7535417079925537
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.7014153003692627
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 0.705010175704956
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.6911535263061523
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7473876476287842
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 0.7272803783416748
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.7651207447052002
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.6821088790893555
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 0.6515142917633057
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 0.6310932636260986
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.706773042678833
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 86 cost time: 0.6928296089172363
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 87 cost time: 0.7605750560760498
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 88 cost time: 0.7868924140930176
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 89 cost time: 0.7066597938537598
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 90 cost time: 0.6562120914459229
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 91 cost time: 0.6715738773345947
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 92 cost time: 0.6883499622344971
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 93 cost time: 0.684802770614624
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.7323992252349854
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 95 cost time: 0.7689464092254639
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7256293296813965
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.7278339862823486
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.7396652698516846
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.7134828567504883
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.7433066368103027
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 96249
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.075603485107422
Epoch: 1, Steps: 18 | Train Loss: 3.289 Vali Loss: 3.000 Vali Acc: 0.107 Test Loss: 3.000 Test Acc: 0.107
Validation loss decreased (inf --> -0.106637).  Saving model ...
Epoch: 2 cost time: 0.7581956386566162
Epoch: 2, Steps: 18 | Train Loss: 2.779 Vali Loss: 2.366 Vali Acc: 0.533 Test Loss: 2.366 Test Acc: 0.533
Validation loss decreased (-0.106637 --> -0.533310).  Saving model ...
Epoch: 3 cost time: 0.7394471168518066
Epoch: 3, Steps: 18 | Train Loss: 2.029 Vali Loss: 1.582 Vali Acc: 0.810 Test Loss: 1.582 Test Acc: 0.810
Validation loss decreased (-0.533310 --> -0.809984).  Saving model ...
Epoch: 4 cost time: 0.8003036975860596
Epoch: 4, Steps: 18 | Train Loss: 1.274 Vali Loss: 0.888 Vali Acc: 0.927 Test Loss: 0.888 Test Acc: 0.927
Validation loss decreased (-0.809984 --> -0.926658).  Saving model ...
Epoch: 5 cost time: 0.8213589191436768
Epoch: 5, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.483 Vali Acc: 0.953 Test Loss: 0.483 Test Acc: 0.953
Validation loss decreased (-0.926658 --> -0.953329).  Saving model ...
Epoch: 6 cost time: 0.7183544635772705
Epoch: 6, Steps: 18 | Train Loss: 0.323 Vali Loss: 0.287 Vali Acc: 0.963 Test Loss: 0.287 Test Acc: 0.963
Validation loss decreased (-0.953329 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.7220067977905273
Epoch: 7, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.213 Vali Acc: 0.967 Test Loss: 0.213 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 0.7277312278747559
Epoch: 8, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.8181817531585693
Epoch: 9, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.8645386695861816
Epoch: 10, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.7746613025665283
Epoch: 11, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7751717567443848
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7454543113708496
Epoch: 13, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7423298358917236
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7697038650512695
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8122825622558594
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8330283164978027
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7662768363952637
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8351061344146729
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7646324634552002
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.759911298751831
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8059587478637695
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7525906562805176
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.6965103149414062
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6734843254089355
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6444132328033447
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.5559055805206299
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6100342273712158
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.6449446678161621
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6259102821350098
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.6304969787597656
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.6670451164245605
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6371521949768066
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6336872577667236
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5836577415466309
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.6097476482391357
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.8173508644104004
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8116528987884521
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.7344257831573486
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.773017406463623
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7780568599700928
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.7471771240234375
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.726006031036377
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.7746832370758057
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.7685503959655762
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.7992908954620361
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7479424476623535
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.7698194980621338
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7555813789367676
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7593657970428467
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.7069733142852783
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.7956814765930176
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.785041332244873
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 0.776019811630249
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 0.768230676651001
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7485346794128418
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7652342319488525
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 0.7785236835479736
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 0.8133561611175537
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 0.7688822746276855
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7715842723846436
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.7603464126586914
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.7327017784118652
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.7802598476409912
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.7862389087677002
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.7700490951538086
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.8041260242462158
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.7706394195556641
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.7957541942596436
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 74713
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8856332302093506
Epoch: 1, Steps: 18 | Train Loss: 3.378 Vali Loss: 3.143 Vali Acc: 0.093 Test Loss: 3.143 Test Acc: 0.093
Validation loss decreased (inf --> -0.093302).  Saving model ...
Epoch: 2 cost time: 0.7624506950378418
Epoch: 2, Steps: 18 | Train Loss: 2.923 Vali Loss: 2.587 Vali Acc: 0.407 Test Loss: 2.587 Test Acc: 0.407
Validation loss decreased (-0.093302 --> -0.406641).  Saving model ...
Epoch: 3 cost time: 0.8010022640228271
Epoch: 3, Steps: 18 | Train Loss: 2.298 Vali Loss: 1.849 Vali Acc: 0.773 Test Loss: 1.849 Test Acc: 0.773
Validation loss decreased (-0.406641 --> -0.773315).  Saving model ...
Epoch: 4 cost time: 0.762244462966919
Epoch: 4, Steps: 18 | Train Loss: 1.541 Vali Loss: 1.120 Vali Acc: 0.933 Test Loss: 1.120 Test Acc: 0.933
Validation loss decreased (-0.773315 --> -0.933322).  Saving model ...
Epoch: 5 cost time: 0.7928764820098877
Epoch: 5, Steps: 18 | Train Loss: 0.867 Vali Loss: 0.628 Vali Acc: 0.947 Test Loss: 0.628 Test Acc: 0.947
Validation loss decreased (-0.933322 --> -0.946660).  Saving model ...
Epoch: 6 cost time: 0.7320446968078613
Epoch: 6, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.365 Vali Acc: 0.963 Test Loss: 0.365 Test Acc: 0.963
Validation loss decreased (-0.946660 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.794745922088623
Epoch: 7, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.256 Vali Acc: 0.970 Test Loss: 0.256 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 0.8072144985198975
Epoch: 8, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.738288164138794
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.788923978805542
Epoch: 10, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7975621223449707
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.7393362522125244
Epoch: 12, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.747075080871582
Epoch: 13, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.7788732051849365
Epoch: 14, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.7403299808502197
Epoch: 15, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.7733094692230225
Epoch: 16, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.7635815143585205
Epoch: 17, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.7844126224517822
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.7957327365875244
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7328124046325684
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7729394435882568
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7439496517181396
Epoch: 22, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7722699642181396
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8655557632446289
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7856953144073486
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7953097820281982
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7732222080230713
Epoch: 27, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7525408267974854
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8379144668579102
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.8211190700531006
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.8438801765441895
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.8098247051239014
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.745187520980835
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7776110172271729
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.7635998725891113
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7491140365600586
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.758685827255249
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8337571620941162
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.8012106418609619
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.7250285148620605
Epoch: 40, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7757673263549805
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.7351047992706299
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.822812557220459
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.8285295963287354
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7788522243499756
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.6688327789306641
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7380311489105225
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.7659635543823242
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.804638147354126
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7760570049285889
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7350254058837891
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.8193295001983643
Epoch: 52, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.791722297668457
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.7661492824554443
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.6652295589447021
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.7131369113922119
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.7316677570343018
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.6902592182159424
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.722987174987793
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.6970453262329102
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.7533037662506104
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.76847243309021
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7326536178588867
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.744401216506958
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.7370684146881104
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.7311151027679443
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 0.724524736404419
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.6875932216644287
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 0.7171802520751953
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.6996700763702393
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7215850353240967
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7390146255493164
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 0.7512447834014893
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 0.6851518154144287
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 0.7316372394561768
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7373757362365723
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7363970279693604
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7642931938171387
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.7702412605285645
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 0.7014307975769043
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 0.7139480113983154
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 0.7906930446624756
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 0.7804756164550781
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7748336791992188
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.765634298324585
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 0.8191876411437988
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 0.741706132888794
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 0.7841300964355469
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7854416370391846
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.8465044498443604
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.778740406036377
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 0.7612974643707275
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.7834734916687012
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.7795305252075195
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.7777297496795654
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.8186402320861816
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.7918548583984375
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.7724688053131104
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 0.7708883285522461
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 0.7467653751373291
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 56825
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0958492755889893
Epoch: 1, Steps: 18 | Train Loss: 3.332 Vali Loss: 3.150 Vali Acc: 0.067 Test Loss: 3.150 Test Acc: 0.067
Validation loss decreased (inf --> -0.066635).  Saving model ...
Epoch: 2 cost time: 0.7717764377593994
Epoch: 2, Steps: 18 | Train Loss: 2.997 Vali Loss: 2.752 Vali Acc: 0.283 Test Loss: 2.752 Test Acc: 0.283
Validation loss decreased (-0.066635 --> -0.283306).  Saving model ...
Epoch: 3 cost time: 0.7703626155853271
Epoch: 3, Steps: 18 | Train Loss: 2.610 Vali Loss: 2.255 Vali Acc: 0.617 Test Loss: 2.255 Test Acc: 0.617
Validation loss decreased (-0.283306 --> -0.616644).  Saving model ...
Epoch: 4 cost time: 0.8121440410614014
Epoch: 4, Steps: 18 | Train Loss: 2.067 Vali Loss: 1.708 Vali Acc: 0.800 Test Loss: 1.708 Test Acc: 0.800
Validation loss decreased (-0.616644 --> -0.799983).  Saving model ...
Epoch: 5 cost time: 0.7426047325134277
Epoch: 5, Steps: 18 | Train Loss: 1.509 Vali Loss: 1.168 Vali Acc: 0.913 Test Loss: 1.168 Test Acc: 0.913
Validation loss decreased (-0.799983 --> -0.913322).  Saving model ...
Epoch: 6 cost time: 0.7527575492858887
Epoch: 6, Steps: 18 | Train Loss: 0.941 Vali Loss: 0.741 Vali Acc: 0.957 Test Loss: 0.741 Test Acc: 0.957
Validation loss decreased (-0.913322 --> -0.956659).  Saving model ...
Epoch: 7 cost time: 0.7473058700561523
Epoch: 7, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.472 Vali Acc: 0.963 Test Loss: 0.472 Test Acc: 0.963
Validation loss decreased (-0.956659 --> -0.963329).  Saving model ...
Epoch: 8 cost time: 0.7539727687835693
Epoch: 8, Steps: 18 | Train Loss: 0.340 Vali Loss: 0.344 Vali Acc: 0.963 Test Loss: 0.344 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963330).  Saving model ...
Epoch: 9 cost time: 0.7325515747070312
Epoch: 9, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.269 Vali Acc: 0.970 Test Loss: 0.269 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969997).  Saving model ...
Epoch: 10 cost time: 0.7732162475585938
Epoch: 10, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.769564151763916
Epoch: 11, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.6963498592376709
Epoch: 12, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.175 Vali Acc: 0.977 Test Loss: 0.175 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7911694049835205
Epoch: 13, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8482916355133057
Epoch: 14, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7569072246551514
Epoch: 15, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7463924884796143
Epoch: 16, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7226848602294922
Epoch: 17, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7717292308807373
Epoch: 18, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8019962310791016
Epoch: 19, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7917318344116211
Epoch: 20, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7678577899932861
Epoch: 21, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8788189888000488
Epoch: 22, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8177103996276855
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.765000581741333
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.811730146408081
Epoch: 25, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7806906700134277
Epoch: 26, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 42537
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0592682361602783
Epoch: 1, Steps: 18 | Train Loss: 3.327 Vali Loss: 3.124 Vali Acc: 0.077 Test Loss: 3.124 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 0.7212002277374268
Epoch: 2, Steps: 18 | Train Loss: 3.022 Vali Loss: 2.740 Vali Acc: 0.270 Test Loss: 2.740 Test Acc: 0.270
Validation loss decreased (-0.076635 --> -0.269973).  Saving model ...
Epoch: 3 cost time: 0.7885088920593262
Epoch: 3, Steps: 18 | Train Loss: 2.610 Vali Loss: 2.252 Vali Acc: 0.597 Test Loss: 2.252 Test Acc: 0.597
Validation loss decreased (-0.269973 --> -0.596644).  Saving model ...
Epoch: 4 cost time: 0.8301925659179688
Epoch: 4, Steps: 18 | Train Loss: 2.081 Vali Loss: 1.704 Vali Acc: 0.840 Test Loss: 1.704 Test Acc: 0.840
Validation loss decreased (-0.596644 --> -0.839983).  Saving model ...
Epoch: 5 cost time: 0.7535240650177002
Epoch: 5, Steps: 18 | Train Loss: 1.497 Vali Loss: 1.179 Vali Acc: 0.927 Test Loss: 1.179 Test Acc: 0.927
Validation loss decreased (-0.839983 --> -0.926655).  Saving model ...
Epoch: 6 cost time: 0.791982889175415
Epoch: 6, Steps: 18 | Train Loss: 1.015 Vali Loss: 0.772 Vali Acc: 0.943 Test Loss: 0.772 Test Acc: 0.943
Validation loss decreased (-0.926655 --> -0.943326).  Saving model ...
Epoch: 7 cost time: 0.7388758659362793
Epoch: 7, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.494 Vali Acc: 0.960 Test Loss: 0.494 Test Acc: 0.960
Validation loss decreased (-0.943326 --> -0.959995).  Saving model ...
Epoch: 8 cost time: 0.8340063095092773
Epoch: 8, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.354 Vali Acc: 0.970 Test Loss: 0.354 Test Acc: 0.970
Validation loss decreased (-0.959995 --> -0.969996).  Saving model ...
Epoch: 9 cost time: 0.7956347465515137
Epoch: 9, Steps: 18 | Train Loss: 0.229 Vali Loss: 0.277 Vali Acc: 0.973 Test Loss: 0.277 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 0.7874150276184082
Epoch: 10, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.717005729675293
Epoch: 11, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.202 Vali Acc: 0.973 Test Loss: 0.202 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 0.7460422515869141
Epoch: 12, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.182 Vali Acc: 0.980 Test Loss: 0.182 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 0.6868987083435059
Epoch: 13, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 14 cost time: 0.71773362159729
Epoch: 14, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 15 cost time: 0.741199254989624
Epoch: 15, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 16 cost time: 0.7031540870666504
Epoch: 16, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.749382495880127
Epoch: 17, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7660236358642578
Epoch: 18, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7831907272338867
Epoch: 19, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7424099445343018
Epoch: 20, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.804434061050415
Epoch: 21, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7581050395965576
Epoch: 22, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.804546594619751
Epoch: 23, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8151276111602783
Epoch: 24, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8116521835327148
Epoch: 25, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.8031034469604492
Epoch: 26, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7333428859710693
Epoch: 27, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8834326267242432
Epoch: 28, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8014621734619141
Epoch: 29, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.737990140914917
Epoch: 30, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7757852077484131
Epoch: 31, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7471063137054443
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7447280883789062
Epoch: 33, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7892119884490967
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7478199005126953
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7192010879516602
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7679412364959717
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7628536224365234
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7559795379638672
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7356700897216797
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7336728572845459
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7123963832855225
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.7422406673431396
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.7968671321868896
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.8978981971740723
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.7580783367156982
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.6793527603149414
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.8132684230804443
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.713134765625
Epoch: 49, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.7907729148864746
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.7668392658233643
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.7816457748413086
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.7473945617675781
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.7806129455566406
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.8378987312316895
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.8021318912506104
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.796797513961792
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.7491023540496826
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.7443838119506836
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.7239856719970703
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.775425910949707
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7972714900970459
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.7561507225036621
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.8324282169342041
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.9905672073364258
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.759575366973877
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 0.8120527267456055
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.62851881980896
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8149814605712891
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.8153355121612549
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8091557025909424
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7794623374938965
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 0.7924346923828125
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 0.7703804969787598
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 0.7612733840942383
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 0.8260116577148438
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 0.8225584030151367
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.8251397609710693
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 0.8045105934143066
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 0.8691563606262207
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 0.8561305999755859
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 0.7996046543121338
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 0.7631287574768066
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 0.8975822925567627
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 0.7676198482513428
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 0.8255460262298584
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.8041820526123047
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 0.7471699714660645
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 89 cost time: 0.7581617832183838
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 90 cost time: 0.7776765823364258
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.8541920185089111
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.8729803562164307
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.7580058574676514
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.8667464256286621
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.7941756248474121
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.8105347156524658
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.7553648948669434
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 98 cost time: 0.7606050968170166
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.7719428539276123
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 0.7547874450683594
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df256_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 39049
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2225589752197266
Epoch: 1, Steps: 18 | Train Loss: 3.192 Vali Loss: 2.392 Vali Acc: 0.613 Test Loss: 2.392 Test Acc: 0.613
Validation loss decreased (inf --> -0.613309).  Saving model ...
Epoch: 2 cost time: 1.0011224746704102
Epoch: 2, Steps: 18 | Train Loss: 1.807 Vali Loss: 0.941 Vali Acc: 0.910 Test Loss: 0.941 Test Acc: 0.910
Validation loss decreased (-0.613309 --> -0.909991).  Saving model ...
Epoch: 3 cost time: 0.9263379573822021
Epoch: 3, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.316 Vali Acc: 0.960 Test Loss: 0.316 Test Acc: 0.960
Validation loss decreased (-0.909991 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 0.9637694358825684
Epoch: 4, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.211 Vali Acc: 0.953 Test Loss: 0.211 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8579084873199463
Epoch: 5, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9022049903869629
Epoch: 6, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.959997 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.9062433242797852
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9409012794494629
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9765503406524658
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 0.9308593273162842
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 0.9264731407165527
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 0.9284472465515137
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 0.967980146408081
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.9657919406890869
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.038484811782837
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9983792304992676
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.9016749858856201
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.0219013690948486
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.0110485553741455
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 0.9541091918945312
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.9427213668823242
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.9244771003723145
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 0.9450571537017822
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.9413607120513916
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 0.9450008869171143
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9806067943572998
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9095942974090576
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9359545707702637
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9688858985900879
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.0545637607574463
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.0367469787597656
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0572681427001953
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.021409511566162
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9608058929443359
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 0.9201741218566895
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9551839828491211
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 0.891549825668335
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 0.9197759628295898
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9650282859802246
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9389395713806152
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9717111587524414
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 0.9111242294311523
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8546922206878662
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 0.9766433238983154
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 0.98030686378479
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 0.9277968406677246
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0111830234527588
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 48 cost time: 0.8641178607940674
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 49 cost time: 0.8972959518432617
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 50 cost time: 0.8618123531341553
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 51 cost time: 0.8756990432739258
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 52 cost time: 0.8140716552734375
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9286131858825684
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7898199558258057
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 55 cost time: 0.8893899917602539
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7865822315216064
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.843285083770752
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8579056262969971
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8422908782958984
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7948131561279297
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9162750244140625
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.881047248840332
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8370983600616455
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 64 cost time: 0.8261334896087646
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9802913665771484
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 66 cost time: 0.8602421283721924
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 67 cost time: 0.8583648204803467
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 68 cost time: 0.7057473659515381
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 69 cost time: 0.8038828372955322
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 70 cost time: 0.8103222846984863
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8904109001159668
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7968568801879883
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9046568870544434
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.8554458618164062
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.8194386959075928
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.8300161361694336
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.9165704250335693
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.9169924259185791
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.9522402286529541
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 80 cost time: 0.9272615909576416
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.9238877296447754
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.8386216163635254
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.9493494033813477
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.9507644176483154
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.9637806415557861
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.9798705577850342
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.7938764095306396
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.9944877624511719
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.9743201732635498
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 264713
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0026636123657227
Epoch: 1, Steps: 18 | Train Loss: 3.164 Vali Loss: 2.694 Vali Acc: 0.373 Test Loss: 2.694 Test Acc: 0.373
Validation loss decreased (inf --> -0.373306).  Saving model ...
Epoch: 2 cost time: 0.8504583835601807
Epoch: 2, Steps: 18 | Train Loss: 2.269 Vali Loss: 1.566 Vali Acc: 0.857 Test Loss: 1.566 Test Acc: 0.857
Validation loss decreased (-0.373306 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 0.8378696441650391
Epoch: 3, Steps: 18 | Train Loss: 1.156 Vali Loss: 0.693 Vali Acc: 0.943 Test Loss: 0.693 Test Acc: 0.943
Validation loss decreased (-0.856651 --> -0.943326).  Saving model ...
Epoch: 4 cost time: 0.801673412322998
Epoch: 4, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.323 Vali Acc: 0.960 Test Loss: 0.323 Test Acc: 0.960
Validation loss decreased (-0.943326 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 0.8241019248962402
Epoch: 5, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 0.8102660179138184
Epoch: 6, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
Validation loss decreased (-0.959998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.7853269577026367
Epoch: 7, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.771477222442627
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.7724344730377197
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.7586507797241211
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.7877371311187744
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7907845973968506
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8220653533935547
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.8188340663909912
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.784156084060669
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8153612613677979
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8475043773651123
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7527875900268555
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7634720802307129
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8147077560424805
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8182559013366699
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7480885982513428
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8303751945495605
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8339278697967529
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7658770084381104
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.8795740604400635
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8218886852264404
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.820734977722168
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.856245756149292
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8302710056304932
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7760562896728516
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7758922576904297
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8021478652954102
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7833528518676758
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7894914150238037
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8056819438934326
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8198704719543457
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7735064029693604
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7941923141479492
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8385698795318604
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8267059326171875
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8444633483886719
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.8051071166992188
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.853187084197998
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.791804313659668
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8483693599700928
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7462387084960938
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.7794241905212402
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8550155162811279
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.7906599044799805
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.8670423030853271
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.7931137084960938
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7814412117004395
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.786529541015625
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.9111566543579102
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8624098300933838
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.895247220993042
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8144946098327637
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7789430618286133
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8939311504364014
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.83467698097229
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.771500825881958
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.7564868927001953
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7351677417755127
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 135177
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0928850173950195
Epoch: 1, Steps: 18 | Train Loss: 3.326 Vali Loss: 2.949 Vali Acc: 0.187 Test Loss: 2.949 Test Acc: 0.187
Validation loss decreased (inf --> -0.186637).  Saving model ...
Epoch: 2 cost time: 0.6316566467285156
Epoch: 2, Steps: 18 | Train Loss: 2.642 Vali Loss: 2.147 Vali Acc: 0.700 Test Loss: 2.147 Test Acc: 0.700
Validation loss decreased (-0.186637 --> -0.699979).  Saving model ...
Epoch: 3 cost time: 0.6699686050415039
Epoch: 3, Steps: 18 | Train Loss: 1.768 Vali Loss: 1.290 Vali Acc: 0.897 Test Loss: 1.290 Test Acc: 0.897
Validation loss decreased (-0.699979 --> -0.896654).  Saving model ...
Epoch: 4 cost time: 0.7154479026794434
Epoch: 4, Steps: 18 | Train Loss: 0.994 Vali Loss: 0.664 Vali Acc: 0.943 Test Loss: 0.664 Test Acc: 0.943
Validation loss decreased (-0.896654 --> -0.943327).  Saving model ...
Epoch: 5 cost time: 0.7471561431884766
Epoch: 5, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.358 Vali Acc: 0.957 Test Loss: 0.358 Test Acc: 0.957
Validation loss decreased (-0.943327 --> -0.956663).  Saving model ...
Epoch: 6 cost time: 0.7683677673339844
Epoch: 6, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
Validation loss decreased (-0.956663 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 0.685192346572876
Epoch: 7, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7638189792633057
Epoch: 8, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.6956577301025391
Epoch: 9, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.7289931774139404
Epoch: 10, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7210144996643066
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7268452644348145
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.7154862880706787
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7401108741760254
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7808566093444824
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7710225582122803
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6746711730957031
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.6391761302947998
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.6634743213653564
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7054729461669922
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6809024810791016
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7029180526733398
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.534904956817627
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.701235294342041
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.6725037097930908
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.6900081634521484
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7525525093078613
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7063815593719482
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.658484697341919
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6639740467071533
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6996946334838867
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7838211059570312
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7238702774047852
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7153027057647705
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7759816646575928
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6649026870727539
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7408356666564941
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7031040191650391
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7243444919586182
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7410433292388916
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.6817502975463867
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7228443622589111
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6975893974304199
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7943916320800781
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7919859886169434
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.723400354385376
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7627787590026855
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.7202727794647217
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.7248601913452148
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7174310684204102
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7405085563659668
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7578907012939453
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.7384097576141357
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7882523536682129
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.7610063552856445
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7713470458984375
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7698609828948975
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.7710714340209961
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.7021708488464355
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.7445237636566162
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.6949436664581299
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7510209083557129
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.7492828369140625
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7454497814178467
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7491869926452637
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.715630292892456
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 0.829308271408081
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7236533164978027
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7645881175994873
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.7421817779541016
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.767094612121582
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7609367370605469
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7166025638580322
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 0.7661032676696777
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 0.7772519588470459
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 0.7148308753967285
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 0.7802536487579346
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.6790676116943359
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.796112060546875
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.7269227504730225
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.793682336807251
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.8105337619781494
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.7516131401062012
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.7407445907592773
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.7488672733306885
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 0.7186229228973389
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 0.7503876686096191
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 0.6869258880615234
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7110929489135742
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.7650167942047119
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.7255492210388184
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.7192888259887695
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.7987775802612305
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 0.8189413547515869
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 0.7167901992797852
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7869131565093994
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.8017816543579102
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 0.7880845069885254
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.7250266075134277
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.7561306953430176
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 92025
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.143662214279175
Epoch: 1, Steps: 18 | Train Loss: 3.241 Vali Loss: 2.978 Vali Acc: 0.207 Test Loss: 2.978 Test Acc: 0.207
Validation loss decreased (inf --> -0.206637).  Saving model ...
Epoch: 2 cost time: 0.7456815242767334
Epoch: 2, Steps: 18 | Train Loss: 2.779 Vali Loss: 2.310 Vali Acc: 0.567 Test Loss: 2.310 Test Acc: 0.567
Validation loss decreased (-0.206637 --> -0.566644).  Saving model ...
Epoch: 3 cost time: 0.7268326282501221
Epoch: 3, Steps: 18 | Train Loss: 2.059 Vali Loss: 1.561 Vali Acc: 0.837 Test Loss: 1.561 Test Acc: 0.837
Validation loss decreased (-0.566644 --> -0.836651).  Saving model ...
Epoch: 4 cost time: 0.751007080078125
Epoch: 4, Steps: 18 | Train Loss: 1.269 Vali Loss: 0.910 Vali Acc: 0.923 Test Loss: 0.910 Test Acc: 0.923
Validation loss decreased (-0.836651 --> -0.923324).  Saving model ...
Epoch: 5 cost time: 0.7329165935516357
Epoch: 5, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.498 Vali Acc: 0.960 Test Loss: 0.498 Test Acc: 0.960
Validation loss decreased (-0.923324 --> -0.959995).  Saving model ...
Epoch: 6 cost time: 0.7099425792694092
Epoch: 6, Steps: 18 | Train Loss: 0.326 Vali Loss: 0.298 Vali Acc: 0.967 Test Loss: 0.298 Test Acc: 0.967
Validation loss decreased (-0.959995 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 0.6988210678100586
Epoch: 7, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.214 Vali Acc: 0.967 Test Loss: 0.214 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 0.8045897483825684
Epoch: 8, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7729065418243408
Epoch: 9, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.7337815761566162
Epoch: 10, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 0.7646558284759521
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.7701823711395264
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.749422550201416
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.715552806854248
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.530238151550293
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.6935379505157471
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7190213203430176
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.68514084815979
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7070608139038086
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7174012660980225
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7148253917694092
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7229242324829102
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.680863618850708
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.6620771884918213
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.777752161026001
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7033467292785645
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7083134651184082
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7498204708099365
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.7119016647338867
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6964445114135742
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7085113525390625
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7645800113677979
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.7934794425964355
Epoch: 33, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7499463558197021
Epoch: 34, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7326455116271973
Epoch: 35, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7072455883026123
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7889249324798584
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7455768585205078
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6643970012664795
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7691066265106201
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6920373439788818
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7268853187561035
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7864925861358643
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 70489
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.199784755706787
Epoch: 1, Steps: 18 | Train Loss: 3.292 Vali Loss: 3.074 Vali Acc: 0.107 Test Loss: 3.074 Test Acc: 0.107
Validation loss decreased (inf --> -0.106636).  Saving model ...
Epoch: 2 cost time: 0.7230291366577148
Epoch: 2, Steps: 18 | Train Loss: 2.902 Vali Loss: 2.538 Vali Acc: 0.407 Test Loss: 2.538 Test Acc: 0.407
Validation loss decreased (-0.106636 --> -0.406641).  Saving model ...
Epoch: 3 cost time: 0.689199686050415
Epoch: 3, Steps: 18 | Train Loss: 2.266 Vali Loss: 1.873 Vali Acc: 0.743 Test Loss: 1.873 Test Acc: 0.743
Validation loss decreased (-0.406641 --> -0.743315).  Saving model ...
Epoch: 4 cost time: 0.6163418292999268
Epoch: 4, Steps: 18 | Train Loss: 1.601 Vali Loss: 1.199 Vali Acc: 0.880 Test Loss: 1.199 Test Acc: 0.880
Validation loss decreased (-0.743315 --> -0.879988).  Saving model ...
Epoch: 5 cost time: 0.7476718425750732
Epoch: 5, Steps: 18 | Train Loss: 0.958 Vali Loss: 0.697 Vali Acc: 0.940 Test Loss: 0.697 Test Acc: 0.940
Validation loss decreased (-0.879988 --> -0.939993).  Saving model ...
Epoch: 6 cost time: 0.738107442855835
Epoch: 6, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.416 Vali Acc: 0.953 Test Loss: 0.416 Test Acc: 0.953
Validation loss decreased (-0.939993 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 0.7249441146850586
Epoch: 7, Steps: 18 | Train Loss: 0.273 Vali Loss: 0.282 Vali Acc: 0.967 Test Loss: 0.282 Test Acc: 0.967
Validation loss decreased (-0.953329 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.7160623073577881
Epoch: 8, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.224 Vali Acc: 0.963 Test Loss: 0.224 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7436835765838623
Epoch: 9, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.723198413848877
Epoch: 10, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7709259986877441
Epoch: 11, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7309796810150146
Epoch: 12, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7151811122894287
Epoch: 13, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.8016653060913086
Epoch: 14, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.7729249000549316
Epoch: 15, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.7517814636230469
Epoch: 16, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.7492773532867432
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.7366933822631836
Epoch: 18, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7093658447265625
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7055714130401611
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7384581565856934
Epoch: 21, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7465822696685791
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7325148582458496
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7338685989379883
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7290441989898682
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.780670166015625
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7612240314483643
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7739970684051514
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.7560722827911377
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.7170822620391846
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.7313237190246582
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7533566951751709
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8076176643371582
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7358264923095703
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.7151384353637695
Epoch: 35, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7510175704956055
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.7008421421051025
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.6944506168365479
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.760056734085083
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.7762236595153809
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7545793056488037
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.7249271869659424
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.7231836318969727
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.7091703414916992
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.6876528263092041
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.721468448638916
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.6863276958465576
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.6895473003387451
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.7683944702148438
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7073266506195068
Epoch: 50, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7490546703338623
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.7775921821594238
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7479109764099121
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 0.7488212585449219
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7268760204315186
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6861295700073242
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 0.7043752670288086
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 0.7054955959320068
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 0.7059824466705322
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 0.7358865737915039
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 0.7189579010009766
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 0.7026903629302979
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 0.7562675476074219
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 0.7720427513122559
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 0.7749764919281006
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7234530448913574
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7710123062133789
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 0.7036025524139404
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7373194694519043
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 0.7099168300628662
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 0.7409689426422119
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 0.7526988983154297
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 0.7120282649993896
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 0.7486567497253418
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7029213905334473
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 0.7081270217895508
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 0.7518384456634521
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 78 cost time: 0.7355325222015381
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7618911266326904
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.7686822414398193
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.7266910076141357
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 0.7480068206787109
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 0.7434923648834229
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 84 cost time: 0.7307860851287842
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 85 cost time: 0.7207443714141846
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 0.660247802734375
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 87 cost time: 0.8052976131439209
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 88 cost time: 0.7242741584777832
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7532205581665039
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.7328066825866699
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 91 cost time: 0.693871021270752
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 92 cost time: 0.6857337951660156
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 93 cost time: 0.6085155010223389
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 94 cost time: 0.6960244178771973
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.7290475368499756
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 96 cost time: 0.6923680305480957
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 97 cost time: 0.6977152824401855
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.704808235168457
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.6731829643249512
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.6874499320983887
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 52601
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.05454683303833
Epoch: 1, Steps: 18 | Train Loss: 3.357 Vali Loss: 3.152 Vali Acc: 0.100 Test Loss: 3.152 Test Acc: 0.100
Validation loss decreased (inf --> -0.099968).  Saving model ...
Epoch: 2 cost time: 0.7390313148498535
Epoch: 2, Steps: 18 | Train Loss: 3.148 Vali Loss: 2.800 Vali Acc: 0.277 Test Loss: 2.800 Test Acc: 0.277
Validation loss decreased (-0.099968 --> -0.276639).  Saving model ...
Epoch: 3 cost time: 0.6499855518341064
Epoch: 3, Steps: 18 | Train Loss: 2.749 Vali Loss: 2.330 Vali Acc: 0.580 Test Loss: 2.330 Test Acc: 0.580
Validation loss decreased (-0.276639 --> -0.579977).  Saving model ...
Epoch: 4 cost time: 0.6835799217224121
Epoch: 4, Steps: 18 | Train Loss: 2.179 Vali Loss: 1.785 Vali Acc: 0.773 Test Loss: 1.785 Test Acc: 0.773
Validation loss decreased (-0.579977 --> -0.773315).  Saving model ...
Epoch: 5 cost time: 0.7148921489715576
Epoch: 5, Steps: 18 | Train Loss: 1.630 Vali Loss: 1.251 Vali Acc: 0.870 Test Loss: 1.251 Test Acc: 0.870
Validation loss decreased (-0.773315 --> -0.869987).  Saving model ...
Epoch: 6 cost time: 0.7338576316833496
Epoch: 6, Steps: 18 | Train Loss: 1.050 Vali Loss: 0.809 Vali Acc: 0.947 Test Loss: 0.809 Test Acc: 0.947
Validation loss decreased (-0.869987 --> -0.946659).  Saving model ...
Epoch: 7 cost time: 0.6980059146881104
Epoch: 7, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.520 Vali Acc: 0.943 Test Loss: 0.520 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6727745532989502
Epoch: 8, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.360 Vali Acc: 0.967 Test Loss: 0.360 Test Acc: 0.967
Validation loss decreased (-0.946659 --> -0.966663).  Saving model ...
Epoch: 9 cost time: 0.6300339698791504
Epoch: 9, Steps: 18 | Train Loss: 0.244 Vali Loss: 0.275 Vali Acc: 0.967 Test Loss: 0.275 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 10 cost time: 0.6448276042938232
Epoch: 10, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 11 cost time: 0.6379404067993164
Epoch: 11, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.6612956523895264
Epoch: 12, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.6990981101989746
Epoch: 13, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 0.6690125465393066
Epoch: 14, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.6994040012359619
Epoch: 15, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.697178840637207
Epoch: 16, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6741361618041992
Epoch: 17, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7306904792785645
Epoch: 18, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5283575057983398
Epoch: 19, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6994132995605469
Epoch: 20, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7055721282958984
Epoch: 21, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6902928352355957
Epoch: 22, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.725924015045166
Epoch: 23, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6682596206665039
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7723448276519775
Epoch: 25, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7149765491485596
Epoch: 26, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7081432342529297
Epoch: 27, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.6708645820617676
Epoch: 28, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.6904897689819336
Epoch: 29, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6910355091094971
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.6845560073852539
Epoch: 31, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.6718897819519043
Epoch: 32, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7534477710723877
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7004818916320801
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7730555534362793
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7482829093933105
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.751828670501709
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.6939387321472168
Epoch: 38, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7116165161132812
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7090260982513428
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7258245944976807
Epoch: 41, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7451245784759521
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.7450902462005615
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.816368818283081
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.6957688331604004
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.7978034019470215
Epoch: 46, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7298583984375
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7819654941558838
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.7049622535705566
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.6966433525085449
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.7157504558563232
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.7515757083892822
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.7383711338043213
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8194153308868408
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7490396499633789
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7741043567657471
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.7550246715545654
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.7592668533325195
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.8496406078338623
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.7679624557495117
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.7951247692108154
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.7928321361541748
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.6871981620788574
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.7569074630737305
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.8030037879943848
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6878037452697754
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6970272064208984
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.7178359031677246
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 0.7439956665039062
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.7251572608947754
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8219656944274902
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 0.8156919479370117
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.8119983673095703
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.8775808811187744
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 0.8738651275634766
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8049860000610352
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 0.8556201457977295
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.8152005672454834
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.8625061511993408
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 0.8134822845458984
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 0.760932445526123
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7725968360900879
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.8774433135986328
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 0.814457893371582
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.8976473808288574
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.9140441417694092
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.8611223697662354
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.8507156372070312
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 0.8014059066772461
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 0.8132457733154297
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 0.844245433807373
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 0.8337540626525879
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.718890905380249
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 0.7935080528259277
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.8451113700866699
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 0.837777853012085
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 0.8335130214691162
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.8582437038421631
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 99 cost time: 0.900334358215332
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.9466872215270996
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 38313
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1125736236572266
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 3.097 Vali Acc: 0.103 Test Loss: 3.097 Test Acc: 0.103
Validation loss decreased (inf --> -0.103302).  Saving model ...
Epoch: 2 cost time: 0.824568510055542
Epoch: 2, Steps: 18 | Train Loss: 2.987 Vali Loss: 2.724 Vali Acc: 0.317 Test Loss: 2.724 Test Acc: 0.317
Validation loss decreased (-0.103302 --> -0.316639).  Saving model ...
Epoch: 3 cost time: 0.8069102764129639
Epoch: 3, Steps: 18 | Train Loss: 2.580 Vali Loss: 2.250 Vali Acc: 0.630 Test Loss: 2.250 Test Acc: 0.630
Validation loss decreased (-0.316639 --> -0.629977).  Saving model ...
Epoch: 4 cost time: 0.7750773429870605
Epoch: 4, Steps: 18 | Train Loss: 2.088 Vali Loss: 1.738 Vali Acc: 0.827 Test Loss: 1.738 Test Acc: 0.827
Validation loss decreased (-0.629977 --> -0.826649).  Saving model ...
Epoch: 5 cost time: 0.727935791015625
Epoch: 5, Steps: 18 | Train Loss: 1.528 Vali Loss: 1.240 Vali Acc: 0.903 Test Loss: 1.240 Test Acc: 0.903
Validation loss decreased (-0.826649 --> -0.903321).  Saving model ...
Epoch: 6 cost time: 0.6775715351104736
Epoch: 6, Steps: 18 | Train Loss: 1.027 Vali Loss: 0.823 Vali Acc: 0.947 Test Loss: 0.823 Test Acc: 0.947
Validation loss decreased (-0.903321 --> -0.946658).  Saving model ...
Epoch: 7 cost time: 0.7557799816131592
Epoch: 7, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.537 Vali Acc: 0.950 Test Loss: 0.537 Test Acc: 0.950
Validation loss decreased (-0.946658 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.7421777248382568
Epoch: 8, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.378 Vali Acc: 0.960 Test Loss: 0.378 Test Acc: 0.960
Validation loss decreased (-0.949995 --> -0.959996).  Saving model ...
Epoch: 9 cost time: 0.6555154323577881
Epoch: 9, Steps: 18 | Train Loss: 0.242 Vali Loss: 0.293 Vali Acc: 0.960 Test Loss: 0.293 Test Acc: 0.960
Validation loss decreased (-0.959996 --> -0.959997).  Saving model ...
Epoch: 10 cost time: 0.7849135398864746
Epoch: 10, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 0.7650480270385742
Epoch: 11, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 12 cost time: 0.753464937210083
Epoch: 12, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.7817673683166504
Epoch: 13, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7684056758880615
Epoch: 14, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7428808212280273
Epoch: 15, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.798004150390625
Epoch: 16, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7605226039886475
Epoch: 17, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.6628026962280273
Epoch: 18, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.6707470417022705
Epoch: 19, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.6704256534576416
Epoch: 20, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6673521995544434
Epoch: 21, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6711857318878174
Epoch: 22, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7497642040252686
Epoch: 23, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7942986488342285
Epoch: 24, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8441381454467773
Epoch: 25, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7692947387695312
Epoch: 26, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7808659076690674
Epoch: 27, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.6909067630767822
Epoch: 28, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7195415496826172
Epoch: 29, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7532567977905273
Epoch: 30, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7732410430908203
Epoch: 31, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8053405284881592
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7902836799621582
Epoch: 33, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7679078578948975
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7589919567108154
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7500200271606445
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7443220615386963
Epoch: 37, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7222900390625
Epoch: 38, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.752983570098877
Epoch: 39, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7172470092773438
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7713623046875
Epoch: 41, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.8113584518432617
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8139886856079102
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.828761100769043
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.7259316444396973
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.7262570858001709
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.8295407295227051
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.800438642501831
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.8124160766601562
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.7552077770233154
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8059742450714111
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.7681841850280762
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.7661933898925781
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7994015216827393
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.8053359985351562
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.8930768966674805
Epoch: 56, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.8003025054931641
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.8341274261474609
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 59 cost time: 0.7843339443206787
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.8175745010375977
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7209196090698242
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.7956094741821289
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.8103291988372803
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.8164947032928467
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.8218197822570801
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.8251137733459473
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 0.7770557403564453
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.8505861759185791
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 0.8391420841217041
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.80535888671875
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 0.7915191650390625
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7607419490814209
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7938334941864014
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 0.772118091583252
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 75 cost time: 0.7860631942749023
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 0.790764331817627
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 77 cost time: 0.8234715461730957
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.8217368125915527
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 0.826030969619751
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 0.7758855819702148
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8189544677734375
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 0.8565845489501953
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 0.6907556056976318
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 0.7750623226165771
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 0.7672567367553711
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 0.7379016876220703
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 0.839238166809082
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.8039417266845703
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 0.8219048976898193
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 0.8149137496948242
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 0.8144054412841797
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 0.8565871715545654
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.8379580974578857
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 0.8319716453552246
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.8876147270202637
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 0.7884483337402344
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 0.8077046871185303
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.7351744174957275
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.7994575500488281
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 0.8529868125915527
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df128_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 34825
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5378880500793457
Epoch: 1, Steps: 18 | Train Loss: 3.119 Vali Loss: 2.358 Vali Acc: 0.603 Test Loss: 2.358 Test Acc: 0.603
Validation loss decreased (inf --> -0.603310).  Saving model ...
Epoch: 2 cost time: 1.173837661743164
Epoch: 2, Steps: 18 | Train Loss: 1.727 Vali Loss: 0.953 Vali Acc: 0.920 Test Loss: 0.953 Test Acc: 0.920
Validation loss decreased (-0.603310 --> -0.919990).  Saving model ...
Epoch: 3 cost time: 1.065518856048584
Epoch: 3, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
Validation loss decreased (-0.919990 --> -0.936663).  Saving model ...
Epoch: 4 cost time: 1.1131353378295898
Epoch: 4, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
Validation loss decreased (-0.936663 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.2447574138641357
Epoch: 5, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1686890125274658
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.2020061016082764
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.2119393348693848
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1631138324737549
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.166628122329712
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.1706643104553223
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.105924129486084
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1253914833068848
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0259177684783936
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0844144821166992
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.1619515419006348
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1776385307312012
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1725366115570068
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.09916090965271
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1573193073272705
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.1706249713897705
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.159571886062622
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.1773500442504883
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.089573621749878
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.1193592548370361
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.2198421955108643
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.1751654148101807
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.235490322113037
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0340261459350586
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.03342866897583
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0447087287902832
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0441443920135498
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9406638145446777
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8458912372589111
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8913471698760986
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8294308185577393
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 262601
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0697906017303467
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 2.756 Vali Acc: 0.307 Test Loss: 2.756 Test Acc: 0.307
Validation loss decreased (inf --> -0.306639).  Saving model ...
Epoch: 2 cost time: 0.7199487686157227
Epoch: 2, Steps: 18 | Train Loss: 2.305 Vali Loss: 1.615 Vali Acc: 0.857 Test Loss: 1.615 Test Acc: 0.857
Validation loss decreased (-0.306639 --> -0.856651).  Saving model ...
Epoch: 3 cost time: 0.6420300006866455
Epoch: 3, Steps: 18 | Train Loss: 1.175 Vali Loss: 0.727 Vali Acc: 0.943 Test Loss: 0.727 Test Acc: 0.943
Validation loss decreased (-0.856651 --> -0.943326).  Saving model ...
Epoch: 4 cost time: 0.73653244972229
Epoch: 4, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.339 Vali Acc: 0.960 Test Loss: 0.339 Test Acc: 0.960
Validation loss decreased (-0.943326 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 0.7436752319335938
Epoch: 5, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.7521793842315674
Epoch: 6, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.777738094329834
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7372317314147949
Epoch: 8, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7994668483734131
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.706718921661377
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8051111698150635
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7208511829376221
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7096631526947021
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6631498336791992
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7366132736206055
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8144598007202148
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7993416786193848
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7362997531890869
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7747995853424072
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7391293048858643
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7350590229034424
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.6541182994842529
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7308659553527832
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7235157489776611
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7232215404510498
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.8069443702697754
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.8844058513641357
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7727108001708984
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.7212913036346436
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.8157048225402832
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.7669863700866699
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.6603207588195801
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7677850723266602
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8017747402191162
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.798588752746582
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8199572563171387
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8571722507476807
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8030226230621338
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7885215282440186
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7634611129760742
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7890598773956299
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7499122619628906
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8111097812652588
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8032684326171875
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7472138404846191
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7356669902801514
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7651903629302979
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8310637474060059
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.881662130355835
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7947297096252441
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 51 cost time: 0.8070604801177979
Epoch: 51, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.7736349105834961
Epoch: 52, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8084878921508789
Epoch: 53, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7677574157714844
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 55 cost time: 0.9046058654785156
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 56 cost time: 0.712540864944458
Epoch: 56, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 57 cost time: 0.7599959373474121
Epoch: 57, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 58 cost time: 0.7505054473876953
Epoch: 58, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7455973625183105
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.7925021648406982
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 61 cost time: 0.7578144073486328
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8823578357696533
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8301160335540771
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.8238518238067627
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7637150287628174
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.7951836585998535
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 0.9627437591552734
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.8292925357818604
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7587664127349854
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.7877264022827148
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 71 cost time: 0.8909132480621338
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 72 cost time: 0.8443310260772705
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 73 cost time: 0.9188616275787354
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.8501617908477783
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8370132446289062
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.8155257701873779
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.7897074222564697
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.801832914352417
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.8239481449127197
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.8177566528320312
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 81 cost time: 0.7707345485687256
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 0.8121955394744873
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 0.8297162055969238
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.8348367214202881
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 0.845604658126831
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7934925556182861
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.834956169128418
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.835883378982544
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.795884370803833
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 0.8344686031341553
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.7926998138427734
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 0.7160830497741699
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.7848358154296875
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 0.826561689376831
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 0.8346929550170898
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7849531173706055
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 0.8269917964935303
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 0.8857359886169434
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.872802734375
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.8649191856384277
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 133065
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.027268409729004
Epoch: 1, Steps: 18 | Train Loss: 3.261 Vali Loss: 2.891 Vali Acc: 0.167 Test Loss: 2.891 Test Acc: 0.167
Validation loss decreased (inf --> -0.166638).  Saving model ...
Epoch: 2 cost time: 0.7772862911224365
Epoch: 2, Steps: 18 | Train Loss: 2.682 Vali Loss: 2.135 Vali Acc: 0.680 Test Loss: 2.135 Test Acc: 0.680
Validation loss decreased (-0.166638 --> -0.679979).  Saving model ...
Epoch: 3 cost time: 0.6468613147735596
Epoch: 3, Steps: 18 | Train Loss: 1.795 Vali Loss: 1.336 Vali Acc: 0.917 Test Loss: 1.336 Test Acc: 0.917
Validation loss decreased (-0.679979 --> -0.916653).  Saving model ...
Epoch: 4 cost time: 0.6762866973876953
Epoch: 4, Steps: 18 | Train Loss: 1.029 Vali Loss: 0.717 Vali Acc: 0.940 Test Loss: 0.717 Test Acc: 0.940
Validation loss decreased (-0.916653 --> -0.939993).  Saving model ...
Epoch: 5 cost time: 0.6602540016174316
Epoch: 5, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.369 Vali Acc: 0.957 Test Loss: 0.369 Test Acc: 0.957
Validation loss decreased (-0.939993 --> -0.956663).  Saving model ...
Epoch: 6 cost time: 0.6829149723052979
Epoch: 6, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.234 Vali Acc: 0.973 Test Loss: 0.234 Test Acc: 0.973
Validation loss decreased (-0.956663 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 0.7196080684661865
Epoch: 7, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7480373382568359
Epoch: 8, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.7799668312072754
Epoch: 9, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.727116584777832
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.7596969604492188
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7527852058410645
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8053493499755859
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.7226698398590088
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7646031379699707
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7044064998626709
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.6994287967681885
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 0.5634915828704834
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7103872299194336
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6835794448852539
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.697643518447876
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6772935390472412
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7285900115966797
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6357448101043701
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.683612585067749
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6968450546264648
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6837368011474609
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 89913
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.781914234161377
Epoch: 1, Steps: 18 | Train Loss: 3.350 Vali Loss: 3.039 Vali Acc: 0.137 Test Loss: 3.039 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 0.6635689735412598
Epoch: 2, Steps: 18 | Train Loss: 2.796 Vali Loss: 2.386 Vali Acc: 0.537 Test Loss: 2.386 Test Acc: 0.537
Validation loss decreased (-0.136636 --> -0.536643).  Saving model ...
Epoch: 3 cost time: 0.6574327945709229
Epoch: 3, Steps: 18 | Train Loss: 2.128 Vali Loss: 1.645 Vali Acc: 0.840 Test Loss: 1.645 Test Acc: 0.840
Validation loss decreased (-0.536643 --> -0.839984).  Saving model ...
Epoch: 4 cost time: 0.669011116027832
Epoch: 4, Steps: 18 | Train Loss: 1.352 Vali Loss: 0.982 Vali Acc: 0.943 Test Loss: 0.982 Test Acc: 0.943
Validation loss decreased (-0.839984 --> -0.943324).  Saving model ...
Epoch: 5 cost time: 0.6814346313476562
Epoch: 5, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.552 Vali Acc: 0.953 Test Loss: 0.552 Test Acc: 0.953
Validation loss decreased (-0.943324 --> -0.953328).  Saving model ...
Epoch: 6 cost time: 0.6954019069671631
Epoch: 6, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.326 Vali Acc: 0.963 Test Loss: 0.326 Test Acc: 0.963
Validation loss decreased (-0.953328 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.5589745044708252
Epoch: 7, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.238 Vali Acc: 0.960 Test Loss: 0.238 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7130370140075684
Epoch: 8, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.6668369770050049
Epoch: 9, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.6591250896453857
Epoch: 10, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.6794371604919434
Epoch: 11, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.656954288482666
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.687366247177124
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.6975131034851074
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7144074440002441
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7007889747619629
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8316605091094971
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7482597827911377
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7463283538818359
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6312274932861328
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.622596025466919
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6768953800201416
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.648240327835083
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 68377
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps22_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.136427402496338
Epoch: 1, Steps: 18 | Train Loss: 3.253 Vali Loss: 3.027 Vali Acc: 0.123 Test Loss: 3.027 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 0.7920355796813965
Epoch: 2, Steps: 18 | Train Loss: 2.896 Vali Loss: 2.527 Vali Acc: 0.463 Test Loss: 2.527 Test Acc: 0.463
Validation loss decreased (-0.123303 --> -0.463308).  Saving model ...
Epoch: 3 cost time: 0.7465305328369141
Epoch: 3, Steps: 18 | Train Loss: 2.284 Vali Loss: 1.892 Vali Acc: 0.777 Test Loss: 1.892 Test Acc: 0.777
Validation loss decreased (-0.463308 --> -0.776648).  Saving model ...
Epoch: 4 cost time: 0.7508945465087891
Epoch: 4, Steps: 18 | Train Loss: 1.591 Vali Loss: 1.248 Vali Acc: 0.913 Test Loss: 1.248 Test Acc: 0.913
Validation loss decreased (-0.776648 --> -0.913321).  Saving model ...
Epoch: 5 cost time: 0.7530555725097656
Epoch: 5, Steps: 18 | Train Loss: 1.003 Vali Loss: 0.716 Vali Acc: 0.947 Test Loss: 0.716 Test Acc: 0.947
Validation loss decreased (-0.913321 --> -0.946660).  Saving model ...
Epoch: 6 cost time: 0.7546772956848145
Epoch: 6, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.413 Vali Acc: 0.970 Test Loss: 0.413 Test Acc: 0.970
Validation loss decreased (-0.946660 --> -0.969996).  Saving model ...
Epoch: 7 cost time: 0.7250049114227295
Epoch: 7, Steps: 18 | Train Loss: 0.270 Vali Loss: 0.268 Vali Acc: 0.977 Test Loss: 0.268 Test Acc: 0.977
Validation loss decreased (-0.969996 --> -0.976664).  Saving model ...
Epoch: 8 cost time: 0.7286972999572754
Epoch: 8, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.210 Vali Acc: 0.977 Test Loss: 0.210 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.7953791618347168
Epoch: 9, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.7583553791046143
Epoch: 10, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.7504444122314453
Epoch: 11, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.7539691925048828
Epoch: 12, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7562885284423828
Epoch: 13, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7032186985015869
Epoch: 14, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7872130870819092
Epoch: 15, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7312467098236084
Epoch: 16, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7534434795379639
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7570154666900635
Epoch: 18, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7679176330566406
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8388068675994873
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8423161506652832
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7438821792602539
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7985749244689941
Epoch: 23, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8088634014129639
Epoch: 24, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.6923623085021973
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7269086837768555
Epoch: 26, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.766160249710083
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7000260353088379
Epoch: 28, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.733834981918335
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7191777229309082
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7431719303131104
Epoch: 31, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7248368263244629
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7240340709686279
Epoch: 33, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.753371000289917
Epoch: 34, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6951014995574951
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7520816326141357
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.717841386795044
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7498466968536377
Epoch: 38, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.8118326663970947
Epoch: 39, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7853090763092041
Epoch: 40, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7536640167236328
Epoch: 41, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7361571788787842
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.735541582107544
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.7330198287963867
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.7121825218200684
Epoch: 45, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.8027760982513428
Epoch: 46, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7714042663574219
Epoch: 47, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.7634844779968262
Epoch: 48, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7685568332672119
Epoch: 49, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6990859508514404
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7260584831237793
Epoch: 51, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 52 cost time: 0.794672966003418
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 53 cost time: 0.70377516746521
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 54 cost time: 0.6777472496032715
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7024269104003906
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7084541320800781
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7674264907836914
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.7820713520050049
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.779066801071167
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 60 cost time: 0.7698040008544922
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7382099628448486
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 62 cost time: 0.7067883014678955
Epoch: 62, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 63 cost time: 0.7282891273498535
Epoch: 63, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 64 cost time: 0.740530252456665
Epoch: 64, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 65 cost time: 0.7016324996948242
Epoch: 65, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 66 cost time: 0.7194089889526367
Epoch: 66, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 67 cost time: 0.7242612838745117
Epoch: 67, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 68 cost time: 0.7210564613342285
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6966738700866699
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.7888131141662598
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7361142635345459
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.6829547882080078
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.734504222869873
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.741551399230957
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7317683696746826
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 76 cost time: 0.6916439533233643
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7444839477539062
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 78 cost time: 0.7962939739227295
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 79 cost time: 0.4856579303741455
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.6635253429412842
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.6987817287445068
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.7028288841247559
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 0.6711492538452148
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6925487518310547
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 0.7036981582641602
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 0.6927680969238281
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 0.6804628372192383
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 0.7269141674041748
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7046012878417969
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 0.6821386814117432
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 0.706998348236084
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.7848379611968994
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.7034385204315186
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.7149770259857178
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.7103376388549805
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 0.7090604305267334
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 0.6774506568908691
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 0.7018787860870361
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.6976780891418457
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 0.6239480972290039
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps22_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 50489
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps29_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.043808698654175
Epoch: 1, Steps: 18 | Train Loss: 3.425 Vali Loss: 3.248 Vali Acc: 0.053 Test Loss: 3.248 Test Acc: 0.053
Validation loss decreased (inf --> -0.053301).  Saving model ...
Epoch: 2 cost time: 0.6982879638671875
Epoch: 2, Steps: 18 | Train Loss: 3.131 Vali Loss: 2.867 Vali Acc: 0.183 Test Loss: 2.867 Test Acc: 0.183
Validation loss decreased (-0.053301 --> -0.183305).  Saving model ...
Epoch: 3 cost time: 0.6776740550994873
Epoch: 3, Steps: 18 | Train Loss: 2.658 Vali Loss: 2.375 Vali Acc: 0.537 Test Loss: 2.375 Test Acc: 0.537
Validation loss decreased (-0.183305 --> -0.536643).  Saving model ...
Epoch: 4 cost time: 0.6616628170013428
Epoch: 4, Steps: 18 | Train Loss: 2.139 Vali Loss: 1.837 Vali Acc: 0.800 Test Loss: 1.837 Test Acc: 0.800
Validation loss decreased (-0.536643 --> -0.799982).  Saving model ...
Epoch: 5 cost time: 0.6984610557556152
Epoch: 5, Steps: 18 | Train Loss: 1.586 Vali Loss: 1.297 Vali Acc: 0.890 Test Loss: 1.297 Test Acc: 0.890
Validation loss decreased (-0.799982 --> -0.889987).  Saving model ...
Epoch: 6 cost time: 0.7326221466064453
Epoch: 6, Steps: 18 | Train Loss: 1.056 Vali Loss: 0.853 Vali Acc: 0.933 Test Loss: 0.853 Test Acc: 0.933
Validation loss decreased (-0.889987 --> -0.933325).  Saving model ...
Epoch: 7 cost time: 0.7269072532653809
Epoch: 7, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.560 Vali Acc: 0.940 Test Loss: 0.560 Test Acc: 0.940
Validation loss decreased (-0.933325 --> -0.939994).  Saving model ...
Epoch: 8 cost time: 0.6813676357269287
Epoch: 8, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.396 Vali Acc: 0.960 Test Loss: 0.396 Test Acc: 0.960
Validation loss decreased (-0.939994 --> -0.959996).  Saving model ...
Epoch: 9 cost time: 0.7249796390533447
Epoch: 9, Steps: 18 | Train Loss: 0.249 Vali Loss: 0.295 Vali Acc: 0.963 Test Loss: 0.295 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963330).  Saving model ...
Epoch: 10 cost time: 0.6371521949768066
Epoch: 10, Steps: 18 | Train Loss: 0.208 Vali Loss: 0.245 Vali Acc: 0.967 Test Loss: 0.245 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 11 cost time: 0.6737563610076904
Epoch: 11, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 0.7246577739715576
Epoch: 12, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 13 cost time: 0.7633962631225586
Epoch: 13, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.6711137294769287
Epoch: 14, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.734978199005127
Epoch: 15, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.7283332347869873
Epoch: 16, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.7950754165649414
Epoch: 17, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.7055070400238037
Epoch: 18, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.713043212890625
Epoch: 19, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.7136831283569336
Epoch: 20, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.6985349655151367
Epoch: 21, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 0.7633004188537598
Epoch: 22, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7015187740325928
Epoch: 23, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7394800186157227
Epoch: 24, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7624907493591309
Epoch: 25, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7284371852874756
Epoch: 26, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.6995198726654053
Epoch: 27, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7353086471557617
Epoch: 28, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.7134978771209717
Epoch: 29, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.7692735195159912
Epoch: 30, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.7352039813995361
Epoch: 31, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7586948871612549
Epoch: 32, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.7279872894287109
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.725632905960083
Epoch: 34, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.7729554176330566
Epoch: 35, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.6670372486114502
Epoch: 36, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.6994497776031494
Epoch: 37, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.7072107791900635
Epoch: 38, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.7525327205657959
Epoch: 39, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.7213151454925537
Epoch: 40, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7269694805145264
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.7693536281585693
Epoch: 42, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.7004461288452148
Epoch: 43, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.7967805862426758
Epoch: 44, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.7147188186645508
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.7535245418548584
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7520825862884521
Epoch: 47, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.7065672874450684
Epoch: 48, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.7022089958190918
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7695221900939941
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.7579925060272217
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.7231378555297852
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.8030803203582764
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 0.7895486354827881
Epoch: 54, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 0.7665939331054688
Epoch: 55, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 0.7866709232330322
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 0.7834324836730957
Epoch: 57, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 0.7673180103302002
Epoch: 58, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 0.7782938480377197
Epoch: 59, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 0.7287468910217285
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7842006683349609
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.7803585529327393
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8027939796447754
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 0.8017184734344482
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 0.7658460140228271
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.784337043762207
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 0.8043978214263916
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 0.7377510070800781
Epoch: 68, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 0.7393112182617188
Epoch: 69, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 0.7680227756500244
Epoch: 70, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.791715145111084
Epoch: 71, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 0.7775816917419434
Epoch: 72, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7088418006896973
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 0.722050666809082
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 0.7690520286560059
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 0.742302656173706
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 0.7461991310119629
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 78 cost time: 0.7813560962677002
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 0.7302398681640625
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 0.758765459060669
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8629424571990967
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 0.8524012565612793
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 0.7411668300628662
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 84 cost time: 0.7345540523529053
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 85 cost time: 0.7534580230712891
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 0.7781298160552979
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.823199987411499
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 0.7702021598815918
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 0.808283805847168
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 0.800133228302002
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 0.7647857666015625
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.7604568004608154
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.7283506393432617
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 0.7868287563323975
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 0.7253012657165527
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.7080731391906738
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 0.7986114025115967
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.760063648223877
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.7407498359680176
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 0.8199691772460938
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps29_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 36201
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps36_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3745834827423096
Epoch: 1, Steps: 18 | Train Loss: 3.431 Vali Loss: 3.210 Vali Acc: 0.080 Test Loss: 3.210 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 0.7890205383300781
Epoch: 2, Steps: 18 | Train Loss: 3.106 Vali Loss: 2.854 Vali Acc: 0.243 Test Loss: 2.854 Test Acc: 0.243
Validation loss decreased (-0.079968 --> -0.243305).  Saving model ...
Epoch: 3 cost time: 0.8812100887298584
Epoch: 3, Steps: 18 | Train Loss: 2.692 Vali Loss: 2.410 Vali Acc: 0.473 Test Loss: 2.410 Test Acc: 0.473
Validation loss decreased (-0.243305 --> -0.473309).  Saving model ...
Epoch: 4 cost time: 0.6947154998779297
Epoch: 4, Steps: 18 | Train Loss: 2.181 Vali Loss: 1.890 Vali Acc: 0.737 Test Loss: 1.890 Test Acc: 0.737
Validation loss decreased (-0.473309 --> -0.736648).  Saving model ...
Epoch: 5 cost time: 0.7022385597229004
Epoch: 5, Steps: 18 | Train Loss: 1.649 Vali Loss: 1.362 Vali Acc: 0.893 Test Loss: 1.362 Test Acc: 0.893
Validation loss decreased (-0.736648 --> -0.893320).  Saving model ...
Epoch: 6 cost time: 0.7688460350036621
Epoch: 6, Steps: 18 | Train Loss: 1.175 Vali Loss: 0.916 Vali Acc: 0.937 Test Loss: 0.916 Test Acc: 0.937
Validation loss decreased (-0.893320 --> -0.936658).  Saving model ...
Epoch: 7 cost time: 0.6806294918060303
Epoch: 7, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.599 Vali Acc: 0.950 Test Loss: 0.599 Test Acc: 0.950
Validation loss decreased (-0.936658 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.7534596920013428
Epoch: 8, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.408 Vali Acc: 0.957 Test Loss: 0.408 Test Acc: 0.957
Validation loss decreased (-0.949994 --> -0.956663).  Saving model ...
Epoch: 9 cost time: 0.602288007736206
Epoch: 9, Steps: 18 | Train Loss: 0.300 Vali Loss: 0.307 Vali Acc: 0.957 Test Loss: 0.307 Test Acc: 0.957
Validation loss decreased (-0.956663 --> -0.956664).  Saving model ...
Epoch: 10 cost time: 0.7830512523651123
Epoch: 10, Steps: 18 | Train Loss: 0.191 Vali Loss: 0.251 Vali Acc: 0.967 Test Loss: 0.251 Test Acc: 0.967
Validation loss decreased (-0.956664 --> -0.966664).  Saving model ...
Epoch: 11 cost time: 0.6945650577545166
Epoch: 11, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.212 Vali Acc: 0.973 Test Loss: 0.212 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 0.7344155311584473
Epoch: 12, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 13 cost time: 0.7497470378875732
Epoch: 13, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7498664855957031
Epoch: 14, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.7283885478973389
Epoch: 15, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.7612981796264648
Epoch: 16, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7018771171569824
Epoch: 17, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7995686531066895
Epoch: 18, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7531688213348389
Epoch: 19, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.6913795471191406
Epoch: 20, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.6979250907897949
Epoch: 21, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.786787748336792
Epoch: 22, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.6871085166931152
Epoch: 23, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.6582062244415283
Epoch: 24, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6659622192382812
Epoch: 25, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7109823226928711
Epoch: 26, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.9322891235351562
Epoch: 27, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7730152606964111
Epoch: 28, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8013176918029785
Epoch: 29, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7246475219726562
Epoch: 30, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.7349295616149902
Epoch: 31, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7902789115905762
Epoch: 32, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.7362210750579834
Epoch: 33, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7975211143493652
Epoch: 34, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.8003137111663818
Epoch: 35, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.8199834823608398
Epoch: 36, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.7590744495391846
Epoch: 37, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.7403092384338379
Epoch: 38, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.805941104888916
Epoch: 39, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.7415075302124023
Epoch: 40, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7958250045776367
Epoch: 41, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.7784626483917236
Epoch: 42, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.7977097034454346
Epoch: 43, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.697239875793457
Epoch: 44, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.7666795253753662
Epoch: 45, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.7631657123565674
Epoch: 46, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7300817966461182
Epoch: 47, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.7532002925872803
Epoch: 48, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.7246129512786865
Epoch: 49, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7337334156036377
Epoch: 50, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.7208807468414307
Epoch: 51, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 52 cost time: 0.736217737197876
Epoch: 52, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.7659552097320557
Epoch: 53, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 54 cost time: 0.822908878326416
Epoch: 54, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 0.7763292789459229
Epoch: 55, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7375626564025879
Epoch: 56, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7350058555603027
Epoch: 57, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 0.7449448108673096
Epoch: 58, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 0.7494180202484131
Epoch: 59, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 60 cost time: 0.7436459064483643
Epoch: 60, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 0.7481958866119385
Epoch: 61, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 0.742084264755249
Epoch: 62, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 0.8338017463684082
Epoch: 63, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7809333801269531
Epoch: 64, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7994773387908936
Epoch: 65, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.783566951751709
Epoch: 66, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 0.7667248249053955
Epoch: 67, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 0.7793440818786621
Epoch: 68, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 0.7508442401885986
Epoch: 69, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 0.7747128009796143
Epoch: 70, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 0.7351565361022949
Epoch: 71, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 0.7338013648986816
Epoch: 72, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7212107181549072
Epoch: 73, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7502570152282715
Epoch: 74, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 0.7708611488342285
Epoch: 75, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 0.7078433036804199
Epoch: 76, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 0.6896219253540039
Epoch: 77, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.7633318901062012
Epoch: 78, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.741661787033081
Epoch: 79, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 80 cost time: 0.7538917064666748
Epoch: 80, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8232860565185547
Epoch: 81, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 82 cost time: 0.797149658203125
Epoch: 82, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 83 cost time: 0.8033161163330078
Epoch: 83, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.8310580253601074
Epoch: 84, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7794938087463379
Epoch: 85, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 0.756782054901123
Epoch: 86, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 0.7323203086853027
Epoch: 87, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.6914236545562744
Epoch: 88, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 0.7714331150054932
Epoch: 89, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 0.7787036895751953
Epoch: 90, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 0.8439891338348389
Epoch: 91, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.8396453857421875
Epoch: 92, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.8058559894561768
Epoch: 93, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 94 cost time: 0.8328447341918945
Epoch: 94, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.784132719039917
Epoch: 95, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.7612807750701904
Epoch: 96, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.7645130157470703
Epoch: 97, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 98 cost time: 0.7339169979095459
Epoch: 98, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 99 cost time: 0.7523403167724609
Epoch: 99, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 100 cost time: 0.7928025722503662
Epoch: 100, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_PatchTST_UEA_ftM_sl144_ll0_pl0_el1_dm16_nh4_df64_ps36_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 32713
model size : 0.44MB
