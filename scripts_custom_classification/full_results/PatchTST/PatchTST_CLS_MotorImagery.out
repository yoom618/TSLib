Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.046821594238281
Epoch: 1, Steps: 18 | Train Loss: 1.437 Vali Loss: 1.184 Vali Acc: 0.620 Test Loss: 1.184 Test Acc: 0.620
Validation loss decreased (inf --> -0.619988).  Saving model ...
Epoch: 2 cost time: 13.941799879074097
Epoch: 2, Steps: 18 | Train Loss: 1.704 Vali Loss: 1.778 Vali Acc: 0.580 Test Loss: 1.778 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.008894205093384
Epoch: 3, Steps: 18 | Train Loss: 3.051 Vali Loss: 8.709 Vali Acc: 0.510 Test Loss: 8.709 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.265172719955444
Epoch: 4, Steps: 18 | Train Loss: 4.742 Vali Loss: 6.943 Vali Acc: 0.550 Test Loss: 6.943 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.606181383132935
Epoch: 5, Steps: 18 | Train Loss: 2.432 Vali Loss: 6.509 Vali Acc: 0.490 Test Loss: 6.509 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 12.48512601852417
Epoch: 6, Steps: 18 | Train Loss: 2.120 Vali Loss: 7.956 Vali Acc: 0.510 Test Loss: 7.956 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 13.620663404464722
Epoch: 7, Steps: 18 | Train Loss: 2.606 Vali Loss: 10.035 Vali Acc: 0.520 Test Loss: 10.035 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 13.132287502288818
Epoch: 8, Steps: 18 | Train Loss: 2.107 Vali Loss: 11.902 Vali Acc: 0.520 Test Loss: 11.902 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 12.88001012802124
Epoch: 9, Steps: 18 | Train Loss: 1.143 Vali Loss: 7.696 Vali Acc: 0.580 Test Loss: 7.696 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 13.277664422988892
Epoch: 10, Steps: 18 | Train Loss: 0.792 Vali Loss: 4.593 Vali Acc: 0.510 Test Loss: 4.593 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 14.069311380386353
Epoch: 11, Steps: 18 | Train Loss: 0.560 Vali Loss: 5.887 Vali Acc: 0.510 Test Loss: 5.887 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1685250
model size : 8.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.467381477355957
Epoch: 1, Steps: 18 | Train Loss: 1.117 Vali Loss: 1.375 Vali Acc: 0.530 Test Loss: 1.375 Test Acc: 0.530
Validation loss decreased (inf --> -0.529986).  Saving model ...
Epoch: 2 cost time: 8.275063037872314
Epoch: 2, Steps: 18 | Train Loss: 1.076 Vali Loss: 2.467 Vali Acc: 0.530 Test Loss: 2.467 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.63520622253418
Epoch: 3, Steps: 18 | Train Loss: 1.735 Vali Loss: 3.507 Vali Acc: 0.480 Test Loss: 3.507 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.400672435760498
Epoch: 4, Steps: 18 | Train Loss: 2.740 Vali Loss: 6.109 Vali Acc: 0.540 Test Loss: 6.109 Test Acc: 0.540
Validation loss decreased (-0.529986 --> -0.539939).  Saving model ...
Epoch: 5 cost time: 8.309549570083618
Epoch: 5, Steps: 18 | Train Loss: 2.002 Vali Loss: 7.771 Vali Acc: 0.540 Test Loss: 7.771 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.406157732009888
Epoch: 6, Steps: 18 | Train Loss: 1.731 Vali Loss: 4.750 Vali Acc: 0.460 Test Loss: 4.750 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.03796911239624
Epoch: 7, Steps: 18 | Train Loss: 1.184 Vali Loss: 4.037 Vali Acc: 0.590 Test Loss: 4.037 Test Acc: 0.590
Validation loss decreased (-0.539939 --> -0.589960).  Saving model ...
Epoch: 8 cost time: 8.038942575454712
Epoch: 8, Steps: 18 | Train Loss: 0.998 Vali Loss: 4.807 Vali Acc: 0.490 Test Loss: 4.807 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.618267059326172
Epoch: 9, Steps: 18 | Train Loss: 0.502 Vali Loss: 5.623 Vali Acc: 0.520 Test Loss: 5.623 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.71268367767334
Epoch: 10, Steps: 18 | Train Loss: 0.630 Vali Loss: 3.255 Vali Acc: 0.590 Test Loss: 3.255 Test Acc: 0.590
Validation loss decreased (-0.589960 --> -0.589967).  Saving model ...
Epoch: 11 cost time: 7.672616243362427
Epoch: 11, Steps: 18 | Train Loss: 0.389 Vali Loss: 5.951 Vali Acc: 0.520 Test Loss: 5.951 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.794198036193848
Epoch: 12, Steps: 18 | Train Loss: 0.560 Vali Loss: 4.306 Vali Acc: 0.570 Test Loss: 4.306 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.545078992843628
Epoch: 13, Steps: 18 | Train Loss: 0.417 Vali Loss: 8.449 Vali Acc: 0.570 Test Loss: 8.449 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.757363319396973
Epoch: 14, Steps: 18 | Train Loss: 0.402 Vali Loss: 6.524 Vali Acc: 0.610 Test Loss: 6.524 Test Acc: 0.610
Validation loss decreased (-0.589967 --> -0.609935).  Saving model ...
Epoch: 15 cost time: 7.917263746261597
Epoch: 15, Steps: 18 | Train Loss: 0.631 Vali Loss: 8.085 Vali Acc: 0.460 Test Loss: 8.085 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.11420202255249
Epoch: 16, Steps: 18 | Train Loss: 0.808 Vali Loss: 6.429 Vali Acc: 0.520 Test Loss: 6.429 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.716134548187256
Epoch: 17, Steps: 18 | Train Loss: 0.733 Vali Loss: 3.751 Vali Acc: 0.540 Test Loss: 3.751 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.661067724227905
Epoch: 18, Steps: 18 | Train Loss: 0.619 Vali Loss: 6.295 Vali Acc: 0.510 Test Loss: 6.295 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.2301976680755615
Epoch: 19, Steps: 18 | Train Loss: 0.339 Vali Loss: 7.516 Vali Acc: 0.550 Test Loss: 7.516 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.29592490196228
Epoch: 20, Steps: 18 | Train Loss: 0.111 Vali Loss: 10.903 Vali Acc: 0.490 Test Loss: 10.903 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.240766286849976
Epoch: 21, Steps: 18 | Train Loss: 0.226 Vali Loss: 12.653 Vali Acc: 0.490 Test Loss: 12.653 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.468904495239258
Epoch: 22, Steps: 18 | Train Loss: 0.398 Vali Loss: 13.682 Vali Acc: 0.470 Test Loss: 13.682 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.562597513198853
Epoch: 23, Steps: 18 | Train Loss: 0.719 Vali Loss: 9.501 Vali Acc: 0.460 Test Loss: 9.501 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.952740430831909
Epoch: 24, Steps: 18 | Train Loss: 0.513 Vali Loss: 11.690 Vali Acc: 0.420 Test Loss: 11.690 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1072258
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.560739040374756
Epoch: 1, Steps: 18 | Train Loss: 1.086 Vali Loss: 2.408 Vali Acc: 0.500 Test Loss: 2.408 Test Acc: 0.500
Validation loss decreased (inf --> -0.499976).  Saving model ...
Epoch: 2 cost time: 5.228173017501831
Epoch: 2, Steps: 18 | Train Loss: 0.963 Vali Loss: 1.821 Vali Acc: 0.590 Test Loss: 1.821 Test Acc: 0.590
Validation loss decreased (-0.499976 --> -0.589982).  Saving model ...
Epoch: 3 cost time: 5.133824110031128
Epoch: 3, Steps: 18 | Train Loss: 1.244 Vali Loss: 2.459 Vali Acc: 0.560 Test Loss: 2.459 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.027552604675293
Epoch: 4, Steps: 18 | Train Loss: 0.922 Vali Loss: 2.187 Vali Acc: 0.490 Test Loss: 2.187 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.0958497524261475
Epoch: 5, Steps: 18 | Train Loss: 0.807 Vali Loss: 1.724 Vali Acc: 0.630 Test Loss: 1.724 Test Acc: 0.630
Validation loss decreased (-0.589982 --> -0.629983).  Saving model ...
Epoch: 6 cost time: 4.912309646606445
Epoch: 6, Steps: 18 | Train Loss: 0.917 Vali Loss: 2.469 Vali Acc: 0.630 Test Loss: 2.469 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.026453256607056
Epoch: 7, Steps: 18 | Train Loss: 1.118 Vali Loss: 3.809 Vali Acc: 0.560 Test Loss: 3.809 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.796414136886597
Epoch: 8, Steps: 18 | Train Loss: 0.906 Vali Loss: 3.573 Vali Acc: 0.550 Test Loss: 3.573 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.647724390029907
Epoch: 9, Steps: 18 | Train Loss: 0.509 Vali Loss: 4.544 Vali Acc: 0.540 Test Loss: 4.544 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.835849285125732
Epoch: 10, Steps: 18 | Train Loss: 0.741 Vali Loss: 4.687 Vali Acc: 0.590 Test Loss: 4.687 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.905137538909912
Epoch: 11, Steps: 18 | Train Loss: 0.506 Vali Loss: 3.245 Vali Acc: 0.570 Test Loss: 3.245 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.282968997955322
Epoch: 12, Steps: 18 | Train Loss: 0.495 Vali Loss: 5.339 Vali Acc: 0.530 Test Loss: 5.339 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.700491666793823
Epoch: 13, Steps: 18 | Train Loss: 0.446 Vali Loss: 6.202 Vali Acc: 0.500 Test Loss: 6.202 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.918896198272705
Epoch: 14, Steps: 18 | Train Loss: 0.282 Vali Loss: 4.897 Vali Acc: 0.560 Test Loss: 4.897 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.427077054977417
Epoch: 15, Steps: 18 | Train Loss: 0.458 Vali Loss: 5.210 Vali Acc: 0.610 Test Loss: 5.210 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 852482
model size : 5.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.170842885971069
Epoch: 1, Steps: 18 | Train Loss: 0.981 Vali Loss: 1.015 Vali Acc: 0.450 Test Loss: 1.015 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 3.699591636657715
Epoch: 2, Steps: 18 | Train Loss: 1.036 Vali Loss: 1.821 Vali Acc: 0.580 Test Loss: 1.821 Test Acc: 0.580
Validation loss decreased (-0.449990 --> -0.579982).  Saving model ...
Epoch: 3 cost time: 3.9552910327911377
Epoch: 3, Steps: 18 | Train Loss: 0.778 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.183898448944092
Epoch: 4, Steps: 18 | Train Loss: 0.757 Vali Loss: 1.613 Vali Acc: 0.500 Test Loss: 1.613 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9280943870544434
Epoch: 5, Steps: 18 | Train Loss: 0.596 Vali Loss: 1.913 Vali Acc: 0.610 Test Loss: 1.913 Test Acc: 0.610
Validation loss decreased (-0.579982 --> -0.609981).  Saving model ...
Epoch: 6 cost time: 3.8095152378082275
Epoch: 6, Steps: 18 | Train Loss: 1.224 Vali Loss: 2.299 Vali Acc: 0.620 Test Loss: 2.299 Test Acc: 0.620
Validation loss decreased (-0.609981 --> -0.619977).  Saving model ...
Epoch: 7 cost time: 3.736931562423706
Epoch: 7, Steps: 18 | Train Loss: 0.869 Vali Loss: 3.158 Vali Acc: 0.580 Test Loss: 3.158 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7171554565429688
Epoch: 8, Steps: 18 | Train Loss: 0.817 Vali Loss: 3.115 Vali Acc: 0.570 Test Loss: 3.115 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4929745197296143
Epoch: 9, Steps: 18 | Train Loss: 0.504 Vali Loss: 3.771 Vali Acc: 0.550 Test Loss: 3.771 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.415113210678101
Epoch: 10, Steps: 18 | Train Loss: 1.127 Vali Loss: 4.944 Vali Acc: 0.480 Test Loss: 4.944 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.224653482437134
Epoch: 11, Steps: 18 | Train Loss: 0.504 Vali Loss: 6.796 Vali Acc: 0.440 Test Loss: 6.796 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.095509052276611
Epoch: 12, Steps: 18 | Train Loss: 0.552 Vali Loss: 6.597 Vali Acc: 0.520 Test Loss: 6.597 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.138027667999268
Epoch: 13, Steps: 18 | Train Loss: 0.439 Vali Loss: 7.407 Vali Acc: 0.480 Test Loss: 7.407 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.21297550201416
Epoch: 14, Steps: 18 | Train Loss: 1.108 Vali Loss: 6.859 Vali Acc: 0.480 Test Loss: 6.859 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.262439012527466
Epoch: 15, Steps: 18 | Train Loss: 0.475 Vali Loss: 8.741 Vali Acc: 0.490 Test Loss: 8.741 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.1016435623168945
Epoch: 16, Steps: 18 | Train Loss: 0.471 Vali Loss: 7.021 Vali Acc: 0.460 Test Loss: 7.021 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 763778
model size : 5.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.687835216522217
Epoch: 1, Steps: 18 | Train Loss: 0.789 Vali Loss: 0.797 Vali Acc: 0.590 Test Loss: 0.797 Test Acc: 0.590
Validation loss decreased (inf --> -0.589992).  Saving model ...
Epoch: 2 cost time: 2.99322247505188
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.938 Vali Acc: 0.560 Test Loss: 0.938 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.977191209793091
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.994323253631592
Epoch: 4, Steps: 18 | Train Loss: 0.624 Vali Loss: 1.274 Vali Acc: 0.540 Test Loss: 1.274 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.012448787689209
Epoch: 5, Steps: 18 | Train Loss: 0.461 Vali Loss: 2.231 Vali Acc: 0.550 Test Loss: 2.231 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2795779705047607
Epoch: 6, Steps: 18 | Train Loss: 0.591 Vali Loss: 2.275 Vali Acc: 0.480 Test Loss: 2.275 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.355635643005371
Epoch: 7, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.829 Vali Acc: 0.540 Test Loss: 1.829 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.170112371444702
Epoch: 8, Steps: 18 | Train Loss: 0.672 Vali Loss: 2.894 Vali Acc: 0.510 Test Loss: 2.894 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0077877044677734
Epoch: 9, Steps: 18 | Train Loss: 0.451 Vali Loss: 3.143 Vali Acc: 0.520 Test Loss: 3.143 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.227027654647827
Epoch: 10, Steps: 18 | Train Loss: 0.548 Vali Loss: 3.538 Vali Acc: 0.500 Test Loss: 3.538 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.5285191535949707
Epoch: 11, Steps: 18 | Train Loss: 0.534 Vali Loss: 4.124 Vali Acc: 0.480 Test Loss: 4.124 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 668290
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.322571516036987
Epoch: 1, Steps: 18 | Train Loss: 0.888 Vali Loss: 1.107 Vali Acc: 0.520 Test Loss: 1.107 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 2.785393238067627
Epoch: 2, Steps: 18 | Train Loss: 0.716 Vali Loss: 1.082 Vali Acc: 0.540 Test Loss: 1.082 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 3 cost time: 2.860386371612549
Epoch: 3, Steps: 18 | Train Loss: 0.749 Vali Loss: 1.144 Vali Acc: 0.530 Test Loss: 1.144 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.938666343688965
Epoch: 4, Steps: 18 | Train Loss: 0.544 Vali Loss: 1.083 Vali Acc: 0.600 Test Loss: 1.083 Test Acc: 0.600
Validation loss decreased (-0.539989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 2.774909019470215
Epoch: 5, Steps: 18 | Train Loss: 0.491 Vali Loss: 1.344 Vali Acc: 0.510 Test Loss: 1.344 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7309203147888184
Epoch: 6, Steps: 18 | Train Loss: 0.506 Vali Loss: 1.450 Vali Acc: 0.500 Test Loss: 1.450 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8865604400634766
Epoch: 7, Steps: 18 | Train Loss: 0.515 Vali Loss: 1.876 Vali Acc: 0.510 Test Loss: 1.876 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.505502462387085
Epoch: 8, Steps: 18 | Train Loss: 0.329 Vali Loss: 2.883 Vali Acc: 0.500 Test Loss: 2.883 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.559598207473755
Epoch: 9, Steps: 18 | Train Loss: 0.578 Vali Loss: 1.955 Vali Acc: 0.490 Test Loss: 1.955 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.692228317260742
Epoch: 10, Steps: 18 | Train Loss: 0.576 Vali Loss: 2.355 Vali Acc: 0.580 Test Loss: 2.355 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5711636543273926
Epoch: 11, Steps: 18 | Train Loss: 0.449 Vali Loss: 3.194 Vali Acc: 0.560 Test Loss: 3.194 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6653592586517334
Epoch: 12, Steps: 18 | Train Loss: 0.309 Vali Loss: 3.958 Vali Acc: 0.490 Test Loss: 3.958 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.796548366546631
Epoch: 13, Steps: 18 | Train Loss: 0.413 Vali Loss: 3.603 Vali Acc: 0.570 Test Loss: 3.603 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.649674892425537
Epoch: 14, Steps: 18 | Train Loss: 0.290 Vali Loss: 3.934 Vali Acc: 0.490 Test Loss: 3.934 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 638338
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.143945932388306
Epoch: 1, Steps: 18 | Train Loss: 0.836 Vali Loss: 0.808 Vali Acc: 0.550 Test Loss: 0.808 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 2.5107815265655518
Epoch: 2, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2580573558807373
Epoch: 3, Steps: 18 | Train Loss: 0.776 Vali Loss: 0.936 Vali Acc: 0.590 Test Loss: 0.936 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589991).  Saving model ...
Epoch: 4 cost time: 2.2842180728912354
Epoch: 4, Steps: 18 | Train Loss: 0.838 Vali Loss: 1.507 Vali Acc: 0.530 Test Loss: 1.507 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6346216201782227
Epoch: 5, Steps: 18 | Train Loss: 0.604 Vali Loss: 1.321 Vali Acc: 0.470 Test Loss: 1.321 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6345162391662598
Epoch: 6, Steps: 18 | Train Loss: 0.420 Vali Loss: 2.258 Vali Acc: 0.460 Test Loss: 2.258 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.63806414604187
Epoch: 7, Steps: 18 | Train Loss: 0.492 Vali Loss: 2.060 Vali Acc: 0.550 Test Loss: 2.060 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4198596477508545
Epoch: 8, Steps: 18 | Train Loss: 0.349 Vali Loss: 2.037 Vali Acc: 0.550 Test Loss: 2.037 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.37957501411438
Epoch: 9, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.963 Vali Acc: 0.490 Test Loss: 1.963 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.427823305130005
Epoch: 10, Steps: 18 | Train Loss: 0.418 Vali Loss: 2.194 Vali Acc: 0.530 Test Loss: 2.194 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4712202548980713
Epoch: 11, Steps: 18 | Train Loss: 0.365 Vali Loss: 2.222 Vali Acc: 0.580 Test Loss: 2.222 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4811153411865234
Epoch: 12, Steps: 18 | Train Loss: 0.307 Vali Loss: 2.730 Vali Acc: 0.520 Test Loss: 2.730 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4728379249572754
Epoch: 13, Steps: 18 | Train Loss: 0.314 Vali Loss: 3.772 Vali Acc: 0.530 Test Loss: 3.772 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 624770
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.1682710647583
Epoch: 1, Steps: 18 | Train Loss: 1.954 Vali Loss: 3.393 Vali Acc: 0.460 Test Loss: 3.393 Test Acc: 0.460
Validation loss decreased (inf --> -0.459966).  Saving model ...
Epoch: 2 cost time: 12.839484691619873
Epoch: 2, Steps: 18 | Train Loss: 2.530 Vali Loss: 3.688 Vali Acc: 0.610 Test Loss: 3.688 Test Acc: 0.610
Validation loss decreased (-0.459966 --> -0.609963).  Saving model ...
Epoch: 3 cost time: 13.99527645111084
Epoch: 3, Steps: 18 | Train Loss: 2.775 Vali Loss: 5.339 Vali Acc: 0.500 Test Loss: 5.339 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.266419172286987
Epoch: 4, Steps: 18 | Train Loss: 2.533 Vali Loss: 7.898 Vali Acc: 0.560 Test Loss: 7.898 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 13.527738571166992
Epoch: 5, Steps: 18 | Train Loss: 2.683 Vali Loss: 9.994 Vali Acc: 0.530 Test Loss: 9.994 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 13.684329748153687
Epoch: 6, Steps: 18 | Train Loss: 2.366 Vali Loss: 14.826 Vali Acc: 0.530 Test Loss: 14.826 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 13.010002374649048
Epoch: 7, Steps: 18 | Train Loss: 2.076 Vali Loss: 9.050 Vali Acc: 0.520 Test Loss: 9.050 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 13.35320496559143
Epoch: 8, Steps: 18 | Train Loss: 1.310 Vali Loss: 8.605 Vali Acc: 0.530 Test Loss: 8.605 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 13.161407709121704
Epoch: 9, Steps: 18 | Train Loss: 3.457 Vali Loss: 9.066 Vali Acc: 0.530 Test Loss: 9.066 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 13.757238388061523
Epoch: 10, Steps: 18 | Train Loss: 1.158 Vali Loss: 7.998 Vali Acc: 0.530 Test Loss: 7.998 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 12.320660591125488
Epoch: 11, Steps: 18 | Train Loss: 3.225 Vali Loss: 11.334 Vali Acc: 0.510 Test Loss: 11.334 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.167671918869019
Epoch: 12, Steps: 18 | Train Loss: 1.734 Vali Loss: 3.829 Vali Acc: 0.530 Test Loss: 3.829 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1586562
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.716108798980713
Epoch: 1, Steps: 18 | Train Loss: 1.007 Vali Loss: 1.014 Vali Acc: 0.560 Test Loss: 1.014 Test Acc: 0.560
Validation loss decreased (inf --> -0.559990).  Saving model ...
Epoch: 2 cost time: 5.622605800628662
Epoch: 2, Steps: 18 | Train Loss: 1.205 Vali Loss: 3.411 Vali Acc: 0.600 Test Loss: 3.411 Test Acc: 0.600
Validation loss decreased (-0.559990 --> -0.599966).  Saving model ...
Epoch: 3 cost time: 6.0848708152771
Epoch: 3, Steps: 18 | Train Loss: 1.308 Vali Loss: 2.294 Vali Acc: 0.540 Test Loss: 2.294 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.949084520339966
Epoch: 4, Steps: 18 | Train Loss: 1.098 Vali Loss: 3.104 Vali Acc: 0.550 Test Loss: 3.104 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.340550661087036
Epoch: 5, Steps: 18 | Train Loss: 1.126 Vali Loss: 4.599 Vali Acc: 0.520 Test Loss: 4.599 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.114360332489014
Epoch: 6, Steps: 18 | Train Loss: 1.500 Vali Loss: 4.140 Vali Acc: 0.450 Test Loss: 4.140 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.529892921447754
Epoch: 7, Steps: 18 | Train Loss: 1.333 Vali Loss: 6.313 Vali Acc: 0.530 Test Loss: 6.313 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.7312774658203125
Epoch: 8, Steps: 18 | Train Loss: 2.046 Vali Loss: 5.865 Vali Acc: 0.510 Test Loss: 5.865 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.772420167922974
Epoch: 9, Steps: 18 | Train Loss: 1.356 Vali Loss: 6.492 Vali Acc: 0.550 Test Loss: 6.492 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.373899459838867
Epoch: 10, Steps: 18 | Train Loss: 1.122 Vali Loss: 5.178 Vali Acc: 0.570 Test Loss: 5.178 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.545937538146973
Epoch: 11, Steps: 18 | Train Loss: 1.030 Vali Loss: 6.308 Vali Acc: 0.620 Test Loss: 6.308 Test Acc: 0.620
Validation loss decreased (-0.599966 --> -0.619937).  Saving model ...
Epoch: 12 cost time: 6.775779485702515
Epoch: 12, Steps: 18 | Train Loss: 1.030 Vali Loss: 7.502 Vali Acc: 0.500 Test Loss: 7.502 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.8182408809661865
Epoch: 13, Steps: 18 | Train Loss: 0.326 Vali Loss: 9.291 Vali Acc: 0.520 Test Loss: 9.291 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.782306432723999
Epoch: 14, Steps: 18 | Train Loss: 0.709 Vali Loss: 8.068 Vali Acc: 0.510 Test Loss: 8.068 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.768601655960083
Epoch: 15, Steps: 18 | Train Loss: 0.407 Vali Loss: 9.334 Vali Acc: 0.530 Test Loss: 9.334 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.691529273986816
Epoch: 16, Steps: 18 | Train Loss: 0.269 Vali Loss: 7.672 Vali Acc: 0.570 Test Loss: 7.672 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.688860654830933
Epoch: 17, Steps: 18 | Train Loss: 0.538 Vali Loss: 7.068 Vali Acc: 0.560 Test Loss: 7.068 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.245623350143433
Epoch: 18, Steps: 18 | Train Loss: 0.308 Vali Loss: 14.833 Vali Acc: 0.500 Test Loss: 14.833 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.870753288269043
Epoch: 19, Steps: 18 | Train Loss: 0.526 Vali Loss: 13.701 Vali Acc: 0.500 Test Loss: 13.701 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.0486578941345215
Epoch: 20, Steps: 18 | Train Loss: 0.141 Vali Loss: 12.554 Vali Acc: 0.510 Test Loss: 12.554 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.24858832359314
Epoch: 21, Steps: 18 | Train Loss: 0.371 Vali Loss: 12.102 Vali Acc: 0.500 Test Loss: 12.102 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 973570
model size : 6.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.532358884811401
Epoch: 1, Steps: 18 | Train Loss: 0.893 Vali Loss: 0.981 Vali Acc: 0.590 Test Loss: 0.981 Test Acc: 0.590
Validation loss decreased (inf --> -0.589990).  Saving model ...
Epoch: 2 cost time: 4.433716535568237
Epoch: 2, Steps: 18 | Train Loss: 0.799 Vali Loss: 1.756 Vali Acc: 0.480 Test Loss: 1.756 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.595181941986084
Epoch: 3, Steps: 18 | Train Loss: 0.918 Vali Loss: 1.775 Vali Acc: 0.540 Test Loss: 1.775 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.355825901031494
Epoch: 4, Steps: 18 | Train Loss: 0.845 Vali Loss: 2.267 Vali Acc: 0.530 Test Loss: 2.267 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.284798860549927
Epoch: 5, Steps: 18 | Train Loss: 1.065 Vali Loss: 4.304 Vali Acc: 0.460 Test Loss: 4.304 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.5026795864105225
Epoch: 6, Steps: 18 | Train Loss: 1.537 Vali Loss: 3.068 Vali Acc: 0.500 Test Loss: 3.068 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.367701768875122
Epoch: 7, Steps: 18 | Train Loss: 0.780 Vali Loss: 3.999 Vali Acc: 0.570 Test Loss: 3.999 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.483688116073608
Epoch: 8, Steps: 18 | Train Loss: 0.924 Vali Loss: 3.131 Vali Acc: 0.550 Test Loss: 3.131 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.293691158294678
Epoch: 9, Steps: 18 | Train Loss: 0.967 Vali Loss: 4.010 Vali Acc: 0.550 Test Loss: 4.010 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.675772190093994
Epoch: 10, Steps: 18 | Train Loss: 1.124 Vali Loss: 4.245 Vali Acc: 0.450 Test Loss: 4.245 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.894533157348633
Epoch: 11, Steps: 18 | Train Loss: 0.633 Vali Loss: 6.192 Vali Acc: 0.500 Test Loss: 6.192 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 753794
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.78456449508667
Epoch: 1, Steps: 18 | Train Loss: 0.907 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 2.995091438293457
Epoch: 2, Steps: 18 | Train Loss: 1.418 Vali Loss: 1.689 Vali Acc: 0.610 Test Loss: 1.689 Test Acc: 0.610
Validation loss decreased (-0.479988 --> -0.609983).  Saving model ...
Epoch: 3 cost time: 3.4294397830963135
Epoch: 3, Steps: 18 | Train Loss: 0.863 Vali Loss: 1.421 Vali Acc: 0.520 Test Loss: 1.421 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.249251365661621
Epoch: 4, Steps: 18 | Train Loss: 0.755 Vali Loss: 2.214 Vali Acc: 0.520 Test Loss: 2.214 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.993109941482544
Epoch: 5, Steps: 18 | Train Loss: 0.744 Vali Loss: 2.559 Vali Acc: 0.500 Test Loss: 2.559 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.017050266265869
Epoch: 6, Steps: 18 | Train Loss: 0.776 Vali Loss: 2.929 Vali Acc: 0.540 Test Loss: 2.929 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.011390209197998
Epoch: 7, Steps: 18 | Train Loss: 0.905 Vali Loss: 3.633 Vali Acc: 0.550 Test Loss: 3.633 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.885493755340576
Epoch: 8, Steps: 18 | Train Loss: 0.742 Vali Loss: 4.521 Vali Acc: 0.540 Test Loss: 4.521 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.8415188789367676
Epoch: 9, Steps: 18 | Train Loss: 1.296 Vali Loss: 4.193 Vali Acc: 0.520 Test Loss: 4.193 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.010110139846802
Epoch: 10, Steps: 18 | Train Loss: 0.371 Vali Loss: 4.240 Vali Acc: 0.530 Test Loss: 4.240 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.848327398300171
Epoch: 11, Steps: 18 | Train Loss: 0.513 Vali Loss: 5.620 Vali Acc: 0.520 Test Loss: 5.620 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.602752447128296
Epoch: 12, Steps: 18 | Train Loss: 0.578 Vali Loss: 7.020 Vali Acc: 0.530 Test Loss: 7.020 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 665090
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.533286809921265
Epoch: 1, Steps: 18 | Train Loss: 0.849 Vali Loss: 0.963 Vali Acc: 0.530 Test Loss: 0.963 Test Acc: 0.530
Validation loss decreased (inf --> -0.529990).  Saving model ...
Epoch: 2 cost time: 3.01401686668396
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.811 Vali Acc: 0.590 Test Loss: 0.811 Test Acc: 0.590
Validation loss decreased (-0.529990 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 2.8977363109588623
Epoch: 3, Steps: 18 | Train Loss: 0.662 Vali Loss: 1.083 Vali Acc: 0.580 Test Loss: 1.083 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.891066789627075
Epoch: 4, Steps: 18 | Train Loss: 0.493 Vali Loss: 1.418 Vali Acc: 0.560 Test Loss: 1.418 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.169344186782837
Epoch: 5, Steps: 18 | Train Loss: 0.881 Vali Loss: 1.767 Vali Acc: 0.630 Test Loss: 1.767 Test Acc: 0.630
Validation loss decreased (-0.589992 --> -0.629982).  Saving model ...
Epoch: 6 cost time: 3.04535174369812
Epoch: 6, Steps: 18 | Train Loss: 0.804 Vali Loss: 1.629 Vali Acc: 0.590 Test Loss: 1.629 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.102252960205078
Epoch: 7, Steps: 18 | Train Loss: 1.046 Vali Loss: 2.042 Vali Acc: 0.460 Test Loss: 2.042 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.126866102218628
Epoch: 8, Steps: 18 | Train Loss: 0.365 Vali Loss: 3.265 Vali Acc: 0.530 Test Loss: 3.265 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0310254096984863
Epoch: 9, Steps: 18 | Train Loss: 0.454 Vali Loss: 3.472 Vali Acc: 0.520 Test Loss: 3.472 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.017104148864746
Epoch: 10, Steps: 18 | Train Loss: 0.432 Vali Loss: 3.740 Vali Acc: 0.470 Test Loss: 3.740 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1453614234924316
Epoch: 11, Steps: 18 | Train Loss: 0.515 Vali Loss: 3.622 Vali Acc: 0.490 Test Loss: 3.622 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0421674251556396
Epoch: 12, Steps: 18 | Train Loss: 0.747 Vali Loss: 4.827 Vali Acc: 0.550 Test Loss: 4.827 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.1954526901245117
Epoch: 13, Steps: 18 | Train Loss: 0.477 Vali Loss: 3.831 Vali Acc: 0.570 Test Loss: 3.831 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1147608757019043
Epoch: 14, Steps: 18 | Train Loss: 0.656 Vali Loss: 4.947 Vali Acc: 0.510 Test Loss: 4.947 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.00583815574646
Epoch: 15, Steps: 18 | Train Loss: 0.231 Vali Loss: 4.500 Vali Acc: 0.520 Test Loss: 4.500 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 569602
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.149566411972046
Epoch: 1, Steps: 18 | Train Loss: 0.852 Vali Loss: 0.769 Vali Acc: 0.520 Test Loss: 0.769 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.1409711837768555
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.911 Vali Acc: 0.520 Test Loss: 0.911 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2695019245147705
Epoch: 3, Steps: 18 | Train Loss: 0.647 Vali Loss: 1.163 Vali Acc: 0.550 Test Loss: 1.163 Test Acc: 0.550
Validation loss decreased (-0.519992 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 2.6614484786987305
Epoch: 4, Steps: 18 | Train Loss: 0.640 Vali Loss: 1.483 Vali Acc: 0.520 Test Loss: 1.483 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3836216926574707
Epoch: 5, Steps: 18 | Train Loss: 0.655 Vali Loss: 2.255 Vali Acc: 0.440 Test Loss: 2.255 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.486520290374756
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.203 Vali Acc: 0.570 Test Loss: 1.203 Test Acc: 0.570
Validation loss decreased (-0.549988 --> -0.569988).  Saving model ...
Epoch: 7 cost time: 2.3601815700531006
Epoch: 7, Steps: 18 | Train Loss: 0.420 Vali Loss: 1.654 Vali Acc: 0.510 Test Loss: 1.654 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.568527936935425
Epoch: 8, Steps: 18 | Train Loss: 0.562 Vali Loss: 1.674 Vali Acc: 0.570 Test Loss: 1.674 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6585495471954346
Epoch: 9, Steps: 18 | Train Loss: 0.448 Vali Loss: 2.576 Vali Acc: 0.570 Test Loss: 2.576 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.437052011489868
Epoch: 10, Steps: 18 | Train Loss: 0.501 Vali Loss: 4.128 Vali Acc: 0.460 Test Loss: 4.128 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.375927209854126
Epoch: 11, Steps: 18 | Train Loss: 0.477 Vali Loss: 2.114 Vali Acc: 0.540 Test Loss: 2.114 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.473586082458496
Epoch: 12, Steps: 18 | Train Loss: 0.272 Vali Loss: 2.509 Vali Acc: 0.590 Test Loss: 2.509 Test Acc: 0.590
Validation loss decreased (-0.569988 --> -0.589975).  Saving model ...
Epoch: 13 cost time: 2.3677568435668945
Epoch: 13, Steps: 18 | Train Loss: 0.407 Vali Loss: 4.588 Vali Acc: 0.460 Test Loss: 4.588 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5650641918182373
Epoch: 14, Steps: 18 | Train Loss: 0.283 Vali Loss: 3.339 Vali Acc: 0.520 Test Loss: 3.339 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.42264723777771
Epoch: 15, Steps: 18 | Train Loss: 0.166 Vali Loss: 3.982 Vali Acc: 0.480 Test Loss: 3.982 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4619648456573486
Epoch: 16, Steps: 18 | Train Loss: 0.337 Vali Loss: 4.598 Vali Acc: 0.480 Test Loss: 4.598 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6135284900665283
Epoch: 17, Steps: 18 | Train Loss: 0.257 Vali Loss: 3.852 Vali Acc: 0.550 Test Loss: 3.852 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6656110286712646
Epoch: 18, Steps: 18 | Train Loss: 0.210 Vali Loss: 5.033 Vali Acc: 0.470 Test Loss: 5.033 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.607391834259033
Epoch: 19, Steps: 18 | Train Loss: 0.215 Vali Loss: 6.092 Vali Acc: 0.470 Test Loss: 6.092 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6182875633239746
Epoch: 20, Steps: 18 | Train Loss: 0.264 Vali Loss: 6.798 Vali Acc: 0.490 Test Loss: 6.798 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.468383312225342
Epoch: 21, Steps: 18 | Train Loss: 0.055 Vali Loss: 6.836 Vali Acc: 0.470 Test Loss: 6.836 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5818803310394287
Epoch: 22, Steps: 18 | Train Loss: 0.165 Vali Loss: 5.078 Vali Acc: 0.480 Test Loss: 5.078 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 539650
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.070122003555298
Epoch: 1, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.747 Vali Acc: 0.540 Test Loss: 0.747 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.3981010913848877
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.848 Vali Acc: 0.500 Test Loss: 0.848 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3576934337615967
Epoch: 3, Steps: 18 | Train Loss: 0.613 Vali Loss: 1.362 Vali Acc: 0.590 Test Loss: 1.362 Test Acc: 0.590
Validation loss decreased (-0.539993 --> -0.589986).  Saving model ...
Epoch: 4 cost time: 2.402628183364868
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.146 Vali Acc: 0.460 Test Loss: 1.146 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.308696746826172
Epoch: 5, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.363110303878784
Epoch: 6, Steps: 18 | Train Loss: 0.713 Vali Loss: 1.915 Vali Acc: 0.570 Test Loss: 1.915 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3032138347625732
Epoch: 7, Steps: 18 | Train Loss: 0.441 Vali Loss: 2.333 Vali Acc: 0.460 Test Loss: 2.333 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4136464595794678
Epoch: 8, Steps: 18 | Train Loss: 0.555 Vali Loss: 2.085 Vali Acc: 0.450 Test Loss: 2.085 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.3484625816345215
Epoch: 9, Steps: 18 | Train Loss: 0.679 Vali Loss: 2.045 Vali Acc: 0.560 Test Loss: 2.045 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.327301263809204
Epoch: 10, Steps: 18 | Train Loss: 0.248 Vali Loss: 1.963 Vali Acc: 0.570 Test Loss: 1.963 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.525705575942993
Epoch: 11, Steps: 18 | Train Loss: 0.257 Vali Loss: 2.173 Vali Acc: 0.500 Test Loss: 2.173 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.419637680053711
Epoch: 12, Steps: 18 | Train Loss: 0.470 Vali Loss: 2.809 Vali Acc: 0.550 Test Loss: 2.809 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.497331380844116
Epoch: 13, Steps: 18 | Train Loss: 0.408 Vali Loss: 3.447 Vali Acc: 0.520 Test Loss: 3.447 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 526082
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.969069242477417
Epoch: 1, Steps: 18 | Train Loss: 1.758 Vali Loss: 2.100 Vali Acc: 0.510 Test Loss: 2.100 Test Acc: 0.510
Validation loss decreased (inf --> -0.509979).  Saving model ...
Epoch: 2 cost time: 12.70331621170044
Epoch: 2, Steps: 18 | Train Loss: 2.748 Vali Loss: 4.667 Vali Acc: 0.500 Test Loss: 4.667 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.704565525054932
Epoch: 3, Steps: 18 | Train Loss: 5.992 Vali Loss: 13.171 Vali Acc: 0.530 Test Loss: 13.171 Test Acc: 0.530
Validation loss decreased (-0.509979 --> -0.529868).  Saving model ...
Epoch: 4 cost time: 12.551796913146973
Epoch: 4, Steps: 18 | Train Loss: 4.680 Vali Loss: 10.187 Vali Acc: 0.610 Test Loss: 10.187 Test Acc: 0.610
Validation loss decreased (-0.529868 --> -0.609898).  Saving model ...
Epoch: 5 cost time: 12.256120443344116
Epoch: 5, Steps: 18 | Train Loss: 3.626 Vali Loss: 5.121 Vali Acc: 0.570 Test Loss: 5.121 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.285643100738525
Epoch: 6, Steps: 18 | Train Loss: 2.542 Vali Loss: 4.197 Vali Acc: 0.560 Test Loss: 4.197 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.324737548828125
Epoch: 7, Steps: 18 | Train Loss: 1.831 Vali Loss: 4.102 Vali Acc: 0.530 Test Loss: 4.102 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.608349800109863
Epoch: 8, Steps: 18 | Train Loss: 0.893 Vali Loss: 5.671 Vali Acc: 0.560 Test Loss: 5.671 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.775086641311646
Epoch: 9, Steps: 18 | Train Loss: 0.644 Vali Loss: 5.283 Vali Acc: 0.440 Test Loss: 5.283 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.92238187789917
Epoch: 10, Steps: 18 | Train Loss: 0.453 Vali Loss: 4.408 Vali Acc: 0.510 Test Loss: 4.408 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.814024686813354
Epoch: 11, Steps: 18 | Train Loss: 0.831 Vali Loss: 7.002 Vali Acc: 0.570 Test Loss: 7.002 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.685328006744385
Epoch: 12, Steps: 18 | Train Loss: 1.138 Vali Loss: 7.568 Vali Acc: 0.520 Test Loss: 7.568 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 12.099153757095337
Epoch: 13, Steps: 18 | Train Loss: 1.377 Vali Loss: 6.154 Vali Acc: 0.510 Test Loss: 6.154 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.058433532714844
Epoch: 14, Steps: 18 | Train Loss: 1.213 Vali Loss: 3.934 Vali Acc: 0.530 Test Loss: 3.934 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 1537218
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.931540489196777
Epoch: 1, Steps: 18 | Train Loss: 1.028 Vali Loss: 0.995 Vali Acc: 0.540 Test Loss: 0.995 Test Acc: 0.540
Validation loss decreased (inf --> -0.539990).  Saving model ...
Epoch: 2 cost time: 5.931686639785767
Epoch: 2, Steps: 18 | Train Loss: 0.926 Vali Loss: 2.082 Vali Acc: 0.530 Test Loss: 2.082 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.587983131408691
Epoch: 3, Steps: 18 | Train Loss: 0.857 Vali Loss: 3.203 Vali Acc: 0.480 Test Loss: 3.203 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.446433782577515
Epoch: 4, Steps: 18 | Train Loss: 1.856 Vali Loss: 3.134 Vali Acc: 0.530 Test Loss: 3.134 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.402380704879761
Epoch: 5, Steps: 18 | Train Loss: 1.630 Vali Loss: 3.147 Vali Acc: 0.600 Test Loss: 3.147 Test Acc: 0.600
Validation loss decreased (-0.539990 --> -0.599969).  Saving model ...
Epoch: 6 cost time: 6.140735626220703
Epoch: 6, Steps: 18 | Train Loss: 1.849 Vali Loss: 3.518 Vali Acc: 0.470 Test Loss: 3.518 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.212621688842773
Epoch: 7, Steps: 18 | Train Loss: 1.246 Vali Loss: 7.743 Vali Acc: 0.550 Test Loss: 7.743 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.245189905166626
Epoch: 8, Steps: 18 | Train Loss: 1.261 Vali Loss: 11.411 Vali Acc: 0.450 Test Loss: 11.411 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.077769756317139
Epoch: 9, Steps: 18 | Train Loss: 1.649 Vali Loss: 9.782 Vali Acc: 0.500 Test Loss: 9.782 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.17744255065918
Epoch: 10, Steps: 18 | Train Loss: 2.024 Vali Loss: 6.738 Vali Acc: 0.530 Test Loss: 6.738 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.752382516860962
Epoch: 11, Steps: 18 | Train Loss: 1.686 Vali Loss: 8.390 Vali Acc: 0.530 Test Loss: 8.390 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.634796380996704
Epoch: 12, Steps: 18 | Train Loss: 1.659 Vali Loss: 3.354 Vali Acc: 0.520 Test Loss: 3.354 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.978826522827148
Epoch: 13, Steps: 18 | Train Loss: 0.650 Vali Loss: 4.733 Vali Acc: 0.530 Test Loss: 4.733 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.889805316925049
Epoch: 14, Steps: 18 | Train Loss: 0.465 Vali Loss: 7.854 Vali Acc: 0.470 Test Loss: 7.854 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.445923805236816
Epoch: 15, Steps: 18 | Train Loss: 0.328 Vali Loss: 8.814 Vali Acc: 0.520 Test Loss: 8.814 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 924226
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.064321994781494
Epoch: 1, Steps: 18 | Train Loss: 0.919 Vali Loss: 1.105 Vali Acc: 0.600 Test Loss: 1.105 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 4.296030044555664
Epoch: 2, Steps: 18 | Train Loss: 0.896 Vali Loss: 1.490 Vali Acc: 0.550 Test Loss: 1.490 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.322669744491577
Epoch: 3, Steps: 18 | Train Loss: 1.046 Vali Loss: 2.114 Vali Acc: 0.470 Test Loss: 2.114 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.498888731002808
Epoch: 4, Steps: 18 | Train Loss: 0.697 Vali Loss: 2.852 Vali Acc: 0.500 Test Loss: 2.852 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.378495693206787
Epoch: 5, Steps: 18 | Train Loss: 0.725 Vali Loss: 4.153 Vali Acc: 0.510 Test Loss: 4.153 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.2203528881073
Epoch: 6, Steps: 18 | Train Loss: 0.574 Vali Loss: 3.726 Vali Acc: 0.460 Test Loss: 3.726 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.230315208435059
Epoch: 7, Steps: 18 | Train Loss: 0.997 Vali Loss: 5.374 Vali Acc: 0.530 Test Loss: 5.374 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.298630475997925
Epoch: 8, Steps: 18 | Train Loss: 1.715 Vali Loss: 6.990 Vali Acc: 0.500 Test Loss: 6.990 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.415523052215576
Epoch: 9, Steps: 18 | Train Loss: 1.725 Vali Loss: 3.487 Vali Acc: 0.540 Test Loss: 3.487 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.584216833114624
Epoch: 10, Steps: 18 | Train Loss: 0.384 Vali Loss: 4.579 Vali Acc: 0.500 Test Loss: 4.579 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.1458282470703125
Epoch: 11, Steps: 18 | Train Loss: 0.567 Vali Loss: 5.242 Vali Acc: 0.490 Test Loss: 5.242 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 704450
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.199751138687134
Epoch: 1, Steps: 18 | Train Loss: 0.865 Vali Loss: 1.427 Vali Acc: 0.470 Test Loss: 1.427 Test Acc: 0.470
Validation loss decreased (inf --> -0.469986).  Saving model ...
Epoch: 2 cost time: 3.7899749279022217
Epoch: 2, Steps: 18 | Train Loss: 0.899 Vali Loss: 1.381 Vali Acc: 0.510 Test Loss: 1.381 Test Acc: 0.510
Validation loss decreased (-0.469986 --> -0.509986).  Saving model ...
Epoch: 3 cost time: 3.9356467723846436
Epoch: 3, Steps: 18 | Train Loss: 1.031 Vali Loss: 1.309 Vali Acc: 0.510 Test Loss: 1.309 Test Acc: 0.510
Validation loss decreased (-0.509986 --> -0.509987).  Saving model ...
Epoch: 4 cost time: 3.214996814727783
Epoch: 4, Steps: 18 | Train Loss: 0.539 Vali Loss: 1.995 Vali Acc: 0.510 Test Loss: 1.995 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8129723072052
Epoch: 5, Steps: 18 | Train Loss: 0.619 Vali Loss: 2.398 Vali Acc: 0.490 Test Loss: 2.398 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7915358543395996
Epoch: 6, Steps: 18 | Train Loss: 0.578 Vali Loss: 2.797 Vali Acc: 0.530 Test Loss: 2.797 Test Acc: 0.530
Validation loss decreased (-0.509987 --> -0.529972).  Saving model ...
Epoch: 7 cost time: 3.826669692993164
Epoch: 7, Steps: 18 | Train Loss: 0.542 Vali Loss: 3.255 Vali Acc: 0.560 Test Loss: 3.255 Test Acc: 0.560
Validation loss decreased (-0.529972 --> -0.559967).  Saving model ...
Epoch: 8 cost time: 3.561948776245117
Epoch: 8, Steps: 18 | Train Loss: 0.536 Vali Loss: 2.709 Vali Acc: 0.510 Test Loss: 2.709 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4890527725219727
Epoch: 9, Steps: 18 | Train Loss: 0.709 Vali Loss: 5.123 Vali Acc: 0.550 Test Loss: 5.123 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8720076084136963
Epoch: 10, Steps: 18 | Train Loss: 0.891 Vali Loss: 4.601 Vali Acc: 0.500 Test Loss: 4.601 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7636752128601074
Epoch: 11, Steps: 18 | Train Loss: 0.355 Vali Loss: 7.458 Vali Acc: 0.470 Test Loss: 7.458 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.857923746109009
Epoch: 12, Steps: 18 | Train Loss: 0.523 Vali Loss: 4.280 Vali Acc: 0.490 Test Loss: 4.280 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9179131984710693
Epoch: 13, Steps: 18 | Train Loss: 0.177 Vali Loss: 3.698 Vali Acc: 0.530 Test Loss: 3.698 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6612541675567627
Epoch: 14, Steps: 18 | Train Loss: 0.568 Vali Loss: 4.492 Vali Acc: 0.490 Test Loss: 4.492 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.5925233364105225
Epoch: 15, Steps: 18 | Train Loss: 0.433 Vali Loss: 5.652 Vali Acc: 0.530 Test Loss: 5.652 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.644832134246826
Epoch: 16, Steps: 18 | Train Loss: 0.428 Vali Loss: 9.689 Vali Acc: 0.490 Test Loss: 9.689 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.030348539352417
Epoch: 17, Steps: 18 | Train Loss: 1.399 Vali Loss: 7.306 Vali Acc: 0.550 Test Loss: 7.306 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 615746
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.909859895706177
Epoch: 1, Steps: 18 | Train Loss: 0.817 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.2301292419433594
Epoch: 2, Steps: 18 | Train Loss: 0.765 Vali Loss: 1.247 Vali Acc: 0.470 Test Loss: 1.247 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1091954708099365
Epoch: 3, Steps: 18 | Train Loss: 0.724 Vali Loss: 3.337 Vali Acc: 0.440 Test Loss: 3.337 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0452253818511963
Epoch: 4, Steps: 18 | Train Loss: 0.962 Vali Loss: 1.220 Vali Acc: 0.550 Test Loss: 1.220 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 3.103224039077759
Epoch: 5, Steps: 18 | Train Loss: 0.513 Vali Loss: 1.512 Vali Acc: 0.490 Test Loss: 1.512 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.207653522491455
Epoch: 6, Steps: 18 | Train Loss: 0.479 Vali Loss: 1.604 Vali Acc: 0.540 Test Loss: 1.604 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2091619968414307
Epoch: 7, Steps: 18 | Train Loss: 0.451 Vali Loss: 2.105 Vali Acc: 0.520 Test Loss: 2.105 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0607025623321533
Epoch: 8, Steps: 18 | Train Loss: 0.545 Vali Loss: 2.741 Vali Acc: 0.490 Test Loss: 2.741 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.038339138031006
Epoch: 9, Steps: 18 | Train Loss: 0.384 Vali Loss: 2.400 Vali Acc: 0.470 Test Loss: 2.400 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.1787021160125732
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 3.406 Vali Acc: 0.520 Test Loss: 3.406 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.082723379135132
Epoch: 11, Steps: 18 | Train Loss: 0.555 Vali Loss: 2.368 Vali Acc: 0.550 Test Loss: 2.368 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.939500570297241
Epoch: 12, Steps: 18 | Train Loss: 0.288 Vali Loss: 4.843 Vali Acc: 0.510 Test Loss: 4.843 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.893479824066162
Epoch: 13, Steps: 18 | Train Loss: 0.629 Vali Loss: 4.280 Vali Acc: 0.510 Test Loss: 4.280 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7447876930236816
Epoch: 14, Steps: 18 | Train Loss: 0.361 Vali Loss: 5.184 Vali Acc: 0.450 Test Loss: 5.184 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 520258
model size : 4.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.352649688720703
Epoch: 1, Steps: 18 | Train Loss: 0.835 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 2.6730523109436035
Epoch: 2, Steps: 18 | Train Loss: 0.875 Vali Loss: 0.917 Vali Acc: 0.430 Test Loss: 0.917 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7659943103790283
Epoch: 3, Steps: 18 | Train Loss: 0.752 Vali Loss: 1.057 Vali Acc: 0.510 Test Loss: 1.057 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.746809244155884
Epoch: 4, Steps: 18 | Train Loss: 0.572 Vali Loss: 1.212 Vali Acc: 0.590 Test Loss: 1.212 Test Acc: 0.590
Validation loss decreased (-0.549992 --> -0.589988).  Saving model ...
Epoch: 5 cost time: 2.6559369564056396
Epoch: 5, Steps: 18 | Train Loss: 0.650 Vali Loss: 1.571 Vali Acc: 0.500 Test Loss: 1.571 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6662421226501465
Epoch: 6, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.765 Vali Acc: 0.540 Test Loss: 1.765 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6879563331604004
Epoch: 7, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.708 Vali Acc: 0.590 Test Loss: 1.708 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7124948501586914
Epoch: 8, Steps: 18 | Train Loss: 0.625 Vali Loss: 2.424 Vali Acc: 0.450 Test Loss: 2.424 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.73875093460083
Epoch: 9, Steps: 18 | Train Loss: 0.245 Vali Loss: 2.734 Vali Acc: 0.470 Test Loss: 2.734 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7223472595214844
Epoch: 10, Steps: 18 | Train Loss: 0.311 Vali Loss: 3.181 Vali Acc: 0.480 Test Loss: 3.181 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7925918102264404
Epoch: 11, Steps: 18 | Train Loss: 0.233 Vali Loss: 3.778 Vali Acc: 0.590 Test Loss: 3.778 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6058924198150635
Epoch: 12, Steps: 18 | Train Loss: 0.403 Vali Loss: 2.866 Vali Acc: 0.500 Test Loss: 2.866 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6014187335968018
Epoch: 13, Steps: 18 | Train Loss: 0.201 Vali Loss: 3.262 Vali Acc: 0.520 Test Loss: 3.262 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.336658239364624
Epoch: 14, Steps: 18 | Train Loss: 0.385 Vali Loss: 3.091 Vali Acc: 0.520 Test Loss: 3.091 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 490306
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8177547454833984
Epoch: 1, Steps: 18 | Train Loss: 0.832 Vali Loss: 0.746 Vali Acc: 0.570 Test Loss: 0.746 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 1.8998773097991943
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.869 Vali Acc: 0.540 Test Loss: 0.869 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.209660291671753
Epoch: 3, Steps: 18 | Train Loss: 0.570 Vali Loss: 1.107 Vali Acc: 0.470 Test Loss: 1.107 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.173630475997925
Epoch: 4, Steps: 18 | Train Loss: 0.580 Vali Loss: 1.043 Vali Acc: 0.620 Test Loss: 1.043 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619990).  Saving model ...
Epoch: 5 cost time: 1.9615931510925293
Epoch: 5, Steps: 18 | Train Loss: 0.501 Vali Loss: 1.272 Vali Acc: 0.510 Test Loss: 1.272 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.116692543029785
Epoch: 6, Steps: 18 | Train Loss: 0.581 Vali Loss: 1.752 Vali Acc: 0.510 Test Loss: 1.752 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.142653465270996
Epoch: 7, Steps: 18 | Train Loss: 0.464 Vali Loss: 1.344 Vali Acc: 0.590 Test Loss: 1.344 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2405245304107666
Epoch: 8, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.931 Vali Acc: 0.500 Test Loss: 1.931 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.102569818496704
Epoch: 9, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.929 Vali Acc: 0.490 Test Loss: 1.929 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.092559576034546
Epoch: 10, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.994 Vali Acc: 0.600 Test Loss: 1.994 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1316757202148438
Epoch: 11, Steps: 18 | Train Loss: 0.544 Vali Loss: 1.434 Vali Acc: 0.640 Test Loss: 1.434 Test Acc: 0.640
Validation loss decreased (-0.619990 --> -0.639986).  Saving model ...
Epoch: 12 cost time: 2.1373791694641113
Epoch: 12, Steps: 18 | Train Loss: 0.291 Vali Loss: 2.785 Vali Acc: 0.480 Test Loss: 2.785 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1569838523864746
Epoch: 13, Steps: 18 | Train Loss: 0.192 Vali Loss: 2.390 Vali Acc: 0.510 Test Loss: 2.390 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.386423110961914
Epoch: 14, Steps: 18 | Train Loss: 0.333 Vali Loss: 2.545 Vali Acc: 0.500 Test Loss: 2.545 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3941702842712402
Epoch: 15, Steps: 18 | Train Loss: 0.675 Vali Loss: 2.414 Vali Acc: 0.540 Test Loss: 2.414 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3468570709228516
Epoch: 16, Steps: 18 | Train Loss: 0.225 Vali Loss: 2.596 Vali Acc: 0.580 Test Loss: 2.596 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.462418556213379
Epoch: 17, Steps: 18 | Train Loss: 0.312 Vali Loss: 3.328 Vali Acc: 0.540 Test Loss: 3.328 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.539484977722168
Epoch: 18, Steps: 18 | Train Loss: 0.307 Vali Loss: 4.901 Vali Acc: 0.480 Test Loss: 4.901 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3655788898468018
Epoch: 19, Steps: 18 | Train Loss: 0.327 Vali Loss: 5.122 Vali Acc: 0.500 Test Loss: 5.122 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.48486065864563
Epoch: 20, Steps: 18 | Train Loss: 0.404 Vali Loss: 4.106 Vali Acc: 0.490 Test Loss: 4.106 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4146907329559326
Epoch: 21, Steps: 18 | Train Loss: 0.100 Vali Loss: 3.562 Vali Acc: 0.510 Test Loss: 3.562 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm128_nh16_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 476738
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.329201459884644
Epoch: 1, Steps: 18 | Train Loss: 1.142 Vali Loss: 1.262 Vali Acc: 0.490 Test Loss: 1.262 Test Acc: 0.490
Validation loss decreased (inf --> -0.489987).  Saving model ...
Epoch: 2 cost time: 12.860285997390747
Epoch: 2, Steps: 18 | Train Loss: 1.037 Vali Loss: 3.007 Vali Acc: 0.500 Test Loss: 3.007 Test Acc: 0.500
Validation loss decreased (-0.489987 --> -0.499970).  Saving model ...
Epoch: 3 cost time: 12.875212669372559
Epoch: 3, Steps: 18 | Train Loss: 1.522 Vali Loss: 3.130 Vali Acc: 0.460 Test Loss: 3.130 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.59872841835022
Epoch: 4, Steps: 18 | Train Loss: 1.485 Vali Loss: 3.463 Vali Acc: 0.530 Test Loss: 3.463 Test Acc: 0.530
Validation loss decreased (-0.499970 --> -0.529965).  Saving model ...
Epoch: 5 cost time: 11.303281545639038
Epoch: 5, Steps: 18 | Train Loss: 1.337 Vali Loss: 3.967 Vali Acc: 0.460 Test Loss: 3.967 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.99871563911438
Epoch: 6, Steps: 18 | Train Loss: 0.969 Vali Loss: 3.414 Vali Acc: 0.480 Test Loss: 3.414 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.309691190719604
Epoch: 7, Steps: 18 | Train Loss: 0.808 Vali Loss: 3.964 Vali Acc: 0.590 Test Loss: 3.964 Test Acc: 0.590
Validation loss decreased (-0.529965 --> -0.589960).  Saving model ...
Epoch: 8 cost time: 12.416455745697021
Epoch: 8, Steps: 18 | Train Loss: 1.074 Vali Loss: 8.552 Vali Acc: 0.490 Test Loss: 8.552 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.606433629989624
Epoch: 9, Steps: 18 | Train Loss: 0.887 Vali Loss: 9.419 Vali Acc: 0.530 Test Loss: 9.419 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.503134965896606
Epoch: 10, Steps: 18 | Train Loss: 0.982 Vali Loss: 7.221 Vali Acc: 0.500 Test Loss: 7.221 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.863800048828125
Epoch: 11, Steps: 18 | Train Loss: 1.928 Vali Loss: 11.610 Vali Acc: 0.530 Test Loss: 11.610 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.311594486236572
Epoch: 12, Steps: 18 | Train Loss: 1.051 Vali Loss: 10.250 Vali Acc: 0.490 Test Loss: 10.250 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.230929613113403
Epoch: 13, Steps: 18 | Train Loss: 0.613 Vali Loss: 11.472 Vali Acc: 0.460 Test Loss: 11.472 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.131474256515503
Epoch: 14, Steps: 18 | Train Loss: 0.686 Vali Loss: 19.773 Vali Acc: 0.460 Test Loss: 19.773 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.044332504272461
Epoch: 15, Steps: 18 | Train Loss: 1.168 Vali Loss: 8.782 Vali Acc: 0.530 Test Loss: 8.782 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.669666051864624
Epoch: 16, Steps: 18 | Train Loss: 0.482 Vali Loss: 11.163 Vali Acc: 0.510 Test Loss: 11.163 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.853507041931152
Epoch: 17, Steps: 18 | Train Loss: 0.979 Vali Loss: 10.869 Vali Acc: 0.580 Test Loss: 10.869 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 793858
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.198192119598389
Epoch: 1, Steps: 18 | Train Loss: 0.928 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 4.48029899597168
Epoch: 2, Steps: 18 | Train Loss: 0.866 Vali Loss: 1.059 Vali Acc: 0.690 Test Loss: 1.059 Test Acc: 0.690
Validation loss decreased (-0.549992 --> -0.689989).  Saving model ...
Epoch: 3 cost time: 5.666763782501221
Epoch: 3, Steps: 18 | Train Loss: 0.734 Vali Loss: 1.338 Vali Acc: 0.590 Test Loss: 1.338 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.892189979553223
Epoch: 4, Steps: 18 | Train Loss: 0.658 Vali Loss: 3.855 Vali Acc: 0.500 Test Loss: 3.855 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.5903754234313965
Epoch: 5, Steps: 18 | Train Loss: 1.822 Vali Loss: 1.766 Vali Acc: 0.500 Test Loss: 1.766 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.963329076766968
Epoch: 6, Steps: 18 | Train Loss: 0.717 Vali Loss: 2.602 Vali Acc: 0.530 Test Loss: 2.602 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.18542218208313
Epoch: 7, Steps: 18 | Train Loss: 0.642 Vali Loss: 3.405 Vali Acc: 0.490 Test Loss: 3.405 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.907223463058472
Epoch: 8, Steps: 18 | Train Loss: 0.601 Vali Loss: 4.711 Vali Acc: 0.520 Test Loss: 4.711 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.257049560546875
Epoch: 9, Steps: 18 | Train Loss: 0.916 Vali Loss: 3.857 Vali Acc: 0.480 Test Loss: 3.857 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.1273133754730225
Epoch: 10, Steps: 18 | Train Loss: 0.393 Vali Loss: 7.098 Vali Acc: 0.440 Test Loss: 7.098 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.918626546859741
Epoch: 11, Steps: 18 | Train Loss: 0.504 Vali Loss: 4.644 Vali Acc: 0.550 Test Loss: 4.644 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.781338691711426
Epoch: 12, Steps: 18 | Train Loss: 0.513 Vali Loss: 3.702 Vali Acc: 0.540 Test Loss: 3.702 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.69
model parameter : 487362
model size : 3.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.648623704910278
Epoch: 1, Steps: 18 | Train Loss: 1.071 Vali Loss: 0.870 Vali Acc: 0.530 Test Loss: 0.870 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 3.785038948059082
Epoch: 2, Steps: 18 | Train Loss: 1.093 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.982562780380249
Epoch: 3, Steps: 18 | Train Loss: 0.872 Vali Loss: 1.807 Vali Acc: 0.550 Test Loss: 1.807 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549982).  Saving model ...
Epoch: 4 cost time: 4.2409820556640625
Epoch: 4, Steps: 18 | Train Loss: 0.746 Vali Loss: 1.657 Vali Acc: 0.540 Test Loss: 1.657 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9339537620544434
Epoch: 5, Steps: 18 | Train Loss: 0.865 Vali Loss: 1.617 Vali Acc: 0.530 Test Loss: 1.617 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.886056423187256
Epoch: 6, Steps: 18 | Train Loss: 0.735 Vali Loss: 2.079 Vali Acc: 0.520 Test Loss: 2.079 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.050500154495239
Epoch: 7, Steps: 18 | Train Loss: 0.637 Vali Loss: 2.178 Vali Acc: 0.490 Test Loss: 2.178 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.981689929962158
Epoch: 8, Steps: 18 | Train Loss: 0.473 Vali Loss: 1.858 Vali Acc: 0.550 Test Loss: 1.858 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.0238518714904785
Epoch: 9, Steps: 18 | Train Loss: 0.345 Vali Loss: 3.332 Vali Acc: 0.520 Test Loss: 3.332 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.8719136714935303
Epoch: 10, Steps: 18 | Train Loss: 0.394 Vali Loss: 2.977 Vali Acc: 0.530 Test Loss: 2.977 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.9183619022369385
Epoch: 11, Steps: 18 | Train Loss: 0.274 Vali Loss: 4.142 Vali Acc: 0.540 Test Loss: 4.142 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.8563313484191895
Epoch: 12, Steps: 18 | Train Loss: 0.560 Vali Loss: 3.657 Vali Acc: 0.510 Test Loss: 3.657 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.788144111633301
Epoch: 13, Steps: 18 | Train Loss: 0.423 Vali Loss: 4.903 Vali Acc: 0.510 Test Loss: 4.903 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 377474
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.551295518875122
Epoch: 1, Steps: 18 | Train Loss: 0.947 Vali Loss: 0.802 Vali Acc: 0.550 Test Loss: 0.802 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 3.2091050148010254
Epoch: 2, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.800 Vali Acc: 0.550 Test Loss: 0.800 Test Acc: 0.550
Validation loss decreased (-0.549992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 3.2836997509002686
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.874 Vali Acc: 0.520 Test Loss: 0.874 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1809403896331787
Epoch: 4, Steps: 18 | Train Loss: 0.669 Vali Loss: 1.048 Vali Acc: 0.620 Test Loss: 1.048 Test Acc: 0.620
Validation loss decreased (-0.549992 --> -0.619990).  Saving model ...
Epoch: 5 cost time: 2.70463228225708
Epoch: 5, Steps: 18 | Train Loss: 0.411 Vali Loss: 1.374 Vali Acc: 0.540 Test Loss: 1.374 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.123579502105713
Epoch: 6, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.239 Vali Acc: 0.520 Test Loss: 1.239 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.245797634124756
Epoch: 7, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.367 Vali Acc: 0.620 Test Loss: 1.367 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.963691234588623
Epoch: 8, Steps: 18 | Train Loss: 0.383 Vali Loss: 2.033 Vali Acc: 0.610 Test Loss: 2.033 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.005326271057129
Epoch: 9, Steps: 18 | Train Loss: 0.352 Vali Loss: 2.682 Vali Acc: 0.460 Test Loss: 2.682 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2183902263641357
Epoch: 10, Steps: 18 | Train Loss: 0.212 Vali Loss: 2.274 Vali Acc: 0.640 Test Loss: 2.274 Test Acc: 0.640
Validation loss decreased (-0.619990 --> -0.639977).  Saving model ...
Epoch: 11 cost time: 3.235146999359131
Epoch: 11, Steps: 18 | Train Loss: 0.286 Vali Loss: 2.387 Vali Acc: 0.520 Test Loss: 2.387 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0268445014953613
Epoch: 12, Steps: 18 | Train Loss: 0.366 Vali Loss: 2.358 Vali Acc: 0.570 Test Loss: 2.358 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7277915477752686
Epoch: 13, Steps: 18 | Train Loss: 0.226 Vali Loss: 3.504 Vali Acc: 0.480 Test Loss: 3.504 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9991843700408936
Epoch: 14, Steps: 18 | Train Loss: 0.216 Vali Loss: 3.036 Vali Acc: 0.510 Test Loss: 3.036 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.6488704681396484
Epoch: 15, Steps: 18 | Train Loss: 0.158 Vali Loss: 3.269 Vali Acc: 0.540 Test Loss: 3.269 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5808002948760986
Epoch: 16, Steps: 18 | Train Loss: 0.262 Vali Loss: 4.059 Vali Acc: 0.580 Test Loss: 4.059 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.627774953842163
Epoch: 17, Steps: 18 | Train Loss: 0.267 Vali Loss: 3.064 Vali Acc: 0.570 Test Loss: 3.064 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.380466938018799
Epoch: 18, Steps: 18 | Train Loss: 0.349 Vali Loss: 5.216 Vali Acc: 0.540 Test Loss: 5.216 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.6333203315734863
Epoch: 19, Steps: 18 | Train Loss: 0.151 Vali Loss: 5.755 Vali Acc: 0.500 Test Loss: 5.755 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.7190866470336914
Epoch: 20, Steps: 18 | Train Loss: 0.163 Vali Loss: 4.346 Vali Acc: 0.550 Test Loss: 4.346 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 333122
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.663764715194702
Epoch: 1, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.799 Vali Acc: 0.440 Test Loss: 0.799 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 2.753551483154297
Epoch: 2, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.955 Vali Acc: 0.550 Test Loss: 0.955 Test Acc: 0.550
Validation loss decreased (-0.439992 --> -0.549990).  Saving model ...
Epoch: 3 cost time: 2.836153268814087
Epoch: 3, Steps: 18 | Train Loss: 0.705 Vali Loss: 1.185 Vali Acc: 0.470 Test Loss: 1.185 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.756967782974243
Epoch: 4, Steps: 18 | Train Loss: 0.528 Vali Loss: 1.071 Vali Acc: 0.520 Test Loss: 1.071 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7408509254455566
Epoch: 5, Steps: 18 | Train Loss: 0.604 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7674739360809326
Epoch: 6, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.284 Vali Acc: 0.590 Test Loss: 1.284 Test Acc: 0.590
Validation loss decreased (-0.549990 --> -0.589987).  Saving model ...
Epoch: 7 cost time: 2.807053565979004
Epoch: 7, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.437 Vali Acc: 0.540 Test Loss: 1.437 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7254960536956787
Epoch: 8, Steps: 18 | Train Loss: 0.323 Vali Loss: 2.212 Vali Acc: 0.510 Test Loss: 2.212 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7198498249053955
Epoch: 9, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.556 Vali Acc: 0.520 Test Loss: 1.556 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7326555252075195
Epoch: 10, Steps: 18 | Train Loss: 0.236 Vali Loss: 1.987 Vali Acc: 0.550 Test Loss: 1.987 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.661808490753174
Epoch: 11, Steps: 18 | Train Loss: 0.256 Vali Loss: 2.508 Vali Acc: 0.520 Test Loss: 2.508 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.725626230239868
Epoch: 12, Steps: 18 | Train Loss: 0.238 Vali Loss: 2.459 Vali Acc: 0.490 Test Loss: 2.459 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8400142192840576
Epoch: 13, Steps: 18 | Train Loss: 0.291 Vali Loss: 2.713 Vali Acc: 0.460 Test Loss: 2.713 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.786020517349243
Epoch: 14, Steps: 18 | Train Loss: 0.231 Vali Loss: 2.610 Vali Acc: 0.480 Test Loss: 2.610 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7285706996917725
Epoch: 15, Steps: 18 | Train Loss: 0.084 Vali Loss: 2.674 Vali Acc: 0.510 Test Loss: 2.674 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.719794273376465
Epoch: 16, Steps: 18 | Train Loss: 0.097 Vali Loss: 2.904 Vali Acc: 0.540 Test Loss: 2.904 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 285378
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.0967628955841064
Epoch: 1, Steps: 18 | Train Loss: 0.792 Vali Loss: 0.713 Vali Acc: 0.570 Test Loss: 0.713 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.6145036220550537
Epoch: 2, Steps: 18 | Train Loss: 0.713 Vali Loss: 1.027 Vali Acc: 0.420 Test Loss: 1.027 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6001336574554443
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 1.021 Vali Acc: 0.540 Test Loss: 1.021 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9401917457580566
Epoch: 4, Steps: 18 | Train Loss: 0.735 Vali Loss: 1.254 Vali Acc: 0.530 Test Loss: 1.254 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.175767421722412
Epoch: 5, Steps: 18 | Train Loss: 0.506 Vali Loss: 1.620 Vali Acc: 0.480 Test Loss: 1.620 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4254038333892822
Epoch: 6, Steps: 18 | Train Loss: 0.589 Vali Loss: 1.111 Vali Acc: 0.510 Test Loss: 1.111 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.3250370025634766
Epoch: 7, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.179 Vali Acc: 0.490 Test Loss: 1.179 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.3651716709136963
Epoch: 8, Steps: 18 | Train Loss: 0.358 Vali Loss: 1.325 Vali Acc: 0.510 Test Loss: 1.325 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.3961732387542725
Epoch: 9, Steps: 18 | Train Loss: 0.289 Vali Loss: 1.669 Vali Acc: 0.530 Test Loss: 1.669 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.318917751312256
Epoch: 10, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.965 Vali Acc: 0.450 Test Loss: 1.965 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.31809139251709
Epoch: 11, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.706 Vali Acc: 0.590 Test Loss: 1.706 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589983).  Saving model ...
Epoch: 12 cost time: 2.4093151092529297
Epoch: 12, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.838 Vali Acc: 0.470 Test Loss: 1.838 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.326582193374634
Epoch: 13, Steps: 18 | Train Loss: 0.301 Vali Loss: 2.638 Vali Acc: 0.540 Test Loss: 2.638 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3208227157592773
Epoch: 14, Steps: 18 | Train Loss: 0.214 Vali Loss: 3.498 Vali Acc: 0.480 Test Loss: 3.498 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.337287425994873
Epoch: 15, Steps: 18 | Train Loss: 0.286 Vali Loss: 2.835 Vali Acc: 0.470 Test Loss: 2.835 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4047722816467285
Epoch: 16, Steps: 18 | Train Loss: 0.139 Vali Loss: 2.865 Vali Acc: 0.490 Test Loss: 2.865 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.345292091369629
Epoch: 17, Steps: 18 | Train Loss: 0.332 Vali Loss: 2.657 Vali Acc: 0.530 Test Loss: 2.657 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4471051692962646
Epoch: 18, Steps: 18 | Train Loss: 0.132 Vali Loss: 2.507 Vali Acc: 0.530 Test Loss: 2.507 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.221647262573242
Epoch: 19, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.865 Vali Acc: 0.530 Test Loss: 2.865 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3281021118164062
Epoch: 20, Steps: 18 | Train Loss: 0.161 Vali Loss: 2.349 Vali Acc: 0.620 Test Loss: 2.349 Test Acc: 0.620
Validation loss decreased (-0.589983 --> -0.619977).  Saving model ...
Epoch: 21 cost time: 2.2212233543395996
Epoch: 21, Steps: 18 | Train Loss: 0.083 Vali Loss: 2.514 Vali Acc: 0.550 Test Loss: 2.514 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3925774097442627
Epoch: 22, Steps: 18 | Train Loss: 0.027 Vali Loss: 3.320 Vali Acc: 0.550 Test Loss: 3.320 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.27937650680542
Epoch: 23, Steps: 18 | Train Loss: 0.039 Vali Loss: 3.308 Vali Acc: 0.490 Test Loss: 3.308 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5341880321502686
Epoch: 24, Steps: 18 | Train Loss: 0.097 Vali Loss: 3.128 Vali Acc: 0.520 Test Loss: 3.128 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.572636365890503
Epoch: 25, Steps: 18 | Train Loss: 0.027 Vali Loss: 2.935 Vali Acc: 0.570 Test Loss: 2.935 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.570880651473999
Epoch: 26, Steps: 18 | Train Loss: 0.035 Vali Loss: 2.745 Vali Acc: 0.570 Test Loss: 2.745 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.414250135421753
Epoch: 27, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.993 Vali Acc: 0.550 Test Loss: 2.993 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.448651075363159
Epoch: 28, Steps: 18 | Train Loss: 0.031 Vali Loss: 3.403 Vali Acc: 0.540 Test Loss: 3.403 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3611135482788086
Epoch: 29, Steps: 18 | Train Loss: 0.026 Vali Loss: 4.050 Vali Acc: 0.530 Test Loss: 4.050 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.6125314235687256
Epoch: 30, Steps: 18 | Train Loss: 0.047 Vali Loss: 3.742 Vali Acc: 0.540 Test Loss: 3.742 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 270402
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.0013391971588135
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.708 Vali Acc: 0.630 Test Loss: 0.708 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 2.2796597480773926
Epoch: 2, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.746 Vali Acc: 0.580 Test Loss: 0.746 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2166366577148438
Epoch: 3, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.828 Vali Acc: 0.610 Test Loss: 0.828 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.224961996078491
Epoch: 4, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.798 Vali Acc: 0.590 Test Loss: 0.798 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.304514169692993
Epoch: 5, Steps: 18 | Train Loss: 0.532 Vali Loss: 0.978 Vali Acc: 0.510 Test Loss: 0.978 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.2088589668273926
Epoch: 6, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.932 Vali Acc: 0.520 Test Loss: 0.932 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.170196771621704
Epoch: 7, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.971 Vali Acc: 0.600 Test Loss: 0.971 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.161055088043213
Epoch: 8, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.043 Vali Acc: 0.580 Test Loss: 1.043 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.172780990600586
Epoch: 9, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.150 Vali Acc: 0.530 Test Loss: 1.150 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.201630115509033
Epoch: 10, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.095 Vali Acc: 0.630 Test Loss: 1.095 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.170316219329834
Epoch: 11, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.342 Vali Acc: 0.530 Test Loss: 1.342 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 263618
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.527230501174927
Epoch: 1, Steps: 18 | Train Loss: 1.197 Vali Loss: 2.516 Vali Acc: 0.530 Test Loss: 2.516 Test Acc: 0.530
Validation loss decreased (inf --> -0.529975).  Saving model ...
Epoch: 2 cost time: 10.583733320236206
Epoch: 2, Steps: 18 | Train Loss: 1.696 Vali Loss: 3.610 Vali Acc: 0.610 Test Loss: 3.610 Test Acc: 0.610
Validation loss decreased (-0.529975 --> -0.609964).  Saving model ...
Epoch: 3 cost time: 10.419935464859009
Epoch: 3, Steps: 18 | Train Loss: 2.006 Vali Loss: 3.045 Vali Acc: 0.580 Test Loss: 3.045 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.476852655410767
Epoch: 4, Steps: 18 | Train Loss: 1.763 Vali Loss: 3.017 Vali Acc: 0.500 Test Loss: 3.017 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.020142555236816
Epoch: 5, Steps: 18 | Train Loss: 1.320 Vali Loss: 6.005 Vali Acc: 0.490 Test Loss: 6.005 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.586965560913086
Epoch: 6, Steps: 18 | Train Loss: 1.248 Vali Loss: 5.956 Vali Acc: 0.520 Test Loss: 5.956 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.841952562332153
Epoch: 7, Steps: 18 | Train Loss: 0.940 Vali Loss: 6.823 Vali Acc: 0.470 Test Loss: 6.823 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.686227560043335
Epoch: 8, Steps: 18 | Train Loss: 2.093 Vali Loss: 7.402 Vali Acc: 0.490 Test Loss: 7.402 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.60240387916565
Epoch: 9, Steps: 18 | Train Loss: 0.650 Vali Loss: 5.120 Vali Acc: 0.570 Test Loss: 5.120 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.252510070800781
Epoch: 10, Steps: 18 | Train Loss: 0.788 Vali Loss: 9.720 Vali Acc: 0.530 Test Loss: 9.720 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.32620644569397
Epoch: 11, Steps: 18 | Train Loss: 0.845 Vali Loss: 8.443 Vali Acc: 0.550 Test Loss: 8.443 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 8.576088428497314
Epoch: 12, Steps: 18 | Train Loss: 2.620 Vali Loss: 11.350 Vali Acc: 0.510 Test Loss: 11.350 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 744322
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.0024518966674805
Epoch: 1, Steps: 18 | Train Loss: 0.916 Vali Loss: 1.023 Vali Acc: 0.570 Test Loss: 1.023 Test Acc: 0.570
Validation loss decreased (inf --> -0.569990).  Saving model ...
Epoch: 2 cost time: 4.58364725112915
Epoch: 2, Steps: 18 | Train Loss: 0.856 Vali Loss: 1.256 Vali Acc: 0.550 Test Loss: 1.256 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.668051719665527
Epoch: 3, Steps: 18 | Train Loss: 0.763 Vali Loss: 1.856 Vali Acc: 0.490 Test Loss: 1.856 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.573434591293335
Epoch: 4, Steps: 18 | Train Loss: 0.864 Vali Loss: 2.991 Vali Acc: 0.520 Test Loss: 2.991 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.596741676330566
Epoch: 5, Steps: 18 | Train Loss: 0.990 Vali Loss: 2.243 Vali Acc: 0.540 Test Loss: 2.243 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.5871803760528564
Epoch: 6, Steps: 18 | Train Loss: 0.541 Vali Loss: 2.319 Vali Acc: 0.550 Test Loss: 2.319 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.6535444259643555
Epoch: 7, Steps: 18 | Train Loss: 0.845 Vali Loss: 3.421 Vali Acc: 0.520 Test Loss: 3.421 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.750524282455444
Epoch: 8, Steps: 18 | Train Loss: 1.018 Vali Loss: 2.498 Vali Acc: 0.500 Test Loss: 2.498 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.267229795455933
Epoch: 9, Steps: 18 | Train Loss: 0.796 Vali Loss: 2.634 Vali Acc: 0.540 Test Loss: 2.634 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.4729883670806885
Epoch: 10, Steps: 18 | Train Loss: 0.512 Vali Loss: 3.632 Vali Acc: 0.580 Test Loss: 3.632 Test Acc: 0.580
Validation loss decreased (-0.569990 --> -0.579964).  Saving model ...
Epoch: 11 cost time: 4.4430460929870605
Epoch: 11, Steps: 18 | Train Loss: 0.322 Vali Loss: 3.976 Vali Acc: 0.630 Test Loss: 3.976 Test Acc: 0.630
Validation loss decreased (-0.579964 --> -0.629960).  Saving model ...
Epoch: 12 cost time: 4.566211223602295
Epoch: 12, Steps: 18 | Train Loss: 0.635 Vali Loss: 3.730 Vali Acc: 0.510 Test Loss: 3.730 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.34433388710022
Epoch: 13, Steps: 18 | Train Loss: 0.415 Vali Loss: 6.110 Vali Acc: 0.540 Test Loss: 6.110 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.735326766967773
Epoch: 14, Steps: 18 | Train Loss: 0.565 Vali Loss: 4.038 Vali Acc: 0.610 Test Loss: 4.038 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.499388933181763
Epoch: 15, Steps: 18 | Train Loss: 0.265 Vali Loss: 5.506 Vali Acc: 0.550 Test Loss: 5.506 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.247316598892212
Epoch: 16, Steps: 18 | Train Loss: 0.426 Vali Loss: 4.859 Vali Acc: 0.590 Test Loss: 4.859 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.661804914474487
Epoch: 17, Steps: 18 | Train Loss: 0.411 Vali Loss: 7.657 Vali Acc: 0.500 Test Loss: 7.657 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.70404314994812
Epoch: 18, Steps: 18 | Train Loss: 0.250 Vali Loss: 8.982 Vali Acc: 0.470 Test Loss: 8.982 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.562650203704834
Epoch: 19, Steps: 18 | Train Loss: 0.190 Vali Loss: 7.835 Vali Acc: 0.500 Test Loss: 7.835 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.3741209506988525
Epoch: 20, Steps: 18 | Train Loss: 0.205 Vali Loss: 9.026 Vali Acc: 0.590 Test Loss: 9.026 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.475548267364502
Epoch: 21, Steps: 18 | Train Loss: 0.352 Vali Loss: 10.170 Vali Acc: 0.510 Test Loss: 10.170 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 437826
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.531750917434692
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 1.604 Vali Acc: 0.520 Test Loss: 1.604 Test Acc: 0.520
Validation loss decreased (inf --> -0.519984).  Saving model ...
Epoch: 2 cost time: 3.1073713302612305
Epoch: 2, Steps: 18 | Train Loss: 0.758 Vali Loss: 1.031 Vali Acc: 0.630 Test Loss: 1.031 Test Acc: 0.630
Validation loss decreased (-0.519984 --> -0.629990).  Saving model ...
Epoch: 3 cost time: 2.9446868896484375
Epoch: 3, Steps: 18 | Train Loss: 0.723 Vali Loss: 1.029 Vali Acc: 0.610 Test Loss: 1.029 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8637733459472656
Epoch: 4, Steps: 18 | Train Loss: 0.692 Vali Loss: 1.092 Vali Acc: 0.530 Test Loss: 1.092 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2708449363708496
Epoch: 5, Steps: 18 | Train Loss: 0.437 Vali Loss: 1.193 Vali Acc: 0.550 Test Loss: 1.193 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.997572422027588
Epoch: 6, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.924 Vali Acc: 0.520 Test Loss: 1.924 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8496994972229004
Epoch: 7, Steps: 18 | Train Loss: 0.768 Vali Loss: 3.467 Vali Acc: 0.520 Test Loss: 3.467 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.205409526824951
Epoch: 8, Steps: 18 | Train Loss: 0.858 Vali Loss: 2.484 Vali Acc: 0.520 Test Loss: 2.484 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2644999027252197
Epoch: 9, Steps: 18 | Train Loss: 0.362 Vali Loss: 2.386 Vali Acc: 0.480 Test Loss: 2.386 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1881909370422363
Epoch: 10, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.850 Vali Acc: 0.520 Test Loss: 2.850 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.9239437580108643
Epoch: 11, Steps: 18 | Train Loss: 0.317 Vali Loss: 2.925 Vali Acc: 0.520 Test Loss: 2.925 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.927692174911499
Epoch: 12, Steps: 18 | Train Loss: 0.294 Vali Loss: 4.244 Vali Acc: 0.530 Test Loss: 4.244 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 327938
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.763546705245972
Epoch: 1, Steps: 18 | Train Loss: 0.868 Vali Loss: 0.714 Vali Acc: 0.510 Test Loss: 0.714 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 3.210824728012085
Epoch: 2, Steps: 18 | Train Loss: 0.765 Vali Loss: 1.119 Vali Acc: 0.540 Test Loss: 1.119 Test Acc: 0.540
Validation loss decreased (-0.509993 --> -0.539989).  Saving model ...
Epoch: 3 cost time: 3.090557813644409
Epoch: 3, Steps: 18 | Train Loss: 0.941 Vali Loss: 1.037 Vali Acc: 0.550 Test Loss: 1.037 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 3.2401676177978516
Epoch: 4, Steps: 18 | Train Loss: 1.044 Vali Loss: 2.083 Vali Acc: 0.540 Test Loss: 2.083 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1563773155212402
Epoch: 5, Steps: 18 | Train Loss: 0.587 Vali Loss: 1.692 Vali Acc: 0.590 Test Loss: 1.692 Test Acc: 0.590
Validation loss decreased (-0.549990 --> -0.589983).  Saving model ...
Epoch: 6 cost time: 3.0963218212127686
Epoch: 6, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.723 Vali Acc: 0.590 Test Loss: 1.723 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0956854820251465
Epoch: 7, Steps: 18 | Train Loss: 0.616 Vali Loss: 1.701 Vali Acc: 0.560 Test Loss: 1.701 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.979827642440796
Epoch: 8, Steps: 18 | Train Loss: 0.429 Vali Loss: 2.172 Vali Acc: 0.540 Test Loss: 2.172 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.046616554260254
Epoch: 9, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.924 Vali Acc: 0.530 Test Loss: 1.924 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.108937978744507
Epoch: 10, Steps: 18 | Train Loss: 0.389 Vali Loss: 3.218 Vali Acc: 0.560 Test Loss: 3.218 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1853935718536377
Epoch: 11, Steps: 18 | Train Loss: 0.338 Vali Loss: 2.034 Vali Acc: 0.560 Test Loss: 2.034 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.116631031036377
Epoch: 12, Steps: 18 | Train Loss: 0.294 Vali Loss: 2.882 Vali Acc: 0.500 Test Loss: 2.882 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.13456654548645
Epoch: 13, Steps: 18 | Train Loss: 0.266 Vali Loss: 3.177 Vali Acc: 0.540 Test Loss: 3.177 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1945886611938477
Epoch: 14, Steps: 18 | Train Loss: 0.321 Vali Loss: 3.572 Vali Acc: 0.520 Test Loss: 3.572 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.20173978805542
Epoch: 15, Steps: 18 | Train Loss: 0.150 Vali Loss: 3.220 Vali Acc: 0.540 Test Loss: 3.220 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 283586
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.071077346801758
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.747 Vali Acc: 0.450 Test Loss: 0.747 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.3349382877349854
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.890 Vali Acc: 0.470 Test Loss: 0.890 Test Acc: 0.470
Validation loss decreased (-0.449993 --> -0.469991).  Saving model ...
Epoch: 3 cost time: 2.284815788269043
Epoch: 3, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.922 Vali Acc: 0.540 Test Loss: 0.922 Test Acc: 0.540
Validation loss decreased (-0.469991 --> -0.539991).  Saving model ...
Epoch: 4 cost time: 2.300076723098755
Epoch: 4, Steps: 18 | Train Loss: 0.551 Vali Loss: 1.811 Vali Acc: 0.490 Test Loss: 1.811 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.248251438140869
Epoch: 5, Steps: 18 | Train Loss: 0.545 Vali Loss: 1.204 Vali Acc: 0.520 Test Loss: 1.204 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.332296133041382
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.229 Vali Acc: 0.560 Test Loss: 1.229 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559988).  Saving model ...
Epoch: 7 cost time: 2.3127708435058594
Epoch: 7, Steps: 18 | Train Loss: 0.391 Vali Loss: 2.185 Vali Acc: 0.520 Test Loss: 2.185 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.33915376663208
Epoch: 8, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.886 Vali Acc: 0.490 Test Loss: 1.886 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4764838218688965
Epoch: 9, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.955 Vali Acc: 0.500 Test Loss: 1.955 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2194342613220215
Epoch: 10, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.751 Vali Acc: 0.510 Test Loss: 1.751 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2826030254364014
Epoch: 11, Steps: 18 | Train Loss: 0.160 Vali Loss: 2.825 Vali Acc: 0.460 Test Loss: 2.825 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3985650539398193
Epoch: 12, Steps: 18 | Train Loss: 0.196 Vali Loss: 2.180 Vali Acc: 0.550 Test Loss: 2.180 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.194336175918579
Epoch: 13, Steps: 18 | Train Loss: 0.306 Vali Loss: 2.481 Vali Acc: 0.500 Test Loss: 2.481 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3840444087982178
Epoch: 14, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.882 Vali Acc: 0.550 Test Loss: 2.882 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.24357533454895
Epoch: 15, Steps: 18 | Train Loss: 0.212 Vali Loss: 3.022 Vali Acc: 0.510 Test Loss: 3.022 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.239555835723877
Epoch: 16, Steps: 18 | Train Loss: 0.169 Vali Loss: 2.898 Vali Acc: 0.510 Test Loss: 2.898 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 235842
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7921178340911865
Epoch: 1, Steps: 18 | Train Loss: 0.858 Vali Loss: 0.795 Vali Acc: 0.520 Test Loss: 0.795 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.004521608352661
Epoch: 2, Steps: 18 | Train Loss: 0.680 Vali Loss: 0.845 Vali Acc: 0.500 Test Loss: 0.845 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.027345895767212
Epoch: 3, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.930 Vali Acc: 0.560 Test Loss: 0.930 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559991).  Saving model ...
Epoch: 4 cost time: 2.1388638019561768
Epoch: 4, Steps: 18 | Train Loss: 0.565 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.112550973892212
Epoch: 5, Steps: 18 | Train Loss: 0.560 Vali Loss: 1.068 Vali Acc: 0.520 Test Loss: 1.068 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.035780668258667
Epoch: 6, Steps: 18 | Train Loss: 0.566 Vali Loss: 1.405 Vali Acc: 0.580 Test Loss: 1.405 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579986).  Saving model ...
Epoch: 7 cost time: 2.107492685317993
Epoch: 7, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.282 Vali Acc: 0.520 Test Loss: 1.282 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.094902276992798
Epoch: 8, Steps: 18 | Train Loss: 0.391 Vali Loss: 1.706 Vali Acc: 0.460 Test Loss: 1.706 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1154239177703857
Epoch: 9, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.312 Vali Acc: 0.570 Test Loss: 1.312 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.239652156829834
Epoch: 10, Steps: 18 | Train Loss: 0.408 Vali Loss: 1.402 Vali Acc: 0.510 Test Loss: 1.402 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9231657981872559
Epoch: 11, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.350 Vali Acc: 0.600 Test Loss: 1.350 Test Acc: 0.600
Validation loss decreased (-0.579986 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 1.912667989730835
Epoch: 12, Steps: 18 | Train Loss: 0.242 Vali Loss: 2.195 Vali Acc: 0.550 Test Loss: 2.195 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9240336418151855
Epoch: 13, Steps: 18 | Train Loss: 0.236 Vali Loss: 1.751 Vali Acc: 0.560 Test Loss: 1.751 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.065375566482544
Epoch: 14, Steps: 18 | Train Loss: 0.173 Vali Loss: 2.002 Vali Acc: 0.530 Test Loss: 2.002 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.938100814819336
Epoch: 15, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.896 Vali Acc: 0.570 Test Loss: 1.896 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0139317512512207
Epoch: 16, Steps: 18 | Train Loss: 0.074 Vali Loss: 2.405 Vali Acc: 0.520 Test Loss: 2.405 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.12603497505188
Epoch: 17, Steps: 18 | Train Loss: 0.116 Vali Loss: 2.296 Vali Acc: 0.560 Test Loss: 2.296 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2691993713378906
Epoch: 18, Steps: 18 | Train Loss: 0.086 Vali Loss: 2.285 Vali Acc: 0.550 Test Loss: 2.285 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2899680137634277
Epoch: 19, Steps: 18 | Train Loss: 0.077 Vali Loss: 2.483 Vali Acc: 0.500 Test Loss: 2.483 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2271809577941895
Epoch: 20, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.924 Vali Acc: 0.540 Test Loss: 2.924 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2522029876708984
Epoch: 21, Steps: 18 | Train Loss: 0.097 Vali Loss: 2.299 Vali Acc: 0.580 Test Loss: 2.299 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 220866
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7803306579589844
Epoch: 1, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.670 Vali Acc: 0.610 Test Loss: 0.670 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 1.9745872020721436
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9931843280792236
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.781 Vali Acc: 0.550 Test Loss: 0.781 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9168329238891602
Epoch: 4, Steps: 18 | Train Loss: 0.573 Vali Loss: 1.083 Vali Acc: 0.590 Test Loss: 1.083 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.971362590789795
Epoch: 5, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.872 Vali Acc: 0.540 Test Loss: 0.872 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9191582202911377
Epoch: 6, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.968 Vali Acc: 0.560 Test Loss: 0.968 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1124391555786133
Epoch: 7, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.941 Vali Acc: 0.620 Test Loss: 0.941 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619991).  Saving model ...
Epoch: 8 cost time: 1.9794471263885498
Epoch: 8, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.188 Vali Acc: 0.550 Test Loss: 1.188 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9683315753936768
Epoch: 9, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.315 Vali Acc: 0.490 Test Loss: 1.315 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9825935363769531
Epoch: 10, Steps: 18 | Train Loss: 0.229 Vali Loss: 1.739 Vali Acc: 0.480 Test Loss: 1.739 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8560216426849365
Epoch: 11, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0052778720855713
Epoch: 12, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.955 Vali Acc: 0.520 Test Loss: 1.955 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9324233531951904
Epoch: 13, Steps: 18 | Train Loss: 0.205 Vali Loss: 1.914 Vali Acc: 0.480 Test Loss: 1.914 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9085345268249512
Epoch: 14, Steps: 18 | Train Loss: 0.158 Vali Loss: 1.810 Vali Acc: 0.550 Test Loss: 1.810 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.982189416885376
Epoch: 15, Steps: 18 | Train Loss: 0.147 Vali Loss: 2.299 Vali Acc: 0.490 Test Loss: 2.299 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.043823480606079
Epoch: 16, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.972 Vali Acc: 0.580 Test Loss: 1.972 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9472455978393555
Epoch: 17, Steps: 18 | Train Loss: 0.069 Vali Loss: 2.084 Vali Acc: 0.540 Test Loss: 2.084 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 214082
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 12.014475107192993
Epoch: 1, Steps: 18 | Train Loss: 2.046 Vali Loss: 1.683 Vali Acc: 0.640 Test Loss: 1.683 Test Acc: 0.640
Validation loss decreased (inf --> -0.639983).  Saving model ...
Epoch: 2 cost time: 10.318032503128052
Epoch: 2, Steps: 18 | Train Loss: 1.782 Vali Loss: 2.302 Vali Acc: 0.540 Test Loss: 2.302 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.038211107254028
Epoch: 3, Steps: 18 | Train Loss: 1.390 Vali Loss: 2.328 Vali Acc: 0.570 Test Loss: 2.328 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.103586435317993
Epoch: 4, Steps: 18 | Train Loss: 1.194 Vali Loss: 4.327 Vali Acc: 0.550 Test Loss: 4.327 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.8685781955719
Epoch: 5, Steps: 18 | Train Loss: 1.245 Vali Loss: 4.881 Vali Acc: 0.540 Test Loss: 4.881 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.881016731262207
Epoch: 6, Steps: 18 | Train Loss: 1.631 Vali Loss: 3.274 Vali Acc: 0.510 Test Loss: 3.274 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.71571946144104
Epoch: 7, Steps: 18 | Train Loss: 1.060 Vali Loss: 5.184 Vali Acc: 0.520 Test Loss: 5.184 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.093687057495117
Epoch: 8, Steps: 18 | Train Loss: 1.621 Vali Loss: 4.325 Vali Acc: 0.490 Test Loss: 4.325 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.92939019203186
Epoch: 9, Steps: 18 | Train Loss: 1.208 Vali Loss: 7.056 Vali Acc: 0.540 Test Loss: 7.056 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 8.010671854019165
Epoch: 10, Steps: 18 | Train Loss: 0.795 Vali Loss: 7.802 Vali Acc: 0.460 Test Loss: 7.802 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 8.780120849609375
Epoch: 11, Steps: 18 | Train Loss: 1.247 Vali Loss: 8.081 Vali Acc: 0.490 Test Loss: 8.081 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 719554
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.179227590560913
Epoch: 1, Steps: 18 | Train Loss: 0.809 Vali Loss: 1.686 Vali Acc: 0.460 Test Loss: 1.686 Test Acc: 0.460
Validation loss decreased (inf --> -0.459983).  Saving model ...
Epoch: 2 cost time: 4.525830268859863
Epoch: 2, Steps: 18 | Train Loss: 1.070 Vali Loss: 1.280 Vali Acc: 0.480 Test Loss: 1.280 Test Acc: 0.480
Validation loss decreased (-0.459983 --> -0.479987).  Saving model ...
Epoch: 3 cost time: 4.554287433624268
Epoch: 3, Steps: 18 | Train Loss: 0.643 Vali Loss: 1.351 Vali Acc: 0.570 Test Loss: 1.351 Test Acc: 0.570
Validation loss decreased (-0.479987 --> -0.569986).  Saving model ...
Epoch: 4 cost time: 4.573901891708374
Epoch: 4, Steps: 18 | Train Loss: 0.506 Vali Loss: 1.833 Vali Acc: 0.560 Test Loss: 1.833 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.510343790054321
Epoch: 5, Steps: 18 | Train Loss: 0.553 Vali Loss: 2.817 Vali Acc: 0.490 Test Loss: 2.817 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.475929260253906
Epoch: 6, Steps: 18 | Train Loss: 0.665 Vali Loss: 2.179 Vali Acc: 0.490 Test Loss: 2.179 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.443955659866333
Epoch: 7, Steps: 18 | Train Loss: 0.439 Vali Loss: 2.556 Vali Acc: 0.550 Test Loss: 2.556 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.622479438781738
Epoch: 8, Steps: 18 | Train Loss: 0.369 Vali Loss: 2.802 Vali Acc: 0.540 Test Loss: 2.802 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.441782474517822
Epoch: 9, Steps: 18 | Train Loss: 0.528 Vali Loss: 4.339 Vali Acc: 0.490 Test Loss: 4.339 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.7517430782318115
Epoch: 10, Steps: 18 | Train Loss: 0.514 Vali Loss: 2.926 Vali Acc: 0.560 Test Loss: 2.926 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.790053844451904
Epoch: 11, Steps: 18 | Train Loss: 0.412 Vali Loss: 3.249 Vali Acc: 0.540 Test Loss: 3.249 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.501814842224121
Epoch: 12, Steps: 18 | Train Loss: 0.449 Vali Loss: 5.408 Vali Acc: 0.560 Test Loss: 5.408 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.6346189975738525
Epoch: 13, Steps: 18 | Train Loss: 0.487 Vali Loss: 3.778 Vali Acc: 0.610 Test Loss: 3.778 Test Acc: 0.610
Validation loss decreased (-0.569986 --> -0.609962).  Saving model ...
Epoch: 14 cost time: 4.812344074249268
Epoch: 14, Steps: 18 | Train Loss: 0.377 Vali Loss: 4.436 Vali Acc: 0.530 Test Loss: 4.436 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.637908458709717
Epoch: 15, Steps: 18 | Train Loss: 0.105 Vali Loss: 4.039 Vali Acc: 0.620 Test Loss: 4.039 Test Acc: 0.620
Validation loss decreased (-0.609962 --> -0.619960).  Saving model ...
Epoch: 16 cost time: 4.639118909835815
Epoch: 16, Steps: 18 | Train Loss: 0.543 Vali Loss: 6.321 Vali Acc: 0.490 Test Loss: 6.321 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.738719463348389
Epoch: 17, Steps: 18 | Train Loss: 0.350 Vali Loss: 8.136 Vali Acc: 0.530 Test Loss: 8.136 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.524949550628662
Epoch: 18, Steps: 18 | Train Loss: 0.689 Vali Loss: 7.290 Vali Acc: 0.480 Test Loss: 7.290 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.497454881668091
Epoch: 19, Steps: 18 | Train Loss: 0.779 Vali Loss: 5.745 Vali Acc: 0.490 Test Loss: 5.745 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.654975891113281
Epoch: 20, Steps: 18 | Train Loss: 0.189 Vali Loss: 7.106 Vali Acc: 0.500 Test Loss: 7.106 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.573545932769775
Epoch: 21, Steps: 18 | Train Loss: 0.531 Vali Loss: 9.404 Vali Acc: 0.530 Test Loss: 9.404 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.74558424949646
Epoch: 22, Steps: 18 | Train Loss: 0.822 Vali Loss: 11.189 Vali Acc: 0.530 Test Loss: 11.189 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.617175340652466
Epoch: 23, Steps: 18 | Train Loss: 0.339 Vali Loss: 10.196 Vali Acc: 0.520 Test Loss: 10.196 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.808958292007446
Epoch: 24, Steps: 18 | Train Loss: 0.271 Vali Loss: 9.128 Vali Acc: 0.480 Test Loss: 9.128 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.756856679916382
Epoch: 25, Steps: 18 | Train Loss: 0.181 Vali Loss: 7.348 Vali Acc: 0.510 Test Loss: 7.348 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 413058
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.607025623321533
Epoch: 1, Steps: 18 | Train Loss: 0.871 Vali Loss: 1.214 Vali Acc: 0.480 Test Loss: 1.214 Test Acc: 0.480
Validation loss decreased (inf --> -0.479988).  Saving model ...
Epoch: 2 cost time: 3.0874996185302734
Epoch: 2, Steps: 18 | Train Loss: 0.942 Vali Loss: 0.807 Vali Acc: 0.590 Test Loss: 0.807 Test Acc: 0.590
Validation loss decreased (-0.479988 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 3.6211130619049072
Epoch: 3, Steps: 18 | Train Loss: 0.912 Vali Loss: 3.053 Vali Acc: 0.520 Test Loss: 3.053 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0976829528808594
Epoch: 4, Steps: 18 | Train Loss: 0.693 Vali Loss: 1.019 Vali Acc: 0.590 Test Loss: 1.019 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5339691638946533
Epoch: 5, Steps: 18 | Train Loss: 0.585 Vali Loss: 1.397 Vali Acc: 0.520 Test Loss: 1.397 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.303318977355957
Epoch: 6, Steps: 18 | Train Loss: 0.514 Vali Loss: 1.914 Vali Acc: 0.620 Test Loss: 1.914 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619981).  Saving model ...
Epoch: 7 cost time: 3.330763816833496
Epoch: 7, Steps: 18 | Train Loss: 0.400 Vali Loss: 2.190 Vali Acc: 0.500 Test Loss: 2.190 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.059640407562256
Epoch: 8, Steps: 18 | Train Loss: 0.625 Vali Loss: 2.410 Vali Acc: 0.480 Test Loss: 2.410 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3814873695373535
Epoch: 9, Steps: 18 | Train Loss: 0.379 Vali Loss: 3.477 Vali Acc: 0.450 Test Loss: 3.477 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9926412105560303
Epoch: 10, Steps: 18 | Train Loss: 0.445 Vali Loss: 3.479 Vali Acc: 0.480 Test Loss: 3.479 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7791733741760254
Epoch: 11, Steps: 18 | Train Loss: 0.281 Vali Loss: 4.394 Vali Acc: 0.490 Test Loss: 4.394 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9198403358459473
Epoch: 12, Steps: 18 | Train Loss: 0.513 Vali Loss: 3.161 Vali Acc: 0.580 Test Loss: 3.161 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7977025508880615
Epoch: 13, Steps: 18 | Train Loss: 0.363 Vali Loss: 3.970 Vali Acc: 0.550 Test Loss: 3.970 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.964918375015259
Epoch: 14, Steps: 18 | Train Loss: 0.338 Vali Loss: 4.332 Vali Acc: 0.470 Test Loss: 4.332 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.838418960571289
Epoch: 15, Steps: 18 | Train Loss: 0.138 Vali Loss: 4.349 Vali Acc: 0.470 Test Loss: 4.349 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.9994966983795166
Epoch: 16, Steps: 18 | Train Loss: 0.273 Vali Loss: 7.204 Vali Acc: 0.500 Test Loss: 7.204 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 303170
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.349813938140869
Epoch: 1, Steps: 18 | Train Loss: 0.852 Vali Loss: 0.964 Vali Acc: 0.490 Test Loss: 0.964 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 3.6693506240844727
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.961 Vali Acc: 0.600 Test Loss: 0.961 Test Acc: 0.600
Validation loss decreased (-0.489990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 3.5982000827789307
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.924 Vali Acc: 0.560 Test Loss: 0.924 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4030709266662598
Epoch: 4, Steps: 18 | Train Loss: 0.655 Vali Loss: 1.135 Vali Acc: 0.480 Test Loss: 1.135 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.226821184158325
Epoch: 5, Steps: 18 | Train Loss: 0.450 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.458176851272583
Epoch: 6, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.748 Vali Acc: 0.510 Test Loss: 1.748 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.414691686630249
Epoch: 7, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.376 Vali Acc: 0.560 Test Loss: 1.376 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.914849758148193
Epoch: 8, Steps: 18 | Train Loss: 0.312 Vali Loss: 2.065 Vali Acc: 0.520 Test Loss: 2.065 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.810914754867554
Epoch: 9, Steps: 18 | Train Loss: 0.249 Vali Loss: 2.666 Vali Acc: 0.500 Test Loss: 2.666 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.939861536026001
Epoch: 10, Steps: 18 | Train Loss: 0.353 Vali Loss: 2.956 Vali Acc: 0.450 Test Loss: 2.956 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.361040353775024
Epoch: 11, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.998 Vali Acc: 0.540 Test Loss: 1.998 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.409364700317383
Epoch: 12, Steps: 18 | Train Loss: 0.380 Vali Loss: 2.704 Vali Acc: 0.590 Test Loss: 2.704 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 258818
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.882987022399902
Epoch: 1, Steps: 18 | Train Loss: 0.870 Vali Loss: 0.717 Vali Acc: 0.600 Test Loss: 0.717 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 3.2354371547698975
Epoch: 2, Steps: 18 | Train Loss: 0.791 Vali Loss: 0.793 Vali Acc: 0.620 Test Loss: 0.793 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619992).  Saving model ...
Epoch: 3 cost time: 3.418308973312378
Epoch: 3, Steps: 18 | Train Loss: 0.806 Vali Loss: 1.002 Vali Acc: 0.530 Test Loss: 1.002 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4358561038970947
Epoch: 4, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.999 Vali Acc: 0.490 Test Loss: 0.999 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7056729793548584
Epoch: 5, Steps: 18 | Train Loss: 0.457 Vali Loss: 1.317 Vali Acc: 0.520 Test Loss: 1.317 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.810788869857788
Epoch: 6, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.6962075233459473
Epoch: 7, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.968 Vali Acc: 0.470 Test Loss: 1.968 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.688406229019165
Epoch: 8, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.541 Vali Acc: 0.450 Test Loss: 1.541 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.3849833011627197
Epoch: 9, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.727 Vali Acc: 0.520 Test Loss: 1.727 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1924705505371094
Epoch: 10, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.640 Vali Acc: 0.510 Test Loss: 1.640 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.164895534515381
Epoch: 11, Steps: 18 | Train Loss: 0.172 Vali Loss: 2.706 Vali Acc: 0.530 Test Loss: 2.706 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.5313844680786133
Epoch: 12, Steps: 18 | Train Loss: 0.498 Vali Loss: 2.487 Vali Acc: 0.500 Test Loss: 2.487 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 211074
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.541202783584595
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.723 Vali Acc: 0.530 Test Loss: 0.723 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 3.415519952774048
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.932 Vali Acc: 0.500 Test Loss: 0.932 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3006834983825684
Epoch: 3, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.890 Vali Acc: 0.580 Test Loss: 0.890 Test Acc: 0.580
Validation loss decreased (-0.529993 --> -0.579991).  Saving model ...
Epoch: 4 cost time: 3.176989793777466
Epoch: 4, Steps: 18 | Train Loss: 0.521 Vali Loss: 1.143 Vali Acc: 0.450 Test Loss: 1.143 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4526443481445312
Epoch: 5, Steps: 18 | Train Loss: 0.608 Vali Loss: 1.197 Vali Acc: 0.610 Test Loss: 1.197 Test Acc: 0.610
Validation loss decreased (-0.579991 --> -0.609988).  Saving model ...
Epoch: 6 cost time: 2.5291481018066406
Epoch: 6, Steps: 18 | Train Loss: 0.700 Vali Loss: 1.472 Vali Acc: 0.450 Test Loss: 1.472 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9371232986450195
Epoch: 7, Steps: 18 | Train Loss: 0.400 Vali Loss: 1.115 Vali Acc: 0.550 Test Loss: 1.115 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.095669746398926
Epoch: 8, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.638 Vali Acc: 0.450 Test Loss: 1.638 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.500739097595215
Epoch: 9, Steps: 18 | Train Loss: 0.326 Vali Loss: 1.317 Vali Acc: 0.530 Test Loss: 1.317 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4465553760528564
Epoch: 10, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.428 Vali Acc: 0.580 Test Loss: 1.428 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.383979558944702
Epoch: 11, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.737 Vali Acc: 0.570 Test Loss: 1.737 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7925004959106445
Epoch: 12, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.912 Vali Acc: 0.500 Test Loss: 1.912 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.97770357131958
Epoch: 13, Steps: 18 | Train Loss: 0.132 Vali Loss: 1.891 Vali Acc: 0.580 Test Loss: 1.891 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9881253242492676
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 2.333 Vali Acc: 0.560 Test Loss: 2.333 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.4453861713409424
Epoch: 15, Steps: 18 | Train Loss: 0.129 Vali Loss: 2.131 Vali Acc: 0.530 Test Loss: 2.131 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 196098
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.734179973602295
Epoch: 1, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.0028483867645264
Epoch: 2, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.822 Vali Acc: 0.610 Test Loss: 0.822 Test Acc: 0.610
Validation loss decreased (-0.509992 --> -0.609992).  Saving model ...
Epoch: 3 cost time: 3.003352642059326
Epoch: 3, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.922 Vali Acc: 0.480 Test Loss: 0.922 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9594314098358154
Epoch: 4, Steps: 18 | Train Loss: 0.480 Vali Loss: 0.896 Vali Acc: 0.630 Test Loss: 0.896 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629991).  Saving model ...
Epoch: 5 cost time: 3.4647409915924072
Epoch: 5, Steps: 18 | Train Loss: 0.627 Vali Loss: 1.151 Vali Acc: 0.510 Test Loss: 1.151 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.36242938041687
Epoch: 6, Steps: 18 | Train Loss: 0.500 Vali Loss: 1.076 Vali Acc: 0.590 Test Loss: 1.076 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3075740337371826
Epoch: 7, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.072 Vali Acc: 0.540 Test Loss: 1.072 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.418569326400757
Epoch: 8, Steps: 18 | Train Loss: 0.369 Vali Loss: 1.551 Vali Acc: 0.550 Test Loss: 1.551 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.018521785736084
Epoch: 9, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.151 Vali Acc: 0.550 Test Loss: 1.151 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.111119270324707
Epoch: 10, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.471 Vali Acc: 0.560 Test Loss: 1.471 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2043097019195557
Epoch: 11, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.835 Vali Acc: 0.490 Test Loss: 1.835 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.110356330871582
Epoch: 12, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.703 Vali Acc: 0.510 Test Loss: 1.703 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.511997699737549
Epoch: 13, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.967 Vali Acc: 0.500 Test Loss: 1.967 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.498293876647949
Epoch: 14, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.739 Vali Acc: 0.490 Test Loss: 1.739 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm64_nh16_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 189314
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.896991014480591
Epoch: 1, Steps: 18 | Train Loss: 0.956 Vali Loss: 1.359 Vali Acc: 0.420 Test Loss: 1.359 Test Acc: 0.420
Validation loss decreased (inf --> -0.419986).  Saving model ...
Epoch: 2 cost time: 6.602565288543701
Epoch: 2, Steps: 18 | Train Loss: 0.994 Vali Loss: 1.520 Vali Acc: 0.490 Test Loss: 1.520 Test Acc: 0.490
Validation loss decreased (-0.419986 --> -0.489985).  Saving model ...
Epoch: 3 cost time: 6.599896430969238
Epoch: 3, Steps: 18 | Train Loss: 1.113 Vali Loss: 1.354 Vali Acc: 0.510 Test Loss: 1.354 Test Acc: 0.510
Validation loss decreased (-0.489985 --> -0.509986).  Saving model ...
Epoch: 4 cost time: 5.850397348403931
Epoch: 4, Steps: 18 | Train Loss: 0.996 Vali Loss: 3.328 Vali Acc: 0.520 Test Loss: 3.328 Test Acc: 0.520
Validation loss decreased (-0.509986 --> -0.519967).  Saving model ...
Epoch: 5 cost time: 5.913978815078735
Epoch: 5, Steps: 18 | Train Loss: 0.901 Vali Loss: 1.670 Vali Acc: 0.490 Test Loss: 1.670 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.992005825042725
Epoch: 6, Steps: 18 | Train Loss: 0.813 Vali Loss: 2.454 Vali Acc: 0.550 Test Loss: 2.454 Test Acc: 0.550
Validation loss decreased (-0.519967 --> -0.549975).  Saving model ...
Epoch: 7 cost time: 6.405785083770752
Epoch: 7, Steps: 18 | Train Loss: 0.702 Vali Loss: 5.266 Vali Acc: 0.520 Test Loss: 5.266 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.075023651123047
Epoch: 8, Steps: 18 | Train Loss: 1.179 Vali Loss: 3.118 Vali Acc: 0.500 Test Loss: 3.118 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.360152006149292
Epoch: 9, Steps: 18 | Train Loss: 0.937 Vali Loss: 4.963 Vali Acc: 0.510 Test Loss: 4.963 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.885219097137451
Epoch: 10, Steps: 18 | Train Loss: 0.378 Vali Loss: 4.233 Vali Acc: 0.440 Test Loss: 4.233 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.875616073608398
Epoch: 11, Steps: 18 | Train Loss: 0.402 Vali Loss: 4.745 Vali Acc: 0.470 Test Loss: 4.745 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.967564821243286
Epoch: 12, Steps: 18 | Train Loss: 0.947 Vali Loss: 6.686 Vali Acc: 0.500 Test Loss: 6.686 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.344258546829224
Epoch: 13, Steps: 18 | Train Loss: 0.525 Vali Loss: 6.461 Vali Acc: 0.460 Test Loss: 6.461 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.481289863586426
Epoch: 14, Steps: 18 | Train Loss: 0.399 Vali Loss: 8.012 Vali Acc: 0.520 Test Loss: 8.012 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.807416915893555
Epoch: 15, Steps: 18 | Train Loss: 0.591 Vali Loss: 7.053 Vali Acc: 0.450 Test Loss: 7.053 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.5469629764556885
Epoch: 16, Steps: 18 | Train Loss: 0.204 Vali Loss: 5.284 Vali Acc: 0.480 Test Loss: 5.284 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.55
model parameter : 385026
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.22238302230835
Epoch: 1, Steps: 18 | Train Loss: 0.836 Vali Loss: 1.092 Vali Acc: 0.490 Test Loss: 1.092 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 3.321939706802368
Epoch: 2, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.854 Vali Acc: 0.540 Test Loss: 0.854 Test Acc: 0.540
Validation loss decreased (-0.489989 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 2.957947015762329
Epoch: 3, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.917 Vali Acc: 0.560 Test Loss: 0.917 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559991).  Saving model ...
Epoch: 4 cost time: 3.243533134460449
Epoch: 4, Steps: 18 | Train Loss: 0.623 Vali Loss: 1.252 Vali Acc: 0.480 Test Loss: 1.252 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.38073992729187
Epoch: 5, Steps: 18 | Train Loss: 0.479 Vali Loss: 1.261 Vali Acc: 0.530 Test Loss: 1.261 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5421950817108154
Epoch: 6, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.421 Vali Acc: 0.530 Test Loss: 1.421 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6670360565185547
Epoch: 7, Steps: 18 | Train Loss: 0.522 Vali Loss: 2.324 Vali Acc: 0.580 Test Loss: 2.324 Test Acc: 0.580
Validation loss decreased (-0.559991 --> -0.579977).  Saving model ...
Epoch: 8 cost time: 3.7482824325561523
Epoch: 8, Steps: 18 | Train Loss: 0.344 Vali Loss: 2.248 Vali Acc: 0.540 Test Loss: 2.248 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2747583389282227
Epoch: 9, Steps: 18 | Train Loss: 0.554 Vali Loss: 4.293 Vali Acc: 0.550 Test Loss: 4.293 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0121400356292725
Epoch: 10, Steps: 18 | Train Loss: 0.431 Vali Loss: 2.187 Vali Acc: 0.540 Test Loss: 2.187 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.891118288040161
Epoch: 11, Steps: 18 | Train Loss: 0.296 Vali Loss: 3.513 Vali Acc: 0.570 Test Loss: 3.513 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6132493019104004
Epoch: 12, Steps: 18 | Train Loss: 0.463 Vali Loss: 4.105 Vali Acc: 0.470 Test Loss: 4.105 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7974438667297363
Epoch: 13, Steps: 18 | Train Loss: 0.481 Vali Loss: 3.217 Vali Acc: 0.500 Test Loss: 3.217 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.7779862880706787
Epoch: 14, Steps: 18 | Train Loss: 0.303 Vali Loss: 3.879 Vali Acc: 0.510 Test Loss: 3.879 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.576650857925415
Epoch: 15, Steps: 18 | Train Loss: 0.254 Vali Loss: 2.894 Vali Acc: 0.540 Test Loss: 2.894 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.3860788345336914
Epoch: 16, Steps: 18 | Train Loss: 0.200 Vali Loss: 2.375 Vali Acc: 0.600 Test Loss: 2.375 Test Acc: 0.600
Validation loss decreased (-0.579977 --> -0.599976).  Saving model ...
Epoch: 17 cost time: 3.3331809043884277
Epoch: 17, Steps: 18 | Train Loss: 0.122 Vali Loss: 3.459 Vali Acc: 0.500 Test Loss: 3.459 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3851709365844727
Epoch: 18, Steps: 18 | Train Loss: 0.080 Vali Loss: 3.308 Vali Acc: 0.580 Test Loss: 3.308 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0803890228271484
Epoch: 19, Steps: 18 | Train Loss: 0.026 Vali Loss: 4.031 Vali Acc: 0.540 Test Loss: 4.031 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.549555778503418
Epoch: 20, Steps: 18 | Train Loss: 0.037 Vali Loss: 4.317 Vali Acc: 0.570 Test Loss: 4.317 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.453383207321167
Epoch: 21, Steps: 18 | Train Loss: 0.094 Vali Loss: 4.565 Vali Acc: 0.520 Test Loss: 4.565 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.606072187423706
Epoch: 22, Steps: 18 | Train Loss: 0.023 Vali Loss: 4.392 Vali Acc: 0.530 Test Loss: 4.392 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.653820753097534
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 4.486 Vali Acc: 0.540 Test Loss: 4.486 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.7701191902160645
Epoch: 24, Steps: 18 | Train Loss: 0.014 Vali Loss: 5.875 Vali Acc: 0.520 Test Loss: 5.875 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.8481318950653076
Epoch: 25, Steps: 18 | Train Loss: 0.092 Vali Loss: 6.186 Vali Acc: 0.510 Test Loss: 6.186 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.555818557739258
Epoch: 26, Steps: 18 | Train Loss: 0.021 Vali Loss: 8.689 Vali Acc: 0.490 Test Loss: 8.689 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 231778
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.158864974975586
Epoch: 1, Steps: 18 | Train Loss: 0.827 Vali Loss: 0.733 Vali Acc: 0.620 Test Loss: 0.733 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 2.8387863636016846
Epoch: 2, Steps: 18 | Train Loss: 0.706 Vali Loss: 0.681 Vali Acc: 0.620 Test Loss: 0.681 Test Acc: 0.620
Validation loss decreased (-0.619993 --> -0.619993).  Saving model ...
Epoch: 3 cost time: 2.786961078643799
Epoch: 3, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.885 Vali Acc: 0.610 Test Loss: 0.885 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.950575590133667
Epoch: 4, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.823 Vali Acc: 0.530 Test Loss: 0.823 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9842824935913086
Epoch: 5, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.929 Vali Acc: 0.560 Test Loss: 0.929 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0081214904785156
Epoch: 6, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.989 Vali Acc: 0.510 Test Loss: 0.989 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9585628509521484
Epoch: 7, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.473 Vali Acc: 0.510 Test Loss: 1.473 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.7475035190582275
Epoch: 8, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.880 Vali Acc: 0.550 Test Loss: 1.880 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7722063064575195
Epoch: 9, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.356 Vali Acc: 0.540 Test Loss: 1.356 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.651859998703003
Epoch: 10, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.490 Vali Acc: 0.570 Test Loss: 1.490 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.776366949081421
Epoch: 11, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.952 Vali Acc: 0.500 Test Loss: 1.952 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.597520589828491
Epoch: 12, Steps: 18 | Train Loss: 0.162 Vali Loss: 2.329 Vali Acc: 0.490 Test Loss: 2.329 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 176834
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8242249488830566
Epoch: 1, Steps: 18 | Train Loss: 0.809 Vali Loss: 0.680 Vali Acc: 0.570 Test Loss: 0.680 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.3468263149261475
Epoch: 2, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.683 Vali Acc: 0.540 Test Loss: 0.683 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3520455360412598
Epoch: 3, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.863 Vali Acc: 0.570 Test Loss: 0.863 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3054847717285156
Epoch: 4, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.885 Vali Acc: 0.510 Test Loss: 0.885 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5241034030914307
Epoch: 5, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.809 Vali Acc: 0.600 Test Loss: 0.809 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 2.5318844318389893
Epoch: 6, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.071 Vali Acc: 0.590 Test Loss: 1.071 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.55304217338562
Epoch: 7, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.277 Vali Acc: 0.520 Test Loss: 1.277 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7640926837921143
Epoch: 8, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.517 Vali Acc: 0.530 Test Loss: 1.517 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.604630708694458
Epoch: 9, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.560 Vali Acc: 0.490 Test Loss: 1.560 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.463890314102173
Epoch: 10, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.507 Vali Acc: 0.590 Test Loss: 1.507 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.459369659423828
Epoch: 11, Steps: 18 | Train Loss: 0.239 Vali Loss: 2.084 Vali Acc: 0.470 Test Loss: 2.084 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4150846004486084
Epoch: 12, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.911 Vali Acc: 0.540 Test Loss: 1.911 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4612860679626465
Epoch: 13, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.871 Vali Acc: 0.550 Test Loss: 1.871 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3164608478546143
Epoch: 14, Steps: 18 | Train Loss: 0.126 Vali Loss: 2.494 Vali Acc: 0.520 Test Loss: 2.494 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.447399616241455
Epoch: 15, Steps: 18 | Train Loss: 0.143 Vali Loss: 2.347 Vali Acc: 0.550 Test Loss: 2.347 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 154658
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.759753942489624
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.731 Vali Acc: 0.500 Test Loss: 0.731 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 1.990062952041626
Epoch: 2, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.1327433586120605
Epoch: 3, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.715 Vali Acc: 0.580 Test Loss: 0.715 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579993).  Saving model ...
Epoch: 4 cost time: 2.1633410453796387
Epoch: 4, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.775 Vali Acc: 0.590 Test Loss: 0.775 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 2.1681809425354004
Epoch: 5, Steps: 18 | Train Loss: 0.481 Vali Loss: 0.836 Vali Acc: 0.520 Test Loss: 0.836 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.262587070465088
Epoch: 6, Steps: 18 | Train Loss: 0.454 Vali Loss: 0.950 Vali Acc: 0.540 Test Loss: 0.950 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1338608264923096
Epoch: 7, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.029 Vali Acc: 0.570 Test Loss: 1.029 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9961442947387695
Epoch: 8, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.223 Vali Acc: 0.510 Test Loss: 1.223 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0983028411865234
Epoch: 9, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.365 Vali Acc: 0.510 Test Loss: 1.365 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1632485389709473
Epoch: 10, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.224 Vali Acc: 0.550 Test Loss: 1.224 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.974609375
Epoch: 11, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.418 Vali Acc: 0.510 Test Loss: 1.418 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.00162410736084
Epoch: 12, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.641 Vali Acc: 0.480 Test Loss: 1.641 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0936691761016846
Epoch: 13, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.956 Vali Acc: 0.510 Test Loss: 1.956 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1032955646514893
Epoch: 14, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.546 Vali Acc: 0.560 Test Loss: 1.546 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 130786
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.602618932723999
Epoch: 1, Steps: 18 | Train Loss: 0.766 Vali Loss: 0.790 Vali Acc: 0.410 Test Loss: 0.790 Test Acc: 0.410
Validation loss decreased (inf --> -0.409992).  Saving model ...
Epoch: 2 cost time: 2.056717872619629
Epoch: 2, Steps: 18 | Train Loss: 0.664 Vali Loss: 0.701 Vali Acc: 0.550 Test Loss: 0.701 Test Acc: 0.550
Validation loss decreased (-0.409992 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.158019542694092
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.879 Vali Acc: 0.500 Test Loss: 0.879 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0464253425598145
Epoch: 4, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.810 Vali Acc: 0.550 Test Loss: 0.810 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8864314556121826
Epoch: 5, Steps: 18 | Train Loss: 0.544 Vali Loss: 1.117 Vali Acc: 0.540 Test Loss: 1.117 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8922572135925293
Epoch: 6, Steps: 18 | Train Loss: 0.500 Vali Loss: 0.930 Vali Acc: 0.500 Test Loss: 0.930 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0327365398406982
Epoch: 7, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.050 Vali Acc: 0.550 Test Loss: 1.050 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8294031620025635
Epoch: 8, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.064 Vali Acc: 0.490 Test Loss: 1.064 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9704711437225342
Epoch: 9, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.308 Vali Acc: 0.490 Test Loss: 1.308 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0521392822265625
Epoch: 10, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.224 Vali Acc: 0.480 Test Loss: 1.224 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.11151123046875
Epoch: 11, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.811 Vali Acc: 0.480 Test Loss: 1.811 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.118260622024536
Epoch: 12, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.473 Vali Acc: 0.560 Test Loss: 1.473 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559985).  Saving model ...
Epoch: 13 cost time: 2.0951762199401855
Epoch: 13, Steps: 18 | Train Loss: 0.168 Vali Loss: 1.642 Vali Acc: 0.490 Test Loss: 1.642 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.065079689025879
Epoch: 14, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.696 Vali Acc: 0.470 Test Loss: 1.696 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.18263578414917
Epoch: 15, Steps: 18 | Train Loss: 0.168 Vali Loss: 1.846 Vali Acc: 0.500 Test Loss: 1.846 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9413979053497314
Epoch: 16, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.801 Vali Acc: 0.480 Test Loss: 1.801 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9453458786010742
Epoch: 17, Steps: 18 | Train Loss: 0.082 Vali Loss: 1.725 Vali Acc: 0.540 Test Loss: 1.725 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9678924083709717
Epoch: 18, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.725 Vali Acc: 0.510 Test Loss: 1.725 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7712454795837402
Epoch: 19, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.010 Vali Acc: 0.520 Test Loss: 2.010 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.059511423110962
Epoch: 20, Steps: 18 | Train Loss: 0.045 Vali Loss: 1.867 Vali Acc: 0.540 Test Loss: 1.867 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.047487258911133
Epoch: 21, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.086 Vali Acc: 0.520 Test Loss: 2.086 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6954965591430664
Epoch: 22, Steps: 18 | Train Loss: 0.050 Vali Loss: 2.137 Vali Acc: 0.520 Test Loss: 2.137 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 123298
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.081271171569824
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.818 Vali Acc: 0.410 Test Loss: 0.818 Test Acc: 0.410
Validation loss decreased (inf --> -0.409992).  Saving model ...
Epoch: 2 cost time: 1.4629790782928467
Epoch: 2, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
Validation loss decreased (-0.409992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 1.5070092678070068
Epoch: 3, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.803 Vali Acc: 0.520 Test Loss: 0.803 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.540177583694458
Epoch: 4, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.739 Vali Acc: 0.490 Test Loss: 0.739 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5717782974243164
Epoch: 5, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.955 Vali Acc: 0.550 Test Loss: 0.955 Test Acc: 0.550
Validation loss decreased (-0.539992 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 1.4326825141906738
Epoch: 6, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.919 Vali Acc: 0.480 Test Loss: 0.919 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.664707899093628
Epoch: 7, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.937 Vali Acc: 0.570 Test Loss: 0.937 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569991).  Saving model ...
Epoch: 8 cost time: 1.3010685443878174
Epoch: 8, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.974 Vali Acc: 0.490 Test Loss: 0.974 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5200233459472656
Epoch: 9, Steps: 18 | Train Loss: 0.421 Vali Loss: 0.909 Vali Acc: 0.510 Test Loss: 0.909 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5185949802398682
Epoch: 10, Steps: 18 | Train Loss: 0.392 Vali Loss: 1.077 Vali Acc: 0.520 Test Loss: 1.077 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8814902305603027
Epoch: 11, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.249 Vali Acc: 0.480 Test Loss: 1.249 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.100114107131958
Epoch: 12, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0495247840881348
Epoch: 13, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.202 Vali Acc: 0.510 Test Loss: 1.202 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9339325428009033
Epoch: 14, Steps: 18 | Train Loss: 0.187 Vali Loss: 1.534 Vali Acc: 0.480 Test Loss: 1.534 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9581193923950195
Epoch: 15, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.483 Vali Acc: 0.520 Test Loss: 1.483 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.991246223449707
Epoch: 16, Steps: 18 | Train Loss: 0.116 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9151921272277832
Epoch: 17, Steps: 18 | Train Loss: 0.097 Vali Loss: 1.593 Vali Acc: 0.510 Test Loss: 1.593 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 119906
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.830199241638184
Epoch: 1, Steps: 18 | Train Loss: 1.026 Vali Loss: 1.321 Vali Acc: 0.460 Test Loss: 1.321 Test Acc: 0.460
Validation loss decreased (inf --> -0.459987).  Saving model ...
Epoch: 2 cost time: 7.652030944824219
Epoch: 2, Steps: 18 | Train Loss: 0.883 Vali Loss: 1.816 Vali Acc: 0.490 Test Loss: 1.816 Test Acc: 0.490
Validation loss decreased (-0.459987 --> -0.489982).  Saving model ...
Epoch: 3 cost time: 7.085582733154297
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.008 Vali Acc: 0.600 Test Loss: 1.008 Test Acc: 0.600
Validation loss decreased (-0.489982 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 7.270674228668213
Epoch: 4, Steps: 18 | Train Loss: 0.728 Vali Loss: 1.133 Vali Acc: 0.530 Test Loss: 1.133 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.94644021987915
Epoch: 5, Steps: 18 | Train Loss: 1.343 Vali Loss: 3.554 Vali Acc: 0.500 Test Loss: 3.554 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.472290277481079
Epoch: 6, Steps: 18 | Train Loss: 1.292 Vali Loss: 1.942 Vali Acc: 0.530 Test Loss: 1.942 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.99973464012146
Epoch: 7, Steps: 18 | Train Loss: 0.481 Vali Loss: 2.476 Vali Acc: 0.490 Test Loss: 2.476 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.163368225097656
Epoch: 8, Steps: 18 | Train Loss: 0.393 Vali Loss: 4.199 Vali Acc: 0.490 Test Loss: 4.199 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 7.35298490524292
Epoch: 9, Steps: 18 | Train Loss: 0.888 Vali Loss: 2.838 Vali Acc: 0.480 Test Loss: 2.838 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.271774053573608
Epoch: 10, Steps: 18 | Train Loss: 0.684 Vali Loss: 4.396 Vali Acc: 0.480 Test Loss: 4.396 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.955465078353882
Epoch: 11, Steps: 18 | Train Loss: 0.354 Vali Loss: 3.347 Vali Acc: 0.530 Test Loss: 3.347 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.085562705993652
Epoch: 12, Steps: 18 | Train Loss: 0.350 Vali Loss: 3.610 Vali Acc: 0.600 Test Loss: 3.610 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.303107976913452
Epoch: 13, Steps: 18 | Train Loss: 0.403 Vali Loss: 4.784 Vali Acc: 0.490 Test Loss: 4.784 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 360066
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.912651777267456
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 1.082 Vali Acc: 0.500 Test Loss: 1.082 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 3.396253824234009
Epoch: 2, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
Validation loss decreased (-0.499989 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 3.344559669494629
Epoch: 3, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.927 Vali Acc: 0.530 Test Loss: 0.927 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.444897174835205
Epoch: 4, Steps: 18 | Train Loss: 0.536 Vali Loss: 1.158 Vali Acc: 0.530 Test Loss: 1.158 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5028083324432373
Epoch: 5, Steps: 18 | Train Loss: 0.460 Vali Loss: 1.410 Vali Acc: 0.490 Test Loss: 1.410 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4642252922058105
Epoch: 6, Steps: 18 | Train Loss: 0.405 Vali Loss: 1.856 Vali Acc: 0.520 Test Loss: 1.856 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5392773151397705
Epoch: 7, Steps: 18 | Train Loss: 0.512 Vali Loss: 1.800 Vali Acc: 0.510 Test Loss: 1.800 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.5185928344726562
Epoch: 8, Steps: 18 | Train Loss: 0.503 Vali Loss: 2.394 Vali Acc: 0.540 Test Loss: 2.394 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.5561578273773193
Epoch: 9, Steps: 18 | Train Loss: 0.286 Vali Loss: 2.570 Vali Acc: 0.480 Test Loss: 2.570 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3613340854644775
Epoch: 10, Steps: 18 | Train Loss: 0.392 Vali Loss: 2.540 Vali Acc: 0.550 Test Loss: 2.540 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.317770004272461
Epoch: 11, Steps: 18 | Train Loss: 0.191 Vali Loss: 2.901 Vali Acc: 0.540 Test Loss: 2.901 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.470033645629883
Epoch: 12, Steps: 18 | Train Loss: 0.293 Vali Loss: 3.259 Vali Acc: 0.530 Test Loss: 3.259 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 206818
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.057505369186401
Epoch: 1, Steps: 18 | Train Loss: 0.823 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.5392236709594727
Epoch: 2, Steps: 18 | Train Loss: 0.730 Vali Loss: 1.656 Vali Acc: 0.520 Test Loss: 1.656 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519983).  Saving model ...
Epoch: 3 cost time: 2.44807505607605
Epoch: 3, Steps: 18 | Train Loss: 0.683 Vali Loss: 0.849 Vali Acc: 0.600 Test Loss: 0.849 Test Acc: 0.600
Validation loss decreased (-0.519983 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 2.413383722305298
Epoch: 4, Steps: 18 | Train Loss: 0.581 Vali Loss: 1.074 Vali Acc: 0.530 Test Loss: 1.074 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.551351308822632
Epoch: 5, Steps: 18 | Train Loss: 0.438 Vali Loss: 0.965 Vali Acc: 0.550 Test Loss: 0.965 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5510430335998535
Epoch: 6, Steps: 18 | Train Loss: 0.515 Vali Loss: 1.106 Vali Acc: 0.530 Test Loss: 1.106 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.470097303390503
Epoch: 7, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.548 Vali Acc: 0.600 Test Loss: 1.548 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.496443271636963
Epoch: 8, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.549 Vali Acc: 0.560 Test Loss: 1.549 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.487226963043213
Epoch: 9, Steps: 18 | Train Loss: 0.466 Vali Loss: 2.031 Vali Acc: 0.520 Test Loss: 2.031 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.520529270172119
Epoch: 10, Steps: 18 | Train Loss: 0.337 Vali Loss: 2.996 Vali Acc: 0.570 Test Loss: 2.996 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4791316986083984
Epoch: 11, Steps: 18 | Train Loss: 0.668 Vali Loss: 2.331 Vali Acc: 0.530 Test Loss: 2.331 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3657994270324707
Epoch: 12, Steps: 18 | Train Loss: 0.374 Vali Loss: 2.309 Vali Acc: 0.530 Test Loss: 2.309 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.452620506286621
Epoch: 13, Steps: 18 | Train Loss: 0.214 Vali Loss: 2.147 Vali Acc: 0.490 Test Loss: 2.147 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 151874
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7877395153045654
Epoch: 1, Steps: 18 | Train Loss: 0.824 Vali Loss: 0.799 Vali Acc: 0.480 Test Loss: 0.799 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.2486448287963867
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
Validation loss decreased (-0.479992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.2525436878204346
Epoch: 3, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.774 Vali Acc: 0.530 Test Loss: 0.774 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 2.2217326164245605
Epoch: 4, Steps: 18 | Train Loss: 0.559 Vali Loss: 0.934 Vali Acc: 0.510 Test Loss: 0.934 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.282078504562378
Epoch: 5, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.930 Vali Acc: 0.550 Test Loss: 0.930 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 2.223076343536377
Epoch: 6, Steps: 18 | Train Loss: 0.371 Vali Loss: 1.111 Vali Acc: 0.510 Test Loss: 1.111 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2961339950561523
Epoch: 7, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.074 Vali Acc: 0.570 Test Loss: 1.074 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569989).  Saving model ...
Epoch: 8 cost time: 2.389333486557007
Epoch: 8, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.207 Vali Acc: 0.540 Test Loss: 1.207 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3087007999420166
Epoch: 9, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.351 Vali Acc: 0.520 Test Loss: 1.351 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.265199899673462
Epoch: 10, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.512 Vali Acc: 0.550 Test Loss: 1.512 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3154451847076416
Epoch: 11, Steps: 18 | Train Loss: 0.139 Vali Loss: 1.432 Vali Acc: 0.570 Test Loss: 1.432 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3816936016082764
Epoch: 12, Steps: 18 | Train Loss: 0.114 Vali Loss: 2.033 Vali Acc: 0.470 Test Loss: 2.033 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.292525291442871
Epoch: 13, Steps: 18 | Train Loss: 0.087 Vali Loss: 1.837 Vali Acc: 0.540 Test Loss: 1.837 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.237731456756592
Epoch: 14, Steps: 18 | Train Loss: 0.115 Vali Loss: 2.466 Vali Acc: 0.500 Test Loss: 2.466 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.301187038421631
Epoch: 15, Steps: 18 | Train Loss: 0.091 Vali Loss: 2.277 Vali Acc: 0.530 Test Loss: 2.277 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.3690359592437744
Epoch: 16, Steps: 18 | Train Loss: 0.133 Vali Loss: 2.068 Vali Acc: 0.530 Test Loss: 2.068 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3120875358581543
Epoch: 17, Steps: 18 | Train Loss: 0.120 Vali Loss: 2.453 Vali Acc: 0.520 Test Loss: 2.453 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 129698
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8078620433807373
Epoch: 1, Steps: 18 | Train Loss: 0.776 Vali Loss: 0.702 Vali Acc: 0.550 Test Loss: 0.702 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.115635395050049
Epoch: 2, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.723 Vali Acc: 0.540 Test Loss: 0.723 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.135089159011841
Epoch: 3, Steps: 18 | Train Loss: 0.684 Vali Loss: 1.046 Vali Acc: 0.530 Test Loss: 1.046 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0085487365722656
Epoch: 4, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.859 Vali Acc: 0.600 Test Loss: 0.859 Test Acc: 0.600
Validation loss decreased (-0.549993 --> -0.599991).  Saving model ...
Epoch: 5 cost time: 2.0490543842315674
Epoch: 5, Steps: 18 | Train Loss: 0.607 Vali Loss: 0.778 Vali Acc: 0.620 Test Loss: 0.778 Test Acc: 0.620
Validation loss decreased (-0.599991 --> -0.619992).  Saving model ...
Epoch: 6 cost time: 2.0274507999420166
Epoch: 6, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.877 Vali Acc: 0.600 Test Loss: 0.877 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.035935401916504
Epoch: 7, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.905 Vali Acc: 0.550 Test Loss: 0.905 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.052002429962158
Epoch: 8, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.085 Vali Acc: 0.550 Test Loss: 1.085 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0191500186920166
Epoch: 9, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.256 Vali Acc: 0.550 Test Loss: 1.256 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.168306827545166
Epoch: 10, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.266 Vali Acc: 0.530 Test Loss: 1.266 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0294060707092285
Epoch: 11, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.537 Vali Acc: 0.530 Test Loss: 1.537 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.057770252227783
Epoch: 12, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.629 Vali Acc: 0.510 Test Loss: 1.629 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0371248722076416
Epoch: 13, Steps: 18 | Train Loss: 0.229 Vali Loss: 2.152 Vali Acc: 0.520 Test Loss: 2.152 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0381433963775635
Epoch: 14, Steps: 18 | Train Loss: 0.137 Vali Loss: 2.117 Vali Acc: 0.490 Test Loss: 2.117 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9872887134552002
Epoch: 15, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.985 Vali Acc: 0.500 Test Loss: 1.985 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 105826
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5959088802337646
Epoch: 1, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.703 Vali Acc: 0.560 Test Loss: 0.703 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 1.9759812355041504
Epoch: 2, Steps: 18 | Train Loss: 0.742 Vali Loss: 0.841 Vali Acc: 0.440 Test Loss: 0.841 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.984856128692627
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.753 Vali Acc: 0.550 Test Loss: 0.753 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1051344871520996
Epoch: 4, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.852 Vali Acc: 0.480 Test Loss: 0.852 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.041135549545288
Epoch: 5, Steps: 18 | Train Loss: 0.512 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.148292303085327
Epoch: 6, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.907 Vali Acc: 0.510 Test Loss: 0.907 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.039287567138672
Epoch: 7, Steps: 18 | Train Loss: 0.395 Vali Loss: 0.866 Vali Acc: 0.510 Test Loss: 0.866 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.096633195877075
Epoch: 8, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.036 Vali Acc: 0.490 Test Loss: 1.036 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9890706539154053
Epoch: 9, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.068 Vali Acc: 0.550 Test Loss: 1.068 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.1744301319122314
Epoch: 10, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.004 Vali Acc: 0.520 Test Loss: 1.004 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.096033811569214
Epoch: 11, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.159 Vali Acc: 0.550 Test Loss: 1.159 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 98338
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4278769493103027
Epoch: 1, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.742 Vali Acc: 0.520 Test Loss: 0.742 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 1.8318018913269043
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.707 Vali Acc: 0.550 Test Loss: 0.707 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 1.8917689323425293
Epoch: 3, Steps: 18 | Train Loss: 0.650 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8415324687957764
Epoch: 4, Steps: 18 | Train Loss: 0.557 Vali Loss: 0.789 Vali Acc: 0.550 Test Loss: 0.789 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.905505657196045
Epoch: 5, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.811 Vali Acc: 0.620 Test Loss: 0.811 Test Acc: 0.620
Validation loss decreased (-0.549993 --> -0.619992).  Saving model ...
Epoch: 6 cost time: 2.006802558898926
Epoch: 6, Steps: 18 | Train Loss: 0.411 Vali Loss: 1.003 Vali Acc: 0.520 Test Loss: 1.003 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9012160301208496
Epoch: 7, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.914 Vali Acc: 0.530 Test Loss: 0.914 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8246595859527588
Epoch: 8, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.931 Vali Acc: 0.560 Test Loss: 0.931 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9819767475128174
Epoch: 9, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.883 Vali Acc: 0.540 Test Loss: 0.883 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9039976596832275
Epoch: 10, Steps: 18 | Train Loss: 0.304 Vali Loss: 0.940 Vali Acc: 0.540 Test Loss: 0.940 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.858036994934082
Epoch: 11, Steps: 18 | Train Loss: 0.248 Vali Loss: 1.194 Vali Acc: 0.530 Test Loss: 1.194 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.895524024963379
Epoch: 12, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.195 Vali Acc: 0.490 Test Loss: 1.195 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.727607250213623
Epoch: 13, Steps: 18 | Train Loss: 0.229 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8693790435791016
Epoch: 14, Steps: 18 | Train Loss: 0.169 Vali Loss: 1.329 Vali Acc: 0.520 Test Loss: 1.329 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.826979398727417
Epoch: 15, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.320 Vali Acc: 0.570 Test Loss: 1.320 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 94946
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.007737636566162
Epoch: 1, Steps: 18 | Train Loss: 0.862 Vali Loss: 0.928 Vali Acc: 0.520 Test Loss: 0.928 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 5.479592800140381
Epoch: 2, Steps: 18 | Train Loss: 0.876 Vali Loss: 1.030 Vali Acc: 0.610 Test Loss: 1.030 Test Acc: 0.610
Validation loss decreased (-0.519991 --> -0.609990).  Saving model ...
Epoch: 3 cost time: 5.436579465866089
Epoch: 3, Steps: 18 | Train Loss: 1.027 Vali Loss: 1.480 Vali Acc: 0.550 Test Loss: 1.480 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.660981178283691
Epoch: 4, Steps: 18 | Train Loss: 0.938 Vali Loss: 3.142 Vali Acc: 0.530 Test Loss: 3.142 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.611401081085205
Epoch: 5, Steps: 18 | Train Loss: 0.770 Vali Loss: 1.645 Vali Acc: 0.550 Test Loss: 1.645 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.571913719177246
Epoch: 6, Steps: 18 | Train Loss: 0.713 Vali Loss: 2.938 Vali Acc: 0.550 Test Loss: 2.938 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.937203645706177
Epoch: 7, Steps: 18 | Train Loss: 0.504 Vali Loss: 2.328 Vali Acc: 0.530 Test Loss: 2.328 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.288269758224487
Epoch: 8, Steps: 18 | Train Loss: 0.651 Vali Loss: 2.437 Vali Acc: 0.570 Test Loss: 2.437 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.536235809326172
Epoch: 9, Steps: 18 | Train Loss: 0.607 Vali Loss: 3.141 Vali Acc: 0.450 Test Loss: 3.141 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.132976531982422
Epoch: 10, Steps: 18 | Train Loss: 0.560 Vali Loss: 4.181 Vali Acc: 0.460 Test Loss: 4.181 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.2503650188446045
Epoch: 11, Steps: 18 | Train Loss: 0.489 Vali Loss: 5.141 Vali Acc: 0.490 Test Loss: 5.141 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.102442264556885
Epoch: 12, Steps: 18 | Train Loss: 0.853 Vali Loss: 8.122 Vali Acc: 0.540 Test Loss: 8.122 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 347586
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.403379440307617
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.695 Vali Acc: 0.530 Test Loss: 0.695 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 4.055832147598267
Epoch: 2, Steps: 18 | Train Loss: 0.767 Vali Loss: 1.021 Vali Acc: 0.510 Test Loss: 1.021 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.726708173751831
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 1.076 Vali Acc: 0.450 Test Loss: 1.076 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6120028495788574
Epoch: 4, Steps: 18 | Train Loss: 0.582 Vali Loss: 1.359 Vali Acc: 0.550 Test Loss: 1.359 Test Acc: 0.550
Validation loss decreased (-0.529993 --> -0.549986).  Saving model ...
Epoch: 5 cost time: 3.378201484680176
Epoch: 5, Steps: 18 | Train Loss: 0.456 Vali Loss: 1.703 Vali Acc: 0.530 Test Loss: 1.703 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.048924207687378
Epoch: 6, Steps: 18 | Train Loss: 0.900 Vali Loss: 2.223 Vali Acc: 0.540 Test Loss: 2.223 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4667797088623047
Epoch: 7, Steps: 18 | Train Loss: 0.699 Vali Loss: 2.078 Vali Acc: 0.540 Test Loss: 2.078 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.5063297748565674
Epoch: 8, Steps: 18 | Train Loss: 0.318 Vali Loss: 2.367 Vali Acc: 0.430 Test Loss: 2.367 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4732277393341064
Epoch: 9, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.603 Vali Acc: 0.560 Test Loss: 1.603 Test Acc: 0.560
Validation loss decreased (-0.549986 --> -0.559984).  Saving model ...
Epoch: 10 cost time: 3.739755868911743
Epoch: 10, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.962 Vali Acc: 0.480 Test Loss: 1.962 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.75419545173645
Epoch: 11, Steps: 18 | Train Loss: 0.160 Vali Loss: 3.010 Vali Acc: 0.500 Test Loss: 3.010 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8697075843811035
Epoch: 12, Steps: 18 | Train Loss: 0.113 Vali Loss: 2.541 Vali Acc: 0.500 Test Loss: 2.541 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.746532440185547
Epoch: 13, Steps: 18 | Train Loss: 0.169 Vali Loss: 3.243 Vali Acc: 0.530 Test Loss: 3.243 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.795945644378662
Epoch: 14, Steps: 18 | Train Loss: 0.212 Vali Loss: 5.264 Vali Acc: 0.490 Test Loss: 5.264 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.9811456203460693
Epoch: 15, Steps: 18 | Train Loss: 0.287 Vali Loss: 4.693 Vali Acc: 0.540 Test Loss: 4.693 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.6972086429595947
Epoch: 16, Steps: 18 | Train Loss: 0.275 Vali Loss: 3.871 Vali Acc: 0.560 Test Loss: 3.871 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.774407386779785
Epoch: 17, Steps: 18 | Train Loss: 0.301 Vali Loss: 5.676 Vali Acc: 0.500 Test Loss: 5.676 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.921132802963257
Epoch: 18, Steps: 18 | Train Loss: 0.173 Vali Loss: 4.245 Vali Acc: 0.570 Test Loss: 4.245 Test Acc: 0.570
Validation loss decreased (-0.559984 --> -0.569958).  Saving model ...
Epoch: 19 cost time: 3.6779379844665527
Epoch: 19, Steps: 18 | Train Loss: 0.104 Vali Loss: 4.373 Vali Acc: 0.530 Test Loss: 4.373 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.919393301010132
Epoch: 20, Steps: 18 | Train Loss: 0.079 Vali Loss: 6.411 Vali Acc: 0.540 Test Loss: 6.411 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.7777273654937744
Epoch: 21, Steps: 18 | Train Loss: 0.110 Vali Loss: 6.447 Vali Acc: 0.550 Test Loss: 6.447 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7935636043548584
Epoch: 22, Steps: 18 | Train Loss: 0.120 Vali Loss: 5.488 Vali Acc: 0.590 Test Loss: 5.488 Test Acc: 0.590
Validation loss decreased (-0.569958 --> -0.589945).  Saving model ...
Epoch: 23 cost time: 3.824916362762451
Epoch: 23, Steps: 18 | Train Loss: 0.065 Vali Loss: 4.166 Vali Acc: 0.570 Test Loss: 4.166 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.808014392852783
Epoch: 24, Steps: 18 | Train Loss: 0.095 Vali Loss: 4.620 Vali Acc: 0.510 Test Loss: 4.620 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.9635205268859863
Epoch: 25, Steps: 18 | Train Loss: 0.052 Vali Loss: 5.210 Vali Acc: 0.500 Test Loss: 5.210 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.9397811889648438
Epoch: 26, Steps: 18 | Train Loss: 0.055 Vali Loss: 5.006 Vali Acc: 0.550 Test Loss: 5.006 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.8219034671783447
Epoch: 27, Steps: 18 | Train Loss: 0.026 Vali Loss: 6.132 Vali Acc: 0.550 Test Loss: 6.132 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.038671016693115
Epoch: 28, Steps: 18 | Train Loss: 0.133 Vali Loss: 6.247 Vali Acc: 0.570 Test Loss: 6.247 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.7988412380218506
Epoch: 29, Steps: 18 | Train Loss: 0.309 Vali Loss: 6.751 Vali Acc: 0.530 Test Loss: 6.751 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7619824409484863
Epoch: 30, Steps: 18 | Train Loss: 0.111 Vali Loss: 6.729 Vali Acc: 0.540 Test Loss: 6.729 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.167574882507324
Epoch: 31, Steps: 18 | Train Loss: 0.050 Vali Loss: 6.165 Vali Acc: 0.550 Test Loss: 6.165 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.350792407989502
Epoch: 32, Steps: 18 | Train Loss: 0.025 Vali Loss: 6.292 Vali Acc: 0.490 Test Loss: 6.292 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 194338
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.855222463607788
Epoch: 1, Steps: 18 | Train Loss: 0.840 Vali Loss: 0.858 Vali Acc: 0.520 Test Loss: 0.858 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 3.0206470489501953
Epoch: 2, Steps: 18 | Train Loss: 0.709 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
Validation loss decreased (-0.519991 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 3.171849489212036
Epoch: 3, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.718 Vali Acc: 0.570 Test Loss: 0.718 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.062673568725586
Epoch: 4, Steps: 18 | Train Loss: 0.755 Vali Loss: 1.217 Vali Acc: 0.540 Test Loss: 1.217 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1173484325408936
Epoch: 5, Steps: 18 | Train Loss: 0.682 Vali Loss: 1.182 Vali Acc: 0.570 Test Loss: 1.182 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4384937286376953
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.989 Vali Acc: 0.580 Test Loss: 0.989 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579990).  Saving model ...
Epoch: 7 cost time: 2.8383662700653076
Epoch: 7, Steps: 18 | Train Loss: 0.353 Vali Loss: 1.269 Vali Acc: 0.510 Test Loss: 1.269 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.162719964981079
Epoch: 8, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.137 Vali Acc: 0.510 Test Loss: 1.137 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.101572275161743
Epoch: 9, Steps: 18 | Train Loss: 0.596 Vali Loss: 1.456 Vali Acc: 0.560 Test Loss: 1.456 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2795870304107666
Epoch: 10, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.654 Vali Acc: 0.530 Test Loss: 1.654 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.262770175933838
Epoch: 11, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.603 Vali Acc: 0.570 Test Loss: 1.603 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8966875076293945
Epoch: 12, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.922 Vali Acc: 0.530 Test Loss: 1.922 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.887722969055176
Epoch: 13, Steps: 18 | Train Loss: 0.161 Vali Loss: 1.801 Vali Acc: 0.520 Test Loss: 1.801 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1713688373565674
Epoch: 14, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.756 Vali Acc: 0.600 Test Loss: 1.756 Test Acc: 0.600
Validation loss decreased (-0.579990 --> -0.599982).  Saving model ...
Epoch: 15 cost time: 3.2291252613067627
Epoch: 15, Steps: 18 | Train Loss: 0.069 Vali Loss: 2.908 Vali Acc: 0.530 Test Loss: 2.908 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.278801918029785
Epoch: 16, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.790 Vali Acc: 0.520 Test Loss: 2.790 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.294904947280884
Epoch: 17, Steps: 18 | Train Loss: 0.138 Vali Loss: 2.531 Vali Acc: 0.560 Test Loss: 2.531 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0965688228607178
Epoch: 18, Steps: 18 | Train Loss: 0.088 Vali Loss: 3.621 Vali Acc: 0.460 Test Loss: 3.621 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.9115898609161377
Epoch: 19, Steps: 18 | Train Loss: 0.157 Vali Loss: 3.825 Vali Acc: 0.550 Test Loss: 3.825 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3455002307891846
Epoch: 20, Steps: 18 | Train Loss: 0.116 Vali Loss: 3.568 Vali Acc: 0.530 Test Loss: 3.568 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1774120330810547
Epoch: 21, Steps: 18 | Train Loss: 0.095 Vali Loss: 3.608 Vali Acc: 0.540 Test Loss: 3.608 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.437601089477539
Epoch: 22, Steps: 18 | Train Loss: 0.048 Vali Loss: 3.483 Vali Acc: 0.520 Test Loss: 3.483 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.194870710372925
Epoch: 23, Steps: 18 | Train Loss: 0.073 Vali Loss: 4.102 Vali Acc: 0.530 Test Loss: 4.102 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.687190532684326
Epoch: 24, Steps: 18 | Train Loss: 0.139 Vali Loss: 4.209 Vali Acc: 0.500 Test Loss: 4.209 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 139394
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.908952236175537
Epoch: 1, Steps: 18 | Train Loss: 0.768 Vali Loss: 0.722 Vali Acc: 0.520 Test Loss: 0.722 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.32490611076355
Epoch: 2, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.824 Vali Acc: 0.520 Test Loss: 0.824 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.577669858932495
Epoch: 3, Steps: 18 | Train Loss: 0.615 Vali Loss: 1.037 Vali Acc: 0.490 Test Loss: 1.037 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.557206869125366
Epoch: 4, Steps: 18 | Train Loss: 0.645 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9335319995880127
Epoch: 5, Steps: 18 | Train Loss: 0.505 Vali Loss: 0.937 Vali Acc: 0.630 Test Loss: 0.937 Test Acc: 0.630
Validation loss decreased (-0.519993 --> -0.629991).  Saving model ...
Epoch: 6 cost time: 2.5511527061462402
Epoch: 6, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.274 Vali Acc: 0.470 Test Loss: 1.274 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6804401874542236
Epoch: 7, Steps: 18 | Train Loss: 0.369 Vali Loss: 1.242 Vali Acc: 0.480 Test Loss: 1.242 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1041817665100098
Epoch: 8, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.475 Vali Acc: 0.490 Test Loss: 1.475 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.459887742996216
Epoch: 9, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.227 Vali Acc: 0.530 Test Loss: 1.227 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2813169956207275
Epoch: 10, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.572 Vali Acc: 0.550 Test Loss: 1.572 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0440447330474854
Epoch: 11, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.648 Vali Acc: 0.560 Test Loss: 1.648 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.1553986072540283
Epoch: 12, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.570 Vali Acc: 0.520 Test Loss: 1.570 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.375169515609741
Epoch: 13, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.694 Vali Acc: 0.620 Test Loss: 1.694 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.3094844818115234
Epoch: 14, Steps: 18 | Train Loss: 0.130 Vali Loss: 2.185 Vali Acc: 0.590 Test Loss: 2.185 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.619784355163574
Epoch: 15, Steps: 18 | Train Loss: 0.173 Vali Loss: 2.700 Vali Acc: 0.530 Test Loss: 2.700 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 117218
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.771198749542236
Epoch: 1, Steps: 18 | Train Loss: 0.769 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.0721254348754883
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.729 Vali Acc: 0.560 Test Loss: 0.729 Test Acc: 0.560
Validation loss decreased (-0.499993 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 3.043217182159424
Epoch: 3, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.806 Vali Acc: 0.570 Test Loss: 0.806 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 2.8898818492889404
Epoch: 4, Steps: 18 | Train Loss: 0.553 Vali Loss: 0.847 Vali Acc: 0.470 Test Loss: 0.847 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0266690254211426
Epoch: 5, Steps: 18 | Train Loss: 0.444 Vali Loss: 0.995 Vali Acc: 0.560 Test Loss: 0.995 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2158591747283936
Epoch: 6, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.970 Vali Acc: 0.550 Test Loss: 0.970 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.1288654804229736
Epoch: 7, Steps: 18 | Train Loss: 0.343 Vali Loss: 0.882 Vali Acc: 0.600 Test Loss: 0.882 Test Acc: 0.600
Validation loss decreased (-0.569992 --> -0.599991).  Saving model ...
Epoch: 8 cost time: 3.0791590213775635
Epoch: 8, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.012 Vali Acc: 0.570 Test Loss: 1.012 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1897776126861572
Epoch: 9, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.170 Vali Acc: 0.570 Test Loss: 1.170 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0334644317626953
Epoch: 10, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2697739601135254
Epoch: 11, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.468 Vali Acc: 0.550 Test Loss: 1.468 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.265472173690796
Epoch: 12, Steps: 18 | Train Loss: 0.187 Vali Loss: 1.450 Vali Acc: 0.520 Test Loss: 1.450 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.188638687133789
Epoch: 13, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.865 Vali Acc: 0.520 Test Loss: 1.865 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.1058475971221924
Epoch: 14, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.847 Vali Acc: 0.510 Test Loss: 1.847 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.227771759033203
Epoch: 15, Steps: 18 | Train Loss: 0.118 Vali Loss: 2.029 Vali Acc: 0.450 Test Loss: 2.029 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.213108539581299
Epoch: 16, Steps: 18 | Train Loss: 0.062 Vali Loss: 2.630 Vali Acc: 0.430 Test Loss: 2.630 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.069004774093628
Epoch: 17, Steps: 18 | Train Loss: 0.151 Vali Loss: 2.655 Vali Acc: 0.510 Test Loss: 2.655 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 93346
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.158057689666748
Epoch: 1, Steps: 18 | Train Loss: 0.798 Vali Loss: 0.746 Vali Acc: 0.430 Test Loss: 0.746 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 3.0202019214630127
Epoch: 2, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.744 Vali Acc: 0.530 Test Loss: 0.744 Test Acc: 0.530
Validation loss decreased (-0.429993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 3.16030216217041
Epoch: 3, Steps: 18 | Train Loss: 0.656 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
Validation loss decreased (-0.529993 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 3.0818934440612793
Epoch: 4, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.893 Vali Acc: 0.590 Test Loss: 0.893 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589991).  Saving model ...
Epoch: 5 cost time: 3.1296095848083496
Epoch: 5, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.830 Vali Acc: 0.510 Test Loss: 0.830 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0181660652160645
Epoch: 6, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.859 Vali Acc: 0.510 Test Loss: 0.859 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0387215614318848
Epoch: 7, Steps: 18 | Train Loss: 0.465 Vali Loss: 1.029 Vali Acc: 0.580 Test Loss: 1.029 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.015842914581299
Epoch: 8, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.932 Vali Acc: 0.540 Test Loss: 0.932 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.12807559967041
Epoch: 9, Steps: 18 | Train Loss: 0.342 Vali Loss: 1.388 Vali Acc: 0.430 Test Loss: 1.388 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.1062304973602295
Epoch: 10, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.988 Vali Acc: 0.530 Test Loss: 0.988 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.023045778274536
Epoch: 11, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.632 Vali Acc: 0.540 Test Loss: 1.632 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9898853302001953
Epoch: 12, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.249 Vali Acc: 0.520 Test Loss: 1.249 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.999232530593872
Epoch: 13, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.468 Vali Acc: 0.540 Test Loss: 1.468 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8945038318634033
Epoch: 14, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.350 Vali Acc: 0.560 Test Loss: 1.350 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 85858
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.3926544189453125
Epoch: 1, Steps: 18 | Train Loss: 0.799 Vali Loss: 0.696 Vali Acc: 0.550 Test Loss: 0.696 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.8820810317993164
Epoch: 2, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.730 Vali Acc: 0.530 Test Loss: 0.730 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0196938514709473
Epoch: 3, Steps: 18 | Train Loss: 0.652 Vali Loss: 0.749 Vali Acc: 0.490 Test Loss: 0.749 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8663783073425293
Epoch: 4, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.738 Vali Acc: 0.580 Test Loss: 0.738 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 3.035574436187744
Epoch: 5, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.740 Vali Acc: 0.600 Test Loss: 0.740 Test Acc: 0.600
Validation loss decreased (-0.579993 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 3.014388084411621
Epoch: 6, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.838 Vali Acc: 0.510 Test Loss: 0.838 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.814542293548584
Epoch: 7, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.852 Vali Acc: 0.530 Test Loss: 0.852 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9141266345977783
Epoch: 8, Steps: 18 | Train Loss: 0.365 Vali Loss: 0.875 Vali Acc: 0.560 Test Loss: 0.875 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6718859672546387
Epoch: 9, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.984 Vali Acc: 0.560 Test Loss: 0.984 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.551635265350342
Epoch: 10, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.058 Vali Acc: 0.490 Test Loss: 1.058 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.625518321990967
Epoch: 11, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.086 Vali Acc: 0.540 Test Loss: 1.086 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.692988634109497
Epoch: 12, Steps: 18 | Train Loss: 0.247 Vali Loss: 1.055 Vali Acc: 0.540 Test Loss: 1.055 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.695256471633911
Epoch: 13, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.339 Vali Acc: 0.560 Test Loss: 1.339 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7082865238189697
Epoch: 14, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.261 Vali Acc: 0.550 Test Loss: 1.261 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9973156452178955
Epoch: 15, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.415 Vali Acc: 0.500 Test Loss: 1.415 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm32_nh4_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 82466
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.216543912887573
Epoch: 1, Steps: 18 | Train Loss: 0.922 Vali Loss: 0.715 Vali Acc: 0.450 Test Loss: 0.715 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 5.666750431060791
Epoch: 2, Steps: 18 | Train Loss: 0.689 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.449993 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 5.699363708496094
Epoch: 3, Steps: 18 | Train Loss: 0.919 Vali Loss: 0.760 Vali Acc: 0.560 Test Loss: 0.760 Test Acc: 0.560
Validation loss decreased (-0.499988 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 5.624437093734741
Epoch: 4, Steps: 18 | Train Loss: 0.594 Vali Loss: 1.541 Vali Acc: 0.510 Test Loss: 1.541 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.960269451141357
Epoch: 5, Steps: 18 | Train Loss: 0.641 Vali Loss: 1.117 Vali Acc: 0.480 Test Loss: 1.117 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.787789583206177
Epoch: 6, Steps: 18 | Train Loss: 0.624 Vali Loss: 1.429 Vali Acc: 0.570 Test Loss: 1.429 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569986).  Saving model ...
Epoch: 7 cost time: 5.904547691345215
Epoch: 7, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.741 Vali Acc: 0.460 Test Loss: 1.741 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.667662858963013
Epoch: 8, Steps: 18 | Train Loss: 0.294 Vali Loss: 2.529 Vali Acc: 0.520 Test Loss: 2.529 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.814764976501465
Epoch: 9, Steps: 18 | Train Loss: 0.429 Vali Loss: 2.464 Vali Acc: 0.500 Test Loss: 2.464 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.914116621017456
Epoch: 10, Steps: 18 | Train Loss: 0.268 Vali Loss: 2.189 Vali Acc: 0.510 Test Loss: 2.189 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.832368850708008
Epoch: 11, Steps: 18 | Train Loss: 0.152 Vali Loss: 2.597 Vali Acc: 0.510 Test Loss: 2.597 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.765984296798706
Epoch: 12, Steps: 18 | Train Loss: 0.197 Vali Loss: 2.651 Vali Acc: 0.510 Test Loss: 2.651 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.703879356384277
Epoch: 13, Steps: 18 | Train Loss: 0.215 Vali Loss: 3.009 Vali Acc: 0.590 Test Loss: 3.009 Test Acc: 0.590
Validation loss decreased (-0.569986 --> -0.589970).  Saving model ...
Epoch: 14 cost time: 5.743492841720581
Epoch: 14, Steps: 18 | Train Loss: 0.200 Vali Loss: 3.111 Vali Acc: 0.570 Test Loss: 3.111 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.197701930999756
Epoch: 15, Steps: 18 | Train Loss: 0.086 Vali Loss: 4.178 Vali Acc: 0.530 Test Loss: 4.178 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.71732759475708
Epoch: 16, Steps: 18 | Train Loss: 0.099 Vali Loss: 4.601 Vali Acc: 0.470 Test Loss: 4.601 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.407659292221069
Epoch: 17, Steps: 18 | Train Loss: 0.115 Vali Loss: 3.912 Vali Acc: 0.510 Test Loss: 3.912 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.408357381820679
Epoch: 18, Steps: 18 | Train Loss: 0.064 Vali Loss: 4.972 Vali Acc: 0.470 Test Loss: 4.972 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.152677536010742
Epoch: 19, Steps: 18 | Train Loss: 0.123 Vali Loss: 4.585 Vali Acc: 0.500 Test Loss: 4.585 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.125874042510986
Epoch: 20, Steps: 18 | Train Loss: 0.079 Vali Loss: 5.415 Vali Acc: 0.500 Test Loss: 5.415 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.683102607727051
Epoch: 21, Steps: 18 | Train Loss: 0.080 Vali Loss: 5.863 Vali Acc: 0.500 Test Loss: 5.863 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.596451044082642
Epoch: 22, Steps: 18 | Train Loss: 0.028 Vali Loss: 6.069 Vali Acc: 0.490 Test Loss: 6.069 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.360260248184204
Epoch: 23, Steps: 18 | Train Loss: 0.052 Vali Loss: 5.703 Vali Acc: 0.460 Test Loss: 5.703 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 189826
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.234485626220703
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 0.910 Vali Acc: 0.500 Test Loss: 0.910 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 3.525589942932129
Epoch: 2, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
Validation loss decreased (-0.499991 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 3.7538533210754395
Epoch: 3, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.792 Vali Acc: 0.600 Test Loss: 0.792 Test Acc: 0.600
Validation loss decreased (-0.539992 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 3.684654951095581
Epoch: 4, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.849 Vali Acc: 0.560 Test Loss: 0.849 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7863755226135254
Epoch: 5, Steps: 18 | Train Loss: 0.600 Vali Loss: 1.460 Vali Acc: 0.530 Test Loss: 1.460 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7428102493286133
Epoch: 6, Steps: 18 | Train Loss: 0.549 Vali Loss: 1.105 Vali Acc: 0.620 Test Loss: 1.105 Test Acc: 0.620
Validation loss decreased (-0.599992 --> -0.619989).  Saving model ...
Epoch: 7 cost time: 3.536259412765503
Epoch: 7, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.088 Vali Acc: 0.470 Test Loss: 1.088 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5996596813201904
Epoch: 8, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.848 Vali Acc: 0.520 Test Loss: 1.848 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.704768180847168
Epoch: 9, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.670 Vali Acc: 0.520 Test Loss: 1.670 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.7464799880981445
Epoch: 10, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.179 Vali Acc: 0.580 Test Loss: 1.179 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.694662570953369
Epoch: 11, Steps: 18 | Train Loss: 0.158 Vali Loss: 1.407 Vali Acc: 0.500 Test Loss: 1.407 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.597362756729126
Epoch: 12, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.567 Vali Acc: 0.510 Test Loss: 1.567 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.598583936691284
Epoch: 13, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.973 Vali Acc: 0.560 Test Loss: 1.973 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.5769999027252197
Epoch: 14, Steps: 18 | Train Loss: 0.045 Vali Loss: 1.712 Vali Acc: 0.550 Test Loss: 1.712 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.5614380836486816
Epoch: 15, Steps: 18 | Train Loss: 0.052 Vali Loss: 2.042 Vali Acc: 0.580 Test Loss: 2.042 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.5102951526641846
Epoch: 16, Steps: 18 | Train Loss: 0.023 Vali Loss: 2.075 Vali Acc: 0.550 Test Loss: 2.075 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 113202
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.177050590515137
Epoch: 1, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.668 Vali Acc: 0.560 Test Loss: 0.668 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.5404467582702637
Epoch: 2, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.670 Vali Acc: 0.590 Test Loss: 0.670 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.54538631439209
Epoch: 3, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.781 Vali Acc: 0.520 Test Loss: 0.781 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7973129749298096
Epoch: 4, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.760 Vali Acc: 0.560 Test Loss: 0.760 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6040091514587402
Epoch: 5, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.862 Vali Acc: 0.550 Test Loss: 0.862 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6407086849212646
Epoch: 6, Steps: 18 | Train Loss: 0.407 Vali Loss: 0.907 Vali Acc: 0.550 Test Loss: 0.907 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6249473094940186
Epoch: 7, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.831 Vali Acc: 0.590 Test Loss: 0.831 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.555053472518921
Epoch: 8, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.144 Vali Acc: 0.620 Test Loss: 1.144 Test Acc: 0.620
Validation loss decreased (-0.589993 --> -0.619989).  Saving model ...
Epoch: 9 cost time: 2.040217638015747
Epoch: 9, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.083 Vali Acc: 0.570 Test Loss: 1.083 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3353235721588135
Epoch: 10, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.333 Vali Acc: 0.520 Test Loss: 1.333 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.414234161376953
Epoch: 11, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.195 Vali Acc: 0.540 Test Loss: 1.195 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5423789024353027
Epoch: 12, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.459 Vali Acc: 0.550 Test Loss: 1.459 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.537926435470581
Epoch: 13, Steps: 18 | Train Loss: 0.107 Vali Loss: 1.400 Vali Acc: 0.530 Test Loss: 1.400 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5847437381744385
Epoch: 14, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.612 Vali Acc: 0.560 Test Loss: 1.612 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6690287590026855
Epoch: 15, Steps: 18 | Train Loss: 0.071 Vali Loss: 1.421 Vali Acc: 0.520 Test Loss: 1.421 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.664341926574707
Epoch: 16, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.627 Vali Acc: 0.510 Test Loss: 1.627 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.623260498046875
Epoch: 17, Steps: 18 | Train Loss: 0.030 Vali Loss: 1.755 Vali Acc: 0.550 Test Loss: 1.755 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5827250480651855
Epoch: 18, Steps: 18 | Train Loss: 0.026 Vali Loss: 1.932 Vali Acc: 0.520 Test Loss: 1.932 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 85730
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.9174137115478516
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.700 Vali Acc: 0.500 Test Loss: 0.700 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.224360227584839
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.696 Vali Acc: 0.570 Test Loss: 0.696 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.1512868404388428
Epoch: 3, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.721 Vali Acc: 0.540 Test Loss: 0.721 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.443477153778076
Epoch: 4, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.975 Vali Acc: 0.530 Test Loss: 0.975 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4079806804656982
Epoch: 5, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.879 Vali Acc: 0.540 Test Loss: 0.879 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.382755756378174
Epoch: 6, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.774 Vali Acc: 0.550 Test Loss: 0.774 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.470088243484497
Epoch: 7, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.901 Vali Acc: 0.510 Test Loss: 0.901 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3480608463287354
Epoch: 8, Steps: 18 | Train Loss: 0.467 Vali Loss: 1.165 Vali Acc: 0.540 Test Loss: 1.165 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6574056148529053
Epoch: 9, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.945 Vali Acc: 0.570 Test Loss: 0.945 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.025519847869873
Epoch: 10, Steps: 18 | Train Loss: 0.256 Vali Loss: 1.162 Vali Acc: 0.590 Test Loss: 1.162 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589988).  Saving model ...
Epoch: 11 cost time: 2.6506385803222656
Epoch: 11, Steps: 18 | Train Loss: 0.209 Vali Loss: 1.102 Vali Acc: 0.560 Test Loss: 1.102 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.537128448486328
Epoch: 12, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.199 Vali Acc: 0.540 Test Loss: 1.199 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5542008876800537
Epoch: 13, Steps: 18 | Train Loss: 0.102 Vali Loss: 1.152 Vali Acc: 0.520 Test Loss: 1.152 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.763324022293091
Epoch: 14, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.276 Vali Acc: 0.510 Test Loss: 1.276 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.560539484024048
Epoch: 15, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.618 Vali Acc: 0.560 Test Loss: 1.618 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.566826343536377
Epoch: 16, Steps: 18 | Train Loss: 0.053 Vali Loss: 1.457 Vali Acc: 0.480 Test Loss: 1.457 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.8439502716064453
Epoch: 17, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.338 Vali Acc: 0.520 Test Loss: 1.338 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7917110919952393
Epoch: 18, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.825 Vali Acc: 0.510 Test Loss: 1.825 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3968584537506104
Epoch: 19, Steps: 18 | Train Loss: 0.042 Vali Loss: 1.803 Vali Acc: 0.550 Test Loss: 1.803 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4543299674987793
Epoch: 20, Steps: 18 | Train Loss: 0.037 Vali Loss: 1.965 Vali Acc: 0.550 Test Loss: 1.965 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 74642
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.527549982070923
Epoch: 1, Steps: 18 | Train Loss: 0.773 Vali Loss: 0.702 Vali Acc: 0.540 Test Loss: 0.702 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.1276321411132812
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.722 Vali Acc: 0.550 Test Loss: 0.722 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 2.019383430480957
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.718 Vali Acc: 0.540 Test Loss: 0.718 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.071892499923706
Epoch: 4, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.840 Vali Acc: 0.550 Test Loss: 0.840 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2815933227539062
Epoch: 5, Steps: 18 | Train Loss: 0.572 Vali Loss: 0.812 Vali Acc: 0.590 Test Loss: 0.812 Test Acc: 0.590
Validation loss decreased (-0.549993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 2.0725414752960205
Epoch: 6, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.816 Vali Acc: 0.560 Test Loss: 0.816 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0783851146698
Epoch: 7, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.880 Vali Acc: 0.500 Test Loss: 0.880 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.216437578201294
Epoch: 8, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.850 Vali Acc: 0.580 Test Loss: 0.850 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1193604469299316
Epoch: 9, Steps: 18 | Train Loss: 0.377 Vali Loss: 0.879 Vali Acc: 0.530 Test Loss: 0.879 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.148871660232544
Epoch: 10, Steps: 18 | Train Loss: 0.332 Vali Loss: 0.911 Vali Acc: 0.560 Test Loss: 0.911 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1752171516418457
Epoch: 11, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.986 Vali Acc: 0.540 Test Loss: 0.986 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0851657390594482
Epoch: 12, Steps: 18 | Train Loss: 0.262 Vali Loss: 1.212 Vali Acc: 0.520 Test Loss: 1.212 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.219977378845215
Epoch: 13, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.240 Vali Acc: 0.510 Test Loss: 1.240 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.259812593460083
Epoch: 14, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.211 Vali Acc: 0.520 Test Loss: 1.211 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0684118270874023
Epoch: 15, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.204 Vali Acc: 0.510 Test Loss: 1.204 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 62706
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.8376996517181396
Epoch: 1, Steps: 18 | Train Loss: 0.815 Vali Loss: 0.760 Vali Acc: 0.420 Test Loss: 0.760 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 2.038681983947754
Epoch: 2, Steps: 18 | Train Loss: 0.766 Vali Loss: 0.748 Vali Acc: 0.470 Test Loss: 0.748 Test Acc: 0.470
Validation loss decreased (-0.419992 --> -0.469993).  Saving model ...
Epoch: 3 cost time: 2.0996055603027344
Epoch: 3, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.742 Vali Acc: 0.470 Test Loss: 0.742 Test Acc: 0.470
Validation loss decreased (-0.469993 --> -0.469993).  Saving model ...
Epoch: 4 cost time: 2.113070249557495
Epoch: 4, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.838 Vali Acc: 0.540 Test Loss: 0.838 Test Acc: 0.540
Validation loss decreased (-0.469993 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 2.027724266052246
Epoch: 5, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 1.886751413345337
Epoch: 6, Steps: 18 | Train Loss: 0.517 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 7 cost time: 1.977919101715088
Epoch: 7, Steps: 18 | Train Loss: 0.511 Vali Loss: 0.824 Vali Acc: 0.530 Test Loss: 0.824 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9517581462860107
Epoch: 8, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.916 Vali Acc: 0.530 Test Loss: 0.916 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9378552436828613
Epoch: 9, Steps: 18 | Train Loss: 0.453 Vali Loss: 0.848 Vali Acc: 0.550 Test Loss: 0.848 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9692447185516357
Epoch: 10, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.798 Vali Acc: 0.540 Test Loss: 0.798 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9261558055877686
Epoch: 11, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.852 Vali Acc: 0.510 Test Loss: 0.852 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9592475891113281
Epoch: 12, Steps: 18 | Train Loss: 0.295 Vali Loss: 0.945 Vali Acc: 0.530 Test Loss: 0.945 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8661620616912842
Epoch: 13, Steps: 18 | Train Loss: 0.295 Vali Loss: 0.965 Vali Acc: 0.530 Test Loss: 0.965 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9729321002960205
Epoch: 14, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.959 Vali Acc: 0.530 Test Loss: 0.959 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0011277198791504
Epoch: 15, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.005 Vali Acc: 0.570 Test Loss: 1.005 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569990).  Saving model ...
Epoch: 16 cost time: 1.9981145858764648
Epoch: 16, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.251 Vali Acc: 0.490 Test Loss: 1.251 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8456628322601318
Epoch: 17, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9658305644989014
Epoch: 18, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.210 Vali Acc: 0.470 Test Loss: 1.210 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9698536396026611
Epoch: 19, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.178 Vali Acc: 0.520 Test Loss: 1.178 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9992742538452148
Epoch: 20, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.282 Vali Acc: 0.490 Test Loss: 1.282 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.107666492462158
Epoch: 21, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.147 Vali Acc: 0.530 Test Loss: 1.147 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0342090129852295
Epoch: 22, Steps: 18 | Train Loss: 0.074 Vali Loss: 1.244 Vali Acc: 0.550 Test Loss: 1.244 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2386324405670166
Epoch: 23, Steps: 18 | Train Loss: 0.047 Vali Loss: 1.289 Vali Acc: 0.550 Test Loss: 1.289 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1715943813323975
Epoch: 24, Steps: 18 | Train Loss: 0.051 Vali Loss: 1.393 Vali Acc: 0.540 Test Loss: 1.393 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1663858890533447
Epoch: 25, Steps: 18 | Train Loss: 0.043 Vali Loss: 1.605 Vali Acc: 0.520 Test Loss: 1.605 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 58962
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.5899345874786377
Epoch: 1, Steps: 18 | Train Loss: 0.791 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 1.9648246765136719
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.741 Vali Acc: 0.530 Test Loss: 0.741 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0248632431030273
Epoch: 3, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.767 Vali Acc: 0.570 Test Loss: 0.767 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 2.0883893966674805
Epoch: 4, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.731 Vali Acc: 0.580 Test Loss: 0.731 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 1.7552974224090576
Epoch: 5, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.839 Vali Acc: 0.640 Test Loss: 0.839 Test Acc: 0.640
Validation loss decreased (-0.579993 --> -0.639992).  Saving model ...
Epoch: 6 cost time: 1.7659871578216553
Epoch: 6, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.837 Vali Acc: 0.520 Test Loss: 0.837 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8814551830291748
Epoch: 7, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.756 Vali Acc: 0.600 Test Loss: 0.756 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.644113302230835
Epoch: 8, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.830 Vali Acc: 0.570 Test Loss: 0.830 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.812087059020996
Epoch: 9, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.824 Vali Acc: 0.540 Test Loss: 0.824 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9329769611358643
Epoch: 10, Steps: 18 | Train Loss: 0.369 Vali Loss: 0.845 Vali Acc: 0.540 Test Loss: 0.845 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8488447666168213
Epoch: 11, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.901 Vali Acc: 0.540 Test Loss: 0.901 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0416100025177
Epoch: 12, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.942 Vali Acc: 0.530 Test Loss: 0.942 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8956165313720703
Epoch: 13, Steps: 18 | Train Loss: 0.249 Vali Loss: 0.968 Vali Acc: 0.530 Test Loss: 0.968 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8756248950958252
Epoch: 14, Steps: 18 | Train Loss: 0.214 Vali Loss: 0.991 Vali Acc: 0.500 Test Loss: 0.991 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8903746604919434
Epoch: 15, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.071 Vali Acc: 0.610 Test Loss: 1.071 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 57266
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.68381404876709
Epoch: 1, Steps: 18 | Train Loss: 0.851 Vali Loss: 0.866 Vali Acc: 0.470 Test Loss: 0.866 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 5.95909571647644
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.740 Vali Acc: 0.560 Test Loss: 0.740 Test Acc: 0.560
Validation loss decreased (-0.469991 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 7.584872484207153
Epoch: 3, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.856 Vali Acc: 0.530 Test Loss: 0.856 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.599846124649048
Epoch: 4, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.096 Vali Acc: 0.610 Test Loss: 1.096 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609989).  Saving model ...
Epoch: 5 cost time: 7.087425947189331
Epoch: 5, Steps: 18 | Train Loss: 0.500 Vali Loss: 2.146 Vali Acc: 0.530 Test Loss: 2.146 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.257770299911499
Epoch: 6, Steps: 18 | Train Loss: 0.462 Vali Loss: 1.337 Vali Acc: 0.540 Test Loss: 1.337 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.451729774475098
Epoch: 7, Steps: 18 | Train Loss: 0.378 Vali Loss: 1.406 Vali Acc: 0.540 Test Loss: 1.406 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.720153331756592
Epoch: 8, Steps: 18 | Train Loss: 0.502 Vali Loss: 3.355 Vali Acc: 0.510 Test Loss: 3.355 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.507575511932373
Epoch: 9, Steps: 18 | Train Loss: 0.441 Vali Loss: 2.032 Vali Acc: 0.560 Test Loss: 2.032 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.9253249168396
Epoch: 10, Steps: 18 | Train Loss: 0.510 Vali Loss: 2.744 Vali Acc: 0.500 Test Loss: 2.744 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.8177807331085205
Epoch: 11, Steps: 18 | Train Loss: 0.212 Vali Loss: 3.586 Vali Acc: 0.560 Test Loss: 3.586 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.279965877532959
Epoch: 12, Steps: 18 | Train Loss: 0.374 Vali Loss: 3.436 Vali Acc: 0.530 Test Loss: 3.436 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.764108419418335
Epoch: 13, Steps: 18 | Train Loss: 0.268 Vali Loss: 2.570 Vali Acc: 0.470 Test Loss: 2.570 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.403846263885498
Epoch: 14, Steps: 18 | Train Loss: 0.109 Vali Loss: 2.862 Vali Acc: 0.510 Test Loss: 2.862 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 177154
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.771380662918091
Epoch: 1, Steps: 18 | Train Loss: 0.875 Vali Loss: 0.745 Vali Acc: 0.550 Test Loss: 0.745 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.0925703048706055
Epoch: 2, Steps: 18 | Train Loss: 0.860 Vali Loss: 1.177 Vali Acc: 0.520 Test Loss: 1.177 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.169795036315918
Epoch: 3, Steps: 18 | Train Loss: 0.713 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.204984188079834
Epoch: 4, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1771063804626465
Epoch: 5, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.966 Vali Acc: 0.560 Test Loss: 0.966 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559990).  Saving model ...
Epoch: 6 cost time: 3.198002576828003
Epoch: 6, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.168 Vali Acc: 0.580 Test Loss: 1.168 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579988).  Saving model ...
Epoch: 7 cost time: 3.136242151260376
Epoch: 7, Steps: 18 | Train Loss: 0.467 Vali Loss: 1.667 Vali Acc: 0.550 Test Loss: 1.667 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.089176893234253
Epoch: 8, Steps: 18 | Train Loss: 0.314 Vali Loss: 1.684 Vali Acc: 0.540 Test Loss: 1.684 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1796863079071045
Epoch: 9, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.237 Vali Acc: 0.580 Test Loss: 1.237 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2469377517700195
Epoch: 10, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.325 Vali Acc: 0.550 Test Loss: 1.325 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.27183198928833
Epoch: 11, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.667 Vali Acc: 0.540 Test Loss: 1.667 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1586828231811523
Epoch: 12, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.702 Vali Acc: 0.490 Test Loss: 1.702 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.28776216506958
Epoch: 13, Steps: 18 | Train Loss: 0.073 Vali Loss: 2.206 Vali Acc: 0.490 Test Loss: 2.206 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.314849376678467
Epoch: 14, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.996 Vali Acc: 0.480 Test Loss: 1.996 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0659399032592773
Epoch: 15, Steps: 18 | Train Loss: 0.039 Vali Loss: 1.990 Vali Acc: 0.510 Test Loss: 1.990 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1710782051086426
Epoch: 16, Steps: 18 | Train Loss: 0.045 Vali Loss: 2.162 Vali Acc: 0.470 Test Loss: 2.162 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 100530
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.4691619873046875
Epoch: 1, Steps: 18 | Train Loss: 0.822 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.468632936477661
Epoch: 2, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.702 Vali Acc: 0.480 Test Loss: 0.702 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5809342861175537
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.962 Vali Acc: 0.530 Test Loss: 0.962 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6828293800354004
Epoch: 4, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.866 Vali Acc: 0.540 Test Loss: 0.866 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.587031841278076
Epoch: 5, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.860 Vali Acc: 0.560 Test Loss: 0.860 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 2.632575035095215
Epoch: 6, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.889 Vali Acc: 0.540 Test Loss: 0.889 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5901386737823486
Epoch: 7, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.030 Vali Acc: 0.570 Test Loss: 1.030 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569990).  Saving model ...
Epoch: 8 cost time: 2.597123384475708
Epoch: 8, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.988 Vali Acc: 0.550 Test Loss: 0.988 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.47383975982666
Epoch: 9, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.111 Vali Acc: 0.530 Test Loss: 1.111 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.588998317718506
Epoch: 10, Steps: 18 | Train Loss: 0.409 Vali Loss: 1.167 Vali Acc: 0.560 Test Loss: 1.167 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.510819911956787
Epoch: 11, Steps: 18 | Train Loss: 0.187 Vali Loss: 1.245 Vali Acc: 0.540 Test Loss: 1.245 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4637451171875
Epoch: 12, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.491 Vali Acc: 0.490 Test Loss: 1.491 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4372196197509766
Epoch: 13, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.290 Vali Acc: 0.530 Test Loss: 1.290 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5494420528411865
Epoch: 14, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.670 Vali Acc: 0.560 Test Loss: 1.670 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5853800773620605
Epoch: 15, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.472 Vali Acc: 0.570 Test Loss: 1.472 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5563721656799316
Epoch: 16, Steps: 18 | Train Loss: 0.054 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.537593126296997
Epoch: 17, Steps: 18 | Train Loss: 0.032 Vali Loss: 1.635 Vali Acc: 0.570 Test Loss: 1.635 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 73058
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.562002420425415
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 0.673 Vali Acc: 0.620 Test Loss: 0.673 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 2.2712082862854004
Epoch: 2, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.688 Vali Acc: 0.570 Test Loss: 0.688 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.162538528442383
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.804 Vali Acc: 0.520 Test Loss: 0.804 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3196070194244385
Epoch: 4, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.755 Vali Acc: 0.610 Test Loss: 0.755 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.3500349521636963
Epoch: 5, Steps: 18 | Train Loss: 0.507 Vali Loss: 0.799 Vali Acc: 0.560 Test Loss: 0.799 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5227560997009277
Epoch: 6, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.779 Vali Acc: 0.590 Test Loss: 0.779 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.4921176433563232
Epoch: 7, Steps: 18 | Train Loss: 0.364 Vali Loss: 0.824 Vali Acc: 0.520 Test Loss: 0.824 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5397346019744873
Epoch: 8, Steps: 18 | Train Loss: 0.326 Vali Loss: 0.971 Vali Acc: 0.530 Test Loss: 0.971 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4315989017486572
Epoch: 9, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.015 Vali Acc: 0.520 Test Loss: 1.015 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.3701705932617188
Epoch: 10, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.064 Vali Acc: 0.530 Test Loss: 1.064 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.467108964920044
Epoch: 11, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.304 Vali Acc: 0.520 Test Loss: 1.304 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 61970
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.0483105182647705
Epoch: 1, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.839 Vali Acc: 0.510 Test Loss: 0.839 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.3085339069366455
Epoch: 2, Steps: 18 | Train Loss: 0.730 Vali Loss: 0.688 Vali Acc: 0.520 Test Loss: 0.688 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.3339359760284424
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.705 Vali Acc: 0.550 Test Loss: 0.705 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.5021722316741943
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.750 Vali Acc: 0.560 Test Loss: 0.750 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 5 cost time: 2.329800605773926
Epoch: 5, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.711 Vali Acc: 0.600 Test Loss: 0.711 Test Acc: 0.600
Validation loss decreased (-0.559993 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 2.445216655731201
Epoch: 6, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.937 Vali Acc: 0.540 Test Loss: 0.937 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.236445903778076
Epoch: 7, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.766 Vali Acc: 0.600 Test Loss: 0.766 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.13826060295105
Epoch: 8, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.772 Vali Acc: 0.550 Test Loss: 0.772 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0316243171691895
Epoch: 9, Steps: 18 | Train Loss: 0.342 Vali Loss: 0.813 Vali Acc: 0.590 Test Loss: 0.813 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.080134153366089
Epoch: 10, Steps: 18 | Train Loss: 0.297 Vali Loss: 0.872 Vali Acc: 0.570 Test Loss: 0.872 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9533026218414307
Epoch: 11, Steps: 18 | Train Loss: 0.251 Vali Loss: 0.934 Vali Acc: 0.570 Test Loss: 0.934 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.005929708480835
Epoch: 12, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.985 Vali Acc: 0.540 Test Loss: 0.985 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9963099956512451
Epoch: 13, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.189 Vali Acc: 0.520 Test Loss: 1.189 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0559842586517334
Epoch: 14, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.060 Vali Acc: 0.550 Test Loss: 1.060 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.128478527069092
Epoch: 15, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.201 Vali Acc: 0.530 Test Loss: 1.201 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 50034
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.7591867446899414
Epoch: 1, Steps: 18 | Train Loss: 0.755 Vali Loss: 0.729 Vali Acc: 0.470 Test Loss: 0.729 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 2.0773532390594482
Epoch: 2, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.745 Vali Acc: 0.470 Test Loss: 0.745 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.022765874862671
Epoch: 3, Steps: 18 | Train Loss: 0.637 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
Validation loss decreased (-0.469993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 2.019832134246826
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.749 Vali Acc: 0.500 Test Loss: 0.749 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1603825092315674
Epoch: 5, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.839 Vali Acc: 0.570 Test Loss: 0.839 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.091522216796875
Epoch: 6, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.784 Vali Acc: 0.480 Test Loss: 0.784 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.149948835372925
Epoch: 7, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.9559712409973145
Epoch: 8, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.793 Vali Acc: 0.560 Test Loss: 0.793 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.078777551651001
Epoch: 9, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.788 Vali Acc: 0.530 Test Loss: 0.788 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0064854621887207
Epoch: 10, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.821 Vali Acc: 0.560 Test Loss: 0.821 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9978265762329102
Epoch: 11, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.788 Vali Acc: 0.570 Test Loss: 0.788 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9943039417266846
Epoch: 12, Steps: 18 | Train Loss: 0.309 Vali Loss: 0.805 Vali Acc: 0.540 Test Loss: 0.805 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0627453327178955
Epoch: 13, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.847 Vali Acc: 0.540 Test Loss: 0.847 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 46290
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 3.4322056770324707
Epoch: 1, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.701 Vali Acc: 0.540 Test Loss: 0.701 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.037043809890747
Epoch: 2, Steps: 18 | Train Loss: 0.694 Vali Loss: 0.736 Vali Acc: 0.500 Test Loss: 0.736 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0388119220733643
Epoch: 3, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.744 Vali Acc: 0.570 Test Loss: 0.744 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 1.882664680480957
Epoch: 4, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.776 Vali Acc: 0.530 Test Loss: 0.776 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8795700073242188
Epoch: 5, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.703 Vali Acc: 0.620 Test Loss: 0.703 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619993).  Saving model ...
Epoch: 6 cost time: 1.95538330078125
Epoch: 6, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.736 Vali Acc: 0.530 Test Loss: 0.736 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.889235496520996
Epoch: 7, Steps: 18 | Train Loss: 0.464 Vali Loss: 0.843 Vali Acc: 0.570 Test Loss: 0.843 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9100356101989746
Epoch: 8, Steps: 18 | Train Loss: 0.475 Vali Loss: 0.896 Vali Acc: 0.510 Test Loss: 0.896 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8667256832122803
Epoch: 9, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.803 Vali Acc: 0.570 Test Loss: 0.803 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.102252244949341
Epoch: 10, Steps: 18 | Train Loss: 0.416 Vali Loss: 0.835 Vali Acc: 0.570 Test Loss: 0.835 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.912811040878296
Epoch: 11, Steps: 18 | Train Loss: 0.328 Vali Loss: 0.889 Vali Acc: 0.550 Test Loss: 0.889 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9891457557678223
Epoch: 12, Steps: 18 | Train Loss: 0.320 Vali Loss: 0.972 Vali Acc: 0.500 Test Loss: 0.972 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8403360843658447
Epoch: 13, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7495183944702148
Epoch: 14, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.984 Vali Acc: 0.500 Test Loss: 0.984 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8682210445404053
Epoch: 15, Steps: 18 | Train Loss: 0.218 Vali Loss: 1.232 Vali Acc: 0.490 Test Loss: 1.232 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 44594
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.7800915241241455
Epoch: 1, Steps: 18 | Train Loss: 0.795 Vali Loss: 0.711 Vali Acc: 0.560 Test Loss: 0.711 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 4.659395217895508
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.761 Vali Acc: 0.570 Test Loss: 0.761 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 4.778625011444092
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.988 Vali Acc: 0.560 Test Loss: 0.988 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.18997049331665
Epoch: 4, Steps: 18 | Train Loss: 0.484 Vali Loss: 1.824 Vali Acc: 0.540 Test Loss: 1.824 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.370278835296631
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 1.349 Vali Acc: 0.490 Test Loss: 1.349 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.580238580703735
Epoch: 6, Steps: 18 | Train Loss: 0.473 Vali Loss: 1.470 Vali Acc: 0.550 Test Loss: 1.470 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.314223051071167
Epoch: 7, Steps: 18 | Train Loss: 0.518 Vali Loss: 1.588 Vali Acc: 0.520 Test Loss: 1.588 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.974324941635132
Epoch: 8, Steps: 18 | Train Loss: 0.239 Vali Loss: 1.558 Vali Acc: 0.550 Test Loss: 1.558 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.984126806259155
Epoch: 9, Steps: 18 | Train Loss: 0.640 Vali Loss: 2.263 Vali Acc: 0.550 Test Loss: 2.263 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.604180574417114
Epoch: 10, Steps: 18 | Train Loss: 0.684 Vali Loss: 1.821 Vali Acc: 0.540 Test Loss: 1.821 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.339872598648071
Epoch: 11, Steps: 18 | Train Loss: 0.230 Vali Loss: 3.911 Vali Acc: 0.540 Test Loss: 3.911 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.91398024559021
Epoch: 12, Steps: 18 | Train Loss: 0.180 Vali Loss: 2.811 Vali Acc: 0.530 Test Loss: 2.811 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 170818
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.924348831176758
Epoch: 1, Steps: 18 | Train Loss: 0.835 Vali Loss: 0.749 Vali Acc: 0.470 Test Loss: 0.749 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.3368330001831055
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.996 Vali Acc: 0.510 Test Loss: 0.996 Test Acc: 0.510
Validation loss decreased (-0.469993 --> -0.509990).  Saving model ...
Epoch: 3 cost time: 3.434380531311035
Epoch: 3, Steps: 18 | Train Loss: 0.648 Vali Loss: 0.842 Vali Acc: 0.530 Test Loss: 0.842 Test Acc: 0.530
Validation loss decreased (-0.509990 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 3.617723226547241
Epoch: 4, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.859 Vali Acc: 0.500 Test Loss: 0.859 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.542354106903076
Epoch: 5, Steps: 18 | Train Loss: 0.481 Vali Loss: 0.917 Vali Acc: 0.550 Test Loss: 0.917 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 3.0075175762176514
Epoch: 6, Steps: 18 | Train Loss: 0.411 Vali Loss: 0.983 Vali Acc: 0.520 Test Loss: 0.983 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0113232135772705
Epoch: 7, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4802401065826416
Epoch: 8, Steps: 18 | Train Loss: 0.243 Vali Loss: 1.256 Vali Acc: 0.540 Test Loss: 1.256 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.306349039077759
Epoch: 9, Steps: 18 | Train Loss: 0.216 Vali Loss: 1.342 Vali Acc: 0.490 Test Loss: 1.342 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4121286869049072
Epoch: 10, Steps: 18 | Train Loss: 0.283 Vali Loss: 1.666 Vali Acc: 0.510 Test Loss: 1.666 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2485532760620117
Epoch: 11, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.606 Vali Acc: 0.510 Test Loss: 1.606 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.466240167617798
Epoch: 12, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.939 Vali Acc: 0.590 Test Loss: 1.939 Test Acc: 0.590
Validation loss decreased (-0.549991 --> -0.589981).  Saving model ...
Epoch: 13 cost time: 3.4036970138549805
Epoch: 13, Steps: 18 | Train Loss: 0.118 Vali Loss: 1.772 Vali Acc: 0.520 Test Loss: 1.772 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.32637882232666
Epoch: 14, Steps: 18 | Train Loss: 0.114 Vali Loss: 1.883 Vali Acc: 0.550 Test Loss: 1.883 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.033102989196777
Epoch: 15, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.500 Vali Acc: 0.500 Test Loss: 2.500 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.058471202850342
Epoch: 16, Steps: 18 | Train Loss: 0.046 Vali Loss: 3.136 Vali Acc: 0.490 Test Loss: 3.136 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.892583131790161
Epoch: 17, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.908 Vali Acc: 0.470 Test Loss: 2.908 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.9757933616638184
Epoch: 18, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.661 Vali Acc: 0.540 Test Loss: 2.661 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.9937970638275146
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.850 Vali Acc: 0.460 Test Loss: 2.850 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.588057041168213
Epoch: 20, Steps: 18 | Train Loss: 0.018 Vali Loss: 2.885 Vali Acc: 0.510 Test Loss: 2.885 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5749359130859375
Epoch: 21, Steps: 18 | Train Loss: 0.031 Vali Loss: 3.768 Vali Acc: 0.500 Test Loss: 3.768 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.9013757705688477
Epoch: 22, Steps: 18 | Train Loss: 0.022 Vali Loss: 3.434 Vali Acc: 0.500 Test Loss: 3.434 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 94194
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.164741277694702
Epoch: 1, Steps: 18 | Train Loss: 0.767 Vali Loss: 0.778 Vali Acc: 0.490 Test Loss: 0.778 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 3.1240780353546143
Epoch: 2, Steps: 18 | Train Loss: 0.776 Vali Loss: 0.891 Vali Acc: 0.470 Test Loss: 0.891 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3402011394500732
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 1.000 Vali Acc: 0.550 Test Loss: 1.000 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549990).  Saving model ...
Epoch: 4 cost time: 2.9709970951080322
Epoch: 4, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.783 Vali Acc: 0.570 Test Loss: 0.783 Test Acc: 0.570
Validation loss decreased (-0.549990 --> -0.569992).  Saving model ...
Epoch: 5 cost time: 2.7815685272216797
Epoch: 5, Steps: 18 | Train Loss: 0.512 Vali Loss: 1.090 Vali Acc: 0.480 Test Loss: 1.090 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8939619064331055
Epoch: 6, Steps: 18 | Train Loss: 0.522 Vali Loss: 0.977 Vali Acc: 0.550 Test Loss: 0.977 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2400217056274414
Epoch: 7, Steps: 18 | Train Loss: 0.453 Vali Loss: 1.035 Vali Acc: 0.610 Test Loss: 1.035 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609990).  Saving model ...
Epoch: 8 cost time: 3.245145797729492
Epoch: 8, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.303 Vali Acc: 0.470 Test Loss: 1.303 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7415614128112793
Epoch: 9, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.270 Vali Acc: 0.510 Test Loss: 1.270 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7011165618896484
Epoch: 10, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.369 Vali Acc: 0.510 Test Loss: 1.369 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1897311210632324
Epoch: 11, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.459 Vali Acc: 0.560 Test Loss: 1.459 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5246925354003906
Epoch: 12, Steps: 18 | Train Loss: 0.190 Vali Loss: 1.663 Vali Acc: 0.470 Test Loss: 1.663 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6337156295776367
Epoch: 13, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.422 Vali Acc: 0.470 Test Loss: 1.422 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4625110626220703
Epoch: 14, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.437 Vali Acc: 0.540 Test Loss: 1.437 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1753344535827637
Epoch: 15, Steps: 18 | Train Loss: 0.092 Vali Loss: 1.692 Vali Acc: 0.540 Test Loss: 1.692 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.3805365562438965
Epoch: 16, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.820 Vali Acc: 0.540 Test Loss: 1.820 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7440147399902344
Epoch: 17, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.781 Vali Acc: 0.530 Test Loss: 1.781 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 66722
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.720506429672241
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.740 Vali Acc: 0.470 Test Loss: 0.740 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.3130273818969727
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.755 Vali Acc: 0.490 Test Loss: 0.755 Test Acc: 0.490
Validation loss decreased (-0.469993 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 2.8924992084503174
Epoch: 3, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.740 Vali Acc: 0.550 Test Loss: 0.740 Test Acc: 0.550
Validation loss decreased (-0.489992 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 2.7854044437408447
Epoch: 4, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.807 Vali Acc: 0.530 Test Loss: 0.807 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.899332046508789
Epoch: 5, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.837 Vali Acc: 0.530 Test Loss: 0.837 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.810689926147461
Epoch: 6, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.876 Vali Acc: 0.520 Test Loss: 0.876 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.964916467666626
Epoch: 7, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.027 Vali Acc: 0.550 Test Loss: 1.027 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.877254009246826
Epoch: 8, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.004 Vali Acc: 0.580 Test Loss: 1.004 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579990).  Saving model ...
Epoch: 9 cost time: 2.724977731704712
Epoch: 9, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.925 Vali Acc: 0.580 Test Loss: 0.925 Test Acc: 0.580
Validation loss decreased (-0.579990 --> -0.579991).  Saving model ...
Epoch: 10 cost time: 2.749493360519409
Epoch: 10, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.007 Vali Acc: 0.500 Test Loss: 1.007 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.901399850845337
Epoch: 11, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6937201023101807
Epoch: 12, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.284 Vali Acc: 0.530 Test Loss: 1.284 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.662221670150757
Epoch: 13, Steps: 18 | Train Loss: 0.101 Vali Loss: 1.165 Vali Acc: 0.590 Test Loss: 1.165 Test Acc: 0.590
Validation loss decreased (-0.579991 --> -0.589988).  Saving model ...
Epoch: 14 cost time: 2.4559340476989746
Epoch: 14, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.453 Vali Acc: 0.570 Test Loss: 1.453 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2322187423706055
Epoch: 15, Steps: 18 | Train Loss: 0.072 Vali Loss: 1.561 Vali Acc: 0.570 Test Loss: 1.561 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8479163646698
Epoch: 16, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.607 Vali Acc: 0.550 Test Loss: 1.607 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.924121379852295
Epoch: 17, Steps: 18 | Train Loss: 0.033 Vali Loss: 1.527 Vali Acc: 0.590 Test Loss: 1.527 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.933436632156372
Epoch: 18, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.617 Vali Acc: 0.560 Test Loss: 1.617 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8179666996002197
Epoch: 19, Steps: 18 | Train Loss: 0.025 Vali Loss: 1.592 Vali Acc: 0.550 Test Loss: 1.592 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.891371250152588
Epoch: 20, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.755 Vali Acc: 0.540 Test Loss: 1.755 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.0999374389648438
Epoch: 21, Steps: 18 | Train Loss: 0.022 Vali Loss: 1.777 Vali Acc: 0.550 Test Loss: 1.777 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.1040029525756836
Epoch: 22, Steps: 18 | Train Loss: 0.024 Vali Loss: 2.016 Vali Acc: 0.570 Test Loss: 2.016 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.9563674926757812
Epoch: 23, Steps: 18 | Train Loss: 0.012 Vali Loss: 2.034 Vali Acc: 0.560 Test Loss: 2.034 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 55634
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.653994798660278
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.708 Vali Acc: 0.500 Test Loss: 0.708 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.7666211128234863
Epoch: 2, Steps: 18 | Train Loss: 0.710 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7951838970184326
Epoch: 3, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.728 Vali Acc: 0.570 Test Loss: 0.728 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 2.7264723777770996
Epoch: 4, Steps: 18 | Train Loss: 0.612 Vali Loss: 0.727 Vali Acc: 0.520 Test Loss: 0.727 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7597248554229736
Epoch: 5, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.771 Vali Acc: 0.590 Test Loss: 0.771 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 6 cost time: 2.870147466659546
Epoch: 6, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.948 Vali Acc: 0.510 Test Loss: 0.948 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.659409999847412
Epoch: 7, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.844 Vali Acc: 0.540 Test Loss: 0.844 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.689720869064331
Epoch: 8, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.850 Vali Acc: 0.500 Test Loss: 0.850 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.866323947906494
Epoch: 9, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.901 Vali Acc: 0.490 Test Loss: 0.901 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.952486753463745
Epoch: 10, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.001 Vali Acc: 0.510 Test Loss: 1.001 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.879747152328491
Epoch: 11, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.106 Vali Acc: 0.530 Test Loss: 1.106 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9442856311798096
Epoch: 12, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9022114276885986
Epoch: 13, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.265 Vali Acc: 0.540 Test Loss: 1.265 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.864567518234253
Epoch: 14, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.230 Vali Acc: 0.530 Test Loss: 1.230 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.6999781131744385
Epoch: 15, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.247 Vali Acc: 0.550 Test Loss: 1.247 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 43698
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.125245571136475
Epoch: 1, Steps: 18 | Train Loss: 0.806 Vali Loss: 0.727 Vali Acc: 0.460 Test Loss: 0.727 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 3.159614324569702
Epoch: 2, Steps: 18 | Train Loss: 0.728 Vali Loss: 0.713 Vali Acc: 0.520 Test Loss: 0.713 Test Acc: 0.520
Validation loss decreased (-0.459993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.875298500061035
Epoch: 3, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.697 Vali Acc: 0.590 Test Loss: 0.697 Test Acc: 0.590
Validation loss decreased (-0.519993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 3.1421797275543213
Epoch: 4, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.709 Vali Acc: 0.490 Test Loss: 0.709 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.927727460861206
Epoch: 5, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.727 Vali Acc: 0.610 Test Loss: 0.727 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609993).  Saving model ...
Epoch: 6 cost time: 3.1487138271331787
Epoch: 6, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.778 Vali Acc: 0.510 Test Loss: 0.778 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.025099754333496
Epoch: 7, Steps: 18 | Train Loss: 0.506 Vali Loss: 0.743 Vali Acc: 0.540 Test Loss: 0.743 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.072053909301758
Epoch: 8, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.752 Vali Acc: 0.550 Test Loss: 0.752 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9314451217651367
Epoch: 9, Steps: 18 | Train Loss: 0.418 Vali Loss: 0.722 Vali Acc: 0.610 Test Loss: 0.722 Test Acc: 0.610
Validation loss decreased (-0.609993 --> -0.609993).  Saving model ...
Epoch: 10 cost time: 3.1086063385009766
Epoch: 10, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.864 Vali Acc: 0.510 Test Loss: 0.864 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2126429080963135
Epoch: 11, Steps: 18 | Train Loss: 0.321 Vali Loss: 0.911 Vali Acc: 0.600 Test Loss: 0.911 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.013312339782715
Epoch: 12, Steps: 18 | Train Loss: 0.260 Vali Loss: 0.846 Vali Acc: 0.570 Test Loss: 0.846 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7003097534179688
Epoch: 13, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.988 Vali Acc: 0.480 Test Loss: 0.988 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8462259769439697
Epoch: 14, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.176 Vali Acc: 0.560 Test Loss: 1.176 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.723926544189453
Epoch: 15, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.964 Vali Acc: 0.570 Test Loss: 0.964 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7939987182617188
Epoch: 16, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.890 Vali Acc: 0.560 Test Loss: 0.890 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.739107131958008
Epoch: 17, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.961 Vali Acc: 0.560 Test Loss: 0.961 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5960121154785156
Epoch: 18, Steps: 18 | Train Loss: 0.125 Vali Loss: 1.099 Vali Acc: 0.570 Test Loss: 1.099 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6959316730499268
Epoch: 19, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.105 Vali Acc: 0.540 Test Loss: 1.105 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 39954
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.189299821853638
Epoch: 1, Steps: 18 | Train Loss: 0.800 Vali Loss: 0.748 Vali Acc: 0.450 Test Loss: 0.748 Test Acc: 0.450
Validation loss decreased (inf --> -0.449993).  Saving model ...
Epoch: 2 cost time: 2.732684850692749
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.766 Vali Acc: 0.450 Test Loss: 0.766 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.896176338195801
Epoch: 3, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.757 Vali Acc: 0.490 Test Loss: 0.757 Test Acc: 0.490
Validation loss decreased (-0.449993 --> -0.489992).  Saving model ...
Epoch: 4 cost time: 3.0179858207702637
Epoch: 4, Steps: 18 | Train Loss: 0.627 Vali Loss: 0.734 Vali Acc: 0.540 Test Loss: 0.734 Test Acc: 0.540
Validation loss decreased (-0.489992 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 2.7428009510040283
Epoch: 5, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.857 Vali Acc: 0.560 Test Loss: 0.857 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559991).  Saving model ...
Epoch: 6 cost time: 2.940464973449707
Epoch: 6, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.789 Vali Acc: 0.540 Test Loss: 0.789 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.878526449203491
Epoch: 7, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.191129207611084
Epoch: 8, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.785 Vali Acc: 0.540 Test Loss: 0.785 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.98641037940979
Epoch: 9, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.786 Vali Acc: 0.570 Test Loss: 0.786 Test Acc: 0.570
Validation loss decreased (-0.559991 --> -0.569992).  Saving model ...
Epoch: 10 cost time: 2.839007616043091
Epoch: 10, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.832 Vali Acc: 0.530 Test Loss: 0.832 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.822307586669922
Epoch: 11, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.885 Vali Acc: 0.590 Test Loss: 0.885 Test Acc: 0.590
Validation loss decreased (-0.569992 --> -0.589991).  Saving model ...
Epoch: 12 cost time: 2.917593240737915
Epoch: 12, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.990 Vali Acc: 0.530 Test Loss: 0.990 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7386701107025146
Epoch: 13, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.885 Vali Acc: 0.550 Test Loss: 0.885 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.732417345046997
Epoch: 14, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.028 Vali Acc: 0.530 Test Loss: 1.028 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7673914432525635
Epoch: 15, Steps: 18 | Train Loss: 0.337 Vali Loss: 0.992 Vali Acc: 0.540 Test Loss: 0.992 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9254751205444336
Epoch: 16, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.085 Vali Acc: 0.540 Test Loss: 1.085 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8203530311584473
Epoch: 17, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.091 Vali Acc: 0.480 Test Loss: 1.091 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7167186737060547
Epoch: 18, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.130 Vali Acc: 0.530 Test Loss: 1.130 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.763535499572754
Epoch: 19, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.195 Vali Acc: 0.530 Test Loss: 1.195 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.7496840953826904
Epoch: 20, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.285 Vali Acc: 0.520 Test Loss: 1.285 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.948577880859375
Epoch: 21, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.401 Vali Acc: 0.480 Test Loss: 1.401 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el3_dm16_nh4_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 38258
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.467402935028076
Epoch: 1, Steps: 18 | Train Loss: 1.479 Vali Loss: 3.054 Vali Acc: 0.520 Test Loss: 3.054 Test Acc: 0.520
Validation loss decreased (inf --> -0.519969).  Saving model ...
Epoch: 2 cost time: 11.696504831314087
Epoch: 2, Steps: 18 | Train Loss: 2.184 Vali Loss: 7.285 Vali Acc: 0.500 Test Loss: 7.285 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.639713764190674
Epoch: 3, Steps: 18 | Train Loss: 4.476 Vali Loss: 13.750 Vali Acc: 0.460 Test Loss: 13.750 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.833440780639648
Epoch: 4, Steps: 18 | Train Loss: 6.625 Vali Loss: 5.638 Vali Acc: 0.510 Test Loss: 5.638 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 12.640920400619507
Epoch: 5, Steps: 18 | Train Loss: 2.547 Vali Loss: 13.844 Vali Acc: 0.570 Test Loss: 13.844 Test Acc: 0.570
Validation loss decreased (-0.519969 --> -0.569862).  Saving model ...
Epoch: 6 cost time: 12.339212417602539
Epoch: 6, Steps: 18 | Train Loss: 2.184 Vali Loss: 11.135 Vali Acc: 0.520 Test Loss: 11.135 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.298182725906372
Epoch: 7, Steps: 18 | Train Loss: 2.474 Vali Loss: 11.200 Vali Acc: 0.540 Test Loss: 11.200 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 12.106848239898682
Epoch: 8, Steps: 18 | Train Loss: 2.229 Vali Loss: 11.892 Vali Acc: 0.500 Test Loss: 11.892 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 11.870880603790283
Epoch: 9, Steps: 18 | Train Loss: 3.352 Vali Loss: 14.222 Vali Acc: 0.460 Test Loss: 14.222 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 11.297671556472778
Epoch: 10, Steps: 18 | Train Loss: 1.727 Vali Loss: 10.055 Vali Acc: 0.510 Test Loss: 10.055 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.092297554016113
Epoch: 11, Steps: 18 | Train Loss: 1.145 Vali Loss: 13.274 Vali Acc: 0.550 Test Loss: 13.274 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 11.5122811794281
Epoch: 12, Steps: 18 | Train Loss: 0.882 Vali Loss: 17.969 Vali Acc: 0.550 Test Loss: 17.969 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 11.442827939987183
Epoch: 13, Steps: 18 | Train Loss: 1.189 Vali Loss: 16.589 Vali Acc: 0.530 Test Loss: 16.589 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.66660213470459
Epoch: 14, Steps: 18 | Train Loss: 2.985 Vali Loss: 21.370 Vali Acc: 0.470 Test Loss: 21.370 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.937712669372559
Epoch: 15, Steps: 18 | Train Loss: 1.623 Vali Loss: 19.615 Vali Acc: 0.530 Test Loss: 19.615 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 1552770
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.158602714538574
Epoch: 1, Steps: 18 | Train Loss: 1.065 Vali Loss: 1.677 Vali Acc: 0.530 Test Loss: 1.677 Test Acc: 0.530
Validation loss decreased (inf --> -0.529983).  Saving model ...
Epoch: 2 cost time: 5.488227128982544
Epoch: 2, Steps: 18 | Train Loss: 1.150 Vali Loss: 2.461 Vali Acc: 0.630 Test Loss: 2.461 Test Acc: 0.630
Validation loss decreased (-0.529983 --> -0.629975).  Saving model ...
Epoch: 3 cost time: 6.0810136795043945
Epoch: 3, Steps: 18 | Train Loss: 1.072 Vali Loss: 3.688 Vali Acc: 0.570 Test Loss: 3.688 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1586525440216064
Epoch: 4, Steps: 18 | Train Loss: 1.303 Vali Loss: 2.988 Vali Acc: 0.520 Test Loss: 2.988 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.475427150726318
Epoch: 5, Steps: 18 | Train Loss: 0.954 Vali Loss: 4.372 Vali Acc: 0.560 Test Loss: 4.372 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.791316747665405
Epoch: 6, Steps: 18 | Train Loss: 1.226 Vali Loss: 6.036 Vali Acc: 0.530 Test Loss: 6.036 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.982604742050171
Epoch: 7, Steps: 18 | Train Loss: 1.580 Vali Loss: 7.392 Vali Acc: 0.550 Test Loss: 7.392 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.99383020401001
Epoch: 8, Steps: 18 | Train Loss: 1.523 Vali Loss: 7.001 Vali Acc: 0.440 Test Loss: 7.001 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.371922254562378
Epoch: 9, Steps: 18 | Train Loss: 0.952 Vali Loss: 5.702 Vali Acc: 0.470 Test Loss: 5.702 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.623100519180298
Epoch: 10, Steps: 18 | Train Loss: 0.734 Vali Loss: 4.311 Vali Acc: 0.570 Test Loss: 4.311 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.57263970375061
Epoch: 11, Steps: 18 | Train Loss: 0.536 Vali Loss: 6.829 Vali Acc: 0.510 Test Loss: 6.829 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.187117338180542
Epoch: 12, Steps: 18 | Train Loss: 0.526 Vali Loss: 5.718 Vali Acc: 0.620 Test Loss: 5.718 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 939778
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.422914981842041
Epoch: 1, Steps: 18 | Train Loss: 1.265 Vali Loss: 1.842 Vali Acc: 0.520 Test Loss: 1.842 Test Acc: 0.520
Validation loss decreased (inf --> -0.519982).  Saving model ...
Epoch: 2 cost time: 4.349073648452759
Epoch: 2, Steps: 18 | Train Loss: 1.832 Vali Loss: 2.119 Vali Acc: 0.540 Test Loss: 2.119 Test Acc: 0.540
Validation loss decreased (-0.519982 --> -0.539979).  Saving model ...
Epoch: 3 cost time: 3.5250768661499023
Epoch: 3, Steps: 18 | Train Loss: 1.618 Vali Loss: 2.407 Vali Acc: 0.570 Test Loss: 2.407 Test Acc: 0.570
Validation loss decreased (-0.539979 --> -0.569976).  Saving model ...
Epoch: 4 cost time: 4.18338942527771
Epoch: 4, Steps: 18 | Train Loss: 1.047 Vali Loss: 2.059 Vali Acc: 0.600 Test Loss: 2.059 Test Acc: 0.600
Validation loss decreased (-0.569976 --> -0.599979).  Saving model ...
Epoch: 5 cost time: 4.3332200050354
Epoch: 5, Steps: 18 | Train Loss: 1.370 Vali Loss: 3.283 Vali Acc: 0.490 Test Loss: 3.283 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.805107355117798
Epoch: 6, Steps: 18 | Train Loss: 1.158 Vali Loss: 5.816 Vali Acc: 0.540 Test Loss: 5.816 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.772372245788574
Epoch: 7, Steps: 18 | Train Loss: 0.935 Vali Loss: 2.987 Vali Acc: 0.470 Test Loss: 2.987 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.5605528354644775
Epoch: 8, Steps: 18 | Train Loss: 0.999 Vali Loss: 5.926 Vali Acc: 0.460 Test Loss: 5.926 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.389168977737427
Epoch: 9, Steps: 18 | Train Loss: 0.679 Vali Loss: 5.516 Vali Acc: 0.530 Test Loss: 5.516 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.284448623657227
Epoch: 10, Steps: 18 | Train Loss: 0.765 Vali Loss: 6.002 Vali Acc: 0.530 Test Loss: 6.002 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.134801626205444
Epoch: 11, Steps: 18 | Train Loss: 0.712 Vali Loss: 4.878 Vali Acc: 0.570 Test Loss: 4.878 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.925969123840332
Epoch: 12, Steps: 18 | Train Loss: 0.521 Vali Loss: 6.467 Vali Acc: 0.540 Test Loss: 6.467 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.3654656410217285
Epoch: 13, Steps: 18 | Train Loss: 1.060 Vali Loss: 5.267 Vali Acc: 0.540 Test Loss: 5.267 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.365496635437012
Epoch: 14, Steps: 18 | Train Loss: 0.333 Vali Loss: 5.579 Vali Acc: 0.500 Test Loss: 5.579 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 720002
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.171458959579468
Epoch: 1, Steps: 18 | Train Loss: 0.929 Vali Loss: 1.132 Vali Acc: 0.490 Test Loss: 1.132 Test Acc: 0.490
Validation loss decreased (inf --> -0.489989).  Saving model ...
Epoch: 2 cost time: 3.7644848823547363
Epoch: 2, Steps: 18 | Train Loss: 1.096 Vali Loss: 1.462 Vali Acc: 0.590 Test Loss: 1.462 Test Acc: 0.590
Validation loss decreased (-0.489989 --> -0.589985).  Saving model ...
Epoch: 3 cost time: 4.27501654624939
Epoch: 3, Steps: 18 | Train Loss: 1.105 Vali Loss: 2.210 Vali Acc: 0.550 Test Loss: 2.210 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.040085077285767
Epoch: 4, Steps: 18 | Train Loss: 1.119 Vali Loss: 1.472 Vali Acc: 0.530 Test Loss: 1.472 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8507542610168457
Epoch: 5, Steps: 18 | Train Loss: 0.985 Vali Loss: 2.924 Vali Acc: 0.570 Test Loss: 2.924 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8243346214294434
Epoch: 6, Steps: 18 | Train Loss: 0.586 Vali Loss: 2.586 Vali Acc: 0.600 Test Loss: 2.586 Test Acc: 0.600
Validation loss decreased (-0.589985 --> -0.599974).  Saving model ...
Epoch: 7 cost time: 3.8707754611968994
Epoch: 7, Steps: 18 | Train Loss: 0.580 Vali Loss: 2.764 Vali Acc: 0.590 Test Loss: 2.764 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5376317501068115
Epoch: 8, Steps: 18 | Train Loss: 0.450 Vali Loss: 3.345 Vali Acc: 0.550 Test Loss: 3.345 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.0276641845703125
Epoch: 9, Steps: 18 | Train Loss: 0.661 Vali Loss: 3.072 Vali Acc: 0.590 Test Loss: 3.072 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4281067848205566
Epoch: 10, Steps: 18 | Train Loss: 0.488 Vali Loss: 3.801 Vali Acc: 0.510 Test Loss: 3.801 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.02693247795105
Epoch: 11, Steps: 18 | Train Loss: 0.661 Vali Loss: 5.817 Vali Acc: 0.520 Test Loss: 5.817 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9187493324279785
Epoch: 12, Steps: 18 | Train Loss: 0.657 Vali Loss: 4.408 Vali Acc: 0.520 Test Loss: 4.408 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.943579912185669
Epoch: 13, Steps: 18 | Train Loss: 0.369 Vali Loss: 6.307 Vali Acc: 0.570 Test Loss: 6.307 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.818920612335205
Epoch: 14, Steps: 18 | Train Loss: 0.323 Vali Loss: 5.752 Vali Acc: 0.510 Test Loss: 5.752 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.933419704437256
Epoch: 15, Steps: 18 | Train Loss: 0.347 Vali Loss: 7.215 Vali Acc: 0.510 Test Loss: 7.215 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.408972978591919
Epoch: 16, Steps: 18 | Train Loss: 0.451 Vali Loss: 6.150 Vali Acc: 0.550 Test Loss: 6.150 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 631298
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.847208023071289
Epoch: 1, Steps: 18 | Train Loss: 0.953 Vali Loss: 1.160 Vali Acc: 0.570 Test Loss: 1.160 Test Acc: 0.570
Validation loss decreased (inf --> -0.569988).  Saving model ...
Epoch: 2 cost time: 2.884799003601074
Epoch: 2, Steps: 18 | Train Loss: 0.885 Vali Loss: 1.458 Vali Acc: 0.520 Test Loss: 1.458 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4400644302368164
Epoch: 3, Steps: 18 | Train Loss: 1.097 Vali Loss: 1.175 Vali Acc: 0.580 Test Loss: 1.175 Test Acc: 0.580
Validation loss decreased (-0.569988 --> -0.579988).  Saving model ...
Epoch: 4 cost time: 3.126082420349121
Epoch: 4, Steps: 18 | Train Loss: 0.846 Vali Loss: 1.593 Vali Acc: 0.580 Test Loss: 1.593 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1969826221466064
Epoch: 5, Steps: 18 | Train Loss: 0.803 Vali Loss: 2.306 Vali Acc: 0.550 Test Loss: 2.306 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.301710367202759
Epoch: 6, Steps: 18 | Train Loss: 0.603 Vali Loss: 1.494 Vali Acc: 0.540 Test Loss: 1.494 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.232128620147705
Epoch: 7, Steps: 18 | Train Loss: 0.525 Vali Loss: 2.513 Vali Acc: 0.540 Test Loss: 2.513 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.563098430633545
Epoch: 8, Steps: 18 | Train Loss: 0.540 Vali Loss: 3.301 Vali Acc: 0.450 Test Loss: 3.301 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.558432102203369
Epoch: 9, Steps: 18 | Train Loss: 0.559 Vali Loss: 2.790 Vali Acc: 0.490 Test Loss: 2.790 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.41092848777771
Epoch: 10, Steps: 18 | Train Loss: 0.438 Vali Loss: 3.214 Vali Acc: 0.560 Test Loss: 3.214 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.4089818000793457
Epoch: 11, Steps: 18 | Train Loss: 0.427 Vali Loss: 3.983 Vali Acc: 0.510 Test Loss: 3.983 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.2787363529205322
Epoch: 12, Steps: 18 | Train Loss: 0.731 Vali Loss: 4.808 Vali Acc: 0.490 Test Loss: 4.808 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.1736254692077637
Epoch: 13, Steps: 18 | Train Loss: 0.317 Vali Loss: 3.895 Vali Acc: 0.520 Test Loss: 3.895 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 535810
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.899716377258301
Epoch: 1, Steps: 18 | Train Loss: 0.779 Vali Loss: 1.282 Vali Acc: 0.510 Test Loss: 1.282 Test Acc: 0.510
Validation loss decreased (inf --> -0.509987).  Saving model ...
Epoch: 2 cost time: 2.969754934310913
Epoch: 2, Steps: 18 | Train Loss: 1.024 Vali Loss: 1.159 Vali Acc: 0.510 Test Loss: 1.159 Test Acc: 0.510
Validation loss decreased (-0.509987 --> -0.509988).  Saving model ...
Epoch: 3 cost time: 3.1614556312561035
Epoch: 3, Steps: 18 | Train Loss: 0.668 Vali Loss: 1.098 Vali Acc: 0.530 Test Loss: 1.098 Test Acc: 0.530
Validation loss decreased (-0.509988 --> -0.529989).  Saving model ...
Epoch: 4 cost time: 3.0343105792999268
Epoch: 4, Steps: 18 | Train Loss: 0.622 Vali Loss: 1.830 Vali Acc: 0.500 Test Loss: 1.830 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9006564617156982
Epoch: 5, Steps: 18 | Train Loss: 0.491 Vali Loss: 2.048 Vali Acc: 0.440 Test Loss: 2.048 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7665371894836426
Epoch: 6, Steps: 18 | Train Loss: 0.428 Vali Loss: 1.467 Vali Acc: 0.580 Test Loss: 1.467 Test Acc: 0.580
Validation loss decreased (-0.529989 --> -0.579985).  Saving model ...
Epoch: 7 cost time: 2.5055530071258545
Epoch: 7, Steps: 18 | Train Loss: 0.433 Vali Loss: 2.119 Vali Acc: 0.460 Test Loss: 2.119 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.391404867172241
Epoch: 8, Steps: 18 | Train Loss: 0.423 Vali Loss: 2.157 Vali Acc: 0.480 Test Loss: 2.157 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.534473180770874
Epoch: 9, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.657 Vali Acc: 0.560 Test Loss: 1.657 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.668212413787842
Epoch: 10, Steps: 18 | Train Loss: 0.375 Vali Loss: 2.417 Vali Acc: 0.490 Test Loss: 2.417 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9017934799194336
Epoch: 11, Steps: 18 | Train Loss: 0.298 Vali Loss: 3.228 Vali Acc: 0.470 Test Loss: 3.228 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0879812240600586
Epoch: 12, Steps: 18 | Train Loss: 0.160 Vali Loss: 3.214 Vali Acc: 0.500 Test Loss: 3.214 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.0975215435028076
Epoch: 13, Steps: 18 | Train Loss: 0.573 Vali Loss: 3.755 Vali Acc: 0.550 Test Loss: 3.755 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1158437728881836
Epoch: 14, Steps: 18 | Train Loss: 0.285 Vali Loss: 4.077 Vali Acc: 0.500 Test Loss: 4.077 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.119790554046631
Epoch: 15, Steps: 18 | Train Loss: 0.129 Vali Loss: 4.248 Vali Acc: 0.520 Test Loss: 4.248 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2005157470703125
Epoch: 16, Steps: 18 | Train Loss: 0.390 Vali Loss: 3.932 Vali Acc: 0.600 Test Loss: 3.932 Test Acc: 0.600
Validation loss decreased (-0.579985 --> -0.599961).  Saving model ...
Epoch: 17 cost time: 3.1078033447265625
Epoch: 17, Steps: 18 | Train Loss: 0.522 Vali Loss: 4.397 Vali Acc: 0.470 Test Loss: 4.397 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1818978786468506
Epoch: 18, Steps: 18 | Train Loss: 0.357 Vali Loss: 5.358 Vali Acc: 0.510 Test Loss: 5.358 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1733756065368652
Epoch: 19, Steps: 18 | Train Loss: 0.292 Vali Loss: 5.111 Vali Acc: 0.510 Test Loss: 5.111 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.01223087310791
Epoch: 20, Steps: 18 | Train Loss: 0.334 Vali Loss: 5.020 Vali Acc: 0.560 Test Loss: 5.020 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.9986531734466553
Epoch: 21, Steps: 18 | Train Loss: 0.418 Vali Loss: 6.349 Vali Acc: 0.480 Test Loss: 6.349 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9840145111083984
Epoch: 22, Steps: 18 | Train Loss: 0.255 Vali Loss: 6.302 Vali Acc: 0.550 Test Loss: 6.302 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.224358081817627
Epoch: 23, Steps: 18 | Train Loss: 0.136 Vali Loss: 7.015 Vali Acc: 0.550 Test Loss: 7.015 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.163787841796875
Epoch: 24, Steps: 18 | Train Loss: 0.347 Vali Loss: 7.151 Vali Acc: 0.550 Test Loss: 7.151 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.2293038368225098
Epoch: 25, Steps: 18 | Train Loss: 0.133 Vali Loss: 8.352 Vali Acc: 0.490 Test Loss: 8.352 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.189005136489868
Epoch: 26, Steps: 18 | Train Loss: 0.102 Vali Loss: 8.012 Vali Acc: 0.420 Test Loss: 8.012 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 505858
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.781250953674316
Epoch: 1, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.954 Vali Acc: 0.440 Test Loss: 0.954 Test Acc: 0.440
Validation loss decreased (inf --> -0.439990).  Saving model ...
Epoch: 2 cost time: 2.8053534030914307
Epoch: 2, Steps: 18 | Train Loss: 0.725 Vali Loss: 1.007 Vali Acc: 0.520 Test Loss: 1.007 Test Acc: 0.520
Validation loss decreased (-0.439990 --> -0.519990).  Saving model ...
Epoch: 3 cost time: 2.7552928924560547
Epoch: 3, Steps: 18 | Train Loss: 0.711 Vali Loss: 1.527 Vali Acc: 0.440 Test Loss: 1.527 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8255579471588135
Epoch: 4, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
Validation loss decreased (-0.519990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 2.943784475326538
Epoch: 5, Steps: 18 | Train Loss: 0.630 Vali Loss: 2.413 Vali Acc: 0.490 Test Loss: 2.413 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.943850517272949
Epoch: 6, Steps: 18 | Train Loss: 0.859 Vali Loss: 1.968 Vali Acc: 0.540 Test Loss: 1.968 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.95524001121521
Epoch: 7, Steps: 18 | Train Loss: 0.391 Vali Loss: 1.778 Vali Acc: 0.500 Test Loss: 1.778 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9401347637176514
Epoch: 8, Steps: 18 | Train Loss: 0.479 Vali Loss: 1.749 Vali Acc: 0.540 Test Loss: 1.749 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.670504331588745
Epoch: 9, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.793 Vali Acc: 0.530 Test Loss: 1.793 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.454490900039673
Epoch: 10, Steps: 18 | Train Loss: 0.322 Vali Loss: 2.041 Vali Acc: 0.530 Test Loss: 2.041 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4593849182128906
Epoch: 11, Steps: 18 | Train Loss: 0.312 Vali Loss: 2.087 Vali Acc: 0.520 Test Loss: 2.087 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.583944320678711
Epoch: 12, Steps: 18 | Train Loss: 0.246 Vali Loss: 2.424 Vali Acc: 0.560 Test Loss: 2.424 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8761982917785645
Epoch: 13, Steps: 18 | Train Loss: 0.416 Vali Loss: 2.744 Vali Acc: 0.480 Test Loss: 2.744 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.779120445251465
Epoch: 14, Steps: 18 | Train Loss: 0.310 Vali Loss: 3.147 Vali Acc: 0.510 Test Loss: 3.147 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 492290
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 14.221247673034668
Epoch: 1, Steps: 18 | Train Loss: 1.692 Vali Loss: 1.996 Vali Acc: 0.590 Test Loss: 1.996 Test Acc: 0.590
Validation loss decreased (inf --> -0.589980).  Saving model ...
Epoch: 2 cost time: 11.965351343154907
Epoch: 2, Steps: 18 | Train Loss: 2.292 Vali Loss: 5.993 Vali Acc: 0.580 Test Loss: 5.993 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.832723379135132
Epoch: 3, Steps: 18 | Train Loss: 2.415 Vali Loss: 4.347 Vali Acc: 0.620 Test Loss: 4.347 Test Acc: 0.620
Validation loss decreased (-0.589980 --> -0.619957).  Saving model ...
Epoch: 4 cost time: 12.681350469589233
Epoch: 4, Steps: 18 | Train Loss: 2.802 Vali Loss: 9.413 Vali Acc: 0.490 Test Loss: 9.413 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.793838262557983
Epoch: 5, Steps: 18 | Train Loss: 2.005 Vali Loss: 6.448 Vali Acc: 0.420 Test Loss: 6.448 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.259700298309326
Epoch: 6, Steps: 18 | Train Loss: 1.531 Vali Loss: 4.921 Vali Acc: 0.570 Test Loss: 4.921 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.337129592895508
Epoch: 7, Steps: 18 | Train Loss: 0.843 Vali Loss: 9.700 Vali Acc: 0.460 Test Loss: 9.700 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.869587421417236
Epoch: 8, Steps: 18 | Train Loss: 1.497 Vali Loss: 9.701 Vali Acc: 0.570 Test Loss: 9.701 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.286758422851562
Epoch: 9, Steps: 18 | Train Loss: 1.353 Vali Loss: 10.529 Vali Acc: 0.540 Test Loss: 10.529 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 14.37966537475586
Epoch: 10, Steps: 18 | Train Loss: 3.027 Vali Loss: 20.483 Vali Acc: 0.490 Test Loss: 20.483 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.268862247467041
Epoch: 11, Steps: 18 | Train Loss: 1.768 Vali Loss: 13.210 Vali Acc: 0.480 Test Loss: 13.210 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.236706733703613
Epoch: 12, Steps: 18 | Train Loss: 1.596 Vali Loss: 14.405 Vali Acc: 0.500 Test Loss: 14.405 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 15.746959209442139
Epoch: 13, Steps: 18 | Train Loss: 1.194 Vali Loss: 13.982 Vali Acc: 0.560 Test Loss: 13.982 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 1486978
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.743155717849731
Epoch: 1, Steps: 18 | Train Loss: 0.984 Vali Loss: 0.895 Vali Acc: 0.590 Test Loss: 0.895 Test Acc: 0.590
Validation loss decreased (inf --> -0.589991).  Saving model ...
Epoch: 2 cost time: 8.384130477905273
Epoch: 2, Steps: 18 | Train Loss: 1.146 Vali Loss: 3.007 Vali Acc: 0.460 Test Loss: 3.007 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.128896951675415
Epoch: 3, Steps: 18 | Train Loss: 0.960 Vali Loss: 3.172 Vali Acc: 0.480 Test Loss: 3.172 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.688166379928589
Epoch: 4, Steps: 18 | Train Loss: 1.534 Vali Loss: 2.395 Vali Acc: 0.530 Test Loss: 2.395 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.804238796234131
Epoch: 5, Steps: 18 | Train Loss: 0.803 Vali Loss: 3.635 Vali Acc: 0.530 Test Loss: 3.635 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.005171775817871
Epoch: 6, Steps: 18 | Train Loss: 1.065 Vali Loss: 4.139 Vali Acc: 0.490 Test Loss: 4.139 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.187270879745483
Epoch: 7, Steps: 18 | Train Loss: 0.667 Vali Loss: 5.243 Vali Acc: 0.520 Test Loss: 5.243 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 8.035179853439331
Epoch: 8, Steps: 18 | Train Loss: 0.610 Vali Loss: 5.843 Vali Acc: 0.550 Test Loss: 5.843 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 7.902355909347534
Epoch: 9, Steps: 18 | Train Loss: 1.703 Vali Loss: 6.049 Vali Acc: 0.520 Test Loss: 6.049 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.86897087097168
Epoch: 10, Steps: 18 | Train Loss: 1.177 Vali Loss: 10.963 Vali Acc: 0.470 Test Loss: 10.963 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.505212306976318
Epoch: 11, Steps: 18 | Train Loss: 0.852 Vali Loss: 9.822 Vali Acc: 0.500 Test Loss: 9.822 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 873986
model size : 5.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.037649393081665
Epoch: 1, Steps: 18 | Train Loss: 1.088 Vali Loss: 0.862 Vali Acc: 0.550 Test Loss: 0.862 Test Acc: 0.550
Validation loss decreased (inf --> -0.549991).  Saving model ...
Epoch: 2 cost time: 5.4273154735565186
Epoch: 2, Steps: 18 | Train Loss: 0.970 Vali Loss: 1.892 Vali Acc: 0.590 Test Loss: 1.892 Test Acc: 0.590
Validation loss decreased (-0.549991 --> -0.589981).  Saving model ...
Epoch: 3 cost time: 5.472790002822876
Epoch: 3, Steps: 18 | Train Loss: 1.525 Vali Loss: 2.073 Vali Acc: 0.580 Test Loss: 2.073 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.199186563491821
Epoch: 4, Steps: 18 | Train Loss: 0.972 Vali Loss: 2.879 Vali Acc: 0.490 Test Loss: 2.879 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.238314390182495
Epoch: 5, Steps: 18 | Train Loss: 0.877 Vali Loss: 3.318 Vali Acc: 0.510 Test Loss: 3.318 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.235872030258179
Epoch: 6, Steps: 18 | Train Loss: 1.353 Vali Loss: 3.439 Vali Acc: 0.480 Test Loss: 3.439 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.741779565811157
Epoch: 7, Steps: 18 | Train Loss: 1.651 Vali Loss: 4.069 Vali Acc: 0.520 Test Loss: 4.069 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.94287371635437
Epoch: 8, Steps: 18 | Train Loss: 0.952 Vali Loss: 4.144 Vali Acc: 0.550 Test Loss: 4.144 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.10174822807312
Epoch: 9, Steps: 18 | Train Loss: 0.556 Vali Loss: 6.132 Vali Acc: 0.550 Test Loss: 6.132 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.322024822235107
Epoch: 10, Steps: 18 | Train Loss: 0.535 Vali Loss: 3.357 Vali Acc: 0.560 Test Loss: 3.357 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.1975908279418945
Epoch: 11, Steps: 18 | Train Loss: 0.509 Vali Loss: 5.473 Vali Acc: 0.520 Test Loss: 5.473 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.989076614379883
Epoch: 12, Steps: 18 | Train Loss: 0.689 Vali Loss: 4.717 Vali Acc: 0.510 Test Loss: 4.717 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 654210
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.615761041641235
Epoch: 1, Steps: 18 | Train Loss: 0.988 Vali Loss: 0.785 Vali Acc: 0.550 Test Loss: 0.785 Test Acc: 0.550
Validation loss decreased (inf --> -0.549992).  Saving model ...
Epoch: 2 cost time: 4.42479395866394
Epoch: 2, Steps: 18 | Train Loss: 0.850 Vali Loss: 1.323 Vali Acc: 0.490 Test Loss: 1.323 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.71933650970459
Epoch: 3, Steps: 18 | Train Loss: 0.888 Vali Loss: 1.313 Vali Acc: 0.540 Test Loss: 1.313 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.559855699539185
Epoch: 4, Steps: 18 | Train Loss: 0.932 Vali Loss: 2.960 Vali Acc: 0.540 Test Loss: 2.960 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.482342004776001
Epoch: 5, Steps: 18 | Train Loss: 0.947 Vali Loss: 2.430 Vali Acc: 0.480 Test Loss: 2.430 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.598952531814575
Epoch: 6, Steps: 18 | Train Loss: 0.995 Vali Loss: 3.248 Vali Acc: 0.530 Test Loss: 3.248 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.694369554519653
Epoch: 7, Steps: 18 | Train Loss: 1.062 Vali Loss: 2.352 Vali Acc: 0.570 Test Loss: 2.352 Test Acc: 0.570
Validation loss decreased (-0.549992 --> -0.569976).  Saving model ...
Epoch: 8 cost time: 4.645078182220459
Epoch: 8, Steps: 18 | Train Loss: 0.686 Vali Loss: 3.177 Vali Acc: 0.580 Test Loss: 3.177 Test Acc: 0.580
Validation loss decreased (-0.569976 --> -0.579968).  Saving model ...
Epoch: 9 cost time: 4.748181104660034
Epoch: 9, Steps: 18 | Train Loss: 0.663 Vali Loss: 4.218 Vali Acc: 0.480 Test Loss: 4.218 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.045003175735474
Epoch: 10, Steps: 18 | Train Loss: 0.598 Vali Loss: 3.320 Vali Acc: 0.500 Test Loss: 3.320 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.943382740020752
Epoch: 11, Steps: 18 | Train Loss: 0.932 Vali Loss: 5.540 Vali Acc: 0.550 Test Loss: 5.540 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.627225160598755
Epoch: 12, Steps: 18 | Train Loss: 1.047 Vali Loss: 5.897 Vali Acc: 0.520 Test Loss: 5.897 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.410890579223633
Epoch: 13, Steps: 18 | Train Loss: 0.498 Vali Loss: 5.299 Vali Acc: 0.570 Test Loss: 5.299 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.066583633422852
Epoch: 14, Steps: 18 | Train Loss: 0.487 Vali Loss: 8.802 Vali Acc: 0.510 Test Loss: 8.802 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.5782575607299805
Epoch: 15, Steps: 18 | Train Loss: 0.438 Vali Loss: 7.081 Vali Acc: 0.520 Test Loss: 7.081 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.6542909145355225
Epoch: 16, Steps: 18 | Train Loss: 0.509 Vali Loss: 6.267 Vali Acc: 0.480 Test Loss: 6.267 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.68071985244751
Epoch: 17, Steps: 18 | Train Loss: 0.856 Vali Loss: 9.545 Vali Acc: 0.500 Test Loss: 9.545 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.618013143539429
Epoch: 18, Steps: 18 | Train Loss: 0.328 Vali Loss: 8.487 Vali Acc: 0.500 Test Loss: 8.487 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 565506
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.130788564682007
Epoch: 1, Steps: 18 | Train Loss: 0.812 Vali Loss: 0.716 Vali Acc: 0.640 Test Loss: 0.716 Test Acc: 0.640
Validation loss decreased (inf --> -0.639993).  Saving model ...
Epoch: 2 cost time: 3.497997283935547
Epoch: 2, Steps: 18 | Train Loss: 0.702 Vali Loss: 1.617 Vali Acc: 0.470 Test Loss: 1.617 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7964439392089844
Epoch: 3, Steps: 18 | Train Loss: 0.672 Vali Loss: 1.081 Vali Acc: 0.550 Test Loss: 1.081 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.815518856048584
Epoch: 4, Steps: 18 | Train Loss: 0.615 Vali Loss: 1.527 Vali Acc: 0.580 Test Loss: 1.527 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.032107830047607
Epoch: 5, Steps: 18 | Train Loss: 0.598 Vali Loss: 1.657 Vali Acc: 0.570 Test Loss: 1.657 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.095154523849487
Epoch: 6, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.675 Vali Acc: 0.550 Test Loss: 1.675 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8552420139312744
Epoch: 7, Steps: 18 | Train Loss: 0.837 Vali Loss: 2.273 Vali Acc: 0.510 Test Loss: 2.273 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.7606828212738037
Epoch: 8, Steps: 18 | Train Loss: 0.459 Vali Loss: 2.516 Vali Acc: 0.510 Test Loss: 2.516 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.9307918548583984
Epoch: 9, Steps: 18 | Train Loss: 0.293 Vali Loss: 3.056 Vali Acc: 0.500 Test Loss: 3.056 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.593700647354126
Epoch: 10, Steps: 18 | Train Loss: 0.460 Vali Loss: 5.473 Vali Acc: 0.460 Test Loss: 5.473 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.226029396057129
Epoch: 11, Steps: 18 | Train Loss: 0.385 Vali Loss: 3.572 Vali Acc: 0.500 Test Loss: 3.572 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 470018
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.703575611114502
Epoch: 1, Steps: 18 | Train Loss: 0.854 Vali Loss: 0.932 Vali Acc: 0.490 Test Loss: 0.932 Test Acc: 0.490
Validation loss decreased (inf --> -0.489991).  Saving model ...
Epoch: 2 cost time: 3.106649398803711
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.857 Vali Acc: 0.600 Test Loss: 0.857 Test Acc: 0.600
Validation loss decreased (-0.489991 --> -0.599991).  Saving model ...
Epoch: 3 cost time: 3.1913342475891113
Epoch: 3, Steps: 18 | Train Loss: 0.858 Vali Loss: 1.115 Vali Acc: 0.540 Test Loss: 1.115 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0288851261138916
Epoch: 4, Steps: 18 | Train Loss: 0.745 Vali Loss: 1.215 Vali Acc: 0.550 Test Loss: 1.215 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1187915802001953
Epoch: 5, Steps: 18 | Train Loss: 0.543 Vali Loss: 1.205 Vali Acc: 0.570 Test Loss: 1.205 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8411121368408203
Epoch: 6, Steps: 18 | Train Loss: 0.498 Vali Loss: 1.624 Vali Acc: 0.540 Test Loss: 1.624 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0625758171081543
Epoch: 7, Steps: 18 | Train Loss: 0.457 Vali Loss: 1.609 Vali Acc: 0.520 Test Loss: 1.609 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.023763656616211
Epoch: 8, Steps: 18 | Train Loss: 0.375 Vali Loss: 2.469 Vali Acc: 0.510 Test Loss: 2.469 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2600905895233154
Epoch: 9, Steps: 18 | Train Loss: 0.452 Vali Loss: 2.278 Vali Acc: 0.530 Test Loss: 2.278 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1771068572998047
Epoch: 10, Steps: 18 | Train Loss: 0.440 Vali Loss: 1.739 Vali Acc: 0.550 Test Loss: 1.739 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.164654493331909
Epoch: 11, Steps: 18 | Train Loss: 0.581 Vali Loss: 3.088 Vali Acc: 0.580 Test Loss: 3.088 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.173360586166382
Epoch: 12, Steps: 18 | Train Loss: 0.315 Vali Loss: 2.705 Vali Acc: 0.520 Test Loss: 2.705 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 440066
model size : 4.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.530857563018799
Epoch: 1, Steps: 18 | Train Loss: 0.802 Vali Loss: 0.712 Vali Acc: 0.500 Test Loss: 0.712 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.928283929824829
Epoch: 2, Steps: 18 | Train Loss: 0.707 Vali Loss: 1.148 Vali Acc: 0.470 Test Loss: 1.148 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.978264093399048
Epoch: 3, Steps: 18 | Train Loss: 0.702 Vali Loss: 1.110 Vali Acc: 0.550 Test Loss: 1.110 Test Acc: 0.550
Validation loss decreased (-0.499993 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 2.99222731590271
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 1.655 Vali Acc: 0.520 Test Loss: 1.655 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0988190174102783
Epoch: 5, Steps: 18 | Train Loss: 0.571 Vali Loss: 1.474 Vali Acc: 0.500 Test Loss: 1.474 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.046966075897217
Epoch: 6, Steps: 18 | Train Loss: 0.526 Vali Loss: 2.004 Vali Acc: 0.470 Test Loss: 2.004 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9961133003234863
Epoch: 7, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.430 Vali Acc: 0.550 Test Loss: 1.430 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8496062755584717
Epoch: 8, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.968 Vali Acc: 0.600 Test Loss: 1.968 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599980).  Saving model ...
Epoch: 9 cost time: 2.884599447250366
Epoch: 9, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.924 Vali Acc: 0.530 Test Loss: 1.924 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8876454830169678
Epoch: 10, Steps: 18 | Train Loss: 0.411 Vali Loss: 2.420 Vali Acc: 0.560 Test Loss: 2.420 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1622250080108643
Epoch: 11, Steps: 18 | Train Loss: 0.418 Vali Loss: 2.277 Vali Acc: 0.540 Test Loss: 2.277 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0935420989990234
Epoch: 12, Steps: 18 | Train Loss: 0.330 Vali Loss: 2.178 Vali Acc: 0.480 Test Loss: 2.178 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9767422676086426
Epoch: 13, Steps: 18 | Train Loss: 0.363 Vali Loss: 2.456 Vali Acc: 0.550 Test Loss: 2.456 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0404539108276367
Epoch: 14, Steps: 18 | Train Loss: 0.242 Vali Loss: 2.720 Vali Acc: 0.500 Test Loss: 2.720 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.077610731124878
Epoch: 15, Steps: 18 | Train Loss: 0.237 Vali Loss: 2.756 Vali Acc: 0.550 Test Loss: 2.756 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8756604194641113
Epoch: 16, Steps: 18 | Train Loss: 0.296 Vali Loss: 4.020 Vali Acc: 0.510 Test Loss: 4.020 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9962446689605713
Epoch: 17, Steps: 18 | Train Loss: 0.272 Vali Loss: 3.516 Vali Acc: 0.550 Test Loss: 3.516 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.982724189758301
Epoch: 18, Steps: 18 | Train Loss: 0.236 Vali Loss: 2.984 Vali Acc: 0.610 Test Loss: 2.984 Test Acc: 0.610
Validation loss decreased (-0.599980 --> -0.609970).  Saving model ...
Epoch: 19 cost time: 2.8237855434417725
Epoch: 19, Steps: 18 | Train Loss: 0.336 Vali Loss: 3.227 Vali Acc: 0.600 Test Loss: 3.227 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9148213863372803
Epoch: 20, Steps: 18 | Train Loss: 0.161 Vali Loss: 3.432 Vali Acc: 0.500 Test Loss: 3.432 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.96524715423584
Epoch: 21, Steps: 18 | Train Loss: 0.139 Vali Loss: 3.843 Vali Acc: 0.570 Test Loss: 3.843 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.030970811843872
Epoch: 22, Steps: 18 | Train Loss: 0.384 Vali Loss: 4.261 Vali Acc: 0.580 Test Loss: 4.261 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.0291783809661865
Epoch: 23, Steps: 18 | Train Loss: 0.171 Vali Loss: 3.955 Vali Acc: 0.560 Test Loss: 3.955 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0886616706848145
Epoch: 24, Steps: 18 | Train Loss: 0.141 Vali Loss: 4.100 Vali Acc: 0.530 Test Loss: 4.100 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.0911433696746826
Epoch: 25, Steps: 18 | Train Loss: 0.106 Vali Loss: 4.311 Vali Acc: 0.520 Test Loss: 4.311 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7606711387634277
Epoch: 26, Steps: 18 | Train Loss: 0.251 Vali Loss: 4.729 Vali Acc: 0.610 Test Loss: 4.729 Test Acc: 0.610
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.891779899597168
Epoch: 27, Steps: 18 | Train Loss: 0.210 Vali Loss: 4.728 Vali Acc: 0.550 Test Loss: 4.728 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.0505011081695557
Epoch: 28, Steps: 18 | Train Loss: 0.207 Vali Loss: 4.824 Vali Acc: 0.470 Test Loss: 4.824 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 426498
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 15.144599437713623
Epoch: 1, Steps: 18 | Train Loss: 2.493 Vali Loss: 3.023 Vali Acc: 0.540 Test Loss: 3.023 Test Acc: 0.540
Validation loss decreased (inf --> -0.539970).  Saving model ...
Epoch: 2 cost time: 13.053480386734009
Epoch: 2, Steps: 18 | Train Loss: 1.793 Vali Loss: 2.403 Vali Acc: 0.520 Test Loss: 2.403 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 12.275439500808716
Epoch: 3, Steps: 18 | Train Loss: 2.018 Vali Loss: 5.402 Vali Acc: 0.530 Test Loss: 5.402 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.843544006347656
Epoch: 4, Steps: 18 | Train Loss: 2.008 Vali Loss: 6.272 Vali Acc: 0.600 Test Loss: 6.272 Test Acc: 0.600
Validation loss decreased (-0.539970 --> -0.599937).  Saving model ...
Epoch: 5 cost time: 13.626333236694336
Epoch: 5, Steps: 18 | Train Loss: 3.868 Vali Loss: 5.808 Vali Acc: 0.510 Test Loss: 5.808 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.274567365646362
Epoch: 6, Steps: 18 | Train Loss: 2.803 Vali Loss: 10.034 Vali Acc: 0.580 Test Loss: 10.034 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.175031661987305
Epoch: 7, Steps: 18 | Train Loss: 3.393 Vali Loss: 11.016 Vali Acc: 0.520 Test Loss: 11.016 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.004167556762695
Epoch: 8, Steps: 18 | Train Loss: 2.688 Vali Loss: 10.729 Vali Acc: 0.500 Test Loss: 10.729 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 12.83379864692688
Epoch: 9, Steps: 18 | Train Loss: 1.817 Vali Loss: 13.900 Vali Acc: 0.570 Test Loss: 13.900 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 12.039909362792969
Epoch: 10, Steps: 18 | Train Loss: 2.716 Vali Loss: 27.070 Vali Acc: 0.520 Test Loss: 27.070 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 11.908129930496216
Epoch: 11, Steps: 18 | Train Loss: 3.014 Vali Loss: 12.990 Vali Acc: 0.510 Test Loss: 12.990 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 12.536872386932373
Epoch: 12, Steps: 18 | Train Loss: 2.123 Vali Loss: 10.940 Vali Acc: 0.600 Test Loss: 10.940 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.766677141189575
Epoch: 13, Steps: 18 | Train Loss: 1.265 Vali Loss: 16.722 Vali Acc: 0.570 Test Loss: 16.722 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 11.866063117980957
Epoch: 14, Steps: 18 | Train Loss: 1.237 Vali Loss: 11.965 Vali Acc: 0.560 Test Loss: 11.965 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 1454082
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.968445062637329
Epoch: 1, Steps: 18 | Train Loss: 1.081 Vali Loss: 1.504 Vali Acc: 0.520 Test Loss: 1.504 Test Acc: 0.520
Validation loss decreased (inf --> -0.519985).  Saving model ...
Epoch: 2 cost time: 6.490168333053589
Epoch: 2, Steps: 18 | Train Loss: 0.948 Vali Loss: 1.259 Vali Acc: 0.610 Test Loss: 1.259 Test Acc: 0.610
Validation loss decreased (-0.519985 --> -0.609987).  Saving model ...
Epoch: 3 cost time: 6.333117723464966
Epoch: 3, Steps: 18 | Train Loss: 2.046 Vali Loss: 2.947 Vali Acc: 0.510 Test Loss: 2.947 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.519970178604126
Epoch: 4, Steps: 18 | Train Loss: 2.126 Vali Loss: 2.240 Vali Acc: 0.570 Test Loss: 2.240 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.600642681121826
Epoch: 5, Steps: 18 | Train Loss: 0.903 Vali Loss: 2.528 Vali Acc: 0.540 Test Loss: 2.528 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.7813639640808105
Epoch: 6, Steps: 18 | Train Loss: 0.857 Vali Loss: 4.608 Vali Acc: 0.490 Test Loss: 4.608 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.475682497024536
Epoch: 7, Steps: 18 | Train Loss: 0.623 Vali Loss: 4.771 Vali Acc: 0.530 Test Loss: 4.771 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.295237302780151
Epoch: 8, Steps: 18 | Train Loss: 1.728 Vali Loss: 13.004 Vali Acc: 0.520 Test Loss: 13.004 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.543145179748535
Epoch: 9, Steps: 18 | Train Loss: 1.528 Vali Loss: 6.703 Vali Acc: 0.550 Test Loss: 6.703 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.81783390045166
Epoch: 10, Steps: 18 | Train Loss: 1.199 Vali Loss: 11.569 Vali Acc: 0.520 Test Loss: 11.569 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.524312496185303
Epoch: 11, Steps: 18 | Train Loss: 2.456 Vali Loss: 12.056 Vali Acc: 0.560 Test Loss: 12.056 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.7248945236206055
Epoch: 12, Steps: 18 | Train Loss: 1.528 Vali Loss: 8.147 Vali Acc: 0.560 Test Loss: 8.147 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 841090
model size : 5.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.28984260559082
Epoch: 1, Steps: 18 | Train Loss: 1.119 Vali Loss: 0.878 Vali Acc: 0.540 Test Loss: 0.878 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 4.615837574005127
Epoch: 2, Steps: 18 | Train Loss: 1.062 Vali Loss: 1.817 Vali Acc: 0.560 Test Loss: 1.817 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559982).  Saving model ...
Epoch: 3 cost time: 4.617916584014893
Epoch: 3, Steps: 18 | Train Loss: 0.964 Vali Loss: 2.151 Vali Acc: 0.590 Test Loss: 2.151 Test Acc: 0.590
Validation loss decreased (-0.559982 --> -0.589978).  Saving model ...
Epoch: 4 cost time: 4.739032983779907
Epoch: 4, Steps: 18 | Train Loss: 0.960 Vali Loss: 2.583 Vali Acc: 0.580 Test Loss: 2.583 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.583024263381958
Epoch: 5, Steps: 18 | Train Loss: 0.652 Vali Loss: 2.795 Vali Acc: 0.530 Test Loss: 2.795 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.307568550109863
Epoch: 6, Steps: 18 | Train Loss: 1.319 Vali Loss: 1.970 Vali Acc: 0.550 Test Loss: 1.970 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.493651628494263
Epoch: 7, Steps: 18 | Train Loss: 0.944 Vali Loss: 7.440 Vali Acc: 0.530 Test Loss: 7.440 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.54308009147644
Epoch: 8, Steps: 18 | Train Loss: 1.272 Vali Loss: 3.617 Vali Acc: 0.550 Test Loss: 3.617 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.6161792278289795
Epoch: 9, Steps: 18 | Train Loss: 1.200 Vali Loss: 5.812 Vali Acc: 0.550 Test Loss: 5.812 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.51286768913269
Epoch: 10, Steps: 18 | Train Loss: 1.004 Vali Loss: 6.591 Vali Acc: 0.500 Test Loss: 6.591 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.424315929412842
Epoch: 11, Steps: 18 | Train Loss: 0.659 Vali Loss: 4.949 Vali Acc: 0.530 Test Loss: 4.949 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.44681715965271
Epoch: 12, Steps: 18 | Train Loss: 0.752 Vali Loss: 5.048 Vali Acc: 0.550 Test Loss: 5.048 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.426769733428955
Epoch: 13, Steps: 18 | Train Loss: 0.594 Vali Loss: 6.982 Vali Acc: 0.520 Test Loss: 6.982 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 621314
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.775228023529053
Epoch: 1, Steps: 18 | Train Loss: 0.966 Vali Loss: 0.993 Vali Acc: 0.550 Test Loss: 0.993 Test Acc: 0.550
Validation loss decreased (inf --> -0.549990).  Saving model ...
Epoch: 2 cost time: 4.541012287139893
Epoch: 2, Steps: 18 | Train Loss: 0.860 Vali Loss: 1.505 Vali Acc: 0.550 Test Loss: 1.505 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.650877952575684
Epoch: 3, Steps: 18 | Train Loss: 0.718 Vali Loss: 2.276 Vali Acc: 0.550 Test Loss: 2.276 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.437132358551025
Epoch: 4, Steps: 18 | Train Loss: 0.949 Vali Loss: 1.840 Vali Acc: 0.520 Test Loss: 1.840 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.298713207244873
Epoch: 5, Steps: 18 | Train Loss: 0.694 Vali Loss: 2.728 Vali Acc: 0.470 Test Loss: 2.728 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.220665693283081
Epoch: 6, Steps: 18 | Train Loss: 0.571 Vali Loss: 3.396 Vali Acc: 0.520 Test Loss: 3.396 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.7654290199279785
Epoch: 7, Steps: 18 | Train Loss: 0.705 Vali Loss: 2.376 Vali Acc: 0.580 Test Loss: 2.376 Test Acc: 0.580
Validation loss decreased (-0.549990 --> -0.579976).  Saving model ...
Epoch: 8 cost time: 4.001511335372925
Epoch: 8, Steps: 18 | Train Loss: 0.922 Vali Loss: 3.225 Vali Acc: 0.530 Test Loss: 3.225 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.20082950592041
Epoch: 9, Steps: 18 | Train Loss: 0.663 Vali Loss: 4.005 Vali Acc: 0.560 Test Loss: 4.005 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.249867916107178
Epoch: 10, Steps: 18 | Train Loss: 0.530 Vali Loss: 6.175 Vali Acc: 0.520 Test Loss: 6.175 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.380733966827393
Epoch: 11, Steps: 18 | Train Loss: 0.511 Vali Loss: 7.199 Vali Acc: 0.580 Test Loss: 7.199 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.246411323547363
Epoch: 12, Steps: 18 | Train Loss: 0.914 Vali Loss: 6.927 Vali Acc: 0.460 Test Loss: 6.927 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.107381820678711
Epoch: 13, Steps: 18 | Train Loss: 0.403 Vali Loss: 6.160 Vali Acc: 0.560 Test Loss: 6.160 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.326688766479492
Epoch: 14, Steps: 18 | Train Loss: 0.344 Vali Loss: 4.555 Vali Acc: 0.500 Test Loss: 4.555 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.242316484451294
Epoch: 15, Steps: 18 | Train Loss: 0.656 Vali Loss: 6.714 Vali Acc: 0.610 Test Loss: 6.714 Test Acc: 0.610
Validation loss decreased (-0.579976 --> -0.609933).  Saving model ...
Epoch: 16 cost time: 4.609947443008423
Epoch: 16, Steps: 18 | Train Loss: 0.569 Vali Loss: 7.295 Vali Acc: 0.510 Test Loss: 7.295 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.372337102890015
Epoch: 17, Steps: 18 | Train Loss: 0.464 Vali Loss: 10.929 Vali Acc: 0.450 Test Loss: 10.929 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.4938881397247314
Epoch: 18, Steps: 18 | Train Loss: 0.384 Vali Loss: 10.425 Vali Acc: 0.500 Test Loss: 10.425 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.534957647323608
Epoch: 19, Steps: 18 | Train Loss: 0.664 Vali Loss: 10.378 Vali Acc: 0.510 Test Loss: 10.378 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.3384480476379395
Epoch: 20, Steps: 18 | Train Loss: 0.615 Vali Loss: 10.501 Vali Acc: 0.490 Test Loss: 10.501 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.087478160858154
Epoch: 21, Steps: 18 | Train Loss: 0.469 Vali Loss: 11.334 Vali Acc: 0.500 Test Loss: 11.334 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.239283323287964
Epoch: 22, Steps: 18 | Train Loss: 0.240 Vali Loss: 12.384 Vali Acc: 0.470 Test Loss: 12.384 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.150250673294067
Epoch: 23, Steps: 18 | Train Loss: 0.644 Vali Loss: 12.789 Vali Acc: 0.560 Test Loss: 12.789 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.43056058883667
Epoch: 24, Steps: 18 | Train Loss: 1.378 Vali Loss: 14.119 Vali Acc: 0.510 Test Loss: 14.119 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.348935842514038
Epoch: 25, Steps: 18 | Train Loss: 0.161 Vali Loss: 15.611 Vali Acc: 0.520 Test Loss: 15.611 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 532610
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.805931568145752
Epoch: 1, Steps: 18 | Train Loss: 0.938 Vali Loss: 0.853 Vali Acc: 0.470 Test Loss: 0.853 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 3.363966941833496
Epoch: 2, Steps: 18 | Train Loss: 0.737 Vali Loss: 1.653 Vali Acc: 0.500 Test Loss: 1.653 Test Acc: 0.500
Validation loss decreased (-0.469991 --> -0.499983).  Saving model ...
Epoch: 3 cost time: 3.3245396614074707
Epoch: 3, Steps: 18 | Train Loss: 1.178 Vali Loss: 3.934 Vali Acc: 0.510 Test Loss: 3.934 Test Acc: 0.510
Validation loss decreased (-0.499983 --> -0.509961).  Saving model ...
Epoch: 4 cost time: 3.0295650959014893
Epoch: 4, Steps: 18 | Train Loss: 0.943 Vali Loss: 1.573 Vali Acc: 0.450 Test Loss: 1.573 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1484975814819336
Epoch: 5, Steps: 18 | Train Loss: 0.638 Vali Loss: 2.120 Vali Acc: 0.470 Test Loss: 2.120 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4439103603363037
Epoch: 6, Steps: 18 | Train Loss: 0.549 Vali Loss: 2.651 Vali Acc: 0.470 Test Loss: 2.651 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3069355487823486
Epoch: 7, Steps: 18 | Train Loss: 0.524 Vali Loss: 2.304 Vali Acc: 0.470 Test Loss: 2.304 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.387192487716675
Epoch: 8, Steps: 18 | Train Loss: 0.437 Vali Loss: 2.461 Vali Acc: 0.490 Test Loss: 2.461 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.269979953765869
Epoch: 9, Steps: 18 | Train Loss: 0.611 Vali Loss: 2.819 Vali Acc: 0.480 Test Loss: 2.819 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2864487171173096
Epoch: 10, Steps: 18 | Train Loss: 0.478 Vali Loss: 3.108 Vali Acc: 0.550 Test Loss: 3.108 Test Acc: 0.550
Validation loss decreased (-0.509961 --> -0.549969).  Saving model ...
Epoch: 11 cost time: 3.433872938156128
Epoch: 11, Steps: 18 | Train Loss: 0.553 Vali Loss: 3.680 Vali Acc: 0.490 Test Loss: 3.680 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2671847343444824
Epoch: 12, Steps: 18 | Train Loss: 0.493 Vali Loss: 3.789 Vali Acc: 0.490 Test Loss: 3.789 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.35335373878479
Epoch: 13, Steps: 18 | Train Loss: 0.859 Vali Loss: 3.668 Vali Acc: 0.540 Test Loss: 3.668 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.337707042694092
Epoch: 14, Steps: 18 | Train Loss: 0.364 Vali Loss: 3.839 Vali Acc: 0.580 Test Loss: 3.839 Test Acc: 0.580
Validation loss decreased (-0.549969 --> -0.579962).  Saving model ...
Epoch: 15 cost time: 3.208042860031128
Epoch: 15, Steps: 18 | Train Loss: 0.727 Vali Loss: 3.119 Vali Acc: 0.540 Test Loss: 3.119 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1332576274871826
Epoch: 16, Steps: 18 | Train Loss: 0.484 Vali Loss: 7.120 Vali Acc: 0.540 Test Loss: 7.120 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.088517427444458
Epoch: 17, Steps: 18 | Train Loss: 0.800 Vali Loss: 8.008 Vali Acc: 0.480 Test Loss: 8.008 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.2010998725891113
Epoch: 18, Steps: 18 | Train Loss: 0.814 Vali Loss: 6.442 Vali Acc: 0.490 Test Loss: 6.442 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.262756824493408
Epoch: 19, Steps: 18 | Train Loss: 0.500 Vali Loss: 10.597 Vali Acc: 0.480 Test Loss: 10.597 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3009767532348633
Epoch: 20, Steps: 18 | Train Loss: 0.325 Vali Loss: 9.330 Vali Acc: 0.490 Test Loss: 9.330 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2397701740264893
Epoch: 21, Steps: 18 | Train Loss: 0.219 Vali Loss: 9.316 Vali Acc: 0.490 Test Loss: 9.316 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.196972370147705
Epoch: 22, Steps: 18 | Train Loss: 0.396 Vali Loss: 8.317 Vali Acc: 0.510 Test Loss: 8.317 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.3374850749969482
Epoch: 23, Steps: 18 | Train Loss: 0.229 Vali Loss: 9.393 Vali Acc: 0.500 Test Loss: 9.393 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.244007110595703
Epoch: 24, Steps: 18 | Train Loss: 0.413 Vali Loss: 10.889 Vali Acc: 0.500 Test Loss: 10.889 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 437122
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.499126672744751
Epoch: 1, Steps: 18 | Train Loss: 0.829 Vali Loss: 1.002 Vali Acc: 0.500 Test Loss: 1.002 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 2.684852123260498
Epoch: 2, Steps: 18 | Train Loss: 0.994 Vali Loss: 1.650 Vali Acc: 0.520 Test Loss: 1.650 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519983).  Saving model ...
Epoch: 3 cost time: 2.9738378524780273
Epoch: 3, Steps: 18 | Train Loss: 0.880 Vali Loss: 1.387 Vali Acc: 0.470 Test Loss: 1.387 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8461649417877197
Epoch: 4, Steps: 18 | Train Loss: 0.628 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8769612312316895
Epoch: 5, Steps: 18 | Train Loss: 0.694 Vali Loss: 1.397 Vali Acc: 0.560 Test Loss: 1.397 Test Acc: 0.560
Validation loss decreased (-0.519983 --> -0.559986).  Saving model ...
Epoch: 6 cost time: 2.9588608741760254
Epoch: 6, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.632 Vali Acc: 0.500 Test Loss: 1.632 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.875361680984497
Epoch: 7, Steps: 18 | Train Loss: 0.522 Vali Loss: 1.557 Vali Acc: 0.500 Test Loss: 1.557 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9994306564331055
Epoch: 8, Steps: 18 | Train Loss: 0.605 Vali Loss: 2.785 Vali Acc: 0.460 Test Loss: 2.785 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9496042728424072
Epoch: 9, Steps: 18 | Train Loss: 0.458 Vali Loss: 3.017 Vali Acc: 0.470 Test Loss: 3.017 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.95462965965271
Epoch: 10, Steps: 18 | Train Loss: 0.650 Vali Loss: 2.638 Vali Acc: 0.470 Test Loss: 2.638 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.8455634117126465
Epoch: 11, Steps: 18 | Train Loss: 0.516 Vali Loss: 2.979 Vali Acc: 0.450 Test Loss: 2.979 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.746159315109253
Epoch: 12, Steps: 18 | Train Loss: 0.389 Vali Loss: 3.427 Vali Acc: 0.510 Test Loss: 3.427 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.7488062381744385
Epoch: 13, Steps: 18 | Train Loss: 0.466 Vali Loss: 4.290 Vali Acc: 0.470 Test Loss: 4.290 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.6873977184295654
Epoch: 14, Steps: 18 | Train Loss: 0.594 Vali Loss: 3.275 Vali Acc: 0.520 Test Loss: 3.275 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.94498872756958
Epoch: 15, Steps: 18 | Train Loss: 0.225 Vali Loss: 3.371 Vali Acc: 0.530 Test Loss: 3.371 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 407170
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.285049915313721
Epoch: 1, Steps: 18 | Train Loss: 0.813 Vali Loss: 0.748 Vali Acc: 0.570 Test Loss: 0.748 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.559964895248413
Epoch: 2, Steps: 18 | Train Loss: 0.661 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5585665702819824
Epoch: 3, Steps: 18 | Train Loss: 0.605 Vali Loss: 1.124 Vali Acc: 0.510 Test Loss: 1.124 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5312397480010986
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 1.158 Vali Acc: 0.580 Test Loss: 1.158 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579988).  Saving model ...
Epoch: 5 cost time: 2.6290738582611084
Epoch: 5, Steps: 18 | Train Loss: 0.479 Vali Loss: 1.485 Vali Acc: 0.570 Test Loss: 1.485 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4693257808685303
Epoch: 6, Steps: 18 | Train Loss: 0.477 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.676048755645752
Epoch: 7, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.877 Vali Acc: 0.590 Test Loss: 1.877 Test Acc: 0.590
Validation loss decreased (-0.579988 --> -0.589981).  Saving model ...
Epoch: 8 cost time: 2.850980520248413
Epoch: 8, Steps: 18 | Train Loss: 0.470 Vali Loss: 1.777 Vali Acc: 0.470 Test Loss: 1.777 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8788859844207764
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.606 Vali Acc: 0.550 Test Loss: 1.606 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6539130210876465
Epoch: 10, Steps: 18 | Train Loss: 0.514 Vali Loss: 2.824 Vali Acc: 0.490 Test Loss: 2.824 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7023448944091797
Epoch: 11, Steps: 18 | Train Loss: 0.464 Vali Loss: 2.541 Vali Acc: 0.500 Test Loss: 2.541 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6993188858032227
Epoch: 12, Steps: 18 | Train Loss: 0.438 Vali Loss: 2.705 Vali Acc: 0.560 Test Loss: 2.705 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.819901943206787
Epoch: 13, Steps: 18 | Train Loss: 0.418 Vali Loss: 2.066 Vali Acc: 0.540 Test Loss: 2.066 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8854475021362305
Epoch: 14, Steps: 18 | Train Loss: 0.262 Vali Loss: 2.719 Vali Acc: 0.540 Test Loss: 2.719 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7423388957977295
Epoch: 15, Steps: 18 | Train Loss: 0.240 Vali Loss: 3.510 Vali Acc: 0.500 Test Loss: 3.510 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6257741451263428
Epoch: 16, Steps: 18 | Train Loss: 0.373 Vali Loss: 3.566 Vali Acc: 0.470 Test Loss: 3.566 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8121745586395264
Epoch: 17, Steps: 18 | Train Loss: 0.177 Vali Loss: 2.876 Vali Acc: 0.490 Test Loss: 2.876 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm128_nh16_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 393602
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 13.350574016571045
Epoch: 1, Steps: 18 | Train Loss: 1.104 Vali Loss: 0.798 Vali Acc: 0.560 Test Loss: 0.798 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 11.585506916046143
Epoch: 2, Steps: 18 | Train Loss: 1.417 Vali Loss: 1.601 Vali Acc: 0.540 Test Loss: 1.601 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.554229259490967
Epoch: 3, Steps: 18 | Train Loss: 1.392 Vali Loss: 2.013 Vali Acc: 0.570 Test Loss: 2.013 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569980).  Saving model ...
Epoch: 4 cost time: 11.253952264785767
Epoch: 4, Steps: 18 | Train Loss: 1.823 Vali Loss: 1.920 Vali Acc: 0.560 Test Loss: 1.920 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.577949285507202
Epoch: 5, Steps: 18 | Train Loss: 0.963 Vali Loss: 5.584 Vali Acc: 0.500 Test Loss: 5.584 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.472151041030884
Epoch: 6, Steps: 18 | Train Loss: 1.667 Vali Loss: 9.358 Vali Acc: 0.510 Test Loss: 9.358 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 12.029743194580078
Epoch: 7, Steps: 18 | Train Loss: 0.808 Vali Loss: 3.681 Vali Acc: 0.580 Test Loss: 3.681 Test Acc: 0.580
Validation loss decreased (-0.569980 --> -0.579963).  Saving model ...
Epoch: 8 cost time: 11.945428133010864
Epoch: 8, Steps: 18 | Train Loss: 0.914 Vali Loss: 6.406 Vali Acc: 0.500 Test Loss: 6.406 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.291610479354858
Epoch: 9, Steps: 18 | Train Loss: 1.473 Vali Loss: 7.662 Vali Acc: 0.490 Test Loss: 7.662 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.69654107093811
Epoch: 10, Steps: 18 | Train Loss: 1.142 Vali Loss: 9.376 Vali Acc: 0.520 Test Loss: 9.376 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.910181760787964
Epoch: 11, Steps: 18 | Train Loss: 1.057 Vali Loss: 6.385 Vali Acc: 0.550 Test Loss: 6.385 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.216190099716187
Epoch: 12, Steps: 18 | Train Loss: 0.704 Vali Loss: 6.916 Vali Acc: 0.500 Test Loss: 6.916 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.937920093536377
Epoch: 13, Steps: 18 | Train Loss: 0.754 Vali Loss: 9.846 Vali Acc: 0.520 Test Loss: 9.846 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.320939540863037
Epoch: 14, Steps: 18 | Train Loss: 0.897 Vali Loss: 10.878 Vali Acc: 0.520 Test Loss: 10.878 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.676412343978882
Epoch: 15, Steps: 18 | Train Loss: 0.538 Vali Loss: 8.625 Vali Acc: 0.520 Test Loss: 8.625 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.46957015991211
Epoch: 16, Steps: 18 | Train Loss: 0.490 Vali Loss: 12.087 Vali Acc: 0.610 Test Loss: 12.087 Test Acc: 0.610
Validation loss decreased (-0.579963 --> -0.609879).  Saving model ...
Epoch: 17 cost time: 13.894547700881958
Epoch: 17, Steps: 18 | Train Loss: 1.178 Vali Loss: 13.003 Vali Acc: 0.510 Test Loss: 13.003 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 13.896857261657715
Epoch: 18, Steps: 18 | Train Loss: 0.638 Vali Loss: 11.903 Vali Acc: 0.520 Test Loss: 11.903 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.413939476013184
Epoch: 19, Steps: 18 | Train Loss: 0.248 Vali Loss: 16.642 Vali Acc: 0.430 Test Loss: 16.642 Test Acc: 0.430
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 12.53922963142395
Epoch: 20, Steps: 18 | Train Loss: 0.188 Vali Loss: 10.418 Vali Acc: 0.590 Test Loss: 10.418 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.410295963287354
Epoch: 21, Steps: 18 | Train Loss: 0.775 Vali Loss: 13.438 Vali Acc: 0.520 Test Loss: 13.438 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.845696926116943
Epoch: 22, Steps: 18 | Train Loss: 1.690 Vali Loss: 21.484 Vali Acc: 0.410 Test Loss: 21.484 Test Acc: 0.410
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.703634977340698
Epoch: 23, Steps: 18 | Train Loss: 0.765 Vali Loss: 30.122 Vali Acc: 0.470 Test Loss: 30.122 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.051048517227173
Epoch: 24, Steps: 18 | Train Loss: 0.577 Vali Loss: 18.098 Vali Acc: 0.430 Test Loss: 18.098 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.525631427764893
Epoch: 25, Steps: 18 | Train Loss: 0.049 Vali Loss: 16.657 Vali Acc: 0.470 Test Loss: 16.657 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 11.018857479095459
Epoch: 26, Steps: 18 | Train Loss: 0.414 Vali Loss: 20.392 Vali Acc: 0.550 Test Loss: 20.392 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 743874
model size : 4.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.729122638702393
Epoch: 1, Steps: 18 | Train Loss: 0.858 Vali Loss: 1.050 Vali Acc: 0.450 Test Loss: 1.050 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 5.968898296356201
Epoch: 2, Steps: 18 | Train Loss: 0.809 Vali Loss: 1.253 Vali Acc: 0.520 Test Loss: 1.253 Test Acc: 0.520
Validation loss decreased (-0.449990 --> -0.519987).  Saving model ...
Epoch: 3 cost time: 5.7191162109375
Epoch: 3, Steps: 18 | Train Loss: 0.904 Vali Loss: 1.241 Vali Acc: 0.610 Test Loss: 1.241 Test Acc: 0.610
Validation loss decreased (-0.519987 --> -0.609988).  Saving model ...
Epoch: 4 cost time: 5.699274778366089
Epoch: 4, Steps: 18 | Train Loss: 0.883 Vali Loss: 1.669 Vali Acc: 0.500 Test Loss: 1.669 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.627761602401733
Epoch: 5, Steps: 18 | Train Loss: 0.926 Vali Loss: 2.262 Vali Acc: 0.520 Test Loss: 2.262 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.561434507369995
Epoch: 6, Steps: 18 | Train Loss: 1.385 Vali Loss: 3.455 Vali Acc: 0.490 Test Loss: 3.455 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.865980386734009
Epoch: 7, Steps: 18 | Train Loss: 0.884 Vali Loss: 3.508 Vali Acc: 0.520 Test Loss: 3.508 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.815292119979858
Epoch: 8, Steps: 18 | Train Loss: 0.486 Vali Loss: 3.260 Vali Acc: 0.510 Test Loss: 3.260 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.7849366664886475
Epoch: 9, Steps: 18 | Train Loss: 0.546 Vali Loss: 4.140 Vali Acc: 0.660 Test Loss: 4.140 Test Acc: 0.660
Validation loss decreased (-0.609988 --> -0.659959).  Saving model ...
Epoch: 10 cost time: 5.792267799377441
Epoch: 10, Steps: 18 | Train Loss: 0.635 Vali Loss: 3.641 Vali Acc: 0.500 Test Loss: 3.641 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.644484043121338
Epoch: 11, Steps: 18 | Train Loss: 0.448 Vali Loss: 6.861 Vali Acc: 0.520 Test Loss: 6.861 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.9085211753845215
Epoch: 12, Steps: 18 | Train Loss: 1.375 Vali Loss: 5.483 Vali Acc: 0.550 Test Loss: 5.483 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.796202659606934
Epoch: 13, Steps: 18 | Train Loss: 0.658 Vali Loss: 7.455 Vali Acc: 0.470 Test Loss: 7.455 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.749537944793701
Epoch: 14, Steps: 18 | Train Loss: 0.634 Vali Loss: 7.834 Vali Acc: 0.530 Test Loss: 7.834 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.983594655990601
Epoch: 15, Steps: 18 | Train Loss: 0.337 Vali Loss: 5.503 Vali Acc: 0.520 Test Loss: 5.503 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.740427255630493
Epoch: 16, Steps: 18 | Train Loss: 0.285 Vali Loss: 6.623 Vali Acc: 0.470 Test Loss: 6.623 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.4804651737213135
Epoch: 17, Steps: 18 | Train Loss: 0.376 Vali Loss: 5.259 Vali Acc: 0.520 Test Loss: 5.259 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.840408802032471
Epoch: 18, Steps: 18 | Train Loss: 0.316 Vali Loss: 5.468 Vali Acc: 0.560 Test Loss: 5.468 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.819295406341553
Epoch: 19, Steps: 18 | Train Loss: 0.308 Vali Loss: 8.493 Vali Acc: 0.530 Test Loss: 8.493 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 437378
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.046004295349121
Epoch: 1, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.841 Vali Acc: 0.500 Test Loss: 0.841 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 4.107980728149414
Epoch: 2, Steps: 18 | Train Loss: 0.683 Vali Loss: 1.284 Vali Acc: 0.430 Test Loss: 1.284 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.185633420944214
Epoch: 3, Steps: 18 | Train Loss: 0.683 Vali Loss: 0.936 Vali Acc: 0.520 Test Loss: 0.936 Test Acc: 0.520
Validation loss decreased (-0.499992 --> -0.519991).  Saving model ...
Epoch: 4 cost time: 4.089247941970825
Epoch: 4, Steps: 18 | Train Loss: 0.450 Vali Loss: 1.194 Vali Acc: 0.480 Test Loss: 1.194 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.5925681591033936
Epoch: 5, Steps: 18 | Train Loss: 0.601 Vali Loss: 1.382 Vali Acc: 0.540 Test Loss: 1.382 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539986).  Saving model ...
Epoch: 6 cost time: 4.451201915740967
Epoch: 6, Steps: 18 | Train Loss: 0.467 Vali Loss: 2.202 Vali Acc: 0.540 Test Loss: 2.202 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.478116273880005
Epoch: 7, Steps: 18 | Train Loss: 0.418 Vali Loss: 2.162 Vali Acc: 0.520 Test Loss: 2.162 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.496044158935547
Epoch: 8, Steps: 18 | Train Loss: 0.335 Vali Loss: 2.087 Vali Acc: 0.500 Test Loss: 2.087 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.537754774093628
Epoch: 9, Steps: 18 | Train Loss: 0.237 Vali Loss: 2.969 Vali Acc: 0.500 Test Loss: 2.969 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.007334470748901
Epoch: 10, Steps: 18 | Train Loss: 0.258 Vali Loss: 3.505 Vali Acc: 0.540 Test Loss: 3.505 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.283283710479736
Epoch: 11, Steps: 18 | Train Loss: 0.728 Vali Loss: 3.017 Vali Acc: 0.530 Test Loss: 3.017 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.045537233352661
Epoch: 12, Steps: 18 | Train Loss: 0.298 Vali Loss: 4.639 Vali Acc: 0.540 Test Loss: 4.639 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.002461910247803
Epoch: 13, Steps: 18 | Train Loss: 0.729 Vali Loss: 3.403 Vali Acc: 0.540 Test Loss: 3.403 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.225999355316162
Epoch: 14, Steps: 18 | Train Loss: 0.383 Vali Loss: 4.769 Vali Acc: 0.510 Test Loss: 4.769 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.164028882980347
Epoch: 15, Steps: 18 | Train Loss: 0.217 Vali Loss: 3.558 Vali Acc: 0.560 Test Loss: 3.558 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559964).  Saving model ...
Epoch: 16 cost time: 4.045367956161499
Epoch: 16, Steps: 18 | Train Loss: 0.175 Vali Loss: 4.995 Vali Acc: 0.490 Test Loss: 4.995 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.1246490478515625
Epoch: 17, Steps: 18 | Train Loss: 0.162 Vali Loss: 4.744 Vali Acc: 0.520 Test Loss: 4.744 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.0085365772247314
Epoch: 18, Steps: 18 | Train Loss: 0.239 Vali Loss: 5.502 Vali Acc: 0.500 Test Loss: 5.502 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.152976036071777
Epoch: 19, Steps: 18 | Train Loss: 0.210 Vali Loss: 5.130 Vali Acc: 0.520 Test Loss: 5.130 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7119460105895996
Epoch: 20, Steps: 18 | Train Loss: 0.083 Vali Loss: 5.742 Vali Acc: 0.510 Test Loss: 5.742 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8004283905029297
Epoch: 21, Steps: 18 | Train Loss: 0.184 Vali Loss: 5.159 Vali Acc: 0.560 Test Loss: 5.159 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.173466920852661
Epoch: 22, Steps: 18 | Train Loss: 0.091 Vali Loss: 4.941 Vali Acc: 0.600 Test Loss: 4.941 Test Acc: 0.600
Validation loss decreased (-0.559964 --> -0.599951).  Saving model ...
Epoch: 23 cost time: 4.133036136627197
Epoch: 23, Steps: 18 | Train Loss: 0.182 Vali Loss: 7.858 Vali Acc: 0.540 Test Loss: 7.858 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.044995069503784
Epoch: 24, Steps: 18 | Train Loss: 0.310 Vali Loss: 5.661 Vali Acc: 0.570 Test Loss: 5.661 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.9986343383789062
Epoch: 25, Steps: 18 | Train Loss: 0.693 Vali Loss: 6.350 Vali Acc: 0.540 Test Loss: 6.350 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.194763660430908
Epoch: 26, Steps: 18 | Train Loss: 0.689 Vali Loss: 7.082 Vali Acc: 0.570 Test Loss: 7.082 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.5749690532684326
Epoch: 27, Steps: 18 | Train Loss: 0.284 Vali Loss: 6.012 Vali Acc: 0.560 Test Loss: 6.012 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.603464126586914
Epoch: 28, Steps: 18 | Train Loss: 0.135 Vali Loss: 6.146 Vali Acc: 0.570 Test Loss: 6.146 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.9096908569335938
Epoch: 29, Steps: 18 | Train Loss: 0.126 Vali Loss: 6.927 Vali Acc: 0.540 Test Loss: 6.927 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.9821784496307373
Epoch: 30, Steps: 18 | Train Loss: 0.159 Vali Loss: 10.060 Vali Acc: 0.550 Test Loss: 10.060 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.0998077392578125
Epoch: 31, Steps: 18 | Train Loss: 0.197 Vali Loss: 9.587 Vali Acc: 0.560 Test Loss: 9.587 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.7894773483276367
Epoch: 32, Steps: 18 | Train Loss: 0.145 Vali Loss: 8.707 Vali Acc: 0.550 Test Loss: 8.707 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 327490
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.267419338226318
Epoch: 1, Steps: 18 | Train Loss: 0.801 Vali Loss: 0.817 Vali Acc: 0.460 Test Loss: 0.817 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 3.543884515762329
Epoch: 2, Steps: 18 | Train Loss: 0.654 Vali Loss: 1.129 Vali Acc: 0.450 Test Loss: 1.129 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4241323471069336
Epoch: 3, Steps: 18 | Train Loss: 0.633 Vali Loss: 2.239 Vali Acc: 0.520 Test Loss: 2.239 Test Acc: 0.520
Validation loss decreased (-0.459992 --> -0.519978).  Saving model ...
Epoch: 4 cost time: 3.317354679107666
Epoch: 4, Steps: 18 | Train Loss: 0.693 Vali Loss: 1.258 Vali Acc: 0.530 Test Loss: 1.258 Test Acc: 0.530
Validation loss decreased (-0.519978 --> -0.529987).  Saving model ...
Epoch: 5 cost time: 3.409533739089966
Epoch: 5, Steps: 18 | Train Loss: 0.501 Vali Loss: 1.536 Vali Acc: 0.570 Test Loss: 1.536 Test Acc: 0.570
Validation loss decreased (-0.529987 --> -0.569985).  Saving model ...
Epoch: 6 cost time: 3.2159841060638428
Epoch: 6, Steps: 18 | Train Loss: 0.455 Vali Loss: 1.504 Vali Acc: 0.580 Test Loss: 1.504 Test Acc: 0.580
Validation loss decreased (-0.569985 --> -0.579985).  Saving model ...
Epoch: 7 cost time: 3.7603988647460938
Epoch: 7, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.637 Vali Acc: 0.540 Test Loss: 1.637 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.650552988052368
Epoch: 8, Steps: 18 | Train Loss: 0.416 Vali Loss: 2.294 Vali Acc: 0.540 Test Loss: 2.294 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4539694786071777
Epoch: 9, Steps: 18 | Train Loss: 0.280 Vali Loss: 2.172 Vali Acc: 0.530 Test Loss: 2.172 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5519492626190186
Epoch: 10, Steps: 18 | Train Loss: 0.410 Vali Loss: 3.019 Vali Acc: 0.470 Test Loss: 3.019 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6174232959747314
Epoch: 11, Steps: 18 | Train Loss: 0.316 Vali Loss: 3.054 Vali Acc: 0.530 Test Loss: 3.054 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.7854795455932617
Epoch: 12, Steps: 18 | Train Loss: 0.228 Vali Loss: 3.724 Vali Acc: 0.520 Test Loss: 3.724 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.5765912532806396
Epoch: 13, Steps: 18 | Train Loss: 0.597 Vali Loss: 4.851 Vali Acc: 0.530 Test Loss: 4.851 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.766796350479126
Epoch: 14, Steps: 18 | Train Loss: 0.333 Vali Loss: 3.830 Vali Acc: 0.520 Test Loss: 3.830 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.673095703125
Epoch: 15, Steps: 18 | Train Loss: 0.192 Vali Loss: 4.028 Vali Acc: 0.550 Test Loss: 4.028 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.6814327239990234
Epoch: 16, Steps: 18 | Train Loss: 0.212 Vali Loss: 5.351 Vali Acc: 0.550 Test Loss: 5.351 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 283138
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.399916410446167
Epoch: 1, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.867 Vali Acc: 0.530 Test Loss: 0.867 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 2.6513619422912598
Epoch: 2, Steps: 18 | Train Loss: 0.703 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6547698974609375
Epoch: 3, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.904 Vali Acc: 0.500 Test Loss: 0.904 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8070030212402344
Epoch: 4, Steps: 18 | Train Loss: 0.569 Vali Loss: 1.128 Vali Acc: 0.610 Test Loss: 1.128 Test Acc: 0.610
Validation loss decreased (-0.529991 --> -0.609989).  Saving model ...
Epoch: 5 cost time: 2.8900139331817627
Epoch: 5, Steps: 18 | Train Loss: 0.525 Vali Loss: 1.466 Vali Acc: 0.490 Test Loss: 1.466 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.898421049118042
Epoch: 6, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.212 Vali Acc: 0.520 Test Loss: 1.212 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.967695474624634
Epoch: 7, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.265 Vali Acc: 0.490 Test Loss: 1.265 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.746586561203003
Epoch: 8, Steps: 18 | Train Loss: 0.471 Vali Loss: 2.169 Vali Acc: 0.480 Test Loss: 2.169 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.79996657371521
Epoch: 9, Steps: 18 | Train Loss: 0.244 Vali Loss: 2.132 Vali Acc: 0.480 Test Loss: 2.132 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7648050785064697
Epoch: 10, Steps: 18 | Train Loss: 0.273 Vali Loss: 2.296 Vali Acc: 0.460 Test Loss: 2.296 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.877732992172241
Epoch: 11, Steps: 18 | Train Loss: 0.169 Vali Loss: 2.534 Vali Acc: 0.530 Test Loss: 2.534 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8007988929748535
Epoch: 12, Steps: 18 | Train Loss: 0.329 Vali Loss: 2.534 Vali Acc: 0.550 Test Loss: 2.534 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.048758029937744
Epoch: 13, Steps: 18 | Train Loss: 0.331 Vali Loss: 2.976 Vali Acc: 0.480 Test Loss: 2.976 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.027941942214966
Epoch: 14, Steps: 18 | Train Loss: 0.170 Vali Loss: 3.022 Vali Acc: 0.550 Test Loss: 3.022 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 235394
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.596704006195068
Epoch: 1, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.793 Vali Acc: 0.450 Test Loss: 0.793 Test Acc: 0.450
Validation loss decreased (inf --> -0.449992).  Saving model ...
Epoch: 2 cost time: 2.610779047012329
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.797 Vali Acc: 0.630 Test Loss: 0.797 Test Acc: 0.630
Validation loss decreased (-0.449992 --> -0.629992).  Saving model ...
Epoch: 3 cost time: 2.5265791416168213
Epoch: 3, Steps: 18 | Train Loss: 0.650 Vali Loss: 0.870 Vali Acc: 0.530 Test Loss: 0.870 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6365976333618164
Epoch: 4, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.984 Vali Acc: 0.540 Test Loss: 0.984 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6938059329986572
Epoch: 5, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.015 Vali Acc: 0.580 Test Loss: 1.015 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.801201105117798
Epoch: 6, Steps: 18 | Train Loss: 0.414 Vali Loss: 1.168 Vali Acc: 0.490 Test Loss: 1.168 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6050851345062256
Epoch: 7, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.289 Vali Acc: 0.540 Test Loss: 1.289 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6815075874328613
Epoch: 8, Steps: 18 | Train Loss: 0.344 Vali Loss: 1.242 Vali Acc: 0.470 Test Loss: 1.242 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7817461490631104
Epoch: 9, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.745 Vali Acc: 0.510 Test Loss: 1.745 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5603740215301514
Epoch: 10, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.802 Vali Acc: 0.500 Test Loss: 1.802 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.721872329711914
Epoch: 11, Steps: 18 | Train Loss: 0.176 Vali Loss: 2.058 Vali Acc: 0.490 Test Loss: 2.058 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6792497634887695
Epoch: 12, Steps: 18 | Train Loss: 0.182 Vali Loss: 2.254 Vali Acc: 0.460 Test Loss: 2.254 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 220418
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.1783177852630615
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.762 Vali Acc: 0.500 Test Loss: 0.762 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.4369232654571533
Epoch: 2, Steps: 18 | Train Loss: 0.766 Vali Loss: 0.756 Vali Acc: 0.580 Test Loss: 0.756 Test Acc: 0.580
Validation loss decreased (-0.499992 --> -0.579992).  Saving model ...
Epoch: 3 cost time: 2.633192300796509
Epoch: 3, Steps: 18 | Train Loss: 0.626 Vali Loss: 0.939 Vali Acc: 0.610 Test Loss: 0.939 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609991).  Saving model ...
Epoch: 4 cost time: 2.3211960792541504
Epoch: 4, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.954 Vali Acc: 0.470 Test Loss: 0.954 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4936060905456543
Epoch: 5, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.918 Vali Acc: 0.520 Test Loss: 0.918 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4809131622314453
Epoch: 6, Steps: 18 | Train Loss: 0.414 Vali Loss: 1.083 Vali Acc: 0.460 Test Loss: 1.083 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4292893409729004
Epoch: 7, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.138 Vali Acc: 0.480 Test Loss: 1.138 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.452049732208252
Epoch: 8, Steps: 18 | Train Loss: 0.354 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5952932834625244
Epoch: 9, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3408548831939697
Epoch: 10, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.399 Vali Acc: 0.530 Test Loss: 1.399 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.439730405807495
Epoch: 11, Steps: 18 | Train Loss: 0.234 Vali Loss: 1.418 Vali Acc: 0.560 Test Loss: 1.418 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.394702911376953
Epoch: 12, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.776 Vali Acc: 0.530 Test Loss: 1.776 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4624040126800537
Epoch: 13, Steps: 18 | Train Loss: 0.144 Vali Loss: 2.100 Vali Acc: 0.490 Test Loss: 2.100 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 213634
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.929364681243896
Epoch: 1, Steps: 18 | Train Loss: 1.260 Vali Loss: 2.365 Vali Acc: 0.510 Test Loss: 2.365 Test Acc: 0.510
Validation loss decreased (inf --> -0.509976).  Saving model ...
Epoch: 2 cost time: 9.243996381759644
Epoch: 2, Steps: 18 | Train Loss: 1.969 Vali Loss: 1.368 Vali Acc: 0.590 Test Loss: 1.368 Test Acc: 0.590
Validation loss decreased (-0.509976 --> -0.589986).  Saving model ...
Epoch: 3 cost time: 9.188088417053223
Epoch: 3, Steps: 18 | Train Loss: 1.141 Vali Loss: 2.677 Vali Acc: 0.410 Test Loss: 2.677 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.44741177558899
Epoch: 4, Steps: 18 | Train Loss: 1.170 Vali Loss: 2.914 Vali Acc: 0.520 Test Loss: 2.914 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.009143829345703
Epoch: 5, Steps: 18 | Train Loss: 1.338 Vali Loss: 2.175 Vali Acc: 0.520 Test Loss: 2.175 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.061556577682495
Epoch: 6, Steps: 18 | Train Loss: 1.106 Vali Loss: 3.970 Vali Acc: 0.530 Test Loss: 3.970 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.040241241455078
Epoch: 7, Steps: 18 | Train Loss: 0.906 Vali Loss: 4.737 Vali Acc: 0.500 Test Loss: 4.737 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.056351900100708
Epoch: 8, Steps: 18 | Train Loss: 1.358 Vali Loss: 10.064 Vali Acc: 0.530 Test Loss: 10.064 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.18186330795288
Epoch: 9, Steps: 18 | Train Loss: 2.069 Vali Loss: 6.039 Vali Acc: 0.560 Test Loss: 6.039 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.148329734802246
Epoch: 10, Steps: 18 | Train Loss: 1.002 Vali Loss: 8.036 Vali Acc: 0.520 Test Loss: 8.036 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.124853372573853
Epoch: 11, Steps: 18 | Train Loss: 0.812 Vali Loss: 7.061 Vali Acc: 0.530 Test Loss: 7.061 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.364915370941162
Epoch: 12, Steps: 18 | Train Loss: 1.230 Vali Loss: 10.115 Vali Acc: 0.530 Test Loss: 10.115 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 710850
model size : 3.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.605468511581421
Epoch: 1, Steps: 18 | Train Loss: 0.876 Vali Loss: 1.070 Vali Acc: 0.510 Test Loss: 1.070 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 4.863823175430298
Epoch: 2, Steps: 18 | Train Loss: 0.955 Vali Loss: 1.294 Vali Acc: 0.610 Test Loss: 1.294 Test Acc: 0.610
Validation loss decreased (-0.509989 --> -0.609987).  Saving model ...
Epoch: 3 cost time: 4.934412240982056
Epoch: 3, Steps: 18 | Train Loss: 0.739 Vali Loss: 2.339 Vali Acc: 0.520 Test Loss: 2.339 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.8758790493011475
Epoch: 4, Steps: 18 | Train Loss: 1.342 Vali Loss: 2.926 Vali Acc: 0.500 Test Loss: 2.926 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.80145788192749
Epoch: 5, Steps: 18 | Train Loss: 1.046 Vali Loss: 2.026 Vali Acc: 0.530 Test Loss: 2.026 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.514068603515625
Epoch: 6, Steps: 18 | Train Loss: 0.832 Vali Loss: 1.570 Vali Acc: 0.610 Test Loss: 1.570 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.540771961212158
Epoch: 7, Steps: 18 | Train Loss: 0.946 Vali Loss: 2.171 Vali Acc: 0.570 Test Loss: 2.171 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.784819602966309
Epoch: 8, Steps: 18 | Train Loss: 0.596 Vali Loss: 3.973 Vali Acc: 0.510 Test Loss: 3.973 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.624338865280151
Epoch: 9, Steps: 18 | Train Loss: 0.690 Vali Loss: 3.430 Vali Acc: 0.530 Test Loss: 3.430 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.452184677124023
Epoch: 10, Steps: 18 | Train Loss: 0.280 Vali Loss: 3.604 Vali Acc: 0.510 Test Loss: 3.604 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.519099950790405
Epoch: 11, Steps: 18 | Train Loss: 0.358 Vali Loss: 4.386 Vali Acc: 0.540 Test Loss: 4.386 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.718924283981323
Epoch: 12, Steps: 18 | Train Loss: 0.232 Vali Loss: 4.171 Vali Acc: 0.590 Test Loss: 4.171 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 404354
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.26971960067749
Epoch: 1, Steps: 18 | Train Loss: 0.902 Vali Loss: 0.982 Vali Acc: 0.460 Test Loss: 0.982 Test Acc: 0.460
Validation loss decreased (inf --> -0.459990).  Saving model ...
Epoch: 2 cost time: 3.6387414932250977
Epoch: 2, Steps: 18 | Train Loss: 0.765 Vali Loss: 1.239 Vali Acc: 0.590 Test Loss: 1.239 Test Acc: 0.590
Validation loss decreased (-0.459990 --> -0.589988).  Saving model ...
Epoch: 3 cost time: 3.560123920440674
Epoch: 3, Steps: 18 | Train Loss: 0.664 Vali Loss: 1.006 Vali Acc: 0.570 Test Loss: 1.006 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6032373905181885
Epoch: 4, Steps: 18 | Train Loss: 0.502 Vali Loss: 1.705 Vali Acc: 0.540 Test Loss: 1.705 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6358885765075684
Epoch: 5, Steps: 18 | Train Loss: 0.606 Vali Loss: 1.190 Vali Acc: 0.590 Test Loss: 1.190 Test Acc: 0.590
Validation loss decreased (-0.589988 --> -0.589988).  Saving model ...
Epoch: 6 cost time: 3.6344759464263916
Epoch: 6, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.732 Vali Acc: 0.530 Test Loss: 1.732 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.483271598815918
Epoch: 7, Steps: 18 | Train Loss: 0.406 Vali Loss: 2.347 Vali Acc: 0.530 Test Loss: 2.347 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4527640342712402
Epoch: 8, Steps: 18 | Train Loss: 0.492 Vali Loss: 3.225 Vali Acc: 0.460 Test Loss: 3.225 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.622065782546997
Epoch: 9, Steps: 18 | Train Loss: 0.371 Vali Loss: 2.318 Vali Acc: 0.480 Test Loss: 2.318 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.9184978008270264
Epoch: 10, Steps: 18 | Train Loss: 0.488 Vali Loss: 2.704 Vali Acc: 0.530 Test Loss: 2.704 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7901382446289062
Epoch: 11, Steps: 18 | Train Loss: 0.465 Vali Loss: 3.245 Vali Acc: 0.460 Test Loss: 3.245 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.9384992122650146
Epoch: 12, Steps: 18 | Train Loss: 0.276 Vali Loss: 3.300 Vali Acc: 0.530 Test Loss: 3.300 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.720926523208618
Epoch: 13, Steps: 18 | Train Loss: 0.268 Vali Loss: 4.573 Vali Acc: 0.520 Test Loss: 4.573 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.821500778198242
Epoch: 14, Steps: 18 | Train Loss: 0.281 Vali Loss: 3.809 Vali Acc: 0.560 Test Loss: 3.809 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.88917875289917
Epoch: 15, Steps: 18 | Train Loss: 0.214 Vali Loss: 4.141 Vali Acc: 0.520 Test Loss: 4.141 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 294466
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.384299039840698
Epoch: 1, Steps: 18 | Train Loss: 0.847 Vali Loss: 0.741 Vali Acc: 0.520 Test Loss: 0.741 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.6539011001586914
Epoch: 2, Steps: 18 | Train Loss: 0.761 Vali Loss: 0.910 Vali Acc: 0.580 Test Loss: 0.910 Test Acc: 0.580
Validation loss decreased (-0.519993 --> -0.579991).  Saving model ...
Epoch: 3 cost time: 3.0815744400024414
Epoch: 3, Steps: 18 | Train Loss: 0.606 Vali Loss: 1.054 Vali Acc: 0.530 Test Loss: 1.054 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1368443965911865
Epoch: 4, Steps: 18 | Train Loss: 0.637 Vali Loss: 1.653 Vali Acc: 0.530 Test Loss: 1.653 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1026320457458496
Epoch: 5, Steps: 18 | Train Loss: 0.435 Vali Loss: 1.653 Vali Acc: 0.450 Test Loss: 1.653 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.232333183288574
Epoch: 6, Steps: 18 | Train Loss: 0.440 Vali Loss: 2.452 Vali Acc: 0.560 Test Loss: 2.452 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.273871660232544
Epoch: 7, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.999 Vali Acc: 0.530 Test Loss: 1.999 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2671384811401367
Epoch: 8, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.959 Vali Acc: 0.520 Test Loss: 1.959 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.4438045024871826
Epoch: 9, Steps: 18 | Train Loss: 0.303 Vali Loss: 2.688 Vali Acc: 0.550 Test Loss: 2.688 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.346304178237915
Epoch: 10, Steps: 18 | Train Loss: 1.021 Vali Loss: 3.357 Vali Acc: 0.500 Test Loss: 3.357 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.2594895362854004
Epoch: 11, Steps: 18 | Train Loss: 0.544 Vali Loss: 3.074 Vali Acc: 0.530 Test Loss: 3.074 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.159919023513794
Epoch: 12, Steps: 18 | Train Loss: 0.271 Vali Loss: 3.554 Vali Acc: 0.490 Test Loss: 3.554 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 250114
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.296368360519409
Epoch: 1, Steps: 18 | Train Loss: 0.827 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.4924890995025635
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.707 Vali Acc: 0.560 Test Loss: 0.707 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 2.4187748432159424
Epoch: 3, Steps: 18 | Train Loss: 0.837 Vali Loss: 1.302 Vali Acc: 0.540 Test Loss: 1.302 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9840772151947021
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.853 Vali Acc: 0.610 Test Loss: 0.853 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609991).  Saving model ...
Epoch: 5 cost time: 2.3596391677856445
Epoch: 5, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.508 Vali Acc: 0.460 Test Loss: 1.508 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.246090888977051
Epoch: 6, Steps: 18 | Train Loss: 0.509 Vali Loss: 1.550 Vali Acc: 0.520 Test Loss: 1.550 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.452253818511963
Epoch: 7, Steps: 18 | Train Loss: 0.411 Vali Loss: 1.579 Vali Acc: 0.500 Test Loss: 1.579 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.851541042327881
Epoch: 8, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.992 Vali Acc: 0.490 Test Loss: 1.992 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5611908435821533
Epoch: 9, Steps: 18 | Train Loss: 0.302 Vali Loss: 1.908 Vali Acc: 0.500 Test Loss: 1.908 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6075563430786133
Epoch: 10, Steps: 18 | Train Loss: 0.309 Vali Loss: 2.426 Vali Acc: 0.480 Test Loss: 2.426 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.593184471130371
Epoch: 11, Steps: 18 | Train Loss: 0.339 Vali Loss: 2.068 Vali Acc: 0.520 Test Loss: 2.068 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7367560863494873
Epoch: 12, Steps: 18 | Train Loss: 0.193 Vali Loss: 2.785 Vali Acc: 0.480 Test Loss: 2.785 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.4769957065582275
Epoch: 13, Steps: 18 | Train Loss: 0.169 Vali Loss: 2.674 Vali Acc: 0.520 Test Loss: 2.674 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.866483211517334
Epoch: 14, Steps: 18 | Train Loss: 0.153 Vali Loss: 2.442 Vali Acc: 0.490 Test Loss: 2.442 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 202370
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.219383239746094
Epoch: 1, Steps: 18 | Train Loss: 0.848 Vali Loss: 0.750 Vali Acc: 0.550 Test Loss: 0.750 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.4014289379119873
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.773 Vali Acc: 0.620 Test Loss: 0.773 Test Acc: 0.620
Validation loss decreased (-0.549993 --> -0.619992).  Saving model ...
Epoch: 3 cost time: 2.3550209999084473
Epoch: 3, Steps: 18 | Train Loss: 0.705 Vali Loss: 0.776 Vali Acc: 0.560 Test Loss: 0.776 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4501054286956787
Epoch: 4, Steps: 18 | Train Loss: 0.556 Vali Loss: 0.918 Vali Acc: 0.570 Test Loss: 0.918 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5502023696899414
Epoch: 5, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.930 Vali Acc: 0.540 Test Loss: 0.930 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4910764694213867
Epoch: 6, Steps: 18 | Train Loss: 0.365 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.314333915710449
Epoch: 7, Steps: 18 | Train Loss: 0.345 Vali Loss: 1.135 Vali Acc: 0.540 Test Loss: 1.135 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.409531831741333
Epoch: 8, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.150 Vali Acc: 0.530 Test Loss: 1.150 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2879884243011475
Epoch: 9, Steps: 18 | Train Loss: 0.350 Vali Loss: 2.014 Vali Acc: 0.530 Test Loss: 2.014 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3044464588165283
Epoch: 10, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.554 Vali Acc: 0.480 Test Loss: 1.554 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4679014682769775
Epoch: 11, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.556 Vali Acc: 0.520 Test Loss: 1.556 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4211528301239014
Epoch: 12, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.610 Vali Acc: 0.510 Test Loss: 1.610 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 187394
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.071328401565552
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.878 Vali Acc: 0.440 Test Loss: 0.878 Test Acc: 0.440
Validation loss decreased (inf --> -0.439991).  Saving model ...
Epoch: 2 cost time: 2.190150737762451
Epoch: 2, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.791 Vali Acc: 0.560 Test Loss: 0.791 Test Acc: 0.560
Validation loss decreased (-0.439991 --> -0.559992).  Saving model ...
Epoch: 3 cost time: 2.1491143703460693
Epoch: 3, Steps: 18 | Train Loss: 0.674 Vali Loss: 0.921 Vali Acc: 0.500 Test Loss: 0.921 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.347703218460083
Epoch: 4, Steps: 18 | Train Loss: 0.586 Vali Loss: 1.290 Vali Acc: 0.470 Test Loss: 1.290 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4004411697387695
Epoch: 5, Steps: 18 | Train Loss: 0.613 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.631819725036621
Epoch: 6, Steps: 18 | Train Loss: 0.442 Vali Loss: 1.028 Vali Acc: 0.560 Test Loss: 1.028 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4207112789154053
Epoch: 7, Steps: 18 | Train Loss: 0.359 Vali Loss: 1.223 Vali Acc: 0.490 Test Loss: 1.223 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5060789585113525
Epoch: 8, Steps: 18 | Train Loss: 0.316 Vali Loss: 1.103 Vali Acc: 0.530 Test Loss: 1.103 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.461104154586792
Epoch: 9, Steps: 18 | Train Loss: 0.236 Vali Loss: 1.310 Vali Acc: 0.570 Test Loss: 1.310 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569987).  Saving model ...
Epoch: 10 cost time: 2.282733917236328
Epoch: 10, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.452 Vali Acc: 0.490 Test Loss: 1.452 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2149813175201416
Epoch: 11, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.587 Vali Acc: 0.490 Test Loss: 1.587 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3362035751342773
Epoch: 12, Steps: 18 | Train Loss: 0.160 Vali Loss: 2.045 Vali Acc: 0.520 Test Loss: 2.045 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.388427734375
Epoch: 13, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.667 Vali Acc: 0.530 Test Loss: 1.667 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4262442588806152
Epoch: 14, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.848 Vali Acc: 0.510 Test Loss: 1.848 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2920312881469727
Epoch: 15, Steps: 18 | Train Loss: 0.194 Vali Loss: 2.269 Vali Acc: 0.550 Test Loss: 2.269 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3886749744415283
Epoch: 16, Steps: 18 | Train Loss: 0.144 Vali Loss: 2.016 Vali Acc: 0.540 Test Loss: 2.016 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4045584201812744
Epoch: 17, Steps: 18 | Train Loss: 0.143 Vali Loss: 2.203 Vali Acc: 0.540 Test Loss: 2.203 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3820128440856934
Epoch: 18, Steps: 18 | Train Loss: 0.127 Vali Loss: 2.452 Vali Acc: 0.480 Test Loss: 2.452 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3882601261138916
Epoch: 19, Steps: 18 | Train Loss: 0.067 Vali Loss: 2.875 Vali Acc: 0.500 Test Loss: 2.875 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 180610
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.042680263519287
Epoch: 1, Steps: 18 | Train Loss: 1.195 Vali Loss: 0.845 Vali Acc: 0.630 Test Loss: 0.845 Test Acc: 0.630
Validation loss decreased (inf --> -0.629992).  Saving model ...
Epoch: 2 cost time: 8.718093872070312
Epoch: 2, Steps: 18 | Train Loss: 1.733 Vali Loss: 1.512 Vali Acc: 0.500 Test Loss: 1.512 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.297583818435669
Epoch: 3, Steps: 18 | Train Loss: 1.111 Vali Loss: 1.702 Vali Acc: 0.580 Test Loss: 1.702 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.603610754013062
Epoch: 4, Steps: 18 | Train Loss: 1.174 Vali Loss: 2.319 Vali Acc: 0.550 Test Loss: 2.319 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.16170048713684
Epoch: 5, Steps: 18 | Train Loss: 1.069 Vali Loss: 2.637 Vali Acc: 0.560 Test Loss: 2.637 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.13303256034851
Epoch: 6, Steps: 18 | Train Loss: 1.627 Vali Loss: 5.797 Vali Acc: 0.510 Test Loss: 5.797 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.054462909698486
Epoch: 7, Steps: 18 | Train Loss: 0.991 Vali Loss: 9.679 Vali Acc: 0.530 Test Loss: 9.679 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.139561414718628
Epoch: 8, Steps: 18 | Train Loss: 1.260 Vali Loss: 5.777 Vali Acc: 0.530 Test Loss: 5.777 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 8.722267389297485
Epoch: 9, Steps: 18 | Train Loss: 1.329 Vali Loss: 6.251 Vali Acc: 0.540 Test Loss: 6.251 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 9.001950740814209
Epoch: 10, Steps: 18 | Train Loss: 0.769 Vali Loss: 5.981 Vali Acc: 0.530 Test Loss: 5.981 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 9.072800874710083
Epoch: 11, Steps: 18 | Train Loss: 0.469 Vali Loss: 7.030 Vali Acc: 0.560 Test Loss: 7.030 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 694338
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.428138732910156
Epoch: 1, Steps: 18 | Train Loss: 0.897 Vali Loss: 0.947 Vali Acc: 0.540 Test Loss: 0.947 Test Acc: 0.540
Validation loss decreased (inf --> -0.539991).  Saving model ...
Epoch: 2 cost time: 4.729531764984131
Epoch: 2, Steps: 18 | Train Loss: 1.080 Vali Loss: 3.544 Vali Acc: 0.510 Test Loss: 3.544 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.5090460777282715
Epoch: 3, Steps: 18 | Train Loss: 0.887 Vali Loss: 1.352 Vali Acc: 0.530 Test Loss: 1.352 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9339029788970947
Epoch: 4, Steps: 18 | Train Loss: 0.663 Vali Loss: 1.528 Vali Acc: 0.560 Test Loss: 1.528 Test Acc: 0.560
Validation loss decreased (-0.539991 --> -0.559985).  Saving model ...
Epoch: 5 cost time: 3.613191843032837
Epoch: 5, Steps: 18 | Train Loss: 0.453 Vali Loss: 2.002 Vali Acc: 0.550 Test Loss: 2.002 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.732119560241699
Epoch: 6, Steps: 18 | Train Loss: 0.568 Vali Loss: 2.557 Vali Acc: 0.580 Test Loss: 2.557 Test Acc: 0.580
Validation loss decreased (-0.559985 --> -0.579974).  Saving model ...
Epoch: 7 cost time: 4.60032320022583
Epoch: 7, Steps: 18 | Train Loss: 0.497 Vali Loss: 3.196 Vali Acc: 0.540 Test Loss: 3.196 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.179967403411865
Epoch: 8, Steps: 18 | Train Loss: 0.416 Vali Loss: 2.747 Vali Acc: 0.530 Test Loss: 2.747 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.113830327987671
Epoch: 9, Steps: 18 | Train Loss: 0.604 Vali Loss: 4.339 Vali Acc: 0.480 Test Loss: 4.339 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.30692720413208
Epoch: 10, Steps: 18 | Train Loss: 0.305 Vali Loss: 5.241 Vali Acc: 0.550 Test Loss: 5.241 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.253399133682251
Epoch: 11, Steps: 18 | Train Loss: 0.613 Vali Loss: 3.982 Vali Acc: 0.630 Test Loss: 3.982 Test Acc: 0.630
Validation loss decreased (-0.579974 --> -0.629960).  Saving model ...
Epoch: 12 cost time: 4.223989009857178
Epoch: 12, Steps: 18 | Train Loss: 0.364 Vali Loss: 5.354 Vali Acc: 0.450 Test Loss: 5.354 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.0610644817352295
Epoch: 13, Steps: 18 | Train Loss: 0.840 Vali Loss: 7.103 Vali Acc: 0.460 Test Loss: 7.103 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.328866720199585
Epoch: 14, Steps: 18 | Train Loss: 0.853 Vali Loss: 3.828 Vali Acc: 0.510 Test Loss: 3.828 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.169177770614624
Epoch: 15, Steps: 18 | Train Loss: 0.600 Vali Loss: 5.442 Vali Acc: 0.550 Test Loss: 5.442 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.562511205673218
Epoch: 16, Steps: 18 | Train Loss: 0.217 Vali Loss: 6.118 Vali Acc: 0.510 Test Loss: 6.118 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.495600700378418
Epoch: 17, Steps: 18 | Train Loss: 0.261 Vali Loss: 7.081 Vali Acc: 0.480 Test Loss: 7.081 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.482213258743286
Epoch: 18, Steps: 18 | Train Loss: 0.279 Vali Loss: 6.564 Vali Acc: 0.550 Test Loss: 6.564 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.377122163772583
Epoch: 19, Steps: 18 | Train Loss: 0.386 Vali Loss: 7.723 Vali Acc: 0.480 Test Loss: 7.723 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.402260780334473
Epoch: 20, Steps: 18 | Train Loss: 0.124 Vali Loss: 9.337 Vali Acc: 0.490 Test Loss: 9.337 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.53987193107605
Epoch: 21, Steps: 18 | Train Loss: 0.632 Vali Loss: 8.906 Vali Acc: 0.500 Test Loss: 8.906 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 387842
model size : 2.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.603093147277832
Epoch: 1, Steps: 18 | Train Loss: 0.890 Vali Loss: 0.738 Vali Acc: 0.550 Test Loss: 0.738 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.952981948852539
Epoch: 2, Steps: 18 | Train Loss: 0.759 Vali Loss: 1.371 Vali Acc: 0.550 Test Loss: 1.371 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.096189498901367
Epoch: 3, Steps: 18 | Train Loss: 0.647 Vali Loss: 1.384 Vali Acc: 0.540 Test Loss: 1.384 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.002337217330933
Epoch: 4, Steps: 18 | Train Loss: 0.632 Vali Loss: 1.343 Vali Acc: 0.480 Test Loss: 1.343 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.065777540206909
Epoch: 5, Steps: 18 | Train Loss: 0.871 Vali Loss: 3.079 Vali Acc: 0.550 Test Loss: 3.079 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6394424438476562
Epoch: 6, Steps: 18 | Train Loss: 0.665 Vali Loss: 1.791 Vali Acc: 0.580 Test Loss: 1.791 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579982).  Saving model ...
Epoch: 7 cost time: 3.943988561630249
Epoch: 7, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.726 Vali Acc: 0.520 Test Loss: 1.726 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8095898628234863
Epoch: 8, Steps: 18 | Train Loss: 0.383 Vali Loss: 2.740 Vali Acc: 0.480 Test Loss: 2.740 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.811232805252075
Epoch: 9, Steps: 18 | Train Loss: 0.475 Vali Loss: 2.227 Vali Acc: 0.510 Test Loss: 2.227 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.711709499359131
Epoch: 10, Steps: 18 | Train Loss: 0.285 Vali Loss: 2.854 Vali Acc: 0.500 Test Loss: 2.854 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4746134281158447
Epoch: 11, Steps: 18 | Train Loss: 0.327 Vali Loss: 2.263 Vali Acc: 0.560 Test Loss: 2.263 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.523411750793457
Epoch: 12, Steps: 18 | Train Loss: 0.295 Vali Loss: 4.461 Vali Acc: 0.470 Test Loss: 4.461 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.71101713180542
Epoch: 13, Steps: 18 | Train Loss: 0.374 Vali Loss: 3.056 Vali Acc: 0.530 Test Loss: 3.056 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.851060390472412
Epoch: 14, Steps: 18 | Train Loss: 0.285 Vali Loss: 5.476 Vali Acc: 0.520 Test Loss: 5.476 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.8729190826416016
Epoch: 15, Steps: 18 | Train Loss: 0.759 Vali Loss: 5.577 Vali Acc: 0.490 Test Loss: 5.577 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8442111015319824
Epoch: 16, Steps: 18 | Train Loss: 0.151 Vali Loss: 3.756 Vali Acc: 0.550 Test Loss: 3.756 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 277954
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.196500301361084
Epoch: 1, Steps: 18 | Train Loss: 0.821 Vali Loss: 0.985 Vali Acc: 0.490 Test Loss: 0.985 Test Acc: 0.490
Validation loss decreased (inf --> -0.489990).  Saving model ...
Epoch: 2 cost time: 3.4048571586608887
Epoch: 2, Steps: 18 | Train Loss: 0.922 Vali Loss: 1.063 Vali Acc: 0.490 Test Loss: 1.063 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9836835861206055
Epoch: 3, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.880 Vali Acc: 0.660 Test Loss: 0.880 Test Acc: 0.660
Validation loss decreased (-0.489990 --> -0.659991).  Saving model ...
Epoch: 4 cost time: 3.5814383029937744
Epoch: 4, Steps: 18 | Train Loss: 0.633 Vali Loss: 1.769 Vali Acc: 0.550 Test Loss: 1.769 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.691413640975952
Epoch: 5, Steps: 18 | Train Loss: 0.484 Vali Loss: 1.219 Vali Acc: 0.520 Test Loss: 1.219 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.681901216506958
Epoch: 6, Steps: 18 | Train Loss: 0.395 Vali Loss: 1.694 Vali Acc: 0.460 Test Loss: 1.694 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7091352939605713
Epoch: 7, Steps: 18 | Train Loss: 0.349 Vali Loss: 2.082 Vali Acc: 0.480 Test Loss: 2.082 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.849510908126831
Epoch: 8, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.880 Vali Acc: 0.530 Test Loss: 1.880 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.6635966300964355
Epoch: 9, Steps: 18 | Train Loss: 0.659 Vali Loss: 2.685 Vali Acc: 0.530 Test Loss: 2.685 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.8774147033691406
Epoch: 10, Steps: 18 | Train Loss: 0.585 Vali Loss: 2.365 Vali Acc: 0.530 Test Loss: 2.365 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.8907227516174316
Epoch: 11, Steps: 18 | Train Loss: 0.241 Vali Loss: 2.204 Vali Acc: 0.560 Test Loss: 2.204 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.9834237098693848
Epoch: 12, Steps: 18 | Train Loss: 0.256 Vali Loss: 2.414 Vali Acc: 0.590 Test Loss: 2.414 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.7429986000061035
Epoch: 13, Steps: 18 | Train Loss: 0.283 Vali Loss: 2.768 Vali Acc: 0.560 Test Loss: 2.768 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 233602
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.297852993011475
Epoch: 1, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 2.9671361446380615
Epoch: 2, Steps: 18 | Train Loss: 0.766 Vali Loss: 1.027 Vali Acc: 0.530 Test Loss: 1.027 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0997350215911865
Epoch: 3, Steps: 18 | Train Loss: 0.885 Vali Loss: 0.885 Vali Acc: 0.590 Test Loss: 0.885 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589991).  Saving model ...
Epoch: 4 cost time: 3.062114953994751
Epoch: 4, Steps: 18 | Train Loss: 0.822 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.589991 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 3.170522451400757
Epoch: 5, Steps: 18 | Train Loss: 0.670 Vali Loss: 1.511 Vali Acc: 0.550 Test Loss: 1.511 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9671497344970703
Epoch: 6, Steps: 18 | Train Loss: 0.485 Vali Loss: 1.123 Vali Acc: 0.560 Test Loss: 1.123 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.955183506011963
Epoch: 7, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.306 Vali Acc: 0.510 Test Loss: 1.306 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.208436965942383
Epoch: 8, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.605 Vali Acc: 0.570 Test Loss: 1.605 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.069152593612671
Epoch: 9, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.651 Vali Acc: 0.520 Test Loss: 1.651 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.121490478515625
Epoch: 10, Steps: 18 | Train Loss: 0.253 Vali Loss: 2.641 Vali Acc: 0.530 Test Loss: 2.641 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0970685482025146
Epoch: 11, Steps: 18 | Train Loss: 0.248 Vali Loss: 2.892 Vali Acc: 0.470 Test Loss: 2.892 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9037160873413086
Epoch: 12, Steps: 18 | Train Loss: 0.252 Vali Loss: 2.689 Vali Acc: 0.490 Test Loss: 2.689 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9177746772766113
Epoch: 13, Steps: 18 | Train Loss: 0.315 Vali Loss: 3.119 Vali Acc: 0.430 Test Loss: 3.119 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.2511301040649414
Epoch: 14, Steps: 18 | Train Loss: 0.136 Vali Loss: 2.727 Vali Acc: 0.480 Test Loss: 2.727 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 185858
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.965004205703735
Epoch: 1, Steps: 18 | Train Loss: 0.813 Vali Loss: 0.759 Vali Acc: 0.460 Test Loss: 0.759 Test Acc: 0.460
Validation loss decreased (inf --> -0.459992).  Saving model ...
Epoch: 2 cost time: 2.8267245292663574
Epoch: 2, Steps: 18 | Train Loss: 0.725 Vali Loss: 0.787 Vali Acc: 0.490 Test Loss: 0.787 Test Acc: 0.490
Validation loss decreased (-0.459992 --> -0.489992).  Saving model ...
Epoch: 3 cost time: 3.0379819869995117
Epoch: 3, Steps: 18 | Train Loss: 0.625 Vali Loss: 1.109 Vali Acc: 0.560 Test Loss: 1.109 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559989).  Saving model ...
Epoch: 4 cost time: 2.897165536880493
Epoch: 4, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.906 Vali Acc: 0.590 Test Loss: 0.906 Test Acc: 0.590
Validation loss decreased (-0.559989 --> -0.589991).  Saving model ...
Epoch: 5 cost time: 2.950073719024658
Epoch: 5, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.970 Vali Acc: 0.540 Test Loss: 0.970 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9851841926574707
Epoch: 6, Steps: 18 | Train Loss: 0.477 Vali Loss: 1.412 Vali Acc: 0.510 Test Loss: 1.412 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1839842796325684
Epoch: 7, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.288 Vali Acc: 0.530 Test Loss: 1.288 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9903392791748047
Epoch: 8, Steps: 18 | Train Loss: 0.465 Vali Loss: 1.793 Vali Acc: 0.570 Test Loss: 1.793 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9656801223754883
Epoch: 9, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.372 Vali Acc: 0.580 Test Loss: 1.372 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.093890428543091
Epoch: 10, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.811 Vali Acc: 0.510 Test Loss: 1.811 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.0792713165283203
Epoch: 11, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.031 Vali Acc: 0.560 Test Loss: 2.031 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.0369672775268555
Epoch: 12, Steps: 18 | Train Loss: 0.302 Vali Loss: 2.237 Vali Acc: 0.560 Test Loss: 2.237 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.092193365097046
Epoch: 13, Steps: 18 | Train Loss: 0.209 Vali Loss: 2.524 Vali Acc: 0.490 Test Loss: 2.524 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.034848213195801
Epoch: 14, Steps: 18 | Train Loss: 0.092 Vali Loss: 2.223 Vali Acc: 0.500 Test Loss: 2.223 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 170882
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.618512868881226
Epoch: 1, Steps: 18 | Train Loss: 0.806 Vali Loss: 0.733 Vali Acc: 0.550 Test Loss: 0.733 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 2.8296985626220703
Epoch: 2, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.786 Vali Acc: 0.520 Test Loss: 0.786 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.971503734588623
Epoch: 3, Steps: 18 | Train Loss: 0.649 Vali Loss: 0.790 Vali Acc: 0.550 Test Loss: 0.790 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0534653663635254
Epoch: 4, Steps: 18 | Train Loss: 0.544 Vali Loss: 0.843 Vali Acc: 0.560 Test Loss: 0.843 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 2.9013288021087646
Epoch: 5, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.305 Vali Acc: 0.470 Test Loss: 1.305 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.199666738510132
Epoch: 6, Steps: 18 | Train Loss: 0.479 Vali Loss: 0.860 Vali Acc: 0.610 Test Loss: 0.860 Test Acc: 0.610
Validation loss decreased (-0.559992 --> -0.609991).  Saving model ...
Epoch: 7 cost time: 2.509768009185791
Epoch: 7, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.502 Vali Acc: 0.570 Test Loss: 1.502 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.386850357055664
Epoch: 8, Steps: 18 | Train Loss: 0.359 Vali Loss: 1.467 Vali Acc: 0.580 Test Loss: 1.467 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4273629188537598
Epoch: 9, Steps: 18 | Train Loss: 0.483 Vali Loss: 1.334 Vali Acc: 0.480 Test Loss: 1.334 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6076953411102295
Epoch: 10, Steps: 18 | Train Loss: 0.288 Vali Loss: 1.642 Vali Acc: 0.480 Test Loss: 1.642 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7463133335113525
Epoch: 11, Steps: 18 | Train Loss: 0.282 Vali Loss: 1.572 Vali Acc: 0.550 Test Loss: 1.572 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.58064341545105
Epoch: 12, Steps: 18 | Train Loss: 0.266 Vali Loss: 1.764 Vali Acc: 0.520 Test Loss: 1.764 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6111297607421875
Epoch: 13, Steps: 18 | Train Loss: 0.247 Vali Loss: 1.603 Vali Acc: 0.570 Test Loss: 1.603 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.634136199951172
Epoch: 14, Steps: 18 | Train Loss: 0.153 Vali Loss: 2.378 Vali Acc: 0.460 Test Loss: 2.378 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.877488851547241
Epoch: 15, Steps: 18 | Train Loss: 0.235 Vali Loss: 2.043 Vali Acc: 0.540 Test Loss: 2.043 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.780514717102051
Epoch: 16, Steps: 18 | Train Loss: 0.165 Vali Loss: 2.132 Vali Acc: 0.530 Test Loss: 2.132 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm64_nh16_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 164098
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.849344968795776
Epoch: 1, Steps: 18 | Train Loss: 0.876 Vali Loss: 1.143 Vali Acc: 0.620 Test Loss: 1.143 Test Acc: 0.620
Validation loss decreased (inf --> -0.619989).  Saving model ...
Epoch: 2 cost time: 4.5635597705841064
Epoch: 2, Steps: 18 | Train Loss: 0.840 Vali Loss: 1.122 Vali Acc: 0.630 Test Loss: 1.122 Test Acc: 0.630
Validation loss decreased (-0.619989 --> -0.629989).  Saving model ...
Epoch: 3 cost time: 4.626777172088623
Epoch: 3, Steps: 18 | Train Loss: 1.021 Vali Loss: 1.032 Vali Acc: 0.540 Test Loss: 1.032 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.741856575012207
Epoch: 4, Steps: 18 | Train Loss: 0.828 Vali Loss: 1.894 Vali Acc: 0.640 Test Loss: 1.894 Test Acc: 0.640
Validation loss decreased (-0.629989 --> -0.639981).  Saving model ...
Epoch: 5 cost time: 4.667136192321777
Epoch: 5, Steps: 18 | Train Loss: 0.635 Vali Loss: 2.250 Vali Acc: 0.590 Test Loss: 2.250 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.232564449310303
Epoch: 6, Steps: 18 | Train Loss: 0.710 Vali Loss: 2.186 Vali Acc: 0.590 Test Loss: 2.186 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.615311861038208
Epoch: 7, Steps: 18 | Train Loss: 0.873 Vali Loss: 5.201 Vali Acc: 0.500 Test Loss: 5.201 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.67848539352417
Epoch: 8, Steps: 18 | Train Loss: 1.696 Vali Loss: 5.681 Vali Acc: 0.520 Test Loss: 5.681 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.529635667800903
Epoch: 9, Steps: 18 | Train Loss: 2.252 Vali Loss: 6.037 Vali Acc: 0.480 Test Loss: 6.037 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.5566246509552
Epoch: 10, Steps: 18 | Train Loss: 1.560 Vali Loss: 3.907 Vali Acc: 0.560 Test Loss: 3.907 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.536797046661377
Epoch: 11, Steps: 18 | Train Loss: 0.838 Vali Loss: 5.165 Vali Acc: 0.520 Test Loss: 5.165 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.2056920528411865
Epoch: 12, Steps: 18 | Train Loss: 0.646 Vali Loss: 4.779 Vali Acc: 0.530 Test Loss: 4.779 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.976053237915039
Epoch: 13, Steps: 18 | Train Loss: 0.637 Vali Loss: 5.863 Vali Acc: 0.500 Test Loss: 5.863 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.741732120513916
Epoch: 14, Steps: 18 | Train Loss: 0.400 Vali Loss: 5.242 Vali Acc: 0.540 Test Loss: 5.242 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 364002
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.0040905475616455
Epoch: 1, Steps: 18 | Train Loss: 0.841 Vali Loss: 0.805 Vali Acc: 0.540 Test Loss: 0.805 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 3.5461511611938477
Epoch: 2, Steps: 18 | Train Loss: 0.743 Vali Loss: 1.117 Vali Acc: 0.450 Test Loss: 1.117 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2542405128479004
Epoch: 3, Steps: 18 | Train Loss: 0.737 Vali Loss: 1.252 Vali Acc: 0.480 Test Loss: 1.252 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6059134006500244
Epoch: 4, Steps: 18 | Train Loss: 0.517 Vali Loss: 1.017 Vali Acc: 0.530 Test Loss: 1.017 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.426703691482544
Epoch: 5, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.152 Vali Acc: 0.530 Test Loss: 1.152 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4083683490753174
Epoch: 6, Steps: 18 | Train Loss: 0.512 Vali Loss: 1.788 Vali Acc: 0.530 Test Loss: 1.788 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.344372034072876
Epoch: 7, Steps: 18 | Train Loss: 0.564 Vali Loss: 1.521 Vali Acc: 0.500 Test Loss: 1.521 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.721208095550537
Epoch: 8, Steps: 18 | Train Loss: 0.364 Vali Loss: 2.380 Vali Acc: 0.480 Test Loss: 2.380 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.6145544052124023
Epoch: 9, Steps: 18 | Train Loss: 0.296 Vali Loss: 2.395 Vali Acc: 0.500 Test Loss: 2.395 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.588620662689209
Epoch: 10, Steps: 18 | Train Loss: 0.188 Vali Loss: 3.028 Vali Acc: 0.420 Test Loss: 3.028 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.373488426208496
Epoch: 11, Steps: 18 | Train Loss: 0.165 Vali Loss: 2.665 Vali Acc: 0.590 Test Loss: 2.665 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589973).  Saving model ...
Epoch: 12 cost time: 3.2858548164367676
Epoch: 12, Steps: 18 | Train Loss: 0.208 Vali Loss: 3.172 Vali Acc: 0.500 Test Loss: 3.172 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.624089479446411
Epoch: 13, Steps: 18 | Train Loss: 0.069 Vali Loss: 3.272 Vali Acc: 0.510 Test Loss: 3.272 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.738469123840332
Epoch: 14, Steps: 18 | Train Loss: 0.157 Vali Loss: 5.176 Vali Acc: 0.500 Test Loss: 5.176 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.6277008056640625
Epoch: 15, Steps: 18 | Train Loss: 0.187 Vali Loss: 4.159 Vali Acc: 0.540 Test Loss: 4.159 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.498950242996216
Epoch: 16, Steps: 18 | Train Loss: 0.072 Vali Loss: 3.596 Vali Acc: 0.530 Test Loss: 3.596 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.8167316913604736
Epoch: 17, Steps: 18 | Train Loss: 0.062 Vali Loss: 3.292 Vali Acc: 0.550 Test Loss: 3.292 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.346278190612793
Epoch: 18, Steps: 18 | Train Loss: 0.066 Vali Loss: 4.345 Vali Acc: 0.530 Test Loss: 4.345 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.6479485034942627
Epoch: 19, Steps: 18 | Train Loss: 0.058 Vali Loss: 4.985 Vali Acc: 0.490 Test Loss: 4.985 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3836169242858887
Epoch: 20, Steps: 18 | Train Loss: 0.106 Vali Loss: 4.304 Vali Acc: 0.490 Test Loss: 4.304 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.476060152053833
Epoch: 21, Steps: 18 | Train Loss: 0.082 Vali Loss: 4.823 Vali Acc: 0.470 Test Loss: 4.823 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 210754
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 4.953739643096924
Epoch: 1, Steps: 18 | Train Loss: 0.898 Vali Loss: 0.861 Vali Acc: 0.500 Test Loss: 0.861 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 3.072030782699585
Epoch: 2, Steps: 18 | Train Loss: 0.684 Vali Loss: 1.048 Vali Acc: 0.560 Test Loss: 1.048 Test Acc: 0.560
Validation loss decreased (-0.499991 --> -0.559990).  Saving model ...
Epoch: 3 cost time: 2.581606864929199
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.818 Vali Acc: 0.590 Test Loss: 0.818 Test Acc: 0.590
Validation loss decreased (-0.559990 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 2.870952844619751
Epoch: 4, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.868 Vali Acc: 0.530 Test Loss: 0.868 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7549731731414795
Epoch: 5, Steps: 18 | Train Loss: 0.531 Vali Loss: 0.968 Vali Acc: 0.560 Test Loss: 0.968 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.622068405151367
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.971 Vali Acc: 0.560 Test Loss: 0.971 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8140125274658203
Epoch: 7, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.306 Vali Acc: 0.590 Test Loss: 1.306 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8539178371429443
Epoch: 8, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.436 Vali Acc: 0.550 Test Loss: 1.436 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8171615600585938
Epoch: 9, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.600 Vali Acc: 0.490 Test Loss: 1.600 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8701984882354736
Epoch: 10, Steps: 18 | Train Loss: 0.266 Vali Loss: 1.941 Vali Acc: 0.480 Test Loss: 1.941 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.534384250640869
Epoch: 11, Steps: 18 | Train Loss: 0.246 Vali Loss: 2.068 Vali Acc: 0.560 Test Loss: 2.068 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.7561392784118652
Epoch: 12, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.845 Vali Acc: 0.530 Test Loss: 1.845 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6411292552948
Epoch: 13, Steps: 18 | Train Loss: 0.077 Vali Loss: 2.437 Vali Acc: 0.540 Test Loss: 2.437 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 155810
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.57030725479126
Epoch: 1, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.721 Vali Acc: 0.520 Test Loss: 0.721 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.701866626739502
Epoch: 2, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.807 Vali Acc: 0.510 Test Loss: 0.807 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0501723289489746
Epoch: 3, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.192018985748291
Epoch: 4, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.920 Vali Acc: 0.530 Test Loss: 0.920 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529991).  Saving model ...
Epoch: 5 cost time: 2.9712417125701904
Epoch: 5, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.918 Vali Acc: 0.550 Test Loss: 0.918 Test Acc: 0.550
Validation loss decreased (-0.529991 --> -0.549991).  Saving model ...
Epoch: 6 cost time: 2.929051160812378
Epoch: 6, Steps: 18 | Train Loss: 0.380 Vali Loss: 1.152 Vali Acc: 0.530 Test Loss: 1.152 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9418084621429443
Epoch: 7, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.222 Vali Acc: 0.510 Test Loss: 1.222 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1368117332458496
Epoch: 8, Steps: 18 | Train Loss: 0.322 Vali Loss: 1.320 Vali Acc: 0.570 Test Loss: 1.320 Test Acc: 0.570
Validation loss decreased (-0.549991 --> -0.569987).  Saving model ...
Epoch: 9 cost time: 3.057647705078125
Epoch: 9, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.347 Vali Acc: 0.520 Test Loss: 1.347 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7434659004211426
Epoch: 10, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.476 Vali Acc: 0.540 Test Loss: 1.476 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.076293706893921
Epoch: 11, Steps: 18 | Train Loss: 0.173 Vali Loss: 1.716 Vali Acc: 0.570 Test Loss: 1.716 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.770780324935913
Epoch: 12, Steps: 18 | Train Loss: 0.140 Vali Loss: 2.474 Vali Acc: 0.510 Test Loss: 2.474 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.3429150581359863
Epoch: 13, Steps: 18 | Train Loss: 0.201 Vali Loss: 2.470 Vali Acc: 0.490 Test Loss: 2.470 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9626805782318115
Epoch: 14, Steps: 18 | Train Loss: 0.107 Vali Loss: 2.733 Vali Acc: 0.520 Test Loss: 2.733 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.0032577514648438
Epoch: 15, Steps: 18 | Train Loss: 0.081 Vali Loss: 2.495 Vali Acc: 0.490 Test Loss: 2.495 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9253599643707275
Epoch: 16, Steps: 18 | Train Loss: 0.099 Vali Loss: 2.498 Vali Acc: 0.550 Test Loss: 2.498 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.1396868228912354
Epoch: 17, Steps: 18 | Train Loss: 0.048 Vali Loss: 2.270 Vali Acc: 0.520 Test Loss: 2.270 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6830830574035645
Epoch: 18, Steps: 18 | Train Loss: 0.077 Vali Loss: 3.524 Vali Acc: 0.540 Test Loss: 3.524 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 133634
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.460382699966431
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.841 Vali Acc: 0.520 Test Loss: 0.841 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.5627286434173584
Epoch: 2, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.719 Vali Acc: 0.520 Test Loss: 0.719 Test Acc: 0.520
Validation loss decreased (-0.519992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 2.842625379562378
Epoch: 3, Steps: 18 | Train Loss: 0.670 Vali Loss: 0.735 Vali Acc: 0.590 Test Loss: 0.735 Test Acc: 0.590
Validation loss decreased (-0.519993 --> -0.589993).  Saving model ...
Epoch: 4 cost time: 2.7077324390411377
Epoch: 4, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.783 Vali Acc: 0.670 Test Loss: 0.783 Test Acc: 0.670
Validation loss decreased (-0.589993 --> -0.669992).  Saving model ...
Epoch: 5 cost time: 2.8387105464935303
Epoch: 5, Steps: 18 | Train Loss: 0.484 Vali Loss: 1.030 Vali Acc: 0.610 Test Loss: 1.030 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7815208435058594
Epoch: 6, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.916 Vali Acc: 0.560 Test Loss: 0.916 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6513969898223877
Epoch: 7, Steps: 18 | Train Loss: 0.360 Vali Loss: 0.948 Vali Acc: 0.550 Test Loss: 0.948 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.625210762023926
Epoch: 8, Steps: 18 | Train Loss: 0.276 Vali Loss: 1.174 Vali Acc: 0.520 Test Loss: 1.174 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7702748775482178
Epoch: 9, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.155 Vali Acc: 0.560 Test Loss: 1.155 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0292673110961914
Epoch: 10, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.228 Vali Acc: 0.600 Test Loss: 1.228 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6985433101654053
Epoch: 11, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.598 Vali Acc: 0.550 Test Loss: 1.598 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7682747840881348
Epoch: 12, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.377 Vali Acc: 0.570 Test Loss: 1.377 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8002495765686035
Epoch: 13, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.462 Vali Acc: 0.610 Test Loss: 1.462 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.757558584213257
Epoch: 14, Steps: 18 | Train Loss: 0.117 Vali Loss: 1.764 Vali Acc: 0.500 Test Loss: 1.764 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 109762
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.031979322433472
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.705 Vali Acc: 0.540 Test Loss: 0.705 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.132514715194702
Epoch: 2, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.779 Vali Acc: 0.530 Test Loss: 0.779 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6059882640838623
Epoch: 3, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.727 Vali Acc: 0.560 Test Loss: 0.727 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559993).  Saving model ...
Epoch: 4 cost time: 2.6494359970092773
Epoch: 4, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.768 Vali Acc: 0.520 Test Loss: 0.768 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5626583099365234
Epoch: 5, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.842 Vali Acc: 0.610 Test Loss: 0.842 Test Acc: 0.610
Validation loss decreased (-0.559993 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 2.870379686355591
Epoch: 6, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.916 Vali Acc: 0.560 Test Loss: 0.916 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.33231782913208
Epoch: 7, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.873 Vali Acc: 0.510 Test Loss: 0.873 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4857823848724365
Epoch: 8, Steps: 18 | Train Loss: 0.375 Vali Loss: 0.955 Vali Acc: 0.630 Test Loss: 0.955 Test Acc: 0.630
Validation loss decreased (-0.609992 --> -0.629990).  Saving model ...
Epoch: 9 cost time: 2.5248160362243652
Epoch: 9, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.489534616470337
Epoch: 10, Steps: 18 | Train Loss: 0.320 Vali Loss: 1.254 Vali Acc: 0.550 Test Loss: 1.254 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5092339515686035
Epoch: 11, Steps: 18 | Train Loss: 0.234 Vali Loss: 1.122 Vali Acc: 0.560 Test Loss: 1.122 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2636592388153076
Epoch: 12, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.264 Vali Acc: 0.530 Test Loss: 1.264 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1538589000701904
Epoch: 13, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.325 Vali Acc: 0.540 Test Loss: 1.325 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.577195405960083
Epoch: 14, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.585 Vali Acc: 0.490 Test Loss: 1.585 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5777978897094727
Epoch: 15, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.479 Vali Acc: 0.530 Test Loss: 1.479 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.433589220046997
Epoch: 16, Steps: 18 | Train Loss: 0.084 Vali Loss: 1.612 Vali Acc: 0.550 Test Loss: 1.612 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5366625785827637
Epoch: 17, Steps: 18 | Train Loss: 0.076 Vali Loss: 1.597 Vali Acc: 0.550 Test Loss: 1.597 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7027649879455566
Epoch: 18, Steps: 18 | Train Loss: 0.088 Vali Loss: 1.567 Vali Acc: 0.540 Test Loss: 1.567 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 102274
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.423010349273682
Epoch: 1, Steps: 18 | Train Loss: 0.811 Vali Loss: 0.781 Vali Acc: 0.480 Test Loss: 0.781 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.841268301010132
Epoch: 2, Steps: 18 | Train Loss: 0.715 Vali Loss: 0.706 Vali Acc: 0.590 Test Loss: 0.706 Test Acc: 0.590
Validation loss decreased (-0.479992 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.764902353286743
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.779 Vali Acc: 0.570 Test Loss: 0.779 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8721513748168945
Epoch: 4, Steps: 18 | Train Loss: 0.568 Vali Loss: 0.717 Vali Acc: 0.570 Test Loss: 0.717 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.916339874267578
Epoch: 5, Steps: 18 | Train Loss: 0.486 Vali Loss: 0.777 Vali Acc: 0.560 Test Loss: 0.777 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.607516288757324
Epoch: 6, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.854 Vali Acc: 0.480 Test Loss: 0.854 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8154349327087402
Epoch: 7, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.899 Vali Acc: 0.520 Test Loss: 0.899 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9640002250671387
Epoch: 8, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.965 Vali Acc: 0.490 Test Loss: 0.965 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.804438829421997
Epoch: 9, Steps: 18 | Train Loss: 0.321 Vali Loss: 1.060 Vali Acc: 0.540 Test Loss: 1.060 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6952598094940186
Epoch: 10, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.956 Vali Acc: 0.550 Test Loss: 0.956 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.746460437774658
Epoch: 11, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.670452356338501
Epoch: 12, Steps: 18 | Train Loss: 0.212 Vali Loss: 1.019 Vali Acc: 0.570 Test Loss: 1.019 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 98882
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.591917991638184
Epoch: 1, Steps: 18 | Train Loss: 0.964 Vali Loss: 1.188 Vali Acc: 0.510 Test Loss: 1.188 Test Acc: 0.510
Validation loss decreased (inf --> -0.509988).  Saving model ...
Epoch: 2 cost time: 5.243202447891235
Epoch: 2, Steps: 18 | Train Loss: 1.224 Vali Loss: 2.577 Vali Acc: 0.500 Test Loss: 2.577 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.699553489685059
Epoch: 3, Steps: 18 | Train Loss: 1.014 Vali Loss: 1.437 Vali Acc: 0.570 Test Loss: 1.437 Test Acc: 0.570
Validation loss decreased (-0.509988 --> -0.569986).  Saving model ...
Epoch: 4 cost time: 5.839266777038574
Epoch: 4, Steps: 18 | Train Loss: 0.694 Vali Loss: 1.575 Vali Acc: 0.530 Test Loss: 1.575 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.806855201721191
Epoch: 5, Steps: 18 | Train Loss: 0.795 Vali Loss: 3.700 Vali Acc: 0.540 Test Loss: 3.700 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.187072277069092
Epoch: 6, Steps: 18 | Train Loss: 0.718 Vali Loss: 1.796 Vali Acc: 0.540 Test Loss: 1.796 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.898738384246826
Epoch: 7, Steps: 18 | Train Loss: 0.702 Vali Loss: 2.234 Vali Acc: 0.550 Test Loss: 2.234 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.240063667297363
Epoch: 8, Steps: 18 | Train Loss: 0.685 Vali Loss: 4.290 Vali Acc: 0.550 Test Loss: 4.290 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.940321207046509
Epoch: 9, Steps: 18 | Train Loss: 0.478 Vali Loss: 2.984 Vali Acc: 0.580 Test Loss: 2.984 Test Acc: 0.580
Validation loss decreased (-0.569986 --> -0.579970).  Saving model ...
Epoch: 10 cost time: 6.0401225090026855
Epoch: 10, Steps: 18 | Train Loss: 0.416 Vali Loss: 3.137 Vali Acc: 0.520 Test Loss: 3.137 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.167680263519287
Epoch: 11, Steps: 18 | Train Loss: 0.302 Vali Loss: 5.212 Vali Acc: 0.500 Test Loss: 5.212 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.626941919326782
Epoch: 12, Steps: 18 | Train Loss: 0.443 Vali Loss: 5.958 Vali Acc: 0.520 Test Loss: 5.958 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.755032300949097
Epoch: 13, Steps: 18 | Train Loss: 1.085 Vali Loss: 7.379 Vali Acc: 0.520 Test Loss: 7.379 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.445479154586792
Epoch: 14, Steps: 18 | Train Loss: 0.756 Vali Loss: 5.781 Vali Acc: 0.500 Test Loss: 5.781 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.4475321769714355
Epoch: 15, Steps: 18 | Train Loss: 0.224 Vali Loss: 6.898 Vali Acc: 0.480 Test Loss: 6.898 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.549012660980225
Epoch: 16, Steps: 18 | Train Loss: 0.128 Vali Loss: 7.762 Vali Acc: 0.500 Test Loss: 7.762 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.748974323272705
Epoch: 17, Steps: 18 | Train Loss: 0.441 Vali Loss: 7.324 Vali Acc: 0.440 Test Loss: 7.324 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.7085418701171875
Epoch: 18, Steps: 18 | Train Loss: 0.344 Vali Loss: 11.518 Vali Acc: 0.460 Test Loss: 11.518 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.125616073608398
Epoch: 19, Steps: 18 | Train Loss: 0.212 Vali Loss: 7.945 Vali Acc: 0.510 Test Loss: 7.945 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 347362
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.6273651123046875
Epoch: 1, Steps: 18 | Train Loss: 0.858 Vali Loss: 0.931 Vali Acc: 0.550 Test Loss: 0.931 Test Acc: 0.550
Validation loss decreased (inf --> -0.549991).  Saving model ...
Epoch: 2 cost time: 3.7732176780700684
Epoch: 2, Steps: 18 | Train Loss: 1.046 Vali Loss: 1.022 Vali Acc: 0.470 Test Loss: 1.022 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3229031562805176
Epoch: 3, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.808 Vali Acc: 0.540 Test Loss: 0.808 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.76466703414917
Epoch: 4, Steps: 18 | Train Loss: 0.811 Vali Loss: 1.637 Vali Acc: 0.510 Test Loss: 1.637 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6801271438598633
Epoch: 5, Steps: 18 | Train Loss: 0.528 Vali Loss: 1.406 Vali Acc: 0.560 Test Loss: 1.406 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559986).  Saving model ...
Epoch: 6 cost time: 3.6270594596862793
Epoch: 6, Steps: 18 | Train Loss: 0.741 Vali Loss: 1.633 Vali Acc: 0.530 Test Loss: 1.633 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5901994705200195
Epoch: 7, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.886 Vali Acc: 0.510 Test Loss: 1.886 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7310099601745605
Epoch: 8, Steps: 18 | Train Loss: 0.338 Vali Loss: 2.760 Vali Acc: 0.570 Test Loss: 2.760 Test Acc: 0.570
Validation loss decreased (-0.559986 --> -0.569972).  Saving model ...
Epoch: 9 cost time: 3.3788902759552
Epoch: 9, Steps: 18 | Train Loss: 0.526 Vali Loss: 1.760 Vali Acc: 0.520 Test Loss: 1.760 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2685294151306152
Epoch: 10, Steps: 18 | Train Loss: 0.308 Vali Loss: 2.335 Vali Acc: 0.490 Test Loss: 2.335 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5026919841766357
Epoch: 11, Steps: 18 | Train Loss: 0.109 Vali Loss: 2.442 Vali Acc: 0.500 Test Loss: 2.442 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.772418260574341
Epoch: 12, Steps: 18 | Train Loss: 0.172 Vali Loss: 2.410 Vali Acc: 0.540 Test Loss: 2.410 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.816438674926758
Epoch: 13, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.478 Vali Acc: 0.510 Test Loss: 2.478 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.7788655757904053
Epoch: 14, Steps: 18 | Train Loss: 0.096 Vali Loss: 3.265 Vali Acc: 0.510 Test Loss: 3.265 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.6844522953033447
Epoch: 15, Steps: 18 | Train Loss: 0.181 Vali Loss: 4.999 Vali Acc: 0.530 Test Loss: 4.999 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6995608806610107
Epoch: 16, Steps: 18 | Train Loss: 0.289 Vali Loss: 5.181 Vali Acc: 0.480 Test Loss: 5.181 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.742581605911255
Epoch: 17, Steps: 18 | Train Loss: 0.176 Vali Loss: 4.405 Vali Acc: 0.550 Test Loss: 4.405 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.4527766704559326
Epoch: 18, Steps: 18 | Train Loss: 0.174 Vali Loss: 4.328 Vali Acc: 0.460 Test Loss: 4.328 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 194114
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.01101016998291
Epoch: 1, Steps: 18 | Train Loss: 0.799 Vali Loss: 0.700 Vali Acc: 0.560 Test Loss: 0.700 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 3.0983660221099854
Epoch: 2, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.832 Vali Acc: 0.510 Test Loss: 0.832 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0254414081573486
Epoch: 3, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.888 Vali Acc: 0.660 Test Loss: 0.888 Test Acc: 0.660
Validation loss decreased (-0.559993 --> -0.659991).  Saving model ...
Epoch: 4 cost time: 3.0002543926239014
Epoch: 4, Steps: 18 | Train Loss: 0.525 Vali Loss: 0.769 Vali Acc: 0.650 Test Loss: 0.769 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0025501251220703
Epoch: 5, Steps: 18 | Train Loss: 0.548 Vali Loss: 1.353 Vali Acc: 0.560 Test Loss: 1.353 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9762918949127197
Epoch: 6, Steps: 18 | Train Loss: 0.508 Vali Loss: 1.775 Vali Acc: 0.480 Test Loss: 1.775 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8049821853637695
Epoch: 7, Steps: 18 | Train Loss: 0.588 Vali Loss: 1.422 Vali Acc: 0.470 Test Loss: 1.422 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.786447048187256
Epoch: 8, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.598 Vali Acc: 0.580 Test Loss: 1.598 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.766003370285034
Epoch: 9, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.332 Vali Acc: 0.540 Test Loss: 1.332 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8757317066192627
Epoch: 10, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.628 Vali Acc: 0.510 Test Loss: 1.628 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.950029134750366
Epoch: 11, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.739 Vali Acc: 0.490 Test Loss: 1.739 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8947594165802
Epoch: 12, Steps: 18 | Train Loss: 0.194 Vali Loss: 2.084 Vali Acc: 0.530 Test Loss: 2.084 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8255159854888916
Epoch: 13, Steps: 18 | Train Loss: 0.219 Vali Loss: 2.037 Vali Acc: 0.600 Test Loss: 2.037 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 139170
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.472691297531128
Epoch: 1, Steps: 18 | Train Loss: 0.808 Vali Loss: 0.716 Vali Acc: 0.560 Test Loss: 0.716 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.5683650970458984
Epoch: 2, Steps: 18 | Train Loss: 0.811 Vali Loss: 0.890 Vali Acc: 0.470 Test Loss: 0.890 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.664905071258545
Epoch: 3, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.874 Vali Acc: 0.580 Test Loss: 0.874 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579991).  Saving model ...
Epoch: 4 cost time: 2.9342124462127686
Epoch: 4, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.954 Vali Acc: 0.550 Test Loss: 0.954 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5403177738189697
Epoch: 5, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.060 Vali Acc: 0.490 Test Loss: 1.060 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7422266006469727
Epoch: 6, Steps: 18 | Train Loss: 0.378 Vali Loss: 1.050 Vali Acc: 0.480 Test Loss: 1.050 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4286301136016846
Epoch: 7, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.231 Vali Acc: 0.460 Test Loss: 1.231 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.523669481277466
Epoch: 8, Steps: 18 | Train Loss: 0.241 Vali Loss: 1.271 Vali Acc: 0.600 Test Loss: 1.271 Test Acc: 0.600
Validation loss decreased (-0.579991 --> -0.599987).  Saving model ...
Epoch: 9 cost time: 2.61582088470459
Epoch: 9, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.764 Vali Acc: 0.500 Test Loss: 1.764 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.609156847000122
Epoch: 10, Steps: 18 | Train Loss: 0.265 Vali Loss: 2.147 Vali Acc: 0.450 Test Loss: 2.147 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8742380142211914
Epoch: 11, Steps: 18 | Train Loss: 0.174 Vali Loss: 2.177 Vali Acc: 0.510 Test Loss: 2.177 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.727822780609131
Epoch: 12, Steps: 18 | Train Loss: 0.113 Vali Loss: 1.980 Vali Acc: 0.550 Test Loss: 1.980 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9834342002868652
Epoch: 13, Steps: 18 | Train Loss: 0.093 Vali Loss: 2.431 Vali Acc: 0.530 Test Loss: 2.431 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9573240280151367
Epoch: 14, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.166 Vali Acc: 0.550 Test Loss: 2.166 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1028940677642822
Epoch: 15, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.222 Vali Acc: 0.580 Test Loss: 2.222 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1618850231170654
Epoch: 16, Steps: 18 | Train Loss: 0.074 Vali Loss: 2.864 Vali Acc: 0.520 Test Loss: 2.864 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.845322847366333
Epoch: 17, Steps: 18 | Train Loss: 0.080 Vali Loss: 2.874 Vali Acc: 0.510 Test Loss: 2.874 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8545143604278564
Epoch: 18, Steps: 18 | Train Loss: 0.082 Vali Loss: 2.653 Vali Acc: 0.570 Test Loss: 2.653 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 116994
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.104930400848389
Epoch: 1, Steps: 18 | Train Loss: 0.820 Vali Loss: 0.737 Vali Acc: 0.430 Test Loss: 0.737 Test Acc: 0.430
Validation loss decreased (inf --> -0.429993).  Saving model ...
Epoch: 2 cost time: 2.4070467948913574
Epoch: 2, Steps: 18 | Train Loss: 0.754 Vali Loss: 0.706 Vali Acc: 0.570 Test Loss: 0.706 Test Acc: 0.570
Validation loss decreased (-0.429993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.544133424758911
Epoch: 3, Steps: 18 | Train Loss: 0.650 Vali Loss: 0.924 Vali Acc: 0.580 Test Loss: 0.924 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579991).  Saving model ...
Epoch: 4 cost time: 2.7661428451538086
Epoch: 4, Steps: 18 | Train Loss: 0.625 Vali Loss: 1.058 Vali Acc: 0.470 Test Loss: 1.058 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7650156021118164
Epoch: 5, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.813 Vali Acc: 0.610 Test Loss: 0.813 Test Acc: 0.610
Validation loss decreased (-0.579991 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 2.8423268795013428
Epoch: 6, Steps: 18 | Train Loss: 0.421 Vali Loss: 0.911 Vali Acc: 0.490 Test Loss: 0.911 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.623443365097046
Epoch: 7, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.871 Vali Acc: 0.570 Test Loss: 0.871 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6697328090667725
Epoch: 8, Steps: 18 | Train Loss: 0.430 Vali Loss: 1.157 Vali Acc: 0.520 Test Loss: 1.157 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.114157199859619
Epoch: 9, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.5146546363830566
Epoch: 10, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.203 Vali Acc: 0.510 Test Loss: 1.203 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9210124015808105
Epoch: 11, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.333 Vali Acc: 0.580 Test Loss: 1.333 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7595837116241455
Epoch: 12, Steps: 18 | Train Loss: 0.221 Vali Loss: 1.939 Vali Acc: 0.520 Test Loss: 1.939 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.805372476577759
Epoch: 13, Steps: 18 | Train Loss: 0.163 Vali Loss: 1.677 Vali Acc: 0.510 Test Loss: 1.677 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.728654146194458
Epoch: 14, Steps: 18 | Train Loss: 0.221 Vali Loss: 2.012 Vali Acc: 0.490 Test Loss: 2.012 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4810373783111572
Epoch: 15, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.827 Vali Acc: 0.550 Test Loss: 1.827 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 93122
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.450608730316162
Epoch: 1, Steps: 18 | Train Loss: 0.783 Vali Loss: 0.813 Vali Acc: 0.480 Test Loss: 0.813 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 2.909769296646118
Epoch: 2, Steps: 18 | Train Loss: 0.798 Vali Loss: 0.865 Vali Acc: 0.480 Test Loss: 0.865 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.913691520690918
Epoch: 3, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.817 Vali Acc: 0.500 Test Loss: 0.817 Test Acc: 0.500
Validation loss decreased (-0.479992 --> -0.499992).  Saving model ...
Epoch: 4 cost time: 3.1350653171539307
Epoch: 4, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.827 Vali Acc: 0.500 Test Loss: 0.827 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0926759243011475
Epoch: 5, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.868 Vali Acc: 0.580 Test Loss: 0.868 Test Acc: 0.580
Validation loss decreased (-0.499992 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 2.56086802482605
Epoch: 6, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6401541233062744
Epoch: 7, Steps: 18 | Train Loss: 0.432 Vali Loss: 0.903 Vali Acc: 0.540 Test Loss: 0.903 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0593326091766357
Epoch: 8, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.058 Vali Acc: 0.490 Test Loss: 1.058 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.978015899658203
Epoch: 9, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.988 Vali Acc: 0.520 Test Loss: 0.988 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9442055225372314
Epoch: 10, Steps: 18 | Train Loss: 0.278 Vali Loss: 1.104 Vali Acc: 0.550 Test Loss: 1.104 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.9344420433044434
Epoch: 11, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4595978260040283
Epoch: 12, Steps: 18 | Train Loss: 0.182 Vali Loss: 1.348 Vali Acc: 0.510 Test Loss: 1.348 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8508002758026123
Epoch: 13, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.412 Vali Acc: 0.530 Test Loss: 1.412 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.3755035400390625
Epoch: 14, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.332 Vali Acc: 0.480 Test Loss: 1.332 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.6839499473571777
Epoch: 15, Steps: 18 | Train Loss: 0.153 Vali Loss: 1.463 Vali Acc: 0.500 Test Loss: 1.463 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 85634
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.41317892074585
Epoch: 1, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.5035057067871094
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.746 Vali Acc: 0.500 Test Loss: 0.746 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6020443439483643
Epoch: 3, Steps: 18 | Train Loss: 0.629 Vali Loss: 0.718 Vali Acc: 0.520 Test Loss: 0.718 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6003706455230713
Epoch: 4, Steps: 18 | Train Loss: 0.548 Vali Loss: 0.826 Vali Acc: 0.560 Test Loss: 0.826 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 2.5978126525878906
Epoch: 5, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.750 Vali Acc: 0.540 Test Loss: 0.750 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7589714527130127
Epoch: 6, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.804 Vali Acc: 0.540 Test Loss: 0.804 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.889801263809204
Epoch: 7, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.889 Vali Acc: 0.550 Test Loss: 0.889 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8234260082244873
Epoch: 8, Steps: 18 | Train Loss: 0.343 Vali Loss: 0.986 Vali Acc: 0.510 Test Loss: 0.986 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1133086681365967
Epoch: 9, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.994 Vali Acc: 0.580 Test Loss: 0.994 Test Acc: 0.580
Validation loss decreased (-0.559992 --> -0.579990).  Saving model ...
Epoch: 10 cost time: 3.095900058746338
Epoch: 10, Steps: 18 | Train Loss: 0.287 Vali Loss: 1.124 Vali Acc: 0.520 Test Loss: 1.124 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8529276847839355
Epoch: 11, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.839916467666626
Epoch: 12, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.096 Vali Acc: 0.540 Test Loss: 1.096 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.831308603286743
Epoch: 13, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.428 Vali Acc: 0.520 Test Loss: 1.428 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.705537796020508
Epoch: 14, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.311 Vali Acc: 0.520 Test Loss: 1.311 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.8349075317382812
Epoch: 15, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.546 Vali Acc: 0.500 Test Loss: 1.546 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7764551639556885
Epoch: 16, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.603 Vali Acc: 0.500 Test Loss: 1.603 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.091087818145752
Epoch: 17, Steps: 18 | Train Loss: 0.098 Vali Loss: 1.529 Vali Acc: 0.540 Test Loss: 1.529 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.904487371444702
Epoch: 18, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.655 Vali Acc: 0.480 Test Loss: 1.655 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8155622482299805
Epoch: 19, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.695 Vali Acc: 0.490 Test Loss: 1.695 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 82242
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.936632633209229
Epoch: 1, Steps: 18 | Train Loss: 0.964 Vali Loss: 1.565 Vali Acc: 0.510 Test Loss: 1.565 Test Acc: 0.510
Validation loss decreased (inf --> -0.509984).  Saving model ...
Epoch: 2 cost time: 5.353656530380249
Epoch: 2, Steps: 18 | Train Loss: 1.011 Vali Loss: 1.330 Vali Acc: 0.570 Test Loss: 1.330 Test Acc: 0.570
Validation loss decreased (-0.509984 --> -0.569987).  Saving model ...
Epoch: 3 cost time: 5.431396722793579
Epoch: 3, Steps: 18 | Train Loss: 0.883 Vali Loss: 1.777 Vali Acc: 0.560 Test Loss: 1.777 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.54103684425354
Epoch: 4, Steps: 18 | Train Loss: 1.507 Vali Loss: 1.510 Vali Acc: 0.600 Test Loss: 1.510 Test Acc: 0.600
Validation loss decreased (-0.569987 --> -0.599985).  Saving model ...
Epoch: 5 cost time: 5.195607662200928
Epoch: 5, Steps: 18 | Train Loss: 0.602 Vali Loss: 2.000 Vali Acc: 0.460 Test Loss: 2.000 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.467204332351685
Epoch: 6, Steps: 18 | Train Loss: 0.712 Vali Loss: 3.498 Vali Acc: 0.560 Test Loss: 3.498 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.430687189102173
Epoch: 7, Steps: 18 | Train Loss: 0.653 Vali Loss: 3.187 Vali Acc: 0.540 Test Loss: 3.187 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.067741870880127
Epoch: 8, Steps: 18 | Train Loss: 0.979 Vali Loss: 3.411 Vali Acc: 0.420 Test Loss: 3.411 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.42932653427124
Epoch: 9, Steps: 18 | Train Loss: 0.389 Vali Loss: 3.277 Vali Acc: 0.510 Test Loss: 3.277 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.275068283081055
Epoch: 10, Steps: 18 | Train Loss: 0.756 Vali Loss: 4.163 Vali Acc: 0.550 Test Loss: 4.163 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.498011350631714
Epoch: 11, Steps: 18 | Train Loss: 0.925 Vali Loss: 3.733 Vali Acc: 0.590 Test Loss: 3.733 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.237980127334595
Epoch: 12, Steps: 18 | Train Loss: 0.566 Vali Loss: 4.974 Vali Acc: 0.550 Test Loss: 4.974 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.418972492218018
Epoch: 13, Steps: 18 | Train Loss: 0.226 Vali Loss: 4.743 Vali Acc: 0.500 Test Loss: 4.743 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.192815065383911
Epoch: 14, Steps: 18 | Train Loss: 0.370 Vali Loss: 4.732 Vali Acc: 0.530 Test Loss: 4.732 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 339042
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.977335691452026
Epoch: 1, Steps: 18 | Train Loss: 0.798 Vali Loss: 0.821 Vali Acc: 0.530 Test Loss: 0.821 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 4.3255064487457275
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.729 Vali Acc: 0.630 Test Loss: 0.729 Test Acc: 0.630
Validation loss decreased (-0.529992 --> -0.629993).  Saving model ...
Epoch: 3 cost time: 4.4466166496276855
Epoch: 3, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.855 Vali Acc: 0.550 Test Loss: 0.855 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.807933330535889
Epoch: 4, Steps: 18 | Train Loss: 0.557 Vali Loss: 1.576 Vali Acc: 0.510 Test Loss: 1.576 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.6939239501953125
Epoch: 5, Steps: 18 | Train Loss: 0.365 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.801664352416992
Epoch: 6, Steps: 18 | Train Loss: 0.450 Vali Loss: 1.597 Vali Acc: 0.540 Test Loss: 1.597 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.0334203243255615
Epoch: 7, Steps: 18 | Train Loss: 0.463 Vali Loss: 2.016 Vali Acc: 0.510 Test Loss: 2.016 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.503350734710693
Epoch: 8, Steps: 18 | Train Loss: 0.351 Vali Loss: 2.022 Vali Acc: 0.510 Test Loss: 2.022 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.361509561538696
Epoch: 9, Steps: 18 | Train Loss: 0.280 Vali Loss: 2.531 Vali Acc: 0.460 Test Loss: 2.531 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.663344860076904
Epoch: 10, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.846 Vali Acc: 0.550 Test Loss: 1.846 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.521221876144409
Epoch: 11, Steps: 18 | Train Loss: 0.423 Vali Loss: 2.533 Vali Acc: 0.610 Test Loss: 2.533 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.653330564498901
Epoch: 12, Steps: 18 | Train Loss: 0.182 Vali Loss: 3.072 Vali Acc: 0.540 Test Loss: 3.072 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 185794
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.15599799156189
Epoch: 1, Steps: 18 | Train Loss: 0.831 Vali Loss: 0.667 Vali Acc: 0.550 Test Loss: 0.667 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 4.798023462295532
Epoch: 2, Steps: 18 | Train Loss: 0.763 Vali Loss: 0.967 Vali Acc: 0.560 Test Loss: 0.967 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559990).  Saving model ...
Epoch: 3 cost time: 3.693410873413086
Epoch: 3, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.865 Vali Acc: 0.500 Test Loss: 0.865 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.180369853973389
Epoch: 4, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.971 Vali Acc: 0.550 Test Loss: 0.971 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.407491207122803
Epoch: 5, Steps: 18 | Train Loss: 0.464 Vali Loss: 1.415 Vali Acc: 0.560 Test Loss: 1.415 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.10890793800354
Epoch: 6, Steps: 18 | Train Loss: 0.607 Vali Loss: 1.121 Vali Acc: 0.530 Test Loss: 1.121 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.260642051696777
Epoch: 7, Steps: 18 | Train Loss: 0.376 Vali Loss: 1.380 Vali Acc: 0.530 Test Loss: 1.380 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.9523608684539795
Epoch: 8, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.478 Vali Acc: 0.520 Test Loss: 1.478 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.929760694503784
Epoch: 9, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.795 Vali Acc: 0.500 Test Loss: 1.795 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.049497842788696
Epoch: 10, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.479 Vali Acc: 0.550 Test Loss: 1.479 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.1017091274261475
Epoch: 11, Steps: 18 | Train Loss: 0.220 Vali Loss: 1.672 Vali Acc: 0.540 Test Loss: 1.672 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.7165603637695312
Epoch: 12, Steps: 18 | Train Loss: 0.244 Vali Loss: 2.037 Vali Acc: 0.530 Test Loss: 2.037 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 130850
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.4764626026153564
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.692 Vali Acc: 0.610 Test Loss: 0.692 Test Acc: 0.610
Validation loss decreased (inf --> -0.609993).  Saving model ...
Epoch: 2 cost time: 3.1115760803222656
Epoch: 2, Steps: 18 | Train Loss: 0.672 Vali Loss: 0.931 Vali Acc: 0.550 Test Loss: 0.931 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4649887084960938
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.745 Vali Acc: 0.570 Test Loss: 0.745 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9000651836395264
Epoch: 4, Steps: 18 | Train Loss: 0.556 Vali Loss: 1.209 Vali Acc: 0.470 Test Loss: 1.209 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5283236503601074
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.917 Vali Acc: 0.670 Test Loss: 0.917 Test Acc: 0.670
Validation loss decreased (-0.609993 --> -0.669991).  Saving model ...
Epoch: 6 cost time: 3.195624589920044
Epoch: 6, Steps: 18 | Train Loss: 0.372 Vali Loss: 1.314 Vali Acc: 0.550 Test Loss: 1.314 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5930869579315186
Epoch: 7, Steps: 18 | Train Loss: 0.597 Vali Loss: 1.187 Vali Acc: 0.550 Test Loss: 1.187 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.810661792755127
Epoch: 8, Steps: 18 | Train Loss: 0.432 Vali Loss: 1.390 Vali Acc: 0.550 Test Loss: 1.390 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.596200704574585
Epoch: 9, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.354 Vali Acc: 0.550 Test Loss: 1.354 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6399269104003906
Epoch: 10, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.740 Vali Acc: 0.550 Test Loss: 1.740 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3925869464874268
Epoch: 11, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.871 Vali Acc: 0.530 Test Loss: 1.871 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.2910072803497314
Epoch: 12, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.809 Vali Acc: 0.540 Test Loss: 1.809 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.57527232170105
Epoch: 13, Steps: 18 | Train Loss: 0.093 Vali Loss: 1.704 Vali Acc: 0.550 Test Loss: 1.704 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.5356087684631348
Epoch: 14, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.970 Vali Acc: 0.500 Test Loss: 1.970 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.5310370922088623
Epoch: 15, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.622 Vali Acc: 0.480 Test Loss: 2.622 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.67
model parameter : 108674
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.65756893157959
Epoch: 1, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.811 Vali Acc: 0.360 Test Loss: 0.811 Test Acc: 0.360
Validation loss decreased (inf --> -0.359992).  Saving model ...
Epoch: 2 cost time: 3.2912771701812744
Epoch: 2, Steps: 18 | Train Loss: 0.702 Vali Loss: 0.801 Vali Acc: 0.500 Test Loss: 0.801 Test Acc: 0.500
Validation loss decreased (-0.359992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 3.477402448654175
Epoch: 3, Steps: 18 | Train Loss: 0.683 Vali Loss: 0.736 Vali Acc: 0.570 Test Loss: 0.736 Test Acc: 0.570
Validation loss decreased (-0.499992 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.4548325538635254
Epoch: 4, Steps: 18 | Train Loss: 0.606 Vali Loss: 0.831 Vali Acc: 0.550 Test Loss: 0.831 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.296525239944458
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.865 Vali Acc: 0.490 Test Loss: 0.865 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4704854488372803
Epoch: 6, Steps: 18 | Train Loss: 0.498 Vali Loss: 1.015 Vali Acc: 0.530 Test Loss: 1.015 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.523418426513672
Epoch: 7, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.175 Vali Acc: 0.600 Test Loss: 1.175 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 3.935835599899292
Epoch: 8, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.096 Vali Acc: 0.520 Test Loss: 1.096 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7379775047302246
Epoch: 9, Steps: 18 | Train Loss: 0.313 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2729172706604004
Epoch: 10, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.262 Vali Acc: 0.490 Test Loss: 1.262 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.476477861404419
Epoch: 11, Steps: 18 | Train Loss: 0.279 Vali Loss: 1.335 Vali Acc: 0.530 Test Loss: 1.335 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5343031883239746
Epoch: 12, Steps: 18 | Train Loss: 0.181 Vali Loss: 1.538 Vali Acc: 0.510 Test Loss: 1.538 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4721200466156006
Epoch: 13, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.720 Vali Acc: 0.520 Test Loss: 1.720 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.96905255317688
Epoch: 14, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.566 Vali Acc: 0.520 Test Loss: 1.566 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7450270652770996
Epoch: 15, Steps: 18 | Train Loss: 0.164 Vali Loss: 2.005 Vali Acc: 0.540 Test Loss: 2.005 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.347667932510376
Epoch: 16, Steps: 18 | Train Loss: 0.134 Vali Loss: 2.125 Vali Acc: 0.520 Test Loss: 2.125 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.5105202198028564
Epoch: 17, Steps: 18 | Train Loss: 0.057 Vali Loss: 2.253 Vali Acc: 0.500 Test Loss: 2.253 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 84802
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.490456819534302
Epoch: 1, Steps: 18 | Train Loss: 0.816 Vali Loss: 0.766 Vali Acc: 0.480 Test Loss: 0.766 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.1447296142578125
Epoch: 2, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.743 Vali Acc: 0.580 Test Loss: 0.743 Test Acc: 0.580
Validation loss decreased (-0.479992 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 3.2433969974517822
Epoch: 3, Steps: 18 | Train Loss: 0.677 Vali Loss: 0.752 Vali Acc: 0.520 Test Loss: 0.752 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2175824642181396
Epoch: 4, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.748 Vali Acc: 0.620 Test Loss: 0.748 Test Acc: 0.620
Validation loss decreased (-0.579993 --> -0.619993).  Saving model ...
Epoch: 5 cost time: 3.049001932144165
Epoch: 5, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.944 Vali Acc: 0.580 Test Loss: 0.944 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.408431053161621
Epoch: 6, Steps: 18 | Train Loss: 0.473 Vali Loss: 0.791 Vali Acc: 0.550 Test Loss: 0.791 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.303879976272583
Epoch: 7, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.007 Vali Acc: 0.520 Test Loss: 1.007 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.249319314956665
Epoch: 8, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.930 Vali Acc: 0.560 Test Loss: 0.930 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2774415016174316
Epoch: 9, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3840394020080566
Epoch: 10, Steps: 18 | Train Loss: 0.242 Vali Loss: 1.296 Vali Acc: 0.540 Test Loss: 1.296 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.292315721511841
Epoch: 11, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.424 Vali Acc: 0.540 Test Loss: 1.424 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.304414987564087
Epoch: 12, Steps: 18 | Train Loss: 0.218 Vali Loss: 1.247 Vali Acc: 0.530 Test Loss: 1.247 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.495844841003418
Epoch: 13, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.334 Vali Acc: 0.540 Test Loss: 1.334 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.477900505065918
Epoch: 14, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.356 Vali Acc: 0.490 Test Loss: 1.356 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 77314
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.395997762680054
Epoch: 1, Steps: 18 | Train Loss: 0.747 Vali Loss: 0.854 Vali Acc: 0.450 Test Loss: 0.854 Test Acc: 0.450
Validation loss decreased (inf --> -0.449991).  Saving model ...
Epoch: 2 cost time: 2.891890287399292
Epoch: 2, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.810 Vali Acc: 0.520 Test Loss: 0.810 Test Acc: 0.520
Validation loss decreased (-0.449991 --> -0.519992).  Saving model ...
Epoch: 3 cost time: 2.9516048431396484
Epoch: 3, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.783 Vali Acc: 0.530 Test Loss: 0.783 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529992).  Saving model ...
Epoch: 4 cost time: 3.3335089683532715
Epoch: 4, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.744 Vali Acc: 0.570 Test Loss: 0.744 Test Acc: 0.570
Validation loss decreased (-0.529992 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 2.914951801300049
Epoch: 5, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.739 Vali Acc: 0.540 Test Loss: 0.739 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.104429244995117
Epoch: 6, Steps: 18 | Train Loss: 0.492 Vali Loss: 1.051 Vali Acc: 0.570 Test Loss: 1.051 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9188976287841797
Epoch: 7, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.820 Vali Acc: 0.590 Test Loss: 0.820 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589992).  Saving model ...
Epoch: 8 cost time: 3.018617630004883
Epoch: 8, Steps: 18 | Train Loss: 0.356 Vali Loss: 0.992 Vali Acc: 0.490 Test Loss: 0.992 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.335754871368408
Epoch: 9, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.855 Vali Acc: 0.570 Test Loss: 0.855 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1933887004852295
Epoch: 10, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.078 Vali Acc: 0.550 Test Loss: 1.078 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9257469177246094
Epoch: 11, Steps: 18 | Train Loss: 0.273 Vali Loss: 1.153 Vali Acc: 0.560 Test Loss: 1.153 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.132582664489746
Epoch: 12, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.401 Vali Acc: 0.520 Test Loss: 1.401 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.9896907806396484
Epoch: 13, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.181 Vali Acc: 0.550 Test Loss: 1.181 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3632330894470215
Epoch: 14, Steps: 18 | Train Loss: 0.171 Vali Loss: 1.331 Vali Acc: 0.530 Test Loss: 1.331 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.748344898223877
Epoch: 15, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.283 Vali Acc: 0.540 Test Loss: 1.283 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.738706588745117
Epoch: 16, Steps: 18 | Train Loss: 0.116 Vali Loss: 1.321 Vali Acc: 0.570 Test Loss: 1.321 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.388978958129883
Epoch: 17, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.551 Vali Acc: 0.510 Test Loss: 1.551 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm32_nh4_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 73922
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.7499964237213135
Epoch: 1, Steps: 18 | Train Loss: 0.962 Vali Loss: 0.729 Vali Acc: 0.620 Test Loss: 0.729 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 5.047447919845581
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 1.230 Vali Acc: 0.540 Test Loss: 1.230 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.624550104141235
Epoch: 3, Steps: 18 | Train Loss: 1.426 Vali Loss: 2.230 Vali Acc: 0.520 Test Loss: 2.230 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.884212493896484
Epoch: 4, Steps: 18 | Train Loss: 1.209 Vali Loss: 0.981 Vali Acc: 0.570 Test Loss: 0.981 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.393510103225708
Epoch: 5, Steps: 18 | Train Loss: 1.177 Vali Loss: 1.274 Vali Acc: 0.650 Test Loss: 1.274 Test Acc: 0.650
Validation loss decreased (-0.619993 --> -0.649987).  Saving model ...
Epoch: 6 cost time: 4.93932843208313
Epoch: 6, Steps: 18 | Train Loss: 0.853 Vali Loss: 2.481 Vali Acc: 0.520 Test Loss: 2.481 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.943039417266846
Epoch: 7, Steps: 18 | Train Loss: 0.537 Vali Loss: 1.408 Vali Acc: 0.470 Test Loss: 1.408 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.605733156204224
Epoch: 8, Steps: 18 | Train Loss: 0.354 Vali Loss: 1.654 Vali Acc: 0.530 Test Loss: 1.654 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.549058198928833
Epoch: 9, Steps: 18 | Train Loss: 0.325 Vali Loss: 2.412 Vali Acc: 0.560 Test Loss: 2.412 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.826042890548706
Epoch: 10, Steps: 18 | Train Loss: 0.334 Vali Loss: 2.199 Vali Acc: 0.540 Test Loss: 2.199 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.680847644805908
Epoch: 11, Steps: 18 | Train Loss: 0.184 Vali Loss: 3.032 Vali Acc: 0.480 Test Loss: 3.032 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.615440368652344
Epoch: 12, Steps: 18 | Train Loss: 0.323 Vali Loss: 2.219 Vali Acc: 0.570 Test Loss: 2.219 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.196169376373291
Epoch: 13, Steps: 18 | Train Loss: 0.190 Vali Loss: 2.760 Vali Acc: 0.550 Test Loss: 2.760 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.106713771820068
Epoch: 14, Steps: 18 | Train Loss: 0.223 Vali Loss: 3.416 Vali Acc: 0.490 Test Loss: 3.416 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.688053369522095
Epoch: 15, Steps: 18 | Train Loss: 0.084 Vali Loss: 3.737 Vali Acc: 0.480 Test Loss: 3.737 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 180210
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.472656011581421
Epoch: 1, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 3.625370740890503
Epoch: 2, Steps: 18 | Train Loss: 0.730 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.229991674423218
Epoch: 3, Steps: 18 | Train Loss: 0.860 Vali Loss: 1.364 Vali Acc: 0.490 Test Loss: 1.364 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8183391094207764
Epoch: 4, Steps: 18 | Train Loss: 0.673 Vali Loss: 1.630 Vali Acc: 0.520 Test Loss: 1.630 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.946343183517456
Epoch: 5, Steps: 18 | Train Loss: 0.519 Vali Loss: 1.078 Vali Acc: 0.580 Test Loss: 1.078 Test Acc: 0.580
Validation loss decreased (-0.519991 --> -0.579989).  Saving model ...
Epoch: 6 cost time: 4.29009485244751
Epoch: 6, Steps: 18 | Train Loss: 0.439 Vali Loss: 1.110 Vali Acc: 0.480 Test Loss: 1.110 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7160255908966064
Epoch: 7, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.891 Vali Acc: 0.500 Test Loss: 0.891 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.876291275024414
Epoch: 8, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.723125457763672
Epoch: 9, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.396 Vali Acc: 0.550 Test Loss: 1.396 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.76007080078125
Epoch: 10, Steps: 18 | Train Loss: 0.154 Vali Loss: 1.370 Vali Acc: 0.530 Test Loss: 1.370 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.9518635272979736
Epoch: 11, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.883 Vali Acc: 0.510 Test Loss: 1.883 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8642354011535645
Epoch: 12, Steps: 18 | Train Loss: 0.095 Vali Loss: 2.112 Vali Acc: 0.490 Test Loss: 2.112 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.6315195560455322
Epoch: 13, Steps: 18 | Train Loss: 0.076 Vali Loss: 2.564 Vali Acc: 0.520 Test Loss: 2.564 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.8594729900360107
Epoch: 14, Steps: 18 | Train Loss: 0.157 Vali Loss: 2.333 Vali Acc: 0.490 Test Loss: 2.333 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.217686891555786
Epoch: 15, Steps: 18 | Train Loss: 0.075 Vali Loss: 2.848 Vali Acc: 0.480 Test Loss: 2.848 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 103586
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.9486236572265625
Epoch: 1, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.691 Vali Acc: 0.520 Test Loss: 0.691 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.056739330291748
Epoch: 2, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.766 Vali Acc: 0.530 Test Loss: 0.766 Test Acc: 0.530
Validation loss decreased (-0.519993 --> -0.529992).  Saving model ...
Epoch: 3 cost time: 2.8830509185791016
Epoch: 3, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.890 Vali Acc: 0.530 Test Loss: 0.890 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3187406063079834
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.800 Vali Acc: 0.510 Test Loss: 0.800 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3387370109558105
Epoch: 5, Steps: 18 | Train Loss: 0.493 Vali Loss: 1.127 Vali Acc: 0.580 Test Loss: 1.127 Test Acc: 0.580
Validation loss decreased (-0.529992 --> -0.579989).  Saving model ...
Epoch: 6 cost time: 2.8433451652526855
Epoch: 6, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.943 Vali Acc: 0.560 Test Loss: 0.943 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.971813440322876
Epoch: 7, Steps: 18 | Train Loss: 0.362 Vali Loss: 0.949 Vali Acc: 0.500 Test Loss: 0.949 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1733832359313965
Epoch: 8, Steps: 18 | Train Loss: 0.321 Vali Loss: 0.909 Vali Acc: 0.560 Test Loss: 0.909 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0899882316589355
Epoch: 9, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.399 Vali Acc: 0.490 Test Loss: 1.399 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1703898906707764
Epoch: 10, Steps: 18 | Train Loss: 0.305 Vali Loss: 1.438 Vali Acc: 0.560 Test Loss: 1.438 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2991771697998047
Epoch: 11, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.443 Vali Acc: 0.530 Test Loss: 1.443 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8745579719543457
Epoch: 12, Steps: 18 | Train Loss: 0.151 Vali Loss: 1.446 Vali Acc: 0.470 Test Loss: 1.446 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.86220383644104
Epoch: 13, Steps: 18 | Train Loss: 0.141 Vali Loss: 2.061 Vali Acc: 0.500 Test Loss: 2.061 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.145702838897705
Epoch: 14, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.448 Vali Acc: 0.540 Test Loss: 1.448 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9429564476013184
Epoch: 15, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 76114
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.294086456298828
Epoch: 1, Steps: 18 | Train Loss: 0.772 Vali Loss: 0.703 Vali Acc: 0.540 Test Loss: 0.703 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.811067581176758
Epoch: 2, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.826 Vali Acc: 0.510 Test Loss: 0.826 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.629039764404297
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.722 Vali Acc: 0.570 Test Loss: 0.722 Test Acc: 0.570
Validation loss decreased (-0.539993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 2.6350831985473633
Epoch: 4, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.895 Vali Acc: 0.520 Test Loss: 0.895 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.987983226776123
Epoch: 5, Steps: 18 | Train Loss: 0.502 Vali Loss: 0.829 Vali Acc: 0.580 Test Loss: 0.829 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579992).  Saving model ...
Epoch: 6 cost time: 2.818239212036133
Epoch: 6, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.903 Vali Acc: 0.560 Test Loss: 0.903 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.047746181488037
Epoch: 7, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.911 Vali Acc: 0.540 Test Loss: 0.911 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.85998272895813
Epoch: 8, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.044 Vali Acc: 0.520 Test Loss: 1.044 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.815203905105591
Epoch: 9, Steps: 18 | Train Loss: 0.260 Vali Loss: 1.000 Vali Acc: 0.550 Test Loss: 1.000 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8292293548583984
Epoch: 10, Steps: 18 | Train Loss: 0.253 Vali Loss: 0.993 Vali Acc: 0.540 Test Loss: 0.993 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7433581352233887
Epoch: 11, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.360 Vali Acc: 0.560 Test Loss: 1.360 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.871556520462036
Epoch: 12, Steps: 18 | Train Loss: 0.148 Vali Loss: 1.025 Vali Acc: 0.560 Test Loss: 1.025 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9443681240081787
Epoch: 13, Steps: 18 | Train Loss: 0.135 Vali Loss: 1.326 Vali Acc: 0.510 Test Loss: 1.326 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0031161308288574
Epoch: 14, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.231 Vali Acc: 0.520 Test Loss: 1.231 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.832972288131714
Epoch: 15, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.503 Vali Acc: 0.520 Test Loss: 1.503 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 65026
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.150156021118164
Epoch: 1, Steps: 18 | Train Loss: 0.736 Vali Loss: 0.699 Vali Acc: 0.510 Test Loss: 0.699 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.75675892829895
Epoch: 2, Steps: 18 | Train Loss: 0.733 Vali Loss: 0.763 Vali Acc: 0.480 Test Loss: 0.763 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.192858934402466
Epoch: 3, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.731 Vali Acc: 0.610 Test Loss: 0.731 Test Acc: 0.610
Validation loss decreased (-0.509993 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 2.5526325702667236
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.730 Vali Acc: 0.620 Test Loss: 0.730 Test Acc: 0.620
Validation loss decreased (-0.609993 --> -0.619993).  Saving model ...
Epoch: 5 cost time: 2.751098871231079
Epoch: 5, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.771 Vali Acc: 0.600 Test Loss: 0.771 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.820330858230591
Epoch: 6, Steps: 18 | Train Loss: 0.485 Vali Loss: 0.801 Vali Acc: 0.600 Test Loss: 0.801 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3656809329986572
Epoch: 7, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.806 Vali Acc: 0.570 Test Loss: 0.806 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9030447006225586
Epoch: 8, Steps: 18 | Train Loss: 0.397 Vali Loss: 0.882 Vali Acc: 0.540 Test Loss: 0.882 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.984562635421753
Epoch: 9, Steps: 18 | Train Loss: 0.353 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9462337493896484
Epoch: 10, Steps: 18 | Train Loss: 0.370 Vali Loss: 0.900 Vali Acc: 0.560 Test Loss: 0.900 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7642247676849365
Epoch: 11, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.7653188705444336
Epoch: 12, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.146 Vali Acc: 0.550 Test Loss: 1.146 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0507283210754395
Epoch: 13, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.045 Vali Acc: 0.570 Test Loss: 1.045 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7926559448242188
Epoch: 14, Steps: 18 | Train Loss: 0.153 Vali Loss: 1.160 Vali Acc: 0.550 Test Loss: 1.160 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 53090
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.511232852935791
Epoch: 1, Steps: 18 | Train Loss: 0.820 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.5315239429473877
Epoch: 2, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.709 Vali Acc: 0.590 Test Loss: 0.709 Test Acc: 0.590
Validation loss decreased (-0.509993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.73012638092041
Epoch: 3, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.708 Vali Acc: 0.610 Test Loss: 0.708 Test Acc: 0.610
Validation loss decreased (-0.589993 --> -0.609993).  Saving model ...
Epoch: 4 cost time: 2.7593979835510254
Epoch: 4, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.732 Vali Acc: 0.550 Test Loss: 0.732 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.977832078933716
Epoch: 5, Steps: 18 | Train Loss: 0.547 Vali Loss: 0.811 Vali Acc: 0.530 Test Loss: 0.811 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8542637825012207
Epoch: 6, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.813 Vali Acc: 0.480 Test Loss: 0.813 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.837127208709717
Epoch: 7, Steps: 18 | Train Loss: 0.476 Vali Loss: 0.763 Vali Acc: 0.530 Test Loss: 0.763 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5048365592956543
Epoch: 8, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.815 Vali Acc: 0.540 Test Loss: 0.815 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8647847175598145
Epoch: 9, Steps: 18 | Train Loss: 0.396 Vali Loss: 0.840 Vali Acc: 0.540 Test Loss: 0.840 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0927395820617676
Epoch: 10, Steps: 18 | Train Loss: 0.365 Vali Loss: 0.919 Vali Acc: 0.540 Test Loss: 0.919 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.610837936401367
Epoch: 11, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.867 Vali Acc: 0.510 Test Loss: 0.867 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.505887269973755
Epoch: 12, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.860 Vali Acc: 0.540 Test Loss: 0.860 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6597392559051514
Epoch: 13, Steps: 18 | Train Loss: 0.254 Vali Loss: 0.927 Vali Acc: 0.510 Test Loss: 0.927 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 49346
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.0166966915130615
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.826 Vali Acc: 0.430 Test Loss: 0.826 Test Acc: 0.430
Validation loss decreased (inf --> -0.429992).  Saving model ...
Epoch: 2 cost time: 3.320289373397827
Epoch: 2, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.732 Vali Acc: 0.540 Test Loss: 0.732 Test Acc: 0.540
Validation loss decreased (-0.429992 --> -0.539993).  Saving model ...
Epoch: 3 cost time: 2.908308982849121
Epoch: 3, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.718 Vali Acc: 0.550 Test Loss: 0.718 Test Acc: 0.550
Validation loss decreased (-0.539993 --> -0.549993).  Saving model ...
Epoch: 4 cost time: 3.012387752532959
Epoch: 4, Steps: 18 | Train Loss: 0.614 Vali Loss: 0.728 Vali Acc: 0.500 Test Loss: 0.728 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.809220790863037
Epoch: 5, Steps: 18 | Train Loss: 0.586 Vali Loss: 0.705 Vali Acc: 0.570 Test Loss: 0.705 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569993).  Saving model ...
Epoch: 6 cost time: 2.986389636993408
Epoch: 6, Steps: 18 | Train Loss: 0.516 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.081465244293213
Epoch: 7, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6237244606018066
Epoch: 8, Steps: 18 | Train Loss: 0.465 Vali Loss: 0.761 Vali Acc: 0.520 Test Loss: 0.761 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1758127212524414
Epoch: 9, Steps: 18 | Train Loss: 0.440 Vali Loss: 0.765 Vali Acc: 0.570 Test Loss: 0.765 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.266117811203003
Epoch: 10, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.781 Vali Acc: 0.570 Test Loss: 0.781 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2877981662750244
Epoch: 11, Steps: 18 | Train Loss: 0.347 Vali Loss: 0.828 Vali Acc: 0.560 Test Loss: 0.828 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9575724601745605
Epoch: 12, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.858 Vali Acc: 0.540 Test Loss: 0.858 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.862678050994873
Epoch: 13, Steps: 18 | Train Loss: 0.285 Vali Loss: 0.956 Vali Acc: 0.530 Test Loss: 0.956 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5325963497161865
Epoch: 14, Steps: 18 | Train Loss: 0.307 Vali Loss: 1.068 Vali Acc: 0.500 Test Loss: 1.068 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.900458335876465
Epoch: 15, Steps: 18 | Train Loss: 0.263 Vali Loss: 1.005 Vali Acc: 0.540 Test Loss: 1.005 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 47650
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.539056301116943
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 5.316339492797852
Epoch: 2, Steps: 18 | Train Loss: 0.887 Vali Loss: 0.875 Vali Acc: 0.590 Test Loss: 0.875 Test Acc: 0.590
Validation loss decreased (-0.499986 --> -0.589991).  Saving model ...
Epoch: 3 cost time: 5.570230484008789
Epoch: 3, Steps: 18 | Train Loss: 0.788 Vali Loss: 1.514 Vali Acc: 0.510 Test Loss: 1.514 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.772978782653809
Epoch: 4, Steps: 18 | Train Loss: 0.912 Vali Loss: 1.016 Vali Acc: 0.570 Test Loss: 1.016 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.860671281814575
Epoch: 5, Steps: 18 | Train Loss: 0.583 Vali Loss: 1.194 Vali Acc: 0.480 Test Loss: 1.194 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.219523906707764
Epoch: 6, Steps: 18 | Train Loss: 0.639 Vali Loss: 2.224 Vali Acc: 0.510 Test Loss: 2.224 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.70777440071106
Epoch: 7, Steps: 18 | Train Loss: 0.415 Vali Loss: 1.903 Vali Acc: 0.540 Test Loss: 1.903 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.314973592758179
Epoch: 8, Steps: 18 | Train Loss: 0.411 Vali Loss: 2.166 Vali Acc: 0.520 Test Loss: 2.166 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.551454305648804
Epoch: 9, Steps: 18 | Train Loss: 0.263 Vali Loss: 2.100 Vali Acc: 0.470 Test Loss: 2.100 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.698460102081299
Epoch: 10, Steps: 18 | Train Loss: 0.309 Vali Loss: 2.522 Vali Acc: 0.520 Test Loss: 2.522 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.555176258087158
Epoch: 11, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.823 Vali Acc: 0.550 Test Loss: 2.823 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.473112344741821
Epoch: 12, Steps: 18 | Train Loss: 0.223 Vali Loss: 2.547 Vali Acc: 0.550 Test Loss: 2.547 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 171762
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.553247690200806
Epoch: 1, Steps: 18 | Train Loss: 0.862 Vali Loss: 0.797 Vali Acc: 0.420 Test Loss: 0.797 Test Acc: 0.420
Validation loss decreased (inf --> -0.419992).  Saving model ...
Epoch: 2 cost time: 3.335469961166382
Epoch: 2, Steps: 18 | Train Loss: 0.714 Vali Loss: 0.962 Vali Acc: 0.480 Test Loss: 0.962 Test Acc: 0.480
Validation loss decreased (-0.419992 --> -0.479990).  Saving model ...
Epoch: 3 cost time: 3.35913348197937
Epoch: 3, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.767 Vali Acc: 0.520 Test Loss: 0.767 Test Acc: 0.520
Validation loss decreased (-0.479990 --> -0.519992).  Saving model ...
Epoch: 4 cost time: 3.442074775695801
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.814 Vali Acc: 0.510 Test Loss: 0.814 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6278207302093506
Epoch: 5, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.842 Vali Acc: 0.570 Test Loss: 0.842 Test Acc: 0.570
Validation loss decreased (-0.519992 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 3.69748592376709
Epoch: 6, Steps: 18 | Train Loss: 0.481 Vali Loss: 1.045 Vali Acc: 0.580 Test Loss: 1.045 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579990).  Saving model ...
Epoch: 7 cost time: 3.3628029823303223
Epoch: 7, Steps: 18 | Train Loss: 0.348 Vali Loss: 1.242 Vali Acc: 0.510 Test Loss: 1.242 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1534817218780518
Epoch: 8, Steps: 18 | Train Loss: 0.339 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4081637859344482
Epoch: 9, Steps: 18 | Train Loss: 0.355 Vali Loss: 1.668 Vali Acc: 0.500 Test Loss: 1.668 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2681734561920166
Epoch: 10, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.499 Vali Acc: 0.510 Test Loss: 1.499 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3984615802764893
Epoch: 11, Steps: 18 | Train Loss: 0.119 Vali Loss: 1.718 Vali Acc: 0.520 Test Loss: 1.718 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.180961847305298
Epoch: 12, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.636 Vali Acc: 0.490 Test Loss: 1.636 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2913217544555664
Epoch: 13, Steps: 18 | Train Loss: 0.120 Vali Loss: 2.094 Vali Acc: 0.500 Test Loss: 2.094 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.923474073410034
Epoch: 14, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.776 Vali Acc: 0.540 Test Loss: 1.776 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.3298192024230957
Epoch: 15, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.423 Vali Acc: 0.520 Test Loss: 2.423 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.141300678253174
Epoch: 16, Steps: 18 | Train Loss: 0.046 Vali Loss: 2.553 Vali Acc: 0.480 Test Loss: 2.553 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 95138
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.5822203159332275
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.710 Vali Acc: 0.520 Test Loss: 0.710 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 3.124166250228882
Epoch: 2, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.783 Vali Acc: 0.460 Test Loss: 0.783 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9616594314575195
Epoch: 3, Steps: 18 | Train Loss: 0.689 Vali Loss: 0.946 Vali Acc: 0.540 Test Loss: 0.946 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539991).  Saving model ...
Epoch: 4 cost time: 3.287558078765869
Epoch: 4, Steps: 18 | Train Loss: 0.529 Vali Loss: 0.847 Vali Acc: 0.540 Test Loss: 0.847 Test Acc: 0.540
Validation loss decreased (-0.539991 --> -0.539992).  Saving model ...
Epoch: 5 cost time: 3.207082986831665
Epoch: 5, Steps: 18 | Train Loss: 0.438 Vali Loss: 0.872 Vali Acc: 0.530 Test Loss: 0.872 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9828269481658936
Epoch: 6, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.914 Vali Acc: 0.540 Test Loss: 0.914 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.036198616027832
Epoch: 7, Steps: 18 | Train Loss: 0.352 Vali Loss: 0.951 Vali Acc: 0.530 Test Loss: 0.951 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.069894313812256
Epoch: 8, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.288 Vali Acc: 0.510 Test Loss: 1.288 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0381007194519043
Epoch: 9, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.137 Vali Acc: 0.480 Test Loss: 1.137 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.440868854522705
Epoch: 10, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.179 Vali Acc: 0.560 Test Loss: 1.179 Test Acc: 0.560
Validation loss decreased (-0.539992 --> -0.559988).  Saving model ...
Epoch: 11 cost time: 3.3132872581481934
Epoch: 11, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.344 Vali Acc: 0.540 Test Loss: 1.344 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1398377418518066
Epoch: 12, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.107128143310547
Epoch: 13, Steps: 18 | Train Loss: 0.105 Vali Loss: 1.489 Vali Acc: 0.480 Test Loss: 1.489 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.489379405975342
Epoch: 14, Steps: 18 | Train Loss: 0.077 Vali Loss: 1.608 Vali Acc: 0.450 Test Loss: 1.608 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3900396823883057
Epoch: 15, Steps: 18 | Train Loss: 0.045 Vali Loss: 1.543 Vali Acc: 0.490 Test Loss: 1.543 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.679103374481201
Epoch: 16, Steps: 18 | Train Loss: 0.035 Vali Loss: 1.740 Vali Acc: 0.510 Test Loss: 1.740 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0627853870391846
Epoch: 17, Steps: 18 | Train Loss: 0.039 Vali Loss: 2.056 Vali Acc: 0.520 Test Loss: 2.056 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.0735349655151367
Epoch: 18, Steps: 18 | Train Loss: 0.034 Vali Loss: 1.947 Vali Acc: 0.500 Test Loss: 1.947 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.4083714485168457
Epoch: 19, Steps: 18 | Train Loss: 0.016 Vali Loss: 2.056 Vali Acc: 0.510 Test Loss: 2.056 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2259395122528076
Epoch: 20, Steps: 18 | Train Loss: 0.019 Vali Loss: 1.843 Vali Acc: 0.500 Test Loss: 1.843 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 67666
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.416100740432739
Epoch: 1, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.818 Vali Acc: 0.500 Test Loss: 0.818 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.641268730163574
Epoch: 2, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.799 Vali Acc: 0.550 Test Loss: 0.799 Test Acc: 0.550
Validation loss decreased (-0.499992 --> -0.549992).  Saving model ...
Epoch: 3 cost time: 3.0137734413146973
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
Validation loss decreased (-0.549992 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 2.7472665309906006
Epoch: 4, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.014896869659424
Epoch: 5, Steps: 18 | Train Loss: 0.522 Vali Loss: 0.905 Vali Acc: 0.600 Test Loss: 0.905 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 3.227180242538452
Epoch: 6, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.949 Vali Acc: 0.590 Test Loss: 0.949 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7935752868652344
Epoch: 7, Steps: 18 | Train Loss: 0.443 Vali Loss: 1.039 Vali Acc: 0.580 Test Loss: 1.039 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.665806293487549
Epoch: 8, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.912 Vali Acc: 0.560 Test Loss: 0.912 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.1372032165527344
Epoch: 9, Steps: 18 | Train Loss: 0.335 Vali Loss: 1.067 Vali Acc: 0.580 Test Loss: 1.067 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.977215528488159
Epoch: 10, Steps: 18 | Train Loss: 0.241 Vali Loss: 0.954 Vali Acc: 0.600 Test Loss: 0.954 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.903008460998535
Epoch: 11, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.963 Vali Acc: 0.530 Test Loss: 0.963 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.8288371562957764
Epoch: 12, Steps: 18 | Train Loss: 0.140 Vali Loss: 1.020 Vali Acc: 0.590 Test Loss: 1.020 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0438640117645264
Epoch: 13, Steps: 18 | Train Loss: 0.123 Vali Loss: 1.279 Vali Acc: 0.550 Test Loss: 1.279 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0876145362854004
Epoch: 14, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.350 Vali Acc: 0.540 Test Loss: 1.350 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.076185703277588
Epoch: 15, Steps: 18 | Train Loss: 0.117 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 56578
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.355435848236084
Epoch: 1, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.769 Vali Acc: 0.490 Test Loss: 0.769 Test Acc: 0.490
Validation loss decreased (inf --> -0.489992).  Saving model ...
Epoch: 2 cost time: 2.9689364433288574
Epoch: 2, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.857 Vali Acc: 0.560 Test Loss: 0.857 Test Acc: 0.560
Validation loss decreased (-0.489992 --> -0.559991).  Saving model ...
Epoch: 3 cost time: 2.8953073024749756
Epoch: 3, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.779 Vali Acc: 0.600 Test Loss: 0.779 Test Acc: 0.600
Validation loss decreased (-0.559991 --> -0.599992).  Saving model ...
Epoch: 4 cost time: 2.5375993251800537
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.788 Vali Acc: 0.550 Test Loss: 0.788 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.582021951675415
Epoch: 5, Steps: 18 | Train Loss: 0.589 Vali Loss: 0.883 Vali Acc: 0.570 Test Loss: 0.883 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.37272572517395
Epoch: 6, Steps: 18 | Train Loss: 0.501 Vali Loss: 0.881 Vali Acc: 0.470 Test Loss: 0.881 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.791839361190796
Epoch: 7, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.794 Vali Acc: 0.590 Test Loss: 0.794 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.415719985961914
Epoch: 8, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.947 Vali Acc: 0.630 Test Loss: 0.947 Test Acc: 0.630
Validation loss decreased (-0.599992 --> -0.629991).  Saving model ...
Epoch: 9 cost time: 3.0850532054901123
Epoch: 9, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.933 Vali Acc: 0.510 Test Loss: 0.933 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4136881828308105
Epoch: 10, Steps: 18 | Train Loss: 0.319 Vali Loss: 0.909 Vali Acc: 0.540 Test Loss: 0.909 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5987114906311035
Epoch: 11, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.133 Vali Acc: 0.530 Test Loss: 1.133 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7537667751312256
Epoch: 12, Steps: 18 | Train Loss: 0.233 Vali Loss: 1.022 Vali Acc: 0.580 Test Loss: 1.022 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1426000595092773
Epoch: 13, Steps: 18 | Train Loss: 0.191 Vali Loss: 1.117 Vali Acc: 0.550 Test Loss: 1.117 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6613781452178955
Epoch: 14, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.266 Vali Acc: 0.510 Test Loss: 1.266 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.729252815246582
Epoch: 15, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.321 Vali Acc: 0.520 Test Loss: 1.321 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8378746509552
Epoch: 16, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.198 Vali Acc: 0.540 Test Loss: 1.198 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.7686076164245605
Epoch: 17, Steps: 18 | Train Loss: 0.089 Vali Loss: 1.395 Vali Acc: 0.560 Test Loss: 1.395 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8824338912963867
Epoch: 18, Steps: 18 | Train Loss: 0.091 Vali Loss: 1.459 Vali Acc: 0.500 Test Loss: 1.459 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 44642
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.872783422470093
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.704 Vali Acc: 0.480 Test Loss: 0.704 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 2.6693975925445557
Epoch: 2, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.687 Vali Acc: 0.590 Test Loss: 0.687 Test Acc: 0.590
Validation loss decreased (-0.479993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 2.695749282836914
Epoch: 3, Steps: 18 | Train Loss: 0.704 Vali Loss: 0.746 Vali Acc: 0.550 Test Loss: 0.746 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.81567120552063
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.762 Vali Acc: 0.540 Test Loss: 0.762 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.584268093109131
Epoch: 5, Steps: 18 | Train Loss: 0.569 Vali Loss: 0.800 Vali Acc: 0.530 Test Loss: 0.800 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4641404151916504
Epoch: 6, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.734 Vali Acc: 0.530 Test Loss: 0.734 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6826910972595215
Epoch: 7, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.812 Vali Acc: 0.510 Test Loss: 0.812 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8718276023864746
Epoch: 8, Steps: 18 | Train Loss: 0.444 Vali Loss: 0.814 Vali Acc: 0.530 Test Loss: 0.814 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1514320373535156
Epoch: 9, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.780 Vali Acc: 0.570 Test Loss: 0.780 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7770941257476807
Epoch: 10, Steps: 18 | Train Loss: 0.374 Vali Loss: 0.817 Vali Acc: 0.560 Test Loss: 0.817 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3058013916015625
Epoch: 11, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.800 Vali Acc: 0.590 Test Loss: 0.800 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7949748039245605
Epoch: 12, Steps: 18 | Train Loss: 0.328 Vali Loss: 0.881 Vali Acc: 0.580 Test Loss: 0.881 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 40898
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.1541430950164795
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.712 Vali Acc: 0.520 Test Loss: 0.712 Test Acc: 0.520
Validation loss decreased (inf --> -0.519993).  Saving model ...
Epoch: 2 cost time: 2.756880521774292
Epoch: 2, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.726 Vali Acc: 0.500 Test Loss: 0.726 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7598612308502197
Epoch: 3, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.708 Vali Acc: 0.520 Test Loss: 0.708 Test Acc: 0.520
Validation loss decreased (-0.519993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.490269184112549
Epoch: 4, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.722 Vali Acc: 0.500 Test Loss: 0.722 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.537074565887451
Epoch: 5, Steps: 18 | Train Loss: 0.643 Vali Loss: 0.719 Vali Acc: 0.540 Test Loss: 0.719 Test Acc: 0.540
Validation loss decreased (-0.519993 --> -0.539993).  Saving model ...
Epoch: 6 cost time: 2.5432450771331787
Epoch: 6, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.780 Vali Acc: 0.520 Test Loss: 0.780 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8020148277282715
Epoch: 7, Steps: 18 | Train Loss: 0.492 Vali Loss: 0.796 Vali Acc: 0.530 Test Loss: 0.796 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.042412042617798
Epoch: 8, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.787 Vali Acc: 0.530 Test Loss: 0.787 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.6804733276367188
Epoch: 9, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.845 Vali Acc: 0.540 Test Loss: 0.845 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.573606252670288
Epoch: 10, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.918 Vali Acc: 0.520 Test Loss: 0.918 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.964292049407959
Epoch: 11, Steps: 18 | Train Loss: 0.359 Vali Loss: 0.946 Vali Acc: 0.520 Test Loss: 0.946 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0343332290649414
Epoch: 12, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.866 Vali Acc: 0.500 Test Loss: 0.866 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5460011959075928
Epoch: 13, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.884 Vali Acc: 0.510 Test Loss: 0.884 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.484518051147461
Epoch: 14, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.038 Vali Acc: 0.470 Test Loss: 1.038 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7863104343414307
Epoch: 15, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.065 Vali Acc: 0.540 Test Loss: 1.065 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.54
model parameter : 39202
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.955672740936279
Epoch: 1, Steps: 18 | Train Loss: 0.877 Vali Loss: 1.008 Vali Acc: 0.500 Test Loss: 1.008 Test Acc: 0.500
Validation loss decreased (inf --> -0.499990).  Saving model ...
Epoch: 2 cost time: 4.19380259513855
Epoch: 2, Steps: 18 | Train Loss: 0.792 Vali Loss: 0.869 Vali Acc: 0.550 Test Loss: 0.869 Test Acc: 0.550
Validation loss decreased (-0.499990 --> -0.549991).  Saving model ...
Epoch: 3 cost time: 4.218362808227539
Epoch: 3, Steps: 18 | Train Loss: 0.584 Vali Loss: 0.862 Vali Acc: 0.560 Test Loss: 0.862 Test Acc: 0.560
Validation loss decreased (-0.549991 --> -0.559991).  Saving model ...
Epoch: 4 cost time: 4.333277463912964
Epoch: 4, Steps: 18 | Train Loss: 0.927 Vali Loss: 1.595 Vali Acc: 0.530 Test Loss: 1.595 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.415483236312866
Epoch: 5, Steps: 18 | Train Loss: 0.495 Vali Loss: 2.045 Vali Acc: 0.440 Test Loss: 2.045 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.083761215209961
Epoch: 6, Steps: 18 | Train Loss: 0.457 Vali Loss: 1.074 Vali Acc: 0.540 Test Loss: 1.074 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.231114387512207
Epoch: 7, Steps: 18 | Train Loss: 0.325 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.563873529434204
Epoch: 8, Steps: 18 | Train Loss: 0.697 Vali Loss: 2.579 Vali Acc: 0.520 Test Loss: 2.579 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.491963148117065
Epoch: 9, Steps: 18 | Train Loss: 0.538 Vali Loss: 2.218 Vali Acc: 0.540 Test Loss: 2.218 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.026209354400635
Epoch: 10, Steps: 18 | Train Loss: 0.368 Vali Loss: 2.221 Vali Acc: 0.540 Test Loss: 2.221 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.128182888031006
Epoch: 11, Steps: 18 | Train Loss: 0.504 Vali Loss: 3.213 Vali Acc: 0.480 Test Loss: 3.213 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.670004844665527
Epoch: 12, Steps: 18 | Train Loss: 0.271 Vali Loss: 2.897 Vali Acc: 0.520 Test Loss: 2.897 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.912292957305908
Epoch: 13, Steps: 18 | Train Loss: 0.295 Vali Loss: 2.876 Vali Acc: 0.500 Test Loss: 2.876 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 167538
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.737947940826416
Epoch: 1, Steps: 18 | Train Loss: 0.817 Vali Loss: 0.769 Vali Acc: 0.440 Test Loss: 0.769 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 3.8989996910095215
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.990 Vali Acc: 0.540 Test Loss: 0.990 Test Acc: 0.540
Validation loss decreased (-0.439992 --> -0.539990).  Saving model ...
Epoch: 3 cost time: 3.712895631790161
Epoch: 3, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.745 Vali Acc: 0.570 Test Loss: 0.745 Test Acc: 0.570
Validation loss decreased (-0.539990 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.6973447799682617
Epoch: 4, Steps: 18 | Train Loss: 0.539 Vali Loss: 0.943 Vali Acc: 0.510 Test Loss: 0.943 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.13960599899292
Epoch: 5, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.852 Vali Acc: 0.560 Test Loss: 0.852 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.85799503326416
Epoch: 6, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.885 Vali Acc: 0.550 Test Loss: 0.885 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5360593795776367
Epoch: 7, Steps: 18 | Train Loss: 0.337 Vali Loss: 1.713 Vali Acc: 0.580 Test Loss: 1.713 Test Acc: 0.580
Validation loss decreased (-0.569993 --> -0.579983).  Saving model ...
Epoch: 8 cost time: 3.181884288787842
Epoch: 8, Steps: 18 | Train Loss: 0.275 Vali Loss: 1.093 Vali Acc: 0.520 Test Loss: 1.093 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.053579330444336
Epoch: 9, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.551 Vali Acc: 0.540 Test Loss: 1.551 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.625624895095825
Epoch: 10, Steps: 18 | Train Loss: 0.229 Vali Loss: 2.167 Vali Acc: 0.540 Test Loss: 2.167 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7147159576416016
Epoch: 11, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.535 Vali Acc: 0.530 Test Loss: 1.535 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.232203960418701
Epoch: 12, Steps: 18 | Train Loss: 0.164 Vali Loss: 2.037 Vali Acc: 0.520 Test Loss: 2.037 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.0635650157928467
Epoch: 13, Steps: 18 | Train Loss: 0.126 Vali Loss: 1.906 Vali Acc: 0.490 Test Loss: 1.906 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6542160511016846
Epoch: 14, Steps: 18 | Train Loss: 0.082 Vali Loss: 1.730 Vali Acc: 0.540 Test Loss: 1.730 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.839782238006592
Epoch: 15, Steps: 18 | Train Loss: 0.054 Vali Loss: 2.417 Vali Acc: 0.530 Test Loss: 2.417 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.0082643032073975
Epoch: 16, Steps: 18 | Train Loss: 0.049 Vali Loss: 2.243 Vali Acc: 0.510 Test Loss: 2.243 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9553728103637695
Epoch: 17, Steps: 18 | Train Loss: 0.031 Vali Loss: 2.585 Vali Acc: 0.520 Test Loss: 2.585 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 90914
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.462194442749023
Epoch: 1, Steps: 18 | Train Loss: 0.761 Vali Loss: 0.751 Vali Acc: 0.510 Test Loss: 0.751 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.192399740219116
Epoch: 2, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.933 Vali Acc: 0.480 Test Loss: 0.933 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2941343784332275
Epoch: 3, Steps: 18 | Train Loss: 0.629 Vali Loss: 1.248 Vali Acc: 0.520 Test Loss: 1.248 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519988).  Saving model ...
Epoch: 4 cost time: 3.575801134109497
Epoch: 4, Steps: 18 | Train Loss: 0.633 Vali Loss: 0.726 Vali Acc: 0.570 Test Loss: 0.726 Test Acc: 0.570
Validation loss decreased (-0.519988 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 3.3445844650268555
Epoch: 5, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.957 Vali Acc: 0.500 Test Loss: 0.957 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.622755289077759
Epoch: 6, Steps: 18 | Train Loss: 0.471 Vali Loss: 0.924 Vali Acc: 0.620 Test Loss: 0.924 Test Acc: 0.620
Validation loss decreased (-0.569993 --> -0.619991).  Saving model ...
Epoch: 7 cost time: 3.387861490249634
Epoch: 7, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.032 Vali Acc: 0.510 Test Loss: 1.032 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.500012159347534
Epoch: 8, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.976 Vali Acc: 0.520 Test Loss: 0.976 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4414567947387695
Epoch: 9, Steps: 18 | Train Loss: 0.346 Vali Loss: 0.960 Vali Acc: 0.560 Test Loss: 0.960 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.4795780181884766
Epoch: 10, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.410 Vali Acc: 0.520 Test Loss: 1.410 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.263307571411133
Epoch: 11, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.248 Vali Acc: 0.550 Test Loss: 1.248 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.292280435562134
Epoch: 12, Steps: 18 | Train Loss: 0.202 Vali Loss: 1.491 Vali Acc: 0.500 Test Loss: 1.491 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.1432693004608154
Epoch: 13, Steps: 18 | Train Loss: 0.148 Vali Loss: 1.924 Vali Acc: 0.490 Test Loss: 1.924 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.5384597778320312
Epoch: 14, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.513 Vali Acc: 0.560 Test Loss: 1.513 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.501396417617798
Epoch: 15, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.482 Vali Acc: 0.550 Test Loss: 1.482 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.105966091156006
Epoch: 16, Steps: 18 | Train Loss: 0.078 Vali Loss: 1.877 Vali Acc: 0.470 Test Loss: 1.877 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 63442
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.248112678527832
Epoch: 1, Steps: 18 | Train Loss: 0.788 Vali Loss: 0.881 Vali Acc: 0.500 Test Loss: 0.881 Test Acc: 0.500
Validation loss decreased (inf --> -0.499991).  Saving model ...
Epoch: 2 cost time: 2.8677897453308105
Epoch: 2, Steps: 18 | Train Loss: 0.717 Vali Loss: 0.754 Vali Acc: 0.450 Test Loss: 0.754 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4334044456481934
Epoch: 3, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.795 Vali Acc: 0.590 Test Loss: 0.795 Test Acc: 0.590
Validation loss decreased (-0.499991 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 2.9046883583068848
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.774 Vali Acc: 0.520 Test Loss: 0.774 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.993539333343506
Epoch: 5, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.801 Vali Acc: 0.540 Test Loss: 0.801 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9159793853759766
Epoch: 6, Steps: 18 | Train Loss: 0.482 Vali Loss: 0.916 Vali Acc: 0.460 Test Loss: 0.916 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8092052936553955
Epoch: 7, Steps: 18 | Train Loss: 0.438 Vali Loss: 1.037 Vali Acc: 0.560 Test Loss: 1.037 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.667069435119629
Epoch: 8, Steps: 18 | Train Loss: 0.336 Vali Loss: 0.997 Vali Acc: 0.540 Test Loss: 0.997 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.107218027114868
Epoch: 9, Steps: 18 | Train Loss: 0.250 Vali Loss: 1.044 Vali Acc: 0.530 Test Loss: 1.044 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.081480026245117
Epoch: 10, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.023648262023926
Epoch: 11, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.082 Vali Acc: 0.490 Test Loss: 1.082 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.0293099880218506
Epoch: 12, Steps: 18 | Train Loss: 0.162 Vali Loss: 1.089 Vali Acc: 0.550 Test Loss: 1.089 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0702316761016846
Epoch: 13, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.260 Vali Acc: 0.550 Test Loss: 1.260 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 52354
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.018877983093262
Epoch: 1, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.693 Vali Acc: 0.620 Test Loss: 0.693 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 3.496469736099243
Epoch: 2, Steps: 18 | Train Loss: 0.691 Vali Loss: 0.685 Vali Acc: 0.600 Test Loss: 0.685 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2761752605438232
Epoch: 3, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.741 Vali Acc: 0.550 Test Loss: 0.741 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.050304651260376
Epoch: 4, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.732 Vali Acc: 0.560 Test Loss: 0.732 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2335214614868164
Epoch: 5, Steps: 18 | Train Loss: 0.573 Vali Loss: 0.805 Vali Acc: 0.590 Test Loss: 0.805 Test Acc: 0.590
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.908085346221924
Epoch: 6, Steps: 18 | Train Loss: 0.504 Vali Loss: 0.799 Vali Acc: 0.570 Test Loss: 0.799 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.314258098602295
Epoch: 7, Steps: 18 | Train Loss: 0.442 Vali Loss: 0.828 Vali Acc: 0.540 Test Loss: 0.828 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.01176118850708
Epoch: 8, Steps: 18 | Train Loss: 0.392 Vali Loss: 0.884 Vali Acc: 0.550 Test Loss: 0.884 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.5842063426971436
Epoch: 9, Steps: 18 | Train Loss: 0.342 Vali Loss: 0.905 Vali Acc: 0.490 Test Loss: 0.905 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.6254830360412598
Epoch: 10, Steps: 18 | Train Loss: 0.331 Vali Loss: 0.951 Vali Acc: 0.530 Test Loss: 0.951 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.9093246459960938
Epoch: 11, Steps: 18 | Train Loss: 0.315 Vali Loss: 1.036 Vali Acc: 0.550 Test Loss: 1.036 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 40418
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.892386198043823
Epoch: 1, Steps: 18 | Train Loss: 0.770 Vali Loss: 0.738 Vali Acc: 0.460 Test Loss: 0.738 Test Acc: 0.460
Validation loss decreased (inf --> -0.459993).  Saving model ...
Epoch: 2 cost time: 2.932939052581787
Epoch: 2, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.702 Vali Acc: 0.530 Test Loss: 0.702 Test Acc: 0.530
Validation loss decreased (-0.459993 --> -0.529993).  Saving model ...
Epoch: 3 cost time: 2.6177175045013428
Epoch: 3, Steps: 18 | Train Loss: 0.675 Vali Loss: 0.740 Vali Acc: 0.480 Test Loss: 0.740 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.755842447280884
Epoch: 4, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.719 Vali Acc: 0.570 Test Loss: 0.719 Test Acc: 0.570
Validation loss decreased (-0.529993 --> -0.569993).  Saving model ...
Epoch: 5 cost time: 2.565117359161377
Epoch: 5, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.794 Vali Acc: 0.490 Test Loss: 0.794 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5257389545440674
Epoch: 6, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.775 Vali Acc: 0.560 Test Loss: 0.775 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.462374448776245
Epoch: 7, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.780 Vali Acc: 0.530 Test Loss: 0.780 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.466866970062256
Epoch: 8, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.796 Vali Acc: 0.540 Test Loss: 0.796 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7533299922943115
Epoch: 9, Steps: 18 | Train Loss: 0.401 Vali Loss: 0.879 Vali Acc: 0.510 Test Loss: 0.879 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6874938011169434
Epoch: 10, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.783 Vali Acc: 0.520 Test Loss: 0.783 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.459805727005005
Epoch: 11, Steps: 18 | Train Loss: 0.287 Vali Loss: 0.847 Vali Acc: 0.530 Test Loss: 0.847 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6151366233825684
Epoch: 12, Steps: 18 | Train Loss: 0.273 Vali Loss: 0.889 Vali Acc: 0.590 Test Loss: 0.889 Test Acc: 0.590
Validation loss decreased (-0.569993 --> -0.589991).  Saving model ...
Epoch: 13 cost time: 2.617647647857666
Epoch: 13, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.922 Vali Acc: 0.540 Test Loss: 0.922 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4650230407714844
Epoch: 14, Steps: 18 | Train Loss: 0.219 Vali Loss: 1.057 Vali Acc: 0.520 Test Loss: 1.057 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5195159912109375
Epoch: 15, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.039 Vali Acc: 0.530 Test Loss: 1.039 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.377549886703491
Epoch: 16, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.130 Vali Acc: 0.560 Test Loss: 1.130 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.805323839187622
Epoch: 17, Steps: 18 | Train Loss: 0.179 Vali Loss: 1.134 Vali Acc: 0.520 Test Loss: 1.134 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5635290145874023
Epoch: 18, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.160 Vali Acc: 0.530 Test Loss: 1.160 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5400047302246094
Epoch: 19, Steps: 18 | Train Loss: 0.106 Vali Loss: 1.228 Vali Acc: 0.540 Test Loss: 1.228 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.546555995941162
Epoch: 20, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.259 Vali Acc: 0.590 Test Loss: 1.259 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7044076919555664
Epoch: 21, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.259 Vali Acc: 0.520 Test Loss: 1.259 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.9630849361419678
Epoch: 22, Steps: 18 | Train Loss: 0.069 Vali Loss: 1.350 Vali Acc: 0.540 Test Loss: 1.350 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 36674
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.987882614135742
Epoch: 1, Steps: 18 | Train Loss: 0.732 Vali Loss: 0.691 Vali Acc: 0.570 Test Loss: 0.691 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 3.4418554306030273
Epoch: 2, Steps: 18 | Train Loss: 0.699 Vali Loss: 0.705 Vali Acc: 0.510 Test Loss: 0.705 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1500446796417236
Epoch: 3, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.692 Vali Acc: 0.600 Test Loss: 0.692 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 3.3057923316955566
Epoch: 4, Steps: 18 | Train Loss: 0.628 Vali Loss: 0.751 Vali Acc: 0.500 Test Loss: 0.751 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.017594575881958
Epoch: 5, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.747 Vali Acc: 0.510 Test Loss: 0.747 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4116923809051514
Epoch: 6, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.799 Vali Acc: 0.520 Test Loss: 0.799 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.125819683074951
Epoch: 7, Steps: 18 | Train Loss: 0.498 Vali Loss: 0.768 Vali Acc: 0.660 Test Loss: 0.768 Test Acc: 0.660
Validation loss decreased (-0.599993 --> -0.659992).  Saving model ...
Epoch: 8 cost time: 3.5192086696624756
Epoch: 8, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.805 Vali Acc: 0.510 Test Loss: 0.805 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.300201416015625
Epoch: 9, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.811 Vali Acc: 0.560 Test Loss: 0.811 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.515622615814209
Epoch: 10, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.806 Vali Acc: 0.570 Test Loss: 0.806 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.338390350341797
Epoch: 11, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.867 Vali Acc: 0.540 Test Loss: 0.867 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.193808078765869
Epoch: 12, Steps: 18 | Train Loss: 0.355 Vali Loss: 0.887 Vali Acc: 0.500 Test Loss: 0.887 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.234740734100342
Epoch: 13, Steps: 18 | Train Loss: 0.302 Vali Loss: 0.870 Vali Acc: 0.590 Test Loss: 0.870 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.580836296081543
Epoch: 14, Steps: 18 | Train Loss: 0.248 Vali Loss: 0.983 Vali Acc: 0.550 Test Loss: 0.983 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3947865962982178
Epoch: 15, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.087 Vali Acc: 0.470 Test Loss: 1.087 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.29988694190979
Epoch: 16, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.054 Vali Acc: 0.480 Test Loss: 1.054 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.101998805999756
Epoch: 17, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.211 Vali Acc: 0.510 Test Loss: 1.211 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el2_dm16_nh4_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 34978
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.3051118850708
Epoch: 1, Steps: 18 | Train Loss: 1.681 Vali Loss: 3.387 Vali Acc: 0.440 Test Loss: 3.387 Test Acc: 0.440
Validation loss decreased (inf --> -0.439966).  Saving model ...
Epoch: 2 cost time: 6.940108776092529
Epoch: 2, Steps: 18 | Train Loss: 3.192 Vali Loss: 3.274 Vali Acc: 0.530 Test Loss: 3.274 Test Acc: 0.530
Validation loss decreased (-0.439966 --> -0.529967).  Saving model ...
Epoch: 3 cost time: 8.909326791763306
Epoch: 3, Steps: 18 | Train Loss: 2.081 Vali Loss: 6.408 Vali Acc: 0.520 Test Loss: 6.408 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.83589482307434
Epoch: 4, Steps: 18 | Train Loss: 3.242 Vali Loss: 11.460 Vali Acc: 0.510 Test Loss: 11.460 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.37877082824707
Epoch: 5, Steps: 18 | Train Loss: 3.528 Vali Loss: 10.494 Vali Acc: 0.440 Test Loss: 10.494 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.366456508636475
Epoch: 6, Steps: 18 | Train Loss: 1.361 Vali Loss: 16.418 Vali Acc: 0.440 Test Loss: 16.418 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.2997822761535645
Epoch: 7, Steps: 18 | Train Loss: 2.261 Vali Loss: 13.292 Vali Acc: 0.520 Test Loss: 13.292 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.085758209228516
Epoch: 8, Steps: 18 | Train Loss: 2.370 Vali Loss: 9.896 Vali Acc: 0.530 Test Loss: 9.896 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.080806255340576
Epoch: 9, Steps: 18 | Train Loss: 2.195 Vali Loss: 9.667 Vali Acc: 0.500 Test Loss: 9.667 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.342431306838989
Epoch: 10, Steps: 18 | Train Loss: 2.203 Vali Loss: 14.864 Vali Acc: 0.510 Test Loss: 14.864 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.143173933029175
Epoch: 11, Steps: 18 | Train Loss: 3.256 Vali Loss: 21.982 Vali Acc: 0.540 Test Loss: 21.982 Test Acc: 0.540
Validation loss decreased (-0.529967 --> -0.539780).  Saving model ...
Epoch: 12 cost time: 7.980990409851074
Epoch: 12, Steps: 18 | Train Loss: 1.564 Vali Loss: 15.250 Vali Acc: 0.580 Test Loss: 15.250 Test Acc: 0.580
Validation loss decreased (-0.539780 --> -0.579848).  Saving model ...
Epoch: 13 cost time: 8.156555414199829
Epoch: 13, Steps: 18 | Train Loss: 3.700 Vali Loss: 22.466 Vali Acc: 0.420 Test Loss: 22.466 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.124122619628906
Epoch: 14, Steps: 18 | Train Loss: 1.035 Vali Loss: 19.257 Vali Acc: 0.530 Test Loss: 19.257 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.516300201416016
Epoch: 15, Steps: 18 | Train Loss: 1.230 Vali Loss: 25.969 Vali Acc: 0.530 Test Loss: 25.969 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.337116003036499
Epoch: 16, Steps: 18 | Train Loss: 0.969 Vali Loss: 21.456 Vali Acc: 0.560 Test Loss: 21.456 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.111626863479614
Epoch: 17, Steps: 18 | Train Loss: 1.126 Vali Loss: 17.379 Vali Acc: 0.520 Test Loss: 17.379 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.9246985912323
Epoch: 18, Steps: 18 | Train Loss: 1.708 Vali Loss: 26.733 Vali Acc: 0.510 Test Loss: 26.733 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.7186243534088135
Epoch: 19, Steps: 18 | Train Loss: 0.133 Vali Loss: 27.534 Vali Acc: 0.500 Test Loss: 27.534 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.415488243103027
Epoch: 20, Steps: 18 | Train Loss: 0.358 Vali Loss: 28.525 Vali Acc: 0.500 Test Loss: 28.525 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.2926154136657715
Epoch: 21, Steps: 18 | Train Loss: 2.055 Vali Loss: 31.115 Vali Acc: 0.570 Test Loss: 31.115 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.752676725387573
Epoch: 22, Steps: 18 | Train Loss: 1.746 Vali Loss: 20.314 Vali Acc: 0.590 Test Loss: 20.314 Test Acc: 0.590
Validation loss decreased (-0.579848 --> -0.589797).  Saving model ...
Epoch: 23 cost time: 8.702678442001343
Epoch: 23, Steps: 18 | Train Loss: 0.983 Vali Loss: 35.815 Vali Acc: 0.500 Test Loss: 35.815 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.900727033615112
Epoch: 24, Steps: 18 | Train Loss: 0.819 Vali Loss: 26.711 Vali Acc: 0.530 Test Loss: 26.711 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.416243076324463
Epoch: 25, Steps: 18 | Train Loss: 0.459 Vali Loss: 39.355 Vali Acc: 0.530 Test Loss: 39.355 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.127723693847656
Epoch: 26, Steps: 18 | Train Loss: 2.221 Vali Loss: 45.222 Vali Acc: 0.450 Test Loss: 45.222 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.70463752746582
Epoch: 27, Steps: 18 | Train Loss: 1.288 Vali Loss: 48.087 Vali Acc: 0.530 Test Loss: 48.087 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.7373206615448
Epoch: 28, Steps: 18 | Train Loss: 2.070 Vali Loss: 41.575 Vali Acc: 0.470 Test Loss: 41.575 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.383860111236572
Epoch: 29, Steps: 18 | Train Loss: 0.831 Vali Loss: 43.420 Vali Acc: 0.480 Test Loss: 43.420 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.715245485305786
Epoch: 30, Steps: 18 | Train Loss: 0.205 Vali Loss: 44.220 Vali Acc: 0.520 Test Loss: 44.220 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.781282424926758
Epoch: 31, Steps: 18 | Train Loss: 1.241 Vali Loss: 51.372 Vali Acc: 0.510 Test Loss: 51.372 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.743985176086426
Epoch: 32, Steps: 18 | Train Loss: 0.196 Vali Loss: 67.417 Vali Acc: 0.470 Test Loss: 67.417 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1420290
model size : 7.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.40146541595459
Epoch: 1, Steps: 18 | Train Loss: 1.186 Vali Loss: 1.582 Vali Acc: 0.460 Test Loss: 1.582 Test Acc: 0.460
Validation loss decreased (inf --> -0.459984).  Saving model ...
Epoch: 2 cost time: 4.031212091445923
Epoch: 2, Steps: 18 | Train Loss: 1.262 Vali Loss: 2.641 Vali Acc: 0.550 Test Loss: 2.641 Test Acc: 0.550
Validation loss decreased (-0.459984 --> -0.549974).  Saving model ...
Epoch: 3 cost time: 4.975465536117554
Epoch: 3, Steps: 18 | Train Loss: 1.651 Vali Loss: 3.400 Vali Acc: 0.520 Test Loss: 3.400 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.882361888885498
Epoch: 4, Steps: 18 | Train Loss: 1.849 Vali Loss: 3.712 Vali Acc: 0.510 Test Loss: 3.712 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.9903810024261475
Epoch: 5, Steps: 18 | Train Loss: 0.988 Vali Loss: 5.267 Vali Acc: 0.560 Test Loss: 5.267 Test Acc: 0.560
Validation loss decreased (-0.549974 --> -0.559947).  Saving model ...
Epoch: 6 cost time: 5.2231669425964355
Epoch: 6, Steps: 18 | Train Loss: 1.741 Vali Loss: 4.061 Vali Acc: 0.560 Test Loss: 4.061 Test Acc: 0.560
Validation loss decreased (-0.559947 --> -0.559959).  Saving model ...
Epoch: 7 cost time: 4.743452548980713
Epoch: 7, Steps: 18 | Train Loss: 2.171 Vali Loss: 11.980 Vali Acc: 0.510 Test Loss: 11.980 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.907029390335083
Epoch: 8, Steps: 18 | Train Loss: 3.834 Vali Loss: 7.510 Vali Acc: 0.600 Test Loss: 7.510 Test Acc: 0.600
Validation loss decreased (-0.559959 --> -0.599925).  Saving model ...
Epoch: 9 cost time: 5.020459890365601
Epoch: 9, Steps: 18 | Train Loss: 1.760 Vali Loss: 8.002 Vali Acc: 0.560 Test Loss: 8.002 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.980756759643555
Epoch: 10, Steps: 18 | Train Loss: 1.223 Vali Loss: 7.000 Vali Acc: 0.550 Test Loss: 7.000 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.168454885482788
Epoch: 11, Steps: 18 | Train Loss: 1.359 Vali Loss: 10.026 Vali Acc: 0.510 Test Loss: 10.026 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.113473176956177
Epoch: 12, Steps: 18 | Train Loss: 1.075 Vali Loss: 18.185 Vali Acc: 0.520 Test Loss: 18.185 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.895228385925293
Epoch: 13, Steps: 18 | Train Loss: 2.868 Vali Loss: 13.457 Vali Acc: 0.540 Test Loss: 13.457 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.155699729919434
Epoch: 14, Steps: 18 | Train Loss: 1.216 Vali Loss: 12.318 Vali Acc: 0.530 Test Loss: 12.318 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.88038182258606
Epoch: 15, Steps: 18 | Train Loss: 0.999 Vali Loss: 14.979 Vali Acc: 0.510 Test Loss: 14.979 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.876617670059204
Epoch: 16, Steps: 18 | Train Loss: 0.725 Vali Loss: 12.306 Vali Acc: 0.470 Test Loss: 12.306 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.030139923095703
Epoch: 17, Steps: 18 | Train Loss: 0.796 Vali Loss: 15.012 Vali Acc: 0.470 Test Loss: 15.012 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.927723169326782
Epoch: 18, Steps: 18 | Train Loss: 0.415 Vali Loss: 16.052 Vali Acc: 0.470 Test Loss: 16.052 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 807298
model size : 5.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.7541656494140625
Epoch: 1, Steps: 18 | Train Loss: 0.916 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 3.9432575702667236
Epoch: 2, Steps: 18 | Train Loss: 0.970 Vali Loss: 1.128 Vali Acc: 0.540 Test Loss: 1.128 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539989).  Saving model ...
Epoch: 3 cost time: 3.7024080753326416
Epoch: 3, Steps: 18 | Train Loss: 0.898 Vali Loss: 3.815 Vali Acc: 0.450 Test Loss: 3.815 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3720157146453857
Epoch: 4, Steps: 18 | Train Loss: 1.084 Vali Loss: 1.631 Vali Acc: 0.560 Test Loss: 1.631 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559984).  Saving model ...
Epoch: 5 cost time: 3.6147196292877197
Epoch: 5, Steps: 18 | Train Loss: 0.833 Vali Loss: 3.021 Vali Acc: 0.530 Test Loss: 3.021 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.1792614459991455
Epoch: 6, Steps: 18 | Train Loss: 0.847 Vali Loss: 2.757 Vali Acc: 0.570 Test Loss: 2.757 Test Acc: 0.570
Validation loss decreased (-0.559984 --> -0.569972).  Saving model ...
Epoch: 7 cost time: 3.9728245735168457
Epoch: 7, Steps: 18 | Train Loss: 0.568 Vali Loss: 3.084 Vali Acc: 0.560 Test Loss: 3.084 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.495002269744873
Epoch: 8, Steps: 18 | Train Loss: 0.509 Vali Loss: 4.678 Vali Acc: 0.480 Test Loss: 4.678 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.075135707855225
Epoch: 9, Steps: 18 | Train Loss: 0.635 Vali Loss: 5.519 Vali Acc: 0.540 Test Loss: 5.519 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9344165325164795
Epoch: 10, Steps: 18 | Train Loss: 0.557 Vali Loss: 6.153 Vali Acc: 0.450 Test Loss: 6.153 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.7073216438293457
Epoch: 11, Steps: 18 | Train Loss: 1.031 Vali Loss: 7.077 Vali Acc: 0.510 Test Loss: 7.077 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.3255646228790283
Epoch: 12, Steps: 18 | Train Loss: 0.304 Vali Loss: 6.860 Vali Acc: 0.540 Test Loss: 6.860 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.174372434616089
Epoch: 13, Steps: 18 | Train Loss: 0.489 Vali Loss: 5.862 Vali Acc: 0.540 Test Loss: 5.862 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.14215087890625
Epoch: 14, Steps: 18 | Train Loss: 0.803 Vali Loss: 6.002 Vali Acc: 0.500 Test Loss: 6.002 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.625136375427246
Epoch: 15, Steps: 18 | Train Loss: 0.338 Vali Loss: 6.648 Vali Acc: 0.580 Test Loss: 6.648 Test Acc: 0.580
Validation loss decreased (-0.569972 --> -0.579934).  Saving model ...
Epoch: 16 cost time: 3.3120570182800293
Epoch: 16, Steps: 18 | Train Loss: 0.322 Vali Loss: 7.372 Vali Acc: 0.570 Test Loss: 7.372 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.993117332458496
Epoch: 17, Steps: 18 | Train Loss: 1.002 Vali Loss: 11.255 Vali Acc: 0.500 Test Loss: 11.255 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7404067516326904
Epoch: 18, Steps: 18 | Train Loss: 0.532 Vali Loss: 9.672 Vali Acc: 0.490 Test Loss: 9.672 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2285919189453125
Epoch: 19, Steps: 18 | Train Loss: 0.324 Vali Loss: 10.475 Vali Acc: 0.510 Test Loss: 10.475 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.35477614402771
Epoch: 20, Steps: 18 | Train Loss: 0.418 Vali Loss: 9.398 Vali Acc: 0.560 Test Loss: 9.398 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.511979818344116
Epoch: 21, Steps: 18 | Train Loss: 0.777 Vali Loss: 12.850 Vali Acc: 0.540 Test Loss: 12.850 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.407402992248535
Epoch: 22, Steps: 18 | Train Loss: 0.647 Vali Loss: 10.015 Vali Acc: 0.570 Test Loss: 10.015 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.547834873199463
Epoch: 23, Steps: 18 | Train Loss: 0.436 Vali Loss: 12.123 Vali Acc: 0.580 Test Loss: 12.123 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.217435836791992
Epoch: 24, Steps: 18 | Train Loss: 0.475 Vali Loss: 11.492 Vali Acc: 0.600 Test Loss: 11.492 Test Acc: 0.600
Validation loss decreased (-0.579934 --> -0.599885).  Saving model ...
Epoch: 25 cost time: 3.909470796585083
Epoch: 25, Steps: 18 | Train Loss: 0.387 Vali Loss: 11.957 Vali Acc: 0.550 Test Loss: 11.957 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.0259459018707275
Epoch: 26, Steps: 18 | Train Loss: 0.233 Vali Loss: 18.882 Vali Acc: 0.480 Test Loss: 18.882 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.8302083015441895
Epoch: 27, Steps: 18 | Train Loss: 0.474 Vali Loss: 14.500 Vali Acc: 0.490 Test Loss: 14.500 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.040453195571899
Epoch: 28, Steps: 18 | Train Loss: 0.420 Vali Loss: 14.687 Vali Acc: 0.510 Test Loss: 14.687 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.151197910308838
Epoch: 29, Steps: 18 | Train Loss: 0.102 Vali Loss: 18.151 Vali Acc: 0.510 Test Loss: 18.151 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.9390525817871094
Epoch: 30, Steps: 18 | Train Loss: 0.597 Vali Loss: 18.817 Vali Acc: 0.440 Test Loss: 18.817 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.084861755371094
Epoch: 31, Steps: 18 | Train Loss: 0.500 Vali Loss: 18.751 Vali Acc: 0.520 Test Loss: 18.751 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.7877197265625
Epoch: 32, Steps: 18 | Train Loss: 0.516 Vali Loss: 25.765 Vali Acc: 0.500 Test Loss: 25.765 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.747859001159668
Epoch: 33, Steps: 18 | Train Loss: 0.761 Vali Loss: 20.838 Vali Acc: 0.470 Test Loss: 20.838 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.99114727973938
Epoch: 34, Steps: 18 | Train Loss: 0.337 Vali Loss: 19.905 Vali Acc: 0.510 Test Loss: 19.905 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 587522
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.17118239402771
Epoch: 1, Steps: 18 | Train Loss: 0.909 Vali Loss: 0.955 Vali Acc: 0.520 Test Loss: 0.955 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 4.331948518753052
Epoch: 2, Steps: 18 | Train Loss: 1.092 Vali Loss: 2.262 Vali Acc: 0.540 Test Loss: 2.262 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539977).  Saving model ...
Epoch: 3 cost time: 3.780061721801758
Epoch: 3, Steps: 18 | Train Loss: 0.967 Vali Loss: 4.639 Vali Acc: 0.510 Test Loss: 4.639 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.983879566192627
Epoch: 4, Steps: 18 | Train Loss: 1.072 Vali Loss: 1.741 Vali Acc: 0.580 Test Loss: 1.741 Test Acc: 0.580
Validation loss decreased (-0.539977 --> -0.579983).  Saving model ...
Epoch: 5 cost time: 3.6179280281066895
Epoch: 5, Steps: 18 | Train Loss: 1.858 Vali Loss: 3.142 Vali Acc: 0.530 Test Loss: 3.142 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.252227306365967
Epoch: 6, Steps: 18 | Train Loss: 1.434 Vali Loss: 3.251 Vali Acc: 0.540 Test Loss: 3.251 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.023764371871948
Epoch: 7, Steps: 18 | Train Loss: 0.943 Vali Loss: 4.522 Vali Acc: 0.550 Test Loss: 4.522 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.324769020080566
Epoch: 8, Steps: 18 | Train Loss: 1.529 Vali Loss: 4.407 Vali Acc: 0.560 Test Loss: 4.407 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.072165250778198
Epoch: 9, Steps: 18 | Train Loss: 1.542 Vali Loss: 5.264 Vali Acc: 0.500 Test Loss: 5.264 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.2809343338012695
Epoch: 10, Steps: 18 | Train Loss: 0.565 Vali Loss: 5.067 Vali Acc: 0.500 Test Loss: 5.067 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.7922799587249756
Epoch: 11, Steps: 18 | Train Loss: 0.440 Vali Loss: 5.800 Vali Acc: 0.540 Test Loss: 5.800 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.4183642864227295
Epoch: 12, Steps: 18 | Train Loss: 0.464 Vali Loss: 5.901 Vali Acc: 0.510 Test Loss: 5.901 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.151477336883545
Epoch: 13, Steps: 18 | Train Loss: 0.368 Vali Loss: 5.088 Vali Acc: 0.530 Test Loss: 5.088 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.218117713928223
Epoch: 14, Steps: 18 | Train Loss: 0.433 Vali Loss: 5.775 Vali Acc: 0.540 Test Loss: 5.775 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 498818
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.458155632019043
Epoch: 1, Steps: 18 | Train Loss: 0.957 Vali Loss: 0.975 Vali Acc: 0.450 Test Loss: 0.975 Test Acc: 0.450
Validation loss decreased (inf --> -0.449990).  Saving model ...
Epoch: 2 cost time: 3.3773183822631836
Epoch: 2, Steps: 18 | Train Loss: 0.791 Vali Loss: 1.071 Vali Acc: 0.460 Test Loss: 1.071 Test Acc: 0.460
Validation loss decreased (-0.449990 --> -0.459989).  Saving model ...
Epoch: 3 cost time: 3.1023876667022705
Epoch: 3, Steps: 18 | Train Loss: 0.632 Vali Loss: 1.421 Vali Acc: 0.480 Test Loss: 1.421 Test Acc: 0.480
Validation loss decreased (-0.459989 --> -0.479986).  Saving model ...
Epoch: 4 cost time: 3.482887029647827
Epoch: 4, Steps: 18 | Train Loss: 0.661 Vali Loss: 1.520 Vali Acc: 0.510 Test Loss: 1.520 Test Acc: 0.510
Validation loss decreased (-0.479986 --> -0.509985).  Saving model ...
Epoch: 5 cost time: 3.2869675159454346
Epoch: 5, Steps: 18 | Train Loss: 0.874 Vali Loss: 2.081 Vali Acc: 0.450 Test Loss: 2.081 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7762575149536133
Epoch: 6, Steps: 18 | Train Loss: 0.675 Vali Loss: 2.347 Vali Acc: 0.480 Test Loss: 2.347 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.61604380607605
Epoch: 7, Steps: 18 | Train Loss: 0.740 Vali Loss: 3.300 Vali Acc: 0.460 Test Loss: 3.300 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7634079456329346
Epoch: 8, Steps: 18 | Train Loss: 0.501 Vali Loss: 3.063 Vali Acc: 0.530 Test Loss: 3.063 Test Acc: 0.530
Validation loss decreased (-0.509985 --> -0.529969).  Saving model ...
Epoch: 9 cost time: 2.5916435718536377
Epoch: 9, Steps: 18 | Train Loss: 0.877 Vali Loss: 2.445 Vali Acc: 0.500 Test Loss: 2.445 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.59871244430542
Epoch: 10, Steps: 18 | Train Loss: 0.438 Vali Loss: 3.715 Vali Acc: 0.480 Test Loss: 3.715 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.051915168762207
Epoch: 11, Steps: 18 | Train Loss: 0.478 Vali Loss: 4.358 Vali Acc: 0.490 Test Loss: 4.358 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8950088024139404
Epoch: 12, Steps: 18 | Train Loss: 0.480 Vali Loss: 3.574 Vali Acc: 0.510 Test Loss: 3.574 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5341908931732178
Epoch: 13, Steps: 18 | Train Loss: 0.324 Vali Loss: 5.138 Vali Acc: 0.490 Test Loss: 5.138 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.830399990081787
Epoch: 14, Steps: 18 | Train Loss: 0.386 Vali Loss: 5.067 Vali Acc: 0.510 Test Loss: 5.067 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.030595541000366
Epoch: 15, Steps: 18 | Train Loss: 0.613 Vali Loss: 4.968 Vali Acc: 0.510 Test Loss: 4.968 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.7650511264801025
Epoch: 16, Steps: 18 | Train Loss: 0.317 Vali Loss: 5.421 Vali Acc: 0.490 Test Loss: 5.421 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.2950046062469482
Epoch: 17, Steps: 18 | Train Loss: 0.408 Vali Loss: 5.770 Vali Acc: 0.500 Test Loss: 5.770 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3308539390563965
Epoch: 18, Steps: 18 | Train Loss: 0.354 Vali Loss: 4.715 Vali Acc: 0.570 Test Loss: 4.715 Test Acc: 0.570
Validation loss decreased (-0.529969 --> -0.569953).  Saving model ...
Epoch: 19 cost time: 2.560852527618408
Epoch: 19, Steps: 18 | Train Loss: 0.153 Vali Loss: 6.149 Vali Acc: 0.530 Test Loss: 6.149 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7335448265075684
Epoch: 20, Steps: 18 | Train Loss: 0.256 Vali Loss: 8.219 Vali Acc: 0.500 Test Loss: 8.219 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.9934158325195312
Epoch: 21, Steps: 18 | Train Loss: 0.233 Vali Loss: 8.446 Vali Acc: 0.510 Test Loss: 8.446 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.860042095184326
Epoch: 22, Steps: 18 | Train Loss: 0.545 Vali Loss: 7.313 Vali Acc: 0.490 Test Loss: 7.313 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1041882038116455
Epoch: 23, Steps: 18 | Train Loss: 0.268 Vali Loss: 5.829 Vali Acc: 0.520 Test Loss: 5.829 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.130512237548828
Epoch: 24, Steps: 18 | Train Loss: 0.195 Vali Loss: 5.541 Vali Acc: 0.540 Test Loss: 5.541 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.888986110687256
Epoch: 25, Steps: 18 | Train Loss: 0.385 Vali Loss: 7.134 Vali Acc: 0.610 Test Loss: 7.134 Test Acc: 0.610
Validation loss decreased (-0.569953 --> -0.609929).  Saving model ...
Epoch: 26 cost time: 2.747445583343506
Epoch: 26, Steps: 18 | Train Loss: 0.200 Vali Loss: 8.485 Vali Acc: 0.470 Test Loss: 8.485 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.030484437942505
Epoch: 27, Steps: 18 | Train Loss: 0.102 Vali Loss: 7.672 Vali Acc: 0.520 Test Loss: 7.672 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0655555725097656
Epoch: 28, Steps: 18 | Train Loss: 0.071 Vali Loss: 9.285 Vali Acc: 0.500 Test Loss: 9.285 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.454024076461792
Epoch: 29, Steps: 18 | Train Loss: 0.232 Vali Loss: 10.509 Vali Acc: 0.510 Test Loss: 10.509 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.234938621520996
Epoch: 30, Steps: 18 | Train Loss: 0.224 Vali Loss: 8.434 Vali Acc: 0.520 Test Loss: 8.434 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.2882347106933594
Epoch: 31, Steps: 18 | Train Loss: 0.105 Vali Loss: 9.270 Vali Acc: 0.510 Test Loss: 9.270 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.316709518432617
Epoch: 32, Steps: 18 | Train Loss: 0.172 Vali Loss: 8.507 Vali Acc: 0.550 Test Loss: 8.507 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.267260789871216
Epoch: 33, Steps: 18 | Train Loss: 0.156 Vali Loss: 8.740 Vali Acc: 0.520 Test Loss: 8.740 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.607111930847168
Epoch: 34, Steps: 18 | Train Loss: 0.033 Vali Loss: 7.919 Vali Acc: 0.500 Test Loss: 7.919 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.1827950477600098
Epoch: 35, Steps: 18 | Train Loss: 0.205 Vali Loss: 9.665 Vali Acc: 0.540 Test Loss: 9.665 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 403330
model size : 3.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.983874082565308
Epoch: 1, Steps: 18 | Train Loss: 0.879 Vali Loss: 0.829 Vali Acc: 0.520 Test Loss: 0.829 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 2.8830337524414062
Epoch: 2, Steps: 18 | Train Loss: 0.769 Vali Loss: 1.075 Vali Acc: 0.470 Test Loss: 1.075 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8723723888397217
Epoch: 3, Steps: 18 | Train Loss: 0.648 Vali Loss: 1.343 Vali Acc: 0.530 Test Loss: 1.343 Test Acc: 0.530
Validation loss decreased (-0.519992 --> -0.529987).  Saving model ...
Epoch: 4 cost time: 3.3574016094207764
Epoch: 4, Steps: 18 | Train Loss: 0.617 Vali Loss: 1.249 Vali Acc: 0.560 Test Loss: 1.249 Test Acc: 0.560
Validation loss decreased (-0.529987 --> -0.559988).  Saving model ...
Epoch: 5 cost time: 3.1267013549804688
Epoch: 5, Steps: 18 | Train Loss: 0.488 Vali Loss: 1.281 Vali Acc: 0.540 Test Loss: 1.281 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.109488010406494
Epoch: 6, Steps: 18 | Train Loss: 0.478 Vali Loss: 1.429 Vali Acc: 0.630 Test Loss: 1.429 Test Acc: 0.630
Validation loss decreased (-0.559988 --> -0.629986).  Saving model ...
Epoch: 7 cost time: 3.3249635696411133
Epoch: 7, Steps: 18 | Train Loss: 0.379 Vali Loss: 1.223 Vali Acc: 0.640 Test Loss: 1.223 Test Acc: 0.640
Validation loss decreased (-0.629986 --> -0.639988).  Saving model ...
Epoch: 8 cost time: 3.1974196434020996
Epoch: 8, Steps: 18 | Train Loss: 0.490 Vali Loss: 1.863 Vali Acc: 0.500 Test Loss: 1.863 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1024389266967773
Epoch: 9, Steps: 18 | Train Loss: 0.399 Vali Loss: 3.126 Vali Acc: 0.510 Test Loss: 3.126 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8255183696746826
Epoch: 10, Steps: 18 | Train Loss: 0.446 Vali Loss: 2.352 Vali Acc: 0.550 Test Loss: 2.352 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0530169010162354
Epoch: 11, Steps: 18 | Train Loss: 0.329 Vali Loss: 3.193 Vali Acc: 0.490 Test Loss: 3.193 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9484434127807617
Epoch: 12, Steps: 18 | Train Loss: 0.179 Vali Loss: 3.520 Vali Acc: 0.520 Test Loss: 3.520 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.03442645072937
Epoch: 13, Steps: 18 | Train Loss: 0.315 Vali Loss: 2.814 Vali Acc: 0.500 Test Loss: 2.814 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.881263017654419
Epoch: 14, Steps: 18 | Train Loss: 0.734 Vali Loss: 3.315 Vali Acc: 0.500 Test Loss: 3.315 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8772292137145996
Epoch: 15, Steps: 18 | Train Loss: 0.153 Vali Loss: 3.641 Vali Acc: 0.550 Test Loss: 3.641 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7769572734832764
Epoch: 16, Steps: 18 | Train Loss: 0.112 Vali Loss: 4.649 Vali Acc: 0.500 Test Loss: 4.649 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.926774263381958
Epoch: 17, Steps: 18 | Train Loss: 0.427 Vali Loss: 4.297 Vali Acc: 0.540 Test Loss: 4.297 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 373378
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.548455715179443
Epoch: 1, Steps: 18 | Train Loss: 0.813 Vali Loss: 1.180 Vali Acc: 0.490 Test Loss: 1.180 Test Acc: 0.490
Validation loss decreased (inf --> -0.489988).  Saving model ...
Epoch: 2 cost time: 2.560678720474243
Epoch: 2, Steps: 18 | Train Loss: 0.753 Vali Loss: 1.011 Vali Acc: 0.540 Test Loss: 1.011 Test Acc: 0.540
Validation loss decreased (-0.489988 --> -0.539990).  Saving model ...
Epoch: 3 cost time: 2.996001720428467
Epoch: 3, Steps: 18 | Train Loss: 0.653 Vali Loss: 0.987 Vali Acc: 0.600 Test Loss: 0.987 Test Acc: 0.600
Validation loss decreased (-0.539990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 2.854229688644409
Epoch: 4, Steps: 18 | Train Loss: 0.592 Vali Loss: 1.004 Vali Acc: 0.460 Test Loss: 1.004 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.841660976409912
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 1.394 Vali Acc: 0.560 Test Loss: 1.394 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6166467666625977
Epoch: 6, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.808 Vali Acc: 0.470 Test Loss: 1.808 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.865917205810547
Epoch: 7, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.633 Vali Acc: 0.480 Test Loss: 1.633 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7936763763427734
Epoch: 8, Steps: 18 | Train Loss: 0.559 Vali Loss: 1.696 Vali Acc: 0.580 Test Loss: 1.696 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.153949499130249
Epoch: 9, Steps: 18 | Train Loss: 0.328 Vali Loss: 2.217 Vali Acc: 0.530 Test Loss: 2.217 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0216541290283203
Epoch: 10, Steps: 18 | Train Loss: 0.324 Vali Loss: 2.307 Vali Acc: 0.570 Test Loss: 2.307 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.094743013381958
Epoch: 11, Steps: 18 | Train Loss: 0.407 Vali Loss: 2.355 Vali Acc: 0.570 Test Loss: 2.355 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.067152738571167
Epoch: 12, Steps: 18 | Train Loss: 0.489 Vali Loss: 2.673 Vali Acc: 0.490 Test Loss: 2.673 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6491997241973877
Epoch: 13, Steps: 18 | Train Loss: 0.300 Vali Loss: 3.070 Vali Acc: 0.510 Test Loss: 3.070 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 359810
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.4979088306427
Epoch: 1, Steps: 18 | Train Loss: 1.536 Vali Loss: 4.890 Vali Acc: 0.500 Test Loss: 4.890 Test Acc: 0.500
Validation loss decreased (inf --> -0.499951).  Saving model ...
Epoch: 2 cost time: 8.006429433822632
Epoch: 2, Steps: 18 | Train Loss: 2.134 Vali Loss: 2.633 Vali Acc: 0.530 Test Loss: 2.633 Test Acc: 0.530
Validation loss decreased (-0.499951 --> -0.529974).  Saving model ...
Epoch: 3 cost time: 6.850872755050659
Epoch: 3, Steps: 18 | Train Loss: 2.374 Vali Loss: 5.357 Vali Acc: 0.530 Test Loss: 5.357 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.1547911167144775
Epoch: 4, Steps: 18 | Train Loss: 1.397 Vali Loss: 4.281 Vali Acc: 0.510 Test Loss: 4.281 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.699700832366943
Epoch: 5, Steps: 18 | Train Loss: 2.274 Vali Loss: 11.440 Vali Acc: 0.550 Test Loss: 11.440 Test Acc: 0.550
Validation loss decreased (-0.529974 --> -0.549886).  Saving model ...
Epoch: 6 cost time: 7.0134851932525635
Epoch: 6, Steps: 18 | Train Loss: 1.518 Vali Loss: 6.479 Vali Acc: 0.590 Test Loss: 6.479 Test Acc: 0.590
Validation loss decreased (-0.549886 --> -0.589935).  Saving model ...
Epoch: 7 cost time: 6.265933275222778
Epoch: 7, Steps: 18 | Train Loss: 1.537 Vali Loss: 11.640 Vali Acc: 0.460 Test Loss: 11.640 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.231938600540161
Epoch: 8, Steps: 18 | Train Loss: 2.683 Vali Loss: 12.336 Vali Acc: 0.570 Test Loss: 12.336 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.63453483581543
Epoch: 9, Steps: 18 | Train Loss: 2.817 Vali Loss: 12.931 Vali Acc: 0.550 Test Loss: 12.931 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.907716989517212
Epoch: 10, Steps: 18 | Train Loss: 3.020 Vali Loss: 18.155 Vali Acc: 0.490 Test Loss: 18.155 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.094569683074951
Epoch: 11, Steps: 18 | Train Loss: 2.008 Vali Loss: 21.901 Vali Acc: 0.510 Test Loss: 21.901 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.649882793426514
Epoch: 12, Steps: 18 | Train Loss: 3.446 Vali Loss: 20.006 Vali Acc: 0.510 Test Loss: 20.006 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.644162654876709
Epoch: 13, Steps: 18 | Train Loss: 1.031 Vali Loss: 12.325 Vali Acc: 0.520 Test Loss: 12.325 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.618591785430908
Epoch: 14, Steps: 18 | Train Loss: 0.825 Vali Loss: 21.375 Vali Acc: 0.520 Test Loss: 21.375 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.35831880569458
Epoch: 15, Steps: 18 | Train Loss: 1.024 Vali Loss: 27.745 Vali Acc: 0.440 Test Loss: 27.745 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.390219688415527
Epoch: 16, Steps: 18 | Train Loss: 1.949 Vali Loss: 36.238 Vali Acc: 0.550 Test Loss: 36.238 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 1387394
model size : 7.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.2295756340026855
Epoch: 1, Steps: 18 | Train Loss: 1.273 Vali Loss: 2.066 Vali Acc: 0.600 Test Loss: 2.066 Test Acc: 0.600
Validation loss decreased (inf --> -0.599979).  Saving model ...
Epoch: 2 cost time: 3.9800193309783936
Epoch: 2, Steps: 18 | Train Loss: 1.835 Vali Loss: 3.235 Vali Acc: 0.520 Test Loss: 3.235 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.759350538253784
Epoch: 3, Steps: 18 | Train Loss: 1.853 Vali Loss: 4.027 Vali Acc: 0.480 Test Loss: 4.027 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9191253185272217
Epoch: 4, Steps: 18 | Train Loss: 1.953 Vali Loss: 3.510 Vali Acc: 0.490 Test Loss: 3.510 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7117292881011963
Epoch: 5, Steps: 18 | Train Loss: 1.361 Vali Loss: 4.364 Vali Acc: 0.500 Test Loss: 4.364 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.428451776504517
Epoch: 6, Steps: 18 | Train Loss: 1.761 Vali Loss: 4.644 Vali Acc: 0.600 Test Loss: 4.644 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.563291549682617
Epoch: 7, Steps: 18 | Train Loss: 0.910 Vali Loss: 7.430 Vali Acc: 0.520 Test Loss: 7.430 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.953862428665161
Epoch: 8, Steps: 18 | Train Loss: 1.594 Vali Loss: 4.859 Vali Acc: 0.610 Test Loss: 4.859 Test Acc: 0.610
Validation loss decreased (-0.599979 --> -0.609951).  Saving model ...
Epoch: 9 cost time: 3.3513481616973877
Epoch: 9, Steps: 18 | Train Loss: 0.655 Vali Loss: 5.796 Vali Acc: 0.510 Test Loss: 5.796 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.903648614883423
Epoch: 10, Steps: 18 | Train Loss: 0.958 Vali Loss: 6.562 Vali Acc: 0.590 Test Loss: 6.562 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.033297061920166
Epoch: 11, Steps: 18 | Train Loss: 1.138 Vali Loss: 16.566 Vali Acc: 0.520 Test Loss: 16.566 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.321386337280273
Epoch: 12, Steps: 18 | Train Loss: 2.314 Vali Loss: 8.127 Vali Acc: 0.560 Test Loss: 8.127 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.281625270843506
Epoch: 13, Steps: 18 | Train Loss: 2.088 Vali Loss: 8.362 Vali Acc: 0.550 Test Loss: 8.362 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.502493143081665
Epoch: 14, Steps: 18 | Train Loss: 1.745 Vali Loss: 9.726 Vali Acc: 0.590 Test Loss: 9.726 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.498837232589722
Epoch: 15, Steps: 18 | Train Loss: 0.550 Vali Loss: 9.737 Vali Acc: 0.570 Test Loss: 9.737 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.396800994873047
Epoch: 16, Steps: 18 | Train Loss: 0.567 Vali Loss: 13.675 Vali Acc: 0.500 Test Loss: 13.675 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.3310980796813965
Epoch: 17, Steps: 18 | Train Loss: 0.624 Vali Loss: 18.713 Vali Acc: 0.480 Test Loss: 18.713 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.926029920578003
Epoch: 18, Steps: 18 | Train Loss: 0.854 Vali Loss: 23.488 Vali Acc: 0.450 Test Loss: 23.488 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 774402
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.113009214401245
Epoch: 1, Steps: 18 | Train Loss: 0.972 Vali Loss: 1.443 Vali Acc: 0.490 Test Loss: 1.443 Test Acc: 0.490
Validation loss decreased (inf --> -0.489986).  Saving model ...
Epoch: 2 cost time: 3.937039375305176
Epoch: 2, Steps: 18 | Train Loss: 0.986 Vali Loss: 1.966 Vali Acc: 0.460 Test Loss: 1.966 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.127500295639038
Epoch: 3, Steps: 18 | Train Loss: 1.560 Vali Loss: 3.867 Vali Acc: 0.420 Test Loss: 3.867 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6904962062835693
Epoch: 4, Steps: 18 | Train Loss: 0.819 Vali Loss: 2.364 Vali Acc: 0.600 Test Loss: 2.364 Test Acc: 0.600
Validation loss decreased (-0.489986 --> -0.599976).  Saving model ...
Epoch: 5 cost time: 3.7751355171203613
Epoch: 5, Steps: 18 | Train Loss: 1.101 Vali Loss: 2.734 Vali Acc: 0.520 Test Loss: 2.734 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8220090866088867
Epoch: 6, Steps: 18 | Train Loss: 0.981 Vali Loss: 3.987 Vali Acc: 0.560 Test Loss: 3.987 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7387077808380127
Epoch: 7, Steps: 18 | Train Loss: 0.569 Vali Loss: 3.207 Vali Acc: 0.570 Test Loss: 3.207 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.245737552642822
Epoch: 8, Steps: 18 | Train Loss: 1.235 Vali Loss: 7.242 Vali Acc: 0.500 Test Loss: 7.242 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.919914960861206
Epoch: 9, Steps: 18 | Train Loss: 0.650 Vali Loss: 4.751 Vali Acc: 0.520 Test Loss: 4.751 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.948751211166382
Epoch: 10, Steps: 18 | Train Loss: 0.546 Vali Loss: 4.143 Vali Acc: 0.660 Test Loss: 4.143 Test Acc: 0.660
Validation loss decreased (-0.599976 --> -0.659959).  Saving model ...
Epoch: 11 cost time: 3.806511640548706
Epoch: 11, Steps: 18 | Train Loss: 0.763 Vali Loss: 7.990 Vali Acc: 0.570 Test Loss: 7.990 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7256693840026855
Epoch: 12, Steps: 18 | Train Loss: 0.743 Vali Loss: 8.379 Vali Acc: 0.530 Test Loss: 8.379 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.67402982711792
Epoch: 13, Steps: 18 | Train Loss: 0.446 Vali Loss: 6.165 Vali Acc: 0.570 Test Loss: 6.165 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.9762325286865234
Epoch: 14, Steps: 18 | Train Loss: 0.434 Vali Loss: 8.585 Vali Acc: 0.520 Test Loss: 8.585 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.149442195892334
Epoch: 15, Steps: 18 | Train Loss: 0.477 Vali Loss: 9.936 Vali Acc: 0.530 Test Loss: 9.936 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.314882278442383
Epoch: 16, Steps: 18 | Train Loss: 1.288 Vali Loss: 9.404 Vali Acc: 0.500 Test Loss: 9.404 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.664285898208618
Epoch: 17, Steps: 18 | Train Loss: 0.376 Vali Loss: 7.005 Vali Acc: 0.540 Test Loss: 7.005 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4066503047943115
Epoch: 18, Steps: 18 | Train Loss: 0.389 Vali Loss: 9.586 Vali Acc: 0.530 Test Loss: 9.586 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.9796555042266846
Epoch: 19, Steps: 18 | Train Loss: 0.577 Vali Loss: 10.476 Vali Acc: 0.570 Test Loss: 10.476 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.579530954360962
Epoch: 20, Steps: 18 | Train Loss: 0.612 Vali Loss: 10.865 Vali Acc: 0.560 Test Loss: 10.865 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 554626
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.996945142745972
Epoch: 1, Steps: 18 | Train Loss: 0.974 Vali Loss: 0.829 Vali Acc: 0.580 Test Loss: 0.829 Test Acc: 0.580
Validation loss decreased (inf --> -0.579992).  Saving model ...
Epoch: 2 cost time: 3.676067590713501
Epoch: 2, Steps: 18 | Train Loss: 0.978 Vali Loss: 2.164 Vali Acc: 0.460 Test Loss: 2.164 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0114238262176514
Epoch: 3, Steps: 18 | Train Loss: 1.070 Vali Loss: 1.684 Vali Acc: 0.490 Test Loss: 1.684 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.1980934143066406
Epoch: 4, Steps: 18 | Train Loss: 0.659 Vali Loss: 2.989 Vali Acc: 0.490 Test Loss: 2.989 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.38661789894104
Epoch: 5, Steps: 18 | Train Loss: 1.120 Vali Loss: 1.935 Vali Acc: 0.570 Test Loss: 1.935 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0783681869506836
Epoch: 6, Steps: 18 | Train Loss: 0.761 Vali Loss: 2.798 Vali Acc: 0.560 Test Loss: 2.798 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.161851406097412
Epoch: 7, Steps: 18 | Train Loss: 1.588 Vali Loss: 5.576 Vali Acc: 0.480 Test Loss: 5.576 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.347297191619873
Epoch: 8, Steps: 18 | Train Loss: 0.858 Vali Loss: 4.864 Vali Acc: 0.530 Test Loss: 4.864 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.2136478424072266
Epoch: 9, Steps: 18 | Train Loss: 0.629 Vali Loss: 4.933 Vali Acc: 0.470 Test Loss: 4.933 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.111588478088379
Epoch: 10, Steps: 18 | Train Loss: 0.884 Vali Loss: 5.050 Vali Acc: 0.530 Test Loss: 5.050 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.3086421489715576
Epoch: 11, Steps: 18 | Train Loss: 0.643 Vali Loss: 3.764 Vali Acc: 0.610 Test Loss: 3.764 Test Acc: 0.610
Validation loss decreased (-0.579992 --> -0.609962).  Saving model ...
Epoch: 12 cost time: 3.417454957962036
Epoch: 12, Steps: 18 | Train Loss: 0.650 Vali Loss: 4.591 Vali Acc: 0.490 Test Loss: 4.591 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3930256366729736
Epoch: 13, Steps: 18 | Train Loss: 0.280 Vali Loss: 8.058 Vali Acc: 0.470 Test Loss: 8.058 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6153218746185303
Epoch: 14, Steps: 18 | Train Loss: 0.366 Vali Loss: 6.052 Vali Acc: 0.510 Test Loss: 6.052 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.783479690551758
Epoch: 15, Steps: 18 | Train Loss: 0.341 Vali Loss: 5.199 Vali Acc: 0.560 Test Loss: 5.199 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.4305803775787354
Epoch: 16, Steps: 18 | Train Loss: 0.344 Vali Loss: 5.739 Vali Acc: 0.550 Test Loss: 5.739 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.096916198730469
Epoch: 17, Steps: 18 | Train Loss: 0.642 Vali Loss: 8.559 Vali Acc: 0.540 Test Loss: 8.559 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.1964755058288574
Epoch: 18, Steps: 18 | Train Loss: 0.909 Vali Loss: 10.254 Vali Acc: 0.530 Test Loss: 10.254 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9108564853668213
Epoch: 19, Steps: 18 | Train Loss: 0.451 Vali Loss: 11.898 Vali Acc: 0.440 Test Loss: 11.898 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.793691635131836
Epoch: 20, Steps: 18 | Train Loss: 0.268 Vali Loss: 14.037 Vali Acc: 0.480 Test Loss: 14.037 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.027853012084961
Epoch: 21, Steps: 18 | Train Loss: 0.323 Vali Loss: 9.377 Vali Acc: 0.490 Test Loss: 9.377 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 465922
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.080350637435913
Epoch: 1, Steps: 18 | Train Loss: 0.970 Vali Loss: 0.788 Vali Acc: 0.500 Test Loss: 0.788 Test Acc: 0.500
Validation loss decreased (inf --> -0.499992).  Saving model ...
Epoch: 2 cost time: 2.7098469734191895
Epoch: 2, Steps: 18 | Train Loss: 0.810 Vali Loss: 0.844 Vali Acc: 0.510 Test Loss: 0.844 Test Acc: 0.510
Validation loss decreased (-0.499992 --> -0.509992).  Saving model ...
Epoch: 3 cost time: 2.933230400085449
Epoch: 3, Steps: 18 | Train Loss: 0.792 Vali Loss: 1.032 Vali Acc: 0.510 Test Loss: 1.032 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8591108322143555
Epoch: 4, Steps: 18 | Train Loss: 0.674 Vali Loss: 2.078 Vali Acc: 0.500 Test Loss: 2.078 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1171212196350098
Epoch: 5, Steps: 18 | Train Loss: 0.537 Vali Loss: 2.235 Vali Acc: 0.530 Test Loss: 2.235 Test Acc: 0.530
Validation loss decreased (-0.509992 --> -0.529978).  Saving model ...
Epoch: 6 cost time: 2.6881136894226074
Epoch: 6, Steps: 18 | Train Loss: 0.641 Vali Loss: 1.995 Vali Acc: 0.470 Test Loss: 1.995 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8822810649871826
Epoch: 7, Steps: 18 | Train Loss: 0.439 Vali Loss: 2.636 Vali Acc: 0.510 Test Loss: 2.636 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.547851085662842
Epoch: 8, Steps: 18 | Train Loss: 0.463 Vali Loss: 2.452 Vali Acc: 0.560 Test Loss: 2.452 Test Acc: 0.560
Validation loss decreased (-0.529978 --> -0.559975).  Saving model ...
Epoch: 9 cost time: 3.128579616546631
Epoch: 9, Steps: 18 | Train Loss: 0.530 Vali Loss: 2.767 Vali Acc: 0.530 Test Loss: 2.767 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.01922607421875
Epoch: 10, Steps: 18 | Train Loss: 0.561 Vali Loss: 3.680 Vali Acc: 0.490 Test Loss: 3.680 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9214913845062256
Epoch: 11, Steps: 18 | Train Loss: 0.416 Vali Loss: 3.732 Vali Acc: 0.500 Test Loss: 3.732 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8641421794891357
Epoch: 12, Steps: 18 | Train Loss: 0.416 Vali Loss: 4.586 Vali Acc: 0.470 Test Loss: 4.586 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.929924964904785
Epoch: 13, Steps: 18 | Train Loss: 0.334 Vali Loss: 3.664 Vali Acc: 0.530 Test Loss: 3.664 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.131815195083618
Epoch: 14, Steps: 18 | Train Loss: 0.340 Vali Loss: 5.080 Vali Acc: 0.520 Test Loss: 5.080 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.1139166355133057
Epoch: 15, Steps: 18 | Train Loss: 0.521 Vali Loss: 4.105 Vali Acc: 0.540 Test Loss: 4.105 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9577038288116455
Epoch: 16, Steps: 18 | Train Loss: 0.249 Vali Loss: 5.726 Vali Acc: 0.530 Test Loss: 5.726 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9120566844940186
Epoch: 17, Steps: 18 | Train Loss: 0.167 Vali Loss: 5.572 Vali Acc: 0.510 Test Loss: 5.572 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8670077323913574
Epoch: 18, Steps: 18 | Train Loss: 0.415 Vali Loss: 7.516 Vali Acc: 0.490 Test Loss: 7.516 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 370434
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.226059198379517
Epoch: 1, Steps: 18 | Train Loss: 0.852 Vali Loss: 1.012 Vali Acc: 0.510 Test Loss: 1.012 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 3.387686252593994
Epoch: 2, Steps: 18 | Train Loss: 0.890 Vali Loss: 1.388 Vali Acc: 0.520 Test Loss: 1.388 Test Acc: 0.520
Validation loss decreased (-0.509990 --> -0.519986).  Saving model ...
Epoch: 3 cost time: 3.0318403244018555
Epoch: 3, Steps: 18 | Train Loss: 0.761 Vali Loss: 1.262 Vali Acc: 0.550 Test Loss: 1.262 Test Acc: 0.550
Validation loss decreased (-0.519986 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 2.8698220252990723
Epoch: 4, Steps: 18 | Train Loss: 0.728 Vali Loss: 1.771 Vali Acc: 0.450 Test Loss: 1.771 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.531707525253296
Epoch: 5, Steps: 18 | Train Loss: 0.730 Vali Loss: 1.363 Vali Acc: 0.650 Test Loss: 1.363 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649986).  Saving model ...
Epoch: 6 cost time: 3.0751543045043945
Epoch: 6, Steps: 18 | Train Loss: 0.475 Vali Loss: 1.329 Vali Acc: 0.580 Test Loss: 1.329 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.584324836730957
Epoch: 7, Steps: 18 | Train Loss: 0.431 Vali Loss: 1.979 Vali Acc: 0.520 Test Loss: 1.979 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5203728675842285
Epoch: 8, Steps: 18 | Train Loss: 0.509 Vali Loss: 2.183 Vali Acc: 0.500 Test Loss: 2.183 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.0438218116760254
Epoch: 9, Steps: 18 | Train Loss: 0.397 Vali Loss: 2.442 Vali Acc: 0.440 Test Loss: 2.442 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1997900009155273
Epoch: 10, Steps: 18 | Train Loss: 0.406 Vali Loss: 2.762 Vali Acc: 0.500 Test Loss: 2.762 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1144344806671143
Epoch: 11, Steps: 18 | Train Loss: 0.300 Vali Loss: 3.175 Vali Acc: 0.500 Test Loss: 3.175 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.274435520172119
Epoch: 12, Steps: 18 | Train Loss: 0.419 Vali Loss: 3.675 Vali Acc: 0.540 Test Loss: 3.675 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.48197603225708
Epoch: 13, Steps: 18 | Train Loss: 0.418 Vali Loss: 3.645 Vali Acc: 0.530 Test Loss: 3.645 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.3257131576538086
Epoch: 14, Steps: 18 | Train Loss: 0.321 Vali Loss: 4.589 Vali Acc: 0.450 Test Loss: 4.589 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.720492362976074
Epoch: 15, Steps: 18 | Train Loss: 0.306 Vali Loss: 3.977 Vali Acc: 0.540 Test Loss: 3.977 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 340482
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.350888967514038
Epoch: 1, Steps: 18 | Train Loss: 0.806 Vali Loss: 0.744 Vali Acc: 0.570 Test Loss: 0.744 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.8228299617767334
Epoch: 2, Steps: 18 | Train Loss: 0.784 Vali Loss: 1.270 Vali Acc: 0.440 Test Loss: 1.270 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.588643789291382
Epoch: 3, Steps: 18 | Train Loss: 0.589 Vali Loss: 1.459 Vali Acc: 0.450 Test Loss: 1.459 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7747128009796143
Epoch: 4, Steps: 18 | Train Loss: 0.686 Vali Loss: 1.163 Vali Acc: 0.520 Test Loss: 1.163 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.613555431365967
Epoch: 5, Steps: 18 | Train Loss: 0.531 Vali Loss: 1.721 Vali Acc: 0.570 Test Loss: 1.721 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.1518447399139404
Epoch: 6, Steps: 18 | Train Loss: 0.587 Vali Loss: 2.338 Vali Acc: 0.510 Test Loss: 2.338 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.803459882736206
Epoch: 7, Steps: 18 | Train Loss: 0.529 Vali Loss: 1.735 Vali Acc: 0.530 Test Loss: 1.735 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.848891019821167
Epoch: 8, Steps: 18 | Train Loss: 0.433 Vali Loss: 1.646 Vali Acc: 0.560 Test Loss: 1.646 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8141379356384277
Epoch: 9, Steps: 18 | Train Loss: 0.317 Vali Loss: 2.175 Vali Acc: 0.490 Test Loss: 2.175 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.210080146789551
Epoch: 10, Steps: 18 | Train Loss: 0.336 Vali Loss: 2.303 Vali Acc: 0.530 Test Loss: 2.303 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.625478982925415
Epoch: 11, Steps: 18 | Train Loss: 0.467 Vali Loss: 3.025 Vali Acc: 0.520 Test Loss: 3.025 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 326914
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.430262327194214
Epoch: 1, Steps: 18 | Train Loss: 1.496 Vali Loss: 3.509 Vali Acc: 0.550 Test Loss: 3.509 Test Acc: 0.550
Validation loss decreased (inf --> -0.549965).  Saving model ...
Epoch: 2 cost time: 5.930678606033325
Epoch: 2, Steps: 18 | Train Loss: 1.616 Vali Loss: 5.970 Vali Acc: 0.530 Test Loss: 5.970 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.915680646896362
Epoch: 3, Steps: 18 | Train Loss: 2.693 Vali Loss: 5.548 Vali Acc: 0.600 Test Loss: 5.548 Test Acc: 0.600
Validation loss decreased (-0.549965 --> -0.599945).  Saving model ...
Epoch: 4 cost time: 5.845209360122681
Epoch: 4, Steps: 18 | Train Loss: 3.051 Vali Loss: 8.665 Vali Acc: 0.630 Test Loss: 8.665 Test Acc: 0.630
Validation loss decreased (-0.599945 --> -0.629913).  Saving model ...
Epoch: 5 cost time: 6.061129570007324
Epoch: 5, Steps: 18 | Train Loss: 2.090 Vali Loss: 5.219 Vali Acc: 0.610 Test Loss: 5.219 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.750290155410767
Epoch: 6, Steps: 18 | Train Loss: 2.221 Vali Loss: 14.043 Vali Acc: 0.530 Test Loss: 14.043 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.125118970870972
Epoch: 7, Steps: 18 | Train Loss: 2.227 Vali Loss: 5.894 Vali Acc: 0.530 Test Loss: 5.894 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.113635301589966
Epoch: 8, Steps: 18 | Train Loss: 4.442 Vali Loss: 22.646 Vali Acc: 0.540 Test Loss: 22.646 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.295914173126221
Epoch: 9, Steps: 18 | Train Loss: 3.274 Vali Loss: 11.874 Vali Acc: 0.480 Test Loss: 11.874 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.237091064453125
Epoch: 10, Steps: 18 | Train Loss: 2.130 Vali Loss: 18.201 Vali Acc: 0.480 Test Loss: 18.201 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.555490016937256
Epoch: 11, Steps: 18 | Train Loss: 2.050 Vali Loss: 27.816 Vali Acc: 0.530 Test Loss: 27.816 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.489293575286865
Epoch: 12, Steps: 18 | Train Loss: 2.138 Vali Loss: 23.301 Vali Acc: 0.480 Test Loss: 23.301 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.063502788543701
Epoch: 13, Steps: 18 | Train Loss: 0.734 Vali Loss: 17.564 Vali Acc: 0.490 Test Loss: 17.564 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.11600136756897
Epoch: 14, Steps: 18 | Train Loss: 1.211 Vali Loss: 28.276 Vali Acc: 0.500 Test Loss: 28.276 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 1370946
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.009230375289917
Epoch: 1, Steps: 18 | Train Loss: 1.108 Vali Loss: 1.620 Vali Acc: 0.530 Test Loss: 1.620 Test Acc: 0.530
Validation loss decreased (inf --> -0.529984).  Saving model ...
Epoch: 2 cost time: 4.038710832595825
Epoch: 2, Steps: 18 | Train Loss: 1.583 Vali Loss: 4.191 Vali Acc: 0.480 Test Loss: 4.191 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.343255281448364
Epoch: 3, Steps: 18 | Train Loss: 1.771 Vali Loss: 3.848 Vali Acc: 0.530 Test Loss: 3.848 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.572716951370239
Epoch: 4, Steps: 18 | Train Loss: 2.089 Vali Loss: 4.695 Vali Acc: 0.530 Test Loss: 4.695 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.006857633590698
Epoch: 5, Steps: 18 | Train Loss: 2.096 Vali Loss: 5.678 Vali Acc: 0.480 Test Loss: 5.678 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.428925275802612
Epoch: 6, Steps: 18 | Train Loss: 1.834 Vali Loss: 4.606 Vali Acc: 0.520 Test Loss: 4.606 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.401876449584961
Epoch: 7, Steps: 18 | Train Loss: 1.989 Vali Loss: 8.629 Vali Acc: 0.520 Test Loss: 8.629 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.241951942443848
Epoch: 8, Steps: 18 | Train Loss: 1.403 Vali Loss: 6.289 Vali Acc: 0.530 Test Loss: 6.289 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.332253932952881
Epoch: 9, Steps: 18 | Train Loss: 1.819 Vali Loss: 7.497 Vali Acc: 0.530 Test Loss: 7.497 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.148191213607788
Epoch: 10, Steps: 18 | Train Loss: 1.557 Vali Loss: 7.798 Vali Acc: 0.530 Test Loss: 7.798 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.167119264602661
Epoch: 11, Steps: 18 | Train Loss: 0.736 Vali Loss: 7.259 Vali Acc: 0.540 Test Loss: 7.259 Test Acc: 0.540
Validation loss decreased (-0.529984 --> -0.539927).  Saving model ...
Epoch: 12 cost time: 3.51328182220459
Epoch: 12, Steps: 18 | Train Loss: 1.009 Vali Loss: 11.184 Vali Acc: 0.540 Test Loss: 11.184 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6768083572387695
Epoch: 13, Steps: 18 | Train Loss: 1.234 Vali Loss: 10.789 Vali Acc: 0.480 Test Loss: 10.789 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.207440614700317
Epoch: 14, Steps: 18 | Train Loss: 1.115 Vali Loss: 15.455 Vali Acc: 0.460 Test Loss: 15.455 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.758422374725342
Epoch: 15, Steps: 18 | Train Loss: 1.195 Vali Loss: 17.266 Vali Acc: 0.450 Test Loss: 17.266 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.696420907974243
Epoch: 16, Steps: 18 | Train Loss: 1.043 Vali Loss: 12.948 Vali Acc: 0.520 Test Loss: 12.948 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.166073560714722
Epoch: 17, Steps: 18 | Train Loss: 0.564 Vali Loss: 10.736 Vali Acc: 0.530 Test Loss: 10.736 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.752310037612915
Epoch: 18, Steps: 18 | Train Loss: 0.576 Vali Loss: 10.586 Vali Acc: 0.550 Test Loss: 10.586 Test Acc: 0.550
Validation loss decreased (-0.539927 --> -0.549894).  Saving model ...
Epoch: 19 cost time: 3.637497663497925
Epoch: 19, Steps: 18 | Train Loss: 0.611 Vali Loss: 10.480 Vali Acc: 0.610 Test Loss: 10.480 Test Acc: 0.610
Validation loss decreased (-0.549894 --> -0.609895).  Saving model ...
Epoch: 20 cost time: 4.515469074249268
Epoch: 20, Steps: 18 | Train Loss: 0.262 Vali Loss: 16.756 Vali Acc: 0.580 Test Loss: 16.756 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.942643165588379
Epoch: 21, Steps: 18 | Train Loss: 1.860 Vali Loss: 17.370 Vali Acc: 0.500 Test Loss: 17.370 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.359650135040283
Epoch: 22, Steps: 18 | Train Loss: 1.245 Vali Loss: 21.894 Vali Acc: 0.480 Test Loss: 21.894 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.279226779937744
Epoch: 23, Steps: 18 | Train Loss: 0.883 Vali Loss: 19.298 Vali Acc: 0.520 Test Loss: 19.298 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.26173210144043
Epoch: 24, Steps: 18 | Train Loss: 0.231 Vali Loss: 15.869 Vali Acc: 0.560 Test Loss: 15.869 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.93725323677063
Epoch: 25, Steps: 18 | Train Loss: 0.390 Vali Loss: 20.450 Vali Acc: 0.490 Test Loss: 20.450 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.101136684417725
Epoch: 26, Steps: 18 | Train Loss: 1.000 Vali Loss: 27.261 Vali Acc: 0.500 Test Loss: 27.261 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.684136152267456
Epoch: 27, Steps: 18 | Train Loss: 0.318 Vali Loss: 33.172 Vali Acc: 0.470 Test Loss: 33.172 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.8688511848449707
Epoch: 28, Steps: 18 | Train Loss: 0.399 Vali Loss: 28.828 Vali Acc: 0.470 Test Loss: 28.828 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.8347017765045166
Epoch: 29, Steps: 18 | Train Loss: 0.422 Vali Loss: 27.317 Vali Acc: 0.490 Test Loss: 27.317 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 757954
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.607887506484985
Epoch: 1, Steps: 18 | Train Loss: 0.955 Vali Loss: 1.493 Vali Acc: 0.510 Test Loss: 1.493 Test Acc: 0.510
Validation loss decreased (inf --> -0.509985).  Saving model ...
Epoch: 2 cost time: 3.4784610271453857
Epoch: 2, Steps: 18 | Train Loss: 0.932 Vali Loss: 1.215 Vali Acc: 0.540 Test Loss: 1.215 Test Acc: 0.540
Validation loss decreased (-0.509985 --> -0.539988).  Saving model ...
Epoch: 3 cost time: 3.7899043560028076
Epoch: 3, Steps: 18 | Train Loss: 1.290 Vali Loss: 2.876 Vali Acc: 0.460 Test Loss: 2.876 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6586287021636963
Epoch: 4, Steps: 18 | Train Loss: 1.749 Vali Loss: 3.022 Vali Acc: 0.550 Test Loss: 3.022 Test Acc: 0.550
Validation loss decreased (-0.539988 --> -0.549970).  Saving model ...
Epoch: 5 cost time: 3.569056510925293
Epoch: 5, Steps: 18 | Train Loss: 1.174 Vali Loss: 6.063 Vali Acc: 0.540 Test Loss: 6.063 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4804296493530273
Epoch: 6, Steps: 18 | Train Loss: 1.552 Vali Loss: 3.881 Vali Acc: 0.490 Test Loss: 3.881 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3881924152374268
Epoch: 7, Steps: 18 | Train Loss: 1.067 Vali Loss: 8.792 Vali Acc: 0.470 Test Loss: 8.792 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1324169635772705
Epoch: 8, Steps: 18 | Train Loss: 0.759 Vali Loss: 5.585 Vali Acc: 0.530 Test Loss: 5.585 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.456681966781616
Epoch: 9, Steps: 18 | Train Loss: 1.475 Vali Loss: 5.119 Vali Acc: 0.500 Test Loss: 5.119 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.508849859237671
Epoch: 10, Steps: 18 | Train Loss: 0.683 Vali Loss: 7.012 Vali Acc: 0.500 Test Loss: 7.012 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.523326873779297
Epoch: 11, Steps: 18 | Train Loss: 0.628 Vali Loss: 7.804 Vali Acc: 0.530 Test Loss: 7.804 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.336277961730957
Epoch: 12, Steps: 18 | Train Loss: 0.706 Vali Loss: 8.459 Vali Acc: 0.480 Test Loss: 8.459 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.553680658340454
Epoch: 13, Steps: 18 | Train Loss: 0.772 Vali Loss: 7.590 Vali Acc: 0.500 Test Loss: 7.590 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.0668835639953613
Epoch: 14, Steps: 18 | Train Loss: 0.412 Vali Loss: 7.278 Vali Acc: 0.560 Test Loss: 7.278 Test Acc: 0.560
Validation loss decreased (-0.549970 --> -0.559927).  Saving model ...
Epoch: 15 cost time: 3.563535451889038
Epoch: 15, Steps: 18 | Train Loss: 0.572 Vali Loss: 6.677 Vali Acc: 0.520 Test Loss: 6.677 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6759626865386963
Epoch: 16, Steps: 18 | Train Loss: 0.615 Vali Loss: 8.619 Vali Acc: 0.530 Test Loss: 8.619 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.690765619277954
Epoch: 17, Steps: 18 | Train Loss: 1.085 Vali Loss: 16.193 Vali Acc: 0.470 Test Loss: 16.193 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.762533187866211
Epoch: 18, Steps: 18 | Train Loss: 0.614 Vali Loss: 9.986 Vali Acc: 0.560 Test Loss: 9.986 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.568351984024048
Epoch: 19, Steps: 18 | Train Loss: 0.524 Vali Loss: 11.750 Vali Acc: 0.470 Test Loss: 11.750 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7486469745635986
Epoch: 20, Steps: 18 | Train Loss: 0.218 Vali Loss: 10.883 Vali Acc: 0.520 Test Loss: 10.883 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6791505813598633
Epoch: 21, Steps: 18 | Train Loss: 0.337 Vali Loss: 10.886 Vali Acc: 0.570 Test Loss: 10.886 Test Acc: 0.570
Validation loss decreased (-0.559927 --> -0.569891).  Saving model ...
Epoch: 22 cost time: 3.304485559463501
Epoch: 22, Steps: 18 | Train Loss: 0.279 Vali Loss: 13.290 Vali Acc: 0.510 Test Loss: 13.290 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.929276704788208
Epoch: 23, Steps: 18 | Train Loss: 0.571 Vali Loss: 14.803 Vali Acc: 0.500 Test Loss: 14.803 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2694427967071533
Epoch: 24, Steps: 18 | Train Loss: 0.419 Vali Loss: 13.553 Vali Acc: 0.490 Test Loss: 13.553 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.453758478164673
Epoch: 25, Steps: 18 | Train Loss: 0.491 Vali Loss: 13.261 Vali Acc: 0.520 Test Loss: 13.261 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.631636381149292
Epoch: 26, Steps: 18 | Train Loss: 0.670 Vali Loss: 12.506 Vali Acc: 0.530 Test Loss: 12.506 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.4568703174591064
Epoch: 27, Steps: 18 | Train Loss: 0.733 Vali Loss: 14.137 Vali Acc: 0.540 Test Loss: 14.137 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.553914785385132
Epoch: 28, Steps: 18 | Train Loss: 0.429 Vali Loss: 12.528 Vali Acc: 0.530 Test Loss: 12.528 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.6690924167633057
Epoch: 29, Steps: 18 | Train Loss: 0.499 Vali Loss: 11.578 Vali Acc: 0.500 Test Loss: 11.578 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.5674731731414795
Epoch: 30, Steps: 18 | Train Loss: 0.459 Vali Loss: 12.410 Vali Acc: 0.550 Test Loss: 12.410 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.4232120513916016
Epoch: 31, Steps: 18 | Train Loss: 0.396 Vali Loss: 12.825 Vali Acc: 0.550 Test Loss: 12.825 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 538178
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.709649562835693
Epoch: 1, Steps: 18 | Train Loss: 1.089 Vali Loss: 1.569 Vali Acc: 0.450 Test Loss: 1.569 Test Acc: 0.450
Validation loss decreased (inf --> -0.449984).  Saving model ...
Epoch: 2 cost time: 3.263261556625366
Epoch: 2, Steps: 18 | Train Loss: 1.191 Vali Loss: 1.008 Vali Acc: 0.530 Test Loss: 1.008 Test Acc: 0.530
Validation loss decreased (-0.449984 --> -0.529990).  Saving model ...
Epoch: 3 cost time: 2.8479716777801514
Epoch: 3, Steps: 18 | Train Loss: 1.143 Vali Loss: 1.943 Vali Acc: 0.470 Test Loss: 1.943 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9213643074035645
Epoch: 4, Steps: 18 | Train Loss: 0.866 Vali Loss: 1.931 Vali Acc: 0.510 Test Loss: 1.931 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.014822244644165
Epoch: 5, Steps: 18 | Train Loss: 1.198 Vali Loss: 2.012 Vali Acc: 0.640 Test Loss: 2.012 Test Acc: 0.640
Validation loss decreased (-0.529990 --> -0.639980).  Saving model ...
Epoch: 6 cost time: 2.9360504150390625
Epoch: 6, Steps: 18 | Train Loss: 0.657 Vali Loss: 3.176 Vali Acc: 0.520 Test Loss: 3.176 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.07136607170105
Epoch: 7, Steps: 18 | Train Loss: 0.932 Vali Loss: 2.596 Vali Acc: 0.570 Test Loss: 2.596 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0973215103149414
Epoch: 8, Steps: 18 | Train Loss: 0.418 Vali Loss: 2.855 Vali Acc: 0.540 Test Loss: 2.855 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.246176242828369
Epoch: 9, Steps: 18 | Train Loss: 0.534 Vali Loss: 3.936 Vali Acc: 0.560 Test Loss: 3.936 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.676314353942871
Epoch: 10, Steps: 18 | Train Loss: 0.433 Vali Loss: 4.255 Vali Acc: 0.530 Test Loss: 4.255 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1691200733184814
Epoch: 11, Steps: 18 | Train Loss: 0.596 Vali Loss: 7.816 Vali Acc: 0.560 Test Loss: 7.816 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9247076511383057
Epoch: 12, Steps: 18 | Train Loss: 1.022 Vali Loss: 7.461 Vali Acc: 0.500 Test Loss: 7.461 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.954019546508789
Epoch: 13, Steps: 18 | Train Loss: 0.543 Vali Loss: 7.760 Vali Acc: 0.540 Test Loss: 7.760 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.741938352584839
Epoch: 14, Steps: 18 | Train Loss: 0.454 Vali Loss: 7.461 Vali Acc: 0.490 Test Loss: 7.461 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.17334246635437
Epoch: 15, Steps: 18 | Train Loss: 0.311 Vali Loss: 8.966 Vali Acc: 0.500 Test Loss: 8.966 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 449474
model size : 4.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.67890477180481
Epoch: 1, Steps: 18 | Train Loss: 0.907 Vali Loss: 1.408 Vali Acc: 0.500 Test Loss: 1.408 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 2.7402760982513428
Epoch: 2, Steps: 18 | Train Loss: 1.248 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
Validation loss decreased (-0.499986 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 2.4717321395874023
Epoch: 3, Steps: 18 | Train Loss: 1.116 Vali Loss: 1.531 Vali Acc: 0.610 Test Loss: 1.531 Test Acc: 0.610
Validation loss decreased (-0.599990 --> -0.609985).  Saving model ...
Epoch: 4 cost time: 3.076380729675293
Epoch: 4, Steps: 18 | Train Loss: 0.775 Vali Loss: 1.654 Vali Acc: 0.540 Test Loss: 1.654 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.489481210708618
Epoch: 5, Steps: 18 | Train Loss: 0.805 Vali Loss: 2.619 Vali Acc: 0.500 Test Loss: 2.619 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5075008869171143
Epoch: 6, Steps: 18 | Train Loss: 0.890 Vali Loss: 1.620 Vali Acc: 0.590 Test Loss: 1.620 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2260146141052246
Epoch: 7, Steps: 18 | Train Loss: 0.507 Vali Loss: 2.075 Vali Acc: 0.520 Test Loss: 2.075 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8995981216430664
Epoch: 8, Steps: 18 | Train Loss: 0.631 Vali Loss: 2.921 Vali Acc: 0.550 Test Loss: 2.921 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.668468952178955
Epoch: 9, Steps: 18 | Train Loss: 0.723 Vali Loss: 2.512 Vali Acc: 0.580 Test Loss: 2.512 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6187171936035156
Epoch: 10, Steps: 18 | Train Loss: 0.385 Vali Loss: 4.253 Vali Acc: 0.480 Test Loss: 4.253 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7226412296295166
Epoch: 11, Steps: 18 | Train Loss: 0.452 Vali Loss: 2.831 Vali Acc: 0.570 Test Loss: 2.831 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.0530853271484375
Epoch: 12, Steps: 18 | Train Loss: 0.333 Vali Loss: 3.190 Vali Acc: 0.560 Test Loss: 3.190 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0909790992736816
Epoch: 13, Steps: 18 | Train Loss: 0.214 Vali Loss: 4.146 Vali Acc: 0.500 Test Loss: 4.146 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 353986
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.021404504776001
Epoch: 1, Steps: 18 | Train Loss: 0.927 Vali Loss: 0.879 Vali Acc: 0.520 Test Loss: 0.879 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 3.0855329036712646
Epoch: 2, Steps: 18 | Train Loss: 0.906 Vali Loss: 1.374 Vali Acc: 0.540 Test Loss: 1.374 Test Acc: 0.540
Validation loss decreased (-0.519991 --> -0.539986).  Saving model ...
Epoch: 3 cost time: 3.4178788661956787
Epoch: 3, Steps: 18 | Train Loss: 0.697 Vali Loss: 1.007 Vali Acc: 0.500 Test Loss: 1.007 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0365235805511475
Epoch: 4, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.372 Vali Acc: 0.560 Test Loss: 1.372 Test Acc: 0.560
Validation loss decreased (-0.539986 --> -0.559986).  Saving model ...
Epoch: 5 cost time: 3.0506420135498047
Epoch: 5, Steps: 18 | Train Loss: 0.607 Vali Loss: 1.126 Vali Acc: 0.530 Test Loss: 1.126 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7716562747955322
Epoch: 6, Steps: 18 | Train Loss: 0.552 Vali Loss: 1.774 Vali Acc: 0.540 Test Loss: 1.774 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8216569423675537
Epoch: 7, Steps: 18 | Train Loss: 0.454 Vali Loss: 1.575 Vali Acc: 0.460 Test Loss: 1.575 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7007436752319336
Epoch: 8, Steps: 18 | Train Loss: 0.324 Vali Loss: 1.785 Vali Acc: 0.490 Test Loss: 1.785 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7991724014282227
Epoch: 9, Steps: 18 | Train Loss: 0.542 Vali Loss: 2.862 Vali Acc: 0.590 Test Loss: 2.862 Test Acc: 0.590
Validation loss decreased (-0.559986 --> -0.589971).  Saving model ...
Epoch: 10 cost time: 2.6655189990997314
Epoch: 10, Steps: 18 | Train Loss: 0.260 Vali Loss: 2.259 Vali Acc: 0.520 Test Loss: 2.259 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1855709552764893
Epoch: 11, Steps: 18 | Train Loss: 0.266 Vali Loss: 3.550 Vali Acc: 0.550 Test Loss: 3.550 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3054113388061523
Epoch: 12, Steps: 18 | Train Loss: 0.455 Vali Loss: 3.197 Vali Acc: 0.550 Test Loss: 3.197 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.241713762283325
Epoch: 13, Steps: 18 | Train Loss: 0.226 Vali Loss: 2.924 Vali Acc: 0.490 Test Loss: 2.924 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7417125701904297
Epoch: 14, Steps: 18 | Train Loss: 0.222 Vali Loss: 3.739 Vali Acc: 0.500 Test Loss: 3.739 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.0842137336730957
Epoch: 15, Steps: 18 | Train Loss: 0.600 Vali Loss: 4.058 Vali Acc: 0.520 Test Loss: 4.058 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8975231647491455
Epoch: 16, Steps: 18 | Train Loss: 0.195 Vali Loss: 6.008 Vali Acc: 0.460 Test Loss: 6.008 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.2477333545684814
Epoch: 17, Steps: 18 | Train Loss: 0.261 Vali Loss: 4.093 Vali Acc: 0.500 Test Loss: 4.093 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.403132438659668
Epoch: 18, Steps: 18 | Train Loss: 0.279 Vali Loss: 4.442 Vali Acc: 0.530 Test Loss: 4.442 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.199958324432373
Epoch: 19, Steps: 18 | Train Loss: 0.198 Vali Loss: 4.991 Vali Acc: 0.530 Test Loss: 4.991 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 324034
model size : 3.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.444559812545776
Epoch: 1, Steps: 18 | Train Loss: 0.789 Vali Loss: 1.002 Vali Acc: 0.470 Test Loss: 1.002 Test Acc: 0.470
Validation loss decreased (inf --> -0.469990).  Saving model ...
Epoch: 2 cost time: 2.717941999435425
Epoch: 2, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.774 Vali Acc: 0.590 Test Loss: 0.774 Test Acc: 0.590
Validation loss decreased (-0.469990 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 2.6922452449798584
Epoch: 3, Steps: 18 | Train Loss: 0.698 Vali Loss: 1.136 Vali Acc: 0.530 Test Loss: 1.136 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1596012115478516
Epoch: 4, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.998 Vali Acc: 0.580 Test Loss: 0.998 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6158151626586914
Epoch: 5, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.186 Vali Acc: 0.560 Test Loss: 1.186 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.657292366027832
Epoch: 6, Steps: 18 | Train Loss: 0.632 Vali Loss: 1.363 Vali Acc: 0.530 Test Loss: 1.363 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.586867570877075
Epoch: 7, Steps: 18 | Train Loss: 0.383 Vali Loss: 1.620 Vali Acc: 0.570 Test Loss: 1.620 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5855982303619385
Epoch: 8, Steps: 18 | Train Loss: 0.449 Vali Loss: 1.644 Vali Acc: 0.480 Test Loss: 1.644 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.52463698387146
Epoch: 9, Steps: 18 | Train Loss: 0.333 Vali Loss: 2.024 Vali Acc: 0.480 Test Loss: 2.024 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6589274406433105
Epoch: 10, Steps: 18 | Train Loss: 0.257 Vali Loss: 2.166 Vali Acc: 0.520 Test Loss: 2.166 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.639402389526367
Epoch: 11, Steps: 18 | Train Loss: 0.416 Vali Loss: 2.007 Vali Acc: 0.500 Test Loss: 2.007 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.55487060546875
Epoch: 12, Steps: 18 | Train Loss: 0.281 Vali Loss: 2.626 Vali Acc: 0.510 Test Loss: 2.626 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm128_nh16_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 310466
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 10.20133376121521
Epoch: 1, Steps: 18 | Train Loss: 1.790 Vali Loss: 1.018 Vali Acc: 0.540 Test Loss: 1.018 Test Acc: 0.540
Validation loss decreased (inf --> -0.539990).  Saving model ...
Epoch: 2 cost time: 7.874164581298828
Epoch: 2, Steps: 18 | Train Loss: 1.762 Vali Loss: 1.499 Vali Acc: 0.620 Test Loss: 1.499 Test Acc: 0.620
Validation loss decreased (-0.539990 --> -0.619985).  Saving model ...
Epoch: 3 cost time: 7.795057058334351
Epoch: 3, Steps: 18 | Train Loss: 2.097 Vali Loss: 2.091 Vali Acc: 0.580 Test Loss: 2.091 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.574786901473999
Epoch: 4, Steps: 18 | Train Loss: 0.849 Vali Loss: 3.120 Vali Acc: 0.580 Test Loss: 3.120 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.085346221923828
Epoch: 5, Steps: 18 | Train Loss: 1.497 Vali Loss: 6.315 Vali Acc: 0.520 Test Loss: 6.315 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.923569679260254
Epoch: 6, Steps: 18 | Train Loss: 2.082 Vali Loss: 5.359 Vali Acc: 0.480 Test Loss: 5.359 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.602006673812866
Epoch: 7, Steps: 18 | Train Loss: 1.585 Vali Loss: 5.322 Vali Acc: 0.520 Test Loss: 5.322 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.530873775482178
Epoch: 8, Steps: 18 | Train Loss: 0.769 Vali Loss: 4.272 Vali Acc: 0.630 Test Loss: 4.272 Test Acc: 0.630
Validation loss decreased (-0.619985 --> -0.629957).  Saving model ...
Epoch: 9 cost time: 6.978011608123779
Epoch: 9, Steps: 18 | Train Loss: 1.255 Vali Loss: 5.546 Vali Acc: 0.540 Test Loss: 5.546 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.593742847442627
Epoch: 10, Steps: 18 | Train Loss: 1.719 Vali Loss: 10.006 Vali Acc: 0.550 Test Loss: 10.006 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.44495964050293
Epoch: 11, Steps: 18 | Train Loss: 1.245 Vali Loss: 9.138 Vali Acc: 0.510 Test Loss: 9.138 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.056485414505005
Epoch: 12, Steps: 18 | Train Loss: 0.478 Vali Loss: 9.334 Vali Acc: 0.520 Test Loss: 9.334 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.733346462249756
Epoch: 13, Steps: 18 | Train Loss: 0.596 Vali Loss: 10.919 Vali Acc: 0.510 Test Loss: 10.919 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.4813337326049805
Epoch: 14, Steps: 18 | Train Loss: 1.056 Vali Loss: 12.451 Vali Acc: 0.470 Test Loss: 12.451 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.513304233551025
Epoch: 15, Steps: 18 | Train Loss: 0.621 Vali Loss: 9.638 Vali Acc: 0.570 Test Loss: 9.638 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.982747793197632
Epoch: 16, Steps: 18 | Train Loss: 0.764 Vali Loss: 13.348 Vali Acc: 0.570 Test Loss: 13.348 Test Acc: 0.570
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.324796676635742
Epoch: 17, Steps: 18 | Train Loss: 0.942 Vali Loss: 14.687 Vali Acc: 0.530 Test Loss: 14.687 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 7.016256093978882
Epoch: 18, Steps: 18 | Train Loss: 1.450 Vali Loss: 16.750 Vali Acc: 0.490 Test Loss: 16.750 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 693890
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.113026142120361
Epoch: 1, Steps: 18 | Train Loss: 0.827 Vali Loss: 1.075 Vali Acc: 0.480 Test Loss: 1.075 Test Acc: 0.480
Validation loss decreased (inf --> -0.479989).  Saving model ...
Epoch: 2 cost time: 3.7094833850860596
Epoch: 2, Steps: 18 | Train Loss: 1.081 Vali Loss: 1.511 Vali Acc: 0.620 Test Loss: 1.511 Test Acc: 0.620
Validation loss decreased (-0.479989 --> -0.619985).  Saving model ...
Epoch: 3 cost time: 3.8822388648986816
Epoch: 3, Steps: 18 | Train Loss: 0.860 Vali Loss: 1.608 Vali Acc: 0.520 Test Loss: 1.608 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.932584524154663
Epoch: 4, Steps: 18 | Train Loss: 0.592 Vali Loss: 2.881 Vali Acc: 0.470 Test Loss: 2.881 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.833094358444214
Epoch: 5, Steps: 18 | Train Loss: 1.256 Vali Loss: 2.992 Vali Acc: 0.450 Test Loss: 2.992 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.1798577308654785
Epoch: 6, Steps: 18 | Train Loss: 0.848 Vali Loss: 2.468 Vali Acc: 0.510 Test Loss: 2.468 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.157898426055908
Epoch: 7, Steps: 18 | Train Loss: 0.979 Vali Loss: 4.494 Vali Acc: 0.500 Test Loss: 4.494 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6689465045928955
Epoch: 8, Steps: 18 | Train Loss: 1.241 Vali Loss: 3.605 Vali Acc: 0.500 Test Loss: 3.605 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.529795169830322
Epoch: 9, Steps: 18 | Train Loss: 0.460 Vali Loss: 3.969 Vali Acc: 0.520 Test Loss: 3.969 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.399395227432251
Epoch: 10, Steps: 18 | Train Loss: 0.624 Vali Loss: 5.718 Vali Acc: 0.550 Test Loss: 5.718 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.1696107387542725
Epoch: 11, Steps: 18 | Train Loss: 0.830 Vali Loss: 5.860 Vali Acc: 0.470 Test Loss: 5.860 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.395278215408325
Epoch: 12, Steps: 18 | Train Loss: 0.576 Vali Loss: 5.827 Vali Acc: 0.500 Test Loss: 5.827 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 387394
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.0812647342681885
Epoch: 1, Steps: 18 | Train Loss: 0.861 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
Validation loss decreased (inf --> -0.499989).  Saving model ...
Epoch: 2 cost time: 3.5489487648010254
Epoch: 2, Steps: 18 | Train Loss: 0.844 Vali Loss: 1.539 Vali Acc: 0.620 Test Loss: 1.539 Test Acc: 0.620
Validation loss decreased (-0.499989 --> -0.619985).  Saving model ...
Epoch: 3 cost time: 3.8980870246887207
Epoch: 3, Steps: 18 | Train Loss: 0.717 Vali Loss: 1.234 Vali Acc: 0.590 Test Loss: 1.234 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.076516389846802
Epoch: 4, Steps: 18 | Train Loss: 0.742 Vali Loss: 1.205 Vali Acc: 0.610 Test Loss: 1.205 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.22263240814209
Epoch: 5, Steps: 18 | Train Loss: 0.499 Vali Loss: 1.822 Vali Acc: 0.510 Test Loss: 1.822 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.450448513031006
Epoch: 6, Steps: 18 | Train Loss: 0.433 Vali Loss: 2.199 Vali Acc: 0.550 Test Loss: 2.199 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.871211528778076
Epoch: 7, Steps: 18 | Train Loss: 0.604 Vali Loss: 1.837 Vali Acc: 0.540 Test Loss: 1.837 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.591506242752075
Epoch: 8, Steps: 18 | Train Loss: 0.331 Vali Loss: 2.420 Vali Acc: 0.480 Test Loss: 2.420 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.167633771896362
Epoch: 9, Steps: 18 | Train Loss: 0.168 Vali Loss: 1.991 Vali Acc: 0.520 Test Loss: 1.991 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.837153196334839
Epoch: 10, Steps: 18 | Train Loss: 0.329 Vali Loss: 2.865 Vali Acc: 0.560 Test Loss: 2.865 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.875424861907959
Epoch: 11, Steps: 18 | Train Loss: 0.526 Vali Loss: 2.579 Vali Acc: 0.520 Test Loss: 2.579 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.375502109527588
Epoch: 12, Steps: 18 | Train Loss: 0.460 Vali Loss: 2.303 Vali Acc: 0.540 Test Loss: 2.303 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 277506
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.743737697601318
Epoch: 1, Steps: 18 | Train Loss: 0.850 Vali Loss: 0.801 Vali Acc: 0.480 Test Loss: 0.801 Test Acc: 0.480
Validation loss decreased (inf --> -0.479992).  Saving model ...
Epoch: 2 cost time: 3.0403635501861572
Epoch: 2, Steps: 18 | Train Loss: 0.818 Vali Loss: 1.065 Vali Acc: 0.540 Test Loss: 1.065 Test Acc: 0.540
Validation loss decreased (-0.479992 --> -0.539989).  Saving model ...
Epoch: 3 cost time: 3.6057095527648926
Epoch: 3, Steps: 18 | Train Loss: 0.579 Vali Loss: 1.259 Vali Acc: 0.510 Test Loss: 1.259 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1581008434295654
Epoch: 4, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.944 Vali Acc: 0.460 Test Loss: 0.944 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.351729393005371
Epoch: 5, Steps: 18 | Train Loss: 0.461 Vali Loss: 1.947 Vali Acc: 0.460 Test Loss: 1.947 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0954153537750244
Epoch: 6, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.558 Vali Acc: 0.540 Test Loss: 1.558 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.3933608531951904
Epoch: 7, Steps: 18 | Train Loss: 0.419 Vali Loss: 2.027 Vali Acc: 0.550 Test Loss: 2.027 Test Acc: 0.550
Validation loss decreased (-0.539989 --> -0.549980).  Saving model ...
Epoch: 8 cost time: 3.475564956665039
Epoch: 8, Steps: 18 | Train Loss: 0.338 Vali Loss: 2.298 Vali Acc: 0.520 Test Loss: 2.298 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8995251655578613
Epoch: 9, Steps: 18 | Train Loss: 0.225 Vali Loss: 3.085 Vali Acc: 0.490 Test Loss: 3.085 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3450076580047607
Epoch: 10, Steps: 18 | Train Loss: 0.248 Vali Loss: 2.304 Vali Acc: 0.540 Test Loss: 2.304 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4020159244537354
Epoch: 11, Steps: 18 | Train Loss: 0.367 Vali Loss: 2.302 Vali Acc: 0.610 Test Loss: 2.302 Test Acc: 0.610
Validation loss decreased (-0.549980 --> -0.609977).  Saving model ...
Epoch: 12 cost time: 3.445361375808716
Epoch: 12, Steps: 18 | Train Loss: 0.160 Vali Loss: 2.908 Vali Acc: 0.520 Test Loss: 2.908 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.005467414855957
Epoch: 13, Steps: 18 | Train Loss: 0.102 Vali Loss: 3.007 Vali Acc: 0.520 Test Loss: 3.007 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.444243907928467
Epoch: 14, Steps: 18 | Train Loss: 0.168 Vali Loss: 2.766 Vali Acc: 0.580 Test Loss: 2.766 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.355023145675659
Epoch: 15, Steps: 18 | Train Loss: 0.205 Vali Loss: 3.766 Vali Acc: 0.500 Test Loss: 3.766 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3766117095947266
Epoch: 16, Steps: 18 | Train Loss: 0.384 Vali Loss: 3.492 Vali Acc: 0.490 Test Loss: 3.492 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.050368309020996
Epoch: 17, Steps: 18 | Train Loss: 0.091 Vali Loss: 5.014 Vali Acc: 0.530 Test Loss: 5.014 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.403378486633301
Epoch: 18, Steps: 18 | Train Loss: 0.087 Vali Loss: 4.831 Vali Acc: 0.510 Test Loss: 4.831 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.5837562084198
Epoch: 19, Steps: 18 | Train Loss: 0.110 Vali Loss: 4.970 Vali Acc: 0.520 Test Loss: 4.970 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0218381881713867
Epoch: 20, Steps: 18 | Train Loss: 0.063 Vali Loss: 5.494 Vali Acc: 0.510 Test Loss: 5.494 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.821298122406006
Epoch: 21, Steps: 18 | Train Loss: 0.196 Vali Loss: 6.108 Vali Acc: 0.520 Test Loss: 6.108 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 233154
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.315374135971069
Epoch: 1, Steps: 18 | Train Loss: 0.827 Vali Loss: 0.892 Vali Acc: 0.510 Test Loss: 0.892 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 2.8929524421691895
Epoch: 2, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.816 Vali Acc: 0.540 Test Loss: 0.816 Test Acc: 0.540
Validation loss decreased (-0.509991 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 2.8466384410858154
Epoch: 3, Steps: 18 | Train Loss: 0.563 Vali Loss: 0.842 Vali Acc: 0.570 Test Loss: 0.842 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 2.9002418518066406
Epoch: 4, Steps: 18 | Train Loss: 0.631 Vali Loss: 1.078 Vali Acc: 0.530 Test Loss: 1.078 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0500149726867676
Epoch: 5, Steps: 18 | Train Loss: 0.410 Vali Loss: 1.646 Vali Acc: 0.500 Test Loss: 1.646 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8483986854553223
Epoch: 6, Steps: 18 | Train Loss: 0.563 Vali Loss: 1.292 Vali Acc: 0.550 Test Loss: 1.292 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9897642135620117
Epoch: 7, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.433 Vali Acc: 0.530 Test Loss: 1.433 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7812812328338623
Epoch: 8, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.880 Vali Acc: 0.520 Test Loss: 1.880 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.818293333053589
Epoch: 9, Steps: 18 | Train Loss: 0.287 Vali Loss: 2.083 Vali Acc: 0.520 Test Loss: 2.083 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1891517639160156
Epoch: 10, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.783 Vali Acc: 0.510 Test Loss: 1.783 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.431401252746582
Epoch: 11, Steps: 18 | Train Loss: 0.254 Vali Loss: 2.951 Vali Acc: 0.430 Test Loss: 2.951 Test Acc: 0.430
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9171290397644043
Epoch: 12, Steps: 18 | Train Loss: 0.239 Vali Loss: 2.414 Vali Acc: 0.530 Test Loss: 2.414 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.0107052326202393
Epoch: 13, Steps: 18 | Train Loss: 0.291 Vali Loss: 2.340 Vali Acc: 0.560 Test Loss: 2.340 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 185410
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.203113555908203
Epoch: 1, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.743 Vali Acc: 0.530 Test Loss: 0.743 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 2.7992477416992188
Epoch: 2, Steps: 18 | Train Loss: 0.750 Vali Loss: 0.728 Vali Acc: 0.590 Test Loss: 0.728 Test Acc: 0.590
Validation loss decreased (-0.529993 --> -0.589993).  Saving model ...
Epoch: 3 cost time: 3.2131998538970947
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.858 Vali Acc: 0.550 Test Loss: 0.858 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.990708112716675
Epoch: 4, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.886 Vali Acc: 0.570 Test Loss: 0.886 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3632020950317383
Epoch: 5, Steps: 18 | Train Loss: 0.469 Vali Loss: 1.163 Vali Acc: 0.520 Test Loss: 1.163 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8469066619873047
Epoch: 6, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.027 Vali Acc: 0.480 Test Loss: 1.027 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3303091526031494
Epoch: 7, Steps: 18 | Train Loss: 0.351 Vali Loss: 1.232 Vali Acc: 0.530 Test Loss: 1.232 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5767123699188232
Epoch: 8, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.866 Vali Acc: 0.480 Test Loss: 1.866 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9143731594085693
Epoch: 9, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.745 Vali Acc: 0.530 Test Loss: 1.745 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.581087112426758
Epoch: 10, Steps: 18 | Train Loss: 0.294 Vali Loss: 1.774 Vali Acc: 0.540 Test Loss: 1.774 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7382895946502686
Epoch: 11, Steps: 18 | Train Loss: 0.326 Vali Loss: 3.161 Vali Acc: 0.520 Test Loss: 3.161 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.670759439468384
Epoch: 12, Steps: 18 | Train Loss: 0.220 Vali Loss: 2.080 Vali Acc: 0.500 Test Loss: 2.080 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 170434
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.936048269271851
Epoch: 1, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.933 Vali Acc: 0.390 Test Loss: 0.933 Test Acc: 0.390
Validation loss decreased (inf --> -0.389991).  Saving model ...
Epoch: 2 cost time: 3.248544216156006
Epoch: 2, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.730 Vali Acc: 0.550 Test Loss: 0.730 Test Acc: 0.550
Validation loss decreased (-0.389991 --> -0.549993).  Saving model ...
Epoch: 3 cost time: 3.3241939544677734
Epoch: 3, Steps: 18 | Train Loss: 0.615 Vali Loss: 0.769 Vali Acc: 0.580 Test Loss: 0.769 Test Acc: 0.580
Validation loss decreased (-0.549993 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 2.768345355987549
Epoch: 4, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.890 Vali Acc: 0.530 Test Loss: 0.890 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6919333934783936
Epoch: 5, Steps: 18 | Train Loss: 0.485 Vali Loss: 1.063 Vali Acc: 0.510 Test Loss: 1.063 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4972188472747803
Epoch: 6, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.116 Vali Acc: 0.480 Test Loss: 1.116 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.229551315307617
Epoch: 7, Steps: 18 | Train Loss: 0.365 Vali Loss: 1.991 Vali Acc: 0.490 Test Loss: 1.991 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.658588409423828
Epoch: 8, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.328 Vali Acc: 0.540 Test Loss: 1.328 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2370240688323975
Epoch: 9, Steps: 18 | Train Loss: 0.293 Vali Loss: 1.354 Vali Acc: 0.530 Test Loss: 1.354 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.517587661743164
Epoch: 10, Steps: 18 | Train Loss: 0.423 Vali Loss: 1.696 Vali Acc: 0.460 Test Loss: 1.696 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.500293254852295
Epoch: 11, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.616 Vali Acc: 0.510 Test Loss: 1.616 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7408106327056885
Epoch: 12, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.738 Vali Acc: 0.510 Test Loss: 1.738 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.583582878112793
Epoch: 13, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.784 Vali Acc: 0.500 Test Loss: 1.784 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 163650
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.115617513656616
Epoch: 1, Steps: 18 | Train Loss: 1.115 Vali Loss: 1.075 Vali Acc: 0.640 Test Loss: 1.075 Test Acc: 0.640
Validation loss decreased (inf --> -0.639989).  Saving model ...
Epoch: 2 cost time: 5.445861577987671
Epoch: 2, Steps: 18 | Train Loss: 1.307 Vali Loss: 2.821 Vali Acc: 0.550 Test Loss: 2.821 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.349931716918945
Epoch: 3, Steps: 18 | Train Loss: 1.738 Vali Loss: 4.191 Vali Acc: 0.610 Test Loss: 4.191 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.2516655921936035
Epoch: 4, Steps: 18 | Train Loss: 2.134 Vali Loss: 6.386 Vali Acc: 0.530 Test Loss: 6.386 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.472009181976318
Epoch: 5, Steps: 18 | Train Loss: 2.145 Vali Loss: 2.647 Vali Acc: 0.490 Test Loss: 2.647 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.209986209869385
Epoch: 6, Steps: 18 | Train Loss: 1.914 Vali Loss: 4.044 Vali Acc: 0.500 Test Loss: 4.044 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.190885543823242
Epoch: 7, Steps: 18 | Train Loss: 0.988 Vali Loss: 8.167 Vali Acc: 0.480 Test Loss: 8.167 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.948550224304199
Epoch: 8, Steps: 18 | Train Loss: 0.727 Vali Loss: 5.325 Vali Acc: 0.490 Test Loss: 5.325 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.2744293212890625
Epoch: 9, Steps: 18 | Train Loss: 1.272 Vali Loss: 7.347 Vali Acc: 0.520 Test Loss: 7.347 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.675607442855835
Epoch: 10, Steps: 18 | Train Loss: 0.562 Vali Loss: 8.231 Vali Acc: 0.510 Test Loss: 8.231 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 6.149187326431274
Epoch: 11, Steps: 18 | Train Loss: 0.947 Vali Loss: 12.392 Vali Acc: 0.500 Test Loss: 12.392 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.64
model parameter : 677378
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.4175450801849365
Epoch: 1, Steps: 18 | Train Loss: 0.867 Vali Loss: 0.869 Vali Acc: 0.510 Test Loss: 0.869 Test Acc: 0.510
Validation loss decreased (inf --> -0.509991).  Saving model ...
Epoch: 2 cost time: 3.5324978828430176
Epoch: 2, Steps: 18 | Train Loss: 1.015 Vali Loss: 1.962 Vali Acc: 0.600 Test Loss: 1.962 Test Acc: 0.600
Validation loss decreased (-0.509991 --> -0.599980).  Saving model ...
Epoch: 3 cost time: 3.657960891723633
Epoch: 3, Steps: 18 | Train Loss: 0.857 Vali Loss: 1.913 Vali Acc: 0.620 Test Loss: 1.913 Test Acc: 0.620
Validation loss decreased (-0.599980 --> -0.619981).  Saving model ...
Epoch: 4 cost time: 3.342935800552368
Epoch: 4, Steps: 18 | Train Loss: 1.267 Vali Loss: 2.438 Vali Acc: 0.560 Test Loss: 2.438 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0389630794525146
Epoch: 5, Steps: 18 | Train Loss: 0.700 Vali Loss: 3.285 Vali Acc: 0.540 Test Loss: 3.285 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5115559101104736
Epoch: 6, Steps: 18 | Train Loss: 0.787 Vali Loss: 2.284 Vali Acc: 0.570 Test Loss: 2.284 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5323755741119385
Epoch: 7, Steps: 18 | Train Loss: 1.191 Vali Loss: 3.136 Vali Acc: 0.480 Test Loss: 3.136 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.242525100708008
Epoch: 8, Steps: 18 | Train Loss: 0.259 Vali Loss: 3.328 Vali Acc: 0.580 Test Loss: 3.328 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.647477149963379
Epoch: 9, Steps: 18 | Train Loss: 0.361 Vali Loss: 2.979 Vali Acc: 0.500 Test Loss: 2.979 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.6648576259613037
Epoch: 10, Steps: 18 | Train Loss: 0.586 Vali Loss: 3.619 Vali Acc: 0.520 Test Loss: 3.619 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.468512535095215
Epoch: 11, Steps: 18 | Train Loss: 0.635 Vali Loss: 4.985 Vali Acc: 0.500 Test Loss: 4.985 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.3066444396972656
Epoch: 12, Steps: 18 | Train Loss: 0.396 Vali Loss: 5.587 Vali Acc: 0.480 Test Loss: 5.587 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.5239131450653076
Epoch: 13, Steps: 18 | Train Loss: 0.534 Vali Loss: 5.266 Vali Acc: 0.510 Test Loss: 5.266 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 370882
model size : 2.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.4400434494018555
Epoch: 1, Steps: 18 | Train Loss: 0.900 Vali Loss: 0.920 Vali Acc: 0.550 Test Loss: 0.920 Test Acc: 0.550
Validation loss decreased (inf --> -0.549991).  Saving model ...
Epoch: 2 cost time: 3.4271318912506104
Epoch: 2, Steps: 18 | Train Loss: 1.001 Vali Loss: 1.404 Vali Acc: 0.510 Test Loss: 1.404 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6711838245391846
Epoch: 3, Steps: 18 | Train Loss: 1.063 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.171015501022339
Epoch: 4, Steps: 18 | Train Loss: 0.809 Vali Loss: 1.312 Vali Acc: 0.620 Test Loss: 1.312 Test Acc: 0.620
Validation loss decreased (-0.549991 --> -0.619987).  Saving model ...
Epoch: 5 cost time: 3.189145088195801
Epoch: 5, Steps: 18 | Train Loss: 0.564 Vali Loss: 1.734 Vali Acc: 0.480 Test Loss: 1.734 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9649441242218018
Epoch: 6, Steps: 18 | Train Loss: 0.425 Vali Loss: 2.542 Vali Acc: 0.450 Test Loss: 2.542 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.767096757888794
Epoch: 7, Steps: 18 | Train Loss: 0.678 Vali Loss: 2.312 Vali Acc: 0.490 Test Loss: 2.312 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0832598209381104
Epoch: 8, Steps: 18 | Train Loss: 0.365 Vali Loss: 2.681 Vali Acc: 0.490 Test Loss: 2.681 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3133842945098877
Epoch: 9, Steps: 18 | Train Loss: 0.504 Vali Loss: 3.736 Vali Acc: 0.490 Test Loss: 3.736 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.295273780822754
Epoch: 10, Steps: 18 | Train Loss: 0.248 Vali Loss: 3.318 Vali Acc: 0.520 Test Loss: 3.318 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.397266149520874
Epoch: 11, Steps: 18 | Train Loss: 0.290 Vali Loss: 3.588 Vali Acc: 0.560 Test Loss: 3.588 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9535956382751465
Epoch: 12, Steps: 18 | Train Loss: 0.511 Vali Loss: 6.977 Vali Acc: 0.510 Test Loss: 6.977 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.6596827507019043
Epoch: 13, Steps: 18 | Train Loss: 0.777 Vali Loss: 3.659 Vali Acc: 0.500 Test Loss: 3.659 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.680074453353882
Epoch: 14, Steps: 18 | Train Loss: 0.500 Vali Loss: 3.032 Vali Acc: 0.560 Test Loss: 3.032 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 260994
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.999021768569946
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 2.883836030960083
Epoch: 2, Steps: 18 | Train Loss: 0.694 Vali Loss: 0.848 Vali Acc: 0.530 Test Loss: 0.848 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.658676862716675
Epoch: 3, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.935 Vali Acc: 0.500 Test Loss: 0.935 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7698843479156494
Epoch: 4, Steps: 18 | Train Loss: 0.521 Vali Loss: 0.997 Vali Acc: 0.550 Test Loss: 0.997 Test Acc: 0.550
Validation loss decreased (-0.529992 --> -0.549990).  Saving model ...
Epoch: 5 cost time: 2.6719462871551514
Epoch: 5, Steps: 18 | Train Loss: 0.513 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.549990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 2.8721823692321777
Epoch: 6, Steps: 18 | Train Loss: 0.700 Vali Loss: 2.595 Vali Acc: 0.560 Test Loss: 2.595 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6357390880584717
Epoch: 7, Steps: 18 | Train Loss: 0.722 Vali Loss: 1.844 Vali Acc: 0.520 Test Loss: 1.844 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.472902536392212
Epoch: 8, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.913 Vali Acc: 0.560 Test Loss: 1.913 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.212294578552246
Epoch: 9, Steps: 18 | Train Loss: 0.253 Vali Loss: 2.334 Vali Acc: 0.500 Test Loss: 2.334 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.140936851501465
Epoch: 10, Steps: 18 | Train Loss: 0.197 Vali Loss: 2.804 Vali Acc: 0.540 Test Loss: 2.804 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0767414569854736
Epoch: 11, Steps: 18 | Train Loss: 0.179 Vali Loss: 3.323 Vali Acc: 0.520 Test Loss: 3.323 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0852315425872803
Epoch: 12, Steps: 18 | Train Loss: 0.366 Vali Loss: 2.906 Vali Acc: 0.540 Test Loss: 2.906 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8290469646453857
Epoch: 13, Steps: 18 | Train Loss: 0.192 Vali Loss: 3.939 Vali Acc: 0.450 Test Loss: 3.939 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.4061176776885986
Epoch: 14, Steps: 18 | Train Loss: 0.257 Vali Loss: 3.321 Vali Acc: 0.500 Test Loss: 3.321 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.1472389698028564
Epoch: 15, Steps: 18 | Train Loss: 0.115 Vali Loss: 3.064 Vali Acc: 0.540 Test Loss: 3.064 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 216642
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.155453681945801
Epoch: 1, Steps: 18 | Train Loss: 0.817 Vali Loss: 0.882 Vali Acc: 0.530 Test Loss: 0.882 Test Acc: 0.530
Validation loss decreased (inf --> -0.529991).  Saving model ...
Epoch: 2 cost time: 2.874055862426758
Epoch: 2, Steps: 18 | Train Loss: 0.823 Vali Loss: 0.847 Vali Acc: 0.600 Test Loss: 0.847 Test Acc: 0.600
Validation loss decreased (-0.529991 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 2.76104998588562
Epoch: 3, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.915 Vali Acc: 0.520 Test Loss: 0.915 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.944448232650757
Epoch: 4, Steps: 18 | Train Loss: 0.651 Vali Loss: 1.233 Vali Acc: 0.490 Test Loss: 1.233 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8176515102386475
Epoch: 5, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.932 Vali Acc: 0.580 Test Loss: 0.932 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.766378402709961
Epoch: 6, Steps: 18 | Train Loss: 0.386 Vali Loss: 1.431 Vali Acc: 0.520 Test Loss: 1.431 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8988852500915527
Epoch: 7, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.745 Vali Acc: 0.530 Test Loss: 1.745 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.734480619430542
Epoch: 8, Steps: 18 | Train Loss: 0.390 Vali Loss: 1.733 Vali Acc: 0.530 Test Loss: 1.733 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.636955976486206
Epoch: 9, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.839 Vali Acc: 0.510 Test Loss: 1.839 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5641682147979736
Epoch: 10, Steps: 18 | Train Loss: 0.268 Vali Loss: 2.254 Vali Acc: 0.510 Test Loss: 2.254 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.93654203414917
Epoch: 11, Steps: 18 | Train Loss: 0.259 Vali Loss: 2.242 Vali Acc: 0.500 Test Loss: 2.242 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.993584156036377
Epoch: 12, Steps: 18 | Train Loss: 0.241 Vali Loss: 2.823 Vali Acc: 0.500 Test Loss: 2.823 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 168898
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.440699815750122
Epoch: 1, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.793 Vali Acc: 0.540 Test Loss: 0.793 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 3.04130220413208
Epoch: 2, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.866 Vali Acc: 0.470 Test Loss: 0.866 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.990586519241333
Epoch: 3, Steps: 18 | Train Loss: 0.668 Vali Loss: 1.373 Vali Acc: 0.530 Test Loss: 1.373 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.234290599822998
Epoch: 4, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.815 Vali Acc: 0.590 Test Loss: 0.815 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589992).  Saving model ...
Epoch: 5 cost time: 2.7188985347747803
Epoch: 5, Steps: 18 | Train Loss: 0.540 Vali Loss: 1.260 Vali Acc: 0.440 Test Loss: 1.260 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.784227132797241
Epoch: 6, Steps: 18 | Train Loss: 0.418 Vali Loss: 1.155 Vali Acc: 0.520 Test Loss: 1.155 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.377654552459717
Epoch: 7, Steps: 18 | Train Loss: 0.333 Vali Loss: 1.356 Vali Acc: 0.510 Test Loss: 1.356 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5973072052001953
Epoch: 8, Steps: 18 | Train Loss: 0.291 Vali Loss: 1.304 Vali Acc: 0.520 Test Loss: 1.304 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.897799015045166
Epoch: 9, Steps: 18 | Train Loss: 0.321 Vali Loss: 1.513 Vali Acc: 0.470 Test Loss: 1.513 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.644826650619507
Epoch: 10, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.860 Vali Acc: 0.530 Test Loss: 1.860 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.592806816101074
Epoch: 11, Steps: 18 | Train Loss: 0.203 Vali Loss: 1.593 Vali Acc: 0.590 Test Loss: 1.593 Test Acc: 0.590
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.497060537338257
Epoch: 12, Steps: 18 | Train Loss: 0.155 Vali Loss: 2.527 Vali Acc: 0.530 Test Loss: 2.527 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8932292461395264
Epoch: 13, Steps: 18 | Train Loss: 0.285 Vali Loss: 2.294 Vali Acc: 0.490 Test Loss: 2.294 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.6848390102386475
Epoch: 14, Steps: 18 | Train Loss: 0.206 Vali Loss: 2.066 Vali Acc: 0.620 Test Loss: 2.066 Test Acc: 0.620
Validation loss decreased (-0.589992 --> -0.619979).  Saving model ...
Epoch: 15 cost time: 2.668966770172119
Epoch: 15, Steps: 18 | Train Loss: 0.208 Vali Loss: 1.966 Vali Acc: 0.530 Test Loss: 1.966 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.670783519744873
Epoch: 16, Steps: 18 | Train Loss: 0.059 Vali Loss: 2.502 Vali Acc: 0.510 Test Loss: 2.502 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7245030403137207
Epoch: 17, Steps: 18 | Train Loss: 0.126 Vali Loss: 3.148 Vali Acc: 0.550 Test Loss: 3.148 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.647817850112915
Epoch: 18, Steps: 18 | Train Loss: 0.140 Vali Loss: 2.794 Vali Acc: 0.500 Test Loss: 2.794 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.689382791519165
Epoch: 19, Steps: 18 | Train Loss: 0.124 Vali Loss: 2.943 Vali Acc: 0.570 Test Loss: 2.943 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.715421438217163
Epoch: 20, Steps: 18 | Train Loss: 0.100 Vali Loss: 2.584 Vali Acc: 0.570 Test Loss: 2.584 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1202001571655273
Epoch: 21, Steps: 18 | Train Loss: 0.076 Vali Loss: 3.971 Vali Acc: 0.540 Test Loss: 3.971 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.511549949645996
Epoch: 22, Steps: 18 | Train Loss: 0.154 Vali Loss: 5.208 Vali Acc: 0.480 Test Loss: 5.208 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5256636142730713
Epoch: 23, Steps: 18 | Train Loss: 0.074 Vali Loss: 3.392 Vali Acc: 0.520 Test Loss: 3.392 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.964566946029663
Epoch: 24, Steps: 18 | Train Loss: 0.068 Vali Loss: 4.181 Vali Acc: 0.510 Test Loss: 4.181 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 153922
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.825017213821411
Epoch: 1, Steps: 18 | Train Loss: 0.741 Vali Loss: 0.805 Vali Acc: 0.570 Test Loss: 0.805 Test Acc: 0.570
Validation loss decreased (inf --> -0.569992).  Saving model ...
Epoch: 2 cost time: 2.9189820289611816
Epoch: 2, Steps: 18 | Train Loss: 0.677 Vali Loss: 1.230 Vali Acc: 0.570 Test Loss: 1.230 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6836469173431396
Epoch: 3, Steps: 18 | Train Loss: 0.636 Vali Loss: 0.846 Vali Acc: 0.510 Test Loss: 0.846 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.056175708770752
Epoch: 4, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.876 Vali Acc: 0.680 Test Loss: 0.876 Test Acc: 0.680
Validation loss decreased (-0.569992 --> -0.679991).  Saving model ...
Epoch: 5 cost time: 3.0729634761810303
Epoch: 5, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.923 Vali Acc: 0.600 Test Loss: 0.923 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.83473539352417
Epoch: 6, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.892 Vali Acc: 0.540 Test Loss: 0.892 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6891772747039795
Epoch: 7, Steps: 18 | Train Loss: 0.370 Vali Loss: 1.009 Vali Acc: 0.580 Test Loss: 1.009 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8658063411712646
Epoch: 8, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.123 Vali Acc: 0.540 Test Loss: 1.123 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6873936653137207
Epoch: 9, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.176 Vali Acc: 0.570 Test Loss: 1.176 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.923240900039673
Epoch: 10, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.450 Vali Acc: 0.560 Test Loss: 1.450 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.139423370361328
Epoch: 11, Steps: 18 | Train Loss: 0.186 Vali Loss: 1.531 Vali Acc: 0.560 Test Loss: 1.531 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8685498237609863
Epoch: 12, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.521 Vali Acc: 0.490 Test Loss: 1.521 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9759976863861084
Epoch: 13, Steps: 18 | Train Loss: 0.147 Vali Loss: 1.700 Vali Acc: 0.500 Test Loss: 1.700 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.91984224319458
Epoch: 14, Steps: 18 | Train Loss: 0.148 Vali Loss: 2.098 Vali Acc: 0.530 Test Loss: 2.098 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.68
model parameter : 147138
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.23435926437378
Epoch: 1, Steps: 18 | Train Loss: 0.968 Vali Loss: 2.508 Vali Acc: 0.530 Test Loss: 2.508 Test Acc: 0.530
Validation loss decreased (inf --> -0.529975).  Saving model ...
Epoch: 2 cost time: 4.148838758468628
Epoch: 2, Steps: 18 | Train Loss: 1.207 Vali Loss: 5.368 Vali Acc: 0.510 Test Loss: 5.368 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2840235233306885
Epoch: 3, Steps: 18 | Train Loss: 2.221 Vali Loss: 4.436 Vali Acc: 0.500 Test Loss: 4.436 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.998504638671875
Epoch: 4, Steps: 18 | Train Loss: 3.242 Vali Loss: 4.655 Vali Acc: 0.470 Test Loss: 4.655 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9240331649780273
Epoch: 5, Steps: 18 | Train Loss: 2.452 Vali Loss: 11.223 Vali Acc: 0.500 Test Loss: 11.223 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.303802013397217
Epoch: 6, Steps: 18 | Train Loss: 3.481 Vali Loss: 7.153 Vali Acc: 0.460 Test Loss: 7.153 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.837336301803589
Epoch: 7, Steps: 18 | Train Loss: 1.605 Vali Loss: 7.484 Vali Acc: 0.500 Test Loss: 7.484 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.084975957870483
Epoch: 8, Steps: 18 | Train Loss: 1.856 Vali Loss: 8.640 Vali Acc: 0.440 Test Loss: 8.640 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.3539276123046875
Epoch: 9, Steps: 18 | Train Loss: 0.872 Vali Loss: 4.754 Vali Acc: 0.540 Test Loss: 4.754 Test Acc: 0.540
Validation loss decreased (-0.529975 --> -0.539952).  Saving model ...
Epoch: 10 cost time: 3.826007843017578
Epoch: 10, Steps: 18 | Train Loss: 1.343 Vali Loss: 6.200 Vali Acc: 0.550 Test Loss: 6.200 Test Acc: 0.550
Validation loss decreased (-0.539952 --> -0.549938).  Saving model ...
Epoch: 11 cost time: 3.830528736114502
Epoch: 11, Steps: 18 | Train Loss: 1.927 Vali Loss: 10.004 Vali Acc: 0.510 Test Loss: 10.004 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.018266439437866
Epoch: 12, Steps: 18 | Train Loss: 1.037 Vali Loss: 9.813 Vali Acc: 0.510 Test Loss: 9.813 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8404462337493896
Epoch: 13, Steps: 18 | Train Loss: 1.085 Vali Loss: 19.244 Vali Acc: 0.420 Test Loss: 19.244 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.263526916503906
Epoch: 14, Steps: 18 | Train Loss: 1.514 Vali Loss: 14.398 Vali Acc: 0.510 Test Loss: 14.398 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7347583770751953
Epoch: 15, Steps: 18 | Train Loss: 1.535 Vali Loss: 13.839 Vali Acc: 0.460 Test Loss: 13.839 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.743290424346924
Epoch: 16, Steps: 18 | Train Loss: 0.237 Vali Loss: 10.456 Vali Acc: 0.470 Test Loss: 10.456 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.6248717308044434
Epoch: 17, Steps: 18 | Train Loss: 0.725 Vali Loss: 15.754 Vali Acc: 0.570 Test Loss: 15.754 Test Acc: 0.570
Validation loss decreased (-0.549938 --> -0.569842).  Saving model ...
Epoch: 18 cost time: 4.648813009262085
Epoch: 18, Steps: 18 | Train Loss: 0.786 Vali Loss: 16.210 Vali Acc: 0.520 Test Loss: 16.210 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.326156377792358
Epoch: 19, Steps: 18 | Train Loss: 0.602 Vali Loss: 17.516 Vali Acc: 0.530 Test Loss: 17.516 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.047698259353638
Epoch: 20, Steps: 18 | Train Loss: 0.322 Vali Loss: 18.371 Vali Acc: 0.490 Test Loss: 18.371 Test Acc: 0.490
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.3513312339782715
Epoch: 21, Steps: 18 | Train Loss: 0.492 Vali Loss: 17.108 Vali Acc: 0.480 Test Loss: 17.108 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.092421054840088
Epoch: 22, Steps: 18 | Train Loss: 0.421 Vali Loss: 23.766 Vali Acc: 0.450 Test Loss: 23.766 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.7593019008636475
Epoch: 23, Steps: 18 | Train Loss: 0.292 Vali Loss: 29.831 Vali Acc: 0.450 Test Loss: 29.831 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.067381381988525
Epoch: 24, Steps: 18 | Train Loss: 0.266 Vali Loss: 19.737 Vali Acc: 0.490 Test Loss: 19.737 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.842784404754639
Epoch: 25, Steps: 18 | Train Loss: 0.533 Vali Loss: 16.940 Vali Acc: 0.490 Test Loss: 16.940 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.509016990661621
Epoch: 26, Steps: 18 | Train Loss: 0.453 Vali Loss: 14.029 Vali Acc: 0.490 Test Loss: 14.029 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.97740626335144
Epoch: 27, Steps: 18 | Train Loss: 0.886 Vali Loss: 19.490 Vali Acc: 0.470 Test Loss: 19.490 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 669122
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.657887697219849
Epoch: 1, Steps: 18 | Train Loss: 0.954 Vali Loss: 1.345 Vali Acc: 0.530 Test Loss: 1.345 Test Acc: 0.530
Validation loss decreased (inf --> -0.529987).  Saving model ...
Epoch: 2 cost time: 3.3466098308563232
Epoch: 2, Steps: 18 | Train Loss: 0.916 Vali Loss: 1.196 Vali Acc: 0.590 Test Loss: 1.196 Test Acc: 0.590
Validation loss decreased (-0.529987 --> -0.589988).  Saving model ...
Epoch: 3 cost time: 3.817056179046631
Epoch: 3, Steps: 18 | Train Loss: 0.844 Vali Loss: 1.459 Vali Acc: 0.570 Test Loss: 1.459 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8328514099121094
Epoch: 4, Steps: 18 | Train Loss: 0.831 Vali Loss: 1.597 Vali Acc: 0.550 Test Loss: 1.597 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.494703769683838
Epoch: 5, Steps: 18 | Train Loss: 0.629 Vali Loss: 1.616 Vali Acc: 0.600 Test Loss: 1.616 Test Acc: 0.600
Validation loss decreased (-0.589988 --> -0.599984).  Saving model ...
Epoch: 6 cost time: 3.3154098987579346
Epoch: 6, Steps: 18 | Train Loss: 0.596 Vali Loss: 2.491 Vali Acc: 0.540 Test Loss: 2.491 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3002383708953857
Epoch: 7, Steps: 18 | Train Loss: 0.529 Vali Loss: 3.002 Vali Acc: 0.550 Test Loss: 3.002 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8452112674713135
Epoch: 8, Steps: 18 | Train Loss: 0.367 Vali Loss: 2.275 Vali Acc: 0.590 Test Loss: 2.275 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.834749221801758
Epoch: 9, Steps: 18 | Train Loss: 0.796 Vali Loss: 3.357 Vali Acc: 0.570 Test Loss: 3.357 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.895298957824707
Epoch: 10, Steps: 18 | Train Loss: 0.386 Vali Loss: 4.758 Vali Acc: 0.460 Test Loss: 4.758 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.021251916885376
Epoch: 11, Steps: 18 | Train Loss: 1.051 Vali Loss: 8.414 Vali Acc: 0.540 Test Loss: 8.414 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.58314847946167
Epoch: 12, Steps: 18 | Train Loss: 0.763 Vali Loss: 6.834 Vali Acc: 0.510 Test Loss: 6.834 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.7100274562835693
Epoch: 13, Steps: 18 | Train Loss: 0.746 Vali Loss: 5.046 Vali Acc: 0.520 Test Loss: 5.046 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.114219665527344
Epoch: 14, Steps: 18 | Train Loss: 0.415 Vali Loss: 8.839 Vali Acc: 0.550 Test Loss: 8.839 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.534557580947876
Epoch: 15, Steps: 18 | Train Loss: 0.674 Vali Loss: 6.222 Vali Acc: 0.540 Test Loss: 6.222 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 362626
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.789862871170044
Epoch: 1, Steps: 18 | Train Loss: 0.814 Vali Loss: 0.778 Vali Acc: 0.540 Test Loss: 0.778 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 3.639533281326294
Epoch: 2, Steps: 18 | Train Loss: 0.984 Vali Loss: 0.964 Vali Acc: 0.520 Test Loss: 0.964 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9664669036865234
Epoch: 3, Steps: 18 | Train Loss: 0.701 Vali Loss: 1.496 Vali Acc: 0.540 Test Loss: 1.496 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.811492681503296
Epoch: 4, Steps: 18 | Train Loss: 0.760 Vali Loss: 1.937 Vali Acc: 0.600 Test Loss: 1.937 Test Acc: 0.600
Validation loss decreased (-0.539992 --> -0.599981).  Saving model ...
Epoch: 5 cost time: 3.5217363834381104
Epoch: 5, Steps: 18 | Train Loss: 0.784 Vali Loss: 1.787 Vali Acc: 0.550 Test Loss: 1.787 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.37619686126709
Epoch: 6, Steps: 18 | Train Loss: 0.650 Vali Loss: 2.913 Vali Acc: 0.590 Test Loss: 2.913 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.2920453548431396
Epoch: 7, Steps: 18 | Train Loss: 1.019 Vali Loss: 2.003 Vali Acc: 0.470 Test Loss: 2.003 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.413571834564209
Epoch: 8, Steps: 18 | Train Loss: 0.520 Vali Loss: 2.243 Vali Acc: 0.520 Test Loss: 2.243 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.158298015594482
Epoch: 9, Steps: 18 | Train Loss: 0.373 Vali Loss: 3.238 Vali Acc: 0.510 Test Loss: 3.238 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4588887691497803
Epoch: 10, Steps: 18 | Train Loss: 0.663 Vali Loss: 4.663 Vali Acc: 0.480 Test Loss: 4.663 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5233678817749023
Epoch: 11, Steps: 18 | Train Loss: 0.526 Vali Loss: 3.451 Vali Acc: 0.500 Test Loss: 3.451 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.3689663410186768
Epoch: 12, Steps: 18 | Train Loss: 0.259 Vali Loss: 3.072 Vali Acc: 0.550 Test Loss: 3.072 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.4070675373077393
Epoch: 13, Steps: 18 | Train Loss: 0.193 Vali Loss: 3.800 Vali Acc: 0.570 Test Loss: 3.800 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.349066734313965
Epoch: 14, Steps: 18 | Train Loss: 0.217 Vali Loss: 4.398 Vali Acc: 0.480 Test Loss: 4.398 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 252738
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.799375534057617
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 1.009 Vali Acc: 0.480 Test Loss: 1.009 Test Acc: 0.480
Validation loss decreased (inf --> -0.479990).  Saving model ...
Epoch: 2 cost time: 3.2190744876861572
Epoch: 2, Steps: 18 | Train Loss: 0.973 Vali Loss: 1.176 Vali Acc: 0.460 Test Loss: 1.176 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4097211360931396
Epoch: 3, Steps: 18 | Train Loss: 0.614 Vali Loss: 1.048 Vali Acc: 0.520 Test Loss: 1.048 Test Acc: 0.520
Validation loss decreased (-0.479990 --> -0.519990).  Saving model ...
Epoch: 4 cost time: 3.4464352130889893
Epoch: 4, Steps: 18 | Train Loss: 0.590 Vali Loss: 1.290 Vali Acc: 0.510 Test Loss: 1.290 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.637347936630249
Epoch: 5, Steps: 18 | Train Loss: 0.633 Vali Loss: 1.379 Vali Acc: 0.570 Test Loss: 1.379 Test Acc: 0.570
Validation loss decreased (-0.519990 --> -0.569986).  Saving model ...
Epoch: 6 cost time: 3.385268211364746
Epoch: 6, Steps: 18 | Train Loss: 0.516 Vali Loss: 1.232 Vali Acc: 0.610 Test Loss: 1.232 Test Acc: 0.610
Validation loss decreased (-0.569986 --> -0.609988).  Saving model ...
Epoch: 7 cost time: 3.8815133571624756
Epoch: 7, Steps: 18 | Train Loss: 0.373 Vali Loss: 1.819 Vali Acc: 0.500 Test Loss: 1.819 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.213081121444702
Epoch: 8, Steps: 18 | Train Loss: 0.365 Vali Loss: 3.024 Vali Acc: 0.480 Test Loss: 3.024 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.63204026222229
Epoch: 9, Steps: 18 | Train Loss: 0.595 Vali Loss: 2.780 Vali Acc: 0.510 Test Loss: 2.780 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.789360284805298
Epoch: 10, Steps: 18 | Train Loss: 0.292 Vali Loss: 2.551 Vali Acc: 0.510 Test Loss: 2.551 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6963307857513428
Epoch: 11, Steps: 18 | Train Loss: 0.235 Vali Loss: 2.703 Vali Acc: 0.490 Test Loss: 2.703 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4952502250671387
Epoch: 12, Steps: 18 | Train Loss: 0.377 Vali Loss: 3.241 Vali Acc: 0.470 Test Loss: 3.241 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.106708765029907
Epoch: 13, Steps: 18 | Train Loss: 0.346 Vali Loss: 3.358 Vali Acc: 0.520 Test Loss: 3.358 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1620335578918457
Epoch: 14, Steps: 18 | Train Loss: 0.450 Vali Loss: 4.708 Vali Acc: 0.500 Test Loss: 4.708 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.69439959526062
Epoch: 15, Steps: 18 | Train Loss: 0.120 Vali Loss: 4.513 Vali Acc: 0.460 Test Loss: 4.513 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8128528594970703
Epoch: 16, Steps: 18 | Train Loss: 0.139 Vali Loss: 5.538 Vali Acc: 0.470 Test Loss: 5.538 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 208386
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.263081073760986
Epoch: 1, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.689 Vali Acc: 0.570 Test Loss: 0.689 Test Acc: 0.570
Validation loss decreased (inf --> -0.569993).  Saving model ...
Epoch: 2 cost time: 2.8285863399505615
Epoch: 2, Steps: 18 | Train Loss: 0.750 Vali Loss: 1.156 Vali Acc: 0.520 Test Loss: 1.156 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.247357130050659
Epoch: 3, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.982 Vali Acc: 0.550 Test Loss: 0.982 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8953750133514404
Epoch: 4, Steps: 18 | Train Loss: 0.654 Vali Loss: 0.990 Vali Acc: 0.600 Test Loss: 0.990 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 3.5546178817749023
Epoch: 5, Steps: 18 | Train Loss: 0.496 Vali Loss: 1.173 Vali Acc: 0.490 Test Loss: 1.173 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4431381225585938
Epoch: 6, Steps: 18 | Train Loss: 0.484 Vali Loss: 1.471 Vali Acc: 0.590 Test Loss: 1.471 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3507349491119385
Epoch: 7, Steps: 18 | Train Loss: 0.346 Vali Loss: 1.430 Vali Acc: 0.480 Test Loss: 1.430 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.540607452392578
Epoch: 8, Steps: 18 | Train Loss: 0.296 Vali Loss: 1.393 Vali Acc: 0.530 Test Loss: 1.393 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.5626070499420166
Epoch: 9, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.753 Vali Acc: 0.520 Test Loss: 1.753 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.9154038429260254
Epoch: 10, Steps: 18 | Train Loss: 0.248 Vali Loss: 1.984 Vali Acc: 0.490 Test Loss: 1.984 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2552361488342285
Epoch: 11, Steps: 18 | Train Loss: 0.374 Vali Loss: 2.300 Vali Acc: 0.490 Test Loss: 2.300 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.096855640411377
Epoch: 12, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.906 Vali Acc: 0.470 Test Loss: 1.906 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.436579942703247
Epoch: 13, Steps: 18 | Train Loss: 0.190 Vali Loss: 2.808 Vali Acc: 0.510 Test Loss: 2.808 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.809532403945923
Epoch: 14, Steps: 18 | Train Loss: 0.226 Vali Loss: 3.703 Vali Acc: 0.500 Test Loss: 3.703 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 160642
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.018761873245239
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.689 Vali Acc: 0.600 Test Loss: 0.689 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 3.0768425464630127
Epoch: 2, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.737 Vali Acc: 0.530 Test Loss: 0.737 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.196852684020996
Epoch: 3, Steps: 18 | Train Loss: 0.659 Vali Loss: 0.803 Vali Acc: 0.540 Test Loss: 0.803 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4026293754577637
Epoch: 4, Steps: 18 | Train Loss: 0.533 Vali Loss: 0.897 Vali Acc: 0.520 Test Loss: 0.897 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.9066214561462402
Epoch: 5, Steps: 18 | Train Loss: 0.425 Vali Loss: 1.061 Vali Acc: 0.480 Test Loss: 1.061 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.096782684326172
Epoch: 6, Steps: 18 | Train Loss: 0.489 Vali Loss: 1.484 Vali Acc: 0.480 Test Loss: 1.484 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4104654788970947
Epoch: 7, Steps: 18 | Train Loss: 0.362 Vali Loss: 1.250 Vali Acc: 0.610 Test Loss: 1.250 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609988).  Saving model ...
Epoch: 8 cost time: 3.6601052284240723
Epoch: 8, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.417 Vali Acc: 0.480 Test Loss: 1.417 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.610511064529419
Epoch: 9, Steps: 18 | Train Loss: 0.222 Vali Loss: 1.674 Vali Acc: 0.500 Test Loss: 1.674 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0840606689453125
Epoch: 10, Steps: 18 | Train Loss: 0.229 Vali Loss: 1.440 Vali Acc: 0.600 Test Loss: 1.440 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2471463680267334
Epoch: 11, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.894 Vali Acc: 0.470 Test Loss: 1.894 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.922962188720703
Epoch: 12, Steps: 18 | Train Loss: 0.137 Vali Loss: 1.993 Vali Acc: 0.520 Test Loss: 1.993 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.56632661819458
Epoch: 13, Steps: 18 | Train Loss: 0.125 Vali Loss: 2.084 Vali Acc: 0.480 Test Loss: 2.084 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5417840480804443
Epoch: 14, Steps: 18 | Train Loss: 0.127 Vali Loss: 2.614 Vali Acc: 0.490 Test Loss: 2.614 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.0323362350463867
Epoch: 15, Steps: 18 | Train Loss: 0.087 Vali Loss: 3.110 Vali Acc: 0.530 Test Loss: 3.110 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4610562324523926
Epoch: 16, Steps: 18 | Train Loss: 0.085 Vali Loss: 3.408 Vali Acc: 0.480 Test Loss: 3.408 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.3389225006103516
Epoch: 17, Steps: 18 | Train Loss: 0.259 Vali Loss: 3.148 Vali Acc: 0.500 Test Loss: 3.148 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 145666
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.911403179168701
Epoch: 1, Steps: 18 | Train Loss: 0.800 Vali Loss: 0.867 Vali Acc: 0.460 Test Loss: 0.867 Test Acc: 0.460
Validation loss decreased (inf --> -0.459991).  Saving model ...
Epoch: 2 cost time: 3.1190741062164307
Epoch: 2, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.873 Vali Acc: 0.540 Test Loss: 0.873 Test Acc: 0.540
Validation loss decreased (-0.459991 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 2.99372935295105
Epoch: 3, Steps: 18 | Train Loss: 0.622 Vali Loss: 0.886 Vali Acc: 0.530 Test Loss: 0.886 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1734957695007324
Epoch: 4, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.914 Vali Acc: 0.620 Test Loss: 0.914 Test Acc: 0.620
Validation loss decreased (-0.539991 --> -0.619991).  Saving model ...
Epoch: 5 cost time: 2.9039201736450195
Epoch: 5, Steps: 18 | Train Loss: 0.593 Vali Loss: 1.212 Vali Acc: 0.470 Test Loss: 1.212 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1722331047058105
Epoch: 6, Steps: 18 | Train Loss: 0.424 Vali Loss: 1.153 Vali Acc: 0.460 Test Loss: 1.153 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1244499683380127
Epoch: 7, Steps: 18 | Train Loss: 0.382 Vali Loss: 1.100 Vali Acc: 0.570 Test Loss: 1.100 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1191272735595703
Epoch: 8, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.075 Vali Acc: 0.530 Test Loss: 1.075 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.288870334625244
Epoch: 9, Steps: 18 | Train Loss: 0.281 Vali Loss: 1.265 Vali Acc: 0.510 Test Loss: 1.265 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3514790534973145
Epoch: 10, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.694 Vali Acc: 0.440 Test Loss: 1.694 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.663940668106079
Epoch: 11, Steps: 18 | Train Loss: 0.223 Vali Loss: 1.631 Vali Acc: 0.490 Test Loss: 1.631 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2880237102508545
Epoch: 12, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.595 Vali Acc: 0.520 Test Loss: 1.595 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0366759300231934
Epoch: 13, Steps: 18 | Train Loss: 0.199 Vali Loss: 2.049 Vali Acc: 0.500 Test Loss: 2.049 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7057642936706543
Epoch: 14, Steps: 18 | Train Loss: 0.253 Vali Loss: 1.952 Vali Acc: 0.540 Test Loss: 1.952 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm64_nh16_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 138882
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.901184797286987
Epoch: 1, Steps: 18 | Train Loss: 0.907 Vali Loss: 1.058 Vali Acc: 0.520 Test Loss: 1.058 Test Acc: 0.520
Validation loss decreased (inf --> -0.519989).  Saving model ...
Epoch: 2 cost time: 3.7120895385742188
Epoch: 2, Steps: 18 | Train Loss: 0.901 Vali Loss: 0.849 Vali Acc: 0.570 Test Loss: 0.849 Test Acc: 0.570
Validation loss decreased (-0.519989 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 3.8225491046905518
Epoch: 3, Steps: 18 | Train Loss: 1.182 Vali Loss: 1.721 Vali Acc: 0.470 Test Loss: 1.721 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9049105644226074
Epoch: 4, Steps: 18 | Train Loss: 0.774 Vali Loss: 3.325 Vali Acc: 0.530 Test Loss: 3.325 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.930100202560425
Epoch: 5, Steps: 18 | Train Loss: 0.825 Vali Loss: 2.251 Vali Acc: 0.520 Test Loss: 2.251 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.9668948650360107
Epoch: 6, Steps: 18 | Train Loss: 1.234 Vali Loss: 1.913 Vali Acc: 0.570 Test Loss: 1.913 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7771928310394287
Epoch: 7, Steps: 18 | Train Loss: 1.133 Vali Loss: 2.884 Vali Acc: 0.500 Test Loss: 2.884 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6252875328063965
Epoch: 8, Steps: 18 | Train Loss: 0.605 Vali Loss: 3.613 Vali Acc: 0.490 Test Loss: 3.613 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.351402521133423
Epoch: 9, Steps: 18 | Train Loss: 0.501 Vali Loss: 4.962 Vali Acc: 0.490 Test Loss: 4.962 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.5598669052124023
Epoch: 10, Steps: 18 | Train Loss: 0.593 Vali Loss: 4.201 Vali Acc: 0.560 Test Loss: 4.201 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.7101404666900635
Epoch: 11, Steps: 18 | Train Loss: 0.634 Vali Loss: 5.012 Vali Acc: 0.540 Test Loss: 5.012 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.6810476779937744
Epoch: 12, Steps: 18 | Train Loss: 0.647 Vali Loss: 5.540 Vali Acc: 0.540 Test Loss: 5.540 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 342978
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.9399940967559814
Epoch: 1, Steps: 18 | Train Loss: 0.856 Vali Loss: 0.776 Vali Acc: 0.510 Test Loss: 0.776 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.201042413711548
Epoch: 2, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.829 Vali Acc: 0.590 Test Loss: 0.829 Test Acc: 0.590
Validation loss decreased (-0.509992 --> -0.589992).  Saving model ...
Epoch: 3 cost time: 3.0822250843048096
Epoch: 3, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.995 Vali Acc: 0.560 Test Loss: 0.995 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4792072772979736
Epoch: 4, Steps: 18 | Train Loss: 0.573 Vali Loss: 1.699 Vali Acc: 0.470 Test Loss: 1.699 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.195770740509033
Epoch: 5, Steps: 18 | Train Loss: 0.720 Vali Loss: 1.700 Vali Acc: 0.510 Test Loss: 1.700 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2004215717315674
Epoch: 6, Steps: 18 | Train Loss: 0.609 Vali Loss: 1.807 Vali Acc: 0.460 Test Loss: 1.807 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.331657886505127
Epoch: 7, Steps: 18 | Train Loss: 0.474 Vali Loss: 2.452 Vali Acc: 0.470 Test Loss: 2.452 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3298990726470947
Epoch: 8, Steps: 18 | Train Loss: 0.612 Vali Loss: 1.856 Vali Acc: 0.480 Test Loss: 1.856 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0869781970977783
Epoch: 9, Steps: 18 | Train Loss: 0.327 Vali Loss: 2.382 Vali Acc: 0.450 Test Loss: 2.382 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1892306804656982
Epoch: 10, Steps: 18 | Train Loss: 0.209 Vali Loss: 2.725 Vali Acc: 0.490 Test Loss: 2.725 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.9082508087158203
Epoch: 11, Steps: 18 | Train Loss: 0.122 Vali Loss: 3.126 Vali Acc: 0.470 Test Loss: 3.126 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.2776331901550293
Epoch: 12, Steps: 18 | Train Loss: 0.178 Vali Loss: 3.463 Vali Acc: 0.500 Test Loss: 3.463 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 189730
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.703131675720215
Epoch: 1, Steps: 18 | Train Loss: 0.800 Vali Loss: 0.766 Vali Acc: 0.520 Test Loss: 0.766 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 3.569406032562256
Epoch: 2, Steps: 18 | Train Loss: 0.761 Vali Loss: 1.041 Vali Acc: 0.510 Test Loss: 1.041 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3069043159484863
Epoch: 3, Steps: 18 | Train Loss: 0.782 Vali Loss: 1.144 Vali Acc: 0.490 Test Loss: 1.144 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.986311197280884
Epoch: 4, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.858 Vali Acc: 0.590 Test Loss: 0.858 Test Acc: 0.590
Validation loss decreased (-0.519992 --> -0.589991).  Saving model ...
Epoch: 5 cost time: 2.946997880935669
Epoch: 5, Steps: 18 | Train Loss: 0.576 Vali Loss: 1.052 Vali Acc: 0.630 Test Loss: 1.052 Test Acc: 0.630
Validation loss decreased (-0.589991 --> -0.629989).  Saving model ...
Epoch: 6 cost time: 3.171816110610962
Epoch: 6, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.177 Vali Acc: 0.580 Test Loss: 1.177 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.154773712158203
Epoch: 7, Steps: 18 | Train Loss: 0.495 Vali Loss: 1.509 Vali Acc: 0.550 Test Loss: 1.509 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.000520706176758
Epoch: 8, Steps: 18 | Train Loss: 0.285 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9034481048583984
Epoch: 9, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.581 Vali Acc: 0.510 Test Loss: 1.581 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.5065956115722656
Epoch: 10, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.722 Vali Acc: 0.560 Test Loss: 1.722 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.850802421569824
Epoch: 11, Steps: 18 | Train Loss: 0.138 Vali Loss: 2.140 Vali Acc: 0.460 Test Loss: 2.140 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.277789354324341
Epoch: 12, Steps: 18 | Train Loss: 0.118 Vali Loss: 2.644 Vali Acc: 0.450 Test Loss: 2.644 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.5571742057800293
Epoch: 13, Steps: 18 | Train Loss: 0.145 Vali Loss: 2.450 Vali Acc: 0.490 Test Loss: 2.450 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9351799488067627
Epoch: 14, Steps: 18 | Train Loss: 0.103 Vali Loss: 2.717 Vali Acc: 0.530 Test Loss: 2.717 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.286128282546997
Epoch: 15, Steps: 18 | Train Loss: 0.088 Vali Loss: 2.758 Vali Acc: 0.520 Test Loss: 2.758 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 134786
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 9.031261920928955
Epoch: 1, Steps: 18 | Train Loss: 0.822 Vali Loss: 0.786 Vali Acc: 0.510 Test Loss: 0.786 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.268610715866089
Epoch: 2, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.775 Vali Acc: 0.570 Test Loss: 0.775 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569992).  Saving model ...
Epoch: 3 cost time: 3.8550331592559814
Epoch: 3, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.810 Vali Acc: 0.660 Test Loss: 0.810 Test Acc: 0.660
Validation loss decreased (-0.569992 --> -0.659992).  Saving model ...
Epoch: 4 cost time: 3.8725697994232178
Epoch: 4, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.976 Vali Acc: 0.550 Test Loss: 0.976 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.868103265762329
Epoch: 5, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.987 Vali Acc: 0.560 Test Loss: 0.987 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3917274475097656
Epoch: 6, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.950 Vali Acc: 0.570 Test Loss: 0.950 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8256187438964844
Epoch: 7, Steps: 18 | Train Loss: 0.375 Vali Loss: 1.097 Vali Acc: 0.570 Test Loss: 1.097 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.7811336517333984
Epoch: 8, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.246 Vali Acc: 0.570 Test Loss: 1.246 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.5523722171783447
Epoch: 9, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.544 Vali Acc: 0.550 Test Loss: 1.544 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.041291236877441
Epoch: 10, Steps: 18 | Train Loss: 0.176 Vali Loss: 1.554 Vali Acc: 0.520 Test Loss: 1.554 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1548688411712646
Epoch: 11, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.696 Vali Acc: 0.520 Test Loss: 1.696 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.535337448120117
Epoch: 12, Steps: 18 | Train Loss: 0.123 Vali Loss: 2.023 Vali Acc: 0.520 Test Loss: 2.023 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.7608001232147217
Epoch: 13, Steps: 18 | Train Loss: 0.089 Vali Loss: 2.200 Vali Acc: 0.540 Test Loss: 2.200 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 112610
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.9027934074401855
Epoch: 1, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.701 Vali Acc: 0.600 Test Loss: 0.701 Test Acc: 0.600
Validation loss decreased (inf --> -0.599993).  Saving model ...
Epoch: 2 cost time: 3.2836527824401855
Epoch: 2, Steps: 18 | Train Loss: 0.690 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0860722064971924
Epoch: 3, Steps: 18 | Train Loss: 0.665 Vali Loss: 0.701 Vali Acc: 0.590 Test Loss: 0.701 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8089778423309326
Epoch: 4, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.872 Vali Acc: 0.550 Test Loss: 0.872 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2091736793518066
Epoch: 5, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.923 Vali Acc: 0.610 Test Loss: 0.923 Test Acc: 0.610
Validation loss decreased (-0.599993 --> -0.609991).  Saving model ...
Epoch: 6 cost time: 3.589320659637451
Epoch: 6, Steps: 18 | Train Loss: 0.402 Vali Loss: 0.993 Vali Acc: 0.550 Test Loss: 0.993 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.29191517829895
Epoch: 7, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.045 Vali Acc: 0.570 Test Loss: 1.045 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1383256912231445
Epoch: 8, Steps: 18 | Train Loss: 0.347 Vali Loss: 1.098 Vali Acc: 0.570 Test Loss: 1.098 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.619222640991211
Epoch: 9, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.091 Vali Acc: 0.530 Test Loss: 1.091 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.988279342651367
Epoch: 10, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.420 Vali Acc: 0.540 Test Loss: 1.420 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4010868072509766
Epoch: 11, Steps: 18 | Train Loss: 0.199 Vali Loss: 1.337 Vali Acc: 0.570 Test Loss: 1.337 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4039978981018066
Epoch: 12, Steps: 18 | Train Loss: 0.145 Vali Loss: 1.384 Vali Acc: 0.550 Test Loss: 1.384 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.073582649230957
Epoch: 13, Steps: 18 | Train Loss: 0.146 Vali Loss: 1.712 Vali Acc: 0.510 Test Loss: 1.712 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.910175085067749
Epoch: 14, Steps: 18 | Train Loss: 0.095 Vali Loss: 1.970 Vali Acc: 0.470 Test Loss: 1.970 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.085035800933838
Epoch: 15, Steps: 18 | Train Loss: 0.073 Vali Loss: 1.611 Vali Acc: 0.520 Test Loss: 1.611 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 88738
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.417202472686768
Epoch: 1, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.723 Vali Acc: 0.510 Test Loss: 0.723 Test Acc: 0.510
Validation loss decreased (inf --> -0.509993).  Saving model ...
Epoch: 2 cost time: 2.6610121726989746
Epoch: 2, Steps: 18 | Train Loss: 0.723 Vali Loss: 0.802 Vali Acc: 0.510 Test Loss: 0.802 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7228477001190186
Epoch: 3, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.766 Vali Acc: 0.580 Test Loss: 0.766 Test Acc: 0.580
Validation loss decreased (-0.509993 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 3.0566368103027344
Epoch: 4, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.848 Vali Acc: 0.580 Test Loss: 0.848 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7196192741394043
Epoch: 5, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.855 Vali Acc: 0.480 Test Loss: 0.855 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.826272487640381
Epoch: 6, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.801 Vali Acc: 0.540 Test Loss: 0.801 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9543914794921875
Epoch: 7, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.867 Vali Acc: 0.550 Test Loss: 0.867 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7119903564453125
Epoch: 8, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.959 Vali Acc: 0.530 Test Loss: 0.959 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8971927165985107
Epoch: 9, Steps: 18 | Train Loss: 0.292 Vali Loss: 1.402 Vali Acc: 0.480 Test Loss: 1.402 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6468541622161865
Epoch: 10, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.220 Vali Acc: 0.530 Test Loss: 1.220 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.458752155303955
Epoch: 11, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.287 Vali Acc: 0.530 Test Loss: 1.287 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.42987322807312
Epoch: 12, Steps: 18 | Train Loss: 0.211 Vali Loss: 1.310 Vali Acc: 0.480 Test Loss: 1.310 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.924527168273926
Epoch: 13, Steps: 18 | Train Loss: 0.120 Vali Loss: 1.331 Vali Acc: 0.540 Test Loss: 1.331 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 81250
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.048453330993652
Epoch: 1, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.754 Vali Acc: 0.510 Test Loss: 0.754 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 2.6180648803710938
Epoch: 2, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
Validation loss decreased (-0.509992 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 3.0186243057250977
Epoch: 3, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.698 Vali Acc: 0.570 Test Loss: 0.698 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.2299718856811523
Epoch: 4, Steps: 18 | Train Loss: 0.545 Vali Loss: 0.792 Vali Acc: 0.510 Test Loss: 0.792 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.390958547592163
Epoch: 5, Steps: 18 | Train Loss: 0.542 Vali Loss: 0.755 Vali Acc: 0.610 Test Loss: 0.755 Test Acc: 0.610
Validation loss decreased (-0.569993 --> -0.609992).  Saving model ...
Epoch: 6 cost time: 2.973515748977661
Epoch: 6, Steps: 18 | Train Loss: 0.497 Vali Loss: 0.813 Vali Acc: 0.540 Test Loss: 0.813 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4478180408477783
Epoch: 7, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.842 Vali Acc: 0.570 Test Loss: 0.842 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8313660621643066
Epoch: 8, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.832 Vali Acc: 0.540 Test Loss: 0.832 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9444262981414795
Epoch: 9, Steps: 18 | Train Loss: 0.285 Vali Loss: 0.955 Vali Acc: 0.550 Test Loss: 0.955 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0185399055480957
Epoch: 10, Steps: 18 | Train Loss: 0.252 Vali Loss: 1.022 Vali Acc: 0.520 Test Loss: 1.022 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0038135051727295
Epoch: 11, Steps: 18 | Train Loss: 0.261 Vali Loss: 0.988 Vali Acc: 0.560 Test Loss: 0.988 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.861828565597534
Epoch: 12, Steps: 18 | Train Loss: 0.245 Vali Loss: 1.135 Vali Acc: 0.560 Test Loss: 1.135 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.991436243057251
Epoch: 13, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.171 Vali Acc: 0.480 Test Loss: 1.171 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.339949607849121
Epoch: 14, Steps: 18 | Train Loss: 0.121 Vali Loss: 1.203 Vali Acc: 0.570 Test Loss: 1.203 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8015635013580322
Epoch: 15, Steps: 18 | Train Loss: 0.127 Vali Loss: 1.166 Vali Acc: 0.570 Test Loss: 1.166 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 77858
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.033968925476074
Epoch: 1, Steps: 18 | Train Loss: 0.986 Vali Loss: 1.512 Vali Acc: 0.480 Test Loss: 1.512 Test Acc: 0.480
Validation loss decreased (inf --> -0.479985).  Saving model ...
Epoch: 2 cost time: 5.286662817001343
Epoch: 2, Steps: 18 | Train Loss: 1.601 Vali Loss: 2.800 Vali Acc: 0.500 Test Loss: 2.800 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499972).  Saving model ...
Epoch: 3 cost time: 5.305369138717651
Epoch: 3, Steps: 18 | Train Loss: 1.107 Vali Loss: 1.162 Vali Acc: 0.560 Test Loss: 1.162 Test Acc: 0.560
Validation loss decreased (-0.499972 --> -0.559988).  Saving model ...
Epoch: 4 cost time: 4.799747943878174
Epoch: 4, Steps: 18 | Train Loss: 0.815 Vali Loss: 1.548 Vali Acc: 0.510 Test Loss: 1.548 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.569572925567627
Epoch: 5, Steps: 18 | Train Loss: 1.231 Vali Loss: 2.155 Vali Acc: 0.480 Test Loss: 2.155 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.580361843109131
Epoch: 6, Steps: 18 | Train Loss: 0.836 Vali Loss: 1.958 Vali Acc: 0.560 Test Loss: 1.958 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.667797327041626
Epoch: 7, Steps: 18 | Train Loss: 0.669 Vali Loss: 3.007 Vali Acc: 0.510 Test Loss: 3.007 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.117157697677612
Epoch: 8, Steps: 18 | Train Loss: 0.504 Vali Loss: 3.034 Vali Acc: 0.440 Test Loss: 3.034 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.382086992263794
Epoch: 9, Steps: 18 | Train Loss: 0.438 Vali Loss: 3.202 Vali Acc: 0.540 Test Loss: 3.202 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.12272572517395
Epoch: 10, Steps: 18 | Train Loss: 0.696 Vali Loss: 3.377 Vali Acc: 0.550 Test Loss: 3.377 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.314589500427246
Epoch: 11, Steps: 18 | Train Loss: 1.349 Vali Loss: 4.717 Vali Acc: 0.530 Test Loss: 4.717 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.112472295761108
Epoch: 12, Steps: 18 | Train Loss: 0.640 Vali Loss: 4.708 Vali Acc: 0.540 Test Loss: 4.708 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.991471767425537
Epoch: 13, Steps: 18 | Train Loss: 0.201 Vali Loss: 4.656 Vali Acc: 0.530 Test Loss: 4.656 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 334658
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.447250843048096
Epoch: 1, Steps: 18 | Train Loss: 0.869 Vali Loss: 1.032 Vali Acc: 0.510 Test Loss: 1.032 Test Acc: 0.510
Validation loss decreased (inf --> -0.509990).  Saving model ...
Epoch: 2 cost time: 2.926515579223633
Epoch: 2, Steps: 18 | Train Loss: 0.759 Vali Loss: 0.853 Vali Acc: 0.530 Test Loss: 0.853 Test Acc: 0.530
Validation loss decreased (-0.509990 --> -0.529991).  Saving model ...
Epoch: 3 cost time: 3.862398147583008
Epoch: 3, Steps: 18 | Train Loss: 0.751 Vali Loss: 1.922 Vali Acc: 0.480 Test Loss: 1.922 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1090595722198486
Epoch: 4, Steps: 18 | Train Loss: 0.566 Vali Loss: 1.272 Vali Acc: 0.530 Test Loss: 1.272 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1103789806365967
Epoch: 5, Steps: 18 | Train Loss: 0.826 Vali Loss: 1.593 Vali Acc: 0.510 Test Loss: 1.593 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.00582218170166
Epoch: 6, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.525 Vali Acc: 0.590 Test Loss: 1.525 Test Acc: 0.590
Validation loss decreased (-0.529991 --> -0.589985).  Saving model ...
Epoch: 7 cost time: 2.9016551971435547
Epoch: 7, Steps: 18 | Train Loss: 0.638 Vali Loss: 2.373 Vali Acc: 0.500 Test Loss: 2.373 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5589442253112793
Epoch: 8, Steps: 18 | Train Loss: 0.868 Vali Loss: 2.214 Vali Acc: 0.540 Test Loss: 2.214 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.640604257583618
Epoch: 9, Steps: 18 | Train Loss: 0.381 Vali Loss: 2.382 Vali Acc: 0.560 Test Loss: 2.382 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.297508478164673
Epoch: 10, Steps: 18 | Train Loss: 0.344 Vali Loss: 2.327 Vali Acc: 0.550 Test Loss: 2.327 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8856189250946045
Epoch: 11, Steps: 18 | Train Loss: 0.491 Vali Loss: 4.096 Vali Acc: 0.500 Test Loss: 4.096 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.864720582962036
Epoch: 12, Steps: 18 | Train Loss: 0.258 Vali Loss: 2.863 Vali Acc: 0.560 Test Loss: 2.863 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.221149444580078
Epoch: 13, Steps: 18 | Train Loss: 0.146 Vali Loss: 4.669 Vali Acc: 0.510 Test Loss: 4.669 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.6838886737823486
Epoch: 14, Steps: 18 | Train Loss: 0.418 Vali Loss: 4.313 Vali Acc: 0.500 Test Loss: 4.313 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.035224199295044
Epoch: 15, Steps: 18 | Train Loss: 0.124 Vali Loss: 4.094 Vali Acc: 0.580 Test Loss: 4.094 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8981754779815674
Epoch: 16, Steps: 18 | Train Loss: 0.218 Vali Loss: 5.541 Vali Acc: 0.500 Test Loss: 5.541 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 181410
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.078877687454224
Epoch: 1, Steps: 18 | Train Loss: 0.874 Vali Loss: 0.740 Vali Acc: 0.630 Test Loss: 0.740 Test Acc: 0.630
Validation loss decreased (inf --> -0.629993).  Saving model ...
Epoch: 2 cost time: 3.3737130165100098
Epoch: 2, Steps: 18 | Train Loss: 0.716 Vali Loss: 0.762 Vali Acc: 0.530 Test Loss: 0.762 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5801548957824707
Epoch: 3, Steps: 18 | Train Loss: 0.723 Vali Loss: 1.228 Vali Acc: 0.570 Test Loss: 1.228 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2066738605499268
Epoch: 4, Steps: 18 | Train Loss: 0.571 Vali Loss: 1.738 Vali Acc: 0.520 Test Loss: 1.738 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.5226991176605225
Epoch: 5, Steps: 18 | Train Loss: 0.756 Vali Loss: 1.212 Vali Acc: 0.520 Test Loss: 1.212 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.913567066192627
Epoch: 6, Steps: 18 | Train Loss: 0.441 Vali Loss: 1.048 Vali Acc: 0.500 Test Loss: 1.048 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.27647066116333
Epoch: 7, Steps: 18 | Train Loss: 0.353 Vali Loss: 1.324 Vali Acc: 0.550 Test Loss: 1.324 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.012876033782959
Epoch: 8, Steps: 18 | Train Loss: 0.393 Vali Loss: 1.394 Vali Acc: 0.570 Test Loss: 1.394 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1115620136260986
Epoch: 9, Steps: 18 | Train Loss: 0.400 Vali Loss: 1.471 Vali Acc: 0.530 Test Loss: 1.471 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.418179750442505
Epoch: 10, Steps: 18 | Train Loss: 0.389 Vali Loss: 1.273 Vali Acc: 0.530 Test Loss: 1.273 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.4193170070648193
Epoch: 11, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.518 Vali Acc: 0.540 Test Loss: 1.518 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 126466
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.621837139129639
Epoch: 1, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.755 Vali Acc: 0.530 Test Loss: 0.755 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.053992986679077
Epoch: 2, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.703 Vali Acc: 0.560 Test Loss: 0.703 Test Acc: 0.560
Validation loss decreased (-0.529992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 3.132460594177246
Epoch: 3, Steps: 18 | Train Loss: 0.676 Vali Loss: 0.790 Vali Acc: 0.560 Test Loss: 0.790 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7704567909240723
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.858 Vali Acc: 0.590 Test Loss: 0.858 Test Acc: 0.590
Validation loss decreased (-0.559993 --> -0.589991).  Saving model ...
Epoch: 5 cost time: 2.859950065612793
Epoch: 5, Steps: 18 | Train Loss: 0.473 Vali Loss: 0.932 Vali Acc: 0.550 Test Loss: 0.932 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.529348134994507
Epoch: 6, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5845377445220947
Epoch: 7, Steps: 18 | Train Loss: 0.318 Vali Loss: 1.277 Vali Acc: 0.570 Test Loss: 1.277 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8277359008789062
Epoch: 8, Steps: 18 | Train Loss: 0.286 Vali Loss: 1.119 Vali Acc: 0.570 Test Loss: 1.119 Test Acc: 0.570
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1863536834716797
Epoch: 9, Steps: 18 | Train Loss: 0.231 Vali Loss: 1.313 Vali Acc: 0.530 Test Loss: 1.313 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9873509407043457
Epoch: 10, Steps: 18 | Train Loss: 0.180 Vali Loss: 3.396 Vali Acc: 0.520 Test Loss: 3.396 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.768767833709717
Epoch: 11, Steps: 18 | Train Loss: 0.412 Vali Loss: 1.576 Vali Acc: 0.560 Test Loss: 1.576 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.313041925430298
Epoch: 12, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.860 Vali Acc: 0.500 Test Loss: 1.860 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.530258893966675
Epoch: 13, Steps: 18 | Train Loss: 0.145 Vali Loss: 2.373 Vali Acc: 0.490 Test Loss: 2.373 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9843554496765137
Epoch: 14, Steps: 18 | Train Loss: 0.119 Vali Loss: 2.030 Vali Acc: 0.570 Test Loss: 2.030 Test Acc: 0.570
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 104290
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.511094808578491
Epoch: 1, Steps: 18 | Train Loss: 0.810 Vali Loss: 0.749 Vali Acc: 0.440 Test Loss: 0.749 Test Acc: 0.440
Validation loss decreased (inf --> -0.439993).  Saving model ...
Epoch: 2 cost time: 2.9540481567382812
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.867 Vali Acc: 0.450 Test Loss: 0.867 Test Acc: 0.450
Validation loss decreased (-0.439993 --> -0.449991).  Saving model ...
Epoch: 3 cost time: 2.8837850093841553
Epoch: 3, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.788 Vali Acc: 0.590 Test Loss: 0.788 Test Acc: 0.590
Validation loss decreased (-0.449991 --> -0.589992).  Saving model ...
Epoch: 4 cost time: 2.8018765449523926
Epoch: 4, Steps: 18 | Train Loss: 0.557 Vali Loss: 1.006 Vali Acc: 0.440 Test Loss: 1.006 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5565764904022217
Epoch: 5, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.936 Vali Acc: 0.550 Test Loss: 0.936 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6523678302764893
Epoch: 6, Steps: 18 | Train Loss: 0.466 Vali Loss: 0.992 Vali Acc: 0.520 Test Loss: 0.992 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.989511251449585
Epoch: 7, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.829 Vali Acc: 0.600 Test Loss: 0.829 Test Acc: 0.600
Validation loss decreased (-0.589992 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 2.982897996902466
Epoch: 8, Steps: 18 | Train Loss: 0.328 Vali Loss: 1.112 Vali Acc: 0.520 Test Loss: 1.112 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0111727714538574
Epoch: 9, Steps: 18 | Train Loss: 0.265 Vali Loss: 1.406 Vali Acc: 0.500 Test Loss: 1.406 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.187433958053589
Epoch: 10, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.472 Vali Acc: 0.470 Test Loss: 1.472 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.051626682281494
Epoch: 11, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.364 Vali Acc: 0.540 Test Loss: 1.364 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.960257053375244
Epoch: 12, Steps: 18 | Train Loss: 0.174 Vali Loss: 1.599 Vali Acc: 0.520 Test Loss: 1.599 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7997560501098633
Epoch: 13, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.739 Vali Acc: 0.570 Test Loss: 1.739 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.0989789962768555
Epoch: 14, Steps: 18 | Train Loss: 0.159 Vali Loss: 1.523 Vali Acc: 0.550 Test Loss: 1.523 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.4641666412353516
Epoch: 15, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.934 Vali Acc: 0.530 Test Loss: 1.934 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4398326873779297
Epoch: 16, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.912 Vali Acc: 0.520 Test Loss: 1.912 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.08708119392395
Epoch: 17, Steps: 18 | Train Loss: 0.085 Vali Loss: 2.022 Vali Acc: 0.530 Test Loss: 2.022 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 80418
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.050868511199951
Epoch: 1, Steps: 18 | Train Loss: 0.803 Vali Loss: 0.754 Vali Acc: 0.390 Test Loss: 0.754 Test Acc: 0.390
Validation loss decreased (inf --> -0.389992).  Saving model ...
Epoch: 2 cost time: 2.983797311782837
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.713 Vali Acc: 0.560 Test Loss: 0.713 Test Acc: 0.560
Validation loss decreased (-0.389992 --> -0.559993).  Saving model ...
Epoch: 3 cost time: 3.241243839263916
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.798 Vali Acc: 0.570 Test Loss: 0.798 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569992).  Saving model ...
Epoch: 4 cost time: 3.066451072692871
Epoch: 4, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.799 Vali Acc: 0.540 Test Loss: 0.799 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8405590057373047
Epoch: 5, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.850 Vali Acc: 0.520 Test Loss: 0.850 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2836720943450928
Epoch: 6, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.041 Vali Acc: 0.610 Test Loss: 1.041 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609990).  Saving model ...
Epoch: 7 cost time: 2.8165442943573
Epoch: 7, Steps: 18 | Train Loss: 0.488 Vali Loss: 0.989 Vali Acc: 0.520 Test Loss: 0.989 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7710883617401123
Epoch: 8, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.081 Vali Acc: 0.560 Test Loss: 1.081 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9537594318389893
Epoch: 9, Steps: 18 | Train Loss: 0.305 Vali Loss: 1.096 Vali Acc: 0.470 Test Loss: 1.096 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7344279289245605
Epoch: 10, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3531599044799805
Epoch: 11, Steps: 18 | Train Loss: 0.235 Vali Loss: 1.257 Vali Acc: 0.470 Test Loss: 1.257 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1495234966278076
Epoch: 12, Steps: 18 | Train Loss: 0.170 Vali Loss: 1.305 Vali Acc: 0.490 Test Loss: 1.305 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.938297748565674
Epoch: 13, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.323 Vali Acc: 0.510 Test Loss: 1.323 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.620882034301758
Epoch: 14, Steps: 18 | Train Loss: 0.180 Vali Loss: 1.322 Vali Acc: 0.510 Test Loss: 1.322 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.6849865913391113
Epoch: 15, Steps: 18 | Train Loss: 0.138 Vali Loss: 1.744 Vali Acc: 0.510 Test Loss: 1.744 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7034571170806885
Epoch: 16, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.894 Vali Acc: 0.530 Test Loss: 1.894 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 72930
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.020383596420288
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 2.8935797214508057
Epoch: 2, Steps: 18 | Train Loss: 0.678 Vali Loss: 0.726 Vali Acc: 0.600 Test Loss: 0.726 Test Acc: 0.600
Validation loss decreased (-0.539993 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 3.39717960357666
Epoch: 3, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.806 Vali Acc: 0.520 Test Loss: 0.806 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1846582889556885
Epoch: 4, Steps: 18 | Train Loss: 0.601 Vali Loss: 0.797 Vali Acc: 0.550 Test Loss: 0.797 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.161505699157715
Epoch: 5, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.766 Vali Acc: 0.540 Test Loss: 0.766 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0632500648498535
Epoch: 6, Steps: 18 | Train Loss: 0.460 Vali Loss: 0.838 Vali Acc: 0.500 Test Loss: 0.838 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0109918117523193
Epoch: 7, Steps: 18 | Train Loss: 0.414 Vali Loss: 0.901 Vali Acc: 0.450 Test Loss: 0.901 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.090197801589966
Epoch: 8, Steps: 18 | Train Loss: 0.366 Vali Loss: 0.910 Vali Acc: 0.520 Test Loss: 0.910 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.991832733154297
Epoch: 9, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.933 Vali Acc: 0.550 Test Loss: 0.933 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5116045475006104
Epoch: 10, Steps: 18 | Train Loss: 0.303 Vali Loss: 1.018 Vali Acc: 0.530 Test Loss: 1.018 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1899330615997314
Epoch: 11, Steps: 18 | Train Loss: 0.227 Vali Loss: 1.148 Vali Acc: 0.530 Test Loss: 1.148 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.6781837940216064
Epoch: 12, Steps: 18 | Train Loss: 0.204 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 69538
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.791268348693848
Epoch: 1, Steps: 18 | Train Loss: 0.844 Vali Loss: 0.845 Vali Acc: 0.560 Test Loss: 0.845 Test Acc: 0.560
Validation loss decreased (inf --> -0.559992).  Saving model ...
Epoch: 2 cost time: 4.630679130554199
Epoch: 2, Steps: 18 | Train Loss: 0.782 Vali Loss: 1.863 Vali Acc: 0.500 Test Loss: 1.863 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.864037036895752
Epoch: 3, Steps: 18 | Train Loss: 1.143 Vali Loss: 3.871 Vali Acc: 0.500 Test Loss: 3.871 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.849632501602173
Epoch: 4, Steps: 18 | Train Loss: 0.937 Vali Loss: 1.320 Vali Acc: 0.520 Test Loss: 1.320 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7679591178894043
Epoch: 5, Steps: 18 | Train Loss: 1.388 Vali Loss: 3.094 Vali Acc: 0.420 Test Loss: 3.094 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.473407030105591
Epoch: 6, Steps: 18 | Train Loss: 0.866 Vali Loss: 2.668 Vali Acc: 0.570 Test Loss: 2.668 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569973).  Saving model ...
Epoch: 7 cost time: 4.08150839805603
Epoch: 7, Steps: 18 | Train Loss: 1.126 Vali Loss: 2.714 Vali Acc: 0.500 Test Loss: 2.714 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.187297821044922
Epoch: 8, Steps: 18 | Train Loss: 0.695 Vali Loss: 2.278 Vali Acc: 0.540 Test Loss: 2.278 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8302817344665527
Epoch: 9, Steps: 18 | Train Loss: 0.710 Vali Loss: 3.771 Vali Acc: 0.530 Test Loss: 3.771 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.017547369003296
Epoch: 10, Steps: 18 | Train Loss: 0.684 Vali Loss: 3.903 Vali Acc: 0.500 Test Loss: 3.903 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.085483551025391
Epoch: 11, Steps: 18 | Train Loss: 0.684 Vali Loss: 4.289 Vali Acc: 0.490 Test Loss: 4.289 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.436686038970947
Epoch: 12, Steps: 18 | Train Loss: 0.510 Vali Loss: 5.371 Vali Acc: 0.510 Test Loss: 5.371 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.6364898681640625
Epoch: 13, Steps: 18 | Train Loss: 0.270 Vali Loss: 5.023 Vali Acc: 0.530 Test Loss: 5.023 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.555952310562134
Epoch: 14, Steps: 18 | Train Loss: 0.489 Vali Loss: 4.832 Vali Acc: 0.560 Test Loss: 4.832 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.219101667404175
Epoch: 15, Steps: 18 | Train Loss: 0.548 Vali Loss: 6.979 Vali Acc: 0.560 Test Loss: 6.979 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.070648431777954
Epoch: 16, Steps: 18 | Train Loss: 0.216 Vali Loss: 8.035 Vali Acc: 0.520 Test Loss: 8.035 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 330498
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.645787477493286
Epoch: 1, Steps: 18 | Train Loss: 0.916 Vali Loss: 1.105 Vali Acc: 0.510 Test Loss: 1.105 Test Acc: 0.510
Validation loss decreased (inf --> -0.509989).  Saving model ...
Epoch: 2 cost time: 4.206086158752441
Epoch: 2, Steps: 18 | Train Loss: 0.873 Vali Loss: 0.769 Vali Acc: 0.600 Test Loss: 0.769 Test Acc: 0.600
Validation loss decreased (-0.509989 --> -0.599992).  Saving model ...
Epoch: 3 cost time: 4.506088733673096
Epoch: 3, Steps: 18 | Train Loss: 0.646 Vali Loss: 1.277 Vali Acc: 0.510 Test Loss: 1.277 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.902057647705078
Epoch: 4, Steps: 18 | Train Loss: 0.904 Vali Loss: 0.952 Vali Acc: 0.540 Test Loss: 0.952 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6141974925994873
Epoch: 5, Steps: 18 | Train Loss: 0.627 Vali Loss: 1.064 Vali Acc: 0.540 Test Loss: 1.064 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.991429328918457
Epoch: 6, Steps: 18 | Train Loss: 0.581 Vali Loss: 2.103 Vali Acc: 0.520 Test Loss: 2.103 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.320420265197754
Epoch: 7, Steps: 18 | Train Loss: 0.482 Vali Loss: 1.557 Vali Acc: 0.520 Test Loss: 1.557 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.7880523204803467
Epoch: 8, Steps: 18 | Train Loss: 0.427 Vali Loss: 1.483 Vali Acc: 0.580 Test Loss: 1.483 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.208374500274658
Epoch: 9, Steps: 18 | Train Loss: 0.422 Vali Loss: 1.425 Vali Acc: 0.550 Test Loss: 1.425 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.12906551361084
Epoch: 10, Steps: 18 | Train Loss: 0.218 Vali Loss: 2.200 Vali Acc: 0.550 Test Loss: 2.200 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1976099014282227
Epoch: 11, Steps: 18 | Train Loss: 0.251 Vali Loss: 3.119 Vali Acc: 0.450 Test Loss: 3.119 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.1076648235321045
Epoch: 12, Steps: 18 | Train Loss: 0.134 Vali Loss: 3.400 Vali Acc: 0.500 Test Loss: 3.400 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 177250
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.774202108383179
Epoch: 1, Steps: 18 | Train Loss: 0.905 Vali Loss: 0.755 Vali Acc: 0.440 Test Loss: 0.755 Test Acc: 0.440
Validation loss decreased (inf --> -0.439992).  Saving model ...
Epoch: 2 cost time: 4.290212154388428
Epoch: 2, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.791 Vali Acc: 0.500 Test Loss: 0.791 Test Acc: 0.500
Validation loss decreased (-0.439992 --> -0.499992).  Saving model ...
Epoch: 3 cost time: 4.002798318862915
Epoch: 3, Steps: 18 | Train Loss: 0.599 Vali Loss: 0.862 Vali Acc: 0.530 Test Loss: 0.862 Test Acc: 0.530
Validation loss decreased (-0.499992 --> -0.529991).  Saving model ...
Epoch: 4 cost time: 3.8138492107391357
Epoch: 4, Steps: 18 | Train Loss: 0.546 Vali Loss: 0.934 Vali Acc: 0.530 Test Loss: 0.934 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.742594003677368
Epoch: 5, Steps: 18 | Train Loss: 0.473 Vali Loss: 0.942 Vali Acc: 0.610 Test Loss: 0.942 Test Acc: 0.610
Validation loss decreased (-0.529991 --> -0.609991).  Saving model ...
Epoch: 6 cost time: 3.114802122116089
Epoch: 6, Steps: 18 | Train Loss: 0.434 Vali Loss: 1.664 Vali Acc: 0.460 Test Loss: 1.664 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.19577431678772
Epoch: 7, Steps: 18 | Train Loss: 0.330 Vali Loss: 1.101 Vali Acc: 0.570 Test Loss: 1.101 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.818331718444824
Epoch: 8, Steps: 18 | Train Loss: 0.309 Vali Loss: 1.369 Vali Acc: 0.550 Test Loss: 1.369 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.011542320251465
Epoch: 9, Steps: 18 | Train Loss: 0.377 Vali Loss: 1.811 Vali Acc: 0.500 Test Loss: 1.811 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.7935123443603516
Epoch: 10, Steps: 18 | Train Loss: 0.175 Vali Loss: 2.191 Vali Acc: 0.460 Test Loss: 2.191 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7561771869659424
Epoch: 11, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.896 Vali Acc: 0.500 Test Loss: 1.896 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.128142356872559
Epoch: 12, Steps: 18 | Train Loss: 0.193 Vali Loss: 2.201 Vali Acc: 0.510 Test Loss: 2.201 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.15895938873291
Epoch: 13, Steps: 18 | Train Loss: 0.225 Vali Loss: 2.453 Vali Acc: 0.510 Test Loss: 2.453 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.6346702575683594
Epoch: 14, Steps: 18 | Train Loss: 0.287 Vali Loss: 2.974 Vali Acc: 0.500 Test Loss: 2.974 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.4309399127960205
Epoch: 15, Steps: 18 | Train Loss: 0.158 Vali Loss: 2.605 Vali Acc: 0.510 Test Loss: 2.605 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 122306
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.536829233169556
Epoch: 1, Steps: 18 | Train Loss: 0.802 Vali Loss: 0.866 Vali Acc: 0.470 Test Loss: 0.866 Test Acc: 0.470
Validation loss decreased (inf --> -0.469991).  Saving model ...
Epoch: 2 cost time: 3.108720302581787
Epoch: 2, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.898 Vali Acc: 0.540 Test Loss: 0.898 Test Acc: 0.540
Validation loss decreased (-0.469991 --> -0.539991).  Saving model ...
Epoch: 3 cost time: 3.870694875717163
Epoch: 3, Steps: 18 | Train Loss: 0.739 Vali Loss: 1.072 Vali Acc: 0.550 Test Loss: 1.072 Test Acc: 0.550
Validation loss decreased (-0.539991 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 3.8820605278015137
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.873 Vali Acc: 0.610 Test Loss: 0.873 Test Acc: 0.610
Validation loss decreased (-0.549989 --> -0.609991).  Saving model ...
Epoch: 5 cost time: 3.8051517009735107
Epoch: 5, Steps: 18 | Train Loss: 0.576 Vali Loss: 1.125 Vali Acc: 0.550 Test Loss: 1.125 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3695127964019775
Epoch: 6, Steps: 18 | Train Loss: 0.404 Vali Loss: 1.238 Vali Acc: 0.560 Test Loss: 1.238 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5877227783203125
Epoch: 7, Steps: 18 | Train Loss: 0.432 Vali Loss: 1.335 Vali Acc: 0.570 Test Loss: 1.335 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.18094539642334
Epoch: 8, Steps: 18 | Train Loss: 0.301 Vali Loss: 1.479 Vali Acc: 0.500 Test Loss: 1.479 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9298057556152344
Epoch: 9, Steps: 18 | Train Loss: 0.331 Vali Loss: 1.330 Vali Acc: 0.600 Test Loss: 1.330 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.774837017059326
Epoch: 10, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.647 Vali Acc: 0.510 Test Loss: 1.647 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.307267665863037
Epoch: 11, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.991 Vali Acc: 0.520 Test Loss: 1.991 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6883597373962402
Epoch: 12, Steps: 18 | Train Loss: 0.295 Vali Loss: 2.128 Vali Acc: 0.500 Test Loss: 2.128 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.849957227706909
Epoch: 13, Steps: 18 | Train Loss: 0.168 Vali Loss: 2.143 Vali Acc: 0.530 Test Loss: 2.143 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.925872802734375
Epoch: 14, Steps: 18 | Train Loss: 0.118 Vali Loss: 2.211 Vali Acc: 0.520 Test Loss: 2.211 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 100130
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.834439992904663
Epoch: 1, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.713 Vali Acc: 0.550 Test Loss: 0.713 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 4.025160312652588
Epoch: 2, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.715 Vali Acc: 0.520 Test Loss: 0.715 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.74052357673645
Epoch: 3, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.741 Vali Acc: 0.510 Test Loss: 0.741 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.550537824630737
Epoch: 4, Steps: 18 | Train Loss: 0.533 Vali Loss: 1.018 Vali Acc: 0.560 Test Loss: 1.018 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559990).  Saving model ...
Epoch: 5 cost time: 3.641585111618042
Epoch: 5, Steps: 18 | Train Loss: 0.508 Vali Loss: 0.907 Vali Acc: 0.580 Test Loss: 0.907 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579991).  Saving model ...
Epoch: 6 cost time: 3.7291719913482666
Epoch: 6, Steps: 18 | Train Loss: 0.437 Vali Loss: 1.065 Vali Acc: 0.540 Test Loss: 1.065 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7653720378875732
Epoch: 7, Steps: 18 | Train Loss: 0.367 Vali Loss: 1.018 Vali Acc: 0.570 Test Loss: 1.018 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8743410110473633
Epoch: 8, Steps: 18 | Train Loss: 0.365 Vali Loss: 1.098 Vali Acc: 0.530 Test Loss: 1.098 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.655509948730469
Epoch: 9, Steps: 18 | Train Loss: 0.274 Vali Loss: 1.334 Vali Acc: 0.540 Test Loss: 1.334 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.027026653289795
Epoch: 10, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.704796552658081
Epoch: 11, Steps: 18 | Train Loss: 0.217 Vali Loss: 1.466 Vali Acc: 0.530 Test Loss: 1.466 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.402252197265625
Epoch: 12, Steps: 18 | Train Loss: 0.280 Vali Loss: 1.823 Vali Acc: 0.500 Test Loss: 1.823 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.392105340957642
Epoch: 13, Steps: 18 | Train Loss: 0.196 Vali Loss: 1.607 Vali Acc: 0.490 Test Loss: 1.607 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.7033228874206543
Epoch: 14, Steps: 18 | Train Loss: 0.164 Vali Loss: 1.824 Vali Acc: 0.540 Test Loss: 1.824 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.813631057739258
Epoch: 15, Steps: 18 | Train Loss: 0.153 Vali Loss: 1.999 Vali Acc: 0.510 Test Loss: 1.999 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 76258
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.344698667526245
Epoch: 1, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.684 Vali Acc: 0.550 Test Loss: 0.684 Test Acc: 0.550
Validation loss decreased (inf --> -0.549993).  Saving model ...
Epoch: 2 cost time: 3.554486036300659
Epoch: 2, Steps: 18 | Train Loss: 0.718 Vali Loss: 0.641 Vali Acc: 0.610 Test Loss: 0.641 Test Acc: 0.610
Validation loss decreased (-0.549993 --> -0.609994).  Saving model ...
Epoch: 3 cost time: 3.5150444507598877
Epoch: 3, Steps: 18 | Train Loss: 0.641 Vali Loss: 0.720 Vali Acc: 0.550 Test Loss: 0.720 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.538484573364258
Epoch: 4, Steps: 18 | Train Loss: 0.575 Vali Loss: 0.791 Vali Acc: 0.490 Test Loss: 0.791 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.5705668926239014
Epoch: 5, Steps: 18 | Train Loss: 0.493 Vali Loss: 0.777 Vali Acc: 0.550 Test Loss: 0.777 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.5004003047943115
Epoch: 6, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.865 Vali Acc: 0.490 Test Loss: 0.865 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8470194339752197
Epoch: 7, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.820 Vali Acc: 0.570 Test Loss: 0.820 Test Acc: 0.570
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.4841468334198
Epoch: 8, Steps: 18 | Train Loss: 0.327 Vali Loss: 0.861 Vali Acc: 0.550 Test Loss: 0.861 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.7489070892333984
Epoch: 9, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.111 Vali Acc: 0.470 Test Loss: 1.111 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6715168952941895
Epoch: 10, Steps: 18 | Train Loss: 0.228 Vali Loss: 1.151 Vali Acc: 0.480 Test Loss: 1.151 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.830756425857544
Epoch: 11, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.177 Vali Acc: 0.560 Test Loss: 1.177 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.720395565032959
Epoch: 12, Steps: 18 | Train Loss: 0.167 Vali Loss: 1.396 Vali Acc: 0.480 Test Loss: 1.396 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 68770
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.216625213623047
Epoch: 1, Steps: 18 | Train Loss: 0.778 Vali Loss: 0.711 Vali Acc: 0.580 Test Loss: 0.711 Test Acc: 0.580
Validation loss decreased (inf --> -0.579993).  Saving model ...
Epoch: 2 cost time: 2.9767801761627197
Epoch: 2, Steps: 18 | Train Loss: 0.735 Vali Loss: 0.753 Vali Acc: 0.470 Test Loss: 0.753 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.963502883911133
Epoch: 3, Steps: 18 | Train Loss: 0.617 Vali Loss: 0.742 Vali Acc: 0.580 Test Loss: 0.742 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2571916580200195
Epoch: 4, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.781 Vali Acc: 0.560 Test Loss: 0.781 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4432222843170166
Epoch: 5, Steps: 18 | Train Loss: 0.543 Vali Loss: 0.772 Vali Acc: 0.540 Test Loss: 0.772 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6972262859344482
Epoch: 6, Steps: 18 | Train Loss: 0.466 Vali Loss: 1.007 Vali Acc: 0.590 Test Loss: 1.007 Test Acc: 0.590
Validation loss decreased (-0.579993 --> -0.589990).  Saving model ...
Epoch: 7 cost time: 2.5132408142089844
Epoch: 7, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.864 Vali Acc: 0.610 Test Loss: 0.864 Test Acc: 0.610
Validation loss decreased (-0.589990 --> -0.609991).  Saving model ...
Epoch: 8 cost time: 2.8535192012786865
Epoch: 8, Steps: 18 | Train Loss: 0.419 Vali Loss: 1.015 Vali Acc: 0.500 Test Loss: 1.015 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.801234245300293
Epoch: 9, Steps: 18 | Train Loss: 0.541 Vali Loss: 1.003 Vali Acc: 0.470 Test Loss: 1.003 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8491415977478027
Epoch: 10, Steps: 18 | Train Loss: 0.322 Vali Loss: 0.993 Vali Acc: 0.550 Test Loss: 0.993 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0529732704162598
Epoch: 11, Steps: 18 | Train Loss: 0.255 Vali Loss: 1.071 Vali Acc: 0.530 Test Loss: 1.071 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.190976858139038
Epoch: 12, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.019 Vali Acc: 0.530 Test Loss: 1.019 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8548238277435303
Epoch: 13, Steps: 18 | Train Loss: 0.230 Vali Loss: 1.136 Vali Acc: 0.470 Test Loss: 1.136 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6929328441619873
Epoch: 14, Steps: 18 | Train Loss: 0.183 Vali Loss: 1.296 Vali Acc: 0.510 Test Loss: 1.296 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.777984380722046
Epoch: 15, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.434 Vali Acc: 0.490 Test Loss: 1.434 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4788882732391357
Epoch: 16, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.458 Vali Acc: 0.510 Test Loss: 1.458 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.020397186279297
Epoch: 17, Steps: 18 | Train Loss: 0.131 Vali Loss: 1.289 Vali Acc: 0.520 Test Loss: 1.289 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm32_nh4_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 65378
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.209145307540894
Epoch: 1, Steps: 18 | Train Loss: 0.819 Vali Loss: 0.676 Vali Acc: 0.620 Test Loss: 0.676 Test Acc: 0.620
Validation loss decreased (inf --> -0.619993).  Saving model ...
Epoch: 2 cost time: 5.209461450576782
Epoch: 2, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.788 Vali Acc: 0.620 Test Loss: 0.788 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.5393524169921875
Epoch: 3, Steps: 18 | Train Loss: 0.538 Vali Loss: 0.975 Vali Acc: 0.580 Test Loss: 0.975 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.211918830871582
Epoch: 4, Steps: 18 | Train Loss: 0.625 Vali Loss: 1.009 Vali Acc: 0.530 Test Loss: 1.009 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.464482069015503
Epoch: 5, Steps: 18 | Train Loss: 0.523 Vali Loss: 1.227 Vali Acc: 0.520 Test Loss: 1.227 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.924440145492554
Epoch: 6, Steps: 18 | Train Loss: 0.298 Vali Loss: 1.384 Vali Acc: 0.590 Test Loss: 1.384 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.638320207595825
Epoch: 7, Steps: 18 | Train Loss: 0.334 Vali Loss: 2.983 Vali Acc: 0.530 Test Loss: 2.983 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.908224821090698
Epoch: 8, Steps: 18 | Train Loss: 0.444 Vali Loss: 1.556 Vali Acc: 0.530 Test Loss: 1.556 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.802092552185059
Epoch: 9, Steps: 18 | Train Loss: 0.397 Vali Loss: 1.878 Vali Acc: 0.580 Test Loss: 1.878 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.723181486129761
Epoch: 10, Steps: 18 | Train Loss: 0.830 Vali Loss: 2.579 Vali Acc: 0.540 Test Loss: 2.579 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.579694032669067
Epoch: 11, Steps: 18 | Train Loss: 0.786 Vali Loss: 2.955 Vali Acc: 0.550 Test Loss: 2.955 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 170594
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.675703287124634
Epoch: 1, Steps: 18 | Train Loss: 0.777 Vali Loss: 0.762 Vali Acc: 0.520 Test Loss: 0.762 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 4.330246686935425
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 0.759 Vali Acc: 0.490 Test Loss: 0.759 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.857936143875122
Epoch: 3, Steps: 18 | Train Loss: 0.828 Vali Loss: 1.072 Vali Acc: 0.560 Test Loss: 1.072 Test Acc: 0.560
Validation loss decreased (-0.519992 --> -0.559989).  Saving model ...
Epoch: 4 cost time: 4.398197412490845
Epoch: 4, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.821 Vali Acc: 0.500 Test Loss: 0.821 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.084081649780273
Epoch: 5, Steps: 18 | Train Loss: 0.493 Vali Loss: 1.544 Vali Acc: 0.500 Test Loss: 1.544 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.264742136001587
Epoch: 6, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.948 Vali Acc: 0.550 Test Loss: 0.948 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.109313249588013
Epoch: 7, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.310 Vali Acc: 0.570 Test Loss: 1.310 Test Acc: 0.570
Validation loss decreased (-0.559989 --> -0.569987).  Saving model ...
Epoch: 8 cost time: 5.380792140960693
Epoch: 8, Steps: 18 | Train Loss: 0.306 Vali Loss: 1.201 Vali Acc: 0.540 Test Loss: 1.201 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.7799177169799805
Epoch: 9, Steps: 18 | Train Loss: 0.248 Vali Loss: 1.987 Vali Acc: 0.540 Test Loss: 1.987 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.16925048828125
Epoch: 10, Steps: 18 | Train Loss: 0.210 Vali Loss: 1.349 Vali Acc: 0.510 Test Loss: 1.349 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.821867942810059
Epoch: 11, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.547 Vali Acc: 0.510 Test Loss: 1.547 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.31071662902832
Epoch: 12, Steps: 18 | Train Loss: 0.109 Vali Loss: 2.439 Vali Acc: 0.540 Test Loss: 2.439 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9242961406707764
Epoch: 13, Steps: 18 | Train Loss: 0.153 Vali Loss: 2.239 Vali Acc: 0.520 Test Loss: 2.239 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.225468873977661
Epoch: 14, Steps: 18 | Train Loss: 0.210 Vali Loss: 2.249 Vali Acc: 0.500 Test Loss: 2.249 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.264435291290283
Epoch: 15, Steps: 18 | Train Loss: 0.085 Vali Loss: 2.736 Vali Acc: 0.470 Test Loss: 2.736 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.480081558227539
Epoch: 16, Steps: 18 | Train Loss: 0.098 Vali Loss: 2.947 Vali Acc: 0.530 Test Loss: 2.947 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.924020528793335
Epoch: 17, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.465 Vali Acc: 0.490 Test Loss: 2.465 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 93970
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.161255598068237
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.794 Vali Acc: 0.470 Test Loss: 0.794 Test Acc: 0.470
Validation loss decreased (inf --> -0.469992).  Saving model ...
Epoch: 2 cost time: 3.7254581451416016
Epoch: 2, Steps: 18 | Train Loss: 0.774 Vali Loss: 0.818 Vali Acc: 0.540 Test Loss: 0.818 Test Acc: 0.540
Validation loss decreased (-0.469992 --> -0.539992).  Saving model ...
Epoch: 3 cost time: 4.022190809249878
Epoch: 3, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.799 Vali Acc: 0.540 Test Loss: 0.799 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 3.3226048946380615
Epoch: 4, Steps: 18 | Train Loss: 0.578 Vali Loss: 0.855 Vali Acc: 0.530 Test Loss: 0.855 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5625224113464355
Epoch: 5, Steps: 18 | Train Loss: 0.446 Vali Loss: 0.844 Vali Acc: 0.490 Test Loss: 0.844 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.112987518310547
Epoch: 6, Steps: 18 | Train Loss: 0.394 Vali Loss: 1.103 Vali Acc: 0.590 Test Loss: 1.103 Test Acc: 0.590
Validation loss decreased (-0.539992 --> -0.589989).  Saving model ...
Epoch: 7 cost time: 3.2234838008880615
Epoch: 7, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.957 Vali Acc: 0.550 Test Loss: 0.957 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.457063674926758
Epoch: 8, Steps: 18 | Train Loss: 0.290 Vali Loss: 1.090 Vali Acc: 0.510 Test Loss: 1.090 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.488832473754883
Epoch: 9, Steps: 18 | Train Loss: 0.226 Vali Loss: 1.015 Vali Acc: 0.510 Test Loss: 1.015 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.180032968521118
Epoch: 10, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.352 Vali Acc: 0.530 Test Loss: 1.352 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.054910898208618
Epoch: 11, Steps: 18 | Train Loss: 0.214 Vali Loss: 1.404 Vali Acc: 0.560 Test Loss: 1.404 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.6919989585876465
Epoch: 12, Steps: 18 | Train Loss: 0.160 Vali Loss: 1.545 Vali Acc: 0.490 Test Loss: 1.545 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2817139625549316
Epoch: 13, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.544 Vali Acc: 0.530 Test Loss: 1.544 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.405348539352417
Epoch: 14, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.983 Vali Acc: 0.490 Test Loss: 1.983 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.7751481533050537
Epoch: 15, Steps: 18 | Train Loss: 0.131 Vali Loss: 2.146 Vali Acc: 0.450 Test Loss: 2.146 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.1764326095581055
Epoch: 16, Steps: 18 | Train Loss: 0.106 Vali Loss: 2.067 Vali Acc: 0.520 Test Loss: 2.067 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.59
model parameter : 66498
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.839978933334351
Epoch: 1, Steps: 18 | Train Loss: 0.746 Vali Loss: 0.770 Vali Acc: 0.540 Test Loss: 0.770 Test Acc: 0.540
Validation loss decreased (inf --> -0.539992).  Saving model ...
Epoch: 2 cost time: 3.275933265686035
Epoch: 2, Steps: 18 | Train Loss: 0.731 Vali Loss: 0.749 Vali Acc: 0.510 Test Loss: 0.749 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5179405212402344
Epoch: 3, Steps: 18 | Train Loss: 0.645 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
Validation loss decreased (-0.539992 --> -0.539992).  Saving model ...
Epoch: 4 cost time: 2.968977689743042
Epoch: 4, Steps: 18 | Train Loss: 0.558 Vali Loss: 0.857 Vali Acc: 0.540 Test Loss: 0.857 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.234104871749878
Epoch: 5, Steps: 18 | Train Loss: 0.495 Vali Loss: 1.012 Vali Acc: 0.520 Test Loss: 1.012 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0291736125946045
Epoch: 6, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.911 Vali Acc: 0.570 Test Loss: 0.911 Test Acc: 0.570
Validation loss decreased (-0.539992 --> -0.569991).  Saving model ...
Epoch: 7 cost time: 3.1674814224243164
Epoch: 7, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.853 Vali Acc: 0.530 Test Loss: 0.853 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.818563461303711
Epoch: 8, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.929 Vali Acc: 0.530 Test Loss: 0.929 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1744863986968994
Epoch: 9, Steps: 18 | Train Loss: 0.287 Vali Loss: 0.978 Vali Acc: 0.520 Test Loss: 0.978 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9448630809783936
Epoch: 10, Steps: 18 | Train Loss: 0.251 Vali Loss: 1.203 Vali Acc: 0.530 Test Loss: 1.203 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.523449659347534
Epoch: 11, Steps: 18 | Train Loss: 0.338 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.5503368377685547
Epoch: 12, Steps: 18 | Train Loss: 0.188 Vali Loss: 1.309 Vali Acc: 0.520 Test Loss: 1.309 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.118220806121826
Epoch: 13, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.303 Vali Acc: 0.530 Test Loss: 1.303 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2387025356292725
Epoch: 14, Steps: 18 | Train Loss: 0.111 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.597334384918213
Epoch: 15, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.448 Vali Acc: 0.520 Test Loss: 1.448 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.4174790382385254
Epoch: 16, Steps: 18 | Train Loss: 0.066 Vali Loss: 1.588 Vali Acc: 0.520 Test Loss: 1.588 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 55410
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.8230133056640625
Epoch: 1, Steps: 18 | Train Loss: 0.773 Vali Loss: 0.691 Vali Acc: 0.560 Test Loss: 0.691 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 2.651202917098999
Epoch: 2, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.700 Vali Acc: 0.580 Test Loss: 0.700 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579993).  Saving model ...
Epoch: 3 cost time: 2.7052881717681885
Epoch: 3, Steps: 18 | Train Loss: 0.655 Vali Loss: 0.665 Vali Acc: 0.660 Test Loss: 0.665 Test Acc: 0.660
Validation loss decreased (-0.579993 --> -0.659993).  Saving model ...
Epoch: 4 cost time: 2.6151092052459717
Epoch: 4, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.771 Vali Acc: 0.540 Test Loss: 0.771 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.711092472076416
Epoch: 5, Steps: 18 | Train Loss: 0.603 Vali Loss: 0.744 Vali Acc: 0.600 Test Loss: 0.744 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5188279151916504
Epoch: 6, Steps: 18 | Train Loss: 0.499 Vali Loss: 0.833 Vali Acc: 0.610 Test Loss: 0.833 Test Acc: 0.610
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9790124893188477
Epoch: 7, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.722 Vali Acc: 0.600 Test Loss: 0.722 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.791795492172241
Epoch: 8, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.915 Vali Acc: 0.520 Test Loss: 0.915 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.830766201019287
Epoch: 9, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.931 Vali Acc: 0.590 Test Loss: 0.931 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.801567316055298
Epoch: 10, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.943 Vali Acc: 0.560 Test Loss: 0.943 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9702489376068115
Epoch: 11, Steps: 18 | Train Loss: 0.259 Vali Loss: 1.074 Vali Acc: 0.530 Test Loss: 1.074 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5027077198028564
Epoch: 12, Steps: 18 | Train Loss: 0.270 Vali Loss: 1.166 Vali Acc: 0.520 Test Loss: 1.166 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.86698579788208
Epoch: 13, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.228 Vali Acc: 0.520 Test Loss: 1.228 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.66
model parameter : 43474
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.857954025268555
Epoch: 1, Steps: 18 | Train Loss: 0.784 Vali Loss: 0.729 Vali Acc: 0.480 Test Loss: 0.729 Test Acc: 0.480
Validation loss decreased (inf --> -0.479993).  Saving model ...
Epoch: 2 cost time: 3.4354469776153564
Epoch: 2, Steps: 18 | Train Loss: 0.753 Vali Loss: 0.726 Vali Acc: 0.520 Test Loss: 0.726 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 3 cost time: 3.6349689960479736
Epoch: 3, Steps: 18 | Train Loss: 0.682 Vali Loss: 0.720 Vali Acc: 0.500 Test Loss: 0.720 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.747858762741089
Epoch: 4, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.740 Vali Acc: 0.500 Test Loss: 0.740 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.517641544342041
Epoch: 5, Steps: 18 | Train Loss: 0.552 Vali Loss: 0.771 Vali Acc: 0.570 Test Loss: 0.771 Test Acc: 0.570
Validation loss decreased (-0.519993 --> -0.569992).  Saving model ...
Epoch: 6 cost time: 3.8887429237365723
Epoch: 6, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.857 Vali Acc: 0.490 Test Loss: 0.857 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1252455711364746
Epoch: 7, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.830 Vali Acc: 0.500 Test Loss: 0.830 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.442533493041992
Epoch: 8, Steps: 18 | Train Loss: 0.465 Vali Loss: 0.796 Vali Acc: 0.550 Test Loss: 0.796 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.081496000289917
Epoch: 9, Steps: 18 | Train Loss: 0.421 Vali Loss: 0.790 Vali Acc: 0.580 Test Loss: 0.790 Test Acc: 0.580
Validation loss decreased (-0.569992 --> -0.579992).  Saving model ...
Epoch: 10 cost time: 3.570647954940796
Epoch: 10, Steps: 18 | Train Loss: 0.407 Vali Loss: 0.843 Vali Acc: 0.500 Test Loss: 0.843 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.74214768409729
Epoch: 11, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.877 Vali Acc: 0.520 Test Loss: 0.877 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.061549663543701
Epoch: 12, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.894 Vali Acc: 0.510 Test Loss: 0.894 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.463205337524414
Epoch: 13, Steps: 18 | Train Loss: 0.239 Vali Loss: 0.953 Vali Acc: 0.510 Test Loss: 0.953 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.294044017791748
Epoch: 14, Steps: 18 | Train Loss: 0.195 Vali Loss: 1.057 Vali Acc: 0.520 Test Loss: 1.057 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.274733781814575
Epoch: 15, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.082 Vali Acc: 0.480 Test Loss: 1.082 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4263713359832764
Epoch: 16, Steps: 18 | Train Loss: 0.184 Vali Loss: 1.219 Vali Acc: 0.510 Test Loss: 1.219 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.831740140914917
Epoch: 17, Steps: 18 | Train Loss: 0.178 Vali Loss: 1.223 Vali Acc: 0.540 Test Loss: 1.223 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.3294780254364014
Epoch: 18, Steps: 18 | Train Loss: 0.144 Vali Loss: 1.392 Vali Acc: 0.510 Test Loss: 1.392 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.260084867477417
Epoch: 19, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.400 Vali Acc: 0.500 Test Loss: 1.400 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 39730
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 5.949014186859131
Epoch: 1, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.687 Vali Acc: 0.500 Test Loss: 0.687 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 2.5742781162261963
Epoch: 2, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.690 Vali Acc: 0.510 Test Loss: 0.690 Test Acc: 0.510
Validation loss decreased (-0.499993 --> -0.509993).  Saving model ...
Epoch: 3 cost time: 3.1842234134674072
Epoch: 3, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.697 Vali Acc: 0.510 Test Loss: 0.697 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2995316982269287
Epoch: 4, Steps: 18 | Train Loss: 0.587 Vali Loss: 0.689 Vali Acc: 0.550 Test Loss: 0.689 Test Acc: 0.550
Validation loss decreased (-0.509993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 3.3870246410369873
Epoch: 5, Steps: 18 | Train Loss: 0.571 Vali Loss: 0.719 Vali Acc: 0.550 Test Loss: 0.719 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.633153200149536
Epoch: 6, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.751 Vali Acc: 0.570 Test Loss: 0.751 Test Acc: 0.570
Validation loss decreased (-0.549993 --> -0.569992).  Saving model ...
Epoch: 7 cost time: 2.722231388092041
Epoch: 7, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.810 Vali Acc: 0.530 Test Loss: 0.810 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.100599527359009
Epoch: 8, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.772 Vali Acc: 0.570 Test Loss: 0.772 Test Acc: 0.570
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8567745685577393
Epoch: 9, Steps: 18 | Train Loss: 0.378 Vali Loss: 0.819 Vali Acc: 0.610 Test Loss: 0.819 Test Acc: 0.610
Validation loss decreased (-0.569992 --> -0.609992).  Saving model ...
Epoch: 10 cost time: 3.053920269012451
Epoch: 10, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.846 Vali Acc: 0.610 Test Loss: 0.846 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.433388948440552
Epoch: 11, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.970 Vali Acc: 0.550 Test Loss: 0.970 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0349414348602295
Epoch: 12, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.948 Vali Acc: 0.520 Test Loss: 0.948 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.202584505081177
Epoch: 13, Steps: 18 | Train Loss: 0.284 Vali Loss: 1.069 Vali Acc: 0.510 Test Loss: 1.069 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.355358362197876
Epoch: 14, Steps: 18 | Train Loss: 0.304 Vali Loss: 0.922 Vali Acc: 0.550 Test Loss: 0.922 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.892164468765259
Epoch: 15, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.036 Vali Acc: 0.520 Test Loss: 1.036 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.43625545501709
Epoch: 16, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.095 Vali Acc: 0.530 Test Loss: 1.095 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.027429819107056
Epoch: 17, Steps: 18 | Train Loss: 0.201 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.5053398609161377
Epoch: 18, Steps: 18 | Train Loss: 0.193 Vali Loss: 1.154 Vali Acc: 0.490 Test Loss: 1.154 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.566905975341797
Epoch: 19, Steps: 18 | Train Loss: 0.166 Vali Loss: 1.143 Vali Acc: 0.550 Test Loss: 1.143 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df256_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 38034
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 11.137537717819214
Epoch: 1, Steps: 18 | Train Loss: 0.863 Vali Loss: 1.023 Vali Acc: 0.520 Test Loss: 1.023 Test Acc: 0.520
Validation loss decreased (inf --> -0.519990).  Saving model ...
Epoch: 2 cost time: 5.81531548500061
Epoch: 2, Steps: 18 | Train Loss: 0.734 Vali Loss: 0.773 Vali Acc: 0.620 Test Loss: 0.773 Test Acc: 0.620
Validation loss decreased (-0.519990 --> -0.619992).  Saving model ...
Epoch: 3 cost time: 6.318174600601196
Epoch: 3, Steps: 18 | Train Loss: 0.620 Vali Loss: 1.009 Vali Acc: 0.610 Test Loss: 1.009 Test Acc: 0.610
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.192810297012329
Epoch: 4, Steps: 18 | Train Loss: 0.520 Vali Loss: 1.203 Vali Acc: 0.550 Test Loss: 1.203 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.762981653213501
Epoch: 5, Steps: 18 | Train Loss: 0.494 Vali Loss: 1.054 Vali Acc: 0.570 Test Loss: 1.054 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.080871343612671
Epoch: 6, Steps: 18 | Train Loss: 0.600 Vali Loss: 2.092 Vali Acc: 0.510 Test Loss: 2.092 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.646850347518921
Epoch: 7, Steps: 18 | Train Loss: 0.447 Vali Loss: 1.713 Vali Acc: 0.550 Test Loss: 1.713 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.486473560333252
Epoch: 8, Steps: 18 | Train Loss: 0.840 Vali Loss: 2.946 Vali Acc: 0.500 Test Loss: 2.946 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.53653621673584
Epoch: 9, Steps: 18 | Train Loss: 0.505 Vali Loss: 2.374 Vali Acc: 0.490 Test Loss: 2.374 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.492128849029541
Epoch: 10, Steps: 18 | Train Loss: 0.196 Vali Loss: 2.235 Vali Acc: 0.480 Test Loss: 2.235 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.825025796890259
Epoch: 11, Steps: 18 | Train Loss: 0.379 Vali Loss: 2.672 Vali Acc: 0.500 Test Loss: 2.672 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.451118469238281
Epoch: 12, Steps: 18 | Train Loss: 0.260 Vali Loss: 2.877 Vali Acc: 0.530 Test Loss: 2.877 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 166370
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.430508613586426
Epoch: 1, Steps: 18 | Train Loss: 0.789 Vali Loss: 0.721 Vali Acc: 0.560 Test Loss: 0.721 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 4.222022294998169
Epoch: 2, Steps: 18 | Train Loss: 0.696 Vali Loss: 1.096 Vali Acc: 0.510 Test Loss: 1.096 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.878636360168457
Epoch: 3, Steps: 18 | Train Loss: 0.644 Vali Loss: 0.809 Vali Acc: 0.510 Test Loss: 0.809 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.4623563289642334
Epoch: 4, Steps: 18 | Train Loss: 0.691 Vali Loss: 1.056 Vali Acc: 0.520 Test Loss: 1.056 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.212905645370483
Epoch: 5, Steps: 18 | Train Loss: 0.657 Vali Loss: 0.955 Vali Acc: 0.480 Test Loss: 0.955 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.386235475540161
Epoch: 6, Steps: 18 | Train Loss: 0.492 Vali Loss: 1.324 Vali Acc: 0.520 Test Loss: 1.324 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.256410837173462
Epoch: 7, Steps: 18 | Train Loss: 0.360 Vali Loss: 1.183 Vali Acc: 0.530 Test Loss: 1.183 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.484922170639038
Epoch: 8, Steps: 18 | Train Loss: 0.271 Vali Loss: 1.297 Vali Acc: 0.520 Test Loss: 1.297 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.097165822982788
Epoch: 9, Steps: 18 | Train Loss: 0.329 Vali Loss: 1.345 Vali Acc: 0.580 Test Loss: 1.345 Test Acc: 0.580
Validation loss decreased (-0.559993 --> -0.579987).  Saving model ...
Epoch: 10 cost time: 4.467153072357178
Epoch: 10, Steps: 18 | Train Loss: 0.338 Vali Loss: 1.508 Vali Acc: 0.510 Test Loss: 1.508 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.842312812805176
Epoch: 11, Steps: 18 | Train Loss: 0.141 Vali Loss: 1.558 Vali Acc: 0.490 Test Loss: 1.558 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.698838949203491
Epoch: 12, Steps: 18 | Train Loss: 0.104 Vali Loss: 1.743 Vali Acc: 0.570 Test Loss: 1.743 Test Acc: 0.570
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.901853084564209
Epoch: 13, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.597 Vali Acc: 0.540 Test Loss: 1.597 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.069030523300171
Epoch: 14, Steps: 18 | Train Loss: 0.096 Vali Loss: 1.794 Vali Acc: 0.520 Test Loss: 1.794 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.380476713180542
Epoch: 15, Steps: 18 | Train Loss: 0.100 Vali Loss: 1.690 Vali Acc: 0.560 Test Loss: 1.690 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.233530044555664
Epoch: 16, Steps: 18 | Train Loss: 0.074 Vali Loss: 2.352 Vali Acc: 0.550 Test Loss: 2.352 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.704477548599243
Epoch: 17, Steps: 18 | Train Loss: 0.064 Vali Loss: 2.403 Vali Acc: 0.550 Test Loss: 2.403 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.183379888534546
Epoch: 18, Steps: 18 | Train Loss: 0.051 Vali Loss: 2.380 Vali Acc: 0.530 Test Loss: 2.380 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.8061697483062744
Epoch: 19, Steps: 18 | Train Loss: 0.088 Vali Loss: 2.515 Vali Acc: 0.520 Test Loss: 2.515 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.58
model parameter : 89746
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.773301124572754
Epoch: 1, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.763 Vali Acc: 0.510 Test Loss: 0.763 Test Acc: 0.510
Validation loss decreased (inf --> -0.509992).  Saving model ...
Epoch: 2 cost time: 3.265340805053711
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.821 Vali Acc: 0.470 Test Loss: 0.821 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.122146368026733
Epoch: 3, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.792 Vali Acc: 0.490 Test Loss: 0.792 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0627527236938477
Epoch: 4, Steps: 18 | Train Loss: 0.581 Vali Loss: 1.343 Vali Acc: 0.510 Test Loss: 1.343 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.3629844188690186
Epoch: 5, Steps: 18 | Train Loss: 0.628 Vali Loss: 1.175 Vali Acc: 0.570 Test Loss: 1.175 Test Acc: 0.570
Validation loss decreased (-0.509992 --> -0.569988).  Saving model ...
Epoch: 6 cost time: 3.4397318363189697
Epoch: 6, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.942 Vali Acc: 0.510 Test Loss: 0.942 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.095579147338867
Epoch: 7, Steps: 18 | Train Loss: 0.389 Vali Loss: 0.987 Vali Acc: 0.610 Test Loss: 0.987 Test Acc: 0.610
Validation loss decreased (-0.569988 --> -0.609990).  Saving model ...
Epoch: 8 cost time: 3.6321816444396973
Epoch: 8, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.987 Vali Acc: 0.560 Test Loss: 0.987 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2687864303588867
Epoch: 9, Steps: 18 | Train Loss: 0.239 Vali Loss: 1.125 Vali Acc: 0.510 Test Loss: 1.125 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5000293254852295
Epoch: 10, Steps: 18 | Train Loss: 0.249 Vali Loss: 1.030 Vali Acc: 0.560 Test Loss: 1.030 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1023621559143066
Epoch: 11, Steps: 18 | Train Loss: 0.175 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5308735370635986
Epoch: 12, Steps: 18 | Train Loss: 0.161 Vali Loss: 1.598 Vali Acc: 0.470 Test Loss: 1.598 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.304079294204712
Epoch: 13, Steps: 18 | Train Loss: 0.133 Vali Loss: 1.444 Vali Acc: 0.460 Test Loss: 1.444 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.264657974243164
Epoch: 14, Steps: 18 | Train Loss: 0.099 Vali Loss: 1.704 Vali Acc: 0.520 Test Loss: 1.704 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.302494764328003
Epoch: 15, Steps: 18 | Train Loss: 0.090 Vali Loss: 1.822 Vali Acc: 0.520 Test Loss: 1.822 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.596466302871704
Epoch: 16, Steps: 18 | Train Loss: 0.110 Vali Loss: 1.969 Vali Acc: 0.500 Test Loss: 1.969 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.486931085586548
Epoch: 17, Steps: 18 | Train Loss: 0.047 Vali Loss: 2.185 Vali Acc: 0.460 Test Loss: 2.185 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 62274
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.60933804512024
Epoch: 1, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.757 Vali Acc: 0.520 Test Loss: 0.757 Test Acc: 0.520
Validation loss decreased (inf --> -0.519992).  Saving model ...
Epoch: 2 cost time: 3.864281415939331
Epoch: 2, Steps: 18 | Train Loss: 0.737 Vali Loss: 0.789 Vali Acc: 0.520 Test Loss: 0.789 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.156526565551758
Epoch: 3, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.866 Vali Acc: 0.520 Test Loss: 0.866 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.575348615646362
Epoch: 4, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
Validation loss decreased (-0.519992 --> -0.579993).  Saving model ...
Epoch: 5 cost time: 4.351221799850464
Epoch: 5, Steps: 18 | Train Loss: 0.555 Vali Loss: 0.938 Vali Acc: 0.520 Test Loss: 0.938 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.015755891799927
Epoch: 6, Steps: 18 | Train Loss: 0.443 Vali Loss: 0.778 Vali Acc: 0.630 Test Loss: 0.778 Test Acc: 0.630
Validation loss decreased (-0.579993 --> -0.629992).  Saving model ...
Epoch: 7 cost time: 3.7050108909606934
Epoch: 7, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.984 Vali Acc: 0.510 Test Loss: 0.984 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9571406841278076
Epoch: 8, Steps: 18 | Train Loss: 0.372 Vali Loss: 0.909 Vali Acc: 0.530 Test Loss: 0.909 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.2675721645355225
Epoch: 9, Steps: 18 | Train Loss: 0.299 Vali Loss: 0.858 Vali Acc: 0.600 Test Loss: 0.858 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.062239646911621
Epoch: 10, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.998 Vali Acc: 0.540 Test Loss: 0.998 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.5931432247161865
Epoch: 11, Steps: 18 | Train Loss: 0.194 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.064118146896362
Epoch: 12, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.188 Vali Acc: 0.550 Test Loss: 1.188 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.272039890289307
Epoch: 13, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.155 Vali Acc: 0.570 Test Loss: 1.155 Test Acc: 0.570
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.8453733921051025
Epoch: 14, Steps: 18 | Train Loss: 0.150 Vali Loss: 1.286 Vali Acc: 0.540 Test Loss: 1.286 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.171221971511841
Epoch: 15, Steps: 18 | Train Loss: 0.130 Vali Loss: 1.610 Vali Acc: 0.520 Test Loss: 1.610 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8150618076324463
Epoch: 16, Steps: 18 | Train Loss: 0.079 Vali Loss: 1.862 Vali Acc: 0.520 Test Loss: 1.862 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.63
model parameter : 51186
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.484497547149658
Epoch: 1, Steps: 18 | Train Loss: 0.781 Vali Loss: 0.703 Vali Acc: 0.560 Test Loss: 0.703 Test Acc: 0.560
Validation loss decreased (inf --> -0.559993).  Saving model ...
Epoch: 2 cost time: 3.580713987350464
Epoch: 2, Steps: 18 | Train Loss: 0.749 Vali Loss: 0.699 Vali Acc: 0.570 Test Loss: 0.699 Test Acc: 0.570
Validation loss decreased (-0.559993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 3.618957042694092
Epoch: 3, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.694 Vali Acc: 0.570 Test Loss: 0.694 Test Acc: 0.570
Validation loss decreased (-0.569993 --> -0.569993).  Saving model ...
Epoch: 4 cost time: 3.6260595321655273
Epoch: 4, Steps: 18 | Train Loss: 0.642 Vali Loss: 0.803 Vali Acc: 0.460 Test Loss: 0.803 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.785140037536621
Epoch: 5, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.790 Vali Acc: 0.600 Test Loss: 0.790 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 6 cost time: 3.4643826484680176
Epoch: 6, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.785 Vali Acc: 0.560 Test Loss: 0.785 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1112585067749023
Epoch: 7, Steps: 18 | Train Loss: 0.446 Vali Loss: 0.746 Vali Acc: 0.610 Test Loss: 0.746 Test Acc: 0.610
Validation loss decreased (-0.599992 --> -0.609993).  Saving model ...
Epoch: 8 cost time: 4.2041175365448
Epoch: 8, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.780 Vali Acc: 0.550 Test Loss: 0.780 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.187672138214111
Epoch: 9, Steps: 18 | Train Loss: 0.376 Vali Loss: 0.969 Vali Acc: 0.550 Test Loss: 0.969 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.85541033744812
Epoch: 10, Steps: 18 | Train Loss: 0.349 Vali Loss: 1.034 Vali Acc: 0.540 Test Loss: 1.034 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8704724311828613
Epoch: 11, Steps: 18 | Train Loss: 0.299 Vali Loss: 1.038 Vali Acc: 0.480 Test Loss: 1.038 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5663866996765137
Epoch: 12, Steps: 18 | Train Loss: 0.257 Vali Loss: 1.064 Vali Acc: 0.500 Test Loss: 1.064 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.884805679321289
Epoch: 13, Steps: 18 | Train Loss: 0.224 Vali Loss: 1.207 Vali Acc: 0.520 Test Loss: 1.207 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.030778408050537
Epoch: 14, Steps: 18 | Train Loss: 0.177 Vali Loss: 1.317 Vali Acc: 0.530 Test Loss: 1.317 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.9275174140930176
Epoch: 15, Steps: 18 | Train Loss: 0.176 Vali Loss: 1.251 Vali Acc: 0.530 Test Loss: 1.251 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.697674036026001
Epoch: 16, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.231 Vali Acc: 0.570 Test Loss: 1.231 Test Acc: 0.570
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7654592990875244
Epoch: 17, Steps: 18 | Train Loss: 0.122 Vali Loss: 1.462 Vali Acc: 0.520 Test Loss: 1.462 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 39250
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.491565704345703
Epoch: 1, Steps: 18 | Train Loss: 0.756 Vali Loss: 0.722 Vali Acc: 0.470 Test Loss: 0.722 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.025324821472168
Epoch: 2, Steps: 18 | Train Loss: 0.671 Vali Loss: 0.718 Vali Acc: 0.480 Test Loss: 0.718 Test Acc: 0.480
Validation loss decreased (-0.469993 --> -0.479993).  Saving model ...
Epoch: 3 cost time: 2.838174819946289
Epoch: 3, Steps: 18 | Train Loss: 0.666 Vali Loss: 0.707 Vali Acc: 0.520 Test Loss: 0.707 Test Acc: 0.520
Validation loss decreased (-0.479993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 2.8847222328186035
Epoch: 4, Steps: 18 | Train Loss: 0.630 Vali Loss: 0.727 Vali Acc: 0.500 Test Loss: 0.727 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2254838943481445
Epoch: 5, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.725 Vali Acc: 0.600 Test Loss: 0.725 Test Acc: 0.600
Validation loss decreased (-0.519993 --> -0.599993).  Saving model ...
Epoch: 6 cost time: 3.103504180908203
Epoch: 6, Steps: 18 | Train Loss: 0.549 Vali Loss: 0.865 Vali Acc: 0.510 Test Loss: 0.865 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3508896827697754
Epoch: 7, Steps: 18 | Train Loss: 0.524 Vali Loss: 0.808 Vali Acc: 0.590 Test Loss: 0.808 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.576533794403076
Epoch: 8, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.896 Vali Acc: 0.470 Test Loss: 0.896 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7596373558044434
Epoch: 9, Steps: 18 | Train Loss: 0.413 Vali Loss: 0.821 Vali Acc: 0.480 Test Loss: 0.821 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.173159599304199
Epoch: 10, Steps: 18 | Train Loss: 0.354 Vali Loss: 0.928 Vali Acc: 0.530 Test Loss: 0.928 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4927430152893066
Epoch: 11, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.858 Vali Acc: 0.530 Test Loss: 0.858 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4540774822235107
Epoch: 12, Steps: 18 | Train Loss: 0.262 Vali Loss: 0.924 Vali Acc: 0.510 Test Loss: 0.924 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.113645076751709
Epoch: 13, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.927 Vali Acc: 0.470 Test Loss: 0.927 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.716217517852783
Epoch: 14, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.980 Vali Acc: 0.520 Test Loss: 0.980 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.8783624172210693
Epoch: 15, Steps: 18 | Train Loss: 0.185 Vali Loss: 1.069 Vali Acc: 0.530 Test Loss: 1.069 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 35506
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.854215860366821
Epoch: 1, Steps: 18 | Train Loss: 0.797 Vali Loss: 0.747 Vali Acc: 0.500 Test Loss: 0.747 Test Acc: 0.500
Validation loss decreased (inf --> -0.499993).  Saving model ...
Epoch: 2 cost time: 3.1164968013763428
Epoch: 2, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.723 Vali Acc: 0.570 Test Loss: 0.723 Test Acc: 0.570
Validation loss decreased (-0.499993 --> -0.569993).  Saving model ...
Epoch: 3 cost time: 2.8735508918762207
Epoch: 3, Steps: 18 | Train Loss: 0.668 Vali Loss: 0.732 Vali Acc: 0.520 Test Loss: 0.732 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.060689687728882
Epoch: 4, Steps: 18 | Train Loss: 0.579 Vali Loss: 0.720 Vali Acc: 0.560 Test Loss: 0.720 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.571396589279175
Epoch: 5, Steps: 18 | Train Loss: 0.541 Vali Loss: 0.722 Vali Acc: 0.510 Test Loss: 0.722 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.499293327331543
Epoch: 6, Steps: 18 | Train Loss: 0.527 Vali Loss: 0.752 Vali Acc: 0.540 Test Loss: 0.752 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.6222920417785645
Epoch: 7, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.795 Vali Acc: 0.600 Test Loss: 0.795 Test Acc: 0.600
Validation loss decreased (-0.569993 --> -0.599992).  Saving model ...
Epoch: 8 cost time: 3.7197017669677734
Epoch: 8, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.907 Vali Acc: 0.600 Test Loss: 0.907 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.60121488571167
Epoch: 9, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.943 Vali Acc: 0.480 Test Loss: 0.943 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6893436908721924
Epoch: 10, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.903 Vali Acc: 0.520 Test Loss: 0.903 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.605513572692871
Epoch: 11, Steps: 18 | Train Loss: 0.323 Vali Loss: 1.012 Vali Acc: 0.490 Test Loss: 1.012 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.619264364242554
Epoch: 12, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.062 Vali Acc: 0.470 Test Loss: 1.062 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6332175731658936
Epoch: 13, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.943 Vali Acc: 0.540 Test Loss: 0.943 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.4733853340148926
Epoch: 14, Steps: 18 | Train Loss: 0.254 Vali Loss: 1.052 Vali Acc: 0.510 Test Loss: 1.052 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.929325819015503
Epoch: 15, Steps: 18 | Train Loss: 0.207 Vali Loss: 1.139 Vali Acc: 0.470 Test Loss: 1.139 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.122270822525024
Epoch: 16, Steps: 18 | Train Loss: 0.172 Vali Loss: 1.150 Vali Acc: 0.490 Test Loss: 1.150 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.1947598457336426
Epoch: 17, Steps: 18 | Train Loss: 0.156 Vali Loss: 1.201 Vali Acc: 0.470 Test Loss: 1.201 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df128_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 33810
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps75_str38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.302884340286255
Epoch: 1, Steps: 18 | Train Loss: 0.850 Vali Loss: 0.919 Vali Acc: 0.520 Test Loss: 0.919 Test Acc: 0.520
Validation loss decreased (inf --> -0.519991).  Saving model ...
Epoch: 2 cost time: 4.142328500747681
Epoch: 2, Steps: 18 | Train Loss: 1.073 Vali Loss: 1.940 Vali Acc: 0.500 Test Loss: 1.940 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.568222522735596
Epoch: 3, Steps: 18 | Train Loss: 0.878 Vali Loss: 0.849 Vali Acc: 0.560 Test Loss: 0.849 Test Acc: 0.560
Validation loss decreased (-0.519991 --> -0.559992).  Saving model ...
Epoch: 4 cost time: 4.875793218612671
Epoch: 4, Steps: 18 | Train Loss: 0.611 Vali Loss: 1.573 Vali Acc: 0.560 Test Loss: 1.573 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.758651971817017
Epoch: 5, Steps: 18 | Train Loss: 0.638 Vali Loss: 1.410 Vali Acc: 0.590 Test Loss: 1.410 Test Acc: 0.590
Validation loss decreased (-0.559992 --> -0.589986).  Saving model ...
Epoch: 6 cost time: 4.083374977111816
Epoch: 6, Steps: 18 | Train Loss: 0.459 Vali Loss: 1.399 Vali Acc: 0.610 Test Loss: 1.399 Test Acc: 0.610
Validation loss decreased (-0.589986 --> -0.609986).  Saving model ...
Epoch: 7 cost time: 3.7537801265716553
Epoch: 7, Steps: 18 | Train Loss: 0.629 Vali Loss: 1.476 Vali Acc: 0.590 Test Loss: 1.476 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.336534023284912
Epoch: 8, Steps: 18 | Train Loss: 0.304 Vali Loss: 1.715 Vali Acc: 0.490 Test Loss: 1.715 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.648266792297363
Epoch: 9, Steps: 18 | Train Loss: 0.210 Vali Loss: 2.361 Vali Acc: 0.480 Test Loss: 2.361 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.938800096511841
Epoch: 10, Steps: 18 | Train Loss: 0.309 Vali Loss: 2.410 Vali Acc: 0.530 Test Loss: 2.410 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.049214124679565
Epoch: 11, Steps: 18 | Train Loss: 0.336 Vali Loss: 1.864 Vali Acc: 0.600 Test Loss: 1.864 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.5508668422698975
Epoch: 12, Steps: 18 | Train Loss: 0.393 Vali Loss: 1.930 Vali Acc: 0.570 Test Loss: 1.930 Test Acc: 0.570
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.996227979660034
Epoch: 13, Steps: 18 | Train Loss: 0.319 Vali Loss: 3.091 Vali Acc: 0.540 Test Loss: 3.091 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.622704982757568
Epoch: 14, Steps: 18 | Train Loss: 0.132 Vali Loss: 3.804 Vali Acc: 0.490 Test Loss: 3.804 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.435320615768433
Epoch: 15, Steps: 18 | Train Loss: 0.181 Vali Loss: 3.117 Vali Acc: 0.530 Test Loss: 3.117 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.233956575393677
Epoch: 16, Steps: 18 | Train Loss: 0.184 Vali Loss: 2.519 Vali Acc: 0.560 Test Loss: 2.519 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps75_str38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 164258
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps150_str75_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.860943078994751
Epoch: 1, Steps: 18 | Train Loss: 0.854 Vali Loss: 0.728 Vali Acc: 0.490 Test Loss: 0.728 Test Acc: 0.490
Validation loss decreased (inf --> -0.489993).  Saving model ...
Epoch: 2 cost time: 4.553515672683716
Epoch: 2, Steps: 18 | Train Loss: 0.749 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.489993 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 4.8759660720825195
Epoch: 3, Steps: 18 | Train Loss: 0.815 Vali Loss: 1.706 Vali Acc: 0.500 Test Loss: 1.706 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.35690712928772
Epoch: 4, Steps: 18 | Train Loss: 0.764 Vali Loss: 1.477 Vali Acc: 0.500 Test Loss: 1.477 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.064452886581421
Epoch: 5, Steps: 18 | Train Loss: 0.656 Vali Loss: 1.001 Vali Acc: 0.570 Test Loss: 1.001 Test Acc: 0.570
Validation loss decreased (-0.499988 --> -0.569990).  Saving model ...
Epoch: 6 cost time: 4.171459197998047
Epoch: 6, Steps: 18 | Train Loss: 0.446 Vali Loss: 1.112 Vali Acc: 0.520 Test Loss: 1.112 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.089139461517334
Epoch: 7, Steps: 18 | Train Loss: 0.319 Vali Loss: 1.426 Vali Acc: 0.540 Test Loss: 1.426 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.102165699005127
Epoch: 8, Steps: 18 | Train Loss: 0.356 Vali Loss: 1.209 Vali Acc: 0.610 Test Loss: 1.209 Test Acc: 0.610
Validation loss decreased (-0.569990 --> -0.609988).  Saving model ...
Epoch: 9 cost time: 4.521585702896118
Epoch: 9, Steps: 18 | Train Loss: 0.413 Vali Loss: 1.468 Vali Acc: 0.580 Test Loss: 1.468 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.689634323120117
Epoch: 10, Steps: 18 | Train Loss: 0.361 Vali Loss: 1.898 Vali Acc: 0.490 Test Loss: 1.898 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.3091676235198975
Epoch: 11, Steps: 18 | Train Loss: 0.255 Vali Loss: 2.203 Vali Acc: 0.500 Test Loss: 2.203 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.085299491882324
Epoch: 12, Steps: 18 | Train Loss: 0.108 Vali Loss: 1.766 Vali Acc: 0.490 Test Loss: 1.766 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.076622724533081
Epoch: 13, Steps: 18 | Train Loss: 0.112 Vali Loss: 1.594 Vali Acc: 0.540 Test Loss: 1.594 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.080088138580322
Epoch: 14, Steps: 18 | Train Loss: 0.068 Vali Loss: 2.276 Vali Acc: 0.560 Test Loss: 2.276 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.819844961166382
Epoch: 15, Steps: 18 | Train Loss: 0.065 Vali Loss: 2.494 Vali Acc: 0.510 Test Loss: 2.494 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.2995688915252686
Epoch: 16, Steps: 18 | Train Loss: 0.067 Vali Loss: 3.145 Vali Acc: 0.540 Test Loss: 3.145 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.7260148525238037
Epoch: 17, Steps: 18 | Train Loss: 0.093 Vali Loss: 2.420 Vali Acc: 0.550 Test Loss: 2.420 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.360387325286865
Epoch: 18, Steps: 18 | Train Loss: 0.072 Vali Loss: 2.465 Vali Acc: 0.540 Test Loss: 2.465 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps150_str75_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.61
model parameter : 87634
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps225_str113_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.506141185760498
Epoch: 1, Steps: 18 | Train Loss: 0.773 Vali Loss: 0.764 Vali Acc: 0.530 Test Loss: 0.764 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.6710784435272217
Epoch: 2, Steps: 18 | Train Loss: 0.743 Vali Loss: 0.712 Vali Acc: 0.600 Test Loss: 0.712 Test Acc: 0.600
Validation loss decreased (-0.529992 --> -0.599993).  Saving model ...
Epoch: 3 cost time: 4.011491537094116
Epoch: 3, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.809 Vali Acc: 0.580 Test Loss: 0.809 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7378199100494385
Epoch: 4, Steps: 18 | Train Loss: 0.561 Vali Loss: 0.884 Vali Acc: 0.480 Test Loss: 0.884 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1486315727233887
Epoch: 5, Steps: 18 | Train Loss: 0.473 Vali Loss: 1.012 Vali Acc: 0.650 Test Loss: 1.012 Test Acc: 0.650
Validation loss decreased (-0.599993 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 3.8157458305358887
Epoch: 6, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.997 Vali Acc: 0.530 Test Loss: 0.997 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.693726062774658
Epoch: 7, Steps: 18 | Train Loss: 0.341 Vali Loss: 1.050 Vali Acc: 0.480 Test Loss: 1.050 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.390437126159668
Epoch: 8, Steps: 18 | Train Loss: 0.350 Vali Loss: 1.203 Vali Acc: 0.510 Test Loss: 1.203 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.883647918701172
Epoch: 9, Steps: 18 | Train Loss: 0.232 Vali Loss: 1.137 Vali Acc: 0.520 Test Loss: 1.137 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.516040325164795
Epoch: 10, Steps: 18 | Train Loss: 0.237 Vali Loss: 1.294 Vali Acc: 0.520 Test Loss: 1.294 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.6041553020477295
Epoch: 11, Steps: 18 | Train Loss: 0.149 Vali Loss: 1.268 Vali Acc: 0.510 Test Loss: 1.268 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.9524166584014893
Epoch: 12, Steps: 18 | Train Loss: 0.143 Vali Loss: 1.476 Vali Acc: 0.540 Test Loss: 1.476 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.9291832447052
Epoch: 13, Steps: 18 | Train Loss: 0.086 Vali Loss: 1.542 Vali Acc: 0.530 Test Loss: 1.542 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.318131685256958
Epoch: 14, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.526 Vali Acc: 0.490 Test Loss: 1.526 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.9622957706451416
Epoch: 15, Steps: 18 | Train Loss: 0.083 Vali Loss: 1.621 Vali Acc: 0.530 Test Loss: 1.621 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps225_str113_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.65
model parameter : 60162
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps300_str150_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.449859857559204
Epoch: 1, Steps: 18 | Train Loss: 0.862 Vali Loss: 0.808 Vali Acc: 0.530 Test Loss: 0.808 Test Acc: 0.530
Validation loss decreased (inf --> -0.529992).  Saving model ...
Epoch: 2 cost time: 3.738027811050415
Epoch: 2, Steps: 18 | Train Loss: 0.813 Vali Loss: 0.881 Vali Acc: 0.530 Test Loss: 0.881 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0310416221618652
Epoch: 3, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.733 Vali Acc: 0.530 Test Loss: 0.733 Test Acc: 0.530
Validation loss decreased (-0.529992 --> -0.529993).  Saving model ...
Epoch: 4 cost time: 3.541057825088501
Epoch: 4, Steps: 18 | Train Loss: 0.565 Vali Loss: 0.839 Vali Acc: 0.560 Test Loss: 0.839 Test Acc: 0.560
Validation loss decreased (-0.529993 --> -0.559992).  Saving model ...
Epoch: 5 cost time: 3.676053285598755
Epoch: 5, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.890 Vali Acc: 0.570 Test Loss: 0.890 Test Acc: 0.570
Validation loss decreased (-0.559992 --> -0.569991).  Saving model ...
Epoch: 6 cost time: 3.149136781692505
Epoch: 6, Steps: 18 | Train Loss: 0.483 Vali Loss: 1.039 Vali Acc: 0.530 Test Loss: 1.039 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.139409303665161
Epoch: 7, Steps: 18 | Train Loss: 0.388 Vali Loss: 0.913 Vali Acc: 0.480 Test Loss: 0.913 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.631925106048584
Epoch: 8, Steps: 18 | Train Loss: 0.334 Vali Loss: 1.067 Vali Acc: 0.480 Test Loss: 1.067 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.9929792881011963
Epoch: 9, Steps: 18 | Train Loss: 0.268 Vali Loss: 1.026 Vali Acc: 0.500 Test Loss: 1.026 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3853390216827393
Epoch: 10, Steps: 18 | Train Loss: 0.213 Vali Loss: 1.111 Vali Acc: 0.480 Test Loss: 1.111 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.302942991256714
Epoch: 11, Steps: 18 | Train Loss: 0.165 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.7935304641723633
Epoch: 12, Steps: 18 | Train Loss: 0.142 Vali Loss: 1.547 Vali Acc: 0.520 Test Loss: 1.547 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0726318359375
Epoch: 13, Steps: 18 | Train Loss: 0.115 Vali Loss: 1.553 Vali Acc: 0.500 Test Loss: 1.553 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.821894407272339
Epoch: 14, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.337 Vali Acc: 0.500 Test Loss: 1.337 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.410355567932129
Epoch: 15, Steps: 18 | Train Loss: 0.129 Vali Loss: 1.486 Vali Acc: 0.510 Test Loss: 1.486 Test Acc: 0.510
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps300_str150_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.57
model parameter : 49074
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps450_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 8.492979049682617
Epoch: 1, Steps: 18 | Train Loss: 0.736 Vali Loss: 0.728 Vali Acc: 0.540 Test Loss: 0.728 Test Acc: 0.540
Validation loss decreased (inf --> -0.539993).  Saving model ...
Epoch: 2 cost time: 4.281010866165161
Epoch: 2, Steps: 18 | Train Loss: 0.738 Vali Loss: 0.732 Vali Acc: 0.480 Test Loss: 0.732 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.134866952896118
Epoch: 3, Steps: 18 | Train Loss: 0.686 Vali Loss: 0.733 Vali Acc: 0.540 Test Loss: 0.733 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.458836078643799
Epoch: 4, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.711 Vali Acc: 0.540 Test Loss: 0.711 Test Acc: 0.540
Validation loss decreased (-0.539993 --> -0.539993).  Saving model ...
Epoch: 5 cost time: 3.608401298522949
Epoch: 5, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.759 Vali Acc: 0.510 Test Loss: 0.759 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.8723087310791016
Epoch: 6, Steps: 18 | Train Loss: 0.519 Vali Loss: 0.752 Vali Acc: 0.560 Test Loss: 0.752 Test Acc: 0.560
Validation loss decreased (-0.539993 --> -0.559992).  Saving model ...
Epoch: 7 cost time: 3.6763107776641846
Epoch: 7, Steps: 18 | Train Loss: 0.448 Vali Loss: 0.813 Vali Acc: 0.520 Test Loss: 0.813 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8292698860168457
Epoch: 8, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.821 Vali Acc: 0.600 Test Loss: 0.821 Test Acc: 0.600
Validation loss decreased (-0.559992 --> -0.599992).  Saving model ...
Epoch: 9 cost time: 3.621401071548462
Epoch: 9, Steps: 18 | Train Loss: 0.403 Vali Loss: 0.982 Vali Acc: 0.580 Test Loss: 0.982 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.346309661865234
Epoch: 10, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.924 Vali Acc: 0.530 Test Loss: 0.924 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.970986843109131
Epoch: 11, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.969 Vali Acc: 0.530 Test Loss: 0.969 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.088477849960327
Epoch: 12, Steps: 18 | Train Loss: 0.297 Vali Loss: 1.031 Vali Acc: 0.560 Test Loss: 1.031 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.001777410507202
Epoch: 13, Steps: 18 | Train Loss: 0.291 Vali Loss: 0.982 Vali Acc: 0.560 Test Loss: 0.982 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.629835367202759
Epoch: 14, Steps: 18 | Train Loss: 0.215 Vali Loss: 1.130 Vali Acc: 0.520 Test Loss: 1.130 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.418964147567749
Epoch: 15, Steps: 18 | Train Loss: 0.206 Vali Loss: 1.266 Vali Acc: 0.540 Test Loss: 1.266 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.512602090835571
Epoch: 16, Steps: 18 | Train Loss: 0.157 Vali Loss: 1.360 Vali Acc: 0.510 Test Loss: 1.360 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.954785108566284
Epoch: 17, Steps: 18 | Train Loss: 0.136 Vali Loss: 1.464 Vali Acc: 0.530 Test Loss: 1.464 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.015207529067993
Epoch: 18, Steps: 18 | Train Loss: 0.128 Vali Loss: 1.426 Vali Acc: 0.470 Test Loss: 1.426 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps450_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.6
model parameter : 37138
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps600_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 6.214415788650513
Epoch: 1, Steps: 18 | Train Loss: 0.724 Vali Loss: 0.730 Vali Acc: 0.470 Test Loss: 0.730 Test Acc: 0.470
Validation loss decreased (inf --> -0.469993).  Saving model ...
Epoch: 2 cost time: 3.1518163681030273
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.745 Vali Acc: 0.460 Test Loss: 0.745 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.268911600112915
Epoch: 3, Steps: 18 | Train Loss: 0.688 Vali Loss: 0.724 Vali Acc: 0.520 Test Loss: 0.724 Test Acc: 0.520
Validation loss decreased (-0.469993 --> -0.519993).  Saving model ...
Epoch: 4 cost time: 3.087646484375
Epoch: 4, Steps: 18 | Train Loss: 0.667 Vali Loss: 0.725 Vali Acc: 0.550 Test Loss: 0.725 Test Acc: 0.550
Validation loss decreased (-0.519993 --> -0.549993).  Saving model ...
Epoch: 5 cost time: 3.4583137035369873
Epoch: 5, Steps: 18 | Train Loss: 0.602 Vali Loss: 0.733 Vali Acc: 0.560 Test Loss: 0.733 Test Acc: 0.560
Validation loss decreased (-0.549993 --> -0.559993).  Saving model ...
Epoch: 6 cost time: 3.5530033111572266
Epoch: 6, Steps: 18 | Train Loss: 0.576 Vali Loss: 0.870 Vali Acc: 0.520 Test Loss: 0.870 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0155255794525146
Epoch: 7, Steps: 18 | Train Loss: 0.523 Vali Loss: 0.787 Vali Acc: 0.520 Test Loss: 0.787 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.407992362976074
Epoch: 8, Steps: 18 | Train Loss: 0.438 Vali Loss: 0.754 Vali Acc: 0.550 Test Loss: 0.754 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.791184186935425
Epoch: 9, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.778 Vali Acc: 0.530 Test Loss: 0.778 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.54408860206604
Epoch: 10, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.863 Vali Acc: 0.510 Test Loss: 0.863 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4033660888671875
Epoch: 11, Steps: 18 | Train Loss: 0.345 Vali Loss: 0.887 Vali Acc: 0.550 Test Loss: 0.887 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5799121856689453
Epoch: 12, Steps: 18 | Train Loss: 0.276 Vali Loss: 0.905 Vali Acc: 0.510 Test Loss: 0.905 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.5937983989715576
Epoch: 13, Steps: 18 | Train Loss: 0.267 Vali Loss: 1.079 Vali Acc: 0.490 Test Loss: 1.079 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.506026983261108
Epoch: 14, Steps: 18 | Train Loss: 0.225 Vali Loss: 1.152 Vali Acc: 0.470 Test Loss: 1.152 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.211505889892578
Epoch: 15, Steps: 18 | Train Loss: 0.192 Vali Loss: 1.105 Vali Acc: 0.530 Test Loss: 1.105 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps600_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.56
model parameter : 33394
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_MotorImagery    Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/MotorImagery
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             64                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

278
100
>>>>>>>start training : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
278
100
100
Epoch: 1 cost time: 7.9675047397613525
Epoch: 1, Steps: 18 | Train Loss: 0.752 Vali Loss: 0.701 Vali Acc: 0.530 Test Loss: 0.701 Test Acc: 0.530
Validation loss decreased (inf --> -0.529993).  Saving model ...
Epoch: 2 cost time: 4.036799430847168
Epoch: 2, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.710 Vali Acc: 0.530 Test Loss: 0.710 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.559138059616089
Epoch: 3, Steps: 18 | Train Loss: 0.695 Vali Loss: 0.694 Vali Acc: 0.600 Test Loss: 0.694 Test Acc: 0.600
Validation loss decreased (-0.529993 --> -0.599993).  Saving model ...
Epoch: 4 cost time: 4.041079998016357
Epoch: 4, Steps: 18 | Train Loss: 0.625 Vali Loss: 0.697 Vali Acc: 0.590 Test Loss: 0.697 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.091415643692017
Epoch: 5, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.706 Vali Acc: 0.510 Test Loss: 0.706 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.624527931213379
Epoch: 6, Steps: 18 | Train Loss: 0.588 Vali Loss: 0.729 Vali Acc: 0.620 Test Loss: 0.729 Test Acc: 0.620
Validation loss decreased (-0.599993 --> -0.619993).  Saving model ...
Epoch: 7 cost time: 3.669872760772705
Epoch: 7, Steps: 18 | Train Loss: 0.560 Vali Loss: 0.732 Vali Acc: 0.560 Test Loss: 0.732 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4618985652923584
Epoch: 8, Steps: 18 | Train Loss: 0.478 Vali Loss: 0.768 Vali Acc: 0.550 Test Loss: 0.768 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.316326379776001
Epoch: 9, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.730 Vali Acc: 0.600 Test Loss: 0.730 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.5575919151306152
Epoch: 10, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.729 Vali Acc: 0.610 Test Loss: 0.729 Test Acc: 0.610
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.365888833999634
Epoch: 11, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.813 Vali Acc: 0.510 Test Loss: 0.813 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.377044200897217
Epoch: 12, Steps: 18 | Train Loss: 0.317 Vali Loss: 0.932 Vali Acc: 0.590 Test Loss: 0.932 Test Acc: 0.590
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.2493417263031006
Epoch: 13, Steps: 18 | Train Loss: 0.291 Vali Loss: 0.910 Vali Acc: 0.560 Test Loss: 0.910 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.082732439041138
Epoch: 14, Steps: 18 | Train Loss: 0.247 Vali Loss: 0.917 Vali Acc: 0.540 Test Loss: 0.917 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.1739702224731445
Epoch: 15, Steps: 18 | Train Loss: 0.240 Vali Loss: 1.049 Vali Acc: 0.530 Test Loss: 1.049 Test Acc: 0.530
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.4466183185577393
Epoch: 16, Steps: 18 | Train Loss: 0.200 Vali Loss: 1.034 Vali Acc: 0.540 Test Loss: 1.034 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_MotorImagery_PatchTST_UEA_ftM_sl3000_ll0_pl0_el1_dm16_nh4_df64_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
100
test shape: torch.Size([100, 2]) torch.Size([100, 1])
accuracy:0.62
model parameter : 31698
model size : 0.44MB
