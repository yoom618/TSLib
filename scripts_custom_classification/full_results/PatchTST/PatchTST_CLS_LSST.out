Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4468374
	speed: 0.1241s/iter; left time: 1899.5595s
Epoch: 1 cost time: 17.918147802352905
Epoch: 1, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.193 Vali Acc: 0.439 Test Loss: 2.193 Test Acc: 0.439
Validation loss decreased (inf --> -0.439151).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0911679
	speed: 0.2769s/iter; left time: 4193.5290s
Epoch: 2 cost time: 15.26483416557312
Epoch: 2, Steps: 154 | Train Loss: 1.620 Vali Loss: 4.100 Vali Acc: 0.311 Test Loss: 4.100 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1594534
	speed: 0.2856s/iter; left time: 4282.6031s
Epoch: 3 cost time: 15.688159227371216
Epoch: 3, Steps: 154 | Train Loss: 1.355 Vali Loss: 2.018 Vali Acc: 0.449 Test Loss: 2.018 Test Acc: 0.449
Validation loss decreased (-0.439151 --> -0.448885).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9181089
	speed: 0.2664s/iter; left time: 3953.1621s
Epoch: 4 cost time: 15.741487264633179
Epoch: 4, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.484 Vali Acc: 0.394 Test Loss: 2.484 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6274523
	speed: 0.2969s/iter; left time: 4360.1002s
Epoch: 5 cost time: 16.420478582382202
Epoch: 5, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.765 Vali Acc: 0.331 Test Loss: 2.765 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8518934
	speed: 0.2962s/iter; left time: 4303.5871s
Epoch: 6 cost time: 15.353946924209595
Epoch: 6, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.816 Vali Acc: 0.514 Test Loss: 2.816 Test Acc: 0.514
Validation loss decreased (-0.448885 --> -0.513759).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1386701
	speed: 0.2570s/iter; left time: 3695.3067s
Epoch: 7 cost time: 14.34907078742981
Epoch: 7, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.549 Vali Acc: 0.537 Test Loss: 2.549 Test Acc: 0.537
Validation loss decreased (-0.513759 --> -0.536876).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.8975542
	speed: 0.2747s/iter; left time: 3907.6684s
Epoch: 8 cost time: 14.98669147491455
Epoch: 8, Steps: 154 | Train Loss: 1.461 Vali Loss: 3.219 Vali Acc: 0.409 Test Loss: 3.219 Test Acc: 0.409
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9611648
	speed: 0.2519s/iter; left time: 3544.0681s
Epoch: 9 cost time: 11.628991842269897
Epoch: 9, Steps: 154 | Train Loss: 1.417 Vali Loss: 4.270 Vali Acc: 0.343 Test Loss: 4.270 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0708520
	speed: 0.2507s/iter; left time: 3488.2968s
Epoch: 10 cost time: 13.434903383255005
Epoch: 10, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.436 Vali Acc: 0.543 Test Loss: 3.436 Test Acc: 0.543
Validation loss decreased (-0.536876 --> -0.543356).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5247256
	speed: 0.2464s/iter; left time: 3391.3280s
Epoch: 11 cost time: 11.399440050125122
Epoch: 11, Steps: 154 | Train Loss: 1.301 Vali Loss: 4.847 Vali Acc: 0.477 Test Loss: 4.847 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7173347
	speed: 0.2427s/iter; left time: 3302.2097s
Epoch: 12 cost time: 13.06991720199585
Epoch: 12, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.258 Vali Acc: 0.509 Test Loss: 3.258 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4587118
	speed: 0.2556s/iter; left time: 3438.2249s
Epoch: 13 cost time: 12.04474139213562
Epoch: 13, Steps: 154 | Train Loss: 1.104 Vali Loss: 4.028 Vali Acc: 0.427 Test Loss: 4.028 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2715015
	speed: 0.2475s/iter; left time: 3291.5095s
Epoch: 14 cost time: 13.212103366851807
Epoch: 14, Steps: 154 | Train Loss: 1.152 Vali Loss: 4.333 Vali Acc: 0.401 Test Loss: 4.333 Test Acc: 0.401
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2096916
	speed: 0.2444s/iter; left time: 3212.3221s
Epoch: 15 cost time: 12.503718614578247
Epoch: 15, Steps: 154 | Train Loss: 1.004 Vali Loss: 4.555 Vali Acc: 0.425 Test Loss: 4.555 Test Acc: 0.425
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4796563
	speed: 0.2627s/iter; left time: 3412.4250s
Epoch: 16 cost time: 14.253628015518188
Epoch: 16, Steps: 154 | Train Loss: 0.895 Vali Loss: 4.585 Vali Acc: 0.490 Test Loss: 4.585 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.7971084
	speed: 0.2749s/iter; left time: 3529.0542s
Epoch: 17 cost time: 14.983719825744629
Epoch: 17, Steps: 154 | Train Loss: 0.797 Vali Loss: 5.295 Vali Acc: 0.512 Test Loss: 5.295 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.6984390
	speed: 0.2646s/iter; left time: 3356.0676s
Epoch: 18 cost time: 14.500149965286255
Epoch: 18, Steps: 154 | Train Loss: 0.730 Vali Loss: 4.606 Vali Acc: 0.353 Test Loss: 4.606 Test Acc: 0.353
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1091532
	speed: 0.2642s/iter; left time: 3309.7579s
Epoch: 19 cost time: 14.462431907653809
Epoch: 19, Steps: 154 | Train Loss: 0.694 Vali Loss: 4.261 Vali Acc: 0.485 Test Loss: 4.261 Test Acc: 0.485
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.5247877
	speed: 0.2994s/iter; left time: 3704.9724s
Epoch: 20 cost time: 18.240817546844482
Epoch: 20, Steps: 154 | Train Loss: 0.684 Vali Loss: 4.495 Vali Acc: 0.446 Test Loss: 4.495 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5433901054339011
model parameter : 785038
model size : 5.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5172943
	speed: 0.1397s/iter; left time: 2137.4279s
Epoch: 1 cost time: 19.982040882110596
Epoch: 1, Steps: 154 | Train Loss: 1.872 Vali Loss: 1.896 Vali Acc: 0.476 Test Loss: 1.896 Test Acc: 0.476
Validation loss decreased (inf --> -0.476056).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2410553
	speed: 0.3326s/iter; left time: 5037.2842s
Epoch: 2 cost time: 19.362002849578857
Epoch: 2, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.167 Vali Acc: 0.457 Test Loss: 2.167 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.9794244
	speed: 0.3721s/iter; left time: 5578.8794s
Epoch: 3 cost time: 19.111031770706177
Epoch: 3, Steps: 154 | Train Loss: 1.355 Vali Loss: 1.851 Vali Acc: 0.451 Test Loss: 1.851 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.4606702
	speed: 0.3309s/iter; left time: 4909.9343s
Epoch: 4 cost time: 17.317570447921753
Epoch: 4, Steps: 154 | Train Loss: 1.240 Vali Loss: 2.135 Vali Acc: 0.450 Test Loss: 2.135 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.5048393
	speed: 0.2825s/iter; left time: 4148.5709s
Epoch: 5 cost time: 15.88413691520691
Epoch: 5, Steps: 154 | Train Loss: 1.241 Vali Loss: 1.906 Vali Acc: 0.517 Test Loss: 1.906 Test Acc: 0.517
Validation loss decreased (-0.476056 --> -0.517418).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8305011
	speed: 0.3165s/iter; left time: 4598.6524s
Epoch: 6 cost time: 16.533961296081543
Epoch: 6, Steps: 154 | Train Loss: 1.163 Vali Loss: 3.613 Vali Acc: 0.407 Test Loss: 3.613 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7746234
	speed: 0.2807s/iter; left time: 4035.5997s
Epoch: 7 cost time: 15.337902784347534
Epoch: 7, Steps: 154 | Train Loss: 1.118 Vali Loss: 2.943 Vali Acc: 0.449 Test Loss: 2.943 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6344631
	speed: 0.2670s/iter; left time: 3797.8120s
Epoch: 8 cost time: 13.32133412361145
Epoch: 8, Steps: 154 | Train Loss: 1.080 Vali Loss: 2.564 Vali Acc: 0.469 Test Loss: 2.564 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6493355
	speed: 0.2946s/iter; left time: 4144.1081s
Epoch: 9 cost time: 17.5146324634552
Epoch: 9, Steps: 154 | Train Loss: 0.985 Vali Loss: 2.326 Vali Acc: 0.476 Test Loss: 2.326 Test Acc: 0.476
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.0169556
	speed: 0.2754s/iter; left time: 3832.0552s
Epoch: 10 cost time: 12.447531700134277
Epoch: 10, Steps: 154 | Train Loss: 0.951 Vali Loss: 2.999 Vali Acc: 0.468 Test Loss: 2.999 Test Acc: 0.468
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5819008
	speed: 0.2563s/iter; left time: 3526.4040s
Epoch: 11 cost time: 12.857618570327759
Epoch: 11, Steps: 154 | Train Loss: 0.914 Vali Loss: 3.315 Vali Acc: 0.435 Test Loss: 3.315 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.2122504
	speed: 0.2172s/iter; left time: 2955.6511s
Epoch: 12 cost time: 11.471927404403687
Epoch: 12, Steps: 154 | Train Loss: 0.852 Vali Loss: 3.821 Vali Acc: 0.380 Test Loss: 3.821 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2810723
	speed: 0.2464s/iter; left time: 3314.3378s
Epoch: 13 cost time: 13.480547428131104
Epoch: 13, Steps: 154 | Train Loss: 0.791 Vali Loss: 3.371 Vali Acc: 0.453 Test Loss: 3.371 Test Acc: 0.453
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.7595055
	speed: 0.2413s/iter; left time: 3209.6293s
Epoch: 14 cost time: 12.295969724655151
Epoch: 14, Steps: 154 | Train Loss: 0.675 Vali Loss: 3.780 Vali Acc: 0.514 Test Loss: 3.780 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4731216
	speed: 0.2104s/iter; left time: 2765.9865s
Epoch: 15 cost time: 9.657733678817749
Epoch: 15, Steps: 154 | Train Loss: 0.692 Vali Loss: 4.343 Vali Acc: 0.367 Test Loss: 4.343 Test Acc: 0.367
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5174371451743714
model parameter : 591630
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1492691
	speed: 0.1159s/iter; left time: 1773.5344s
Epoch: 1 cost time: 16.382569074630737
Epoch: 1, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.122 Vali Acc: 0.374 Test Loss: 2.122 Test Acc: 0.374
Validation loss decreased (inf --> -0.373864).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7578973
	speed: 0.2406s/iter; left time: 3644.0539s
Epoch: 2 cost time: 11.395982265472412
Epoch: 2, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.017 Vali Acc: 0.418 Test Loss: 2.017 Test Acc: 0.418
Validation loss decreased (-0.373864 --> -0.418066).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8040321
	speed: 0.2481s/iter; left time: 3719.5489s
Epoch: 3 cost time: 13.21640920639038
Epoch: 3, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.631 Vali Acc: 0.322 Test Loss: 2.631 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5831281
	speed: 0.2480s/iter; left time: 3679.8919s
Epoch: 4 cost time: 13.22326922416687
Epoch: 4, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.126 Vali Acc: 0.417 Test Loss: 2.126 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0078334
	speed: 0.2498s/iter; left time: 3668.5399s
Epoch: 5 cost time: 11.66694164276123
Epoch: 5, Steps: 154 | Train Loss: 1.231 Vali Loss: 2.148 Vali Acc: 0.452 Test Loss: 2.148 Test Acc: 0.452
Validation loss decreased (-0.418066 --> -0.451722).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5651343
	speed: 0.2450s/iter; left time: 3560.4703s
Epoch: 6 cost time: 14.435951709747314
Epoch: 6, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.718 Vali Acc: 0.376 Test Loss: 2.718 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5122805
	speed: 0.2646s/iter; left time: 3803.6777s
Epoch: 7 cost time: 13.705419301986694
Epoch: 7, Steps: 154 | Train Loss: 1.088 Vali Loss: 2.230 Vali Acc: 0.534 Test Loss: 2.230 Test Acc: 0.534
Validation loss decreased (-0.451722 --> -0.534041).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8235170
	speed: 0.2730s/iter; left time: 3883.3872s
Epoch: 8 cost time: 14.86631464958191
Epoch: 8, Steps: 154 | Train Loss: 1.076 Vali Loss: 2.495 Vali Acc: 0.427 Test Loss: 2.495 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5628052
	speed: 0.2796s/iter; left time: 3933.7361s
Epoch: 9 cost time: 15.565053462982178
Epoch: 9, Steps: 154 | Train Loss: 1.007 Vali Loss: 2.385 Vali Acc: 0.546 Test Loss: 2.385 Test Acc: 0.546
Validation loss decreased (-0.534041 --> -0.545799).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2504506
	speed: 0.2710s/iter; left time: 3771.4408s
Epoch: 10 cost time: 15.766302824020386
Epoch: 10, Steps: 154 | Train Loss: 0.887 Vali Loss: 2.791 Vali Acc: 0.494 Test Loss: 2.791 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1434106
	speed: 0.2876s/iter; left time: 3958.0216s
Epoch: 11 cost time: 18.007246255874634
Epoch: 11, Steps: 154 | Train Loss: 0.836 Vali Loss: 2.651 Vali Acc: 0.525 Test Loss: 2.651 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0155239
	speed: 0.3150s/iter; left time: 4286.5544s
Epoch: 12 cost time: 18.872670650482178
Epoch: 12, Steps: 154 | Train Loss: 0.830 Vali Loss: 3.213 Vali Acc: 0.465 Test Loss: 3.213 Test Acc: 0.465
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9964362
	speed: 0.3238s/iter; left time: 4355.7972s
Epoch: 13 cost time: 18.463701725006104
Epoch: 13, Steps: 154 | Train Loss: 0.779 Vali Loss: 3.508 Vali Acc: 0.552 Test Loss: 3.508 Test Acc: 0.552
Validation loss decreased (-0.545799 --> -0.552276).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9458351
	speed: 0.3169s/iter; left time: 4214.1277s
Epoch: 14 cost time: 18.2779278755188
Epoch: 14, Steps: 154 | Train Loss: 0.714 Vali Loss: 3.367 Vali Acc: 0.523 Test Loss: 3.367 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5781151
	speed: 0.2725s/iter; left time: 3582.2662s
Epoch: 15 cost time: 15.13818907737732
Epoch: 15, Steps: 154 | Train Loss: 0.651 Vali Loss: 3.038 Vali Acc: 0.537 Test Loss: 3.038 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6380270
	speed: 0.2859s/iter; left time: 3713.5316s
Epoch: 16 cost time: 16.34080934524536
Epoch: 16, Steps: 154 | Train Loss: 0.623 Vali Loss: 3.257 Vali Acc: 0.508 Test Loss: 3.257 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8471434
	speed: 0.2863s/iter; left time: 3675.7620s
Epoch: 17 cost time: 15.544569730758667
Epoch: 17, Steps: 154 | Train Loss: 0.594 Vali Loss: 3.146 Vali Acc: 0.527 Test Loss: 3.146 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.9640716
	speed: 0.2955s/iter; left time: 3747.6701s
Epoch: 18 cost time: 18.419559478759766
Epoch: 18, Steps: 154 | Train Loss: 0.597 Vali Loss: 3.843 Vali Acc: 0.474 Test Loss: 3.843 Test Acc: 0.474
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.9267344
	speed: 0.3099s/iter; left time: 3882.5742s
Epoch: 19 cost time: 17.998819589614868
Epoch: 19, Steps: 154 | Train Loss: 0.499 Vali Loss: 3.398 Vali Acc: 0.504 Test Loss: 3.398 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3096523
	speed: 0.3127s/iter; left time: 3869.9854s
Epoch: 20 cost time: 14.737725973129272
Epoch: 20, Steps: 154 | Train Loss: 0.507 Vali Loss: 3.616 Vali Acc: 0.481 Test Loss: 3.616 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.7003841
	speed: 0.3442s/iter; left time: 4206.5529s
Epoch: 21 cost time: 19.902838468551636
Epoch: 21, Steps: 154 | Train Loss: 0.473 Vali Loss: 3.630 Vali Acc: 0.533 Test Loss: 3.630 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6157867
	speed: 0.3064s/iter; left time: 3697.7476s
Epoch: 22 cost time: 15.427479982376099
Epoch: 22, Steps: 154 | Train Loss: 0.430 Vali Loss: 3.824 Vali Acc: 0.468 Test Loss: 3.824 Test Acc: 0.468
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0302124
	speed: 0.2990s/iter; left time: 3562.4891s
Epoch: 23 cost time: 17.855219841003418
Epoch: 23, Steps: 154 | Train Loss: 0.406 Vali Loss: 3.408 Vali Acc: 0.482 Test Loss: 3.408 Test Acc: 0.482
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5523114355231143
model parameter : 591758
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.2783177
	speed: 0.1424s/iter; left time: 2179.2655s
Epoch: 1 cost time: 21.885567903518677
Epoch: 1, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.146 Vali Acc: 0.433 Test Loss: 2.146 Test Acc: 0.433
Validation loss decreased (inf --> -0.433474).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3074732
	speed: 0.3579s/iter; left time: 5421.4010s
Epoch: 2 cost time: 18.119795083999634
Epoch: 2, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.230 Vali Acc: 0.444 Test Loss: 2.230 Test Acc: 0.444
Validation loss decreased (-0.433474 --> -0.444017).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6984675
	speed: 0.2649s/iter; left time: 3971.2566s
Epoch: 3 cost time: 18.079843282699585
Epoch: 3, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.175 Vali Acc: 0.472 Test Loss: 2.175 Test Acc: 0.472
Validation loss decreased (-0.444017 --> -0.471998).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0764270
	speed: 0.3089s/iter; left time: 4583.9107s
Epoch: 4 cost time: 15.663645267486572
Epoch: 4, Steps: 154 | Train Loss: 1.236 Vali Loss: 1.643 Vali Acc: 0.519 Test Loss: 1.643 Test Acc: 0.519
Validation loss decreased (-0.471998 --> -0.518637).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7228613
	speed: 0.2737s/iter; left time: 4019.9315s
Epoch: 5 cost time: 17.29933738708496
Epoch: 5, Steps: 154 | Train Loss: 1.188 Vali Loss: 1.966 Vali Acc: 0.453 Test Loss: 1.966 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5432801
	speed: 0.2865s/iter; left time: 4162.4299s
Epoch: 6 cost time: 13.355360746383667
Epoch: 6, Steps: 154 | Train Loss: 1.083 Vali Loss: 2.104 Vali Acc: 0.534 Test Loss: 2.104 Test Acc: 0.534
Validation loss decreased (-0.518637 --> -0.533637).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5513014
	speed: 0.2495s/iter; left time: 3586.9702s
Epoch: 7 cost time: 14.354478120803833
Epoch: 7, Steps: 154 | Train Loss: 1.005 Vali Loss: 2.248 Vali Acc: 0.452 Test Loss: 2.248 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4017985
	speed: 0.2716s/iter; left time: 3863.5790s
Epoch: 8 cost time: 13.780033111572266
Epoch: 8, Steps: 154 | Train Loss: 0.921 Vali Loss: 2.181 Vali Acc: 0.533 Test Loss: 2.181 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.7659535
	speed: 0.2622s/iter; left time: 3688.5072s
Epoch: 9 cost time: 17.031686067581177
Epoch: 9, Steps: 154 | Train Loss: 0.892 Vali Loss: 2.343 Vali Acc: 0.495 Test Loss: 2.343 Test Acc: 0.495
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.2583258
	speed: 0.3324s/iter; left time: 4624.8243s
Epoch: 10 cost time: 19.474661350250244
Epoch: 10, Steps: 154 | Train Loss: 0.838 Vali Loss: 2.536 Vali Acc: 0.484 Test Loss: 2.536 Test Acc: 0.484
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5411941
	speed: 0.3283s/iter; left time: 4518.4049s
Epoch: 11 cost time: 20.872488737106323
Epoch: 11, Steps: 154 | Train Loss: 0.748 Vali Loss: 2.443 Vali Acc: 0.490 Test Loss: 2.443 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.8936794
	speed: 0.3353s/iter; left time: 4562.7305s
Epoch: 12 cost time: 17.894010543823242
Epoch: 12, Steps: 154 | Train Loss: 0.700 Vali Loss: 2.558 Vali Acc: 0.511 Test Loss: 2.558 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0253888
	speed: 0.3003s/iter; left time: 4039.5832s
Epoch: 13 cost time: 19.01721167564392
Epoch: 13, Steps: 154 | Train Loss: 0.642 Vali Loss: 2.608 Vali Acc: 0.497 Test Loss: 2.608 Test Acc: 0.497
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4476062
	speed: 0.3158s/iter; left time: 4200.2301s
Epoch: 14 cost time: 16.181485414505005
Epoch: 14, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.685 Vali Acc: 0.502 Test Loss: 2.685 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3342975
	speed: 0.3250s/iter; left time: 4272.6831s
Epoch: 15 cost time: 21.781219482421875
Epoch: 15, Steps: 154 | Train Loss: 0.523 Vali Loss: 2.621 Vali Acc: 0.452 Test Loss: 2.621 Test Acc: 0.452
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.6824713
	speed: 0.3640s/iter; left time: 4728.4608s
Epoch: 16 cost time: 21.385688066482544
Epoch: 16, Steps: 154 | Train Loss: 0.497 Vali Loss: 2.938 Vali Acc: 0.502 Test Loss: 2.938 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5336577453365775
model parameter : 527502
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7980471
	speed: 0.0684s/iter; left time: 1047.1363s
Epoch: 1 cost time: 9.43939995765686
Epoch: 1, Steps: 154 | Train Loss: 1.975 Vali Loss: 1.708 Vali Acc: 0.460 Test Loss: 1.708 Test Acc: 0.460
Validation loss decreased (inf --> -0.460242).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4396636
	speed: 0.2222s/iter; left time: 3364.9614s
Epoch: 2 cost time: 7.828071594238281
Epoch: 2, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.222 Vali Acc: 0.464 Test Loss: 2.222 Test Acc: 0.464
Validation loss decreased (-0.460242 --> -0.464292).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0648460
	speed: 0.2219s/iter; left time: 3327.3247s
Epoch: 3 cost time: 7.5551598072052
Epoch: 3, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.071 Vali Acc: 0.458 Test Loss: 2.071 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4273407
	speed: 0.2049s/iter; left time: 3039.8037s
Epoch: 4 cost time: 6.679048299789429
Epoch: 4, Steps: 154 | Train Loss: 1.219 Vali Loss: 2.024 Vali Acc: 0.520 Test Loss: 2.024 Test Acc: 0.520
Validation loss decreased (-0.464292 --> -0.520256).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6128868
	speed: 0.2115s/iter; left time: 3105.2905s
Epoch: 5 cost time: 7.458720684051514
Epoch: 5, Steps: 154 | Train Loss: 1.148 Vali Loss: 1.960 Vali Acc: 0.495 Test Loss: 1.960 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8318105
	speed: 0.2175s/iter; left time: 3160.5996s
Epoch: 6 cost time: 7.610726356506348
Epoch: 6, Steps: 154 | Train Loss: 1.034 Vali Loss: 1.892 Vali Acc: 0.530 Test Loss: 1.892 Test Acc: 0.530
Validation loss decreased (-0.520256 --> -0.530395).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6323041
	speed: 0.2074s/iter; left time: 2982.2053s
Epoch: 7 cost time: 7.10929799079895
Epoch: 7, Steps: 154 | Train Loss: 1.003 Vali Loss: 2.685 Vali Acc: 0.481 Test Loss: 2.685 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0876348
	speed: 0.2099s/iter; left time: 2985.2271s
Epoch: 8 cost time: 7.565767288208008
Epoch: 8, Steps: 154 | Train Loss: 0.896 Vali Loss: 2.526 Vali Acc: 0.512 Test Loss: 2.526 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1908003
	speed: 0.2159s/iter; left time: 3037.8795s
Epoch: 9 cost time: 7.495233058929443
Epoch: 9, Steps: 154 | Train Loss: 0.799 Vali Loss: 2.378 Vali Acc: 0.501 Test Loss: 2.378 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8077899
	speed: 0.2102s/iter; left time: 2924.7494s
Epoch: 10 cost time: 7.501834154129028
Epoch: 10, Steps: 154 | Train Loss: 0.751 Vali Loss: 2.551 Vali Acc: 0.497 Test Loss: 2.551 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6181532
	speed: 0.2249s/iter; left time: 3094.2899s
Epoch: 11 cost time: 7.733572006225586
Epoch: 11, Steps: 154 | Train Loss: 0.711 Vali Loss: 2.400 Vali Acc: 0.476 Test Loss: 2.400 Test Acc: 0.476
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.8005220
	speed: 0.2248s/iter; left time: 3059.4347s
Epoch: 12 cost time: 7.557062387466431
Epoch: 12, Steps: 154 | Train Loss: 0.639 Vali Loss: 2.340 Vali Acc: 0.531 Test Loss: 2.340 Test Acc: 0.531
Validation loss decreased (-0.530395 --> -0.531201).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1330030
	speed: 0.2219s/iter; left time: 2984.7929s
Epoch: 13 cost time: 7.80209755897522
Epoch: 13, Steps: 154 | Train Loss: 0.620 Vali Loss: 2.811 Vali Acc: 0.463 Test Loss: 2.811 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6317074
	speed: 0.2059s/iter; left time: 2738.7445s
Epoch: 14 cost time: 7.326891660690308
Epoch: 14, Steps: 154 | Train Loss: 0.569 Vali Loss: 2.558 Vali Acc: 0.502 Test Loss: 2.558 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6904233
	speed: 0.2087s/iter; left time: 2743.5856s
Epoch: 15 cost time: 7.083352565765381
Epoch: 15, Steps: 154 | Train Loss: 0.533 Vali Loss: 2.582 Vali Acc: 0.515 Test Loss: 2.582 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9265283
	speed: 0.1953s/iter; left time: 2536.6702s
Epoch: 16 cost time: 6.92544412612915
Epoch: 16, Steps: 154 | Train Loss: 0.514 Vali Loss: 2.924 Vali Acc: 0.500 Test Loss: 2.924 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4853862
	speed: 0.2032s/iter; left time: 2608.5619s
Epoch: 17 cost time: 7.143970012664795
Epoch: 17, Steps: 154 | Train Loss: 0.445 Vali Loss: 2.803 Vali Acc: 0.508 Test Loss: 2.803 Test Acc: 0.508
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.0399512
	speed: 0.2104s/iter; left time: 2668.2068s
Epoch: 18 cost time: 7.099806070327759
Epoch: 18, Steps: 154 | Train Loss: 0.463 Vali Loss: 3.038 Vali Acc: 0.455 Test Loss: 3.038 Test Acc: 0.455
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.7019958
	speed: 0.1976s/iter; left time: 2475.9950s
Epoch: 19 cost time: 7.384466886520386
Epoch: 19, Steps: 154 | Train Loss: 0.445 Vali Loss: 3.066 Vali Acc: 0.495 Test Loss: 3.066 Test Acc: 0.495
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2834102
	speed: 0.2051s/iter; left time: 2538.6341s
Epoch: 20 cost time: 6.850921869277954
Epoch: 20, Steps: 154 | Train Loss: 0.456 Vali Loss: 3.086 Vali Acc: 0.524 Test Loss: 3.086 Test Acc: 0.524
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2741870
	speed: 0.2013s/iter; left time: 2460.6751s
Epoch: 21 cost time: 6.8587729930877686
Epoch: 21, Steps: 154 | Train Loss: 0.388 Vali Loss: 3.364 Vali Acc: 0.478 Test Loss: 3.364 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.3253610
	speed: 0.1976s/iter; left time: 2384.6127s
Epoch: 22 cost time: 6.996597051620483
Epoch: 22, Steps: 154 | Train Loss: 0.389 Vali Loss: 3.064 Vali Acc: 0.549 Test Loss: 3.064 Test Acc: 0.549
Validation loss decreased (-0.531201 --> -0.548631).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.3915995
	speed: 0.2005s/iter; left time: 2388.5630s
Epoch: 23 cost time: 7.079078197479248
Epoch: 23, Steps: 154 | Train Loss: 0.371 Vali Loss: 3.245 Vali Acc: 0.460 Test Loss: 3.245 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.2492171
	speed: 0.1933s/iter; left time: 2273.4738s
Epoch: 24 cost time: 6.801164865493774
Epoch: 24, Steps: 154 | Train Loss: 0.318 Vali Loss: 3.665 Vali Acc: 0.448 Test Loss: 3.665 Test Acc: 0.448
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.4396358
	speed: 0.1879s/iter; left time: 2180.2469s
Epoch: 25 cost time: 6.813368797302246
Epoch: 25, Steps: 154 | Train Loss: 0.354 Vali Loss: 3.156 Vali Acc: 0.505 Test Loss: 3.156 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.4050591
	speed: 0.1998s/iter; left time: 2288.4709s
Epoch: 26 cost time: 6.979903697967529
Epoch: 26, Steps: 154 | Train Loss: 0.371 Vali Loss: 3.746 Vali Acc: 0.499 Test Loss: 3.746 Test Acc: 0.499
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.2743141
	speed: 0.1820s/iter; left time: 2056.5339s
Epoch: 27 cost time: 6.400198459625244
Epoch: 27, Steps: 154 | Train Loss: 0.353 Vali Loss: 3.447 Vali Acc: 0.416 Test Loss: 3.447 Test Acc: 0.416
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.2631631
	speed: 0.1999s/iter; left time: 2227.0150s
Epoch: 28 cost time: 7.016838550567627
Epoch: 28, Steps: 154 | Train Loss: 0.328 Vali Loss: 3.560 Vali Acc: 0.486 Test Loss: 3.560 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.2231996
	speed: 0.1955s/iter; left time: 2148.3331s
Epoch: 29 cost time: 6.874051332473755
Epoch: 29, Steps: 154 | Train Loss: 0.339 Vali Loss: 3.410 Vali Acc: 0.493 Test Loss: 3.410 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0254482
	speed: 0.2054s/iter; left time: 2225.3461s
Epoch: 30 cost time: 7.249207496643066
Epoch: 30, Steps: 154 | Train Loss: 0.321 Vali Loss: 3.428 Vali Acc: 0.544 Test Loss: 3.428 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.2822197
	speed: 0.2112s/iter; left time: 2256.2068s
Epoch: 31 cost time: 7.490657567977905
Epoch: 31, Steps: 154 | Train Loss: 0.335 Vali Loss: 3.254 Vali Acc: 0.542 Test Loss: 3.254 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.2346029
	speed: 0.2138s/iter; left time: 2250.8354s
Epoch: 32 cost time: 7.348716974258423
Epoch: 32, Steps: 154 | Train Loss: 0.313 Vali Loss: 3.658 Vali Acc: 0.542 Test Loss: 3.658 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5486618004866181
model parameter : 495502
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9932998
	speed: 0.0677s/iter; left time: 1036.5268s
Epoch: 1 cost time: 9.32750940322876
Epoch: 1, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.017 Vali Acc: 0.431 Test Loss: 2.017 Test Acc: 0.431
Validation loss decreased (inf --> -0.431042).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0036826
	speed: 0.2308s/iter; left time: 3496.2136s
Epoch: 2 cost time: 7.758036375045776
Epoch: 2, Steps: 154 | Train Loss: 1.417 Vali Loss: 1.838 Vali Acc: 0.463 Test Loss: 1.838 Test Acc: 0.463
Validation loss decreased (-0.431042 --> -0.463080).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4632058
	speed: 0.2392s/iter; left time: 3586.2004s
Epoch: 3 cost time: 7.5988054275512695
Epoch: 3, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.456 Vali Acc: 0.414 Test Loss: 2.456 Test Acc: 0.414
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5619103
	speed: 0.2332s/iter; left time: 3461.0325s
Epoch: 4 cost time: 8.259697675704956
Epoch: 4, Steps: 154 | Train Loss: 1.178 Vali Loss: 1.910 Vali Acc: 0.483 Test Loss: 1.910 Test Acc: 0.483
Validation loss decreased (-0.463080 --> -0.482949).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6427063
	speed: 0.2490s/iter; left time: 3657.1227s
Epoch: 5 cost time: 7.694454908370972
Epoch: 5, Steps: 154 | Train Loss: 1.103 Vali Loss: 1.923 Vali Acc: 0.511 Test Loss: 1.923 Test Acc: 0.511
Validation loss decreased (-0.482949 --> -0.510524).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8945249
	speed: 0.2319s/iter; left time: 3369.4375s
Epoch: 6 cost time: 9.20806097984314
Epoch: 6, Steps: 154 | Train Loss: 1.043 Vali Loss: 1.754 Vali Acc: 0.512 Test Loss: 1.754 Test Acc: 0.512
Validation loss decreased (-0.510524 --> -0.512148).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2506616
	speed: 0.2662s/iter; left time: 3826.6662s
Epoch: 7 cost time: 8.94199824333191
Epoch: 7, Steps: 154 | Train Loss: 0.974 Vali Loss: 2.091 Vali Acc: 0.465 Test Loss: 2.091 Test Acc: 0.465
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6825572
	speed: 0.2530s/iter; left time: 3598.1415s
Epoch: 8 cost time: 8.085819244384766
Epoch: 8, Steps: 154 | Train Loss: 0.863 Vali Loss: 1.973 Vali Acc: 0.501 Test Loss: 1.973 Test Acc: 0.501
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9012616
	speed: 0.2429s/iter; left time: 3417.2364s
Epoch: 9 cost time: 8.300890445709229
Epoch: 9, Steps: 154 | Train Loss: 0.811 Vali Loss: 2.317 Vali Acc: 0.427 Test Loss: 2.317 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4612119
	speed: 0.2452s/iter; left time: 3411.3806s
Epoch: 10 cost time: 9.067973613739014
Epoch: 10, Steps: 154 | Train Loss: 0.745 Vali Loss: 2.547 Vali Acc: 0.461 Test Loss: 2.547 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6605279
	speed: 0.2544s/iter; left time: 3500.6578s
Epoch: 11 cost time: 8.534119129180908
Epoch: 11, Steps: 154 | Train Loss: 0.677 Vali Loss: 2.245 Vali Acc: 0.534 Test Loss: 2.245 Test Acc: 0.534
Validation loss decreased (-0.512148 --> -0.534446).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0595753
	speed: 0.2629s/iter; left time: 3577.4117s
Epoch: 12 cost time: 9.035061120986938
Epoch: 12, Steps: 154 | Train Loss: 0.589 Vali Loss: 2.445 Vali Acc: 0.521 Test Loss: 2.445 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0576000
	speed: 0.2479s/iter; left time: 3334.8218s
Epoch: 13 cost time: 8.209314107894897
Epoch: 13, Steps: 154 | Train Loss: 0.547 Vali Loss: 2.505 Vali Acc: 0.496 Test Loss: 2.505 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3919263
	speed: 0.2486s/iter; left time: 3305.4748s
Epoch: 14 cost time: 8.47857666015625
Epoch: 14, Steps: 154 | Train Loss: 0.548 Vali Loss: 2.493 Vali Acc: 0.523 Test Loss: 2.493 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.1193610
	speed: 0.2285s/iter; left time: 3004.0987s
Epoch: 15 cost time: 7.501557111740112
Epoch: 15, Steps: 154 | Train Loss: 0.459 Vali Loss: 2.839 Vali Acc: 0.474 Test Loss: 2.839 Test Acc: 0.474
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1487576
	speed: 0.2401s/iter; left time: 3118.9428s
Epoch: 16 cost time: 8.240202188491821
Epoch: 16, Steps: 154 | Train Loss: 0.464 Vali Loss: 3.134 Vali Acc: 0.481 Test Loss: 3.134 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3184898
	speed: 0.2334s/iter; left time: 2996.7255s
Epoch: 17 cost time: 8.04032564163208
Epoch: 17, Steps: 154 | Train Loss: 0.421 Vali Loss: 2.832 Vali Acc: 0.492 Test Loss: 2.832 Test Acc: 0.492
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.1795902
	speed: 0.2402s/iter; left time: 3045.8910s
Epoch: 18 cost time: 8.111381530761719
Epoch: 18, Steps: 154 | Train Loss: 0.444 Vali Loss: 3.038 Vali Acc: 0.461 Test Loss: 3.038 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6484404
	speed: 0.2384s/iter; left time: 2987.1890s
Epoch: 19 cost time: 7.943944215774536
Epoch: 19, Steps: 154 | Train Loss: 0.414 Vali Loss: 2.834 Vali Acc: 0.476 Test Loss: 2.834 Test Acc: 0.476
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0220020
	speed: 0.2135s/iter; left time: 2642.0938s
Epoch: 20 cost time: 7.987338542938232
Epoch: 20, Steps: 154 | Train Loss: 0.419 Vali Loss: 2.944 Vali Acc: 0.521 Test Loss: 2.944 Test Acc: 0.521
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.1631770
	speed: 0.2422s/iter; left time: 2959.3960s
Epoch: 21 cost time: 8.206053972244263
Epoch: 21, Steps: 154 | Train Loss: 0.370 Vali Loss: 3.287 Vali Acc: 0.455 Test Loss: 3.287 Test Acc: 0.455
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5344687753446877
model parameter : 474126
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6470687
	speed: 0.2309s/iter; left time: 3533.7575s
Epoch: 1 cost time: 35.423946380615234
Epoch: 1, Steps: 154 | Train Loss: 2.049 Vali Loss: 2.333 Vali Acc: 0.404 Test Loss: 2.333 Test Acc: 0.404
Validation loss decreased (inf --> -0.404275).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2922318
	speed: 0.5148s/iter; left time: 7797.2719s
Epoch: 2 cost time: 34.569303035736084
Epoch: 2, Steps: 154 | Train Loss: 1.603 Vali Loss: 1.688 Vali Acc: 0.487 Test Loss: 1.688 Test Acc: 0.487
Validation loss decreased (-0.404275 --> -0.487412).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2029359
	speed: 0.5856s/iter; left time: 8780.0415s
Epoch: 3 cost time: 38.701090574264526
Epoch: 3, Steps: 154 | Train Loss: 1.410 Vali Loss: 1.707 Vali Acc: 0.429 Test Loss: 1.707 Test Acc: 0.429
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4978034
	speed: 0.4758s/iter; left time: 7060.1944s
Epoch: 4 cost time: 25.183923721313477
Epoch: 4, Steps: 154 | Train Loss: 1.485 Vali Loss: 1.915 Vali Acc: 0.514 Test Loss: 1.915 Test Acc: 0.514
Validation loss decreased (-0.487412 --> -0.513768).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3333530
	speed: 0.4303s/iter; left time: 6318.3646s
Epoch: 5 cost time: 28.329984664916992
Epoch: 5, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.568 Vali Acc: 0.474 Test Loss: 2.568 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3949970
	speed: 0.4465s/iter; left time: 6488.0548s
Epoch: 6 cost time: 26.4428129196167
Epoch: 6, Steps: 154 | Train Loss: 1.523 Vali Loss: 3.124 Vali Acc: 0.472 Test Loss: 3.124 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.9460161
	speed: 0.3890s/iter; left time: 5592.2389s
Epoch: 7 cost time: 23.402093410491943
Epoch: 7, Steps: 154 | Train Loss: 1.624 Vali Loss: 3.694 Vali Acc: 0.431 Test Loss: 3.694 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1028829
	speed: 0.4410s/iter; left time: 6272.0491s
Epoch: 8 cost time: 29.448925495147705
Epoch: 8, Steps: 154 | Train Loss: 1.582 Vali Loss: 3.209 Vali Acc: 0.501 Test Loss: 3.209 Test Acc: 0.501
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.5851628
	speed: 0.4272s/iter; left time: 6009.6977s
Epoch: 9 cost time: 25.5224609375
Epoch: 9, Steps: 154 | Train Loss: 1.646 Vali Loss: 3.437 Vali Acc: 0.429 Test Loss: 3.437 Test Acc: 0.429
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0677029
	speed: 0.4307s/iter; left time: 5993.8258s
Epoch: 10 cost time: 28.476990461349487
Epoch: 10, Steps: 154 | Train Loss: 1.489 Vali Loss: 3.700 Vali Acc: 0.496 Test Loss: 3.700 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 2.2983277
	speed: 0.5009s/iter; left time: 6892.9669s
Epoch: 11 cost time: 33.203392028808594
Epoch: 11, Steps: 154 | Train Loss: 1.309 Vali Loss: 3.484 Vali Acc: 0.470 Test Loss: 3.484 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 2.3344903
	speed: 0.4710s/iter; left time: 6408.6746s
Epoch: 12 cost time: 26.552603244781494
Epoch: 12, Steps: 154 | Train Loss: 1.219 Vali Loss: 4.160 Vali Acc: 0.476 Test Loss: 4.160 Test Acc: 0.476
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.1051166
	speed: 0.4690s/iter; left time: 6308.9545s
Epoch: 13 cost time: 30.22275424003601
Epoch: 13, Steps: 154 | Train Loss: 1.084 Vali Loss: 3.510 Vali Acc: 0.423 Test Loss: 3.510 Test Acc: 0.423
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.7720517
	speed: 0.4608s/iter; left time: 6128.0225s
Epoch: 14 cost time: 29.467870235443115
Epoch: 14, Steps: 154 | Train Loss: 1.001 Vali Loss: 4.221 Vali Acc: 0.502 Test Loss: 4.221 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.513787510137875
model parameter : 686350
model size : 5.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5856630
	speed: 0.1849s/iter; left time: 2829.6918s
Epoch: 1 cost time: 28.395497798919678
Epoch: 1, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.170 Vali Acc: 0.427 Test Loss: 2.170 Test Acc: 0.427
Validation loss decreased (inf --> -0.426580).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5206836
	speed: 0.4379s/iter; left time: 6632.4544s
Epoch: 2 cost time: 28.55167031288147
Epoch: 2, Steps: 154 | Train Loss: 1.449 Vali Loss: 1.871 Vali Acc: 0.458 Test Loss: 1.871 Test Acc: 0.458
Validation loss decreased (-0.426580 --> -0.458213).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9604996
	speed: 0.4080s/iter; left time: 6117.2366s
Epoch: 3 cost time: 27.683320999145508
Epoch: 3, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.366 Vali Acc: 0.438 Test Loss: 2.366 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6483955
	speed: 0.4643s/iter; left time: 6889.4162s
Epoch: 4 cost time: 31.534000635147095
Epoch: 4, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.008 Vali Acc: 0.442 Test Loss: 2.008 Test Acc: 0.442
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4688578
	speed: 0.4834s/iter; left time: 7099.0613s
Epoch: 5 cost time: 34.05938172340393
Epoch: 5, Steps: 154 | Train Loss: 1.224 Vali Loss: 2.062 Vali Acc: 0.460 Test Loss: 2.062 Test Acc: 0.460
Validation loss decreased (-0.458213 --> -0.459833).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3240157
	speed: 0.4153s/iter; left time: 6035.0114s
Epoch: 6 cost time: 24.984232664108276
Epoch: 6, Steps: 154 | Train Loss: 1.161 Vali Loss: 2.461 Vali Acc: 0.495 Test Loss: 2.461 Test Acc: 0.495
Validation loss decreased (-0.459833 --> -0.494704).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2573553
	speed: 0.4651s/iter; left time: 6687.3363s
Epoch: 7 cost time: 31.882903337478638
Epoch: 7, Steps: 154 | Train Loss: 1.128 Vali Loss: 2.506 Vali Acc: 0.463 Test Loss: 2.506 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0381855
	speed: 0.4264s/iter; left time: 6064.1302s
Epoch: 8 cost time: 28.615566968917847
Epoch: 8, Steps: 154 | Train Loss: 0.981 Vali Loss: 2.756 Vali Acc: 0.443 Test Loss: 2.756 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.1050930
	speed: 0.4400s/iter; left time: 6190.8798s
Epoch: 9 cost time: 28.390823364257812
Epoch: 9, Steps: 154 | Train Loss: 0.951 Vali Loss: 2.887 Vali Acc: 0.470 Test Loss: 2.887 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4223028
	speed: 0.4308s/iter; left time: 5995.2565s
Epoch: 10 cost time: 29.78004002571106
Epoch: 10, Steps: 154 | Train Loss: 0.958 Vali Loss: 2.974 Vali Acc: 0.459 Test Loss: 2.974 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5484871
	speed: 0.4032s/iter; left time: 5548.4783s
Epoch: 11 cost time: 25.935984134674072
Epoch: 11, Steps: 154 | Train Loss: 0.811 Vali Loss: 3.929 Vali Acc: 0.436 Test Loss: 3.929 Test Acc: 0.436
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.8511418
	speed: 0.4103s/iter; left time: 5582.7883s
Epoch: 12 cost time: 27.743016958236694
Epoch: 12, Steps: 154 | Train Loss: 0.761 Vali Loss: 3.441 Vali Acc: 0.425 Test Loss: 3.441 Test Acc: 0.425
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0479026
	speed: 0.3830s/iter; left time: 5153.1670s
Epoch: 13 cost time: 22.433157444000244
Epoch: 13, Steps: 154 | Train Loss: 0.755 Vali Loss: 3.505 Vali Acc: 0.479 Test Loss: 3.505 Test Acc: 0.479
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.6932407
	speed: 0.3996s/iter; left time: 5313.6238s
Epoch: 14 cost time: 25.116028547286987
Epoch: 14, Steps: 154 | Train Loss: 0.663 Vali Loss: 3.436 Vali Acc: 0.490 Test Loss: 3.436 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2469407
	speed: 0.3584s/iter; left time: 4710.6489s
Epoch: 15 cost time: 25.444543600082397
Epoch: 15, Steps: 154 | Train Loss: 0.700 Vali Loss: 3.968 Vali Acc: 0.430 Test Loss: 3.968 Test Acc: 0.430
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.5052931
	speed: 0.4141s/iter; left time: 5380.0353s
Epoch: 16 cost time: 24.830701112747192
Epoch: 16, Steps: 154 | Train Loss: 0.585 Vali Loss: 3.692 Vali Acc: 0.500 Test Loss: 3.692 Test Acc: 0.500
Validation loss decreased (-0.494704 --> -0.499963).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4623967
	speed: 0.4184s/iter; left time: 5371.0462s
Epoch: 17 cost time: 30.0781569480896
Epoch: 17, Steps: 154 | Train Loss: 0.622 Vali Loss: 3.971 Vali Acc: 0.469 Test Loss: 3.971 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1790761
	speed: 0.4706s/iter; left time: 5968.0097s
Epoch: 18 cost time: 35.03343653678894
Epoch: 18, Steps: 154 | Train Loss: 0.533 Vali Loss: 3.679 Vali Acc: 0.500 Test Loss: 3.679 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5730278
	speed: 0.5455s/iter; left time: 6835.0262s
Epoch: 19 cost time: 38.655144691467285
Epoch: 19, Steps: 154 | Train Loss: 0.493 Vali Loss: 3.341 Vali Acc: 0.416 Test Loss: 3.341 Test Acc: 0.416
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.6353118
	speed: 0.5521s/iter; left time: 6832.0229s
Epoch: 20 cost time: 37.05864930152893
Epoch: 20, Steps: 154 | Train Loss: 0.499 Vali Loss: 4.367 Vali Acc: 0.451 Test Loss: 4.367 Test Acc: 0.451
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.7430899
	speed: 0.4755s/iter; left time: 5811.0847s
Epoch: 21 cost time: 26.905043363571167
Epoch: 21, Steps: 154 | Train Loss: 0.527 Vali Loss: 3.738 Vali Acc: 0.485 Test Loss: 3.738 Test Acc: 0.485
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.0426879
	speed: 0.4621s/iter; left time: 5576.3436s
Epoch: 22 cost time: 32.58030557632446
Epoch: 22, Steps: 154 | Train Loss: 0.393 Vali Loss: 3.689 Vali Acc: 0.471 Test Loss: 3.689 Test Acc: 0.471
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.1023717
	speed: 0.4167s/iter; left time: 4963.7022s
Epoch: 23 cost time: 24.378086805343628
Epoch: 23, Steps: 154 | Train Loss: 0.411 Vali Loss: 4.021 Vali Acc: 0.464 Test Loss: 4.021 Test Acc: 0.464
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1082004
	speed: 0.4115s/iter; left time: 4839.2704s
Epoch: 24 cost time: 26.073588609695435
Epoch: 24, Steps: 154 | Train Loss: 0.398 Vali Loss: 3.682 Vali Acc: 0.474 Test Loss: 3.682 Test Acc: 0.474
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.6883377
	speed: 0.4136s/iter; left time: 4799.7031s
Epoch: 25 cost time: 29.278523921966553
Epoch: 25, Steps: 154 | Train Loss: 0.404 Vali Loss: 3.960 Vali Acc: 0.525 Test Loss: 3.960 Test Acc: 0.525
Validation loss decreased (-0.499963 --> -0.525102).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.4742392
	speed: 0.3941s/iter; left time: 4512.7532s
Epoch: 26 cost time: 23.846631050109863
Epoch: 26, Steps: 154 | Train Loss: 0.383 Vali Loss: 3.873 Vali Acc: 0.504 Test Loss: 3.873 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0350617
	speed: 0.3873s/iter; left time: 4375.2542s
Epoch: 27 cost time: 26.08954906463623
Epoch: 27, Steps: 154 | Train Loss: 0.315 Vali Loss: 4.029 Vali Acc: 0.474 Test Loss: 4.029 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.8160930
	speed: 0.3707s/iter; left time: 4131.0390s
Epoch: 28 cost time: 23.032108306884766
Epoch: 28, Steps: 154 | Train Loss: 0.308 Vali Loss: 4.272 Vali Acc: 0.429 Test Loss: 4.272 Test Acc: 0.429
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.2688374
	speed: 0.3725s/iter; left time: 4093.4831s
Epoch: 29 cost time: 23.648751974105835
Epoch: 29, Steps: 154 | Train Loss: 0.382 Vali Loss: 4.514 Vali Acc: 0.451 Test Loss: 4.514 Test Acc: 0.451
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1864020
	speed: 0.3702s/iter; left time: 4011.5433s
Epoch: 30 cost time: 23.750073432922363
Epoch: 30, Steps: 154 | Train Loss: 0.283 Vali Loss: 3.921 Vali Acc: 0.463 Test Loss: 3.921 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.1237977
	speed: 0.3724s/iter; left time: 3977.7165s
Epoch: 31 cost time: 25.98352336883545
Epoch: 31, Steps: 154 | Train Loss: 0.314 Vali Loss: 4.524 Vali Acc: 0.519 Test Loss: 4.524 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.1715618
	speed: 0.4422s/iter; left time: 4655.4842s
Epoch: 32 cost time: 28.78683638572693
Epoch: 32, Steps: 154 | Train Loss: 0.263 Vali Loss: 4.424 Vali Acc: 0.441 Test Loss: 4.424 Test Acc: 0.441
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.2151691
	speed: 0.4010s/iter; left time: 4159.8091s
Epoch: 33 cost time: 22.340051889419556
Epoch: 33, Steps: 154 | Train Loss: 0.290 Vali Loss: 4.768 Vali Acc: 0.457 Test Loss: 4.768 Test Acc: 0.457
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.5668421
	speed: 0.3629s/iter; left time: 3708.8755s
Epoch: 34 cost time: 23.214664936065674
Epoch: 34, Steps: 154 | Train Loss: 0.294 Vali Loss: 4.387 Vali Acc: 0.505 Test Loss: 4.387 Test Acc: 0.505
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.2636005
	speed: 0.3646s/iter; left time: 3669.6350s
Epoch: 35 cost time: 22.138086557388306
Epoch: 35, Steps: 154 | Train Loss: 0.279 Vali Loss: 4.346 Vali Acc: 0.501 Test Loss: 4.346 Test Acc: 0.501
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5251419302514193
model parameter : 492942
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0192547
	speed: 0.1715s/iter; left time: 2623.8763s
Epoch: 1 cost time: 24.39373755455017
Epoch: 1, Steps: 154 | Train Loss: 1.904 Vali Loss: 1.706 Vali Acc: 0.492 Test Loss: 1.706 Test Acc: 0.492
Validation loss decreased (inf --> -0.492278).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6210730
	speed: 0.3519s/iter; left time: 5330.1764s
Epoch: 2 cost time: 23.502437353134155
Epoch: 2, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.687 Vali Acc: 0.403 Test Loss: 2.687 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1999322
	speed: 0.3684s/iter; left time: 5523.0786s
Epoch: 3 cost time: 21.417461395263672
Epoch: 3, Steps: 154 | Train Loss: 1.351 Vali Loss: 1.779 Vali Acc: 0.432 Test Loss: 1.779 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.1814415
	speed: 0.3348s/iter; left time: 4968.2351s
Epoch: 4 cost time: 19.522252082824707
Epoch: 4, Steps: 154 | Train Loss: 1.240 Vali Loss: 2.045 Vali Acc: 0.509 Test Loss: 2.045 Test Acc: 0.509
Validation loss decreased (-0.492278 --> -0.509306).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2296808
	speed: 0.2939s/iter; left time: 4316.0842s
Epoch: 5 cost time: 15.771529912948608
Epoch: 5, Steps: 154 | Train Loss: 1.217 Vali Loss: 2.494 Vali Acc: 0.461 Test Loss: 2.494 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9693886
	speed: 0.2990s/iter; left time: 4344.1397s
Epoch: 6 cost time: 18.140300273895264
Epoch: 6, Steps: 154 | Train Loss: 1.228 Vali Loss: 1.909 Vali Acc: 0.517 Test Loss: 1.909 Test Acc: 0.517
Validation loss decreased (-0.509306 --> -0.517418).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8301935
	speed: 0.2952s/iter; left time: 4244.7592s
Epoch: 7 cost time: 15.926737546920776
Epoch: 7, Steps: 154 | Train Loss: 1.147 Vali Loss: 2.427 Vali Acc: 0.485 Test Loss: 2.427 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6559576
	speed: 0.3066s/iter; left time: 4360.1604s
Epoch: 8 cost time: 18.02367639541626
Epoch: 8, Steps: 154 | Train Loss: 1.071 Vali Loss: 2.936 Vali Acc: 0.356 Test Loss: 2.936 Test Acc: 0.356
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0934741
	speed: 0.3503s/iter; left time: 4928.7957s
Epoch: 9 cost time: 25.218201637268066
Epoch: 9, Steps: 154 | Train Loss: 0.975 Vali Loss: 2.728 Vali Acc: 0.532 Test Loss: 2.728 Test Acc: 0.532
Validation loss decreased (-0.517418 --> -0.531603).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5460975
	speed: 0.4105s/iter; left time: 5711.4404s
Epoch: 10 cost time: 25.03978180885315
Epoch: 10, Steps: 154 | Train Loss: 0.904 Vali Loss: 2.739 Vali Acc: 0.517 Test Loss: 2.739 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8660423
	speed: 0.3954s/iter; left time: 5441.7841s
Epoch: 11 cost time: 20.199780225753784
Epoch: 11, Steps: 154 | Train Loss: 0.830 Vali Loss: 3.240 Vali Acc: 0.542 Test Loss: 3.240 Test Acc: 0.542
Validation loss decreased (-0.531603 --> -0.541736).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5897440
	speed: 0.3236s/iter; left time: 4403.2411s
Epoch: 12 cost time: 22.197945594787598
Epoch: 12, Steps: 154 | Train Loss: 0.789 Vali Loss: 2.982 Vali Acc: 0.478 Test Loss: 2.982 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6522335
	speed: 0.3550s/iter; left time: 4775.2116s
Epoch: 13 cost time: 18.330536365509033
Epoch: 13, Steps: 154 | Train Loss: 0.771 Vali Loss: 3.218 Vali Acc: 0.515 Test Loss: 3.218 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7058240
	speed: 0.3180s/iter; left time: 4229.7424s
Epoch: 14 cost time: 20.061257362365723
Epoch: 14, Steps: 154 | Train Loss: 0.678 Vali Loss: 3.331 Vali Acc: 0.556 Test Loss: 3.331 Test Acc: 0.556
Validation loss decreased (-0.541736 --> -0.556333).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8934683
	speed: 0.4300s/iter; left time: 5652.5462s
Epoch: 15 cost time: 28.581423044204712
Epoch: 15, Steps: 154 | Train Loss: 0.664 Vali Loss: 3.125 Vali Acc: 0.539 Test Loss: 3.125 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.4416327
	speed: 0.4218s/iter; left time: 5479.0309s
Epoch: 16 cost time: 24.532574892044067
Epoch: 16, Steps: 154 | Train Loss: 0.593 Vali Loss: 3.198 Vali Acc: 0.552 Test Loss: 3.198 Test Acc: 0.552
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6271054
	speed: 0.4088s/iter; left time: 5247.6743s
Epoch: 17 cost time: 24.660236120224
Epoch: 17, Steps: 154 | Train Loss: 0.583 Vali Loss: 3.729 Vali Acc: 0.505 Test Loss: 3.729 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.3812362
	speed: 0.3993s/iter; left time: 5064.3237s
Epoch: 18 cost time: 26.57714295387268
Epoch: 18, Steps: 154 | Train Loss: 0.467 Vali Loss: 3.356 Vali Acc: 0.539 Test Loss: 3.356 Test Acc: 0.539
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1807551
	speed: 0.4033s/iter; left time: 5053.5245s
Epoch: 19 cost time: 24.61484670639038
Epoch: 19, Steps: 154 | Train Loss: 0.477 Vali Loss: 3.703 Vali Acc: 0.507 Test Loss: 3.703 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.2198805
	speed: 0.4036s/iter; left time: 4994.6107s
Epoch: 20 cost time: 24.67875337600708
Epoch: 20, Steps: 154 | Train Loss: 0.476 Vali Loss: 3.697 Vali Acc: 0.506 Test Loss: 3.697 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2313964
	speed: 0.3802s/iter; left time: 4646.8074s
Epoch: 21 cost time: 23.439902305603027
Epoch: 21, Steps: 154 | Train Loss: 0.412 Vali Loss: 3.795 Vali Acc: 0.526 Test Loss: 3.795 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3535464
	speed: 0.3860s/iter; left time: 4657.9061s
Epoch: 22 cost time: 25.38069772720337
Epoch: 22, Steps: 154 | Train Loss: 0.410 Vali Loss: 3.358 Vali Acc: 0.511 Test Loss: 3.358 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2780840
	speed: 0.4261s/iter; left time: 5076.4451s
Epoch: 23 cost time: 27.124103784561157
Epoch: 23, Steps: 154 | Train Loss: 0.408 Vali Loss: 3.561 Vali Acc: 0.468 Test Loss: 3.561 Test Acc: 0.468
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.8469146
	speed: 0.4134s/iter; left time: 4861.5522s
Epoch: 24 cost time: 24.645220518112183
Epoch: 24, Steps: 154 | Train Loss: 0.415 Vali Loss: 3.497 Vali Acc: 0.492 Test Loss: 3.497 Test Acc: 0.492
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5563665855636658
model parameter : 493070
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7936054
	speed: 0.1765s/iter; left time: 2699.9137s
Epoch: 1 cost time: 25.750863075256348
Epoch: 1, Steps: 154 | Train Loss: 1.940 Vali Loss: 1.977 Vali Acc: 0.449 Test Loss: 1.977 Test Acc: 0.449
Validation loss decreased (inf --> -0.449291).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2092712
	speed: 0.3636s/iter; left time: 5506.8811s
Epoch: 2 cost time: 24.435638666152954
Epoch: 2, Steps: 154 | Train Loss: 1.394 Vali Loss: 1.870 Vali Acc: 0.476 Test Loss: 1.870 Test Acc: 0.476
Validation loss decreased (-0.449291 --> -0.475650).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8721219
	speed: 0.3879s/iter; left time: 5815.9078s
Epoch: 3 cost time: 24.184688329696655
Epoch: 3, Steps: 154 | Train Loss: 1.283 Vali Loss: 2.366 Vali Acc: 0.454 Test Loss: 2.366 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4341574
	speed: 0.3296s/iter; left time: 4890.8460s
Epoch: 4 cost time: 19.42673087120056
Epoch: 4, Steps: 154 | Train Loss: 1.247 Vali Loss: 1.772 Vali Acc: 0.476 Test Loss: 1.772 Test Acc: 0.476
Validation loss decreased (-0.475650 --> -0.476057).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9765446
	speed: 0.3212s/iter; left time: 4716.6310s
Epoch: 5 cost time: 20.133032083511353
Epoch: 5, Steps: 154 | Train Loss: 1.163 Vali Loss: 2.168 Vali Acc: 0.510 Test Loss: 2.168 Test Acc: 0.510
Validation loss decreased (-0.476057 --> -0.509711).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1153883
	speed: 0.3314s/iter; left time: 4815.1686s
Epoch: 6 cost time: 19.920243740081787
Epoch: 6, Steps: 154 | Train Loss: 1.079 Vali Loss: 2.045 Vali Acc: 0.506 Test Loss: 2.045 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8742405
	speed: 0.2911s/iter; left time: 4185.7497s
Epoch: 7 cost time: 16.283343076705933
Epoch: 7, Steps: 154 | Train Loss: 1.008 Vali Loss: 2.211 Vali Acc: 0.515 Test Loss: 2.211 Test Acc: 0.515
Validation loss decreased (-0.509711 --> -0.514982).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5025885
	speed: 0.3019s/iter; left time: 4294.6337s
Epoch: 8 cost time: 17.772733449935913
Epoch: 8, Steps: 154 | Train Loss: 0.888 Vali Loss: 2.702 Vali Acc: 0.367 Test Loss: 2.702 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0535497
	speed: 0.2965s/iter; left time: 4170.9323s
Epoch: 9 cost time: 17.017752170562744
Epoch: 9, Steps: 154 | Train Loss: 0.861 Vali Loss: 2.720 Vali Acc: 0.472 Test Loss: 2.720 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4512246
	speed: 0.2693s/iter; left time: 3746.7976s
Epoch: 10 cost time: 13.712839365005493
Epoch: 10, Steps: 154 | Train Loss: 0.797 Vali Loss: 2.786 Vali Acc: 0.411 Test Loss: 2.786 Test Acc: 0.411
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.3848640
	speed: 0.3096s/iter; left time: 4260.0851s
Epoch: 11 cost time: 20.86338186264038
Epoch: 11, Steps: 154 | Train Loss: 0.748 Vali Loss: 2.662 Vali Acc: 0.446 Test Loss: 2.662 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3122040
	speed: 0.3178s/iter; left time: 4324.8556s
Epoch: 12 cost time: 19.252981662750244
Epoch: 12, Steps: 154 | Train Loss: 0.670 Vali Loss: 2.657 Vali Acc: 0.484 Test Loss: 2.657 Test Acc: 0.484
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.2984553
	speed: 0.3047s/iter; left time: 4098.8501s
Epoch: 13 cost time: 18.564319610595703
Epoch: 13, Steps: 154 | Train Loss: 0.623 Vali Loss: 2.878 Vali Acc: 0.537 Test Loss: 2.878 Test Acc: 0.537
Validation loss decreased (-0.514982 --> -0.536873).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3138381
	speed: 0.2986s/iter; left time: 3971.3976s
Epoch: 14 cost time: 18.299126863479614
Epoch: 14, Steps: 154 | Train Loss: 0.564 Vali Loss: 3.368 Vali Acc: 0.521 Test Loss: 3.368 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5677541
	speed: 0.3371s/iter; left time: 4431.2001s
Epoch: 15 cost time: 22.111974477767944
Epoch: 15, Steps: 154 | Train Loss: 0.530 Vali Loss: 2.881 Vali Acc: 0.526 Test Loss: 2.881 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6964325
	speed: 0.3483s/iter; left time: 4524.6830s
Epoch: 16 cost time: 22.10901427268982
Epoch: 16, Steps: 154 | Train Loss: 0.535 Vali Loss: 3.297 Vali Acc: 0.453 Test Loss: 3.297 Test Acc: 0.453
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2123452
	speed: 0.3443s/iter; left time: 4419.2550s
Epoch: 17 cost time: 21.735934495925903
Epoch: 17, Steps: 154 | Train Loss: 0.497 Vali Loss: 3.018 Vali Acc: 0.463 Test Loss: 3.018 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.1791178
	speed: 0.3387s/iter; left time: 4295.6787s
Epoch: 18 cost time: 20.6949200630188
Epoch: 18, Steps: 154 | Train Loss: 0.455 Vali Loss: 2.894 Vali Acc: 0.491 Test Loss: 2.894 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.1687883
	speed: 0.3475s/iter; left time: 4353.7971s
Epoch: 19 cost time: 21.440653085708618
Epoch: 19, Steps: 154 | Train Loss: 0.440 Vali Loss: 3.442 Vali Acc: 0.475 Test Loss: 3.442 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3885086
	speed: 0.3261s/iter; left time: 4035.5950s
Epoch: 20 cost time: 20.40833806991577
Epoch: 20, Steps: 154 | Train Loss: 0.432 Vali Loss: 3.279 Vali Acc: 0.486 Test Loss: 3.279 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.3147511
	speed: 0.3075s/iter; left time: 3757.7606s
Epoch: 21 cost time: 17.422618627548218
Epoch: 21, Steps: 154 | Train Loss: 0.400 Vali Loss: 3.343 Vali Acc: 0.548 Test Loss: 3.343 Test Acc: 0.548
Validation loss decreased (-0.536873 --> -0.547817).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1334875
	speed: 0.3132s/iter; left time: 3779.0100s
Epoch: 22 cost time: 19.35492992401123
Epoch: 22, Steps: 154 | Train Loss: 0.373 Vali Loss: 3.359 Vali Acc: 0.479 Test Loss: 3.359 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4028385
	speed: 0.3319s/iter; left time: 3953.3857s
Epoch: 23 cost time: 21.711227416992188
Epoch: 23, Steps: 154 | Train Loss: 0.390 Vali Loss: 3.298 Vali Acc: 0.472 Test Loss: 3.298 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.9398388
	speed: 0.3594s/iter; left time: 4226.2677s
Epoch: 24 cost time: 20.74076199531555
Epoch: 24, Steps: 154 | Train Loss: 0.390 Vali Loss: 3.216 Vali Acc: 0.478 Test Loss: 3.216 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.8599439
	speed: 0.3250s/iter; left time: 3771.6783s
Epoch: 25 cost time: 21.167486906051636
Epoch: 25, Steps: 154 | Train Loss: 0.369 Vali Loss: 3.549 Vali Acc: 0.483 Test Loss: 3.549 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.2809563
	speed: 0.3391s/iter; left time: 3883.3175s
Epoch: 26 cost time: 19.56516432762146
Epoch: 26, Steps: 154 | Train Loss: 0.305 Vali Loss: 3.849 Vali Acc: 0.488 Test Loss: 3.849 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.3508781
	speed: 0.3051s/iter; left time: 3446.6763s
Epoch: 27 cost time: 19.48858094215393
Epoch: 27, Steps: 154 | Train Loss: 0.332 Vali Loss: 3.871 Vali Acc: 0.439 Test Loss: 3.871 Test Acc: 0.439
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.4296936
	speed: 0.3400s/iter; left time: 3788.9267s
Epoch: 28 cost time: 20.7041335105896
Epoch: 28, Steps: 154 | Train Loss: 0.351 Vali Loss: 3.434 Vali Acc: 0.516 Test Loss: 3.434 Test Acc: 0.516
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.2296592
	speed: 0.2748s/iter; left time: 3019.2685s
Epoch: 29 cost time: 12.925009489059448
Epoch: 29, Steps: 154 | Train Loss: 0.341 Vali Loss: 3.471 Vali Acc: 0.488 Test Loss: 3.471 Test Acc: 0.488
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.4812213
	speed: 0.2677s/iter; left time: 2900.8807s
Epoch: 30 cost time: 15.615177392959595
Epoch: 30, Steps: 154 | Train Loss: 0.281 Vali Loss: 3.584 Vali Acc: 0.498 Test Loss: 3.584 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.5925918
	speed: 0.2816s/iter; left time: 3008.1115s
Epoch: 31 cost time: 16.155286073684692
Epoch: 31, Steps: 154 | Train Loss: 0.377 Vali Loss: 3.770 Vali Acc: 0.541 Test Loss: 3.770 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5478507704785077
model parameter : 428814
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7905238
	speed: 0.0715s/iter; left time: 1093.3449s
Epoch: 1 cost time: 10.074711561203003
Epoch: 1, Steps: 154 | Train Loss: 1.984 Vali Loss: 1.787 Vali Acc: 0.430 Test Loss: 1.787 Test Acc: 0.430
Validation loss decreased (inf --> -0.430234).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1284223
	speed: 0.2019s/iter; left time: 3057.6911s
Epoch: 2 cost time: 7.825820684432983
Epoch: 2, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.013 Vali Acc: 0.472 Test Loss: 2.013 Test Acc: 0.472
Validation loss decreased (-0.430234 --> -0.472405).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6246527
	speed: 0.1919s/iter; left time: 2877.8462s
Epoch: 3 cost time: 8.30700135231018
Epoch: 3, Steps: 154 | Train Loss: 1.282 Vali Loss: 1.884 Vali Acc: 0.425 Test Loss: 1.884 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1060748
	speed: 0.2044s/iter; left time: 3032.9027s
Epoch: 4 cost time: 8.473076105117798
Epoch: 4, Steps: 154 | Train Loss: 1.203 Vali Loss: 2.109 Vali Acc: 0.503 Test Loss: 2.109 Test Acc: 0.503
Validation loss decreased (-0.472405 --> -0.503223).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9126441
	speed: 0.1915s/iter; left time: 2812.8365s
Epoch: 5 cost time: 8.01581597328186
Epoch: 5, Steps: 154 | Train Loss: 1.141 Vali Loss: 2.128 Vali Acc: 0.427 Test Loss: 2.128 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6728021
	speed: 0.2090s/iter; left time: 3036.4895s
Epoch: 6 cost time: 8.794156789779663
Epoch: 6, Steps: 154 | Train Loss: 1.095 Vali Loss: 1.994 Vali Acc: 0.517 Test Loss: 1.994 Test Acc: 0.517
Validation loss decreased (-0.503223 --> -0.517012).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0728989
	speed: 0.2152s/iter; left time: 3094.0112s
Epoch: 7 cost time: 9.254027843475342
Epoch: 7, Steps: 154 | Train Loss: 0.968 Vali Loss: 2.028 Vali Acc: 0.500 Test Loss: 2.028 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3646379
	speed: 0.2065s/iter; left time: 2936.4467s
Epoch: 8 cost time: 8.105831623077393
Epoch: 8, Steps: 154 | Train Loss: 0.903 Vali Loss: 2.108 Vali Acc: 0.493 Test Loss: 2.108 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.8748450
	speed: 0.2099s/iter; left time: 2953.1969s
Epoch: 9 cost time: 8.56595754623413
Epoch: 9, Steps: 154 | Train Loss: 0.833 Vali Loss: 2.213 Vali Acc: 0.472 Test Loss: 2.213 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3796839
	speed: 0.2138s/iter; left time: 2975.4977s
Epoch: 10 cost time: 9.51536250114441
Epoch: 10, Steps: 154 | Train Loss: 0.796 Vali Loss: 2.389 Vali Acc: 0.539 Test Loss: 2.389 Test Acc: 0.539
Validation loss decreased (-0.517012 --> -0.539311).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8310193
	speed: 0.2078s/iter; left time: 2859.7685s
Epoch: 11 cost time: 8.825378656387329
Epoch: 11, Steps: 154 | Train Loss: 0.690 Vali Loss: 2.213 Vali Acc: 0.508 Test Loss: 2.213 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5695416
	speed: 0.2137s/iter; left time: 2907.1645s
Epoch: 12 cost time: 9.08186411857605
Epoch: 12, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.622 Vali Acc: 0.471 Test Loss: 2.622 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7714072
	speed: 0.2100s/iter; left time: 2825.7656s
Epoch: 13 cost time: 9.367989540100098
Epoch: 13, Steps: 154 | Train Loss: 0.561 Vali Loss: 2.439 Vali Acc: 0.543 Test Loss: 2.439 Test Acc: 0.543
Validation loss decreased (-0.539311 --> -0.542555).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7505829
	speed: 0.2129s/iter; left time: 2830.8679s
Epoch: 14 cost time: 8.65782904624939
Epoch: 14, Steps: 154 | Train Loss: 0.569 Vali Loss: 2.673 Vali Acc: 0.520 Test Loss: 2.673 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8728607
	speed: 0.2144s/iter; left time: 2817.6355s
Epoch: 15 cost time: 9.356016397476196
Epoch: 15, Steps: 154 | Train Loss: 0.538 Vali Loss: 2.435 Vali Acc: 0.515 Test Loss: 2.435 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7253122
	speed: 0.2086s/iter; left time: 2710.1108s
Epoch: 16 cost time: 9.107876062393188
Epoch: 16, Steps: 154 | Train Loss: 0.505 Vali Loss: 2.703 Vali Acc: 0.515 Test Loss: 2.703 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0844160
	speed: 0.2085s/iter; left time: 2676.1233s
Epoch: 17 cost time: 9.159914255142212
Epoch: 17, Steps: 154 | Train Loss: 0.468 Vali Loss: 2.770 Vali Acc: 0.517 Test Loss: 2.770 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5489372
	speed: 0.2130s/iter; left time: 2701.7603s
Epoch: 18 cost time: 9.41703748703003
Epoch: 18, Steps: 154 | Train Loss: 0.429 Vali Loss: 2.839 Vali Acc: 0.530 Test Loss: 2.839 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.5269214
	speed: 0.2136s/iter; left time: 2676.1626s
Epoch: 19 cost time: 9.069674253463745
Epoch: 19, Steps: 154 | Train Loss: 0.419 Vali Loss: 3.258 Vali Acc: 0.470 Test Loss: 3.258 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2372057
	speed: 0.2170s/iter; left time: 2685.1565s
Epoch: 20 cost time: 9.167996883392334
Epoch: 20, Steps: 154 | Train Loss: 0.415 Vali Loss: 2.805 Vali Acc: 0.519 Test Loss: 2.805 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1334250
	speed: 0.2070s/iter; left time: 2529.3704s
Epoch: 21 cost time: 8.879407405853271
Epoch: 21, Steps: 154 | Train Loss: 0.386 Vali Loss: 3.234 Vali Acc: 0.502 Test Loss: 3.234 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.8362485
	speed: 0.2092s/iter; left time: 2524.4795s
Epoch: 22 cost time: 9.176221132278442
Epoch: 22, Steps: 154 | Train Loss: 0.422 Vali Loss: 2.990 Vali Acc: 0.487 Test Loss: 2.990 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.9388973
	speed: 0.2080s/iter; left time: 2478.2138s
Epoch: 23 cost time: 9.421648979187012
Epoch: 23, Steps: 154 | Train Loss: 0.423 Vali Loss: 3.005 Vali Acc: 0.470 Test Loss: 3.005 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5425790754257908
model parameter : 396814
model size : 3.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7210641
	speed: 0.0854s/iter; left time: 1306.9674s
Epoch: 1 cost time: 11.964216470718384
Epoch: 1, Steps: 154 | Train Loss: 2.028 Vali Loss: 1.689 Vali Acc: 0.454 Test Loss: 1.689 Test Acc: 0.454
Validation loss decreased (inf --> -0.454160).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6050338
	speed: 0.2283s/iter; left time: 3458.4002s
Epoch: 2 cost time: 9.680768251419067
Epoch: 2, Steps: 154 | Train Loss: 1.379 Vali Loss: 1.957 Vali Acc: 0.457 Test Loss: 1.957 Test Acc: 0.457
Validation loss decreased (-0.454160 --> -0.456590).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8321877
	speed: 0.2095s/iter; left time: 3141.5569s
Epoch: 3 cost time: 9.21210765838623
Epoch: 3, Steps: 154 | Train Loss: 1.246 Vali Loss: 1.654 Vali Acc: 0.517 Test Loss: 1.654 Test Acc: 0.517
Validation loss decreased (-0.456590 --> -0.516610).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8590003
	speed: 0.2131s/iter; left time: 3162.8039s
Epoch: 4 cost time: 8.904323101043701
Epoch: 4, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.056 Vali Acc: 0.487 Test Loss: 2.056 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5545619
	speed: 0.2155s/iter; left time: 3164.8442s
Epoch: 5 cost time: 9.32778525352478
Epoch: 5, Steps: 154 | Train Loss: 1.114 Vali Loss: 2.459 Vali Acc: 0.440 Test Loss: 2.459 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0080323
	speed: 0.2053s/iter; left time: 2983.4505s
Epoch: 6 cost time: 8.304444551467896
Epoch: 6, Steps: 154 | Train Loss: 1.011 Vali Loss: 2.018 Vali Acc: 0.470 Test Loss: 2.018 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9753486
	speed: 0.2006s/iter; left time: 2884.0624s
Epoch: 7 cost time: 8.359617710113525
Epoch: 7, Steps: 154 | Train Loss: 0.945 Vali Loss: 1.945 Vali Acc: 0.517 Test Loss: 1.945 Test Acc: 0.517
Validation loss decreased (-0.516610 --> -0.517418).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2208474
	speed: 0.1957s/iter; left time: 2783.6042s
Epoch: 8 cost time: 7.666924476623535
Epoch: 8, Steps: 154 | Train Loss: 0.887 Vali Loss: 2.421 Vali Acc: 0.459 Test Loss: 2.421 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7729568
	speed: 0.1852s/iter; left time: 2605.4895s
Epoch: 9 cost time: 7.707701206207275
Epoch: 9, Steps: 154 | Train Loss: 0.809 Vali Loss: 2.319 Vali Acc: 0.506 Test Loss: 2.319 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0912163
	speed: 0.1957s/iter; left time: 2722.8566s
Epoch: 10 cost time: 7.845128774642944
Epoch: 10, Steps: 154 | Train Loss: 0.769 Vali Loss: 1.972 Vali Acc: 0.508 Test Loss: 1.972 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9819421
	speed: 0.2158s/iter; left time: 2969.6405s
Epoch: 11 cost time: 9.461886644363403
Epoch: 11, Steps: 154 | Train Loss: 0.663 Vali Loss: 2.400 Vali Acc: 0.455 Test Loss: 2.400 Test Acc: 0.455
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.8731565
	speed: 0.2263s/iter; left time: 3079.0296s
Epoch: 12 cost time: 9.695313930511475
Epoch: 12, Steps: 154 | Train Loss: 0.600 Vali Loss: 2.291 Vali Acc: 0.552 Test Loss: 2.291 Test Acc: 0.552
Validation loss decreased (-0.517418 --> -0.551883).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5426696
	speed: 0.2247s/iter; left time: 3022.4324s
Epoch: 13 cost time: 9.323059320449829
Epoch: 13, Steps: 154 | Train Loss: 0.590 Vali Loss: 2.248 Vali Acc: 0.502 Test Loss: 2.248 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2376855
	speed: 0.2278s/iter; left time: 3029.1367s
Epoch: 14 cost time: 9.630050420761108
Epoch: 14, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.488 Vali Acc: 0.519 Test Loss: 2.488 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.3848581
	speed: 0.2133s/iter; left time: 2804.1824s
Epoch: 15 cost time: 8.346431732177734
Epoch: 15, Steps: 154 | Train Loss: 0.533 Vali Loss: 2.492 Vali Acc: 0.523 Test Loss: 2.492 Test Acc: 0.523
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1041736
	speed: 0.2107s/iter; left time: 2737.7254s
Epoch: 16 cost time: 9.086498260498047
Epoch: 16, Steps: 154 | Train Loss: 0.478 Vali Loss: 2.512 Vali Acc: 0.511 Test Loss: 2.512 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3290247
	speed: 0.2146s/iter; left time: 2754.2179s
Epoch: 17 cost time: 9.31677508354187
Epoch: 17, Steps: 154 | Train Loss: 0.473 Vali Loss: 2.837 Vali Acc: 0.486 Test Loss: 2.837 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2410114
	speed: 0.2251s/iter; left time: 2854.5895s
Epoch: 18 cost time: 9.065607070922852
Epoch: 18, Steps: 154 | Train Loss: 0.424 Vali Loss: 2.798 Vali Acc: 0.479 Test Loss: 2.798 Test Acc: 0.479
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.7150437
	speed: 0.2129s/iter; left time: 2667.6092s
Epoch: 19 cost time: 9.262304067611694
Epoch: 19, Steps: 154 | Train Loss: 0.444 Vali Loss: 2.825 Vali Acc: 0.548 Test Loss: 2.825 Test Acc: 0.548
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1935986
	speed: 0.2312s/iter; left time: 2861.4691s
Epoch: 20 cost time: 10.461763620376587
Epoch: 20, Steps: 154 | Train Loss: 0.408 Vali Loss: 2.662 Vali Acc: 0.497 Test Loss: 2.662 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1722657
	speed: 0.2427s/iter; left time: 2966.5089s
Epoch: 21 cost time: 11.087422609329224
Epoch: 21, Steps: 154 | Train Loss: 0.402 Vali Loss: 2.716 Vali Acc: 0.504 Test Loss: 2.716 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3257101
	speed: 0.2346s/iter; left time: 2831.4240s
Epoch: 22 cost time: 10.542407989501953
Epoch: 22, Steps: 154 | Train Loss: 0.374 Vali Loss: 3.341 Vali Acc: 0.377 Test Loss: 3.341 Test Acc: 0.377
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5519059205190592
model parameter : 375438
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7483900
	speed: 0.1639s/iter; left time: 2507.5002s
Epoch: 1 cost time: 24.588948011398315
Epoch: 1, Steps: 154 | Train Loss: 2.051 Vali Loss: 1.891 Vali Acc: 0.491 Test Loss: 1.891 Test Acc: 0.491
Validation loss decreased (inf --> -0.490654).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9165157
	speed: 0.3784s/iter; left time: 5731.9597s
Epoch: 2 cost time: 23.356882572174072
Epoch: 2, Steps: 154 | Train Loss: 1.602 Vali Loss: 1.897 Vali Acc: 0.466 Test Loss: 1.897 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9707346
	speed: 0.3601s/iter; left time: 5399.4578s
Epoch: 3 cost time: 21.569887399673462
Epoch: 3, Steps: 154 | Train Loss: 1.437 Vali Loss: 1.726 Vali Acc: 0.425 Test Loss: 1.726 Test Acc: 0.425
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.3892304
	speed: 0.3679s/iter; left time: 5458.7755s
Epoch: 4 cost time: 22.68989086151123
Epoch: 4, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.178 Vali Acc: 0.513 Test Loss: 2.178 Test Acc: 0.513
Validation loss decreased (-0.490654 --> -0.512955).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4343408
	speed: 0.3717s/iter; left time: 5458.6643s
Epoch: 5 cost time: 22.021411180496216
Epoch: 5, Steps: 154 | Train Loss: 1.535 Vali Loss: 3.588 Vali Acc: 0.448 Test Loss: 3.588 Test Acc: 0.448
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1641154
	speed: 0.3746s/iter; left time: 5442.9423s
Epoch: 6 cost time: 23.365507125854492
Epoch: 6, Steps: 154 | Train Loss: 1.538 Vali Loss: 3.095 Vali Acc: 0.504 Test Loss: 3.095 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0927889
	speed: 0.3433s/iter; left time: 4935.6275s
Epoch: 7 cost time: 21.10704779624939
Epoch: 7, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.971 Vali Acc: 0.510 Test Loss: 2.971 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.5078311
	speed: 0.3435s/iter; left time: 4885.2770s
Epoch: 8 cost time: 20.60168194770813
Epoch: 8, Steps: 154 | Train Loss: 1.546 Vali Loss: 3.088 Vali Acc: 0.449 Test Loss: 3.088 Test Acc: 0.449
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.3296926
	speed: 0.3459s/iter; left time: 4866.8947s
Epoch: 9 cost time: 21.661405324935913
Epoch: 9, Steps: 154 | Train Loss: 1.506 Vali Loss: 3.105 Vali Acc: 0.427 Test Loss: 3.105 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0788155
	speed: 0.3356s/iter; left time: 4669.4869s
Epoch: 10 cost time: 19.83842658996582
Epoch: 10, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.474 Vali Acc: 0.395 Test Loss: 3.474 Test Acc: 0.395
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4907886
	speed: 0.3233s/iter; left time: 4448.6987s
Epoch: 11 cost time: 19.40134334564209
Epoch: 11, Steps: 154 | Train Loss: 1.283 Vali Loss: 4.032 Vali Acc: 0.395 Test Loss: 4.032 Test Acc: 0.395
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.4864268
	speed: 0.3299s/iter; left time: 4489.6020s
Epoch: 12 cost time: 21.125051259994507
Epoch: 12, Steps: 154 | Train Loss: 1.182 Vali Loss: 4.027 Vali Acc: 0.403 Test Loss: 4.027 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.2578464
	speed: 0.3128s/iter; left time: 4207.5023s
Epoch: 13 cost time: 16.772643566131592
Epoch: 13, Steps: 154 | Train Loss: 1.093 Vali Loss: 3.846 Vali Acc: 0.463 Test Loss: 3.846 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7344155
	speed: 0.2863s/iter; left time: 3807.4915s
Epoch: 14 cost time: 15.453686952590942
Epoch: 14, Steps: 154 | Train Loss: 0.951 Vali Loss: 4.484 Vali Acc: 0.399 Test Loss: 4.484 Test Acc: 0.399
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5129764801297648
model parameter : 637006
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.3891631
	speed: 0.1080s/iter; left time: 1652.9415s
Epoch: 1 cost time: 15.90312647819519
Epoch: 1, Steps: 154 | Train Loss: 1.845 Vali Loss: 2.337 Vali Acc: 0.414 Test Loss: 2.337 Test Acc: 0.414
Validation loss decreased (inf --> -0.413602).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8531818
	speed: 0.2682s/iter; left time: 4061.6790s
Epoch: 2 cost time: 15.871858596801758
Epoch: 2, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.121 Vali Acc: 0.495 Test Loss: 2.121 Test Acc: 0.495
Validation loss decreased (-0.413602 --> -0.494707).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3087598
	speed: 0.2581s/iter; left time: 3870.1379s
Epoch: 3 cost time: 14.231161832809448
Epoch: 3, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.013 Vali Acc: 0.461 Test Loss: 2.013 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4760413
	speed: 0.2708s/iter; left time: 4018.8401s
Epoch: 4 cost time: 17.103951930999756
Epoch: 4, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.100 Vali Acc: 0.504 Test Loss: 2.100 Test Acc: 0.504
Validation loss decreased (-0.494707 --> -0.504034).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6233209
	speed: 0.2827s/iter; left time: 4151.8151s
Epoch: 5 cost time: 15.927307844161987
Epoch: 5, Steps: 154 | Train Loss: 1.223 Vali Loss: 2.082 Vali Acc: 0.538 Test Loss: 2.082 Test Acc: 0.538
Validation loss decreased (-0.504034 --> -0.538098).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9831679
	speed: 0.2672s/iter; left time: 3883.0642s
Epoch: 6 cost time: 15.063246965408325
Epoch: 6, Steps: 154 | Train Loss: 1.195 Vali Loss: 2.221 Vali Acc: 0.543 Test Loss: 2.221 Test Acc: 0.543
Validation loss decreased (-0.538098 --> -0.542557).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1904356
	speed: 0.2430s/iter; left time: 3493.8857s
Epoch: 7 cost time: 11.882651567459106
Epoch: 7, Steps: 154 | Train Loss: 1.054 Vali Loss: 2.805 Vali Acc: 0.516 Test Loss: 2.805 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5225117
	speed: 0.2428s/iter; left time: 3453.3328s
Epoch: 8 cost time: 13.526967287063599
Epoch: 8, Steps: 154 | Train Loss: 1.065 Vali Loss: 2.676 Vali Acc: 0.431 Test Loss: 2.676 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9620731
	speed: 0.2741s/iter; left time: 3856.6890s
Epoch: 9 cost time: 18.44948172569275
Epoch: 9, Steps: 154 | Train Loss: 1.009 Vali Loss: 2.725 Vali Acc: 0.412 Test Loss: 2.725 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8866591
	speed: 0.2944s/iter; left time: 4096.6063s
Epoch: 10 cost time: 17.890140771865845
Epoch: 10, Steps: 154 | Train Loss: 0.992 Vali Loss: 3.181 Vali Acc: 0.525 Test Loss: 3.181 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8617364
	speed: 0.2930s/iter; left time: 4031.9012s
Epoch: 11 cost time: 18.09720492362976
Epoch: 11, Steps: 154 | Train Loss: 0.886 Vali Loss: 3.185 Vali Acc: 0.410 Test Loss: 3.185 Test Acc: 0.410
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.8903836
	speed: 0.2970s/iter; left time: 4040.9584s
Epoch: 12 cost time: 18.08328151702881
Epoch: 12, Steps: 154 | Train Loss: 0.824 Vali Loss: 3.405 Vali Acc: 0.487 Test Loss: 3.405 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1259425
	speed: 0.2933s/iter; left time: 3945.6775s
Epoch: 13 cost time: 17.556605100631714
Epoch: 13, Steps: 154 | Train Loss: 0.764 Vali Loss: 3.227 Vali Acc: 0.523 Test Loss: 3.227 Test Acc: 0.523
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1049817
	speed: 0.2887s/iter; left time: 3839.7204s
Epoch: 14 cost time: 17.524254322052002
Epoch: 14, Steps: 154 | Train Loss: 0.739 Vali Loss: 3.770 Vali Acc: 0.441 Test Loss: 3.770 Test Acc: 0.441
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2928873
	speed: 0.2762s/iter; left time: 3630.9917s
Epoch: 15 cost time: 16.698522806167603
Epoch: 15, Steps: 154 | Train Loss: 0.621 Vali Loss: 3.132 Vali Acc: 0.487 Test Loss: 3.132 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.1019081
	speed: 0.2832s/iter; left time: 3678.9681s
Epoch: 16 cost time: 17.29904818534851
Epoch: 16, Steps: 154 | Train Loss: 0.581 Vali Loss: 3.674 Vali Acc: 0.499 Test Loss: 3.674 Test Acc: 0.499
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5425790754257908
model parameter : 443598
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0047965
	speed: 0.1273s/iter; left time: 1947.5853s
Epoch: 1 cost time: 18.68333625793457
Epoch: 1, Steps: 154 | Train Loss: 1.888 Vali Loss: 1.897 Vali Acc: 0.475 Test Loss: 1.897 Test Acc: 0.475
Validation loss decreased (inf --> -0.475245).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1478949
	speed: 0.2885s/iter; left time: 4369.6778s
Epoch: 2 cost time: 17.50446844100952
Epoch: 2, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.726 Vali Acc: 0.336 Test Loss: 2.726 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5657662
	speed: 0.2961s/iter; left time: 4439.8473s
Epoch: 3 cost time: 18.006294012069702
Epoch: 3, Steps: 154 | Train Loss: 1.378 Vali Loss: 1.769 Vali Acc: 0.477 Test Loss: 1.769 Test Acc: 0.477
Validation loss decreased (-0.475245 --> -0.476868).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6064402
	speed: 0.2999s/iter; left time: 4450.4230s
Epoch: 4 cost time: 19.082908630371094
Epoch: 4, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.169 Vali Acc: 0.503 Test Loss: 2.169 Test Acc: 0.503
Validation loss decreased (-0.476868 --> -0.503222).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6030344
	speed: 0.3211s/iter; left time: 4715.0652s
Epoch: 5 cost time: 17.82718777656555
Epoch: 5, Steps: 154 | Train Loss: 1.250 Vali Loss: 1.943 Vali Acc: 0.480 Test Loss: 1.943 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1321379
	speed: 0.2672s/iter; left time: 3883.2864s
Epoch: 6 cost time: 15.23106050491333
Epoch: 6, Steps: 154 | Train Loss: 1.201 Vali Loss: 2.783 Vali Acc: 0.418 Test Loss: 2.783 Test Acc: 0.418
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2110885
	speed: 0.2464s/iter; left time: 3542.8894s
Epoch: 7 cost time: 13.560435771942139
Epoch: 7, Steps: 154 | Train Loss: 1.110 Vali Loss: 2.664 Vali Acc: 0.506 Test Loss: 2.664 Test Acc: 0.506
Validation loss decreased (-0.503222 --> -0.506056).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0280576
	speed: 0.2508s/iter; left time: 3566.5150s
Epoch: 8 cost time: 13.028135299682617
Epoch: 8, Steps: 154 | Train Loss: 1.054 Vali Loss: 2.307 Vali Acc: 0.524 Test Loss: 2.307 Test Acc: 0.524
Validation loss decreased (-0.506056 --> -0.524308).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9634001
	speed: 0.2510s/iter; left time: 3531.8071s
Epoch: 9 cost time: 14.633731842041016
Epoch: 9, Steps: 154 | Train Loss: 1.003 Vali Loss: 3.261 Vali Acc: 0.390 Test Loss: 3.261 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3878421
	speed: 0.2449s/iter; left time: 3407.8193s
Epoch: 10 cost time: 12.480903625488281
Epoch: 10, Steps: 154 | Train Loss: 0.948 Vali Loss: 2.456 Vali Acc: 0.484 Test Loss: 2.456 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6698728
	speed: 0.2366s/iter; left time: 3256.5069s
Epoch: 11 cost time: 12.426737070083618
Epoch: 11, Steps: 154 | Train Loss: 0.820 Vali Loss: 3.056 Vali Acc: 0.511 Test Loss: 3.056 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2205885
	speed: 0.2313s/iter; left time: 3147.1092s
Epoch: 12 cost time: 12.288501024246216
Epoch: 12, Steps: 154 | Train Loss: 0.797 Vali Loss: 3.166 Vali Acc: 0.512 Test Loss: 3.166 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2481883
	speed: 0.2505s/iter; left time: 3370.5913s
Epoch: 13 cost time: 13.749017715454102
Epoch: 13, Steps: 154 | Train Loss: 0.692 Vali Loss: 2.905 Vali Acc: 0.475 Test Loss: 2.905 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.8349295
	speed: 0.2508s/iter; left time: 3334.9360s
Epoch: 14 cost time: 13.80662226676941
Epoch: 14, Steps: 154 | Train Loss: 0.664 Vali Loss: 3.302 Vali Acc: 0.424 Test Loss: 3.302 Test Acc: 0.424
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.5516325
	speed: 0.2446s/iter; left time: 3215.0577s
Epoch: 15 cost time: 12.846266269683838
Epoch: 15, Steps: 154 | Train Loss: 0.640 Vali Loss: 2.849 Vali Acc: 0.566 Test Loss: 2.849 Test Acc: 0.566
Validation loss decreased (-0.524308 --> -0.565665).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.9248663
	speed: 0.2636s/iter; left time: 3424.6766s
Epoch: 16 cost time: 16.756356239318848
Epoch: 16, Steps: 154 | Train Loss: 0.552 Vali Loss: 3.048 Vali Acc: 0.540 Test Loss: 3.048 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6792833
	speed: 0.2818s/iter; left time: 3616.9187s
Epoch: 17 cost time: 16.958357572555542
Epoch: 17, Steps: 154 | Train Loss: 0.593 Vali Loss: 3.292 Vali Acc: 0.526 Test Loss: 3.292 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5647222
	speed: 0.2998s/iter; left time: 3802.3961s
Epoch: 18 cost time: 18.237096309661865
Epoch: 18, Steps: 154 | Train Loss: 0.565 Vali Loss: 3.556 Vali Acc: 0.522 Test Loss: 3.556 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3728245
	speed: 0.2956s/iter; left time: 3703.1971s
Epoch: 19 cost time: 18.238763093948364
Epoch: 19, Steps: 154 | Train Loss: 0.517 Vali Loss: 3.773 Vali Acc: 0.508 Test Loss: 3.773 Test Acc: 0.508
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5936943
	speed: 0.2934s/iter; left time: 3630.5455s
Epoch: 20 cost time: 18.1150004863739
Epoch: 20, Steps: 154 | Train Loss: 0.507 Vali Loss: 3.443 Vali Acc: 0.474 Test Loss: 3.443 Test Acc: 0.474
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2484599
	speed: 0.3018s/iter; left time: 3688.0634s
Epoch: 21 cost time: 19.074302911758423
Epoch: 21, Steps: 154 | Train Loss: 0.444 Vali Loss: 3.740 Vali Acc: 0.501 Test Loss: 3.740 Test Acc: 0.501
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.5748481
	speed: 0.3020s/iter; left time: 3644.7021s
Epoch: 22 cost time: 16.640970945358276
Epoch: 22, Steps: 154 | Train Loss: 0.458 Vali Loss: 3.384 Vali Acc: 0.511 Test Loss: 3.384 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3759658
	speed: 0.3072s/iter; left time: 3659.3938s
Epoch: 23 cost time: 19.897204160690308
Epoch: 23, Steps: 154 | Train Loss: 0.411 Vali Loss: 3.358 Vali Acc: 0.526 Test Loss: 3.358 Test Acc: 0.526
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0461321
	speed: 0.3338s/iter; left time: 3925.0031s
Epoch: 24 cost time: 20.0207736492157
Epoch: 24, Steps: 154 | Train Loss: 0.419 Vali Loss: 3.493 Vali Acc: 0.482 Test Loss: 3.493 Test Acc: 0.482
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0919795
	speed: 0.3194s/iter; left time: 3706.0623s
Epoch: 25 cost time: 19.312859058380127
Epoch: 25, Steps: 154 | Train Loss: 0.377 Vali Loss: 3.596 Vali Acc: 0.516 Test Loss: 3.596 Test Acc: 0.516
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5656934306569343
model parameter : 443726
model size : 4.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1247833
	speed: 0.1315s/iter; left time: 2011.6242s
Epoch: 1 cost time: 18.971158266067505
Epoch: 1, Steps: 154 | Train Loss: 1.921 Vali Loss: 1.736 Vali Acc: 0.471 Test Loss: 1.736 Test Acc: 0.471
Validation loss decreased (inf --> -0.471191).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6423740
	speed: 0.2830s/iter; left time: 4286.9782s
Epoch: 2 cost time: 17.650228261947632
Epoch: 2, Steps: 154 | Train Loss: 1.405 Vali Loss: 2.811 Vali Acc: 0.367 Test Loss: 2.811 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.2175047
	speed: 0.3175s/iter; left time: 4760.7171s
Epoch: 3 cost time: 22.015799045562744
Epoch: 3, Steps: 154 | Train Loss: 1.307 Vali Loss: 2.628 Vali Acc: 0.431 Test Loss: 2.628 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.7825860
	speed: 0.3003s/iter; left time: 4455.6589s
Epoch: 4 cost time: 17.67857551574707
Epoch: 4, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.227 Vali Acc: 0.492 Test Loss: 2.227 Test Acc: 0.492
Validation loss decreased (-0.471191 --> -0.492273).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3766779
	speed: 0.3095s/iter; left time: 4544.9109s
Epoch: 5 cost time: 18.141165733337402
Epoch: 5, Steps: 154 | Train Loss: 1.144 Vali Loss: 2.360 Vali Acc: 0.412 Test Loss: 2.360 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4790001
	speed: 0.2558s/iter; left time: 3717.6800s
Epoch: 6 cost time: 15.546303987503052
Epoch: 6, Steps: 154 | Train Loss: 1.052 Vali Loss: 2.346 Vali Acc: 0.487 Test Loss: 2.346 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6408122
	speed: 0.2894s/iter; left time: 4160.6027s
Epoch: 7 cost time: 17.53865694999695
Epoch: 7, Steps: 154 | Train Loss: 1.000 Vali Loss: 2.470 Vali Acc: 0.483 Test Loss: 2.470 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.9665390
	speed: 0.2784s/iter; left time: 3959.6693s
Epoch: 8 cost time: 15.771935939788818
Epoch: 8, Steps: 154 | Train Loss: 0.914 Vali Loss: 2.066 Vali Acc: 0.538 Test Loss: 2.066 Test Acc: 0.538
Validation loss decreased (-0.492273 --> -0.537692).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9085982
	speed: 0.2548s/iter; left time: 3584.6462s
Epoch: 9 cost time: 13.097628593444824
Epoch: 9, Steps: 154 | Train Loss: 0.849 Vali Loss: 2.490 Vali Acc: 0.504 Test Loss: 2.490 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0550424
	speed: 0.2462s/iter; left time: 3425.3355s
Epoch: 10 cost time: 15.292116641998291
Epoch: 10, Steps: 154 | Train Loss: 0.791 Vali Loss: 2.521 Vali Acc: 0.518 Test Loss: 2.521 Test Acc: 0.518
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.5485652
	speed: 0.2923s/iter; left time: 4022.1869s
Epoch: 11 cost time: 19.19325876235962
Epoch: 11, Steps: 154 | Train Loss: 0.720 Vali Loss: 2.456 Vali Acc: 0.472 Test Loss: 2.456 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.2710426
	speed: 0.2908s/iter; left time: 3957.5813s
Epoch: 12 cost time: 17.3782958984375
Epoch: 12, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.648 Vali Acc: 0.515 Test Loss: 2.648 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2177495
	speed: 0.2986s/iter; left time: 4017.1573s
Epoch: 13 cost time: 18.022019863128662
Epoch: 13, Steps: 154 | Train Loss: 0.635 Vali Loss: 2.834 Vali Acc: 0.532 Test Loss: 2.834 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5850455
	speed: 0.2774s/iter; left time: 3688.6977s
Epoch: 14 cost time: 15.980423212051392
Epoch: 14, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.752 Vali Acc: 0.465 Test Loss: 2.752 Test Acc: 0.465
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3686895
	speed: 0.2987s/iter; left time: 3927.0646s
Epoch: 15 cost time: 19.03446388244629
Epoch: 15, Steps: 154 | Train Loss: 0.579 Vali Loss: 2.914 Vali Acc: 0.486 Test Loss: 2.914 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3787321
	speed: 0.3041s/iter; left time: 3950.2179s
Epoch: 16 cost time: 19.60551929473877
Epoch: 16, Steps: 154 | Train Loss: 0.518 Vali Loss: 2.885 Vali Acc: 0.474 Test Loss: 2.885 Test Acc: 0.474
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.4921085
	speed: 0.3202s/iter; left time: 4110.7142s
Epoch: 17 cost time: 20.184781312942505
Epoch: 17, Steps: 154 | Train Loss: 0.502 Vali Loss: 3.101 Vali Acc: 0.487 Test Loss: 3.101 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.4211823
	speed: 0.3168s/iter; left time: 4018.1061s
Epoch: 18 cost time: 19.151283979415894
Epoch: 18, Steps: 154 | Train Loss: 0.460 Vali Loss: 2.904 Vali Acc: 0.524 Test Loss: 2.904 Test Acc: 0.524
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.537712895377129
model parameter : 379470
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7154237
	speed: 0.0752s/iter; left time: 1150.2837s
Epoch: 1 cost time: 10.716726303100586
Epoch: 1, Steps: 154 | Train Loss: 2.000 Vali Loss: 2.074 Vali Acc: 0.403 Test Loss: 2.074 Test Acc: 0.403
Validation loss decreased (inf --> -0.403467).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1226802
	speed: 0.2031s/iter; left time: 3077.0834s
Epoch: 2 cost time: 9.270488739013672
Epoch: 2, Steps: 154 | Train Loss: 1.404 Vali Loss: 1.857 Vali Acc: 0.468 Test Loss: 1.857 Test Acc: 0.468
Validation loss decreased (-0.403467 --> -0.467946).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0619453
	speed: 0.2001s/iter; left time: 2999.8898s
Epoch: 3 cost time: 8.84930157661438
Epoch: 3, Steps: 154 | Train Loss: 1.291 Vali Loss: 1.976 Vali Acc: 0.494 Test Loss: 1.976 Test Acc: 0.494
Validation loss decreased (-0.467946 --> -0.493492).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4885164
	speed: 0.2029s/iter; left time: 3011.3617s
Epoch: 4 cost time: 8.592890977859497
Epoch: 4, Steps: 154 | Train Loss: 1.219 Vali Loss: 1.952 Vali Acc: 0.476 Test Loss: 1.952 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9834348
	speed: 0.1980s/iter; left time: 2908.1309s
Epoch: 5 cost time: 8.96968150138855
Epoch: 5, Steps: 154 | Train Loss: 1.148 Vali Loss: 1.950 Vali Acc: 0.490 Test Loss: 1.950 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5893102
	speed: 0.2012s/iter; left time: 2924.0978s
Epoch: 6 cost time: 9.53223967552185
Epoch: 6, Steps: 154 | Train Loss: 1.063 Vali Loss: 1.924 Vali Acc: 0.515 Test Loss: 1.924 Test Acc: 0.515
Validation loss decreased (-0.493492 --> -0.514579).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7539217
	speed: 0.1953s/iter; left time: 2808.3476s
Epoch: 7 cost time: 8.453386783599854
Epoch: 7, Steps: 154 | Train Loss: 0.985 Vali Loss: 2.299 Vali Acc: 0.529 Test Loss: 2.299 Test Acc: 0.529
Validation loss decreased (-0.514579 --> -0.528769).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9829335
	speed: 0.1907s/iter; left time: 2712.0710s
Epoch: 8 cost time: 8.854405403137207
Epoch: 8, Steps: 154 | Train Loss: 0.911 Vali Loss: 2.460 Vali Acc: 0.478 Test Loss: 2.460 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7051894
	speed: 0.2114s/iter; left time: 2973.6027s
Epoch: 9 cost time: 9.484506607055664
Epoch: 9, Steps: 154 | Train Loss: 0.838 Vali Loss: 2.429 Vali Acc: 0.459 Test Loss: 2.429 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5838582
	speed: 0.2128s/iter; left time: 2961.7813s
Epoch: 10 cost time: 9.831650495529175
Epoch: 10, Steps: 154 | Train Loss: 0.787 Vali Loss: 2.359 Vali Acc: 0.529 Test Loss: 2.359 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8353539
	speed: 0.2199s/iter; left time: 3026.5866s
Epoch: 11 cost time: 10.107276439666748
Epoch: 11, Steps: 154 | Train Loss: 0.718 Vali Loss: 2.395 Vali Acc: 0.442 Test Loss: 2.395 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.5510194
	speed: 0.2049s/iter; left time: 2788.1237s
Epoch: 12 cost time: 9.167242288589478
Epoch: 12, Steps: 154 | Train Loss: 0.682 Vali Loss: 2.301 Vali Acc: 0.513 Test Loss: 2.301 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9479507
	speed: 0.2008s/iter; left time: 2701.7801s
Epoch: 13 cost time: 9.027364492416382
Epoch: 13, Steps: 154 | Train Loss: 0.659 Vali Loss: 2.392 Vali Acc: 0.523 Test Loss: 2.392 Test Acc: 0.523
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.4162265
	speed: 0.2053s/iter; left time: 2730.6081s
Epoch: 14 cost time: 8.83249568939209
Epoch: 14, Steps: 154 | Train Loss: 0.560 Vali Loss: 2.721 Vali Acc: 0.531 Test Loss: 2.721 Test Acc: 0.531
Validation loss decreased (-0.528769 --> -0.531197).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2842238
	speed: 0.1927s/iter; left time: 2533.6348s
Epoch: 15 cost time: 6.831428527832031
Epoch: 15, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.500 Vali Acc: 0.504 Test Loss: 2.500 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.9787378
	speed: 0.1727s/iter; left time: 2243.5885s
Epoch: 16 cost time: 8.229238510131836
Epoch: 16, Steps: 154 | Train Loss: 0.529 Vali Loss: 2.671 Vali Acc: 0.478 Test Loss: 2.671 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4719928
	speed: 0.1868s/iter; left time: 2398.4586s
Epoch: 17 cost time: 7.996985197067261
Epoch: 17, Steps: 154 | Train Loss: 0.481 Vali Loss: 2.678 Vali Acc: 0.508 Test Loss: 2.678 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5024326
	speed: 0.1833s/iter; left time: 2324.7270s
Epoch: 18 cost time: 7.571252822875977
Epoch: 18, Steps: 154 | Train Loss: 0.461 Vali Loss: 2.701 Vali Acc: 0.493 Test Loss: 2.701 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2686915
	speed: 0.1854s/iter; left time: 2322.3971s
Epoch: 19 cost time: 7.869020462036133
Epoch: 19, Steps: 154 | Train Loss: 0.408 Vali Loss: 2.967 Vali Acc: 0.537 Test Loss: 2.967 Test Acc: 0.537
Validation loss decreased (-0.531197 --> -0.537278).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1669740
	speed: 0.1731s/iter; left time: 2142.3668s
Epoch: 20 cost time: 7.080231189727783
Epoch: 20, Steps: 154 | Train Loss: 0.438 Vali Loss: 3.104 Vali Acc: 0.547 Test Loss: 3.104 Test Acc: 0.547
Validation loss decreased (-0.537278 --> -0.547009).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3910529
	speed: 0.1817s/iter; left time: 2220.7751s
Epoch: 21 cost time: 8.755597114562988
Epoch: 21, Steps: 154 | Train Loss: 0.420 Vali Loss: 2.951 Vali Acc: 0.502 Test Loss: 2.951 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2758205
	speed: 0.1824s/iter; left time: 2200.4777s
Epoch: 22 cost time: 8.062922239303589
Epoch: 22, Steps: 154 | Train Loss: 0.429 Vali Loss: 2.883 Vali Acc: 0.523 Test Loss: 2.883 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5478832
	speed: 0.1884s/iter; left time: 2243.8217s
Epoch: 23 cost time: 8.091734886169434
Epoch: 23, Steps: 154 | Train Loss: 0.392 Vali Loss: 3.723 Vali Acc: 0.489 Test Loss: 3.723 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2898231
	speed: 0.1847s/iter; left time: 2171.9131s
Epoch: 24 cost time: 8.095725536346436
Epoch: 24, Steps: 154 | Train Loss: 0.399 Vali Loss: 3.073 Vali Acc: 0.555 Test Loss: 3.073 Test Acc: 0.555
Validation loss decreased (-0.547009 --> -0.555119).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.2092464
	speed: 0.1842s/iter; left time: 2138.0760s
Epoch: 25 cost time: 7.437844753265381
Epoch: 25, Steps: 154 | Train Loss: 0.366 Vali Loss: 3.112 Vali Acc: 0.543 Test Loss: 3.112 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.5973045
	speed: 0.1724s/iter; left time: 1973.9262s
Epoch: 26 cost time: 7.825731039047241
Epoch: 26, Steps: 154 | Train Loss: 0.359 Vali Loss: 3.356 Vali Acc: 0.544 Test Loss: 3.356 Test Acc: 0.544
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.7610013
	speed: 0.1807s/iter; left time: 2041.7942s
Epoch: 27 cost time: 7.228051662445068
Epoch: 27, Steps: 154 | Train Loss: 0.358 Vali Loss: 3.037 Vali Acc: 0.528 Test Loss: 3.037 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0980835
	speed: 0.1696s/iter; left time: 1889.4468s
Epoch: 28 cost time: 6.701462745666504
Epoch: 28, Steps: 154 | Train Loss: 0.337 Vali Loss: 3.190 Vali Acc: 0.488 Test Loss: 3.190 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.3362472
	speed: 0.1735s/iter; left time: 1906.1052s
Epoch: 29 cost time: 7.06377911567688
Epoch: 29, Steps: 154 | Train Loss: 0.321 Vali Loss: 3.119 Vali Acc: 0.528 Test Loss: 3.119 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0559212
	speed: 0.1773s/iter; left time: 1920.5293s
Epoch: 30 cost time: 8.316004991531372
Epoch: 30, Steps: 154 | Train Loss: 0.318 Vali Loss: 3.271 Vali Acc: 0.517 Test Loss: 3.271 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.4166789
	speed: 0.1836s/iter; left time: 1961.4225s
Epoch: 31 cost time: 8.181303977966309
Epoch: 31, Steps: 154 | Train Loss: 0.335 Vali Loss: 3.152 Vali Acc: 0.521 Test Loss: 3.152 Test Acc: 0.521
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.5440691
	speed: 0.1838s/iter; left time: 1934.5649s
Epoch: 32 cost time: 7.790414810180664
Epoch: 32, Steps: 154 | Train Loss: 0.300 Vali Loss: 3.262 Vali Acc: 0.541 Test Loss: 3.262 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.1297854
	speed: 0.1833s/iter; left time: 1901.6994s
Epoch: 33 cost time: 8.16898250579834
Epoch: 33, Steps: 154 | Train Loss: 0.325 Vali Loss: 3.360 Vali Acc: 0.542 Test Loss: 3.360 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.3414216
	speed: 0.1859s/iter; left time: 1900.0271s
Epoch: 34 cost time: 8.20442795753479
Epoch: 34, Steps: 154 | Train Loss: 0.290 Vali Loss: 3.415 Vali Acc: 0.531 Test Loss: 3.415 Test Acc: 0.531
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5551500405515004
model parameter : 347470
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7905564
	speed: 0.0653s/iter; left time: 999.4352s
Epoch: 1 cost time: 9.230221509933472
Epoch: 1, Steps: 154 | Train Loss: 2.054 Vali Loss: 1.782 Vali Acc: 0.427 Test Loss: 1.782 Test Acc: 0.427
Validation loss decreased (inf --> -0.426584).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8571403
	speed: 0.1805s/iter; left time: 2733.8189s
Epoch: 2 cost time: 7.639531135559082
Epoch: 2, Steps: 154 | Train Loss: 1.386 Vali Loss: 1.865 Vali Acc: 0.485 Test Loss: 1.865 Test Acc: 0.485
Validation loss decreased (-0.426584 --> -0.484977).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1912140
	speed: 0.1788s/iter; left time: 2681.1735s
Epoch: 3 cost time: 7.884246110916138
Epoch: 3, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.578 Vali Acc: 0.437 Test Loss: 2.578 Test Acc: 0.437
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8050067
	speed: 0.1797s/iter; left time: 2666.8316s
Epoch: 4 cost time: 8.104623794555664
Epoch: 4, Steps: 154 | Train Loss: 1.199 Vali Loss: 2.013 Vali Acc: 0.473 Test Loss: 2.013 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.5183668
	speed: 0.1769s/iter; left time: 2598.2694s
Epoch: 5 cost time: 7.680903911590576
Epoch: 5, Steps: 154 | Train Loss: 1.112 Vali Loss: 1.741 Vali Acc: 0.493 Test Loss: 1.741 Test Acc: 0.493
Validation loss decreased (-0.484977 --> -0.493089).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1037588
	speed: 0.1785s/iter; left time: 2594.0173s
Epoch: 6 cost time: 7.747667551040649
Epoch: 6, Steps: 154 | Train Loss: 1.065 Vali Loss: 1.840 Vali Acc: 0.534 Test Loss: 1.840 Test Acc: 0.534
Validation loss decreased (-0.493089 --> -0.534450).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1204034
	speed: 0.1796s/iter; left time: 2582.2169s
Epoch: 7 cost time: 7.614732980728149
Epoch: 7, Steps: 154 | Train Loss: 1.019 Vali Loss: 1.975 Vali Acc: 0.509 Test Loss: 1.975 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9410568
	speed: 0.1825s/iter; left time: 2595.7342s
Epoch: 8 cost time: 8.283248901367188
Epoch: 8, Steps: 154 | Train Loss: 0.912 Vali Loss: 2.353 Vali Acc: 0.508 Test Loss: 2.353 Test Acc: 0.508
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9497898
	speed: 0.1779s/iter; left time: 2502.9186s
Epoch: 9 cost time: 7.935133695602417
Epoch: 9, Steps: 154 | Train Loss: 0.865 Vali Loss: 2.135 Vali Acc: 0.524 Test Loss: 2.135 Test Acc: 0.524
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.9261006
	speed: 0.1769s/iter; left time: 2460.8787s
Epoch: 10 cost time: 7.898679494857788
Epoch: 10, Steps: 154 | Train Loss: 0.781 Vali Loss: 2.225 Vali Acc: 0.542 Test Loss: 2.225 Test Acc: 0.542
Validation loss decreased (-0.534450 --> -0.541746).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2652236
	speed: 0.2095s/iter; left time: 2883.5263s
Epoch: 11 cost time: 10.017260074615479
Epoch: 11, Steps: 154 | Train Loss: 0.729 Vali Loss: 2.159 Vali Acc: 0.531 Test Loss: 2.159 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6900740
	speed: 0.2254s/iter; left time: 3066.7992s
Epoch: 12 cost time: 10.399116277694702
Epoch: 12, Steps: 154 | Train Loss: 0.654 Vali Loss: 2.194 Vali Acc: 0.517 Test Loss: 2.194 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6243215
	speed: 0.2389s/iter; left time: 3213.4240s
Epoch: 13 cost time: 11.592856407165527
Epoch: 13, Steps: 154 | Train Loss: 0.580 Vali Loss: 2.866 Vali Acc: 0.486 Test Loss: 2.866 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4695000
	speed: 0.2362s/iter; left time: 3141.6087s
Epoch: 14 cost time: 10.612021207809448
Epoch: 14, Steps: 154 | Train Loss: 0.563 Vali Loss: 2.297 Vali Acc: 0.543 Test Loss: 2.297 Test Acc: 0.543
Validation loss decreased (-0.541746 --> -0.542556).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0005119
	speed: 0.2251s/iter; left time: 2959.5248s
Epoch: 15 cost time: 9.861801147460938
Epoch: 15, Steps: 154 | Train Loss: 0.539 Vali Loss: 2.576 Vali Acc: 0.519 Test Loss: 2.576 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7247698
	speed: 0.2227s/iter; left time: 2892.8018s
Epoch: 16 cost time: 11.084474325180054
Epoch: 16, Steps: 154 | Train Loss: 0.515 Vali Loss: 2.685 Vali Acc: 0.515 Test Loss: 2.685 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6850487
	speed: 0.2135s/iter; left time: 2740.9145s
Epoch: 17 cost time: 9.189362049102783
Epoch: 17, Steps: 154 | Train Loss: 0.482 Vali Loss: 2.452 Vali Acc: 0.515 Test Loss: 2.452 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7581685
	speed: 0.2122s/iter; left time: 2691.0703s
Epoch: 18 cost time: 9.961824655532837
Epoch: 18, Steps: 154 | Train Loss: 0.424 Vali Loss: 2.937 Vali Acc: 0.467 Test Loss: 2.937 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6458371
	speed: 0.1955s/iter; left time: 2449.9531s
Epoch: 19 cost time: 8.672390460968018
Epoch: 19, Steps: 154 | Train Loss: 0.443 Vali Loss: 2.596 Vali Acc: 0.500 Test Loss: 2.596 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1789612
	speed: 0.2196s/iter; left time: 2717.9293s
Epoch: 20 cost time: 10.21797227859497
Epoch: 20, Steps: 154 | Train Loss: 0.424 Vali Loss: 2.863 Vali Acc: 0.495 Test Loss: 2.863 Test Acc: 0.495
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.4115878
	speed: 0.2140s/iter; left time: 2615.3734s
Epoch: 21 cost time: 9.138363599777222
Epoch: 21, Steps: 154 | Train Loss: 0.420 Vali Loss: 2.741 Vali Acc: 0.488 Test Loss: 2.741 Test Acc: 0.488
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2615308
	speed: 0.2071s/iter; left time: 2499.1712s
Epoch: 22 cost time: 9.012233257293701
Epoch: 22, Steps: 154 | Train Loss: 0.411 Vali Loss: 2.656 Vali Acc: 0.509 Test Loss: 2.656 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3036935
	speed: 0.2070s/iter; left time: 2466.4782s
Epoch: 23 cost time: 8.99968695640564
Epoch: 23, Steps: 154 | Train Loss: 0.357 Vali Loss: 2.752 Vali Acc: 0.502 Test Loss: 2.752 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.4521012
	speed: 0.1977s/iter; left time: 2324.6953s
Epoch: 24 cost time: 8.607982635498047
Epoch: 24, Steps: 154 | Train Loss: 0.394 Vali Loss: 3.076 Vali Acc: 0.517 Test Loss: 3.076 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm128_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5425790754257908
model parameter : 326094
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4473708
	speed: 0.1443s/iter; left time: 2207.4362s
Epoch: 1 cost time: 22.04483652114868
Epoch: 1, Steps: 154 | Train Loss: 1.946 Vali Loss: 1.723 Vali Acc: 0.498 Test Loss: 1.723 Test Acc: 0.498
Validation loss decreased (inf --> -0.497955).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5880057
	speed: 0.3240s/iter; left time: 4906.9951s
Epoch: 2 cost time: 18.16771388053894
Epoch: 2, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.039 Vali Acc: 0.470 Test Loss: 2.039 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8678563
	speed: 0.3452s/iter; left time: 5174.9117s
Epoch: 3 cost time: 22.95888614654541
Epoch: 3, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.065 Vali Acc: 0.514 Test Loss: 2.065 Test Acc: 0.514
Validation loss decreased (-0.497955 --> -0.513767).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8639748
	speed: 0.3434s/iter; left time: 5096.3511s
Epoch: 4 cost time: 22.14694857597351
Epoch: 4, Steps: 154 | Train Loss: 1.236 Vali Loss: 2.163 Vali Acc: 0.412 Test Loss: 2.163 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4467024
	speed: 0.3711s/iter; left time: 5450.1689s
Epoch: 5 cost time: 23.606175184249878
Epoch: 5, Steps: 154 | Train Loss: 1.152 Vali Loss: 2.443 Vali Acc: 0.472 Test Loss: 2.443 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.2705390
	speed: 0.3949s/iter; left time: 5738.4120s
Epoch: 6 cost time: 25.203049898147583
Epoch: 6, Steps: 154 | Train Loss: 1.088 Vali Loss: 2.285 Vali Acc: 0.411 Test Loss: 2.285 Test Acc: 0.411
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.5132675
	speed: 0.3723s/iter; left time: 5353.2389s
Epoch: 7 cost time: 23.978668928146362
Epoch: 7, Steps: 154 | Train Loss: 0.991 Vali Loss: 2.629 Vali Acc: 0.503 Test Loss: 2.629 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.1201792
	speed: 0.3494s/iter; left time: 4969.6568s
Epoch: 8 cost time: 20.462132453918457
Epoch: 8, Steps: 154 | Train Loss: 0.907 Vali Loss: 2.563 Vali Acc: 0.502 Test Loss: 2.563 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6980326
	speed: 0.3567s/iter; left time: 5018.7938s
Epoch: 9 cost time: 23.120383262634277
Epoch: 9, Steps: 154 | Train Loss: 0.824 Vali Loss: 2.656 Vali Acc: 0.489 Test Loss: 2.656 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.5303782
	speed: 0.3758s/iter; left time: 5229.8864s
Epoch: 10 cost time: 25.428657054901123
Epoch: 10, Steps: 154 | Train Loss: 0.726 Vali Loss: 2.986 Vali Acc: 0.479 Test Loss: 2.986 Test Acc: 0.479
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.8124469
	speed: 0.3681s/iter; left time: 5065.4651s
Epoch: 11 cost time: 23.412041425704956
Epoch: 11, Steps: 154 | Train Loss: 0.683 Vali Loss: 3.279 Vali Acc: 0.419 Test Loss: 3.279 Test Acc: 0.419
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.5011001
	speed: 0.3760s/iter; left time: 5115.8431s
Epoch: 12 cost time: 22.634707927703857
Epoch: 12, Steps: 154 | Train Loss: 0.627 Vali Loss: 3.172 Vali Acc: 0.481 Test Loss: 3.172 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.4363627
	speed: 0.4138s/iter; left time: 5567.4066s
Epoch: 13 cost time: 29.313374042510986
Epoch: 13, Steps: 154 | Train Loss: 0.534 Vali Loss: 3.567 Vali Acc: 0.468 Test Loss: 3.567 Test Acc: 0.468
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.513787510137875
model parameter : 343758
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8729885
	speed: 0.0891s/iter; left time: 1363.1576s
Epoch: 1 cost time: 12.809688329696655
Epoch: 1, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.003 Vali Acc: 0.435 Test Loss: 2.003 Test Acc: 0.435
Validation loss decreased (inf --> -0.435098).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2773951
	speed: 0.2344s/iter; left time: 3550.6304s
Epoch: 2 cost time: 11.194045543670654
Epoch: 2, Steps: 154 | Train Loss: 1.360 Vali Loss: 1.789 Vali Acc: 0.473 Test Loss: 1.789 Test Acc: 0.473
Validation loss decreased (-0.435098 --> -0.472813).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0417382
	speed: 0.2369s/iter; left time: 3551.3225s
Epoch: 3 cost time: 11.936728954315186
Epoch: 3, Steps: 154 | Train Loss: 1.232 Vali Loss: 2.319 Vali Acc: 0.460 Test Loss: 2.319 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1227000
	speed: 0.2438s/iter; left time: 3617.9309s
Epoch: 4 cost time: 10.962247371673584
Epoch: 4, Steps: 154 | Train Loss: 1.145 Vali Loss: 1.792 Vali Acc: 0.530 Test Loss: 1.792 Test Acc: 0.530
Validation loss decreased (-0.472813 --> -0.530396).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7003535
	speed: 0.2138s/iter; left time: 3140.1585s
Epoch: 5 cost time: 11.071201801300049
Epoch: 5, Steps: 154 | Train Loss: 1.076 Vali Loss: 2.240 Vali Acc: 0.384 Test Loss: 2.240 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4069097
	speed: 0.2320s/iter; left time: 3370.8045s
Epoch: 6 cost time: 10.676341772079468
Epoch: 6, Steps: 154 | Train Loss: 0.991 Vali Loss: 1.964 Vali Acc: 0.459 Test Loss: 1.964 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8419871
	speed: 0.2308s/iter; left time: 3317.9313s
Epoch: 7 cost time: 10.577535390853882
Epoch: 7, Steps: 154 | Train Loss: 0.897 Vali Loss: 2.336 Vali Acc: 0.464 Test Loss: 2.336 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2201163
	speed: 0.2303s/iter; left time: 3275.0898s
Epoch: 8 cost time: 11.652032613754272
Epoch: 8, Steps: 154 | Train Loss: 0.840 Vali Loss: 2.136 Vali Acc: 0.506 Test Loss: 2.136 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6309354
	speed: 0.2280s/iter; left time: 3207.3543s
Epoch: 9 cost time: 9.500682592391968
Epoch: 9, Steps: 154 | Train Loss: 0.724 Vali Loss: 2.110 Vali Acc: 0.535 Test Loss: 2.110 Test Acc: 0.535
Validation loss decreased (-0.530396 --> -0.535259).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5747500
	speed: 0.2050s/iter; left time: 2852.9742s
Epoch: 10 cost time: 8.905500173568726
Epoch: 10, Steps: 154 | Train Loss: 0.640 Vali Loss: 2.366 Vali Acc: 0.460 Test Loss: 2.366 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3510871
	speed: 0.2145s/iter; left time: 2951.5105s
Epoch: 11 cost time: 10.273132801055908
Epoch: 11, Steps: 154 | Train Loss: 0.604 Vali Loss: 2.332 Vali Acc: 0.470 Test Loss: 2.332 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3929061
	speed: 0.2118s/iter; left time: 2881.4602s
Epoch: 12 cost time: 9.362069606781006
Epoch: 12, Steps: 154 | Train Loss: 0.551 Vali Loss: 2.686 Vali Acc: 0.451 Test Loss: 2.686 Test Acc: 0.451
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4989759
	speed: 0.2186s/iter; left time: 2940.9554s
Epoch: 13 cost time: 10.83587908744812
Epoch: 13, Steps: 154 | Train Loss: 0.521 Vali Loss: 2.643 Vali Acc: 0.487 Test Loss: 2.643 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3915409
	speed: 0.2176s/iter; left time: 2894.3600s
Epoch: 14 cost time: 8.98580288887024
Epoch: 14, Steps: 154 | Train Loss: 0.483 Vali Loss: 2.555 Vali Acc: 0.481 Test Loss: 2.555 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2986821
	speed: 0.2132s/iter; left time: 2803.1230s
Epoch: 15 cost time: 10.828197002410889
Epoch: 15, Steps: 154 | Train Loss: 0.439 Vali Loss: 3.135 Vali Acc: 0.503 Test Loss: 3.135 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.2916324
	speed: 0.2155s/iter; left time: 2799.0070s
Epoch: 16 cost time: 9.803650856018066
Epoch: 16, Steps: 154 | Train Loss: 0.385 Vali Loss: 2.694 Vali Acc: 0.511 Test Loss: 2.694 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8064534
	speed: 0.2052s/iter; left time: 2634.0263s
Epoch: 17 cost time: 9.15137505531311
Epoch: 17, Steps: 154 | Train Loss: 0.348 Vali Loss: 2.849 Vali Acc: 0.521 Test Loss: 2.849 Test Acc: 0.521
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5093701
	speed: 0.1919s/iter; left time: 2433.6411s
Epoch: 18 cost time: 7.928414344787598
Epoch: 18, Steps: 154 | Train Loss: 0.332 Vali Loss: 3.233 Vali Acc: 0.492 Test Loss: 3.233 Test Acc: 0.492
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.3491052
	speed: 0.1798s/iter; left time: 2252.1982s
Epoch: 19 cost time: 7.99835467338562
Epoch: 19, Steps: 154 | Train Loss: 0.306 Vali Loss: 3.243 Vali Acc: 0.498 Test Loss: 3.243 Test Acc: 0.498
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5352798053527981
model parameter : 247054
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9431274
	speed: 0.0673s/iter; left time: 1029.5230s
Epoch: 1 cost time: 9.350559711456299
Epoch: 1, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.113 Vali Acc: 0.429 Test Loss: 2.113 Test Acc: 0.429
Validation loss decreased (inf --> -0.429419).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7052982
	speed: 0.1885s/iter; left time: 2855.8002s
Epoch: 2 cost time: 8.539753198623657
Epoch: 2, Steps: 154 | Train Loss: 1.398 Vali Loss: 1.765 Vali Acc: 0.479 Test Loss: 1.765 Test Acc: 0.479
Validation loss decreased (-0.429419 --> -0.478490).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2038289
	speed: 0.1773s/iter; left time: 2658.9171s
Epoch: 3 cost time: 8.006171226501465
Epoch: 3, Steps: 154 | Train Loss: 1.269 Vali Loss: 1.719 Vali Acc: 0.513 Test Loss: 1.719 Test Acc: 0.513
Validation loss decreased (-0.478490 --> -0.513365).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3951185
	speed: 0.1858s/iter; left time: 2757.1383s
Epoch: 4 cost time: 8.309932708740234
Epoch: 4, Steps: 154 | Train Loss: 1.166 Vali Loss: 1.910 Vali Acc: 0.477 Test Loss: 1.910 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9747137
	speed: 0.1979s/iter; left time: 2906.6746s
Epoch: 5 cost time: 9.11757516860962
Epoch: 5, Steps: 154 | Train Loss: 1.050 Vali Loss: 2.018 Vali Acc: 0.480 Test Loss: 2.018 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1116151
	speed: 0.1994s/iter; left time: 2897.6730s
Epoch: 6 cost time: 9.145701169967651
Epoch: 6, Steps: 154 | Train Loss: 1.002 Vali Loss: 2.171 Vali Acc: 0.457 Test Loss: 2.171 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4819672
	speed: 0.2001s/iter; left time: 2877.1572s
Epoch: 7 cost time: 9.033652782440186
Epoch: 7, Steps: 154 | Train Loss: 0.917 Vali Loss: 2.170 Vali Acc: 0.507 Test Loss: 2.170 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7008903
	speed: 0.1938s/iter; left time: 2757.0286s
Epoch: 8 cost time: 9.020859003067017
Epoch: 8, Steps: 154 | Train Loss: 0.799 Vali Loss: 2.894 Vali Acc: 0.455 Test Loss: 2.894 Test Acc: 0.455
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.0024242
	speed: 0.2099s/iter; left time: 2952.5319s
Epoch: 9 cost time: 9.912520170211792
Epoch: 9, Steps: 154 | Train Loss: 0.755 Vali Loss: 2.230 Vali Acc: 0.496 Test Loss: 2.230 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.0534493
	speed: 0.2174s/iter; left time: 3025.6224s
Epoch: 10 cost time: 10.125693559646606
Epoch: 10, Steps: 154 | Train Loss: 0.624 Vali Loss: 2.230 Vali Acc: 0.507 Test Loss: 2.230 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.0730988
	speed: 0.2269s/iter; left time: 3121.8224s
Epoch: 11 cost time: 10.607923984527588
Epoch: 11, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.379 Vali Acc: 0.511 Test Loss: 2.379 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.4741936
	speed: 0.2197s/iter; left time: 2989.6378s
Epoch: 12 cost time: 9.783060312271118
Epoch: 12, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.491 Vali Acc: 0.483 Test Loss: 2.491 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6987010
	speed: 0.2303s/iter; left time: 3097.7300s
Epoch: 13 cost time: 11.158308506011963
Epoch: 13, Steps: 154 | Train Loss: 0.508 Vali Loss: 2.548 Vali Acc: 0.524 Test Loss: 2.548 Test Acc: 0.524
Validation loss decreased (-0.513365 --> -0.523900).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5645939
	speed: 0.2098s/iter; left time: 2790.3230s
Epoch: 14 cost time: 9.325644969940186
Epoch: 14, Steps: 154 | Train Loss: 0.451 Vali Loss: 2.533 Vali Acc: 0.520 Test Loss: 2.533 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5907221
	speed: 0.2122s/iter; left time: 2789.7798s
Epoch: 15 cost time: 10.103997707366943
Epoch: 15, Steps: 154 | Train Loss: 0.392 Vali Loss: 2.664 Vali Acc: 0.517 Test Loss: 2.664 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3654585
	speed: 0.2154s/iter; left time: 2797.7933s
Epoch: 16 cost time: 10.28616714477539
Epoch: 16, Steps: 154 | Train Loss: 0.370 Vali Loss: 2.778 Vali Acc: 0.527 Test Loss: 2.778 Test Acc: 0.527
Validation loss decreased (-0.523900 --> -0.527142).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1530583
	speed: 0.2087s/iter; left time: 2678.9704s
Epoch: 17 cost time: 9.978019714355469
Epoch: 17, Steps: 154 | Train Loss: 0.336 Vali Loss: 2.846 Vali Acc: 0.535 Test Loss: 2.846 Test Acc: 0.535
Validation loss decreased (-0.527142 --> -0.535251).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2132141
	speed: 0.2136s/iter; left time: 2708.8537s
Epoch: 18 cost time: 9.547199726104736
Epoch: 18, Steps: 154 | Train Loss: 0.324 Vali Loss: 3.130 Vali Acc: 0.515 Test Loss: 3.130 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6364247
	speed: 0.1933s/iter; left time: 2422.4776s
Epoch: 19 cost time: 9.737661838531494
Epoch: 19, Steps: 154 | Train Loss: 0.273 Vali Loss: 3.141 Vali Acc: 0.545 Test Loss: 3.141 Test Acc: 0.545
Validation loss decreased (-0.535251 --> -0.544575).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4242957
	speed: 0.2159s/iter; left time: 2672.1429s
Epoch: 20 cost time: 9.766954183578491
Epoch: 20, Steps: 154 | Train Loss: 0.274 Vali Loss: 3.017 Vali Acc: 0.555 Test Loss: 3.017 Test Acc: 0.555
Validation loss decreased (-0.544575 --> -0.555120).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2566539
	speed: 0.2105s/iter; left time: 2573.1036s
Epoch: 21 cost time: 9.869284629821777
Epoch: 21, Steps: 154 | Train Loss: 0.235 Vali Loss: 3.050 Vali Acc: 0.545 Test Loss: 3.050 Test Acc: 0.545
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1801119
	speed: 0.2087s/iter; left time: 2518.5106s
Epoch: 22 cost time: 10.010357856750488
Epoch: 22, Steps: 154 | Train Loss: 0.235 Vali Loss: 3.509 Vali Acc: 0.556 Test Loss: 3.509 Test Acc: 0.556
Validation loss decreased (-0.555120 --> -0.555926).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0635329
	speed: 0.1992s/iter; left time: 2372.7260s
Epoch: 23 cost time: 8.72556209564209
Epoch: 23, Steps: 154 | Train Loss: 0.235 Vali Loss: 3.093 Vali Acc: 0.546 Test Loss: 3.093 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.2227174
	speed: 0.2000s/iter; left time: 2351.2131s
Epoch: 24 cost time: 9.728484153747559
Epoch: 24, Steps: 154 | Train Loss: 0.219 Vali Loss: 3.545 Vali Acc: 0.513 Test Loss: 3.545 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.5930818
	speed: 0.1994s/iter; left time: 2313.7381s
Epoch: 25 cost time: 8.820952415466309
Epoch: 25, Steps: 154 | Train Loss: 0.185 Vali Loss: 3.540 Vali Acc: 0.541 Test Loss: 3.540 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1464914
	speed: 0.1969s/iter; left time: 2254.5139s
Epoch: 26 cost time: 9.551470518112183
Epoch: 26, Steps: 154 | Train Loss: 0.193 Vali Loss: 3.417 Vali Acc: 0.524 Test Loss: 3.417 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.1966968
	speed: 0.2033s/iter; left time: 2297.2323s
Epoch: 27 cost time: 9.319430828094482
Epoch: 27, Steps: 154 | Train Loss: 0.151 Vali Loss: 3.679 Vali Acc: 0.522 Test Loss: 3.679 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.2871267
	speed: 0.1908s/iter; left time: 2125.8360s
Epoch: 28 cost time: 8.164341688156128
Epoch: 28, Steps: 154 | Train Loss: 0.197 Vali Loss: 3.738 Vali Acc: 0.513 Test Loss: 3.738 Test Acc: 0.513
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.1108451
	speed: 0.1781s/iter; left time: 1956.8707s
Epoch: 29 cost time: 8.35081958770752
Epoch: 29, Steps: 154 | Train Loss: 0.159 Vali Loss: 3.818 Vali Acc: 0.500 Test Loss: 3.818 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0864740
	speed: 0.1820s/iter; left time: 1971.4826s
Epoch: 30 cost time: 7.5033118724823
Epoch: 30, Steps: 154 | Train Loss: 0.170 Vali Loss: 3.946 Vali Acc: 0.492 Test Loss: 3.946 Test Acc: 0.492
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0627164
	speed: 0.1745s/iter; left time: 1863.3210s
Epoch: 31 cost time: 8.267788171768188
Epoch: 31, Steps: 154 | Train Loss: 0.149 Vali Loss: 4.194 Vali Acc: 0.511 Test Loss: 4.194 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.2641659
	speed: 0.1823s/iter; left time: 1918.6059s
Epoch: 32 cost time: 8.610541343688965
Epoch: 32, Steps: 154 | Train Loss: 0.172 Vali Loss: 4.235 Vali Acc: 0.487 Test Loss: 4.235 Test Acc: 0.487
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5559610705596107
model parameter : 247118
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4659657
	speed: 0.0668s/iter; left time: 1021.5071s
Epoch: 1 cost time: 9.389908790588379
Epoch: 1, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.137 Vali Acc: 0.393 Test Loss: 2.137 Test Acc: 0.393
Validation loss decreased (inf --> -0.392923).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4114721
	speed: 0.1718s/iter; left time: 2602.0438s
Epoch: 2 cost time: 7.053982496261597
Epoch: 2, Steps: 154 | Train Loss: 1.364 Vali Loss: 1.563 Vali Acc: 0.496 Test Loss: 1.563 Test Acc: 0.496
Validation loss decreased (-0.392923 --> -0.496335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3645808
	speed: 0.1759s/iter; left time: 2637.1157s
Epoch: 3 cost time: 8.817792177200317
Epoch: 3, Steps: 154 | Train Loss: 1.256 Vali Loss: 2.125 Vali Acc: 0.470 Test Loss: 2.125 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7432871
	speed: 0.2116s/iter; left time: 3140.5490s
Epoch: 4 cost time: 9.53549075126648
Epoch: 4, Steps: 154 | Train Loss: 1.163 Vali Loss: 1.799 Vali Acc: 0.480 Test Loss: 1.799 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.1074982
	speed: 0.1999s/iter; left time: 2936.0154s
Epoch: 5 cost time: 8.582037687301636
Epoch: 5, Steps: 154 | Train Loss: 1.055 Vali Loss: 1.860 Vali Acc: 0.486 Test Loss: 1.860 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.8866320
	speed: 0.2093s/iter; left time: 3041.5392s
Epoch: 6 cost time: 9.9461190700531
Epoch: 6, Steps: 154 | Train Loss: 1.026 Vali Loss: 1.821 Vali Acc: 0.518 Test Loss: 1.821 Test Acc: 0.518
Validation loss decreased (-0.496335 --> -0.517824).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4334643
	speed: 0.2066s/iter; left time: 2970.9162s
Epoch: 7 cost time: 9.297586441040039
Epoch: 7, Steps: 154 | Train Loss: 0.906 Vali Loss: 1.909 Vali Acc: 0.521 Test Loss: 1.909 Test Acc: 0.521
Validation loss decreased (-0.517824 --> -0.521068).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8607455
	speed: 0.2169s/iter; left time: 3085.5721s
Epoch: 8 cost time: 10.49846363067627
Epoch: 8, Steps: 154 | Train Loss: 0.843 Vali Loss: 1.846 Vali Acc: 0.539 Test Loss: 1.846 Test Acc: 0.539
Validation loss decreased (-0.521068 --> -0.539316).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1870657
	speed: 0.2277s/iter; left time: 3203.2290s
Epoch: 9 cost time: 10.229408740997314
Epoch: 9, Steps: 154 | Train Loss: 0.753 Vali Loss: 2.003 Vali Acc: 0.507 Test Loss: 2.003 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9729443
	speed: 0.2119s/iter; left time: 2948.9021s
Epoch: 10 cost time: 9.91325306892395
Epoch: 10, Steps: 154 | Train Loss: 0.694 Vali Loss: 2.066 Vali Acc: 0.528 Test Loss: 2.066 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.5541548
	speed: 0.2296s/iter; left time: 3159.3266s
Epoch: 11 cost time: 9.828277111053467
Epoch: 11, Steps: 154 | Train Loss: 0.646 Vali Loss: 2.067 Vali Acc: 0.522 Test Loss: 2.067 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8914443
	speed: 0.2188s/iter; left time: 2977.2112s
Epoch: 12 cost time: 10.56069040298462
Epoch: 12, Steps: 154 | Train Loss: 0.556 Vali Loss: 2.206 Vali Acc: 0.500 Test Loss: 2.206 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.8241115
	speed: 0.2247s/iter; left time: 3022.5239s
Epoch: 13 cost time: 9.709274530410767
Epoch: 13, Steps: 154 | Train Loss: 0.511 Vali Loss: 2.398 Vali Acc: 0.448 Test Loss: 2.398 Test Acc: 0.448
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.1832193
	speed: 0.2181s/iter; left time: 2899.8697s
Epoch: 14 cost time: 10.255362749099731
Epoch: 14, Steps: 154 | Train Loss: 0.466 Vali Loss: 2.488 Vali Acc: 0.524 Test Loss: 2.488 Test Acc: 0.524
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6591408
	speed: 0.2177s/iter; left time: 2861.0853s
Epoch: 15 cost time: 9.498839378356934
Epoch: 15, Steps: 154 | Train Loss: 0.454 Vali Loss: 2.684 Vali Acc: 0.472 Test Loss: 2.684 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2889333
	speed: 0.2173s/iter; left time: 2822.8574s
Epoch: 16 cost time: 10.345348834991455
Epoch: 16, Steps: 154 | Train Loss: 0.424 Vali Loss: 2.645 Vali Acc: 0.538 Test Loss: 2.645 Test Acc: 0.538
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2036451
	speed: 0.2233s/iter; left time: 2865.9041s
Epoch: 17 cost time: 10.900949954986572
Epoch: 17, Steps: 154 | Train Loss: 0.390 Vali Loss: 2.488 Vali Acc: 0.512 Test Loss: 2.488 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.4470264
	speed: 0.2295s/iter; left time: 2910.3276s
Epoch: 18 cost time: 10.120880126953125
Epoch: 18, Steps: 154 | Train Loss: 0.347 Vali Loss: 2.933 Vali Acc: 0.473 Test Loss: 2.933 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5393349553933495
model parameter : 214990
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2775712
	speed: 0.0811s/iter; left time: 1241.4807s
Epoch: 1 cost time: 11.525905847549438
Epoch: 1, Steps: 154 | Train Loss: 2.095 Vali Loss: 1.936 Vali Acc: 0.406 Test Loss: 1.936 Test Acc: 0.406
Validation loss decreased (inf --> -0.405901).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2367547
	speed: 0.2056s/iter; left time: 3114.5391s
Epoch: 2 cost time: 9.52789044380188
Epoch: 2, Steps: 154 | Train Loss: 1.431 Vali Loss: 1.676 Vali Acc: 0.526 Test Loss: 1.676 Test Acc: 0.526
Validation loss decreased (-0.405901 --> -0.525531).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2986817
	speed: 0.2192s/iter; left time: 3286.4437s
Epoch: 3 cost time: 10.830010652542114
Epoch: 3, Steps: 154 | Train Loss: 1.221 Vali Loss: 2.309 Vali Acc: 0.451 Test Loss: 2.309 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7486667
	speed: 0.2253s/iter; left time: 3342.5164s
Epoch: 4 cost time: 10.070282936096191
Epoch: 4, Steps: 154 | Train Loss: 1.170 Vali Loss: 1.802 Vali Acc: 0.498 Test Loss: 1.802 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.1631110
	speed: 0.2066s/iter; left time: 3033.2215s
Epoch: 5 cost time: 9.567182779312134
Epoch: 5, Steps: 154 | Train Loss: 1.091 Vali Loss: 1.870 Vali Acc: 0.540 Test Loss: 1.870 Test Acc: 0.540
Validation loss decreased (-0.525531 --> -0.539722).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2674868
	speed: 0.2246s/iter; left time: 3264.3001s
Epoch: 6 cost time: 10.532686233520508
Epoch: 6, Steps: 154 | Train Loss: 1.002 Vali Loss: 2.000 Vali Acc: 0.501 Test Loss: 2.000 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5383981
	speed: 0.1978s/iter; left time: 2843.7862s
Epoch: 7 cost time: 8.581262588500977
Epoch: 7, Steps: 154 | Train Loss: 0.930 Vali Loss: 1.775 Vali Acc: 0.490 Test Loss: 1.775 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1341357
	speed: 0.2051s/iter; left time: 2916.9539s
Epoch: 8 cost time: 9.621537923812866
Epoch: 8, Steps: 154 | Train Loss: 0.877 Vali Loss: 1.795 Vali Acc: 0.528 Test Loss: 1.795 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.7661600
	speed: 0.2120s/iter; left time: 2982.4160s
Epoch: 9 cost time: 9.871096134185791
Epoch: 9, Steps: 154 | Train Loss: 0.789 Vali Loss: 2.000 Vali Acc: 0.527 Test Loss: 2.000 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.8192813
	speed: 0.1983s/iter; left time: 2759.7814s
Epoch: 10 cost time: 8.985229015350342
Epoch: 10, Steps: 154 | Train Loss: 0.722 Vali Loss: 2.082 Vali Acc: 0.513 Test Loss: 2.082 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.7853020
	speed: 0.2077s/iter; left time: 2858.6901s
Epoch: 11 cost time: 10.16539478302002
Epoch: 11, Steps: 154 | Train Loss: 0.657 Vali Loss: 1.902 Vali Acc: 0.531 Test Loss: 1.902 Test Acc: 0.531
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.5961621
	speed: 0.2146s/iter; left time: 2919.4068s
Epoch: 12 cost time: 9.49885892868042
Epoch: 12, Steps: 154 | Train Loss: 0.612 Vali Loss: 1.977 Vali Acc: 0.549 Test Loss: 1.977 Test Acc: 0.549
Validation loss decreased (-0.539722 --> -0.549453).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5674039
	speed: 0.2130s/iter; left time: 2866.1149s
Epoch: 13 cost time: 10.26445746421814
Epoch: 13, Steps: 154 | Train Loss: 0.551 Vali Loss: 2.117 Vali Acc: 0.484 Test Loss: 2.117 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.4191867
	speed: 0.2153s/iter; left time: 2862.6245s
Epoch: 14 cost time: 9.830193758010864
Epoch: 14, Steps: 154 | Train Loss: 0.507 Vali Loss: 2.012 Vali Acc: 0.534 Test Loss: 2.012 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.0939444
	speed: 0.2058s/iter; left time: 2705.2833s
Epoch: 15 cost time: 8.906051397323608
Epoch: 15, Steps: 154 | Train Loss: 0.467 Vali Loss: 2.197 Vali Acc: 0.532 Test Loss: 2.197 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3453784
	speed: 0.1986s/iter; left time: 2579.7752s
Epoch: 16 cost time: 9.230430126190186
Epoch: 16, Steps: 154 | Train Loss: 0.441 Vali Loss: 2.608 Vali Acc: 0.506 Test Loss: 2.608 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4108069
	speed: 0.2034s/iter; left time: 2610.7415s
Epoch: 17 cost time: 9.054374694824219
Epoch: 17, Steps: 154 | Train Loss: 0.403 Vali Loss: 2.500 Vali Acc: 0.544 Test Loss: 2.500 Test Acc: 0.544
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3617854
	speed: 0.2000s/iter; left time: 2537.1239s
Epoch: 18 cost time: 9.252707958221436
Epoch: 18, Steps: 154 | Train Loss: 0.376 Vali Loss: 2.579 Vali Acc: 0.510 Test Loss: 2.579 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3569593
	speed: 0.2015s/iter; left time: 2525.1277s
Epoch: 19 cost time: 9.791112899780273
Epoch: 19, Steps: 154 | Train Loss: 0.338 Vali Loss: 2.564 Vali Acc: 0.509 Test Loss: 2.564 Test Acc: 0.509
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2398815
	speed: 0.2085s/iter; left time: 2579.5828s
Epoch: 20 cost time: 8.728169202804565
Epoch: 20, Steps: 154 | Train Loss: 0.323 Vali Loss: 2.639 Vali Acc: 0.546 Test Loss: 2.639 Test Acc: 0.546
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0963591
	speed: 0.2111s/iter; left time: 2579.5530s
Epoch: 21 cost time: 10.2129065990448
Epoch: 21, Steps: 154 | Train Loss: 0.304 Vali Loss: 2.618 Vali Acc: 0.541 Test Loss: 2.618 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3950084
	speed: 0.2056s/iter; left time: 2480.4974s
Epoch: 22 cost time: 9.485535860061646
Epoch: 22, Steps: 154 | Train Loss: 0.278 Vali Loss: 2.735 Vali Acc: 0.509 Test Loss: 2.735 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5494728304947283
model parameter : 198990
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3514159
	speed: 0.0783s/iter; left time: 1197.7867s
Epoch: 1 cost time: 11.116588354110718
Epoch: 1, Steps: 154 | Train Loss: 2.141 Vali Loss: 1.772 Vali Acc: 0.399 Test Loss: 1.772 Test Acc: 0.399
Validation loss decreased (inf --> -0.399415).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4779710
	speed: 0.1995s/iter; left time: 3021.3327s
Epoch: 2 cost time: 8.889780282974243
Epoch: 2, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.442 Vali Acc: 0.401 Test Loss: 2.442 Test Acc: 0.401
Validation loss decreased (-0.399415 --> -0.401435).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5529475
	speed: 0.2022s/iter; left time: 3032.1685s
Epoch: 3 cost time: 9.094322443008423
Epoch: 3, Steps: 154 | Train Loss: 1.265 Vali Loss: 1.719 Vali Acc: 0.485 Test Loss: 1.719 Test Acc: 0.485
Validation loss decreased (-0.401435 --> -0.484573).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7967948
	speed: 0.2003s/iter; left time: 2972.7145s
Epoch: 4 cost time: 8.921088933944702
Epoch: 4, Steps: 154 | Train Loss: 1.171 Vali Loss: 2.071 Vali Acc: 0.418 Test Loss: 2.071 Test Acc: 0.418
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2165133
	speed: 0.1900s/iter; left time: 2790.8570s
Epoch: 5 cost time: 8.149292945861816
Epoch: 5, Steps: 154 | Train Loss: 1.076 Vali Loss: 1.771 Vali Acc: 0.478 Test Loss: 1.771 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5443398
	speed: 0.2024s/iter; left time: 2941.1220s
Epoch: 6 cost time: 9.226178407669067
Epoch: 6, Steps: 154 | Train Loss: 1.045 Vali Loss: 1.685 Vali Acc: 0.502 Test Loss: 1.685 Test Acc: 0.502
Validation loss decreased (-0.484573 --> -0.502011).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4882998
	speed: 0.2051s/iter; left time: 2949.1744s
Epoch: 7 cost time: 8.126514673233032
Epoch: 7, Steps: 154 | Train Loss: 0.970 Vali Loss: 2.009 Vali Acc: 0.487 Test Loss: 2.009 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8917943
	speed: 0.1814s/iter; left time: 2579.4288s
Epoch: 8 cost time: 7.250043869018555
Epoch: 8, Steps: 154 | Train Loss: 0.872 Vali Loss: 1.732 Vali Acc: 0.511 Test Loss: 1.732 Test Acc: 0.511
Validation loss decreased (-0.502011 --> -0.511337).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1006386
	speed: 0.1732s/iter; left time: 2437.3121s
Epoch: 9 cost time: 7.937616348266602
Epoch: 9, Steps: 154 | Train Loss: 0.818 Vali Loss: 1.988 Vali Acc: 0.442 Test Loss: 1.988 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9216943
	speed: 0.1826s/iter; left time: 2540.5110s
Epoch: 10 cost time: 8.284918308258057
Epoch: 10, Steps: 154 | Train Loss: 0.765 Vali Loss: 2.041 Vali Acc: 0.481 Test Loss: 2.041 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2547927
	speed: 0.1907s/iter; left time: 2624.1145s
Epoch: 11 cost time: 8.371265649795532
Epoch: 11, Steps: 154 | Train Loss: 0.694 Vali Loss: 2.113 Vali Acc: 0.509 Test Loss: 2.113 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1117358
	speed: 0.1865s/iter; left time: 2537.6081s
Epoch: 12 cost time: 7.9847376346588135
Epoch: 12, Steps: 154 | Train Loss: 0.635 Vali Loss: 2.042 Vali Acc: 0.480 Test Loss: 2.042 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.4190873
	speed: 0.1837s/iter; left time: 2470.9647s
Epoch: 13 cost time: 8.373701810836792
Epoch: 13, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.304 Vali Acc: 0.468 Test Loss: 2.304 Test Acc: 0.468
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6474252
	speed: 0.1823s/iter; left time: 2424.2388s
Epoch: 14 cost time: 8.543750524520874
Epoch: 14, Steps: 154 | Train Loss: 0.521 Vali Loss: 2.200 Vali Acc: 0.509 Test Loss: 2.200 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.4789217
	speed: 0.1915s/iter; left time: 2517.7310s
Epoch: 15 cost time: 8.531414985656738
Epoch: 15, Steps: 154 | Train Loss: 0.485 Vali Loss: 2.400 Vali Acc: 0.479 Test Loss: 2.400 Test Acc: 0.479
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.4234004
	speed: 0.1864s/iter; left time: 2421.1976s
Epoch: 16 cost time: 8.45796513557434
Epoch: 16, Steps: 154 | Train Loss: 0.433 Vali Loss: 2.448 Vali Acc: 0.495 Test Loss: 2.448 Test Acc: 0.495
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.7073310
	speed: 0.1860s/iter; left time: 2388.2257s
Epoch: 17 cost time: 8.308727979660034
Epoch: 17, Steps: 154 | Train Loss: 0.402 Vali Loss: 2.266 Vali Acc: 0.478 Test Loss: 2.266 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.6928483
	speed: 0.1838s/iter; left time: 2331.1145s
Epoch: 18 cost time: 8.369441270828247
Epoch: 18, Steps: 154 | Train Loss: 0.357 Vali Loss: 2.433 Vali Acc: 0.507 Test Loss: 2.433 Test Acc: 0.507
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5113544201135442
model parameter : 188302
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.2795408
	speed: 0.1369s/iter; left time: 2094.5745s
Epoch: 1 cost time: 20.169978380203247
Epoch: 1, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.211 Vali Acc: 0.404 Test Loss: 2.211 Test Acc: 0.404
Validation loss decreased (inf --> -0.404276).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5117893
	speed: 0.2909s/iter; left time: 4406.9510s
Epoch: 2 cost time: 17.960217714309692
Epoch: 2, Steps: 154 | Train Loss: 1.470 Vali Loss: 1.848 Vali Acc: 0.438 Test Loss: 1.848 Test Acc: 0.438
Validation loss decreased (-0.404276 --> -0.437938).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9239103
	speed: 0.2858s/iter; left time: 4284.6978s
Epoch: 3 cost time: 17.369064331054688
Epoch: 3, Steps: 154 | Train Loss: 1.382 Vali Loss: 1.847 Vali Acc: 0.456 Test Loss: 1.847 Test Acc: 0.456
Validation loss decreased (-0.437938 --> -0.456186).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5621819
	speed: 0.2860s/iter; left time: 4244.2658s
Epoch: 4 cost time: 17.848228931427002
Epoch: 4, Steps: 154 | Train Loss: 1.246 Vali Loss: 1.832 Vali Acc: 0.526 Test Loss: 1.832 Test Acc: 0.526
Validation loss decreased (-0.456186 --> -0.525935).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1541641
	speed: 0.2796s/iter; left time: 4106.6507s
Epoch: 5 cost time: 18.119730234146118
Epoch: 5, Steps: 154 | Train Loss: 1.156 Vali Loss: 2.201 Vali Acc: 0.501 Test Loss: 2.201 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1789118
	speed: 0.3061s/iter; left time: 4448.3429s
Epoch: 6 cost time: 19.44612455368042
Epoch: 6, Steps: 154 | Train Loss: 1.118 Vali Loss: 2.034 Vali Acc: 0.521 Test Loss: 2.034 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9827608
	speed: 0.2939s/iter; left time: 4226.0208s
Epoch: 7 cost time: 14.31687068939209
Epoch: 7, Steps: 154 | Train Loss: 1.020 Vali Loss: 2.965 Vali Acc: 0.415 Test Loss: 2.965 Test Acc: 0.415
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8647994
	speed: 0.2368s/iter; left time: 3367.5613s
Epoch: 8 cost time: 15.642866611480713
Epoch: 8, Steps: 154 | Train Loss: 0.934 Vali Loss: 2.561 Vali Acc: 0.493 Test Loss: 2.561 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.9776173
	speed: 0.2681s/iter; left time: 3771.6694s
Epoch: 9 cost time: 16.632157564163208
Epoch: 9, Steps: 154 | Train Loss: 0.839 Vali Loss: 2.963 Vali Acc: 0.463 Test Loss: 2.963 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3183008
	speed: 0.2653s/iter; left time: 3691.4041s
Epoch: 10 cost time: 16.008288621902466
Epoch: 10, Steps: 154 | Train Loss: 0.752 Vali Loss: 3.333 Vali Acc: 0.488 Test Loss: 3.333 Test Acc: 0.488
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4052095
	speed: 0.2713s/iter; left time: 3733.9518s
Epoch: 11 cost time: 16.465912342071533
Epoch: 11, Steps: 154 | Train Loss: 0.701 Vali Loss: 3.096 Vali Acc: 0.483 Test Loss: 3.096 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6188953
	speed: 0.2722s/iter; left time: 3704.0136s
Epoch: 12 cost time: 14.931532144546509
Epoch: 12, Steps: 154 | Train Loss: 0.626 Vali Loss: 3.022 Vali Acc: 0.489 Test Loss: 3.022 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.6389847
	speed: 0.2463s/iter; left time: 3313.2297s
Epoch: 13 cost time: 14.83545470237732
Epoch: 13, Steps: 154 | Train Loss: 0.567 Vali Loss: 3.249 Vali Acc: 0.446 Test Loss: 3.249 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.4911415
	speed: 0.2661s/iter; left time: 3538.5318s
Epoch: 14 cost time: 16.720495223999023
Epoch: 14, Steps: 154 | Train Loss: 0.497 Vali Loss: 3.430 Vali Acc: 0.431 Test Loss: 3.430 Test Acc: 0.431
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5259529602595296
model parameter : 294222
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0213296
	speed: 0.0674s/iter; left time: 1031.0456s
Epoch: 1 cost time: 9.386022567749023
Epoch: 1, Steps: 154 | Train Loss: 1.970 Vali Loss: 1.778 Vali Acc: 0.465 Test Loss: 1.778 Test Acc: 0.465
Validation loss decreased (inf --> -0.465108).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7464986
	speed: 0.1751s/iter; left time: 2652.7483s
Epoch: 2 cost time: 7.510045051574707
Epoch: 2, Steps: 154 | Train Loss: 1.348 Vali Loss: 1.604 Vali Acc: 0.535 Test Loss: 1.604 Test Acc: 0.535
Validation loss decreased (-0.465108 --> -0.534858).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2510240
	speed: 0.1686s/iter; left time: 2528.3300s
Epoch: 3 cost time: 7.7858593463897705
Epoch: 3, Steps: 154 | Train Loss: 1.222 Vali Loss: 2.028 Vali Acc: 0.508 Test Loss: 2.028 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9057842
	speed: 0.1835s/iter; left time: 2722.3461s
Epoch: 4 cost time: 8.675217866897583
Epoch: 4, Steps: 154 | Train Loss: 1.146 Vali Loss: 2.033 Vali Acc: 0.465 Test Loss: 2.033 Test Acc: 0.465
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9224300
	speed: 0.1838s/iter; left time: 2698.8582s
Epoch: 5 cost time: 8.502825736999512
Epoch: 5, Steps: 154 | Train Loss: 1.063 Vali Loss: 1.881 Vali Acc: 0.508 Test Loss: 1.881 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.8354020
	speed: 0.1871s/iter; left time: 2719.1552s
Epoch: 6 cost time: 8.43235445022583
Epoch: 6, Steps: 154 | Train Loss: 0.967 Vali Loss: 1.953 Vali Acc: 0.527 Test Loss: 1.953 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.3342156
	speed: 0.1827s/iter; left time: 2626.5327s
Epoch: 7 cost time: 8.634846925735474
Epoch: 7, Steps: 154 | Train Loss: 0.919 Vali Loss: 2.270 Vali Acc: 0.521 Test Loss: 2.270 Test Acc: 0.521
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.8521332
	speed: 0.1878s/iter; left time: 2671.5899s
Epoch: 8 cost time: 8.61314868927002
Epoch: 8, Steps: 154 | Train Loss: 0.814 Vali Loss: 2.195 Vali Acc: 0.521 Test Loss: 2.195 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.5599948
	speed: 0.1841s/iter; left time: 2590.3625s
Epoch: 9 cost time: 8.473904132843018
Epoch: 9, Steps: 154 | Train Loss: 0.721 Vali Loss: 2.443 Vali Acc: 0.499 Test Loss: 2.443 Test Acc: 0.499
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.6502725
	speed: 0.1815s/iter; left time: 2525.1377s
Epoch: 10 cost time: 8.495484352111816
Epoch: 10, Steps: 154 | Train Loss: 0.686 Vali Loss: 2.421 Vali Acc: 0.500 Test Loss: 2.421 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.1961378
	speed: 0.1864s/iter; left time: 2565.2364s
Epoch: 11 cost time: 8.579567432403564
Epoch: 11, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.437 Vali Acc: 0.517 Test Loss: 2.437 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.5639978
	speed: 0.1870s/iter; left time: 2544.6717s
Epoch: 12 cost time: 8.895664691925049
Epoch: 12, Steps: 154 | Train Loss: 0.561 Vali Loss: 2.639 Vali Acc: 0.519 Test Loss: 2.639 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5348742903487429
model parameter : 197518
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4179354
	speed: 0.0725s/iter; left time: 1109.9599s
Epoch: 1 cost time: 10.090692281723022
Epoch: 1, Steps: 154 | Train Loss: 1.938 Vali Loss: 1.894 Vali Acc: 0.444 Test Loss: 1.894 Test Acc: 0.444
Validation loss decreased (inf --> -0.444426).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4453105
	speed: 0.1887s/iter; left time: 2858.4240s
Epoch: 2 cost time: 9.008192777633667
Epoch: 2, Steps: 154 | Train Loss: 1.329 Vali Loss: 1.898 Vali Acc: 0.470 Test Loss: 1.898 Test Acc: 0.470
Validation loss decreased (-0.444426 --> -0.469567).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3119152
	speed: 0.1923s/iter; left time: 2883.3553s
Epoch: 3 cost time: 9.076693534851074
Epoch: 3, Steps: 154 | Train Loss: 1.235 Vali Loss: 1.715 Vali Acc: 0.509 Test Loss: 1.715 Test Acc: 0.509
Validation loss decreased (-0.469567 --> -0.508499).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7243004
	speed: 0.1929s/iter; left time: 2862.4443s
Epoch: 4 cost time: 9.035121202468872
Epoch: 4, Steps: 154 | Train Loss: 1.160 Vali Loss: 1.938 Vali Acc: 0.504 Test Loss: 1.938 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5017284
	speed: 0.1878s/iter; left time: 2757.6022s
Epoch: 5 cost time: 8.598286867141724
Epoch: 5, Steps: 154 | Train Loss: 1.053 Vali Loss: 2.105 Vali Acc: 0.459 Test Loss: 2.105 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8030158
	speed: 0.1878s/iter; left time: 2729.2394s
Epoch: 6 cost time: 8.787933826446533
Epoch: 6, Steps: 154 | Train Loss: 1.007 Vali Loss: 1.867 Vali Acc: 0.483 Test Loss: 1.867 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4837892
	speed: 0.1839s/iter; left time: 2643.6981s
Epoch: 7 cost time: 8.660673379898071
Epoch: 7, Steps: 154 | Train Loss: 0.902 Vali Loss: 2.210 Vali Acc: 0.539 Test Loss: 2.210 Test Acc: 0.539
Validation loss decreased (-0.508499 --> -0.538907).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0147768
	speed: 0.1886s/iter; left time: 2683.1358s
Epoch: 8 cost time: 8.312453269958496
Epoch: 8, Steps: 154 | Train Loss: 0.818 Vali Loss: 2.237 Vali Acc: 0.521 Test Loss: 2.237 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7268621
	speed: 0.1888s/iter; left time: 2655.9905s
Epoch: 9 cost time: 8.903889179229736
Epoch: 9, Steps: 154 | Train Loss: 0.730 Vali Loss: 2.412 Vali Acc: 0.490 Test Loss: 2.412 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7231243
	speed: 0.1937s/iter; left time: 2695.0809s
Epoch: 10 cost time: 8.983649492263794
Epoch: 10, Steps: 154 | Train Loss: 0.668 Vali Loss: 2.624 Vali Acc: 0.444 Test Loss: 2.624 Test Acc: 0.444
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8825480
	speed: 0.1833s/iter; left time: 2522.1526s
Epoch: 11 cost time: 8.344540357589722
Epoch: 11, Steps: 154 | Train Loss: 0.618 Vali Loss: 2.506 Vali Acc: 0.482 Test Loss: 2.506 Test Acc: 0.482
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4918426
	speed: 0.1929s/iter; left time: 2624.7573s
Epoch: 12 cost time: 8.809059619903564
Epoch: 12, Steps: 154 | Train Loss: 0.545 Vali Loss: 2.351 Vali Acc: 0.528 Test Loss: 2.351 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9604954
	speed: 0.1894s/iter; left time: 2547.9932s
Epoch: 13 cost time: 8.800537109375
Epoch: 13, Steps: 154 | Train Loss: 0.491 Vali Loss: 2.589 Vali Acc: 0.547 Test Loss: 2.589 Test Acc: 0.547
Validation loss decreased (-0.538907 --> -0.547014).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8833402
	speed: 0.1823s/iter; left time: 2423.8958s
Epoch: 14 cost time: 7.403284788131714
Epoch: 14, Steps: 154 | Train Loss: 0.454 Vali Loss: 2.756 Vali Acc: 0.533 Test Loss: 2.756 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4231768
	speed: 0.1759s/iter; left time: 2312.7092s
Epoch: 15 cost time: 7.671969175338745
Epoch: 15, Steps: 154 | Train Loss: 0.419 Vali Loss: 2.906 Vali Acc: 0.502 Test Loss: 2.906 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.1424555
	speed: 0.1749s/iter; left time: 2272.0769s
Epoch: 16 cost time: 7.799410343170166
Epoch: 16, Steps: 154 | Train Loss: 0.391 Vali Loss: 3.537 Vali Acc: 0.483 Test Loss: 3.537 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4837103
	speed: 0.1702s/iter; left time: 2185.3790s
Epoch: 17 cost time: 7.740339517593384
Epoch: 17, Steps: 154 | Train Loss: 0.378 Vali Loss: 2.998 Vali Acc: 0.497 Test Loss: 2.998 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4008887
	speed: 0.1789s/iter; left time: 2269.5619s
Epoch: 18 cost time: 7.80702543258667
Epoch: 18, Steps: 154 | Train Loss: 0.310 Vali Loss: 3.342 Vali Acc: 0.534 Test Loss: 3.342 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.2082404
	speed: 0.1709s/iter; left time: 2141.3191s
Epoch: 19 cost time: 7.942271947860718
Epoch: 19, Steps: 154 | Train Loss: 0.278 Vali Loss: 3.450 Vali Acc: 0.470 Test Loss: 3.450 Test Acc: 0.470
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0196783
	speed: 0.1711s/iter; left time: 2117.4048s
Epoch: 20 cost time: 7.340961694717407
Epoch: 20, Steps: 154 | Train Loss: 0.287 Vali Loss: 3.696 Vali Acc: 0.474 Test Loss: 3.696 Test Acc: 0.474
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.5118616
	speed: 0.1738s/iter; left time: 2123.8533s
Epoch: 21 cost time: 7.896986961364746
Epoch: 21, Steps: 154 | Train Loss: 0.248 Vali Loss: 3.389 Vali Acc: 0.533 Test Loss: 3.389 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4753843
	speed: 0.1748s/iter; left time: 2108.7471s
Epoch: 22 cost time: 7.908277750015259
Epoch: 22, Steps: 154 | Train Loss: 0.253 Vali Loss: 3.272 Vali Acc: 0.513 Test Loss: 3.272 Test Acc: 0.513
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0549520
	speed: 0.1683s/iter; left time: 2005.3116s
Epoch: 23 cost time: 8.0052011013031
Epoch: 23, Steps: 154 | Train Loss: 0.205 Vali Loss: 3.486 Vali Acc: 0.494 Test Loss: 3.486 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5470397404703974
model parameter : 197582
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1930621
	speed: 0.0649s/iter; left time: 993.1836s
Epoch: 1 cost time: 8.96589732170105
Epoch: 1, Steps: 154 | Train Loss: 2.024 Vali Loss: 1.852 Vali Acc: 0.452 Test Loss: 1.852 Test Acc: 0.452
Validation loss decreased (inf --> -0.451725).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6866007
	speed: 0.1670s/iter; left time: 2529.6709s
Epoch: 2 cost time: 7.215962886810303
Epoch: 2, Steps: 154 | Train Loss: 1.369 Vali Loss: 1.912 Vali Acc: 0.475 Test Loss: 1.912 Test Acc: 0.475
Validation loss decreased (-0.451725 --> -0.474839).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1565858
	speed: 0.1692s/iter; left time: 2536.4269s
Epoch: 3 cost time: 7.32329249382019
Epoch: 3, Steps: 154 | Train Loss: 1.257 Vali Loss: 1.908 Vali Acc: 0.497 Test Loss: 1.908 Test Acc: 0.497
Validation loss decreased (-0.474839 --> -0.497142).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4137287
	speed: 0.1713s/iter; left time: 2542.4896s
Epoch: 4 cost time: 7.393721580505371
Epoch: 4, Steps: 154 | Train Loss: 1.157 Vali Loss: 2.070 Vali Acc: 0.506 Test Loss: 2.070 Test Acc: 0.506
Validation loss decreased (-0.497142 --> -0.505657).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9823337
	speed: 0.1620s/iter; left time: 2378.2496s
Epoch: 5 cost time: 7.280440807342529
Epoch: 5, Steps: 154 | Train Loss: 1.054 Vali Loss: 1.945 Vali Acc: 0.471 Test Loss: 1.945 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9026378
	speed: 0.1827s/iter; left time: 2655.4106s
Epoch: 6 cost time: 7.963186740875244
Epoch: 6, Steps: 154 | Train Loss: 0.990 Vali Loss: 1.959 Vali Acc: 0.515 Test Loss: 1.959 Test Acc: 0.515
Validation loss decreased (-0.505657 --> -0.514984).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9300474
	speed: 0.1780s/iter; left time: 2559.1502s
Epoch: 7 cost time: 8.096344709396362
Epoch: 7, Steps: 154 | Train Loss: 0.939 Vali Loss: 2.147 Vali Acc: 0.540 Test Loss: 2.147 Test Acc: 0.540
Validation loss decreased (-0.514984 --> -0.540125).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9284612
	speed: 0.1827s/iter; left time: 2598.1743s
Epoch: 8 cost time: 8.054179906845093
Epoch: 8, Steps: 154 | Train Loss: 0.849 Vali Loss: 2.135 Vali Acc: 0.461 Test Loss: 2.135 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9776848
	speed: 0.1790s/iter; left time: 2518.8477s
Epoch: 9 cost time: 8.220772743225098
Epoch: 9, Steps: 154 | Train Loss: 0.767 Vali Loss: 1.969 Vali Acc: 0.500 Test Loss: 1.969 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5386800
	speed: 0.1822s/iter; left time: 2535.9190s
Epoch: 10 cost time: 8.044785737991333
Epoch: 10, Steps: 154 | Train Loss: 0.709 Vali Loss: 2.062 Vali Acc: 0.542 Test Loss: 2.062 Test Acc: 0.542
Validation loss decreased (-0.540125 --> -0.541747).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6523458
	speed: 0.1749s/iter; left time: 2406.8784s
Epoch: 11 cost time: 7.990400314331055
Epoch: 11, Steps: 154 | Train Loss: 0.621 Vali Loss: 2.049 Vali Acc: 0.468 Test Loss: 2.049 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.4067206
	speed: 0.1830s/iter; left time: 2489.4203s
Epoch: 12 cost time: 7.951836585998535
Epoch: 12, Steps: 154 | Train Loss: 0.579 Vali Loss: 2.687 Vali Acc: 0.507 Test Loss: 2.687 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7599383
	speed: 0.1879s/iter; left time: 2528.1448s
Epoch: 13 cost time: 8.831747055053711
Epoch: 13, Steps: 154 | Train Loss: 0.507 Vali Loss: 2.402 Vali Acc: 0.544 Test Loss: 2.402 Test Acc: 0.544
Validation loss decreased (-0.541747 --> -0.543772).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5690721
	speed: 0.1914s/iter; left time: 2546.0682s
Epoch: 14 cost time: 8.798302173614502
Epoch: 14, Steps: 154 | Train Loss: 0.481 Vali Loss: 2.930 Vali Acc: 0.499 Test Loss: 2.930 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7568505
	speed: 0.1822s/iter; left time: 2394.5849s
Epoch: 15 cost time: 7.9778289794921875
Epoch: 15, Steps: 154 | Train Loss: 0.438 Vali Loss: 2.701 Vali Acc: 0.506 Test Loss: 2.701 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4032172
	speed: 0.1739s/iter; left time: 2258.5680s
Epoch: 16 cost time: 7.865664720535278
Epoch: 16, Steps: 154 | Train Loss: 0.397 Vali Loss: 2.776 Vali Acc: 0.507 Test Loss: 2.776 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3000003
	speed: 0.1811s/iter; left time: 2324.2353s
Epoch: 17 cost time: 8.202475547790527
Epoch: 17, Steps: 154 | Train Loss: 0.381 Vali Loss: 2.774 Vali Acc: 0.510 Test Loss: 2.774 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5180504
	speed: 0.1757s/iter; left time: 2228.6694s
Epoch: 18 cost time: 7.721123456954956
Epoch: 18, Steps: 154 | Train Loss: 0.361 Vali Loss: 2.647 Vali Acc: 0.508 Test Loss: 2.647 Test Acc: 0.508
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3473747
	speed: 0.1742s/iter; left time: 2182.6629s
Epoch: 19 cost time: 8.252384901046753
Epoch: 19, Steps: 154 | Train Loss: 0.339 Vali Loss: 2.863 Vali Acc: 0.504 Test Loss: 2.863 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2442096
	speed: 0.1798s/iter; left time: 2225.2901s
Epoch: 20 cost time: 7.796749591827393
Epoch: 20, Steps: 154 | Train Loss: 0.301 Vali Loss: 2.846 Vali Acc: 0.546 Test Loss: 2.846 Test Acc: 0.546
Validation loss decreased (-0.543772 --> -0.546200).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8091713
	speed: 0.1790s/iter; left time: 2187.1603s
Epoch: 21 cost time: 8.367527961730957
Epoch: 21, Steps: 154 | Train Loss: 0.279 Vali Loss: 2.937 Vali Acc: 0.485 Test Loss: 2.937 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0642795
	speed: 0.1804s/iter; left time: 2176.5290s
Epoch: 22 cost time: 8.243136405944824
Epoch: 22, Steps: 154 | Train Loss: 0.272 Vali Loss: 3.435 Vali Acc: 0.489 Test Loss: 3.435 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2854949
	speed: 0.1810s/iter; left time: 2155.9845s
Epoch: 23 cost time: 8.37569260597229
Epoch: 23, Steps: 154 | Train Loss: 0.282 Vali Loss: 3.058 Vali Acc: 0.505 Test Loss: 3.058 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0645699
	speed: 0.1806s/iter; left time: 2124.0635s
Epoch: 24 cost time: 8.255461692810059
Epoch: 24, Steps: 154 | Train Loss: 0.202 Vali Loss: 3.296 Vali Acc: 0.506 Test Loss: 3.296 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1929211
	speed: 0.1850s/iter; left time: 2146.7442s
Epoch: 25 cost time: 8.011096954345703
Epoch: 25, Steps: 154 | Train Loss: 0.227 Vali Loss: 3.360 Vali Acc: 0.518 Test Loss: 3.360 Test Acc: 0.518
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.1549587
	speed: 0.1751s/iter; left time: 2005.4422s
Epoch: 26 cost time: 7.867173671722412
Epoch: 26, Steps: 154 | Train Loss: 0.219 Vali Loss: 3.760 Vali Acc: 0.509 Test Loss: 3.760 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0565945
	speed: 0.1814s/iter; left time: 2049.8150s
Epoch: 27 cost time: 8.192003965377808
Epoch: 27, Steps: 154 | Train Loss: 0.204 Vali Loss: 3.443 Vali Acc: 0.491 Test Loss: 3.443 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0917503
	speed: 0.1728s/iter; left time: 1925.3441s
Epoch: 28 cost time: 7.510396718978882
Epoch: 28, Steps: 154 | Train Loss: 0.187 Vali Loss: 3.766 Vali Acc: 0.514 Test Loss: 3.766 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0727112
	speed: 0.1632s/iter; left time: 1793.3453s
Epoch: 29 cost time: 7.3693647384643555
Epoch: 29, Steps: 154 | Train Loss: 0.184 Vali Loss: 3.443 Vali Acc: 0.546 Test Loss: 3.443 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0924870
	speed: 0.1670s/iter; left time: 1809.2712s
Epoch: 30 cost time: 7.514123439788818
Epoch: 30, Steps: 154 | Train Loss: 0.152 Vali Loss: 3.575 Vali Acc: 0.530 Test Loss: 3.575 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5462287104622872
model parameter : 165454
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9108531
	speed: 0.0608s/iter; left time: 929.5378s
Epoch: 1 cost time: 8.349734544754028
Epoch: 1, Steps: 154 | Train Loss: 2.157 Vali Loss: 1.778 Vali Acc: 0.416 Test Loss: 1.778 Test Acc: 0.416
Validation loss decreased (inf --> -0.416041).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7048899
	speed: 0.1593s/iter; left time: 2412.5010s
Epoch: 2 cost time: 6.828111410140991
Epoch: 2, Steps: 154 | Train Loss: 1.476 Vali Loss: 1.769 Vali Acc: 0.492 Test Loss: 1.769 Test Acc: 0.492
Validation loss decreased (-0.416041 --> -0.491872).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6577247
	speed: 0.1645s/iter; left time: 2466.6106s
Epoch: 3 cost time: 6.576853036880493
Epoch: 3, Steps: 154 | Train Loss: 1.265 Vali Loss: 1.835 Vali Acc: 0.456 Test Loss: 1.835 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0639462
	speed: 0.1603s/iter; left time: 2379.3082s
Epoch: 4 cost time: 7.064196586608887
Epoch: 4, Steps: 154 | Train Loss: 1.156 Vali Loss: 1.775 Vali Acc: 0.517 Test Loss: 1.775 Test Acc: 0.517
Validation loss decreased (-0.491872 --> -0.516608).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9488785
	speed: 0.1698s/iter; left time: 2494.0286s
Epoch: 5 cost time: 6.959182977676392
Epoch: 5, Steps: 154 | Train Loss: 1.085 Vali Loss: 2.133 Vali Acc: 0.486 Test Loss: 2.133 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5253243
	speed: 0.1614s/iter; left time: 2345.3265s
Epoch: 6 cost time: 6.776889085769653
Epoch: 6, Steps: 154 | Train Loss: 1.003 Vali Loss: 1.965 Vali Acc: 0.503 Test Loss: 1.965 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6822997
	speed: 0.1665s/iter; left time: 2394.2280s
Epoch: 7 cost time: 7.196638345718384
Epoch: 7, Steps: 154 | Train Loss: 0.925 Vali Loss: 2.074 Vali Acc: 0.503 Test Loss: 2.074 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2683763
	speed: 0.1718s/iter; left time: 2444.0751s
Epoch: 8 cost time: 7.095845460891724
Epoch: 8, Steps: 154 | Train Loss: 0.863 Vali Loss: 2.058 Vali Acc: 0.445 Test Loss: 2.058 Test Acc: 0.445
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.0048575
	speed: 0.1640s/iter; left time: 2307.7188s
Epoch: 9 cost time: 7.000807285308838
Epoch: 9, Steps: 154 | Train Loss: 0.790 Vali Loss: 1.920 Vali Acc: 0.526 Test Loss: 1.920 Test Acc: 0.526
Validation loss decreased (-0.516608 --> -0.526339).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.2690840
	speed: 0.1560s/iter; left time: 2170.8437s
Epoch: 10 cost time: 6.033135175704956
Epoch: 10, Steps: 154 | Train Loss: 0.732 Vali Loss: 2.055 Vali Acc: 0.518 Test Loss: 2.055 Test Acc: 0.518
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.6928251
	speed: 0.1685s/iter; left time: 2318.2844s
Epoch: 11 cost time: 7.7903125286102295
Epoch: 11, Steps: 154 | Train Loss: 0.680 Vali Loss: 2.320 Vali Acc: 0.469 Test Loss: 2.320 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2961794
	speed: 0.1694s/iter; left time: 2304.7953s
Epoch: 12 cost time: 7.460241079330444
Epoch: 12, Steps: 154 | Train Loss: 0.616 Vali Loss: 2.119 Vali Acc: 0.544 Test Loss: 2.119 Test Acc: 0.544
Validation loss decreased (-0.526339 --> -0.543774).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4360470
	speed: 0.1801s/iter; left time: 2423.3929s
Epoch: 13 cost time: 8.025139331817627
Epoch: 13, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.478 Vali Acc: 0.493 Test Loss: 2.478 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.3271081
	speed: 0.1792s/iter; left time: 2383.5887s
Epoch: 14 cost time: 8.182045698165894
Epoch: 14, Steps: 154 | Train Loss: 0.527 Vali Loss: 2.298 Vali Acc: 0.489 Test Loss: 2.298 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2308768
	speed: 0.1780s/iter; left time: 2340.3862s
Epoch: 15 cost time: 7.81687068939209
Epoch: 15, Steps: 154 | Train Loss: 0.473 Vali Loss: 2.287 Vali Acc: 0.504 Test Loss: 2.287 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4303251
	speed: 0.1780s/iter; left time: 2312.8490s
Epoch: 16 cost time: 6.945115327835083
Epoch: 16, Steps: 154 | Train Loss: 0.437 Vali Loss: 2.422 Vali Acc: 0.500 Test Loss: 2.422 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4087903
	speed: 0.1202s/iter; left time: 1542.8448s
Epoch: 17 cost time: 4.783960342407227
Epoch: 17, Steps: 154 | Train Loss: 0.420 Vali Loss: 2.519 Vali Acc: 0.514 Test Loss: 2.519 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1699802
	speed: 0.1293s/iter; left time: 1640.3242s
Epoch: 18 cost time: 6.800862789154053
Epoch: 18, Steps: 154 | Train Loss: 0.355 Vali Loss: 2.520 Vali Acc: 0.509 Test Loss: 2.520 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4116948
	speed: 0.1641s/iter; left time: 2056.1176s
Epoch: 19 cost time: 7.339422941207886
Epoch: 19, Steps: 154 | Train Loss: 0.368 Vali Loss: 2.524 Vali Acc: 0.488 Test Loss: 2.524 Test Acc: 0.488
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1868003
	speed: 0.1751s/iter; left time: 2166.3293s
Epoch: 20 cost time: 8.152526378631592
Epoch: 20, Steps: 154 | Train Loss: 0.301 Vali Loss: 2.601 Vali Acc: 0.533 Test Loss: 2.601 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1339270
	speed: 0.1807s/iter; left time: 2208.4711s
Epoch: 21 cost time: 8.094809532165527
Epoch: 21, Steps: 154 | Train Loss: 0.267 Vali Loss: 2.618 Vali Acc: 0.511 Test Loss: 2.618 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5553391
	speed: 0.1815s/iter; left time: 2190.5425s
Epoch: 22 cost time: 7.989999294281006
Epoch: 22, Steps: 154 | Train Loss: 0.288 Vali Loss: 2.790 Vali Acc: 0.521 Test Loss: 2.790 Test Acc: 0.521
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5437956204379562
model parameter : 149454
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3983641
	speed: 0.0657s/iter; left time: 1005.0628s
Epoch: 1 cost time: 9.12156867980957
Epoch: 1, Steps: 154 | Train Loss: 2.163 Vali Loss: 1.811 Vali Acc: 0.432 Test Loss: 1.811 Test Acc: 0.432
Validation loss decreased (inf --> -0.431855).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3900005
	speed: 0.1711s/iter; left time: 2591.8004s
Epoch: 2 cost time: 7.513278484344482
Epoch: 2, Steps: 154 | Train Loss: 1.496 Vali Loss: 1.840 Vali Acc: 0.428 Test Loss: 1.840 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1897745
	speed: 0.1767s/iter; left time: 2649.2275s
Epoch: 3 cost time: 8.14452052116394
Epoch: 3, Steps: 154 | Train Loss: 1.251 Vali Loss: 1.783 Vali Acc: 0.499 Test Loss: 1.783 Test Acc: 0.499
Validation loss decreased (-0.431855 --> -0.499171).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0783793
	speed: 0.1755s/iter; left time: 2604.4970s
Epoch: 4 cost time: 8.096026182174683
Epoch: 4, Steps: 154 | Train Loss: 1.145 Vali Loss: 1.661 Vali Acc: 0.492 Test Loss: 1.661 Test Acc: 0.492
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8171104
	speed: 0.1663s/iter; left time: 2441.9849s
Epoch: 5 cost time: 6.755222797393799
Epoch: 5, Steps: 154 | Train Loss: 1.093 Vali Loss: 1.798 Vali Acc: 0.512 Test Loss: 1.798 Test Acc: 0.512
Validation loss decreased (-0.499171 --> -0.512147).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0502312
	speed: 0.1620s/iter; left time: 2353.3755s
Epoch: 6 cost time: 7.341412544250488
Epoch: 6, Steps: 154 | Train Loss: 1.001 Vali Loss: 1.799 Vali Acc: 0.521 Test Loss: 1.799 Test Acc: 0.521
Validation loss decreased (-0.512147 --> -0.521474).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8838020
	speed: 0.1726s/iter; left time: 2480.8405s
Epoch: 7 cost time: 7.421468019485474
Epoch: 7, Steps: 154 | Train Loss: 0.959 Vali Loss: 2.072 Vali Acc: 0.496 Test Loss: 2.072 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1306797
	speed: 0.1725s/iter; left time: 2452.9812s
Epoch: 8 cost time: 8.039939641952515
Epoch: 8, Steps: 154 | Train Loss: 0.910 Vali Loss: 2.031 Vali Acc: 0.459 Test Loss: 2.031 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9492434
	speed: 0.1679s/iter; left time: 2362.5025s
Epoch: 9 cost time: 7.479577302932739
Epoch: 9, Steps: 154 | Train Loss: 0.827 Vali Loss: 1.858 Vali Acc: 0.503 Test Loss: 1.858 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6173344
	speed: 0.1730s/iter; left time: 2407.4765s
Epoch: 10 cost time: 7.605806589126587
Epoch: 10, Steps: 154 | Train Loss: 0.781 Vali Loss: 1.947 Vali Acc: 0.543 Test Loss: 1.947 Test Acc: 0.543
Validation loss decreased (-0.521474 --> -0.543371).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0603342
	speed: 0.1677s/iter; left time: 2307.8406s
Epoch: 11 cost time: 6.443591833114624
Epoch: 11, Steps: 154 | Train Loss: 0.739 Vali Loss: 1.960 Vali Acc: 0.521 Test Loss: 1.960 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5510554
	speed: 0.1608s/iter; left time: 2188.6238s
Epoch: 12 cost time: 6.85120153427124
Epoch: 12, Steps: 154 | Train Loss: 0.670 Vali Loss: 2.187 Vali Acc: 0.516 Test Loss: 2.187 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4855562
	speed: 0.1614s/iter; left time: 2171.1682s
Epoch: 13 cost time: 6.918416500091553
Epoch: 13, Steps: 154 | Train Loss: 0.639 Vali Loss: 2.280 Vali Acc: 0.524 Test Loss: 2.280 Test Acc: 0.524
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8228989
	speed: 0.1594s/iter; left time: 2119.3774s
Epoch: 14 cost time: 6.748352527618408
Epoch: 14, Steps: 154 | Train Loss: 0.610 Vali Loss: 2.387 Vali Acc: 0.447 Test Loss: 2.387 Test Acc: 0.447
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.4183906
	speed: 0.1532s/iter; left time: 2013.1957s
Epoch: 15 cost time: 6.496726751327515
Epoch: 15, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.200 Vali Acc: 0.541 Test Loss: 2.200 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.8069605
	speed: 0.1556s/iter; left time: 2020.8462s
Epoch: 16 cost time: 6.405348777770996
Epoch: 16, Steps: 154 | Train Loss: 0.464 Vali Loss: 2.413 Vali Acc: 0.529 Test Loss: 2.413 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.4521906
	speed: 0.1530s/iter; left time: 1964.5287s
Epoch: 17 cost time: 6.834238052368164
Epoch: 17, Steps: 154 | Train Loss: 0.458 Vali Loss: 2.307 Vali Acc: 0.493 Test Loss: 2.307 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.7866063
	speed: 0.1521s/iter; left time: 1929.5892s
Epoch: 18 cost time: 6.6651225090026855
Epoch: 18, Steps: 154 | Train Loss: 0.434 Vali Loss: 2.474 Vali Acc: 0.504 Test Loss: 2.474 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2234276
	speed: 0.1507s/iter; left time: 1887.9068s
Epoch: 19 cost time: 6.252728223800659
Epoch: 19, Steps: 154 | Train Loss: 0.360 Vali Loss: 2.442 Vali Acc: 0.498 Test Loss: 2.442 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.3566716
	speed: 0.1470s/iter; left time: 1818.7411s
Epoch: 20 cost time: 6.355879783630371
Epoch: 20, Steps: 154 | Train Loss: 0.359 Vali Loss: 2.741 Vali Acc: 0.533 Test Loss: 2.741 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5433901054339011
model parameter : 138766
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.3172183
	speed: 0.1199s/iter; left time: 1834.3495s
Epoch: 1 cost time: 17.414984941482544
Epoch: 1, Steps: 154 | Train Loss: 1.934 Vali Loss: 1.903 Vali Acc: 0.452 Test Loss: 1.903 Test Acc: 0.452
Validation loss decreased (inf --> -0.451725).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7329041
	speed: 0.2587s/iter; left time: 3919.0294s
Epoch: 2 cost time: 15.568966150283813
Epoch: 2, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.191 Vali Acc: 0.515 Test Loss: 2.191 Test Acc: 0.515
Validation loss decreased (-0.451725 --> -0.515388).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6216934
	speed: 0.2506s/iter; left time: 3756.8311s
Epoch: 3 cost time: 14.924178123474121
Epoch: 3, Steps: 154 | Train Loss: 1.346 Vali Loss: 1.904 Vali Acc: 0.517 Test Loss: 1.904 Test Acc: 0.517
Validation loss decreased (-0.515388 --> -0.517013).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0723423
	speed: 0.2770s/iter; left time: 4109.8226s
Epoch: 4 cost time: 17.662315607070923
Epoch: 4, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.173 Vali Acc: 0.452 Test Loss: 2.173 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1558425
	speed: 0.2834s/iter; left time: 4161.1895s
Epoch: 5 cost time: 17.769465684890747
Epoch: 5, Steps: 154 | Train Loss: 1.231 Vali Loss: 2.591 Vali Acc: 0.500 Test Loss: 2.591 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8950298
	speed: 0.2855s/iter; left time: 4148.2684s
Epoch: 6 cost time: 18.103846549987793
Epoch: 6, Steps: 154 | Train Loss: 1.100 Vali Loss: 2.344 Vali Acc: 0.476 Test Loss: 2.344 Test Acc: 0.476
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.4624461
	speed: 0.3022s/iter; left time: 4344.1726s
Epoch: 7 cost time: 19.362844228744507
Epoch: 7, Steps: 154 | Train Loss: 0.975 Vali Loss: 2.663 Vali Acc: 0.500 Test Loss: 2.663 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.4297979
	speed: 0.3054s/iter; left time: 4343.4788s
Epoch: 8 cost time: 18.872675895690918
Epoch: 8, Steps: 154 | Train Loss: 0.932 Vali Loss: 2.714 Vali Acc: 0.520 Test Loss: 2.714 Test Acc: 0.520
Validation loss decreased (-0.517013 --> -0.520249).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6355484
	speed: 0.2995s/iter; left time: 4213.5804s
Epoch: 9 cost time: 19.111161470413208
Epoch: 9, Steps: 154 | Train Loss: 0.840 Vali Loss: 2.977 Vali Acc: 0.500 Test Loss: 2.977 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6716017
	speed: 0.3021s/iter; left time: 4203.0583s
Epoch: 10 cost time: 18.927976846694946
Epoch: 10, Steps: 154 | Train Loss: 0.766 Vali Loss: 3.022 Vali Acc: 0.474 Test Loss: 3.022 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.9595296
	speed: 0.2885s/iter; left time: 3969.6281s
Epoch: 11 cost time: 16.394469499588013
Epoch: 11, Steps: 154 | Train Loss: 0.667 Vali Loss: 3.040 Vali Acc: 0.391 Test Loss: 3.040 Test Acc: 0.391
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4819527
	speed: 0.2432s/iter; left time: 3308.7616s
Epoch: 12 cost time: 14.158297538757324
Epoch: 12, Steps: 154 | Train Loss: 0.591 Vali Loss: 3.141 Vali Acc: 0.472 Test Loss: 3.141 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.8603061
	speed: 0.2395s/iter; left time: 3222.1403s
Epoch: 13 cost time: 13.512964010238647
Epoch: 13, Steps: 154 | Train Loss: 0.548 Vali Loss: 3.256 Vali Acc: 0.491 Test Loss: 3.256 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.8471889
	speed: 0.2287s/iter; left time: 3040.9744s
Epoch: 14 cost time: 13.0667884349823
Epoch: 14, Steps: 154 | Train Loss: 0.499 Vali Loss: 3.013 Vali Acc: 0.520 Test Loss: 3.013 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.7699907
	speed: 0.2194s/iter; left time: 2883.4524s
Epoch: 15 cost time: 11.47841191291809
Epoch: 15, Steps: 154 | Train Loss: 0.479 Vali Loss: 3.593 Vali Acc: 0.483 Test Loss: 3.593 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3861821
	speed: 0.2202s/iter; left time: 2860.3762s
Epoch: 16 cost time: 11.798275232315063
Epoch: 16, Steps: 154 | Train Loss: 0.394 Vali Loss: 4.017 Vali Acc: 0.470 Test Loss: 4.017 Test Acc: 0.470
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1731660
	speed: 0.2163s/iter; left time: 2776.7341s
Epoch: 17 cost time: 12.727130651473999
Epoch: 17, Steps: 154 | Train Loss: 0.394 Vali Loss: 4.029 Vali Acc: 0.463 Test Loss: 4.029 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.5721040
	speed: 0.2281s/iter; left time: 2892.4059s
Epoch: 18 cost time: 13.885282516479492
Epoch: 18, Steps: 154 | Train Loss: 0.340 Vali Loss: 3.775 Vali Acc: 0.455 Test Loss: 3.775 Test Acc: 0.455
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5202757502027575
model parameter : 269454
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1796479
	speed: 0.0696s/iter; left time: 1065.0147s
Epoch: 1 cost time: 9.65664029121399
Epoch: 1, Steps: 154 | Train Loss: 1.991 Vali Loss: 2.006 Vali Acc: 0.413 Test Loss: 2.006 Test Acc: 0.413
Validation loss decreased (inf --> -0.413200).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5390160
	speed: 0.1752s/iter; left time: 2654.3941s
Epoch: 2 cost time: 8.013662815093994
Epoch: 2, Steps: 154 | Train Loss: 1.394 Vali Loss: 1.791 Vali Acc: 0.457 Test Loss: 1.791 Test Acc: 0.457
Validation loss decreased (-0.413200 --> -0.456997).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2036906
	speed: 0.1763s/iter; left time: 2642.6931s
Epoch: 3 cost time: 7.964037179946899
Epoch: 3, Steps: 154 | Train Loss: 1.245 Vali Loss: 1.994 Vali Acc: 0.489 Test Loss: 1.994 Test Acc: 0.489
Validation loss decreased (-0.456997 --> -0.489031).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1538435
	speed: 0.1793s/iter; left time: 2660.0104s
Epoch: 4 cost time: 8.076257467269897
Epoch: 4, Steps: 154 | Train Loss: 1.144 Vali Loss: 1.813 Vali Acc: 0.473 Test Loss: 1.813 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8910375
	speed: 0.1735s/iter; left time: 2547.4985s
Epoch: 5 cost time: 8.045071840286255
Epoch: 5, Steps: 154 | Train Loss: 1.063 Vali Loss: 1.993 Vali Acc: 0.485 Test Loss: 1.993 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4430140
	speed: 0.1876s/iter; left time: 2725.6538s
Epoch: 6 cost time: 9.414092302322388
Epoch: 6, Steps: 154 | Train Loss: 0.997 Vali Loss: 1.839 Vali Acc: 0.509 Test Loss: 1.839 Test Acc: 0.509
Validation loss decreased (-0.489031 --> -0.509308).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7103454
	speed: 0.1973s/iter; left time: 2837.2992s
Epoch: 7 cost time: 9.05843448638916
Epoch: 7, Steps: 154 | Train Loss: 0.887 Vali Loss: 2.470 Vali Acc: 0.463 Test Loss: 2.470 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7726938
	speed: 0.1876s/iter; left time: 2668.3465s
Epoch: 8 cost time: 8.836189270019531
Epoch: 8, Steps: 154 | Train Loss: 0.840 Vali Loss: 2.355 Vali Acc: 0.441 Test Loss: 2.355 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9469190
	speed: 0.1944s/iter; left time: 2734.4379s
Epoch: 9 cost time: 9.03702425956726
Epoch: 9, Steps: 154 | Train Loss: 0.756 Vali Loss: 2.192 Vali Acc: 0.508 Test Loss: 2.192 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2323761
	speed: 0.2004s/iter; left time: 2788.8983s
Epoch: 10 cost time: 9.419149160385132
Epoch: 10, Steps: 154 | Train Loss: 0.695 Vali Loss: 2.575 Vali Acc: 0.468 Test Loss: 2.575 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.9264549
	speed: 0.1847s/iter; left time: 2541.3341s
Epoch: 11 cost time: 8.010323524475098
Epoch: 11, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.368 Vali Acc: 0.531 Test Loss: 2.368 Test Acc: 0.531
Validation loss decreased (-0.509308 --> -0.531201).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6189868
	speed: 0.1821s/iter; left time: 2478.1979s
Epoch: 12 cost time: 8.286468267440796
Epoch: 12, Steps: 154 | Train Loss: 0.577 Vali Loss: 2.749 Vali Acc: 0.437 Test Loss: 2.749 Test Acc: 0.437
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.8910815
	speed: 0.1870s/iter; left time: 2515.4578s
Epoch: 13 cost time: 8.60538625717163
Epoch: 13, Steps: 154 | Train Loss: 0.540 Vali Loss: 2.444 Vali Acc: 0.494 Test Loss: 2.444 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3366483
	speed: 0.1876s/iter; left time: 2494.2859s
Epoch: 14 cost time: 8.540618658065796
Epoch: 14, Steps: 154 | Train Loss: 0.472 Vali Loss: 2.502 Vali Acc: 0.552 Test Loss: 2.502 Test Acc: 0.552
Validation loss decreased (-0.531201 --> -0.552286).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.8961856
	speed: 0.1782s/iter; left time: 2342.3280s
Epoch: 15 cost time: 7.954654216766357
Epoch: 15, Steps: 154 | Train Loss: 0.438 Vali Loss: 2.737 Vali Acc: 0.522 Test Loss: 2.737 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6357207
	speed: 0.1821s/iter; left time: 2365.4630s
Epoch: 16 cost time: 8.65387511253357
Epoch: 16, Steps: 154 | Train Loss: 0.406 Vali Loss: 2.933 Vali Acc: 0.522 Test Loss: 2.933 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5680756
	speed: 0.1823s/iter; left time: 2340.2170s
Epoch: 17 cost time: 7.82574200630188
Epoch: 17, Steps: 154 | Train Loss: 0.384 Vali Loss: 3.001 Vali Acc: 0.501 Test Loss: 3.001 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.2650713
	speed: 0.1924s/iter; left time: 2440.7489s
Epoch: 18 cost time: 8.677771091461182
Epoch: 18, Steps: 154 | Train Loss: 0.352 Vali Loss: 3.030 Vali Acc: 0.486 Test Loss: 3.030 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.2284054
	speed: 0.1948s/iter; left time: 2440.7627s
Epoch: 19 cost time: 8.975745916366577
Epoch: 19, Steps: 154 | Train Loss: 0.315 Vali Loss: 3.405 Vali Acc: 0.489 Test Loss: 3.405 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0861938
	speed: 0.2030s/iter; left time: 2512.6777s
Epoch: 20 cost time: 8.730780839920044
Epoch: 20, Steps: 154 | Train Loss: 0.278 Vali Loss: 3.062 Vali Acc: 0.515 Test Loss: 3.062 Test Acc: 0.515
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.4895309
	speed: 0.1808s/iter; left time: 2209.3657s
Epoch: 21 cost time: 7.736290216445923
Epoch: 21, Steps: 154 | Train Loss: 0.286 Vali Loss: 3.795 Vali Acc: 0.491 Test Loss: 3.795 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.1240004
	speed: 0.1845s/iter; left time: 2226.5056s
Epoch: 22 cost time: 8.548162460327148
Epoch: 22, Steps: 154 | Train Loss: 0.257 Vali Loss: 3.770 Vali Acc: 0.494 Test Loss: 3.770 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0663667
	speed: 0.1960s/iter; left time: 2335.1147s
Epoch: 23 cost time: 8.292982339859009
Epoch: 23, Steps: 154 | Train Loss: 0.276 Vali Loss: 3.611 Vali Acc: 0.493 Test Loss: 3.611 Test Acc: 0.493
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2780048
	speed: 0.1756s/iter; left time: 2064.7769s
Epoch: 24 cost time: 8.022305488586426
Epoch: 24, Steps: 154 | Train Loss: 0.271 Vali Loss: 3.638 Vali Acc: 0.517 Test Loss: 3.638 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5523114355231143
model parameter : 172750
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9741495
	speed: 0.0703s/iter; left time: 1076.0356s
Epoch: 1 cost time: 9.973053693771362
Epoch: 1, Steps: 154 | Train Loss: 1.930 Vali Loss: 1.845 Vali Acc: 0.455 Test Loss: 1.845 Test Acc: 0.455
Validation loss decreased (inf --> -0.454564).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0171444
	speed: 0.1833s/iter; left time: 2776.2336s
Epoch: 2 cost time: 8.155073165893555
Epoch: 2, Steps: 154 | Train Loss: 1.363 Vali Loss: 1.681 Vali Acc: 0.528 Test Loss: 1.681 Test Acc: 0.528
Validation loss decreased (-0.454564 --> -0.527558).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4068452
	speed: 0.1927s/iter; left time: 2888.8600s
Epoch: 3 cost time: 8.868768692016602
Epoch: 3, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.047 Vali Acc: 0.472 Test Loss: 2.047 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0981799
	speed: 0.1877s/iter; left time: 2785.3044s
Epoch: 4 cost time: 8.561089277267456
Epoch: 4, Steps: 154 | Train Loss: 1.161 Vali Loss: 1.878 Vali Acc: 0.495 Test Loss: 1.878 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8178570
	speed: 0.1936s/iter; left time: 2842.8740s
Epoch: 5 cost time: 9.036656141281128
Epoch: 5, Steps: 154 | Train Loss: 1.044 Vali Loss: 2.107 Vali Acc: 0.506 Test Loss: 2.107 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0435618
	speed: 0.2012s/iter; left time: 2923.3272s
Epoch: 6 cost time: 9.769320726394653
Epoch: 6, Steps: 154 | Train Loss: 0.961 Vali Loss: 1.940 Vali Acc: 0.501 Test Loss: 1.940 Test Acc: 0.501
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.5661658
	speed: 0.1970s/iter; left time: 2832.1539s
Epoch: 7 cost time: 9.390180110931396
Epoch: 7, Steps: 154 | Train Loss: 0.873 Vali Loss: 2.074 Vali Acc: 0.566 Test Loss: 2.074 Test Acc: 0.566
Validation loss decreased (-0.527558 --> -0.565673).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6966006
	speed: 0.1982s/iter; left time: 2819.1285s
Epoch: 8 cost time: 9.141607522964478
Epoch: 8, Steps: 154 | Train Loss: 0.790 Vali Loss: 2.298 Vali Acc: 0.567 Test Loss: 2.298 Test Acc: 0.567
Validation loss decreased (-0.565673 --> -0.566481).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8641779
	speed: 0.2057s/iter; left time: 2893.5971s
Epoch: 9 cost time: 10.29374098777771
Epoch: 9, Steps: 154 | Train Loss: 0.739 Vali Loss: 2.080 Vali Acc: 0.522 Test Loss: 2.080 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5123026
	speed: 0.2142s/iter; left time: 2981.2696s
Epoch: 10 cost time: 10.01136589050293
Epoch: 10, Steps: 154 | Train Loss: 0.657 Vali Loss: 2.494 Vali Acc: 0.543 Test Loss: 2.494 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6910973
	speed: 0.2168s/iter; left time: 2982.7669s
Epoch: 11 cost time: 10.16667890548706
Epoch: 11, Steps: 154 | Train Loss: 0.640 Vali Loss: 2.323 Vali Acc: 0.545 Test Loss: 2.323 Test Acc: 0.545
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1338738
	speed: 0.2205s/iter; left time: 3000.5355s
Epoch: 12 cost time: 10.302471160888672
Epoch: 12, Steps: 154 | Train Loss: 0.590 Vali Loss: 2.538 Vali Acc: 0.514 Test Loss: 2.538 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.5047543
	speed: 0.2118s/iter; left time: 2849.4960s
Epoch: 13 cost time: 9.991695165634155
Epoch: 13, Steps: 154 | Train Loss: 0.535 Vali Loss: 2.545 Vali Acc: 0.542 Test Loss: 2.545 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5760871
	speed: 0.1972s/iter; left time: 2623.0090s
Epoch: 14 cost time: 8.746682405471802
Epoch: 14, Steps: 154 | Train Loss: 0.479 Vali Loss: 2.759 Vali Acc: 0.509 Test Loss: 2.759 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.4566816
	speed: 0.2051s/iter; left time: 2696.2618s
Epoch: 15 cost time: 9.622967004776001
Epoch: 15, Steps: 154 | Train Loss: 0.433 Vali Loss: 3.075 Vali Acc: 0.539 Test Loss: 3.075 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.6703472
	speed: 0.1959s/iter; left time: 2545.2925s
Epoch: 16 cost time: 8.952482461929321
Epoch: 16, Steps: 154 | Train Loss: 0.385 Vali Loss: 3.024 Vali Acc: 0.506 Test Loss: 3.024 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.1320032
	speed: 0.1925s/iter; left time: 2471.0072s
Epoch: 17 cost time: 9.594423770904541
Epoch: 17, Steps: 154 | Train Loss: 0.329 Vali Loss: 2.953 Vali Acc: 0.536 Test Loss: 2.953 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.4176253
	speed: 0.2168s/iter; left time: 2749.9039s
Epoch: 18 cost time: 10.119088888168335
Epoch: 18, Steps: 154 | Train Loss: 0.333 Vali Loss: 2.893 Vali Acc: 0.531 Test Loss: 2.893 Test Acc: 0.531
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5665044606650446
model parameter : 172814
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2211926
	speed: 0.0760s/iter; left time: 1163.5213s
Epoch: 1 cost time: 10.606134414672852
Epoch: 1, Steps: 154 | Train Loss: 2.065 Vali Loss: 1.897 Vali Acc: 0.396 Test Loss: 1.897 Test Acc: 0.396
Validation loss decreased (inf --> -0.396169).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7855959
	speed: 0.1930s/iter; left time: 2923.1905s
Epoch: 2 cost time: 9.473788261413574
Epoch: 2, Steps: 154 | Train Loss: 1.396 Vali Loss: 1.911 Vali Acc: 0.482 Test Loss: 1.911 Test Acc: 0.482
Validation loss decreased (-0.396169 --> -0.482138).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5141357
	speed: 0.1980s/iter; left time: 2968.9450s
Epoch: 3 cost time: 9.030028581619263
Epoch: 3, Steps: 154 | Train Loss: 1.237 Vali Loss: 1.897 Vali Acc: 0.500 Test Loss: 1.897 Test Acc: 0.500
Validation loss decreased (-0.482138 --> -0.499576).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1272528
	speed: 0.1845s/iter; left time: 2738.1279s
Epoch: 4 cost time: 8.187567472457886
Epoch: 4, Steps: 154 | Train Loss: 1.155 Vali Loss: 1.805 Vali Acc: 0.501 Test Loss: 1.805 Test Acc: 0.501
Validation loss decreased (-0.499576 --> -0.500793).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1805940
	speed: 0.1771s/iter; left time: 2600.2823s
Epoch: 5 cost time: 7.8557655811309814
Epoch: 5, Steps: 154 | Train Loss: 1.081 Vali Loss: 2.205 Vali Acc: 0.412 Test Loss: 2.205 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8551878
	speed: 0.1836s/iter; left time: 2668.1854s
Epoch: 6 cost time: 7.939828634262085
Epoch: 6, Steps: 154 | Train Loss: 1.023 Vali Loss: 1.950 Vali Acc: 0.532 Test Loss: 1.950 Test Acc: 0.532
Validation loss decreased (-0.500793 --> -0.531611).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2442280
	speed: 0.1798s/iter; left time: 2585.2631s
Epoch: 7 cost time: 7.8526952266693115
Epoch: 7, Steps: 154 | Train Loss: 0.922 Vali Loss: 1.848 Vali Acc: 0.485 Test Loss: 1.848 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7670053
	speed: 0.1805s/iter; left time: 2567.5200s
Epoch: 8 cost time: 7.781892776489258
Epoch: 8, Steps: 154 | Train Loss: 0.855 Vali Loss: 1.970 Vali Acc: 0.485 Test Loss: 1.970 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6781009
	speed: 0.1744s/iter; left time: 2453.9826s
Epoch: 9 cost time: 6.900449275970459
Epoch: 9, Steps: 154 | Train Loss: 0.800 Vali Loss: 1.967 Vali Acc: 0.496 Test Loss: 1.967 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3795833
	speed: 0.1721s/iter; left time: 2394.1223s
Epoch: 10 cost time: 7.480711221694946
Epoch: 10, Steps: 154 | Train Loss: 0.731 Vali Loss: 2.031 Vali Acc: 0.504 Test Loss: 2.031 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5266026
	speed: 0.1739s/iter; left time: 2392.8998s
Epoch: 11 cost time: 7.625211477279663
Epoch: 11, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.156 Vali Acc: 0.528 Test Loss: 2.156 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.7939515
	speed: 0.1791s/iter; left time: 2437.6097s
Epoch: 12 cost time: 7.428389072418213
Epoch: 12, Steps: 154 | Train Loss: 0.626 Vali Loss: 2.155 Vali Acc: 0.528 Test Loss: 2.155 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4334952
	speed: 0.1792s/iter; left time: 2410.7811s
Epoch: 13 cost time: 7.554624080657959
Epoch: 13, Steps: 154 | Train Loss: 0.590 Vali Loss: 2.303 Vali Acc: 0.536 Test Loss: 2.303 Test Acc: 0.536
Validation loss decreased (-0.531611 --> -0.536473).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9597214
	speed: 0.1733s/iter; left time: 2304.1032s
Epoch: 14 cost time: 7.427901029586792
Epoch: 14, Steps: 154 | Train Loss: 0.523 Vali Loss: 2.442 Vali Acc: 0.519 Test Loss: 2.442 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1579102
	speed: 0.1774s/iter; left time: 2331.3706s
Epoch: 15 cost time: 8.158041715621948
Epoch: 15, Steps: 154 | Train Loss: 0.493 Vali Loss: 3.063 Vali Acc: 0.463 Test Loss: 3.063 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5721115
	speed: 0.1896s/iter; left time: 2463.6954s
Epoch: 16 cost time: 8.372768640518188
Epoch: 16, Steps: 154 | Train Loss: 0.427 Vali Loss: 2.254 Vali Acc: 0.547 Test Loss: 2.254 Test Acc: 0.547
Validation loss decreased (-0.536473 --> -0.546612).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0620796
	speed: 0.1876s/iter; left time: 2407.7626s
Epoch: 17 cost time: 8.626018524169922
Epoch: 17, Steps: 154 | Train Loss: 0.422 Vali Loss: 2.535 Vali Acc: 0.520 Test Loss: 2.535 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2571626
	speed: 0.1919s/iter; left time: 2433.7943s
Epoch: 18 cost time: 9.356176853179932
Epoch: 18, Steps: 154 | Train Loss: 0.385 Vali Loss: 2.613 Vali Acc: 0.521 Test Loss: 2.613 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4591820
	speed: 0.2032s/iter; left time: 2545.9455s
Epoch: 19 cost time: 9.330446243286133
Epoch: 19, Steps: 154 | Train Loss: 0.334 Vali Loss: 2.549 Vali Acc: 0.509 Test Loss: 2.549 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2948922
	speed: 0.1965s/iter; left time: 2431.3689s
Epoch: 20 cost time: 9.158283472061157
Epoch: 20, Steps: 154 | Train Loss: 0.350 Vali Loss: 2.854 Vali Acc: 0.501 Test Loss: 2.854 Test Acc: 0.501
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.4346966
	speed: 0.2006s/iter; left time: 2451.5910s
Epoch: 21 cost time: 8.639353275299072
Epoch: 21, Steps: 154 | Train Loss: 0.273 Vali Loss: 2.852 Vali Acc: 0.532 Test Loss: 2.852 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.1388824
	speed: 0.1914s/iter; left time: 2309.9734s
Epoch: 22 cost time: 8.90963077545166
Epoch: 22, Steps: 154 | Train Loss: 0.296 Vali Loss: 2.832 Vali Acc: 0.511 Test Loss: 2.832 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.3851297
	speed: 0.1927s/iter; left time: 2296.1758s
Epoch: 23 cost time: 8.675706148147583
Epoch: 23, Steps: 154 | Train Loss: 0.252 Vali Loss: 2.995 Vali Acc: 0.494 Test Loss: 2.995 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.8042774
	speed: 0.1938s/iter; left time: 2279.0542s
Epoch: 24 cost time: 8.621686935424805
Epoch: 24, Steps: 154 | Train Loss: 0.262 Vali Loss: 2.856 Vali Acc: 0.567 Test Loss: 2.856 Test Acc: 0.567
Validation loss decreased (-0.546612 --> -0.566881).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0680064
	speed: 0.1898s/iter; left time: 2203.1167s
Epoch: 25 cost time: 8.95162582397461
Epoch: 25, Steps: 154 | Train Loss: 0.267 Vali Loss: 3.181 Vali Acc: 0.552 Test Loss: 3.181 Test Acc: 0.552
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.2832199
	speed: 0.1919s/iter; left time: 2197.4372s
Epoch: 26 cost time: 9.000246047973633
Epoch: 26, Steps: 154 | Train Loss: 0.215 Vali Loss: 3.098 Vali Acc: 0.540 Test Loss: 3.098 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.2812253
	speed: 0.1941s/iter; left time: 2192.1991s
Epoch: 27 cost time: 8.616273164749146
Epoch: 27, Steps: 154 | Train Loss: 0.228 Vali Loss: 3.125 Vali Acc: 0.491 Test Loss: 3.125 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1196664
	speed: 0.1924s/iter; left time: 2143.8388s
Epoch: 28 cost time: 8.622046947479248
Epoch: 28, Steps: 154 | Train Loss: 0.218 Vali Loss: 3.387 Vali Acc: 0.557 Test Loss: 3.387 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0535039
	speed: 0.1896s/iter; left time: 2083.2337s
Epoch: 29 cost time: 8.499969005584717
Epoch: 29, Steps: 154 | Train Loss: 0.206 Vali Loss: 3.320 Vali Acc: 0.539 Test Loss: 3.320 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.4134636
	speed: 0.1955s/iter; left time: 2118.4196s
Epoch: 30 cost time: 8.596268892288208
Epoch: 30, Steps: 154 | Train Loss: 0.185 Vali Loss: 3.356 Vali Acc: 0.544 Test Loss: 3.356 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0655788
	speed: 0.1845s/iter; left time: 1971.1193s
Epoch: 31 cost time: 8.541597604751587
Epoch: 31, Steps: 154 | Train Loss: 0.188 Vali Loss: 3.503 Vali Acc: 0.566 Test Loss: 3.503 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.2733934
	speed: 0.1887s/iter; left time: 1986.1123s
Epoch: 32 cost time: 8.557504415512085
Epoch: 32, Steps: 154 | Train Loss: 0.199 Vali Loss: 3.400 Vali Acc: 0.525 Test Loss: 3.400 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0520016
	speed: 0.1747s/iter; left time: 1812.5203s
Epoch: 33 cost time: 7.655527591705322
Epoch: 33, Steps: 154 | Train Loss: 0.144 Vali Loss: 3.636 Vali Acc: 0.540 Test Loss: 3.636 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.1812217
	speed: 0.1775s/iter; left time: 1813.7974s
Epoch: 34 cost time: 7.608122825622559
Epoch: 34, Steps: 154 | Train Loss: 0.179 Vali Loss: 3.488 Vali Acc: 0.548 Test Loss: 3.488 Test Acc: 0.548
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5669099756690997
model parameter : 140686
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7189584
	speed: 0.0663s/iter; left time: 1014.8368s
Epoch: 1 cost time: 9.020615339279175
Epoch: 1, Steps: 154 | Train Loss: 2.156 Vali Loss: 1.823 Vali Acc: 0.427 Test Loss: 1.823 Test Acc: 0.427
Validation loss decreased (inf --> -0.426989).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5101762
	speed: 0.1607s/iter; left time: 2434.1259s
Epoch: 2 cost time: 6.543468713760376
Epoch: 2, Steps: 154 | Train Loss: 1.442 Vali Loss: 1.821 Vali Acc: 0.436 Test Loss: 1.821 Test Acc: 0.436
Validation loss decreased (-0.426989 --> -0.435910).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8512042
	speed: 0.1562s/iter; left time: 2341.7389s
Epoch: 3 cost time: 6.8460853099823
Epoch: 3, Steps: 154 | Train Loss: 1.244 Vali Loss: 1.772 Vali Acc: 0.469 Test Loss: 1.772 Test Acc: 0.469
Validation loss decreased (-0.435910 --> -0.469163).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8999820
	speed: 0.1716s/iter; left time: 2546.2389s
Epoch: 4 cost time: 7.537304162979126
Epoch: 4, Steps: 154 | Train Loss: 1.169 Vali Loss: 1.937 Vali Acc: 0.434 Test Loss: 1.937 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8182838
	speed: 0.1663s/iter; left time: 2442.5881s
Epoch: 5 cost time: 7.235029935836792
Epoch: 5, Steps: 154 | Train Loss: 1.076 Vali Loss: 1.858 Vali Acc: 0.481 Test Loss: 1.858 Test Acc: 0.481
Validation loss decreased (-0.469163 --> -0.480922).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3709927
	speed: 0.1779s/iter; left time: 2585.4340s
Epoch: 6 cost time: 7.964024782180786
Epoch: 6, Steps: 154 | Train Loss: 1.047 Vali Loss: 2.234 Vali Acc: 0.457 Test Loss: 2.234 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6994942
	speed: 0.1790s/iter; left time: 2573.4767s
Epoch: 7 cost time: 8.630261182785034
Epoch: 7, Steps: 154 | Train Loss: 0.955 Vali Loss: 1.834 Vali Acc: 0.528 Test Loss: 1.834 Test Acc: 0.528
Validation loss decreased (-0.480922 --> -0.527557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8262593
	speed: 0.1861s/iter; left time: 2646.8886s
Epoch: 8 cost time: 8.204238891601562
Epoch: 8, Steps: 154 | Train Loss: 0.917 Vali Loss: 1.736 Vali Acc: 0.524 Test Loss: 1.736 Test Acc: 0.524
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5005387
	speed: 0.1892s/iter; left time: 2661.9488s
Epoch: 9 cost time: 8.95993185043335
Epoch: 9, Steps: 154 | Train Loss: 0.821 Vali Loss: 1.979 Vali Acc: 0.496 Test Loss: 1.979 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.4757160
	speed: 0.1957s/iter; left time: 2723.1671s
Epoch: 10 cost time: 9.436844825744629
Epoch: 10, Steps: 154 | Train Loss: 0.799 Vali Loss: 2.067 Vali Acc: 0.498 Test Loss: 2.067 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6153792
	speed: 0.2022s/iter; left time: 2782.8583s
Epoch: 11 cost time: 9.363093614578247
Epoch: 11, Steps: 154 | Train Loss: 0.722 Vali Loss: 2.251 Vali Acc: 0.499 Test Loss: 2.251 Test Acc: 0.499
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.4984573
	speed: 0.1883s/iter; left time: 2561.9371s
Epoch: 12 cost time: 8.777504682540894
Epoch: 12, Steps: 154 | Train Loss: 0.662 Vali Loss: 2.248 Vali Acc: 0.514 Test Loss: 2.248 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.4740020
	speed: 0.1903s/iter; left time: 2560.2565s
Epoch: 13 cost time: 8.32424259185791
Epoch: 13, Steps: 154 | Train Loss: 0.616 Vali Loss: 2.416 Vali Acc: 0.521 Test Loss: 2.416 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.4422779
	speed: 0.1805s/iter; left time: 2400.2466s
Epoch: 14 cost time: 8.329743385314941
Epoch: 14, Steps: 154 | Train Loss: 0.553 Vali Loss: 2.299 Vali Acc: 0.470 Test Loss: 2.299 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.5702647
	speed: 0.1875s/iter; left time: 2464.4040s
Epoch: 15 cost time: 7.942724227905273
Epoch: 15, Steps: 154 | Train Loss: 0.506 Vali Loss: 2.574 Vali Acc: 0.537 Test Loss: 2.574 Test Acc: 0.537
Validation loss decreased (-0.527557 --> -0.536876).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6616147
	speed: 0.1802s/iter; left time: 2340.5846s
Epoch: 16 cost time: 8.410338640213013
Epoch: 16, Steps: 154 | Train Loss: 0.485 Vali Loss: 2.348 Vali Acc: 0.481 Test Loss: 2.348 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.5473926
	speed: 0.1917s/iter; left time: 2460.3905s
Epoch: 17 cost time: 8.578778505325317
Epoch: 17, Steps: 154 | Train Loss: 0.451 Vali Loss: 2.409 Vali Acc: 0.542 Test Loss: 2.409 Test Acc: 0.542
Validation loss decreased (-0.536876 --> -0.541744).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4073541
	speed: 0.1828s/iter; left time: 2318.8344s
Epoch: 18 cost time: 7.830675840377808
Epoch: 18, Steps: 154 | Train Loss: 0.420 Vali Loss: 2.360 Vali Acc: 0.549 Test Loss: 2.360 Test Acc: 0.549
Validation loss decreased (-0.541744 --> -0.549044).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0334502
	speed: 0.1802s/iter; left time: 2257.9206s
Epoch: 19 cost time: 8.498034954071045
Epoch: 19, Steps: 154 | Train Loss: 0.390 Vali Loss: 2.587 Vali Acc: 0.531 Test Loss: 2.587 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.2011255
	speed: 0.1867s/iter; left time: 2310.6760s
Epoch: 20 cost time: 8.301928043365479
Epoch: 20, Steps: 154 | Train Loss: 0.389 Vali Loss: 2.743 Vali Acc: 0.519 Test Loss: 2.743 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.5695714
	speed: 0.1854s/iter; left time: 2266.3348s
Epoch: 21 cost time: 8.130529165267944
Epoch: 21, Steps: 154 | Train Loss: 0.350 Vali Loss: 2.608 Vali Acc: 0.533 Test Loss: 2.608 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0581249
	speed: 0.1754s/iter; left time: 2117.0159s
Epoch: 22 cost time: 7.567664623260498
Epoch: 22, Steps: 154 | Train Loss: 0.318 Vali Loss: 2.658 Vali Acc: 0.520 Test Loss: 2.658 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0374260
	speed: 0.1740s/iter; left time: 2072.5419s
Epoch: 23 cost time: 8.30636477470398
Epoch: 23, Steps: 154 | Train Loss: 0.305 Vali Loss: 2.636 Vali Acc: 0.549 Test Loss: 2.636 Test Acc: 0.549
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1550378
	speed: 0.1793s/iter; left time: 2108.2470s
Epoch: 24 cost time: 7.686403036117554
Epoch: 24, Steps: 154 | Train Loss: 0.257 Vali Loss: 2.785 Vali Acc: 0.536 Test Loss: 2.785 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.3641486
	speed: 0.1701s/iter; left time: 1973.8299s
Epoch: 25 cost time: 7.915166139602661
Epoch: 25, Steps: 154 | Train Loss: 0.267 Vali Loss: 3.055 Vali Acc: 0.525 Test Loss: 3.055 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1645104
	speed: 0.1679s/iter; left time: 1922.8162s
Epoch: 26 cost time: 7.236980676651001
Epoch: 26, Steps: 154 | Train Loss: 0.221 Vali Loss: 2.933 Vali Acc: 0.533 Test Loss: 2.933 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0970747
	speed: 0.1642s/iter; left time: 1855.1938s
Epoch: 27 cost time: 7.430933952331543
Epoch: 27, Steps: 154 | Train Loss: 0.234 Vali Loss: 2.892 Vali Acc: 0.550 Test Loss: 2.892 Test Acc: 0.550
Validation loss decreased (-0.549044 --> -0.550255).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0877993
	speed: 0.1644s/iter; left time: 1832.3918s
Epoch: 28 cost time: 6.827779054641724
Epoch: 28, Steps: 154 | Train Loss: 0.199 Vali Loss: 2.818 Vali Acc: 0.538 Test Loss: 2.818 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.2094988
	speed: 0.1658s/iter; left time: 1821.6158s
Epoch: 29 cost time: 7.285429239273071
Epoch: 29, Steps: 154 | Train Loss: 0.212 Vali Loss: 3.096 Vali Acc: 0.530 Test Loss: 3.096 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.6757155
	speed: 0.1688s/iter; left time: 1828.5142s
Epoch: 30 cost time: 7.314351320266724
Epoch: 30, Steps: 154 | Train Loss: 0.204 Vali Loss: 3.129 Vali Acc: 0.520 Test Loss: 3.129 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.1691229
	speed: 0.1613s/iter; left time: 1723.1808s
Epoch: 31 cost time: 6.531174182891846
Epoch: 31, Steps: 154 | Train Loss: 0.197 Vali Loss: 3.166 Vali Acc: 0.561 Test Loss: 3.166 Test Acc: 0.561
Validation loss decreased (-0.550255 --> -0.560796).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.2365384
	speed: 0.1629s/iter; left time: 1714.6425s
Epoch: 32 cost time: 7.2490315437316895
Epoch: 32, Steps: 154 | Train Loss: 0.209 Vali Loss: 3.435 Vali Acc: 0.500 Test Loss: 3.435 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.2526380
	speed: 0.1656s/iter; left time: 1718.2683s
Epoch: 33 cost time: 7.237651348114014
Epoch: 33, Steps: 154 | Train Loss: 0.183 Vali Loss: 3.081 Vali Acc: 0.540 Test Loss: 3.081 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.4187193
	speed: 0.1663s/iter; left time: 1699.3886s
Epoch: 34 cost time: 7.521721601486206
Epoch: 34, Steps: 154 | Train Loss: 0.207 Vali Loss: 3.339 Vali Acc: 0.539 Test Loss: 3.339 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0302529
	speed: 0.1731s/iter; left time: 1741.7686s
Epoch: 35 cost time: 7.19366192817688
Epoch: 35, Steps: 154 | Train Loss: 0.171 Vali Loss: 3.286 Vali Acc: 0.518 Test Loss: 3.286 Test Acc: 0.518
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0209867
	speed: 0.1737s/iter; left time: 1721.1598s
Epoch: 36 cost time: 7.424327373504639
Epoch: 36, Steps: 154 | Train Loss: 0.156 Vali Loss: 3.655 Vali Acc: 0.471 Test Loss: 3.655 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0129881
	speed: 0.1750s/iter; left time: 1707.7904s
Epoch: 37 cost time: 8.427057266235352
Epoch: 37, Steps: 154 | Train Loss: 0.162 Vali Loss: 3.341 Vali Acc: 0.530 Test Loss: 3.341 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.1862170
	speed: 0.1808s/iter; left time: 1736.0148s
Epoch: 38 cost time: 7.47191858291626
Epoch: 38, Steps: 154 | Train Loss: 0.172 Vali Loss: 3.561 Vali Acc: 0.541 Test Loss: 3.561 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.1601582
	speed: 0.1799s/iter; left time: 1700.0138s
Epoch: 39 cost time: 8.523285150527954
Epoch: 39, Steps: 154 | Train Loss: 0.153 Vali Loss: 3.525 Vali Acc: 0.548 Test Loss: 3.525 Test Acc: 0.548
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0332247
	speed: 0.1853s/iter; left time: 1722.1861s
Epoch: 40 cost time: 8.205026626586914
Epoch: 40, Steps: 154 | Train Loss: 0.160 Vali Loss: 3.635 Vali Acc: 0.546 Test Loss: 3.635 Test Acc: 0.546
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.1354255
	speed: 0.1843s/iter; left time: 1684.8187s
Epoch: 41 cost time: 8.500332355499268
Epoch: 41, Steps: 154 | Train Loss: 0.151 Vali Loss: 3.548 Vali Acc: 0.549 Test Loss: 3.548 Test Acc: 0.549
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5608272506082725
model parameter : 124686
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1126034
	speed: 0.0631s/iter; left time: 965.9420s
Epoch: 1 cost time: 9.128903150558472
Epoch: 1, Steps: 154 | Train Loss: 2.193 Vali Loss: 1.909 Vali Acc: 0.406 Test Loss: 1.909 Test Acc: 0.406
Validation loss decreased (inf --> -0.406307).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5634700
	speed: 0.1857s/iter; left time: 2813.5303s
Epoch: 2 cost time: 8.145379781723022
Epoch: 2, Steps: 154 | Train Loss: 1.506 Vali Loss: 1.731 Vali Acc: 0.484 Test Loss: 1.731 Test Acc: 0.484
Validation loss decreased (-0.406307 --> -0.484168).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5148739
	speed: 0.1700s/iter; left time: 2549.1919s
Epoch: 3 cost time: 7.221197605133057
Epoch: 3, Steps: 154 | Train Loss: 1.275 Vali Loss: 1.881 Vali Acc: 0.479 Test Loss: 1.881 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4080887
	speed: 0.1772s/iter; left time: 2629.3704s
Epoch: 4 cost time: 7.826422691345215
Epoch: 4, Steps: 154 | Train Loss: 1.176 Vali Loss: 1.655 Vali Acc: 0.497 Test Loss: 1.655 Test Acc: 0.497
Validation loss decreased (-0.484168 --> -0.496739).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1834499
	speed: 0.1763s/iter; left time: 2589.0084s
Epoch: 5 cost time: 7.867002487182617
Epoch: 5, Steps: 154 | Train Loss: 1.106 Vali Loss: 1.907 Vali Acc: 0.468 Test Loss: 1.907 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3020045
	speed: 0.1791s/iter; left time: 2602.8012s
Epoch: 6 cost time: 7.899857759475708
Epoch: 6, Steps: 154 | Train Loss: 1.034 Vali Loss: 1.678 Vali Acc: 0.512 Test Loss: 1.678 Test Acc: 0.512
Validation loss decreased (-0.496739 --> -0.512149).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2766668
	speed: 0.1710s/iter; left time: 2459.0181s
Epoch: 7 cost time: 7.783510208129883
Epoch: 7, Steps: 154 | Train Loss: 0.982 Vali Loss: 1.921 Vali Acc: 0.477 Test Loss: 1.921 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5380967
	speed: 0.1751s/iter; left time: 2490.1243s
Epoch: 8 cost time: 7.7736358642578125
Epoch: 8, Steps: 154 | Train Loss: 0.931 Vali Loss: 1.931 Vali Acc: 0.482 Test Loss: 1.931 Test Acc: 0.482
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5121028
	speed: 0.1641s/iter; left time: 2309.1652s
Epoch: 9 cost time: 7.4151387214660645
Epoch: 9, Steps: 154 | Train Loss: 0.882 Vali Loss: 2.075 Vali Acc: 0.511 Test Loss: 2.075 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1689902
	speed: 0.1737s/iter; left time: 2416.4685s
Epoch: 10 cost time: 7.980549335479736
Epoch: 10, Steps: 154 | Train Loss: 0.816 Vali Loss: 1.798 Vali Acc: 0.522 Test Loss: 1.798 Test Acc: 0.522
Validation loss decreased (-0.512149 --> -0.521880).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5155883
	speed: 0.1686s/iter; left time: 2319.4358s
Epoch: 11 cost time: 6.116574764251709
Epoch: 11, Steps: 154 | Train Loss: 0.759 Vali Loss: 1.956 Vali Acc: 0.481 Test Loss: 1.956 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1618539
	speed: 0.1499s/iter; left time: 2039.6601s
Epoch: 12 cost time: 6.453291416168213
Epoch: 12, Steps: 154 | Train Loss: 0.717 Vali Loss: 1.764 Vali Acc: 0.548 Test Loss: 1.764 Test Acc: 0.548
Validation loss decreased (-0.521880 --> -0.548239).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5526669
	speed: 0.1540s/iter; left time: 2072.1473s
Epoch: 13 cost time: 6.743362188339233
Epoch: 13, Steps: 154 | Train Loss: 0.639 Vali Loss: 2.076 Vali Acc: 0.465 Test Loss: 2.076 Test Acc: 0.465
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5598377
	speed: 0.1566s/iter; left time: 2082.4889s
Epoch: 14 cost time: 6.6032843589782715
Epoch: 14, Steps: 154 | Train Loss: 0.610 Vali Loss: 1.946 Vali Acc: 0.494 Test Loss: 1.946 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4779353
	speed: 0.1570s/iter; left time: 2064.0202s
Epoch: 15 cost time: 6.56745457649231
Epoch: 15, Steps: 154 | Train Loss: 0.567 Vali Loss: 2.006 Vali Acc: 0.525 Test Loss: 2.006 Test Acc: 0.525
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4369740
	speed: 0.1544s/iter; left time: 2005.5622s
Epoch: 16 cost time: 6.856403112411499
Epoch: 16, Steps: 154 | Train Loss: 0.526 Vali Loss: 1.976 Vali Acc: 0.524 Test Loss: 1.976 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.7427980
	speed: 0.1644s/iter; left time: 2110.9124s
Epoch: 17 cost time: 6.999370574951172
Epoch: 17, Steps: 154 | Train Loss: 0.499 Vali Loss: 2.369 Vali Acc: 0.496 Test Loss: 2.369 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3264806
	speed: 0.1640s/iter; left time: 2079.5971s
Epoch: 18 cost time: 7.122206926345825
Epoch: 18, Steps: 154 | Train Loss: 0.444 Vali Loss: 2.223 Vali Acc: 0.528 Test Loss: 2.223 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2693712
	speed: 0.1592s/iter; left time: 1994.0934s
Epoch: 19 cost time: 6.492400884628296
Epoch: 19, Steps: 154 | Train Loss: 0.418 Vali Loss: 2.420 Vali Acc: 0.479 Test Loss: 2.420 Test Acc: 0.479
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.4593082
	speed: 0.1633s/iter; left time: 2021.1515s
Epoch: 20 cost time: 6.84140944480896
Epoch: 20, Steps: 154 | Train Loss: 0.405 Vali Loss: 2.398 Vali Acc: 0.502 Test Loss: 2.398 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1824701
	speed: 0.1607s/iter; left time: 1963.7638s
Epoch: 21 cost time: 6.690542459487915
Epoch: 21, Steps: 154 | Train Loss: 0.385 Vali Loss: 2.487 Vali Acc: 0.469 Test Loss: 2.487 Test Acc: 0.469
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2722559
	speed: 0.1670s/iter; left time: 2014.7041s
Epoch: 22 cost time: 7.2260942459106445
Epoch: 22, Steps: 154 | Train Loss: 0.336 Vali Loss: 2.682 Vali Acc: 0.480 Test Loss: 2.682 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm64_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5482562854825629
model parameter : 113998
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9549754
	speed: 0.0659s/iter; left time: 1008.7121s
Epoch: 1 cost time: 9.22411823272705
Epoch: 1, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.135 Vali Acc: 0.427 Test Loss: 2.135 Test Acc: 0.427
Validation loss decreased (inf --> -0.426986).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5383022
	speed: 0.1758s/iter; left time: 2663.4583s
Epoch: 2 cost time: 8.00609016418457
Epoch: 2, Steps: 154 | Train Loss: 1.391 Vali Loss: 1.784 Vali Acc: 0.504 Test Loss: 1.784 Test Acc: 0.504
Validation loss decreased (-0.426986 --> -0.504443).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8837429
	speed: 0.1743s/iter; left time: 2613.9029s
Epoch: 3 cost time: 7.795103311538696
Epoch: 3, Steps: 154 | Train Loss: 1.196 Vali Loss: 1.985 Vali Acc: 0.466 Test Loss: 1.985 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7507955
	speed: 0.1697s/iter; left time: 2518.7163s
Epoch: 4 cost time: 7.924348831176758
Epoch: 4, Steps: 154 | Train Loss: 1.093 Vali Loss: 1.949 Vali Acc: 0.475 Test Loss: 1.949 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.6570608
	speed: 0.1733s/iter; left time: 2545.4651s
Epoch: 5 cost time: 7.694706678390503
Epoch: 5, Steps: 154 | Train Loss: 0.993 Vali Loss: 1.997 Vali Acc: 0.497 Test Loss: 1.997 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1652811
	speed: 0.1643s/iter; left time: 2387.7987s
Epoch: 6 cost time: 7.550968408584595
Epoch: 6, Steps: 154 | Train Loss: 0.916 Vali Loss: 1.903 Vali Acc: 0.472 Test Loss: 1.903 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.5230623
	speed: 0.1723s/iter; left time: 2477.1983s
Epoch: 7 cost time: 7.6675803661346436
Epoch: 7, Steps: 154 | Train Loss: 0.824 Vali Loss: 2.087 Vali Acc: 0.512 Test Loss: 2.087 Test Acc: 0.512
Validation loss decreased (-0.504443 --> -0.511739).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9901363
	speed: 0.1689s/iter; left time: 2402.8756s
Epoch: 8 cost time: 7.679097890853882
Epoch: 8, Steps: 154 | Train Loss: 0.715 Vali Loss: 2.015 Vali Acc: 0.492 Test Loss: 2.015 Test Acc: 0.492
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4680076
	speed: 0.1759s/iter; left time: 2475.2720s
Epoch: 9 cost time: 7.916314601898193
Epoch: 9, Steps: 154 | Train Loss: 0.626 Vali Loss: 2.490 Vali Acc: 0.497 Test Loss: 2.490 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0606561
	speed: 0.1662s/iter; left time: 2313.2637s
Epoch: 10 cost time: 7.669257879257202
Epoch: 10, Steps: 154 | Train Loss: 0.604 Vali Loss: 2.336 Vali Acc: 0.460 Test Loss: 2.336 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.2906399
	speed: 0.1738s/iter; left time: 2392.1069s
Epoch: 11 cost time: 7.049148797988892
Epoch: 11, Steps: 154 | Train Loss: 0.564 Vali Loss: 2.418 Vali Acc: 0.464 Test Loss: 2.418 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.7755632
	speed: 0.1726s/iter; left time: 2349.1546s
Epoch: 12 cost time: 8.038661241531372
Epoch: 12, Steps: 154 | Train Loss: 0.492 Vali Loss: 2.588 Vali Acc: 0.507 Test Loss: 2.588 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.1562814
	speed: 0.1703s/iter; left time: 2291.5843s
Epoch: 13 cost time: 7.029222249984741
Epoch: 13, Steps: 154 | Train Loss: 0.482 Vali Loss: 2.695 Vali Acc: 0.480 Test Loss: 2.695 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5305857
	speed: 0.1650s/iter; left time: 2193.8288s
Epoch: 14 cost time: 7.714385032653809
Epoch: 14, Steps: 154 | Train Loss: 0.410 Vali Loss: 2.878 Vali Acc: 0.513 Test Loss: 2.878 Test Acc: 0.513
Validation loss decreased (-0.511739 --> -0.512948).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1285531
	speed: 0.1580s/iter; left time: 2077.5444s
Epoch: 15 cost time: 6.648748159408569
Epoch: 15, Steps: 154 | Train Loss: 0.432 Vali Loss: 2.557 Vali Acc: 0.480 Test Loss: 2.557 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1700057
	speed: 0.1532s/iter; left time: 1989.6467s
Epoch: 16 cost time: 6.366244077682495
Epoch: 16, Steps: 154 | Train Loss: 0.350 Vali Loss: 2.841 Vali Acc: 0.463 Test Loss: 2.841 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5335570
	speed: 0.1549s/iter; left time: 1988.9957s
Epoch: 17 cost time: 6.7146689891815186
Epoch: 17, Steps: 154 | Train Loss: 0.341 Vali Loss: 3.278 Vali Acc: 0.436 Test Loss: 3.278 Test Acc: 0.436
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4668259
	speed: 0.1512s/iter; left time: 1917.9155s
Epoch: 18 cost time: 6.2296671867370605
Epoch: 18, Steps: 154 | Train Loss: 0.331 Vali Loss: 3.367 Vali Acc: 0.496 Test Loss: 3.367 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0568280
	speed: 0.1586s/iter; left time: 1987.6101s
Epoch: 19 cost time: 6.740193843841553
Epoch: 19, Steps: 154 | Train Loss: 0.323 Vali Loss: 3.199 Vali Acc: 0.433 Test Loss: 3.199 Test Acc: 0.433
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3805358
	speed: 0.1513s/iter; left time: 1872.0415s
Epoch: 20 cost time: 6.357228517532349
Epoch: 20, Steps: 154 | Train Loss: 0.281 Vali Loss: 3.248 Vali Acc: 0.454 Test Loss: 3.248 Test Acc: 0.454
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.4421095
	speed: 0.1530s/iter; left time: 1869.2891s
Epoch: 21 cost time: 6.13362193107605
Epoch: 21, Steps: 154 | Train Loss: 0.247 Vali Loss: 3.312 Vali Acc: 0.517 Test Loss: 3.312 Test Acc: 0.517
Validation loss decreased (-0.512948 --> -0.516593).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1755010
	speed: 0.1590s/iter; left time: 1918.2243s
Epoch: 22 cost time: 7.535989761352539
Epoch: 22, Steps: 154 | Train Loss: 0.270 Vali Loss: 3.244 Vali Acc: 0.496 Test Loss: 3.244 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.2609410
	speed: 0.1622s/iter; left time: 1932.5458s
Epoch: 23 cost time: 7.120711326599121
Epoch: 23, Steps: 154 | Train Loss: 0.205 Vali Loss: 3.631 Vali Acc: 0.449 Test Loss: 3.631 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0588925
	speed: 0.1660s/iter; left time: 1952.1592s
Epoch: 24 cost time: 7.047366619110107
Epoch: 24, Steps: 154 | Train Loss: 0.201 Vali Loss: 3.500 Vali Acc: 0.515 Test Loss: 3.500 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0429693
	speed: 0.1570s/iter; left time: 1821.4861s
Epoch: 25 cost time: 7.574236869812012
Epoch: 25, Steps: 154 | Train Loss: 0.218 Vali Loss: 3.988 Vali Acc: 0.401 Test Loss: 3.988 Test Acc: 0.401
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0087145
	speed: 0.1749s/iter; left time: 2002.6403s
Epoch: 26 cost time: 8.29478931427002
Epoch: 26, Steps: 154 | Train Loss: 0.234 Vali Loss: 4.018 Vali Acc: 0.462 Test Loss: 4.018 Test Acc: 0.462
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.5286349
	speed: 0.1853s/iter; left time: 2093.0105s
Epoch: 27 cost time: 8.793331623077393
Epoch: 27, Steps: 154 | Train Loss: 0.214 Vali Loss: 3.731 Vali Acc: 0.473 Test Loss: 3.731 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.2103762
	speed: 0.1829s/iter; left time: 2038.1199s
Epoch: 28 cost time: 8.56641435623169
Epoch: 28, Steps: 154 | Train Loss: 0.175 Vali Loss: 3.953 Vali Acc: 0.460 Test Loss: 3.953 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0361900
	speed: 0.1729s/iter; left time: 1899.6686s
Epoch: 29 cost time: 7.743205785751343
Epoch: 29, Steps: 154 | Train Loss: 0.179 Vali Loss: 3.858 Vali Acc: 0.504 Test Loss: 3.858 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.1381206
	speed: 0.1763s/iter; left time: 1910.3671s
Epoch: 30 cost time: 8.299493312835693
Epoch: 30, Steps: 154 | Train Loss: 0.195 Vali Loss: 3.877 Vali Acc: 0.448 Test Loss: 3.877 Test Acc: 0.448
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0694640
	speed: 0.1701s/iter; left time: 1816.4645s
Epoch: 31 cost time: 7.483280420303345
Epoch: 31, Steps: 154 | Train Loss: 0.161 Vali Loss: 4.168 Vali Acc: 0.457 Test Loss: 4.168 Test Acc: 0.457
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5166261151662611
model parameter : 159982
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0760121
	speed: 0.0620s/iter; left time: 949.3909s
Epoch: 1 cost time: 8.622581481933594
Epoch: 1, Steps: 154 | Train Loss: 2.100 Vali Loss: 1.869 Vali Acc: 0.418 Test Loss: 1.869 Test Acc: 0.418
Validation loss decreased (inf --> -0.418067).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1840562
	speed: 0.1701s/iter; left time: 2576.5845s
Epoch: 2 cost time: 7.647949457168579
Epoch: 2, Steps: 154 | Train Loss: 1.415 Vali Loss: 1.800 Vali Acc: 0.466 Test Loss: 1.800 Test Acc: 0.466
Validation loss decreased (-0.418067 --> -0.466324).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8654125
	speed: 0.1691s/iter; left time: 2535.3540s
Epoch: 3 cost time: 7.705862045288086
Epoch: 3, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.164 Vali Acc: 0.391 Test Loss: 2.164 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0117693
	speed: 0.1638s/iter; left time: 2430.8511s
Epoch: 4 cost time: 7.190545558929443
Epoch: 4, Steps: 154 | Train Loss: 1.135 Vali Loss: 1.757 Vali Acc: 0.464 Test Loss: 1.757 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.5097788
	speed: 0.1693s/iter; left time: 2485.7575s
Epoch: 5 cost time: 7.7785484790802
Epoch: 5, Steps: 154 | Train Loss: 1.053 Vali Loss: 1.753 Vali Acc: 0.509 Test Loss: 1.753 Test Acc: 0.509
Validation loss decreased (-0.466324 --> -0.508904).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1333354
	speed: 0.1672s/iter; left time: 2429.9286s
Epoch: 6 cost time: 6.6922502517700195
Epoch: 6, Steps: 154 | Train Loss: 0.953 Vali Loss: 1.606 Vali Acc: 0.505 Test Loss: 1.606 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8866612
	speed: 0.1620s/iter; left time: 2328.3660s
Epoch: 7 cost time: 7.25890588760376
Epoch: 7, Steps: 154 | Train Loss: 0.917 Vali Loss: 1.736 Vali Acc: 0.536 Test Loss: 1.736 Test Acc: 0.536
Validation loss decreased (-0.508904 --> -0.536073).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5857444
	speed: 0.1679s/iter; left time: 2387.9366s
Epoch: 8 cost time: 7.573592185974121
Epoch: 8, Steps: 154 | Train Loss: 0.845 Vali Loss: 1.958 Vali Acc: 0.492 Test Loss: 1.958 Test Acc: 0.492
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6770424
	speed: 0.1645s/iter; left time: 2313.8966s
Epoch: 9 cost time: 6.831857681274414
Epoch: 9, Steps: 154 | Train Loss: 0.765 Vali Loss: 1.917 Vali Acc: 0.485 Test Loss: 1.917 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6197869
	speed: 0.1507s/iter; left time: 2097.0088s
Epoch: 10 cost time: 6.609102249145508
Epoch: 10, Steps: 154 | Train Loss: 0.734 Vali Loss: 2.028 Vali Acc: 0.505 Test Loss: 2.028 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5551673
	speed: 0.1529s/iter; left time: 2103.4043s
Epoch: 11 cost time: 6.7796950340271
Epoch: 11, Steps: 154 | Train Loss: 0.660 Vali Loss: 1.795 Vali Acc: 0.566 Test Loss: 1.795 Test Acc: 0.566
Validation loss decreased (-0.536073 --> -0.566081).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9915604
	speed: 0.1603s/iter; left time: 2181.7582s
Epoch: 12 cost time: 6.588554620742798
Epoch: 12, Steps: 154 | Train Loss: 0.639 Vali Loss: 2.161 Vali Acc: 0.494 Test Loss: 2.161 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1204512
	speed: 0.1560s/iter; left time: 2099.1672s
Epoch: 13 cost time: 6.820271968841553
Epoch: 13, Steps: 154 | Train Loss: 0.574 Vali Loss: 1.989 Vali Acc: 0.511 Test Loss: 1.989 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.5958019
	speed: 0.1649s/iter; left time: 2193.5777s
Epoch: 14 cost time: 7.007517337799072
Epoch: 14, Steps: 154 | Train Loss: 0.519 Vali Loss: 2.136 Vali Acc: 0.495 Test Loss: 2.136 Test Acc: 0.495
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5148641
	speed: 0.1572s/iter; left time: 2066.4353s
Epoch: 15 cost time: 6.886600017547607
Epoch: 15, Steps: 154 | Train Loss: 0.514 Vali Loss: 2.265 Vali Acc: 0.488 Test Loss: 2.265 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5311873
	speed: 0.1650s/iter; left time: 2143.5544s
Epoch: 16 cost time: 7.321425199508667
Epoch: 16, Steps: 154 | Train Loss: 0.457 Vali Loss: 2.575 Vali Acc: 0.509 Test Loss: 2.575 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0643121
	speed: 0.1617s/iter; left time: 2076.0748s
Epoch: 17 cost time: 7.173585653305054
Epoch: 17, Steps: 154 | Train Loss: 0.427 Vali Loss: 2.774 Vali Acc: 0.481 Test Loss: 2.774 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8490041
	speed: 0.1584s/iter; left time: 2008.4669s
Epoch: 18 cost time: 6.727588415145874
Epoch: 18, Steps: 154 | Train Loss: 0.413 Vali Loss: 2.653 Vali Acc: 0.498 Test Loss: 2.653 Test Acc: 0.498
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.5524201
	speed: 0.1636s/iter; left time: 2049.8598s
Epoch: 19 cost time: 7.249773025512695
Epoch: 19, Steps: 154 | Train Loss: 0.391 Vali Loss: 2.481 Vali Acc: 0.491 Test Loss: 2.481 Test Acc: 0.491
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.7310638
	speed: 0.1549s/iter; left time: 1916.7608s
Epoch: 20 cost time: 6.358473062515259
Epoch: 20, Steps: 154 | Train Loss: 0.358 Vali Loss: 2.437 Vali Acc: 0.524 Test Loss: 2.437 Test Acc: 0.524
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0906358
	speed: 0.1701s/iter; left time: 2078.3595s
Epoch: 21 cost time: 8.021122217178345
Epoch: 21, Steps: 154 | Train Loss: 0.347 Vali Loss: 2.534 Vali Acc: 0.535 Test Loss: 2.534 Test Acc: 0.535
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5660989456609895
model parameter : 111630
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5116354
	speed: 0.0624s/iter; left time: 954.7573s
Epoch: 1 cost time: 8.82831621170044
Epoch: 1, Steps: 154 | Train Loss: 2.038 Vali Loss: 1.995 Vali Acc: 0.391 Test Loss: 1.995 Test Acc: 0.391
Validation loss decreased (inf --> -0.390897).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0579334
	speed: 0.1714s/iter; left time: 2595.7681s
Epoch: 2 cost time: 7.725891351699829
Epoch: 2, Steps: 154 | Train Loss: 1.375 Vali Loss: 1.875 Vali Acc: 0.460 Test Loss: 1.875 Test Acc: 0.460
Validation loss decreased (-0.390897 --> -0.459835).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1661292
	speed: 0.1710s/iter; left time: 2563.3926s
Epoch: 3 cost time: 7.864313840866089
Epoch: 3, Steps: 154 | Train Loss: 1.216 Vali Loss: 1.790 Vali Acc: 0.480 Test Loss: 1.790 Test Acc: 0.480
Validation loss decreased (-0.459835 --> -0.479706).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3263935
	speed: 0.1655s/iter; left time: 2455.3767s
Epoch: 4 cost time: 7.146056890487671
Epoch: 4, Steps: 154 | Train Loss: 1.140 Vali Loss: 1.848 Vali Acc: 0.489 Test Loss: 1.848 Test Acc: 0.489
Validation loss decreased (-0.479706 --> -0.488627).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0803818
	speed: 0.1650s/iter; left time: 2423.3727s
Epoch: 5 cost time: 7.4089109897613525
Epoch: 5, Steps: 154 | Train Loss: 1.023 Vali Loss: 1.653 Vali Acc: 0.532 Test Loss: 1.653 Test Acc: 0.532
Validation loss decreased (-0.488627 --> -0.532425).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1418167
	speed: 0.1674s/iter; left time: 2433.0367s
Epoch: 6 cost time: 7.321413040161133
Epoch: 6, Steps: 154 | Train Loss: 0.957 Vali Loss: 1.943 Vali Acc: 0.496 Test Loss: 1.943 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5986388
	speed: 0.1746s/iter; left time: 2510.5757s
Epoch: 7 cost time: 7.661539554595947
Epoch: 7, Steps: 154 | Train Loss: 0.898 Vali Loss: 1.979 Vali Acc: 0.495 Test Loss: 1.979 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6737373
	speed: 0.1766s/iter; left time: 2511.5614s
Epoch: 8 cost time: 7.796080112457275
Epoch: 8, Steps: 154 | Train Loss: 0.835 Vali Loss: 1.745 Vali Acc: 0.539 Test Loss: 1.745 Test Acc: 0.539
Validation loss decreased (-0.532425 --> -0.538506).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9348161
	speed: 0.1750s/iter; left time: 2462.6799s
Epoch: 9 cost time: 7.272768020629883
Epoch: 9, Steps: 154 | Train Loss: 0.769 Vali Loss: 1.927 Vali Acc: 0.474 Test Loss: 1.927 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.7099611
	speed: 0.1721s/iter; left time: 2394.7730s
Epoch: 10 cost time: 7.914799928665161
Epoch: 10, Steps: 154 | Train Loss: 0.723 Vali Loss: 2.008 Vali Acc: 0.526 Test Loss: 2.008 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.5753629
	speed: 0.1795s/iter; left time: 2469.8977s
Epoch: 11 cost time: 7.7450032234191895
Epoch: 11, Steps: 154 | Train Loss: 0.675 Vali Loss: 2.093 Vali Acc: 0.489 Test Loss: 2.093 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.7658668
	speed: 0.1718s/iter; left time: 2337.6461s
Epoch: 12 cost time: 7.563165903091431
Epoch: 12, Steps: 154 | Train Loss: 0.593 Vali Loss: 1.961 Vali Acc: 0.503 Test Loss: 1.961 Test Acc: 0.503
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1673130
	speed: 0.1776s/iter; left time: 2389.0867s
Epoch: 13 cost time: 7.732210397720337
Epoch: 13, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.057 Vali Acc: 0.534 Test Loss: 2.057 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7938230
	speed: 0.1660s/iter; left time: 2207.1773s
Epoch: 14 cost time: 6.799408674240112
Epoch: 14, Steps: 154 | Train Loss: 0.503 Vali Loss: 2.191 Vali Acc: 0.484 Test Loss: 2.191 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6225731
	speed: 0.1456s/iter; left time: 1913.9871s
Epoch: 15 cost time: 6.230309009552002
Epoch: 15, Steps: 154 | Train Loss: 0.468 Vali Loss: 2.074 Vali Acc: 0.549 Test Loss: 2.074 Test Acc: 0.549
Validation loss decreased (-0.538506 --> -0.549047).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4257613
	speed: 0.1512s/iter; left time: 1964.3490s
Epoch: 16 cost time: 6.889618396759033
Epoch: 16, Steps: 154 | Train Loss: 0.449 Vali Loss: 2.344 Vali Acc: 0.515 Test Loss: 2.344 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6280165
	speed: 0.1526s/iter; left time: 1958.3308s
Epoch: 17 cost time: 6.784947872161865
Epoch: 17, Steps: 154 | Train Loss: 0.405 Vali Loss: 2.579 Vali Acc: 0.476 Test Loss: 2.579 Test Acc: 0.476
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3262083
	speed: 0.1556s/iter; left time: 1972.9823s
Epoch: 18 cost time: 6.654207706451416
Epoch: 18, Steps: 154 | Train Loss: 0.394 Vali Loss: 2.316 Vali Acc: 0.489 Test Loss: 2.316 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3140906
	speed: 0.1486s/iter; left time: 1861.4666s
Epoch: 19 cost time: 6.603723764419556
Epoch: 19, Steps: 154 | Train Loss: 0.384 Vali Loss: 2.434 Vali Acc: 0.514 Test Loss: 2.434 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1396904
	speed: 0.1539s/iter; left time: 1904.6236s
Epoch: 20 cost time: 6.4510533809661865
Epoch: 20, Steps: 154 | Train Loss: 0.320 Vali Loss: 2.564 Vali Acc: 0.501 Test Loss: 2.564 Test Acc: 0.501
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.2449168
	speed: 0.1573s/iter; left time: 1922.1431s
Epoch: 21 cost time: 6.871918201446533
Epoch: 21, Steps: 154 | Train Loss: 0.322 Vali Loss: 2.677 Vali Acc: 0.518 Test Loss: 2.677 Test Acc: 0.518
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3785419
	speed: 0.1537s/iter; left time: 1854.1249s
Epoch: 22 cost time: 6.5558531284332275
Epoch: 22, Steps: 154 | Train Loss: 0.320 Vali Loss: 2.602 Vali Acc: 0.492 Test Loss: 2.602 Test Acc: 0.492
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3172747
	speed: 0.1502s/iter; left time: 1789.6589s
Epoch: 23 cost time: 6.4518280029296875
Epoch: 23, Steps: 154 | Train Loss: 0.308 Vali Loss: 2.788 Vali Acc: 0.528 Test Loss: 2.788 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1454120
	speed: 0.1559s/iter; left time: 1833.6699s
Epoch: 24 cost time: 6.89096212387085
Epoch: 24, Steps: 154 | Train Loss: 0.270 Vali Loss: 2.883 Vali Acc: 0.519 Test Loss: 2.883 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0687728
	speed: 0.1597s/iter; left time: 1852.8702s
Epoch: 25 cost time: 6.346314191818237
Epoch: 25, Steps: 154 | Train Loss: 0.273 Vali Loss: 2.821 Vali Acc: 0.492 Test Loss: 2.821 Test Acc: 0.492
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5490673154906731
model parameter : 111662
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3856850
	speed: 0.0655s/iter; left time: 1001.5306s
Epoch: 1 cost time: 9.433209896087646
Epoch: 1, Steps: 154 | Train Loss: 2.117 Vali Loss: 1.948 Vali Acc: 0.400 Test Loss: 1.948 Test Acc: 0.400
Validation loss decreased (inf --> -0.399818).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5296103
	speed: 0.1625s/iter; left time: 2460.8305s
Epoch: 2 cost time: 6.753182411193848
Epoch: 2, Steps: 154 | Train Loss: 1.459 Vali Loss: 1.885 Vali Acc: 0.443 Test Loss: 1.885 Test Acc: 0.443
Validation loss decreased (-0.399818 --> -0.442804).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8545138
	speed: 0.1595s/iter; left time: 2392.0149s
Epoch: 3 cost time: 6.9263999462127686
Epoch: 3, Steps: 154 | Train Loss: 1.259 Vali Loss: 1.906 Vali Acc: 0.487 Test Loss: 1.906 Test Acc: 0.487
Validation loss decreased (-0.442804 --> -0.486599).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2998509
	speed: 0.1650s/iter; left time: 2447.7013s
Epoch: 4 cost time: 7.218823432922363
Epoch: 4, Steps: 154 | Train Loss: 1.157 Vali Loss: 2.247 Vali Acc: 0.431 Test Loss: 2.247 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0262122
	speed: 0.1619s/iter; left time: 2376.8360s
Epoch: 5 cost time: 7.086703062057495
Epoch: 5, Steps: 154 | Train Loss: 1.096 Vali Loss: 1.753 Vali Acc: 0.460 Test Loss: 1.753 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.4171925
	speed: 0.1674s/iter; left time: 2432.7183s
Epoch: 6 cost time: 7.332975387573242
Epoch: 6, Steps: 154 | Train Loss: 1.025 Vali Loss: 1.725 Vali Acc: 0.497 Test Loss: 1.725 Test Acc: 0.497
Validation loss decreased (-0.486599 --> -0.497144).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7963957
	speed: 0.1590s/iter; left time: 2285.6135s
Epoch: 7 cost time: 7.072771787643433
Epoch: 7, Steps: 154 | Train Loss: 0.948 Vali Loss: 1.881 Vali Acc: 0.468 Test Loss: 1.881 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6820862
	speed: 0.1639s/iter; left time: 2331.3884s
Epoch: 8 cost time: 6.811753988265991
Epoch: 8, Steps: 154 | Train Loss: 0.909 Vali Loss: 2.241 Vali Acc: 0.453 Test Loss: 2.241 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6527343
	speed: 0.1650s/iter; left time: 2321.3302s
Epoch: 9 cost time: 7.325068473815918
Epoch: 9, Steps: 154 | Train Loss: 0.878 Vali Loss: 1.754 Vali Acc: 0.477 Test Loss: 1.754 Test Acc: 0.477
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4858558
	speed: 0.1689s/iter; left time: 2350.6416s
Epoch: 10 cost time: 7.171970844268799
Epoch: 10, Steps: 154 | Train Loss: 0.791 Vali Loss: 1.828 Vali Acc: 0.468 Test Loss: 1.828 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1191611
	speed: 0.1586s/iter; left time: 2181.9416s
Epoch: 11 cost time: 6.642967700958252
Epoch: 11, Steps: 154 | Train Loss: 0.758 Vali Loss: 1.999 Vali Acc: 0.487 Test Loss: 1.999 Test Acc: 0.487
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.9830403
	speed: 0.1637s/iter; left time: 2228.0273s
Epoch: 12 cost time: 7.303740501403809
Epoch: 12, Steps: 154 | Train Loss: 0.699 Vali Loss: 1.783 Vali Acc: 0.545 Test Loss: 1.783 Test Acc: 0.545
Validation loss decreased (-0.497144 --> -0.544589).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5192546
	speed: 0.1621s/iter; left time: 2180.2219s
Epoch: 13 cost time: 6.9374165534973145
Epoch: 13, Steps: 154 | Train Loss: 0.671 Vali Loss: 1.926 Vali Acc: 0.513 Test Loss: 1.926 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9576308
	speed: 0.1572s/iter; left time: 2090.1164s
Epoch: 14 cost time: 6.688886880874634
Epoch: 14, Steps: 154 | Train Loss: 0.630 Vali Loss: 1.842 Vali Acc: 0.526 Test Loss: 1.842 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5792542
	speed: 0.1446s/iter; left time: 1900.2811s
Epoch: 15 cost time: 6.120615720748901
Epoch: 15, Steps: 154 | Train Loss: 0.596 Vali Loss: 1.960 Vali Acc: 0.520 Test Loss: 1.960 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5081582
	speed: 0.1474s/iter; left time: 1914.6655s
Epoch: 16 cost time: 6.45620059967041
Epoch: 16, Steps: 154 | Train Loss: 0.561 Vali Loss: 2.006 Vali Acc: 0.541 Test Loss: 2.006 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0845323
	speed: 0.1475s/iter; left time: 1893.6228s
Epoch: 17 cost time: 5.991094589233398
Epoch: 17, Steps: 154 | Train Loss: 0.518 Vali Loss: 2.102 Vali Acc: 0.523 Test Loss: 2.102 Test Acc: 0.523
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4943817
	speed: 0.1452s/iter; left time: 1840.9865s
Epoch: 18 cost time: 6.323810338973999
Epoch: 18, Steps: 154 | Train Loss: 0.485 Vali Loss: 2.181 Vali Acc: 0.505 Test Loss: 2.181 Test Acc: 0.505
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9484923
	speed: 0.1439s/iter; left time: 1802.8148s
Epoch: 19 cost time: 6.373161792755127
Epoch: 19, Steps: 154 | Train Loss: 0.464 Vali Loss: 2.195 Vali Acc: 0.537 Test Loss: 2.195 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2120065
	speed: 0.1414s/iter; left time: 1749.8707s
Epoch: 20 cost time: 5.915258884429932
Epoch: 20, Steps: 154 | Train Loss: 0.447 Vali Loss: 2.214 Vali Acc: 0.530 Test Loss: 2.214 Test Acc: 0.530
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.5525386
	speed: 0.1437s/iter; left time: 1755.6610s
Epoch: 21 cost time: 6.230100870132446
Epoch: 21, Steps: 154 | Train Loss: 0.431 Vali Loss: 2.217 Vali Acc: 0.533 Test Loss: 2.217 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6424137
	speed: 0.1468s/iter; left time: 1770.8725s
Epoch: 22 cost time: 6.007822513580322
Epoch: 22, Steps: 154 | Train Loss: 0.391 Vali Loss: 2.259 Vali Acc: 0.519 Test Loss: 2.259 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5446066504460665
model parameter : 95598
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2244036
	speed: 0.0520s/iter; left time: 795.3086s
Epoch: 1 cost time: 7.06976842880249
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 1.834 Vali Acc: 0.420 Test Loss: 1.834 Test Acc: 0.420
Validation loss decreased (inf --> -0.420095).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3707864
	speed: 0.1474s/iter; left time: 2232.4188s
Epoch: 2 cost time: 7.60349440574646
Epoch: 2, Steps: 154 | Train Loss: 1.560 Vali Loss: 1.830 Vali Acc: 0.433 Test Loss: 1.830 Test Acc: 0.433
Validation loss decreased (-0.420095 --> -0.433477).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5041397
	speed: 0.1629s/iter; left time: 2442.5012s
Epoch: 3 cost time: 7.248935222625732
Epoch: 3, Steps: 154 | Train Loss: 1.300 Vali Loss: 1.896 Vali Acc: 0.479 Test Loss: 1.896 Test Acc: 0.479
Validation loss decreased (-0.433477 --> -0.479300).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0388592
	speed: 0.1636s/iter; left time: 2428.2472s
Epoch: 4 cost time: 7.378401279449463
Epoch: 4, Steps: 154 | Train Loss: 1.223 Vali Loss: 1.844 Vali Acc: 0.479 Test Loss: 1.844 Test Acc: 0.479
Validation loss decreased (-0.479300 --> -0.479300).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9845186
	speed: 0.1646s/iter; left time: 2416.6670s
Epoch: 5 cost time: 7.328624486923218
Epoch: 5, Steps: 154 | Train Loss: 1.125 Vali Loss: 1.705 Vali Acc: 0.433 Test Loss: 1.705 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4065113
	speed: 0.1670s/iter; left time: 2426.6179s
Epoch: 6 cost time: 7.153551816940308
Epoch: 6, Steps: 154 | Train Loss: 1.077 Vali Loss: 1.824 Vali Acc: 0.476 Test Loss: 1.824 Test Acc: 0.476
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7620800
	speed: 0.1616s/iter; left time: 2323.1631s
Epoch: 7 cost time: 7.440507173538208
Epoch: 7, Steps: 154 | Train Loss: 1.021 Vali Loss: 1.945 Vali Acc: 0.479 Test Loss: 1.945 Test Acc: 0.479
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6185903
	speed: 0.1669s/iter; left time: 2373.2685s
Epoch: 8 cost time: 7.505356788635254
Epoch: 8, Steps: 154 | Train Loss: 0.998 Vali Loss: 1.819 Vali Acc: 0.516 Test Loss: 1.819 Test Acc: 0.516
Validation loss decreased (-0.479300 --> -0.515797).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8268328
	speed: 0.1719s/iter; left time: 2418.4653s
Epoch: 9 cost time: 7.804844617843628
Epoch: 9, Steps: 154 | Train Loss: 0.921 Vali Loss: 1.810 Vali Acc: 0.490 Test Loss: 1.810 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6129233
	speed: 0.1635s/iter; left time: 2275.2805s
Epoch: 10 cost time: 7.743983507156372
Epoch: 10, Steps: 154 | Train Loss: 0.860 Vali Loss: 1.826 Vali Acc: 0.522 Test Loss: 1.826 Test Acc: 0.522
Validation loss decreased (-0.515797 --> -0.521880).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6342659
	speed: 0.1820s/iter; left time: 2504.5560s
Epoch: 11 cost time: 8.48945689201355
Epoch: 11, Steps: 154 | Train Loss: 0.841 Vali Loss: 1.869 Vali Acc: 0.476 Test Loss: 1.869 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0466117
	speed: 0.1793s/iter; left time: 2439.5978s
Epoch: 12 cost time: 8.404687881469727
Epoch: 12, Steps: 154 | Train Loss: 0.805 Vali Loss: 2.083 Vali Acc: 0.489 Test Loss: 2.083 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0072728
	speed: 0.1796s/iter; left time: 2415.7761s
Epoch: 13 cost time: 7.2060863971710205
Epoch: 13, Steps: 154 | Train Loss: 0.737 Vali Loss: 1.851 Vali Acc: 0.485 Test Loss: 1.851 Test Acc: 0.485
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4312917
	speed: 0.1681s/iter; left time: 2236.1555s
Epoch: 14 cost time: 7.4591310024261475
Epoch: 14, Steps: 154 | Train Loss: 0.718 Vali Loss: 1.842 Vali Acc: 0.541 Test Loss: 1.842 Test Acc: 0.541
Validation loss decreased (-0.521880 --> -0.540533).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5480950
	speed: 0.1616s/iter; left time: 2123.7985s
Epoch: 15 cost time: 7.598093032836914
Epoch: 15, Steps: 154 | Train Loss: 0.665 Vali Loss: 2.176 Vali Acc: 0.489 Test Loss: 2.176 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4819170
	speed: 0.1662s/iter; left time: 2159.6540s
Epoch: 16 cost time: 7.695596218109131
Epoch: 16, Steps: 154 | Train Loss: 0.627 Vali Loss: 2.081 Vali Acc: 0.500 Test Loss: 2.081 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.5665907
	speed: 0.1712s/iter; left time: 2198.0396s
Epoch: 17 cost time: 7.299698352813721
Epoch: 17, Steps: 154 | Train Loss: 0.589 Vali Loss: 2.037 Vali Acc: 0.485 Test Loss: 2.037 Test Acc: 0.485
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.1649892
	speed: 0.1626s/iter; left time: 2062.8773s
Epoch: 18 cost time: 7.678332090377808
Epoch: 18, Steps: 154 | Train Loss: 0.564 Vali Loss: 2.241 Vali Acc: 0.494 Test Loss: 2.241 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3359386
	speed: 0.1556s/iter; left time: 1950.0256s
Epoch: 19 cost time: 6.73032808303833
Epoch: 19, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.710 Vali Acc: 0.487 Test Loss: 2.710 Test Acc: 0.487
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5023935
	speed: 0.1597s/iter; left time: 1975.7767s
Epoch: 20 cost time: 6.973340272903442
Epoch: 20, Steps: 154 | Train Loss: 0.532 Vali Loss: 2.539 Vali Acc: 0.486 Test Loss: 2.539 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2875615
	speed: 0.1546s/iter; left time: 1889.1949s
Epoch: 21 cost time: 6.488105058670044
Epoch: 21, Steps: 154 | Train Loss: 0.458 Vali Loss: 2.238 Vali Acc: 0.476 Test Loss: 2.238 Test Acc: 0.476
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6503721
	speed: 0.1528s/iter; left time: 1843.3389s
Epoch: 22 cost time: 6.82571816444397
Epoch: 22, Steps: 154 | Train Loss: 0.464 Vali Loss: 2.129 Vali Acc: 0.512 Test Loss: 2.129 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.5912248
	speed: 0.1534s/iter; left time: 1827.3970s
Epoch: 23 cost time: 6.95762038230896
Epoch: 23, Steps: 154 | Train Loss: 0.457 Vali Loss: 2.501 Vali Acc: 0.499 Test Loss: 2.501 Test Acc: 0.499
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2414058
	speed: 0.1510s/iter; left time: 1775.2151s
Epoch: 24 cost time: 6.816681861877441
Epoch: 24, Steps: 154 | Train Loss: 0.425 Vali Loss: 2.280 Vali Acc: 0.528 Test Loss: 2.280 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.540551500405515
model parameter : 87598
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2793887
	speed: 0.0613s/iter; left time: 937.3033s
Epoch: 1 cost time: 8.533942222595215
Epoch: 1, Steps: 154 | Train Loss: 2.337 Vali Loss: 2.012 Vali Acc: 0.330 Test Loss: 2.012 Test Acc: 0.330
Validation loss decreased (inf --> -0.330069).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3778520
	speed: 0.1638s/iter; left time: 2481.6362s
Epoch: 2 cost time: 6.866578817367554
Epoch: 2, Steps: 154 | Train Loss: 1.706 Vali Loss: 1.661 Vali Acc: 0.464 Test Loss: 1.661 Test Acc: 0.464
Validation loss decreased (-0.330069 --> -0.463487).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8928868
	speed: 0.1523s/iter; left time: 2283.7757s
Epoch: 3 cost time: 6.975585460662842
Epoch: 3, Steps: 154 | Train Loss: 1.364 Vali Loss: 1.723 Vali Acc: 0.452 Test Loss: 1.723 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1591408
	speed: 0.1600s/iter; left time: 2374.5400s
Epoch: 4 cost time: 6.631844520568848
Epoch: 4, Steps: 154 | Train Loss: 1.215 Vali Loss: 1.810 Vali Acc: 0.480 Test Loss: 1.810 Test Acc: 0.480
Validation loss decreased (-0.463487 --> -0.479706).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0563622
	speed: 0.1654s/iter; left time: 2429.0741s
Epoch: 5 cost time: 8.107398748397827
Epoch: 5, Steps: 154 | Train Loss: 1.147 Vali Loss: 1.691 Vali Acc: 0.513 Test Loss: 1.691 Test Acc: 0.513
Validation loss decreased (-0.479706 --> -0.512554).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4503024
	speed: 0.1769s/iter; left time: 2570.4858s
Epoch: 6 cost time: 8.008324146270752
Epoch: 6, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.666 Vali Acc: 0.502 Test Loss: 1.666 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0061593
	speed: 0.1690s/iter; left time: 2430.4006s
Epoch: 7 cost time: 7.1801793575286865
Epoch: 7, Steps: 154 | Train Loss: 1.037 Vali Loss: 1.883 Vali Acc: 0.483 Test Loss: 1.883 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3536500
	speed: 0.1765s/iter; left time: 2510.9836s
Epoch: 8 cost time: 7.703084707260132
Epoch: 8, Steps: 154 | Train Loss: 0.999 Vali Loss: 1.649 Vali Acc: 0.533 Test Loss: 1.649 Test Acc: 0.533
Validation loss decreased (-0.512554 --> -0.533236).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1966662
	speed: 0.1731s/iter; left time: 2434.8342s
Epoch: 9 cost time: 7.702257871627808
Epoch: 9, Steps: 154 | Train Loss: 0.951 Vali Loss: 1.646 Vali Acc: 0.483 Test Loss: 1.646 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9107007
	speed: 0.1753s/iter; left time: 2439.5621s
Epoch: 10 cost time: 7.976258039474487
Epoch: 10, Steps: 154 | Train Loss: 0.899 Vali Loss: 1.642 Vali Acc: 0.542 Test Loss: 1.642 Test Acc: 0.542
Validation loss decreased (-0.533236 --> -0.541752).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9762927
	speed: 0.1710s/iter; left time: 2353.1138s
Epoch: 11 cost time: 7.620033025741577
Epoch: 11, Steps: 154 | Train Loss: 0.869 Vali Loss: 1.636 Vali Acc: 0.528 Test Loss: 1.636 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8315152
	speed: 0.1751s/iter; left time: 2382.1975s
Epoch: 12 cost time: 7.9780662059783936
Epoch: 12, Steps: 154 | Train Loss: 0.832 Vali Loss: 1.726 Vali Acc: 0.550 Test Loss: 1.726 Test Acc: 0.550
Validation loss decreased (-0.541752 --> -0.549861).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7856303
	speed: 0.1723s/iter; left time: 2318.4441s
Epoch: 13 cost time: 7.479671955108643
Epoch: 13, Steps: 154 | Train Loss: 0.778 Vali Loss: 1.623 Vali Acc: 0.522 Test Loss: 1.623 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8222480
	speed: 0.1705s/iter; left time: 2267.9077s
Epoch: 14 cost time: 7.689082860946655
Epoch: 14, Steps: 154 | Train Loss: 0.753 Vali Loss: 1.935 Vali Acc: 0.503 Test Loss: 1.935 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4287950
	speed: 0.1660s/iter; left time: 2182.2397s
Epoch: 15 cost time: 7.950573682785034
Epoch: 15, Steps: 154 | Train Loss: 0.705 Vali Loss: 1.844 Vali Acc: 0.496 Test Loss: 1.844 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6121347
	speed: 0.1788s/iter; left time: 2323.1583s
Epoch: 16 cost time: 7.925901174545288
Epoch: 16, Steps: 154 | Train Loss: 0.671 Vali Loss: 1.861 Vali Acc: 0.498 Test Loss: 1.861 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.1285378
	speed: 0.1715s/iter; left time: 2201.2512s
Epoch: 17 cost time: 7.986015796661377
Epoch: 17, Steps: 154 | Train Loss: 0.635 Vali Loss: 1.839 Vali Acc: 0.512 Test Loss: 1.839 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4037994
	speed: 0.1701s/iter; left time: 2158.0124s
Epoch: 18 cost time: 7.641360521316528
Epoch: 18, Steps: 154 | Train Loss: 0.615 Vali Loss: 2.286 Vali Acc: 0.458 Test Loss: 2.286 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4159534
	speed: 0.1729s/iter; left time: 2166.4107s
Epoch: 19 cost time: 7.944278955459595
Epoch: 19, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.065 Vali Acc: 0.516 Test Loss: 2.065 Test Acc: 0.516
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.9205832
	speed: 0.1712s/iter; left time: 2118.6961s
Epoch: 20 cost time: 7.724736928939819
Epoch: 20, Steps: 154 | Train Loss: 0.556 Vali Loss: 2.101 Vali Acc: 0.537 Test Loss: 2.101 Test Acc: 0.537
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2429155
	speed: 0.1718s/iter; left time: 2099.7557s
Epoch: 21 cost time: 7.838732957839966
Epoch: 21, Steps: 154 | Train Loss: 0.501 Vali Loss: 2.158 Vali Acc: 0.506 Test Loss: 2.158 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5495291
	speed: 0.1646s/iter; left time: 1985.7105s
Epoch: 22 cost time: 7.050506114959717
Epoch: 22, Steps: 154 | Train Loss: 0.495 Vali Loss: 2.231 Vali Acc: 0.538 Test Loss: 2.231 Test Acc: 0.538
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5498783454987834
model parameter : 82254
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6576726
	speed: 0.0602s/iter; left time: 921.0559s
Epoch: 1 cost time: 8.24524736404419
Epoch: 1, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.001 Vali Acc: 0.416 Test Loss: 2.001 Test Acc: 0.416
Validation loss decreased (inf --> -0.415633).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0503711
	speed: 0.1534s/iter; left time: 2323.0210s
Epoch: 2 cost time: 6.6762330532073975
Epoch: 2, Steps: 154 | Train Loss: 1.422 Vali Loss: 1.855 Vali Acc: 0.472 Test Loss: 1.855 Test Acc: 0.472
Validation loss decreased (-0.415633 --> -0.471595).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2187573
	speed: 0.1668s/iter; left time: 2501.5324s
Epoch: 3 cost time: 7.080339193344116
Epoch: 3, Steps: 154 | Train Loss: 1.243 Vali Loss: 1.730 Vali Acc: 0.472 Test Loss: 1.730 Test Acc: 0.472
Validation loss decreased (-0.471595 --> -0.471597).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4820910
	speed: 0.1584s/iter; left time: 2350.8957s
Epoch: 4 cost time: 6.714656829833984
Epoch: 4, Steps: 154 | Train Loss: 1.147 Vali Loss: 1.997 Vali Acc: 0.497 Test Loss: 1.997 Test Acc: 0.497
Validation loss decreased (-0.471597 --> -0.496736).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5811322
	speed: 0.1548s/iter; left time: 2273.2336s
Epoch: 5 cost time: 6.946898937225342
Epoch: 5, Steps: 154 | Train Loss: 1.038 Vali Loss: 1.806 Vali Acc: 0.532 Test Loss: 1.806 Test Acc: 0.532
Validation loss decreased (-0.496736 --> -0.532018).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4386810
	speed: 0.1598s/iter; left time: 2321.8611s
Epoch: 6 cost time: 6.840749025344849
Epoch: 6, Steps: 154 | Train Loss: 0.953 Vali Loss: 2.559 Vali Acc: 0.446 Test Loss: 2.559 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9333078
	speed: 0.1546s/iter; left time: 2222.4546s
Epoch: 7 cost time: 6.675534963607788
Epoch: 7, Steps: 154 | Train Loss: 0.890 Vali Loss: 2.045 Vali Acc: 0.512 Test Loss: 2.045 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6537584
	speed: 0.1602s/iter; left time: 2279.2174s
Epoch: 8 cost time: 7.452566862106323
Epoch: 8, Steps: 154 | Train Loss: 0.843 Vali Loss: 2.264 Vali Acc: 0.498 Test Loss: 2.264 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6639578
	speed: 0.1678s/iter; left time: 2361.3486s
Epoch: 9 cost time: 7.237712383270264
Epoch: 9, Steps: 154 | Train Loss: 0.748 Vali Loss: 2.529 Vali Acc: 0.405 Test Loss: 2.529 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.9339260
	speed: 0.1578s/iter; left time: 2196.2801s
Epoch: 10 cost time: 7.442455530166626
Epoch: 10, Steps: 154 | Train Loss: 0.669 Vali Loss: 2.363 Vali Acc: 0.446 Test Loss: 2.363 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.5974433
	speed: 0.1670s/iter; left time: 2298.1193s
Epoch: 11 cost time: 7.741909980773926
Epoch: 11, Steps: 154 | Train Loss: 0.581 Vali Loss: 2.572 Vali Acc: 0.442 Test Loss: 2.572 Test Acc: 0.442
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2414113
	speed: 0.1634s/iter; left time: 2223.5129s
Epoch: 12 cost time: 7.30595850944519
Epoch: 12, Steps: 154 | Train Loss: 0.526 Vali Loss: 2.558 Vali Acc: 0.442 Test Loss: 2.558 Test Acc: 0.442
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.2924472
	speed: 0.1700s/iter; left time: 2286.6415s
Epoch: 13 cost time: 7.842099666595459
Epoch: 13, Steps: 154 | Train Loss: 0.502 Vali Loss: 2.642 Vali Acc: 0.508 Test Loss: 2.642 Test Acc: 0.508
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.5142819
	speed: 0.1694s/iter; left time: 2252.4551s
Epoch: 14 cost time: 7.995280504226685
Epoch: 14, Steps: 154 | Train Loss: 0.438 Vali Loss: 3.073 Vali Acc: 0.421 Test Loss: 3.073 Test Acc: 0.421
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4457919
	speed: 0.1660s/iter; left time: 2182.7017s
Epoch: 15 cost time: 7.724176645278931
Epoch: 15, Steps: 154 | Train Loss: 0.401 Vali Loss: 3.089 Vali Acc: 0.471 Test Loss: 3.089 Test Acc: 0.471
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5320356853203568
model parameter : 135022
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4800019
	speed: 0.0646s/iter; left time: 988.6928s
Epoch: 1 cost time: 9.058597326278687
Epoch: 1, Steps: 154 | Train Loss: 2.135 Vali Loss: 1.847 Vali Acc: 0.408 Test Loss: 1.847 Test Acc: 0.408
Validation loss decreased (inf --> -0.407524).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4917438
	speed: 0.1725s/iter; left time: 2612.5249s
Epoch: 2 cost time: 7.572503328323364
Epoch: 2, Steps: 154 | Train Loss: 1.449 Vali Loss: 1.776 Vali Acc: 0.461 Test Loss: 1.776 Test Acc: 0.461
Validation loss decreased (-0.407524 --> -0.460647).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1960186
	speed: 0.1766s/iter; left time: 2648.0863s
Epoch: 3 cost time: 8.748556852340698
Epoch: 3, Steps: 154 | Train Loss: 1.217 Vali Loss: 1.963 Vali Acc: 0.470 Test Loss: 1.963 Test Acc: 0.470
Validation loss decreased (-0.460647 --> -0.469972).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1091961
	speed: 0.1868s/iter; left time: 2771.7727s
Epoch: 4 cost time: 8.850637197494507
Epoch: 4, Steps: 154 | Train Loss: 1.113 Vali Loss: 2.104 Vali Acc: 0.430 Test Loss: 2.104 Test Acc: 0.430
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1036574
	speed: 0.1780s/iter; left time: 2614.6279s
Epoch: 5 cost time: 8.3674635887146
Epoch: 5, Steps: 154 | Train Loss: 1.035 Vali Loss: 1.841 Vali Acc: 0.498 Test Loss: 1.841 Test Acc: 0.498
Validation loss decreased (-0.469972 --> -0.498360).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0909660
	speed: 0.1795s/iter; left time: 2608.7567s
Epoch: 6 cost time: 7.684557676315308
Epoch: 6, Steps: 154 | Train Loss: 0.981 Vali Loss: 1.877 Vali Acc: 0.475 Test Loss: 1.877 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8415856
	speed: 0.1709s/iter; left time: 2457.0169s
Epoch: 7 cost time: 7.895563125610352
Epoch: 7, Steps: 154 | Train Loss: 0.913 Vali Loss: 2.041 Vali Acc: 0.475 Test Loss: 2.041 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0769839
	speed: 0.1810s/iter; left time: 2573.8889s
Epoch: 8 cost time: 8.197069644927979
Epoch: 8, Steps: 154 | Train Loss: 0.827 Vali Loss: 1.675 Vali Acc: 0.542 Test Loss: 1.675 Test Acc: 0.542
Validation loss decreased (-0.498360 --> -0.542157).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6999350
	speed: 0.1710s/iter; left time: 2406.3913s
Epoch: 9 cost time: 7.8619630336761475
Epoch: 9, Steps: 154 | Train Loss: 0.767 Vali Loss: 1.950 Vali Acc: 0.485 Test Loss: 1.950 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6404344
	speed: 0.1723s/iter; left time: 2397.9515s
Epoch: 10 cost time: 7.354045867919922
Epoch: 10, Steps: 154 | Train Loss: 0.711 Vali Loss: 2.045 Vali Acc: 0.458 Test Loss: 2.045 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4702244
	speed: 0.1635s/iter; left time: 2249.3417s
Epoch: 11 cost time: 6.825684070587158
Epoch: 11, Steps: 154 | Train Loss: 0.695 Vali Loss: 2.148 Vali Acc: 0.447 Test Loss: 2.148 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1159722
	speed: 0.1622s/iter; left time: 2207.0575s
Epoch: 12 cost time: 7.016619443893433
Epoch: 12, Steps: 154 | Train Loss: 0.634 Vali Loss: 2.096 Vali Acc: 0.508 Test Loss: 2.096 Test Acc: 0.508
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.5271155
	speed: 0.1593s/iter; left time: 2142.9509s
Epoch: 13 cost time: 6.67586612701416
Epoch: 13, Steps: 154 | Train Loss: 0.569 Vali Loss: 2.154 Vali Acc: 0.476 Test Loss: 2.154 Test Acc: 0.476
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5422274
	speed: 0.1540s/iter; left time: 2047.7685s
Epoch: 14 cost time: 6.967360734939575
Epoch: 14, Steps: 154 | Train Loss: 0.544 Vali Loss: 2.258 Vali Acc: 0.531 Test Loss: 2.258 Test Acc: 0.531
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1969593
	speed: 0.1583s/iter; left time: 2080.4216s
Epoch: 15 cost time: 6.041905641555786
Epoch: 15, Steps: 154 | Train Loss: 0.511 Vali Loss: 2.201 Vali Acc: 0.547 Test Loss: 2.201 Test Acc: 0.547
Validation loss decreased (-0.542157 --> -0.546612).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5924274
	speed: 0.1447s/iter; left time: 1880.4105s
Epoch: 16 cost time: 6.84603214263916
Epoch: 16, Steps: 154 | Train Loss: 0.485 Vali Loss: 2.361 Vali Acc: 0.466 Test Loss: 2.361 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2062736
	speed: 0.1566s/iter; left time: 2010.8202s
Epoch: 17 cost time: 7.078079462051392
Epoch: 17, Steps: 154 | Train Loss: 0.419 Vali Loss: 2.497 Vali Acc: 0.431 Test Loss: 2.497 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2116381
	speed: 0.1555s/iter; left time: 1971.6674s
Epoch: 18 cost time: 6.705923318862915
Epoch: 18, Steps: 154 | Train Loss: 0.409 Vali Loss: 2.613 Vali Acc: 0.470 Test Loss: 2.613 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2747077
	speed: 0.1521s/iter; left time: 1905.5725s
Epoch: 19 cost time: 6.683725833892822
Epoch: 19, Steps: 154 | Train Loss: 0.387 Vali Loss: 2.689 Vali Acc: 0.476 Test Loss: 2.689 Test Acc: 0.476
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3677398
	speed: 0.1576s/iter; left time: 1949.6946s
Epoch: 20 cost time: 6.8837738037109375
Epoch: 20, Steps: 154 | Train Loss: 0.354 Vali Loss: 2.656 Vali Acc: 0.503 Test Loss: 2.656 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5467371
	speed: 0.1572s/iter; left time: 1920.8104s
Epoch: 21 cost time: 6.8754563331604
Epoch: 21, Steps: 154 | Train Loss: 0.356 Vali Loss: 2.819 Vali Acc: 0.498 Test Loss: 2.819 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4390901
	speed: 0.1498s/iter; left time: 1807.0903s
Epoch: 22 cost time: 6.695230722427368
Epoch: 22, Steps: 154 | Train Loss: 0.326 Vali Loss: 2.849 Vali Acc: 0.477 Test Loss: 2.849 Test Acc: 0.477
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3579999
	speed: 0.1610s/iter; left time: 1917.9242s
Epoch: 23 cost time: 7.481128692626953
Epoch: 23, Steps: 154 | Train Loss: 0.320 Vali Loss: 2.831 Vali Acc: 0.496 Test Loss: 2.831 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2078403
	speed: 0.1650s/iter; left time: 1940.4065s
Epoch: 24 cost time: 7.174328327178955
Epoch: 24, Steps: 154 | Train Loss: 0.295 Vali Loss: 2.833 Vali Acc: 0.481 Test Loss: 2.833 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.3986125
	speed: 0.1533s/iter; left time: 1779.3542s
Epoch: 25 cost time: 6.8768134117126465
Epoch: 25, Steps: 154 | Train Loss: 0.282 Vali Loss: 3.080 Vali Acc: 0.494 Test Loss: 3.080 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5466342254663422
model parameter : 86670
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1653504
	speed: 0.0693s/iter; left time: 1060.5676s
Epoch: 1 cost time: 9.931540489196777
Epoch: 1, Steps: 154 | Train Loss: 2.079 Vali Loss: 1.830 Vali Acc: 0.419 Test Loss: 1.830 Test Acc: 0.419
Validation loss decreased (inf --> -0.419284).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5346754
	speed: 0.1768s/iter; left time: 2678.1689s
Epoch: 2 cost time: 7.765411853790283
Epoch: 2, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.021 Vali Acc: 0.442 Test Loss: 2.021 Test Acc: 0.442
Validation loss decreased (-0.419284 --> -0.441586).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9806842
	speed: 0.1786s/iter; left time: 2678.4651s
Epoch: 3 cost time: 8.932701349258423
Epoch: 3, Steps: 154 | Train Loss: 1.232 Vali Loss: 2.219 Vali Acc: 0.433 Test Loss: 2.219 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0678165
	speed: 0.1758s/iter; left time: 2608.6904s
Epoch: 4 cost time: 7.9400739669799805
Epoch: 4, Steps: 154 | Train Loss: 1.130 Vali Loss: 1.802 Vali Acc: 0.481 Test Loss: 1.802 Test Acc: 0.481
Validation loss decreased (-0.441586 --> -0.481328).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7806406
	speed: 0.1822s/iter; left time: 2675.6930s
Epoch: 5 cost time: 7.978118181228638
Epoch: 5, Steps: 154 | Train Loss: 1.055 Vali Loss: 1.790 Vali Acc: 0.477 Test Loss: 1.790 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7449544
	speed: 0.1766s/iter; left time: 2566.2044s
Epoch: 6 cost time: 8.681633234024048
Epoch: 6, Steps: 154 | Train Loss: 0.984 Vali Loss: 1.699 Vali Acc: 0.483 Test Loss: 1.699 Test Acc: 0.483
Validation loss decreased (-0.481328 --> -0.482546).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7042433
	speed: 0.1742s/iter; left time: 2504.5432s
Epoch: 7 cost time: 7.834261655807495
Epoch: 7, Steps: 154 | Train Loss: 0.928 Vali Loss: 1.726 Vali Acc: 0.495 Test Loss: 1.726 Test Acc: 0.495
Validation loss decreased (-0.482546 --> -0.495117).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0062464
	speed: 0.1844s/iter; left time: 2622.4701s
Epoch: 8 cost time: 8.499638319015503
Epoch: 8, Steps: 154 | Train Loss: 0.893 Vali Loss: 1.802 Vali Acc: 0.516 Test Loss: 1.802 Test Acc: 0.516
Validation loss decreased (-0.495117 --> -0.515797).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5170154
	speed: 0.1720s/iter; left time: 2419.5046s
Epoch: 9 cost time: 8.327516078948975
Epoch: 9, Steps: 154 | Train Loss: 0.824 Vali Loss: 1.882 Vali Acc: 0.520 Test Loss: 1.882 Test Acc: 0.520
Validation loss decreased (-0.515797 --> -0.520257).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9283893
	speed: 0.1745s/iter; left time: 2428.7893s
Epoch: 10 cost time: 7.496189594268799
Epoch: 10, Steps: 154 | Train Loss: 0.724 Vali Loss: 1.876 Vali Acc: 0.507 Test Loss: 1.876 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4960378
	speed: 0.1793s/iter; left time: 2467.1373s
Epoch: 11 cost time: 8.989098310470581
Epoch: 11, Steps: 154 | Train Loss: 0.715 Vali Loss: 1.929 Vali Acc: 0.550 Test Loss: 1.929 Test Acc: 0.550
Validation loss decreased (-0.520257 --> -0.550265).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0944363
	speed: 0.1742s/iter; left time: 2370.6418s
Epoch: 12 cost time: 8.134495973587036
Epoch: 12, Steps: 154 | Train Loss: 0.680 Vali Loss: 1.948 Vali Acc: 0.486 Test Loss: 1.948 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3204991
	speed: 0.1774s/iter; left time: 2387.0893s
Epoch: 13 cost time: 8.016641855239868
Epoch: 13, Steps: 154 | Train Loss: 0.595 Vali Loss: 1.929 Vali Acc: 0.547 Test Loss: 1.929 Test Acc: 0.547
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3513125
	speed: 0.1741s/iter; left time: 2315.6866s
Epoch: 14 cost time: 8.04528284072876
Epoch: 14, Steps: 154 | Train Loss: 0.591 Vali Loss: 2.046 Vali Acc: 0.517 Test Loss: 2.046 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8350768
	speed: 0.1697s/iter; left time: 2230.1538s
Epoch: 15 cost time: 7.339482307434082
Epoch: 15, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.012 Vali Acc: 0.547 Test Loss: 2.012 Test Acc: 0.547
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3619795
	speed: 0.1717s/iter; left time: 2230.0821s
Epoch: 16 cost time: 7.8269569873809814
Epoch: 16, Steps: 154 | Train Loss: 0.502 Vali Loss: 2.217 Vali Acc: 0.511 Test Loss: 2.217 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2084714
	speed: 0.1664s/iter; left time: 2136.4982s
Epoch: 17 cost time: 8.150914907455444
Epoch: 17, Steps: 154 | Train Loss: 0.454 Vali Loss: 2.292 Vali Acc: 0.528 Test Loss: 2.292 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8347422
	speed: 0.1704s/iter; left time: 2160.8758s
Epoch: 18 cost time: 7.258601427078247
Epoch: 18, Steps: 154 | Train Loss: 0.426 Vali Loss: 2.316 Vali Acc: 0.493 Test Loss: 2.316 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6680178
	speed: 0.1693s/iter; left time: 2121.4074s
Epoch: 19 cost time: 7.96382474899292
Epoch: 19, Steps: 154 | Train Loss: 0.408 Vali Loss: 2.477 Vali Acc: 0.524 Test Loss: 2.477 Test Acc: 0.524
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.7563157
	speed: 0.1629s/iter; left time: 2016.3276s
Epoch: 20 cost time: 7.425140142440796
Epoch: 20, Steps: 154 | Train Loss: 0.384 Vali Loss: 2.375 Vali Acc: 0.537 Test Loss: 2.375 Test Acc: 0.537
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.2529713
	speed: 0.1717s/iter; left time: 2097.8043s
Epoch: 21 cost time: 7.344701766967773
Epoch: 21, Steps: 154 | Train Loss: 0.358 Vali Loss: 2.483 Vali Acc: 0.503 Test Loss: 2.483 Test Acc: 0.503
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5502838605028386
model parameter : 86702
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8539013
	speed: 0.0611s/iter; left time: 935.0708s
Epoch: 1 cost time: 8.483744144439697
Epoch: 1, Steps: 154 | Train Loss: 2.141 Vali Loss: 1.757 Vali Acc: 0.416 Test Loss: 1.757 Test Acc: 0.416
Validation loss decreased (inf --> -0.416446).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2445415
	speed: 0.1636s/iter; left time: 2477.6093s
Epoch: 2 cost time: 7.0177717208862305
Epoch: 2, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.020 Vali Acc: 0.419 Test Loss: 2.020 Test Acc: 0.419
Validation loss decreased (-0.416446 --> -0.418877).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2197810
	speed: 0.1609s/iter; left time: 2412.0456s
Epoch: 3 cost time: 8.224836111068726
Epoch: 3, Steps: 154 | Train Loss: 1.281 Vali Loss: 2.133 Vali Acc: 0.460 Test Loss: 2.133 Test Acc: 0.460
Validation loss decreased (-0.418877 --> -0.460238).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5162590
	speed: 0.1783s/iter; left time: 2646.0111s
Epoch: 4 cost time: 8.626185894012451
Epoch: 4, Steps: 154 | Train Loss: 1.186 Vali Loss: 1.836 Vali Acc: 0.478 Test Loss: 1.836 Test Acc: 0.478
Validation loss decreased (-0.460238 --> -0.477678).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2710392
	speed: 0.1902s/iter; left time: 2792.3989s
Epoch: 5 cost time: 9.261013984680176
Epoch: 5, Steps: 154 | Train Loss: 1.116 Vali Loss: 1.707 Vali Acc: 0.504 Test Loss: 1.707 Test Acc: 0.504
Validation loss decreased (-0.477678 --> -0.504038).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9468614
	speed: 0.1816s/iter; left time: 2639.0607s
Epoch: 6 cost time: 7.980609178543091
Epoch: 6, Steps: 154 | Train Loss: 1.030 Vali Loss: 2.127 Vali Acc: 0.472 Test Loss: 2.127 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2934320
	speed: 0.1758s/iter; left time: 2528.1647s
Epoch: 7 cost time: 8.118450164794922
Epoch: 7, Steps: 154 | Train Loss: 1.001 Vali Loss: 1.885 Vali Acc: 0.517 Test Loss: 1.885 Test Acc: 0.517
Validation loss decreased (-0.504038 --> -0.517418).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0669060
	speed: 0.1854s/iter; left time: 2636.3960s
Epoch: 8 cost time: 8.880666732788086
Epoch: 8, Steps: 154 | Train Loss: 0.948 Vali Loss: 1.779 Vali Acc: 0.522 Test Loss: 1.779 Test Acc: 0.522
Validation loss decreased (-0.517418 --> -0.521880).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9232676
	speed: 0.1829s/iter; left time: 2572.6882s
Epoch: 9 cost time: 7.97858190536499
Epoch: 9, Steps: 154 | Train Loss: 0.859 Vali Loss: 1.952 Vali Acc: 0.495 Test Loss: 1.952 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8762918
	speed: 0.1828s/iter; left time: 2543.5446s
Epoch: 10 cost time: 8.343440055847168
Epoch: 10, Steps: 154 | Train Loss: 0.831 Vali Loss: 2.165 Vali Acc: 0.495 Test Loss: 2.165 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6946530
	speed: 0.1859s/iter; left time: 2558.7958s
Epoch: 11 cost time: 9.345777988433838
Epoch: 11, Steps: 154 | Train Loss: 0.800 Vali Loss: 2.124 Vali Acc: 0.485 Test Loss: 2.124 Test Acc: 0.485
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8473730
	speed: 0.1839s/iter; left time: 2502.8663s
Epoch: 12 cost time: 8.325872421264648
Epoch: 12, Steps: 154 | Train Loss: 0.744 Vali Loss: 1.930 Vali Acc: 0.493 Test Loss: 1.930 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.8364018
	speed: 0.1883s/iter; left time: 2533.0284s
Epoch: 13 cost time: 8.867452144622803
Epoch: 13, Steps: 154 | Train Loss: 0.697 Vali Loss: 1.946 Vali Acc: 0.534 Test Loss: 1.946 Test Acc: 0.534
Validation loss decreased (-0.521880 --> -0.534449).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0149240
	speed: 0.1815s/iter; left time: 2414.2208s
Epoch: 14 cost time: 8.822678089141846
Epoch: 14, Steps: 154 | Train Loss: 0.666 Vali Loss: 2.338 Vali Acc: 0.487 Test Loss: 2.338 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5399638
	speed: 0.1904s/iter; left time: 2502.5749s
Epoch: 15 cost time: 8.214608430862427
Epoch: 15, Steps: 154 | Train Loss: 0.648 Vali Loss: 2.185 Vali Acc: 0.485 Test Loss: 2.185 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5429865
	speed: 0.1861s/iter; left time: 2417.1382s
Epoch: 16 cost time: 9.15738821029663
Epoch: 16, Steps: 154 | Train Loss: 0.609 Vali Loss: 2.003 Vali Acc: 0.495 Test Loss: 2.003 Test Acc: 0.495
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2744913
	speed: 0.1822s/iter; left time: 2339.0743s
Epoch: 17 cost time: 8.216130495071411
Epoch: 17, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.265 Vali Acc: 0.493 Test Loss: 2.265 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2898801
	speed: 0.1881s/iter; left time: 2386.1800s
Epoch: 18 cost time: 8.363306283950806
Epoch: 18, Steps: 154 | Train Loss: 0.531 Vali Loss: 2.289 Vali Acc: 0.492 Test Loss: 2.289 Test Acc: 0.492
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4904894
	speed: 0.1768s/iter; left time: 2215.2149s
Epoch: 19 cost time: 8.155187129974365
Epoch: 19, Steps: 154 | Train Loss: 0.508 Vali Loss: 2.212 Vali Acc: 0.531 Test Loss: 2.212 Test Acc: 0.531
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.1718369
	speed: 0.1540s/iter; left time: 1905.6480s
Epoch: 20 cost time: 7.1179680824279785
Epoch: 20, Steps: 154 | Train Loss: 0.492 Vali Loss: 2.530 Vali Acc: 0.485 Test Loss: 2.530 Test Acc: 0.485
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8483025
	speed: 0.1629s/iter; left time: 1990.7967s
Epoch: 21 cost time: 7.400580644607544
Epoch: 21, Steps: 154 | Train Loss: 0.481 Vali Loss: 2.610 Vali Acc: 0.487 Test Loss: 2.610 Test Acc: 0.487
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1058451
	speed: 0.1569s/iter; left time: 1892.7198s
Epoch: 22 cost time: 6.856533765792847
Epoch: 22, Steps: 154 | Train Loss: 0.421 Vali Loss: 2.358 Vali Acc: 0.502 Test Loss: 2.358 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.1527890
	speed: 0.1554s/iter; left time: 1850.7811s
Epoch: 23 cost time: 6.74461555480957
Epoch: 23, Steps: 154 | Train Loss: 0.431 Vali Loss: 2.396 Vali Acc: 0.496 Test Loss: 2.396 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5344687753446877
model parameter : 70638
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8898792
	speed: 0.0566s/iter; left time: 865.3501s
Epoch: 1 cost time: 7.849437236785889
Epoch: 1, Steps: 154 | Train Loss: 2.208 Vali Loss: 1.805 Vali Acc: 0.427 Test Loss: 1.805 Test Acc: 0.427
Validation loss decreased (inf --> -0.426584).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3332363
	speed: 0.1476s/iter; left time: 2236.2298s
Epoch: 2 cost time: 6.222218990325928
Epoch: 2, Steps: 154 | Train Loss: 1.546 Vali Loss: 1.740 Vali Acc: 0.456 Test Loss: 1.740 Test Acc: 0.456
Validation loss decreased (-0.426584 --> -0.456187).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6383771
	speed: 0.1437s/iter; left time: 2155.1765s
Epoch: 3 cost time: 6.262190580368042
Epoch: 3, Steps: 154 | Train Loss: 1.313 Vali Loss: 1.714 Vali Acc: 0.502 Test Loss: 1.714 Test Acc: 0.502
Validation loss decreased (-0.456187 --> -0.502010).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2240158
	speed: 0.1448s/iter; left time: 2148.1088s
Epoch: 4 cost time: 6.31614875793457
Epoch: 4, Steps: 154 | Train Loss: 1.209 Vali Loss: 1.747 Vali Acc: 0.485 Test Loss: 1.747 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2684492
	speed: 0.1493s/iter; left time: 2191.8765s
Epoch: 5 cost time: 6.4818572998046875
Epoch: 5, Steps: 154 | Train Loss: 1.164 Vali Loss: 1.723 Vali Acc: 0.488 Test Loss: 1.723 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1097853
	speed: 0.1471s/iter; left time: 2137.6621s
Epoch: 6 cost time: 6.373223543167114
Epoch: 6, Steps: 154 | Train Loss: 1.082 Vali Loss: 1.654 Vali Acc: 0.533 Test Loss: 1.654 Test Acc: 0.533
Validation loss decreased (-0.502010 --> -0.532830).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1022850
	speed: 0.1520s/iter; left time: 2185.5579s
Epoch: 7 cost time: 6.843975782394409
Epoch: 7, Steps: 154 | Train Loss: 1.045 Vali Loss: 1.732 Vali Acc: 0.506 Test Loss: 1.732 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9118874
	speed: 0.1471s/iter; left time: 2091.9647s
Epoch: 8 cost time: 6.393961191177368
Epoch: 8, Steps: 154 | Train Loss: 0.974 Vali Loss: 1.901 Vali Acc: 0.494 Test Loss: 1.901 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.8941683
	speed: 0.1530s/iter; left time: 2152.9923s
Epoch: 9 cost time: 7.330650568008423
Epoch: 9, Steps: 154 | Train Loss: 0.931 Vali Loss: 1.730 Vali Acc: 0.517 Test Loss: 1.730 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.9545296
	speed: 0.1557s/iter; left time: 2167.0359s
Epoch: 10 cost time: 7.354975700378418
Epoch: 10, Steps: 154 | Train Loss: 0.885 Vali Loss: 1.778 Vali Acc: 0.531 Test Loss: 1.778 Test Acc: 0.531
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5560551
	speed: 0.1614s/iter; left time: 2221.1555s
Epoch: 11 cost time: 7.368356943130493
Epoch: 11, Steps: 154 | Train Loss: 0.826 Vali Loss: 2.142 Vali Acc: 0.510 Test Loss: 2.142 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.7972723
	speed: 0.1554s/iter; left time: 2114.8336s
Epoch: 12 cost time: 7.179717540740967
Epoch: 12, Steps: 154 | Train Loss: 0.811 Vali Loss: 1.767 Vali Acc: 0.520 Test Loss: 1.767 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2183728
	speed: 0.1567s/iter; left time: 2108.4090s
Epoch: 13 cost time: 7.213800668716431
Epoch: 13, Steps: 154 | Train Loss: 0.739 Vali Loss: 1.844 Vali Acc: 0.514 Test Loss: 1.844 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.6402406
	speed: 0.1581s/iter; left time: 2102.3200s
Epoch: 14 cost time: 7.113022804260254
Epoch: 14, Steps: 154 | Train Loss: 0.729 Vali Loss: 1.756 Vali Acc: 0.559 Test Loss: 1.756 Test Acc: 0.559
Validation loss decreased (-0.532830 --> -0.559188).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4520767
	speed: 0.1546s/iter; left time: 2032.6233s
Epoch: 15 cost time: 6.891463994979858
Epoch: 15, Steps: 154 | Train Loss: 0.668 Vali Loss: 1.945 Vali Acc: 0.526 Test Loss: 1.945 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.3967500
	speed: 0.1531s/iter; left time: 1989.1425s
Epoch: 16 cost time: 6.774244785308838
Epoch: 16, Steps: 154 | Train Loss: 0.643 Vali Loss: 1.878 Vali Acc: 0.559 Test Loss: 1.878 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.7583302
	speed: 0.1571s/iter; left time: 2017.0269s
Epoch: 17 cost time: 6.994771242141724
Epoch: 17, Steps: 154 | Train Loss: 0.627 Vali Loss: 2.046 Vali Acc: 0.527 Test Loss: 2.046 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4075481
	speed: 0.1527s/iter; left time: 1937.2401s
Epoch: 18 cost time: 7.025233507156372
Epoch: 18, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.056 Vali Acc: 0.516 Test Loss: 2.056 Test Acc: 0.516
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3775584
	speed: 0.1543s/iter; left time: 1932.7817s
Epoch: 19 cost time: 7.093827724456787
Epoch: 19, Steps: 154 | Train Loss: 0.563 Vali Loss: 2.091 Vali Acc: 0.556 Test Loss: 2.091 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.1208161
	speed: 0.1525s/iter; left time: 1887.5748s
Epoch: 20 cost time: 6.908874273300171
Epoch: 20, Steps: 154 | Train Loss: 0.543 Vali Loss: 2.137 Vali Acc: 0.529 Test Loss: 2.137 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2209487
	speed: 0.1531s/iter; left time: 1870.8771s
Epoch: 21 cost time: 6.697235584259033
Epoch: 21, Steps: 154 | Train Loss: 0.523 Vali Loss: 2.516 Vali Acc: 0.505 Test Loss: 2.516 Test Acc: 0.505
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6726184
	speed: 0.1490s/iter; left time: 1797.5548s
Epoch: 22 cost time: 6.898215293884277
Epoch: 22, Steps: 154 | Train Loss: 0.455 Vali Loss: 2.236 Vali Acc: 0.502 Test Loss: 2.236 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.5454113
	speed: 0.1558s/iter; left time: 1855.9965s
Epoch: 23 cost time: 7.069219589233398
Epoch: 23, Steps: 154 | Train Loss: 0.469 Vali Loss: 2.948 Vali Acc: 0.502 Test Loss: 2.948 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.6265275
	speed: 0.1512s/iter; left time: 1778.0099s
Epoch: 24 cost time: 6.954896688461304
Epoch: 24, Steps: 154 | Train Loss: 0.456 Vali Loss: 2.306 Vali Acc: 0.487 Test Loss: 2.306 Test Acc: 0.487
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5592051905920519
model parameter : 62638
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0393817
	speed: 0.0578s/iter; left time: 884.4507s
Epoch: 1 cost time: 8.0215163230896
Epoch: 1, Steps: 154 | Train Loss: 2.303 Vali Loss: 2.017 Vali Acc: 0.365 Test Loss: 2.017 Test Acc: 0.365
Validation loss decreased (inf --> -0.364538).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1772971
	speed: 0.1484s/iter; left time: 2247.0756s
Epoch: 2 cost time: 6.326164484024048
Epoch: 2, Steps: 154 | Train Loss: 1.710 Vali Loss: 1.825 Vali Acc: 0.434 Test Loss: 1.825 Test Acc: 0.434
Validation loss decreased (-0.364538 --> -0.433883).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8547101
	speed: 0.1460s/iter; left time: 2188.2459s
Epoch: 3 cost time: 6.446069240570068
Epoch: 3, Steps: 154 | Train Loss: 1.357 Vali Loss: 1.803 Vali Acc: 0.469 Test Loss: 1.803 Test Acc: 0.469
Validation loss decreased (-0.433883 --> -0.468757).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5472572
	speed: 0.1485s/iter; left time: 2204.0107s
Epoch: 4 cost time: 6.378864288330078
Epoch: 4, Steps: 154 | Train Loss: 1.226 Vali Loss: 1.922 Vali Acc: 0.471 Test Loss: 1.922 Test Acc: 0.471
Validation loss decreased (-0.468757 --> -0.470784).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9046601
	speed: 0.1480s/iter; left time: 2173.4256s
Epoch: 5 cost time: 6.429794788360596
Epoch: 5, Steps: 154 | Train Loss: 1.165 Vali Loss: 1.782 Vali Acc: 0.478 Test Loss: 1.782 Test Acc: 0.478
Validation loss decreased (-0.470784 --> -0.478084).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1866577
	speed: 0.1438s/iter; left time: 2089.8090s
Epoch: 6 cost time: 6.50236177444458
Epoch: 6, Steps: 154 | Train Loss: 1.131 Vali Loss: 1.786 Vali Acc: 0.496 Test Loss: 1.786 Test Acc: 0.496
Validation loss decreased (-0.478084 --> -0.496333).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1027611
	speed: 0.1481s/iter; left time: 2128.5607s
Epoch: 7 cost time: 6.481436014175415
Epoch: 7, Steps: 154 | Train Loss: 1.041 Vali Loss: 1.901 Vali Acc: 0.503 Test Loss: 1.901 Test Acc: 0.503
Validation loss decreased (-0.496333 --> -0.502820).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1901357
	speed: 0.1465s/iter; left time: 2083.5356s
Epoch: 8 cost time: 6.325670957565308
Epoch: 8, Steps: 154 | Train Loss: 1.021 Vali Loss: 1.759 Vali Acc: 0.521 Test Loss: 1.759 Test Acc: 0.521
Validation loss decreased (-0.502820 --> -0.520664).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9013810
	speed: 0.1486s/iter; left time: 2090.4418s
Epoch: 9 cost time: 6.303896188735962
Epoch: 9, Steps: 154 | Train Loss: 0.972 Vali Loss: 1.963 Vali Acc: 0.489 Test Loss: 1.963 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9610519
	speed: 0.1448s/iter; left time: 2015.2348s
Epoch: 10 cost time: 6.341411113739014
Epoch: 10, Steps: 154 | Train Loss: 0.909 Vali Loss: 1.801 Vali Acc: 0.490 Test Loss: 1.801 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5293505
	speed: 0.1548s/iter; left time: 2129.7172s
Epoch: 11 cost time: 7.97290563583374
Epoch: 11, Steps: 154 | Train Loss: 0.871 Vali Loss: 1.744 Vali Acc: 0.525 Test Loss: 1.744 Test Acc: 0.525
Validation loss decreased (-0.520664 --> -0.524719).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7459791
	speed: 0.1656s/iter; left time: 2253.7199s
Epoch: 12 cost time: 7.840333700180054
Epoch: 12, Steps: 154 | Train Loss: 0.816 Vali Loss: 1.875 Vali Acc: 0.506 Test Loss: 1.875 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9428456
	speed: 0.1655s/iter; left time: 2226.9762s
Epoch: 13 cost time: 7.652657747268677
Epoch: 13, Steps: 154 | Train Loss: 0.809 Vali Loss: 1.886 Vali Acc: 0.532 Test Loss: 1.886 Test Acc: 0.532
Validation loss decreased (-0.524719 --> -0.532017).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7368020
	speed: 0.1618s/iter; left time: 2151.6448s
Epoch: 14 cost time: 7.7731335163116455
Epoch: 14, Steps: 154 | Train Loss: 0.766 Vali Loss: 2.210 Vali Acc: 0.513 Test Loss: 2.210 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6155916
	speed: 0.1723s/iter; left time: 2264.9241s
Epoch: 15 cost time: 7.779572248458862
Epoch: 15, Steps: 154 | Train Loss: 0.738 Vali Loss: 2.326 Vali Acc: 0.474 Test Loss: 2.326 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8484876
	speed: 0.1563s/iter; left time: 2030.8993s
Epoch: 16 cost time: 7.051016807556152
Epoch: 16, Steps: 154 | Train Loss: 0.702 Vali Loss: 1.957 Vali Acc: 0.532 Test Loss: 1.957 Test Acc: 0.532
Validation loss decreased (-0.532017 --> -0.532422).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6817772
	speed: 0.1586s/iter; left time: 2035.5274s
Epoch: 17 cost time: 7.272475957870483
Epoch: 17, Steps: 154 | Train Loss: 0.661 Vali Loss: 2.028 Vali Acc: 0.513 Test Loss: 2.028 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6032662
	speed: 0.1601s/iter; left time: 2031.0442s
Epoch: 18 cost time: 7.228421688079834
Epoch: 18, Steps: 154 | Train Loss: 0.627 Vali Loss: 2.133 Vali Acc: 0.483 Test Loss: 2.133 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.7083622
	speed: 0.1564s/iter; left time: 1959.9694s
Epoch: 19 cost time: 6.878223180770874
Epoch: 19, Steps: 154 | Train Loss: 0.592 Vali Loss: 2.210 Vali Acc: 0.494 Test Loss: 2.210 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3208402
	speed: 0.1606s/iter; left time: 1987.7310s
Epoch: 20 cost time: 7.5227370262146
Epoch: 20, Steps: 154 | Train Loss: 0.575 Vali Loss: 2.078 Vali Acc: 0.515 Test Loss: 2.078 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.6465455
	speed: 0.1654s/iter; left time: 2020.8958s
Epoch: 21 cost time: 6.922548055648804
Epoch: 21, Steps: 154 | Train Loss: 0.547 Vali Loss: 2.106 Vali Acc: 0.555 Test Loss: 2.106 Test Acc: 0.555
Validation loss decreased (-0.532422 --> -0.554723).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.9420604
	speed: 0.1594s/iter; left time: 1922.9013s
Epoch: 22 cost time: 7.441182613372803
Epoch: 22, Steps: 154 | Train Loss: 0.528 Vali Loss: 2.103 Vali Acc: 0.507 Test Loss: 2.103 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4868351
	speed: 0.1628s/iter; left time: 1939.4703s
Epoch: 23 cost time: 7.304129362106323
Epoch: 23, Steps: 154 | Train Loss: 0.508 Vali Loss: 2.232 Vali Acc: 0.534 Test Loss: 2.232 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.7582703
	speed: 0.1593s/iter; left time: 1872.7585s
Epoch: 24 cost time: 7.343808174133301
Epoch: 24, Steps: 154 | Train Loss: 0.473 Vali Loss: 2.276 Vali Acc: 0.476 Test Loss: 2.276 Test Acc: 0.476
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.3173341
	speed: 0.1631s/iter; left time: 1893.3416s
Epoch: 25 cost time: 7.1921446323394775
Epoch: 25, Steps: 154 | Train Loss: 0.449 Vali Loss: 2.173 Vali Acc: 0.499 Test Loss: 2.173 Test Acc: 0.499
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.5672650
	speed: 0.1570s/iter; left time: 1797.4188s
Epoch: 26 cost time: 7.077347278594971
Epoch: 26, Steps: 154 | Train Loss: 0.437 Vali Loss: 2.503 Vali Acc: 0.515 Test Loss: 2.503 Test Acc: 0.515
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.7230423
	speed: 0.1595s/iter; left time: 1802.1942s
Epoch: 27 cost time: 7.255338430404663
Epoch: 27, Steps: 154 | Train Loss: 0.444 Vali Loss: 2.360 Vali Acc: 0.503 Test Loss: 2.360 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.2767596
	speed: 0.1522s/iter; left time: 1696.3508s
Epoch: 28 cost time: 6.63329815864563
Epoch: 28, Steps: 154 | Train Loss: 0.396 Vali Loss: 2.431 Vali Acc: 0.528 Test Loss: 2.431 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.3054529
	speed: 0.1497s/iter; left time: 1645.5011s
Epoch: 29 cost time: 6.552854061126709
Epoch: 29, Steps: 154 | Train Loss: 0.382 Vali Loss: 2.759 Vali Acc: 0.500 Test Loss: 2.759 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.6050293
	speed: 0.1493s/iter; left time: 1617.7221s
Epoch: 30 cost time: 6.771842956542969
Epoch: 30, Steps: 154 | Train Loss: 0.384 Vali Loss: 2.768 Vali Acc: 0.486 Test Loss: 2.768 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.4660314
	speed: 0.1501s/iter; left time: 1603.6431s
Epoch: 31 cost time: 6.785313606262207
Epoch: 31, Steps: 154 | Train Loss: 0.355 Vali Loss: 2.503 Vali Acc: 0.519 Test Loss: 2.503 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5547445255474452
model parameter : 57294
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2181451
	speed: 0.0558s/iter; left time: 853.2567s
Epoch: 1 cost time: 7.767593145370483
Epoch: 1, Steps: 154 | Train Loss: 1.983 Vali Loss: 2.207 Vali Acc: 0.372 Test Loss: 2.207 Test Acc: 0.372
Validation loss decreased (inf --> -0.372241).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9963942
	speed: 0.1518s/iter; left time: 2298.7204s
Epoch: 2 cost time: 6.78495979309082
Epoch: 2, Steps: 154 | Train Loss: 1.398 Vali Loss: 1.792 Vali Acc: 0.476 Test Loss: 1.792 Test Acc: 0.476
Validation loss decreased (-0.372241 --> -0.476462).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4581099
	speed: 0.1471s/iter; left time: 2205.1566s
Epoch: 3 cost time: 6.613128185272217
Epoch: 3, Steps: 154 | Train Loss: 1.226 Vali Loss: 1.634 Vali Acc: 0.475 Test Loss: 1.634 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.6691676
	speed: 0.1548s/iter; left time: 2296.3449s
Epoch: 4 cost time: 6.371301651000977
Epoch: 4, Steps: 154 | Train Loss: 1.097 Vali Loss: 1.805 Vali Acc: 0.511 Test Loss: 1.805 Test Acc: 0.511
Validation loss decreased (-0.476462 --> -0.510525).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8543943
	speed: 0.1309s/iter; left time: 1922.4906s
Epoch: 5 cost time: 6.05328369140625
Epoch: 5, Steps: 154 | Train Loss: 1.011 Vali Loss: 1.954 Vali Acc: 0.495 Test Loss: 1.954 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0563147
	speed: 0.1483s/iter; left time: 2155.0145s
Epoch: 6 cost time: 6.663088083267212
Epoch: 6, Steps: 154 | Train Loss: 0.936 Vali Loss: 2.101 Vali Acc: 0.489 Test Loss: 2.101 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9389997
	speed: 0.1502s/iter; left time: 2159.8214s
Epoch: 7 cost time: 7.441874742507935
Epoch: 7, Steps: 154 | Train Loss: 0.853 Vali Loss: 2.155 Vali Acc: 0.472 Test Loss: 2.155 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1247486
	speed: 0.1592s/iter; left time: 2264.3078s
Epoch: 8 cost time: 7.384644508361816
Epoch: 8, Steps: 154 | Train Loss: 0.769 Vali Loss: 2.075 Vali Acc: 0.526 Test Loss: 2.075 Test Acc: 0.526
Validation loss decreased (-0.510525 --> -0.526338).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4075686
	speed: 0.1566s/iter; left time: 2203.0980s
Epoch: 9 cost time: 7.440940618515015
Epoch: 9, Steps: 154 | Train Loss: 0.677 Vali Loss: 2.390 Vali Acc: 0.527 Test Loss: 2.390 Test Acc: 0.527
Validation loss decreased (-0.526338 --> -0.527146).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9953672
	speed: 0.1551s/iter; left time: 2157.6305s
Epoch: 10 cost time: 7.133331537246704
Epoch: 10, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.465 Vali Acc: 0.469 Test Loss: 2.465 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7365823
	speed: 0.1573s/iter; left time: 2164.0207s
Epoch: 11 cost time: 7.552717924118042
Epoch: 11, Steps: 154 | Train Loss: 0.532 Vali Loss: 2.856 Vali Acc: 0.506 Test Loss: 2.856 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.3447892
	speed: 0.1490s/iter; left time: 2027.8593s
Epoch: 12 cost time: 6.331054449081421
Epoch: 12, Steps: 154 | Train Loss: 0.494 Vali Loss: 2.850 Vali Acc: 0.484 Test Loss: 2.850 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6546730
	speed: 0.1386s/iter; left time: 1864.1547s
Epoch: 13 cost time: 6.622420072555542
Epoch: 13, Steps: 154 | Train Loss: 0.490 Vali Loss: 2.735 Vali Acc: 0.506 Test Loss: 2.735 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5887971
	speed: 0.1499s/iter; left time: 1994.1768s
Epoch: 14 cost time: 7.376992464065552
Epoch: 14, Steps: 154 | Train Loss: 0.444 Vali Loss: 2.840 Vali Acc: 0.453 Test Loss: 2.840 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.5421259
	speed: 0.1532s/iter; left time: 2014.4299s
Epoch: 15 cost time: 7.136949777603149
Epoch: 15, Steps: 154 | Train Loss: 0.402 Vali Loss: 2.927 Vali Acc: 0.491 Test Loss: 2.927 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.3863670
	speed: 0.1554s/iter; left time: 2018.7086s
Epoch: 16 cost time: 7.144801378250122
Epoch: 16, Steps: 154 | Train Loss: 0.346 Vali Loss: 2.811 Vali Acc: 0.475 Test Loss: 2.811 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3985252
	speed: 0.1543s/iter; left time: 1980.6767s
Epoch: 17 cost time: 6.897174119949341
Epoch: 17, Steps: 154 | Train Loss: 0.339 Vali Loss: 3.246 Vali Acc: 0.517 Test Loss: 3.246 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1032781
	speed: 0.1510s/iter; left time: 1914.7956s
Epoch: 18 cost time: 6.98370361328125
Epoch: 18, Steps: 154 | Train Loss: 0.304 Vali Loss: 3.412 Vali Acc: 0.462 Test Loss: 3.412 Test Acc: 0.462
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1717717
	speed: 0.1545s/iter; left time: 1935.6772s
Epoch: 19 cost time: 7.292724132537842
Epoch: 19, Steps: 154 | Train Loss: 0.296 Vali Loss: 3.276 Vali Acc: 0.502 Test Loss: 3.276 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.527169505271695
model parameter : 122542
model size : 1.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5665392
	speed: 0.0599s/iter; left time: 915.7762s
Epoch: 1 cost time: 8.444175481796265
Epoch: 1, Steps: 154 | Train Loss: 2.107 Vali Loss: 1.726 Vali Acc: 0.430 Test Loss: 1.726 Test Acc: 0.430
Validation loss decreased (inf --> -0.429829).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4656157
	speed: 0.1468s/iter; left time: 2224.2684s
Epoch: 2 cost time: 6.872931957244873
Epoch: 2, Steps: 154 | Train Loss: 1.475 Vali Loss: 1.900 Vali Acc: 0.448 Test Loss: 1.900 Test Acc: 0.448
Validation loss decreased (-0.429829 --> -0.447670).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5295554
	speed: 0.1528s/iter; left time: 2291.4208s
Epoch: 3 cost time: 6.987596750259399
Epoch: 3, Steps: 154 | Train Loss: 1.243 Vali Loss: 1.774 Vali Acc: 0.487 Test Loss: 1.774 Test Acc: 0.487
Validation loss decreased (-0.447670 --> -0.487006).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5794842
	speed: 0.1460s/iter; left time: 2166.7174s
Epoch: 4 cost time: 6.303967237472534
Epoch: 4, Steps: 154 | Train Loss: 1.144 Vali Loss: 2.022 Vali Acc: 0.436 Test Loss: 2.022 Test Acc: 0.436
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8846464
	speed: 0.1435s/iter; left time: 2107.9973s
Epoch: 5 cost time: 6.283078908920288
Epoch: 5, Steps: 154 | Train Loss: 1.045 Vali Loss: 1.790 Vali Acc: 0.485 Test Loss: 1.790 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1345572
	speed: 0.1385s/iter; left time: 2012.6019s
Epoch: 6 cost time: 6.317666053771973
Epoch: 6, Steps: 154 | Train Loss: 0.990 Vali Loss: 1.728 Vali Acc: 0.490 Test Loss: 1.728 Test Acc: 0.490
Validation loss decreased (-0.487006 --> -0.490250).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7390600
	speed: 0.1447s/iter; left time: 2080.1158s
Epoch: 7 cost time: 6.216238737106323
Epoch: 7, Steps: 154 | Train Loss: 0.925 Vali Loss: 1.752 Vali Acc: 0.535 Test Loss: 1.752 Test Acc: 0.535
Validation loss decreased (-0.490250 --> -0.535262).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4063798
	speed: 0.1342s/iter; left time: 1908.1756s
Epoch: 8 cost time: 5.957045078277588
Epoch: 8, Steps: 154 | Train Loss: 0.851 Vali Loss: 1.829 Vali Acc: 0.521 Test Loss: 1.829 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5834225
	speed: 0.1399s/iter; left time: 1968.2292s
Epoch: 9 cost time: 6.417452335357666
Epoch: 9, Steps: 154 | Train Loss: 0.808 Vali Loss: 1.848 Vali Acc: 0.498 Test Loss: 1.848 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6993524
	speed: 0.1421s/iter; left time: 1977.7939s
Epoch: 10 cost time: 6.541131258010864
Epoch: 10, Steps: 154 | Train Loss: 0.744 Vali Loss: 1.913 Vali Acc: 0.481 Test Loss: 1.913 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5387426
	speed: 0.1390s/iter; left time: 1913.2862s
Epoch: 11 cost time: 5.998899936676025
Epoch: 11, Steps: 154 | Train Loss: 0.710 Vali Loss: 1.872 Vali Acc: 0.549 Test Loss: 1.872 Test Acc: 0.549
Validation loss decreased (-0.535262 --> -0.549454).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8708826
	speed: 0.1404s/iter; left time: 1910.0909s
Epoch: 12 cost time: 5.89265775680542
Epoch: 12, Steps: 154 | Train Loss: 0.668 Vali Loss: 2.050 Vali Acc: 0.500 Test Loss: 2.050 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3115495
	speed: 0.1381s/iter; left time: 1857.8224s
Epoch: 13 cost time: 6.133741617202759
Epoch: 13, Steps: 154 | Train Loss: 0.601 Vali Loss: 1.942 Vali Acc: 0.543 Test Loss: 1.942 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.5687073
	speed: 0.1403s/iter; left time: 1865.6533s
Epoch: 14 cost time: 6.033606767654419
Epoch: 14, Steps: 154 | Train Loss: 0.574 Vali Loss: 2.128 Vali Acc: 0.466 Test Loss: 2.128 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6535510
	speed: 0.1392s/iter; left time: 1830.1644s
Epoch: 15 cost time: 5.802870988845825
Epoch: 15, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.013 Vali Acc: 0.519 Test Loss: 2.013 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.2656329
	speed: 0.1213s/iter; left time: 1575.7711s
Epoch: 16 cost time: 6.7658164501190186
Epoch: 16, Steps: 154 | Train Loss: 0.513 Vali Loss: 2.112 Vali Acc: 0.519 Test Loss: 2.112 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1797608
	speed: 0.1528s/iter; left time: 1961.6686s
Epoch: 17 cost time: 6.929541826248169
Epoch: 17, Steps: 154 | Train Loss: 0.460 Vali Loss: 2.401 Vali Acc: 0.518 Test Loss: 2.401 Test Acc: 0.518
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.7962229
	speed: 0.1464s/iter; left time: 1856.8544s
Epoch: 18 cost time: 6.8052027225494385
Epoch: 18, Steps: 154 | Train Loss: 0.458 Vali Loss: 2.215 Vali Acc: 0.491 Test Loss: 2.215 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.4798012
	speed: 0.1493s/iter; left time: 1870.2032s
Epoch: 19 cost time: 7.0061235427856445
Epoch: 19, Steps: 154 | Train Loss: 0.443 Vali Loss: 2.379 Vali Acc: 0.519 Test Loss: 2.379 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.2974791
	speed: 0.1483s/iter; left time: 1835.7387s
Epoch: 20 cost time: 5.71696400642395
Epoch: 20, Steps: 154 | Train Loss: 0.407 Vali Loss: 2.546 Vali Acc: 0.479 Test Loss: 2.546 Test Acc: 0.479
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.2370678
	speed: 0.0906s/iter; left time: 1107.5770s
Epoch: 21 cost time: 3.7469027042388916
Epoch: 21, Steps: 154 | Train Loss: 0.372 Vali Loss: 2.485 Vali Acc: 0.528 Test Loss: 2.485 Test Acc: 0.528
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5494728304947283
model parameter : 74190
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9207858
	speed: 0.0592s/iter; left time: 905.5425s
Epoch: 1 cost time: 8.345706701278687
Epoch: 1, Steps: 154 | Train Loss: 2.036 Vali Loss: 1.907 Vali Acc: 0.384 Test Loss: 1.907 Test Acc: 0.384
Validation loss decreased (inf --> -0.383598).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0216360
	speed: 0.1507s/iter; left time: 2281.9251s
Epoch: 2 cost time: 6.852601528167725
Epoch: 2, Steps: 154 | Train Loss: 1.397 Vali Loss: 1.838 Vali Acc: 0.458 Test Loss: 1.838 Test Acc: 0.458
Validation loss decreased (-0.383598 --> -0.457808).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8143745
	speed: 0.1442s/iter; left time: 2162.3445s
Epoch: 3 cost time: 6.790056228637695
Epoch: 3, Steps: 154 | Train Loss: 1.230 Vali Loss: 1.782 Vali Acc: 0.490 Test Loss: 1.782 Test Acc: 0.490
Validation loss decreased (-0.457808 --> -0.490250).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4699836
	speed: 0.1540s/iter; left time: 2284.5450s
Epoch: 4 cost time: 6.955163240432739
Epoch: 4, Steps: 154 | Train Loss: 1.130 Vali Loss: 2.165 Vali Acc: 0.438 Test Loss: 2.165 Test Acc: 0.438
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3984579
	speed: 0.1653s/iter; left time: 2427.8340s
Epoch: 5 cost time: 7.6167237758636475
Epoch: 5, Steps: 154 | Train Loss: 1.083 Vali Loss: 1.923 Vali Acc: 0.476 Test Loss: 1.923 Test Acc: 0.476
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0106490
	speed: 0.1645s/iter; left time: 2390.3705s
Epoch: 6 cost time: 7.420872211456299
Epoch: 6, Steps: 154 | Train Loss: 0.981 Vali Loss: 2.024 Vali Acc: 0.474 Test Loss: 2.024 Test Acc: 0.474
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.6177342
	speed: 0.1625s/iter; left time: 2336.1577s
Epoch: 7 cost time: 7.5459513664245605
Epoch: 7, Steps: 154 | Train Loss: 0.953 Vali Loss: 1.804 Vali Acc: 0.517 Test Loss: 1.804 Test Acc: 0.517
Validation loss decreased (-0.490250 --> -0.516608).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0100262
	speed: 0.1683s/iter; left time: 2394.0835s
Epoch: 8 cost time: 6.6795737743377686
Epoch: 8, Steps: 154 | Train Loss: 0.869 Vali Loss: 1.916 Vali Acc: 0.522 Test Loss: 1.916 Test Acc: 0.522
Validation loss decreased (-0.516608 --> -0.522284).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5070770
	speed: 0.1521s/iter; left time: 2140.2165s
Epoch: 9 cost time: 7.436601638793945
Epoch: 9, Steps: 154 | Train Loss: 0.816 Vali Loss: 1.849 Vali Acc: 0.559 Test Loss: 1.849 Test Acc: 0.559
Validation loss decreased (-0.522284 --> -0.559187).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7913251
	speed: 0.1665s/iter; left time: 2317.1710s
Epoch: 10 cost time: 7.3809685707092285
Epoch: 10, Steps: 154 | Train Loss: 0.762 Vali Loss: 1.948 Vali Acc: 0.504 Test Loss: 1.948 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4995611
	speed: 0.1502s/iter; left time: 2066.8832s
Epoch: 11 cost time: 7.084612607955933
Epoch: 11, Steps: 154 | Train Loss: 0.718 Vali Loss: 2.058 Vali Acc: 0.468 Test Loss: 2.058 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4225348
	speed: 0.1587s/iter; left time: 2160.1093s
Epoch: 12 cost time: 6.964755296707153
Epoch: 12, Steps: 154 | Train Loss: 0.651 Vali Loss: 1.974 Vali Acc: 0.548 Test Loss: 1.974 Test Acc: 0.548
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5445883
	speed: 0.1534s/iter; left time: 2063.6584s
Epoch: 13 cost time: 7.052103757858276
Epoch: 13, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.122 Vali Acc: 0.567 Test Loss: 2.122 Test Acc: 0.567
Validation loss decreased (-0.559187 --> -0.566889).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3601257
	speed: 0.1551s/iter; left time: 2062.6021s
Epoch: 14 cost time: 6.986461162567139
Epoch: 14, Steps: 154 | Train Loss: 0.617 Vali Loss: 2.055 Vali Acc: 0.541 Test Loss: 2.055 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0407010
	speed: 0.1525s/iter; left time: 2004.8151s
Epoch: 15 cost time: 6.517634868621826
Epoch: 15, Steps: 154 | Train Loss: 0.535 Vali Loss: 2.196 Vali Acc: 0.524 Test Loss: 2.196 Test Acc: 0.524
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3988561
	speed: 0.1433s/iter; left time: 1862.0141s
Epoch: 16 cost time: 6.46051025390625
Epoch: 16, Steps: 154 | Train Loss: 0.495 Vali Loss: 2.166 Vali Acc: 0.532 Test Loss: 2.166 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.2028634
	speed: 0.1437s/iter; left time: 1845.0327s
Epoch: 17 cost time: 6.249534368515015
Epoch: 17, Steps: 154 | Train Loss: 0.478 Vali Loss: 2.235 Vali Acc: 0.506 Test Loss: 2.235 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4957179
	speed: 0.1382s/iter; left time: 1753.1453s
Epoch: 18 cost time: 5.7950170040130615
Epoch: 18, Steps: 154 | Train Loss: 0.445 Vali Loss: 2.322 Vali Acc: 0.510 Test Loss: 2.322 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4166273
	speed: 0.1464s/iter; left time: 1834.1867s
Epoch: 19 cost time: 6.512221336364746
Epoch: 19, Steps: 154 | Train Loss: 0.386 Vali Loss: 2.422 Vali Acc: 0.495 Test Loss: 2.422 Test Acc: 0.495
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2218442
	speed: 0.1439s/iter; left time: 1781.1991s
Epoch: 20 cost time: 6.507925748825073
Epoch: 20, Steps: 154 | Train Loss: 0.389 Vali Loss: 2.605 Vali Acc: 0.464 Test Loss: 2.605 Test Acc: 0.464
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1649217
	speed: 0.1418s/iter; left time: 1732.6175s
Epoch: 21 cost time: 6.047330379486084
Epoch: 21, Steps: 154 | Train Loss: 0.371 Vali Loss: 2.612 Vali Acc: 0.491 Test Loss: 2.612 Test Acc: 0.491
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2163464
	speed: 0.1334s/iter; left time: 1610.3364s
Epoch: 22 cost time: 5.642206907272339
Epoch: 22, Steps: 154 | Train Loss: 0.336 Vali Loss: 2.563 Vali Acc: 0.527 Test Loss: 2.563 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2004680
	speed: 0.1358s/iter; left time: 1618.1129s
Epoch: 23 cost time: 5.9749226570129395
Epoch: 23, Steps: 154 | Train Loss: 0.338 Vali Loss: 2.670 Vali Acc: 0.542 Test Loss: 2.670 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5669099756690997
model parameter : 74222
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6360723
	speed: 0.0617s/iter; left time: 944.4103s
Epoch: 1 cost time: 8.622290134429932
Epoch: 1, Steps: 154 | Train Loss: 2.155 Vali Loss: 1.821 Vali Acc: 0.421 Test Loss: 1.821 Test Acc: 0.421
Validation loss decreased (inf --> -0.420906).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5771281
	speed: 0.1500s/iter; left time: 2271.4259s
Epoch: 2 cost time: 6.9181907176971436
Epoch: 2, Steps: 154 | Train Loss: 1.513 Vali Loss: 1.855 Vali Acc: 0.457 Test Loss: 1.855 Test Acc: 0.457
Validation loss decreased (-0.420906 --> -0.456591).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4186281
	speed: 0.1511s/iter; left time: 2265.2592s
Epoch: 3 cost time: 6.879726886749268
Epoch: 3, Steps: 154 | Train Loss: 1.281 Vali Loss: 1.769 Vali Acc: 0.459 Test Loss: 1.769 Test Acc: 0.459
Validation loss decreased (-0.456591 --> -0.459025).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9314062
	speed: 0.1477s/iter; left time: 2192.2231s
Epoch: 4 cost time: 6.883241891860962
Epoch: 4, Steps: 154 | Train Loss: 1.194 Vali Loss: 1.807 Vali Acc: 0.476 Test Loss: 1.807 Test Acc: 0.476
Validation loss decreased (-0.459025 --> -0.475651).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4504580
	speed: 0.1518s/iter; left time: 2229.8877s
Epoch: 5 cost time: 7.10111665725708
Epoch: 5, Steps: 154 | Train Loss: 1.101 Vali Loss: 1.731 Vali Acc: 0.470 Test Loss: 1.731 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8420117
	speed: 0.1537s/iter; left time: 2232.6927s
Epoch: 6 cost time: 7.112909555435181
Epoch: 6, Steps: 154 | Train Loss: 1.042 Vali Loss: 1.813 Vali Acc: 0.505 Test Loss: 1.813 Test Acc: 0.505
Validation loss decreased (-0.475651 --> -0.504848).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3045255
	speed: 0.1501s/iter; left time: 2157.9671s
Epoch: 7 cost time: 6.699057579040527
Epoch: 7, Steps: 154 | Train Loss: 0.983 Vali Loss: 1.873 Vali Acc: 0.498 Test Loss: 1.873 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8495575
	speed: 0.1498s/iter; left time: 2130.6709s
Epoch: 8 cost time: 6.753896236419678
Epoch: 8, Steps: 154 | Train Loss: 0.934 Vali Loss: 1.864 Vali Acc: 0.539 Test Loss: 1.864 Test Acc: 0.539
Validation loss decreased (-0.504848 --> -0.538911).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6715462
	speed: 0.1547s/iter; left time: 2176.4337s
Epoch: 9 cost time: 6.872171640396118
Epoch: 9, Steps: 154 | Train Loss: 0.884 Vali Loss: 1.796 Vali Acc: 0.528 Test Loss: 1.796 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0396594
	speed: 0.1516s/iter; left time: 2109.0509s
Epoch: 10 cost time: 6.827090501785278
Epoch: 10, Steps: 154 | Train Loss: 0.810 Vali Loss: 2.169 Vali Acc: 0.475 Test Loss: 2.169 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.4821883
	speed: 0.1504s/iter; left time: 2069.3731s
Epoch: 11 cost time: 6.772071599960327
Epoch: 11, Steps: 154 | Train Loss: 0.781 Vali Loss: 2.176 Vali Acc: 0.483 Test Loss: 2.176 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.9918726
	speed: 0.1523s/iter; left time: 2071.9042s
Epoch: 12 cost time: 6.475247859954834
Epoch: 12, Steps: 154 | Train Loss: 0.740 Vali Loss: 2.106 Vali Acc: 0.488 Test Loss: 2.106 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9994981
	speed: 0.1466s/iter; left time: 1972.3275s
Epoch: 13 cost time: 6.506070613861084
Epoch: 13, Steps: 154 | Train Loss: 0.705 Vali Loss: 2.009 Vali Acc: 0.517 Test Loss: 2.009 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7892777
	speed: 0.1507s/iter; left time: 2003.9633s
Epoch: 14 cost time: 6.710792541503906
Epoch: 14, Steps: 154 | Train Loss: 0.656 Vali Loss: 1.996 Vali Acc: 0.521 Test Loss: 1.996 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1341770
	speed: 0.1425s/iter; left time: 1873.7116s
Epoch: 15 cost time: 5.692449569702148
Epoch: 15, Steps: 154 | Train Loss: 0.616 Vali Loss: 2.131 Vali Acc: 0.528 Test Loss: 2.131 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.6595185
	speed: 0.1392s/iter; left time: 1808.2592s
Epoch: 16 cost time: 5.9958336353302
Epoch: 16, Steps: 154 | Train Loss: 0.589 Vali Loss: 2.057 Vali Acc: 0.519 Test Loss: 2.057 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.4548991
	speed: 0.1330s/iter; left time: 1707.7478s
Epoch: 17 cost time: 5.59029221534729
Epoch: 17, Steps: 154 | Train Loss: 0.573 Vali Loss: 2.344 Vali Acc: 0.502 Test Loss: 2.344 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.8318251
	speed: 0.1320s/iter; left time: 1674.0053s
Epoch: 18 cost time: 5.910977125167847
Epoch: 18, Steps: 154 | Train Loss: 0.532 Vali Loss: 2.190 Vali Acc: 0.496 Test Loss: 2.190 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5389294403892944
model parameter : 58158
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2139812
	speed: 0.0533s/iter; left time: 815.5496s
Epoch: 1 cost time: 7.445757865905762
Epoch: 1, Steps: 154 | Train Loss: 2.227 Vali Loss: 1.896 Vali Acc: 0.377 Test Loss: 1.896 Test Acc: 0.377
Validation loss decreased (inf --> -0.377110).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6270326
	speed: 0.1350s/iter; left time: 2044.6736s
Epoch: 2 cost time: 5.62192177772522
Epoch: 2, Steps: 154 | Train Loss: 1.614 Vali Loss: 1.803 Vali Acc: 0.411 Test Loss: 1.803 Test Acc: 0.411
Validation loss decreased (-0.377110 --> -0.410769).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2560986
	speed: 0.1268s/iter; left time: 1900.4260s
Epoch: 3 cost time: 5.562946796417236
Epoch: 3, Steps: 154 | Train Loss: 1.338 Vali Loss: 1.718 Vali Acc: 0.466 Test Loss: 1.718 Test Acc: 0.466
Validation loss decreased (-0.410769 --> -0.465514).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8629836
	speed: 0.1319s/iter; left time: 1957.7764s
Epoch: 4 cost time: 6.168396234512329
Epoch: 4, Steps: 154 | Train Loss: 1.226 Vali Loss: 2.124 Vali Acc: 0.451 Test Loss: 2.124 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1918117
	speed: 0.1322s/iter; left time: 1941.6539s
Epoch: 5 cost time: 5.524679183959961
Epoch: 5, Steps: 154 | Train Loss: 1.153 Vali Loss: 1.679 Vali Acc: 0.515 Test Loss: 1.679 Test Acc: 0.515
Validation loss decreased (-0.465514 --> -0.514987).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4456704
	speed: 0.1451s/iter; left time: 2109.1385s
Epoch: 6 cost time: 6.582442283630371
Epoch: 6, Steps: 154 | Train Loss: 1.102 Vali Loss: 1.950 Vali Acc: 0.482 Test Loss: 1.950 Test Acc: 0.482
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4365852
	speed: 0.1463s/iter; left time: 2103.1707s
Epoch: 7 cost time: 6.536597490310669
Epoch: 7, Steps: 154 | Train Loss: 1.046 Vali Loss: 1.649 Vali Acc: 0.521 Test Loss: 1.649 Test Acc: 0.521
Validation loss decreased (-0.514987 --> -0.520665).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6743062
	speed: 0.1514s/iter; left time: 2153.5492s
Epoch: 8 cost time: 6.762906074523926
Epoch: 8, Steps: 154 | Train Loss: 0.996 Vali Loss: 1.786 Vali Acc: 0.504 Test Loss: 1.786 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4695382
	speed: 0.1479s/iter; left time: 2080.8372s
Epoch: 9 cost time: 6.83949875831604
Epoch: 9, Steps: 154 | Train Loss: 0.940 Vali Loss: 1.580 Vali Acc: 0.549 Test Loss: 1.580 Test Acc: 0.549
Validation loss decreased (-0.520665 --> -0.548646).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2197310
	speed: 0.1457s/iter; left time: 2027.0982s
Epoch: 10 cost time: 6.458162307739258
Epoch: 10, Steps: 154 | Train Loss: 0.900 Vali Loss: 1.780 Vali Acc: 0.513 Test Loss: 1.780 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2812461
	speed: 0.1476s/iter; left time: 2030.7134s
Epoch: 11 cost time: 6.422922134399414
Epoch: 11, Steps: 154 | Train Loss: 0.882 Vali Loss: 1.811 Vali Acc: 0.502 Test Loss: 1.811 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7288868
	speed: 0.1449s/iter; left time: 1971.6975s
Epoch: 12 cost time: 6.547441482543945
Epoch: 12, Steps: 154 | Train Loss: 0.826 Vali Loss: 1.900 Vali Acc: 0.468 Test Loss: 1.900 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0341810
	speed: 0.1455s/iter; left time: 1957.4351s
Epoch: 13 cost time: 6.695483684539795
Epoch: 13, Steps: 154 | Train Loss: 0.793 Vali Loss: 1.741 Vali Acc: 0.550 Test Loss: 1.741 Test Acc: 0.550
Validation loss decreased (-0.548646 --> -0.550266).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5260051
	speed: 0.1494s/iter; left time: 1986.7385s
Epoch: 14 cost time: 6.987863302230835
Epoch: 14, Steps: 154 | Train Loss: 0.713 Vali Loss: 1.822 Vali Acc: 0.484 Test Loss: 1.822 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0064383
	speed: 0.1429s/iter; left time: 1878.2891s
Epoch: 15 cost time: 6.599839687347412
Epoch: 15, Steps: 154 | Train Loss: 0.701 Vali Loss: 1.972 Vali Acc: 0.478 Test Loss: 1.972 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7044674
	speed: 0.1448s/iter; left time: 1880.9044s
Epoch: 16 cost time: 6.353842735290527
Epoch: 16, Steps: 154 | Train Loss: 0.680 Vali Loss: 2.133 Vali Acc: 0.483 Test Loss: 2.133 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0092070
	speed: 0.1433s/iter; left time: 1840.1647s
Epoch: 17 cost time: 6.337752103805542
Epoch: 17, Steps: 154 | Train Loss: 0.641 Vali Loss: 2.000 Vali Acc: 0.509 Test Loss: 2.000 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3644569
	speed: 0.1449s/iter; left time: 1838.2499s
Epoch: 18 cost time: 6.549231767654419
Epoch: 18, Steps: 154 | Train Loss: 0.617 Vali Loss: 2.174 Vali Acc: 0.502 Test Loss: 2.174 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.5864271
	speed: 0.1479s/iter; left time: 1853.0922s
Epoch: 19 cost time: 6.661275863647461
Epoch: 19, Steps: 154 | Train Loss: 0.580 Vali Loss: 2.289 Vali Acc: 0.493 Test Loss: 2.289 Test Acc: 0.493
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.4824911
	speed: 0.1391s/iter; left time: 1721.3776s
Epoch: 20 cost time: 5.781456232070923
Epoch: 20, Steps: 154 | Train Loss: 0.557 Vali Loss: 2.126 Vali Acc: 0.499 Test Loss: 2.126 Test Acc: 0.499
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6196682
	speed: 0.1328s/iter; left time: 1622.5522s
Epoch: 21 cost time: 5.665349245071411
Epoch: 21, Steps: 154 | Train Loss: 0.521 Vali Loss: 2.260 Vali Acc: 0.476 Test Loss: 2.260 Test Acc: 0.476
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.7488633
	speed: 0.1367s/iter; left time: 1649.7925s
Epoch: 22 cost time: 5.8055174350738525
Epoch: 22, Steps: 154 | Train Loss: 0.498 Vali Loss: 2.128 Vali Acc: 0.541 Test Loss: 2.128 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.5496725
	speed: 0.1396s/iter; left time: 1662.8766s
Epoch: 23 cost time: 5.933484792709351
Epoch: 23, Steps: 154 | Train Loss: 0.500 Vali Loss: 2.203 Vali Acc: 0.501 Test Loss: 2.203 Test Acc: 0.501
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5502838605028386
model parameter : 50158
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5863163
	speed: 0.0519s/iter; left time: 793.5067s
Epoch: 1 cost time: 7.067867040634155
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 1.967 Vali Acc: 0.399 Test Loss: 1.967 Test Acc: 0.399
Validation loss decreased (inf --> -0.399007).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5965406
	speed: 0.1317s/iter; left time: 1994.4178s
Epoch: 2 cost time: 5.96196174621582
Epoch: 2, Steps: 154 | Train Loss: 1.687 Vali Loss: 1.767 Vali Acc: 0.432 Test Loss: 1.767 Test Acc: 0.432
Validation loss decreased (-0.399007 --> -0.431856).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3795656
	speed: 0.1334s/iter; left time: 2000.4556s
Epoch: 3 cost time: 6.10731840133667
Epoch: 3, Steps: 154 | Train Loss: 1.363 Vali Loss: 1.813 Vali Acc: 0.472 Test Loss: 1.813 Test Acc: 0.472
Validation loss decreased (-0.431856 --> -0.471596).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4527200
	speed: 0.1416s/iter; left time: 2101.3998s
Epoch: 4 cost time: 6.86820387840271
Epoch: 4, Steps: 154 | Train Loss: 1.219 Vali Loss: 1.644 Vali Acc: 0.491 Test Loss: 1.644 Test Acc: 0.491
Validation loss decreased (-0.471596 --> -0.491468).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5595001
	speed: 0.1522s/iter; left time: 2235.4692s
Epoch: 5 cost time: 7.133738040924072
Epoch: 5, Steps: 154 | Train Loss: 1.179 Vali Loss: 1.767 Vali Acc: 0.505 Test Loss: 1.767 Test Acc: 0.505
Validation loss decreased (-0.491468 --> -0.504849).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0960414
	speed: 0.1510s/iter; left time: 2193.9116s
Epoch: 6 cost time: 6.8607566356658936
Epoch: 6, Steps: 154 | Train Loss: 1.115 Vali Loss: 1.782 Vali Acc: 0.490 Test Loss: 1.782 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1546350
	speed: 0.1563s/iter; left time: 2247.3672s
Epoch: 7 cost time: 7.376892566680908
Epoch: 7, Steps: 154 | Train Loss: 1.063 Vali Loss: 1.788 Vali Acc: 0.490 Test Loss: 1.788 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3464532
	speed: 0.1616s/iter; left time: 2298.0042s
Epoch: 8 cost time: 7.259119272232056
Epoch: 8, Steps: 154 | Train Loss: 1.008 Vali Loss: 1.693 Vali Acc: 0.531 Test Loss: 1.693 Test Acc: 0.531
Validation loss decreased (-0.504849 --> -0.531208).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8611777
	speed: 0.1601s/iter; left time: 2252.4492s
Epoch: 9 cost time: 7.042943000793457
Epoch: 9, Steps: 154 | Train Loss: 0.964 Vali Loss: 1.726 Vali Acc: 0.544 Test Loss: 1.726 Test Acc: 0.544
Validation loss decreased (-0.531208 --> -0.543778).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0509951
	speed: 0.1539s/iter; left time: 2141.4626s
Epoch: 10 cost time: 7.235543489456177
Epoch: 10, Steps: 154 | Train Loss: 0.930 Vali Loss: 1.729 Vali Acc: 0.517 Test Loss: 1.729 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0866977
	speed: 0.1609s/iter; left time: 2213.4742s
Epoch: 11 cost time: 7.222707748413086
Epoch: 11, Steps: 154 | Train Loss: 0.880 Vali Loss: 1.688 Vali Acc: 0.532 Test Loss: 1.688 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.5385278
	speed: 0.1582s/iter; left time: 2152.8448s
Epoch: 12 cost time: 7.318464994430542
Epoch: 12, Steps: 154 | Train Loss: 0.870 Vali Loss: 1.636 Vali Acc: 0.552 Test Loss: 1.636 Test Acc: 0.552
Validation loss decreased (-0.543778 --> -0.552295).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6952533
	speed: 0.1608s/iter; left time: 2162.7157s
Epoch: 13 cost time: 7.434032678604126
Epoch: 13, Steps: 154 | Train Loss: 0.810 Vali Loss: 1.789 Vali Acc: 0.528 Test Loss: 1.789 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1637702
	speed: 0.1544s/iter; left time: 2052.7592s
Epoch: 14 cost time: 6.794536352157593
Epoch: 14, Steps: 154 | Train Loss: 0.791 Vali Loss: 1.879 Vali Acc: 0.514 Test Loss: 1.879 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4722108
	speed: 0.1462s/iter; left time: 1921.9645s
Epoch: 15 cost time: 6.847243547439575
Epoch: 15, Steps: 154 | Train Loss: 0.733 Vali Loss: 1.788 Vali Acc: 0.531 Test Loss: 1.788 Test Acc: 0.531
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6571157
	speed: 0.1498s/iter; left time: 1946.6993s
Epoch: 16 cost time: 6.739311695098877
Epoch: 16, Steps: 154 | Train Loss: 0.728 Vali Loss: 1.955 Vali Acc: 0.540 Test Loss: 1.955 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0097928
	speed: 0.1489s/iter; left time: 1911.2737s
Epoch: 17 cost time: 6.786083936691284
Epoch: 17, Steps: 154 | Train Loss: 0.659 Vali Loss: 2.003 Vali Acc: 0.521 Test Loss: 2.003 Test Acc: 0.521
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2850855
	speed: 0.1496s/iter; left time: 1897.5716s
Epoch: 18 cost time: 6.619158983230591
Epoch: 18, Steps: 154 | Train Loss: 0.676 Vali Loss: 2.155 Vali Acc: 0.491 Test Loss: 2.155 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6654527
	speed: 0.1470s/iter; left time: 1841.1429s
Epoch: 19 cost time: 6.833810091018677
Epoch: 19, Steps: 154 | Train Loss: 0.670 Vali Loss: 1.905 Vali Acc: 0.541 Test Loss: 1.905 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6034904
	speed: 0.1375s/iter; left time: 1701.7442s
Epoch: 20 cost time: 5.965755462646484
Epoch: 20, Steps: 154 | Train Loss: 0.584 Vali Loss: 1.923 Vali Acc: 0.549 Test Loss: 1.923 Test Acc: 0.549
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.8415068
	speed: 0.1409s/iter; left time: 1721.6033s
Epoch: 21 cost time: 6.123240232467651
Epoch: 21, Steps: 154 | Train Loss: 0.581 Vali Loss: 2.529 Vali Acc: 0.472 Test Loss: 2.529 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5961791
	speed: 0.1360s/iter; left time: 1640.6049s
Epoch: 22 cost time: 5.867372989654541
Epoch: 22, Steps: 154 | Train Loss: 0.555 Vali Loss: 2.107 Vali Acc: 0.494 Test Loss: 2.107 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm32_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5523114355231143
model parameter : 44814
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1283059
	speed: 0.0541s/iter; left time: 827.2676s
Epoch: 1 cost time: 7.662376642227173
Epoch: 1, Steps: 154 | Train Loss: 2.166 Vali Loss: 1.772 Vali Acc: 0.421 Test Loss: 1.772 Test Acc: 0.421
Validation loss decreased (inf --> -0.420501).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0760343
	speed: 0.1407s/iter; left time: 2130.7016s
Epoch: 2 cost time: 6.0111002922058105
Epoch: 2, Steps: 154 | Train Loss: 1.501 Vali Loss: 1.811 Vali Acc: 0.437 Test Loss: 1.811 Test Acc: 0.437
Validation loss decreased (-0.420501 --> -0.437127).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5688467
	speed: 0.1387s/iter; left time: 2079.0435s
Epoch: 3 cost time: 6.016831398010254
Epoch: 3, Steps: 154 | Train Loss: 1.238 Vali Loss: 1.788 Vali Acc: 0.439 Test Loss: 1.788 Test Acc: 0.439
Validation loss decreased (-0.437127 --> -0.438749).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8628696
	speed: 0.1461s/iter; left time: 2167.5907s
Epoch: 4 cost time: 6.224188566207886
Epoch: 4, Steps: 154 | Train Loss: 1.078 Vali Loss: 1.778 Vali Acc: 0.423 Test Loss: 1.778 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1387511
	speed: 0.1404s/iter; left time: 2061.7641s
Epoch: 5 cost time: 5.71820068359375
Epoch: 5, Steps: 154 | Train Loss: 1.016 Vali Loss: 1.688 Vali Acc: 0.434 Test Loss: 1.688 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6415109
	speed: 0.1518s/iter; left time: 2205.1414s
Epoch: 6 cost time: 7.1226279735565186
Epoch: 6, Steps: 154 | Train Loss: 0.923 Vali Loss: 1.685 Vali Acc: 0.503 Test Loss: 1.685 Test Acc: 0.503
Validation loss decreased (-0.438749 --> -0.502822).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0458993
	speed: 0.1516s/iter; left time: 2179.3988s
Epoch: 7 cost time: 7.032156705856323
Epoch: 7, Steps: 154 | Train Loss: 0.847 Vali Loss: 1.622 Vali Acc: 0.528 Test Loss: 1.622 Test Acc: 0.528
Validation loss decreased (-0.502822 --> -0.528370).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0497800
	speed: 0.1499s/iter; left time: 2131.4333s
Epoch: 8 cost time: 6.922177314758301
Epoch: 8, Steps: 154 | Train Loss: 0.782 Vali Loss: 1.830 Vali Acc: 0.509 Test Loss: 1.830 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4292816
	speed: 0.1497s/iter; left time: 2105.4703s
Epoch: 9 cost time: 7.0527074337005615
Epoch: 9, Steps: 154 | Train Loss: 0.720 Vali Loss: 1.903 Vali Acc: 0.464 Test Loss: 1.903 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5864568
	speed: 0.1543s/iter; left time: 2146.6330s
Epoch: 10 cost time: 7.165295362472534
Epoch: 10, Steps: 154 | Train Loss: 0.656 Vali Loss: 1.931 Vali Acc: 0.493 Test Loss: 1.931 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6579482
	speed: 0.1528s/iter; left time: 2102.9148s
Epoch: 11 cost time: 7.048708915710449
Epoch: 11, Steps: 154 | Train Loss: 0.601 Vali Loss: 1.915 Vali Acc: 0.484 Test Loss: 1.915 Test Acc: 0.484
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3908272
	speed: 0.1575s/iter; left time: 2143.7161s
Epoch: 12 cost time: 7.115838527679443
Epoch: 12, Steps: 154 | Train Loss: 0.575 Vali Loss: 2.161 Vali Acc: 0.433 Test Loss: 2.161 Test Acc: 0.433
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.4720443
	speed: 0.1502s/iter; left time: 2020.3279s
Epoch: 13 cost time: 7.012413501739502
Epoch: 13, Steps: 154 | Train Loss: 0.530 Vali Loss: 2.096 Vali Acc: 0.500 Test Loss: 2.096 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5039989
	speed: 0.1521s/iter; left time: 2023.4102s
Epoch: 14 cost time: 7.21129846572876
Epoch: 14, Steps: 154 | Train Loss: 0.486 Vali Loss: 2.087 Vali Acc: 0.508 Test Loss: 2.087 Test Acc: 0.508
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.1648650
	speed: 0.1560s/iter; left time: 2051.0830s
Epoch: 15 cost time: 7.090655565261841
Epoch: 15, Steps: 154 | Train Loss: 0.479 Vali Loss: 2.156 Vali Acc: 0.504 Test Loss: 2.156 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.1686410
	speed: 0.1513s/iter; left time: 1965.8060s
Epoch: 16 cost time: 6.920858860015869
Epoch: 16, Steps: 154 | Train Loss: 0.435 Vali Loss: 2.543 Vali Acc: 0.482 Test Loss: 2.543 Test Acc: 0.482
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.3696862
	speed: 0.1510s/iter; left time: 1938.3845s
Epoch: 17 cost time: 6.774382829666138
Epoch: 17, Steps: 154 | Train Loss: 0.431 Vali Loss: 2.387 Vali Acc: 0.509 Test Loss: 2.387 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5283860502838605
model parameter : 77310
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8375781
	speed: 0.0581s/iter; left time: 888.7839s
Epoch: 1 cost time: 8.087131261825562
Epoch: 1, Steps: 154 | Train Loss: 2.103 Vali Loss: 1.955 Vali Acc: 0.366 Test Loss: 1.955 Test Acc: 0.366
Validation loss decreased (inf --> -0.365755).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5118457
	speed: 0.1341s/iter; left time: 2031.3281s
Epoch: 2 cost time: 5.697754144668579
Epoch: 2, Steps: 154 | Train Loss: 1.556 Vali Loss: 1.624 Vali Acc: 0.468 Test Loss: 1.624 Test Acc: 0.468
Validation loss decreased (-0.365755 --> -0.467948).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2749938
	speed: 0.1372s/iter; left time: 2056.6095s
Epoch: 3 cost time: 5.784520149230957
Epoch: 3, Steps: 154 | Train Loss: 1.302 Vali Loss: 1.636 Vali Acc: 0.502 Test Loss: 1.636 Test Acc: 0.502
Validation loss decreased (-0.467948 --> -0.502011).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8188812
	speed: 0.1348s/iter; left time: 1999.8299s
Epoch: 4 cost time: 5.8525612354278564
Epoch: 4, Steps: 154 | Train Loss: 1.196 Vali Loss: 1.693 Vali Acc: 0.483 Test Loss: 1.693 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8872997
	speed: 0.1372s/iter; left time: 2014.6224s
Epoch: 5 cost time: 6.0062055587768555
Epoch: 5, Steps: 154 | Train Loss: 1.084 Vali Loss: 1.551 Vali Acc: 0.510 Test Loss: 1.551 Test Acc: 0.510
Validation loss decreased (-0.502011 --> -0.509717).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3813988
	speed: 0.1391s/iter; left time: 2020.7070s
Epoch: 6 cost time: 5.743014335632324
Epoch: 6, Steps: 154 | Train Loss: 1.025 Vali Loss: 1.472 Vali Acc: 0.559 Test Loss: 1.472 Test Acc: 0.559
Validation loss decreased (-0.509717 --> -0.559190).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2346904
	speed: 0.1414s/iter; left time: 2032.3311s
Epoch: 7 cost time: 6.126363039016724
Epoch: 7, Steps: 154 | Train Loss: 0.971 Vali Loss: 1.611 Vali Acc: 0.504 Test Loss: 1.611 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0711597
	speed: 0.1380s/iter; left time: 1962.1811s
Epoch: 8 cost time: 5.972519159317017
Epoch: 8, Steps: 154 | Train Loss: 0.880 Vali Loss: 1.676 Vali Acc: 0.543 Test Loss: 1.676 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1421640
	speed: 0.1386s/iter; left time: 1949.6072s
Epoch: 9 cost time: 5.894697427749634
Epoch: 9, Steps: 154 | Train Loss: 0.870 Vali Loss: 1.752 Vali Acc: 0.517 Test Loss: 1.752 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3045270
	speed: 0.1410s/iter; left time: 1962.1743s
Epoch: 10 cost time: 6.086628675460815
Epoch: 10, Steps: 154 | Train Loss: 0.800 Vali Loss: 1.761 Vali Acc: 0.509 Test Loss: 1.761 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6267070
	speed: 0.1460s/iter; left time: 2009.4058s
Epoch: 11 cost time: 6.7646143436431885
Epoch: 11, Steps: 154 | Train Loss: 0.780 Vali Loss: 1.701 Vali Acc: 0.524 Test Loss: 1.701 Test Acc: 0.524
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4462278
	speed: 0.1497s/iter; left time: 2036.6279s
Epoch: 12 cost time: 6.81475830078125
Epoch: 12, Steps: 154 | Train Loss: 0.739 Vali Loss: 1.787 Vali Acc: 0.537 Test Loss: 1.787 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6586481
	speed: 0.1476s/iter; left time: 1985.3263s
Epoch: 13 cost time: 6.669134855270386
Epoch: 13, Steps: 154 | Train Loss: 0.701 Vali Loss: 1.719 Vali Acc: 0.553 Test Loss: 1.719 Test Acc: 0.553
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.8651850
	speed: 0.1500s/iter; left time: 1994.3335s
Epoch: 14 cost time: 6.776840448379517
Epoch: 14, Steps: 154 | Train Loss: 0.659 Vali Loss: 1.838 Vali Acc: 0.496 Test Loss: 1.838 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7568193
	speed: 0.1486s/iter; left time: 1953.0120s
Epoch: 15 cost time: 6.710957765579224
Epoch: 15, Steps: 154 | Train Loss: 0.625 Vali Loss: 1.800 Vali Acc: 0.490 Test Loss: 1.800 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2755042
	speed: 0.1499s/iter; left time: 1947.1094s
Epoch: 16 cost time: 6.782066583633423
Epoch: 16, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.153 Vali Acc: 0.502 Test Loss: 2.153 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5592051905920519
model parameter : 53134
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0839601
	speed: 0.0574s/iter; left time: 878.7481s
Epoch: 1 cost time: 8.035728693008423
Epoch: 1, Steps: 154 | Train Loss: 2.196 Vali Loss: 1.877 Vali Acc: 0.412 Test Loss: 1.877 Test Acc: 0.412
Validation loss decreased (inf --> -0.411984).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1182356
	speed: 0.1458s/iter; left time: 2209.0015s
Epoch: 2 cost time: 6.825180292129517
Epoch: 2, Steps: 154 | Train Loss: 1.633 Vali Loss: 1.944 Vali Acc: 0.407 Test Loss: 1.944 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1127374
	speed: 0.1513s/iter; left time: 2268.2794s
Epoch: 3 cost time: 7.000230312347412
Epoch: 3, Steps: 154 | Train Loss: 1.328 Vali Loss: 1.895 Vali Acc: 0.444 Test Loss: 1.895 Test Acc: 0.444
Validation loss decreased (-0.411984 --> -0.443614).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0142000
	speed: 0.1501s/iter; left time: 2227.3838s
Epoch: 4 cost time: 6.942159175872803
Epoch: 4, Steps: 154 | Train Loss: 1.235 Vali Loss: 1.792 Vali Acc: 0.493 Test Loss: 1.792 Test Acc: 0.493
Validation loss decreased (-0.443614 --> -0.492683).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0925901
	speed: 0.1463s/iter; left time: 2148.7036s
Epoch: 5 cost time: 6.54793381690979
Epoch: 5, Steps: 154 | Train Loss: 1.126 Vali Loss: 1.977 Vali Acc: 0.448 Test Loss: 1.977 Test Acc: 0.448
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1799841
	speed: 0.1462s/iter; left time: 2124.6109s
Epoch: 6 cost time: 6.690087080001831
Epoch: 6, Steps: 154 | Train Loss: 1.046 Vali Loss: 1.939 Vali Acc: 0.471 Test Loss: 1.939 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5179514
	speed: 0.1462s/iter; left time: 2102.5625s
Epoch: 7 cost time: 6.620397329330444
Epoch: 7, Steps: 154 | Train Loss: 1.011 Vali Loss: 1.836 Vali Acc: 0.481 Test Loss: 1.836 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.7064344
	speed: 0.1398s/iter; left time: 1988.1140s
Epoch: 8 cost time: 5.724495887756348
Epoch: 8, Steps: 154 | Train Loss: 0.960 Vali Loss: 1.683 Vali Acc: 0.518 Test Loss: 1.683 Test Acc: 0.518
Validation loss decreased (-0.492683 --> -0.518231).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7848894
	speed: 0.1441s/iter; left time: 2027.5829s
Epoch: 9 cost time: 6.256025075912476
Epoch: 9, Steps: 154 | Train Loss: 0.916 Vali Loss: 1.660 Vali Acc: 0.511 Test Loss: 1.660 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6141616
	speed: 0.1429s/iter; left time: 1988.6338s
Epoch: 10 cost time: 6.002263307571411
Epoch: 10, Steps: 154 | Train Loss: 0.847 Vali Loss: 1.686 Vali Acc: 0.522 Test Loss: 1.686 Test Acc: 0.522
Validation loss decreased (-0.518231 --> -0.521881).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6204704
	speed: 0.1405s/iter; left time: 1933.0633s
Epoch: 11 cost time: 5.775440454483032
Epoch: 11, Steps: 154 | Train Loss: 0.835 Vali Loss: 1.839 Vali Acc: 0.500 Test Loss: 1.839 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8576179
	speed: 0.1338s/iter; left time: 1820.2517s
Epoch: 12 cost time: 5.611198663711548
Epoch: 12, Steps: 154 | Train Loss: 0.789 Vali Loss: 2.009 Vali Acc: 0.473 Test Loss: 2.009 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3675150
	speed: 0.1396s/iter; left time: 1878.4533s
Epoch: 13 cost time: 6.111101388931274
Epoch: 13, Steps: 154 | Train Loss: 0.741 Vali Loss: 1.662 Vali Acc: 0.507 Test Loss: 1.662 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7751451
	speed: 0.1358s/iter; left time: 1806.1994s
Epoch: 14 cost time: 5.802577972412109
Epoch: 14, Steps: 154 | Train Loss: 0.712 Vali Loss: 1.855 Vali Acc: 0.526 Test Loss: 1.855 Test Acc: 0.526
Validation loss decreased (-0.521881 --> -0.525934).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.9824699
	speed: 0.1368s/iter; left time: 1797.7904s
Epoch: 15 cost time: 5.897023439407349
Epoch: 15, Steps: 154 | Train Loss: 0.671 Vali Loss: 1.930 Vali Acc: 0.546 Test Loss: 1.930 Test Acc: 0.546
Validation loss decreased (-0.525934 --> -0.546209).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7154754
	speed: 0.1310s/iter; left time: 1701.2346s
Epoch: 16 cost time: 5.945014476776123
Epoch: 16, Steps: 154 | Train Loss: 0.661 Vali Loss: 1.995 Vali Acc: 0.511 Test Loss: 1.995 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.7421832
	speed: 0.1379s/iter; left time: 1770.2966s
Epoch: 17 cost time: 6.651813507080078
Epoch: 17, Steps: 154 | Train Loss: 0.619 Vali Loss: 1.985 Vali Acc: 0.470 Test Loss: 1.985 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4736452
	speed: 0.1492s/iter; left time: 1891.7272s
Epoch: 18 cost time: 7.031723499298096
Epoch: 18, Steps: 154 | Train Loss: 0.578 Vali Loss: 1.974 Vali Acc: 0.536 Test Loss: 1.974 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1704079
	speed: 0.1512s/iter; left time: 1893.9710s
Epoch: 19 cost time: 6.844637632369995
Epoch: 19, Steps: 154 | Train Loss: 0.575 Vali Loss: 2.269 Vali Acc: 0.489 Test Loss: 2.269 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3472057
	speed: 0.1447s/iter; left time: 1790.3035s
Epoch: 20 cost time: 6.660011529922485
Epoch: 20, Steps: 154 | Train Loss: 0.538 Vali Loss: 2.136 Vali Acc: 0.465 Test Loss: 2.136 Test Acc: 0.465
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5565227
	speed: 0.1662s/iter; left time: 2030.5731s
Epoch: 21 cost time: 7.689724683761597
Epoch: 21, Steps: 154 | Train Loss: 0.531 Vali Loss: 2.017 Vali Acc: 0.543 Test Loss: 2.017 Test Acc: 0.543
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.4863515
	speed: 0.1692s/iter; left time: 2041.6885s
Epoch: 22 cost time: 8.187161207199097
Epoch: 22, Steps: 154 | Train Loss: 0.512 Vali Loss: 2.074 Vali Acc: 0.521 Test Loss: 2.074 Test Acc: 0.521
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.5069011
	speed: 0.1700s/iter; left time: 2024.8552s
Epoch: 23 cost time: 7.5256407260894775
Epoch: 23, Steps: 154 | Train Loss: 0.504 Vali Loss: 2.258 Vali Acc: 0.504 Test Loss: 2.258 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.5047102
	speed: 0.1730s/iter; left time: 2034.6328s
Epoch: 24 cost time: 8.208834171295166
Epoch: 24, Steps: 154 | Train Loss: 0.461 Vali Loss: 2.161 Vali Acc: 0.485 Test Loss: 2.161 Test Acc: 0.485
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.7006355
	speed: 0.1708s/iter; left time: 1982.2251s
Epoch: 25 cost time: 8.014652729034424
Epoch: 25, Steps: 154 | Train Loss: 0.460 Vali Loss: 2.489 Vali Acc: 0.485 Test Loss: 2.489 Test Acc: 0.485
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5462287104622872
model parameter : 53150
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0192518
	speed: 0.0672s/iter; left time: 1028.3197s
Epoch: 1 cost time: 9.585789680480957
Epoch: 1, Steps: 154 | Train Loss: 2.263 Vali Loss: 1.895 Vali Acc: 0.409 Test Loss: 1.895 Test Acc: 0.409
Validation loss decreased (inf --> -0.408740).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7378044
	speed: 0.1629s/iter; left time: 2466.7082s
Epoch: 2 cost time: 7.4941794872283936
Epoch: 2, Steps: 154 | Train Loss: 1.657 Vali Loss: 1.931 Vali Acc: 0.414 Test Loss: 1.931 Test Acc: 0.414
Validation loss decreased (-0.408740 --> -0.414417).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1688807
	speed: 0.1676s/iter; left time: 2512.7564s
Epoch: 3 cost time: 7.238813161849976
Epoch: 3, Steps: 154 | Train Loss: 1.363 Vali Loss: 1.716 Vali Acc: 0.470 Test Loss: 1.716 Test Acc: 0.470
Validation loss decreased (-0.414417 --> -0.469975).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3311560
	speed: 0.1664s/iter; left time: 2469.9357s
Epoch: 4 cost time: 7.977991342544556
Epoch: 4, Steps: 154 | Train Loss: 1.246 Vali Loss: 1.792 Vali Acc: 0.476 Test Loss: 1.792 Test Acc: 0.476
Validation loss decreased (-0.469975 --> -0.476057).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1595018
	speed: 0.1632s/iter; left time: 2396.3863s
Epoch: 5 cost time: 7.4486000537872314
Epoch: 5, Steps: 154 | Train Loss: 1.183 Vali Loss: 1.767 Vali Acc: 0.474 Test Loss: 1.767 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9920388
	speed: 0.1578s/iter; left time: 2293.2375s
Epoch: 6 cost time: 6.392109155654907
Epoch: 6, Steps: 154 | Train Loss: 1.116 Vali Loss: 1.894 Vali Acc: 0.474 Test Loss: 1.894 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0277652
	speed: 0.1576s/iter; left time: 2265.1497s
Epoch: 7 cost time: 7.632022857666016
Epoch: 7, Steps: 154 | Train Loss: 1.107 Vali Loss: 1.751 Vali Acc: 0.487 Test Loss: 1.751 Test Acc: 0.487
Validation loss decreased (-0.476057 --> -0.486600).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9687341
	speed: 0.1490s/iter; left time: 2119.7849s
Epoch: 8 cost time: 6.684394359588623
Epoch: 8, Steps: 154 | Train Loss: 1.046 Vali Loss: 2.019 Vali Acc: 0.453 Test Loss: 2.019 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3984890
	speed: 0.1506s/iter; left time: 2119.2185s
Epoch: 9 cost time: 6.052739381790161
Epoch: 9, Steps: 154 | Train Loss: 1.001 Vali Loss: 1.868 Vali Acc: 0.460 Test Loss: 1.868 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3753365
	speed: 0.1508s/iter; left time: 2098.6693s
Epoch: 10 cost time: 7.190483570098877
Epoch: 10, Steps: 154 | Train Loss: 0.959 Vali Loss: 1.840 Vali Acc: 0.491 Test Loss: 1.840 Test Acc: 0.491
Validation loss decreased (-0.486600 --> -0.490655).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6567121
	speed: 0.1481s/iter; left time: 2038.5045s
Epoch: 11 cost time: 6.541234493255615
Epoch: 11, Steps: 154 | Train Loss: 0.929 Vali Loss: 1.921 Vali Acc: 0.459 Test Loss: 1.921 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1805344
	speed: 0.1564s/iter; left time: 2128.5004s
Epoch: 12 cost time: 6.275880336761475
Epoch: 12, Steps: 154 | Train Loss: 0.881 Vali Loss: 1.719 Vali Acc: 0.507 Test Loss: 1.719 Test Acc: 0.507
Validation loss decreased (-0.490655 --> -0.507282).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9752874
	speed: 0.1584s/iter; left time: 2130.8423s
Epoch: 13 cost time: 7.109678745269775
Epoch: 13, Steps: 154 | Train Loss: 0.851 Vali Loss: 1.913 Vali Acc: 0.495 Test Loss: 1.913 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3042736
	speed: 0.1549s/iter; left time: 2059.7281s
Epoch: 14 cost time: 7.165075778961182
Epoch: 14, Steps: 154 | Train Loss: 0.817 Vali Loss: 1.850 Vali Acc: 0.495 Test Loss: 1.850 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.7999479
	speed: 0.1488s/iter; left time: 1956.1513s
Epoch: 15 cost time: 6.316046714782715
Epoch: 15, Steps: 154 | Train Loss: 0.752 Vali Loss: 2.014 Vali Acc: 0.464 Test Loss: 2.014 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0479912
	speed: 0.1750s/iter; left time: 2273.7632s
Epoch: 16 cost time: 7.980443000793457
Epoch: 16, Steps: 154 | Train Loss: 0.751 Vali Loss: 1.972 Vali Acc: 0.482 Test Loss: 1.972 Test Acc: 0.482
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.3226597
	speed: 0.1683s/iter; left time: 2160.3547s
Epoch: 17 cost time: 7.986330986022949
Epoch: 17, Steps: 154 | Train Loss: 0.706 Vali Loss: 1.837 Vali Acc: 0.495 Test Loss: 1.837 Test Acc: 0.495
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.0624057
	speed: 0.1678s/iter; left time: 2128.3055s
Epoch: 18 cost time: 7.386728763580322
Epoch: 18, Steps: 154 | Train Loss: 0.697 Vali Loss: 1.762 Vali Acc: 0.490 Test Loss: 1.762 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.5362564
	speed: 0.1705s/iter; left time: 2135.6962s
Epoch: 19 cost time: 7.957032203674316
Epoch: 19, Steps: 154 | Train Loss: 0.680 Vali Loss: 1.922 Vali Acc: 0.493 Test Loss: 1.922 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6742277
	speed: 0.1648s/iter; left time: 2039.9414s
Epoch: 20 cost time: 7.768214702606201
Epoch: 20, Steps: 154 | Train Loss: 0.630 Vali Loss: 2.161 Vali Acc: 0.455 Test Loss: 2.161 Test Acc: 0.455
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.8297929
	speed: 0.1634s/iter; left time: 1996.3823s
Epoch: 21 cost time: 7.294241666793823
Epoch: 21, Steps: 154 | Train Loss: 0.617 Vali Loss: 2.047 Vali Acc: 0.490 Test Loss: 2.047 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5866577
	speed: 0.1710s/iter; left time: 2063.4110s
Epoch: 22 cost time: 8.156004190444946
Epoch: 22, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.205 Vali Acc: 0.443 Test Loss: 2.205 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5072992700729927
model parameter : 45118
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3560402
	speed: 0.0616s/iter; left time: 942.2721s
Epoch: 1 cost time: 8.557031631469727
Epoch: 1, Steps: 154 | Train Loss: 2.256 Vali Loss: 1.957 Vali Acc: 0.345 Test Loss: 1.957 Test Acc: 0.345
Validation loss decreased (inf --> -0.345074).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4972038
	speed: 0.1651s/iter; left time: 2500.0592s
Epoch: 2 cost time: 8.062093496322632
Epoch: 2, Steps: 154 | Train Loss: 1.742 Vali Loss: 1.745 Vali Acc: 0.436 Test Loss: 1.745 Test Acc: 0.436
Validation loss decreased (-0.345074 --> -0.435506).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9979252
	speed: 0.1623s/iter; left time: 2433.5206s
Epoch: 3 cost time: 7.1366307735443115
Epoch: 3, Steps: 154 | Train Loss: 1.434 Vali Loss: 1.843 Vali Acc: 0.437 Test Loss: 1.843 Test Acc: 0.437
Validation loss decreased (-0.435506 --> -0.436721).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1678685
	speed: 0.1624s/iter; left time: 2409.7471s
Epoch: 4 cost time: 6.98310661315918
Epoch: 4, Steps: 154 | Train Loss: 1.295 Vali Loss: 1.770 Vali Acc: 0.461 Test Loss: 1.770 Test Acc: 0.461
Validation loss decreased (-0.436721 --> -0.461458).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3978865
	speed: 0.1654s/iter; left time: 2429.2166s
Epoch: 5 cost time: 8.065786361694336
Epoch: 5, Steps: 154 | Train Loss: 1.213 Vali Loss: 1.743 Vali Acc: 0.483 Test Loss: 1.743 Test Acc: 0.483
Validation loss decreased (-0.461458 --> -0.482951).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1643496
	speed: 0.1642s/iter; left time: 2386.6136s
Epoch: 6 cost time: 7.157500267028809
Epoch: 6, Steps: 154 | Train Loss: 1.159 Vali Loss: 1.561 Vali Acc: 0.516 Test Loss: 1.561 Test Acc: 0.516
Validation loss decreased (-0.482951 --> -0.516205).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1360488
	speed: 0.1586s/iter; left time: 2280.5840s
Epoch: 7 cost time: 6.588452577590942
Epoch: 7, Steps: 154 | Train Loss: 1.108 Vali Loss: 1.943 Vali Acc: 0.468 Test Loss: 1.943 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0627812
	speed: 0.1597s/iter; left time: 2271.7228s
Epoch: 8 cost time: 7.551394462585449
Epoch: 8, Steps: 154 | Train Loss: 1.089 Vali Loss: 1.785 Vali Acc: 0.478 Test Loss: 1.785 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.7052610
	speed: 0.1547s/iter; left time: 2176.0715s
Epoch: 9 cost time: 6.410728454589844
Epoch: 9, Steps: 154 | Train Loss: 1.052 Vali Loss: 1.635 Vali Acc: 0.504 Test Loss: 1.635 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.9996465
	speed: 0.1414s/iter; left time: 1967.4538s
Epoch: 10 cost time: 5.626384258270264
Epoch: 10, Steps: 154 | Train Loss: 1.003 Vali Loss: 1.664 Vali Acc: 0.526 Test Loss: 1.664 Test Acc: 0.526
Validation loss decreased (-0.516205 --> -0.525531).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8489707
	speed: 0.1353s/iter; left time: 1861.1886s
Epoch: 11 cost time: 6.0526838302612305
Epoch: 11, Steps: 154 | Train Loss: 0.939 Vali Loss: 1.700 Vali Acc: 0.498 Test Loss: 1.700 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9412633
	speed: 0.1333s/iter; left time: 1814.3894s
Epoch: 12 cost time: 6.09757924079895
Epoch: 12, Steps: 154 | Train Loss: 0.916 Vali Loss: 1.580 Vali Acc: 0.540 Test Loss: 1.580 Test Acc: 0.540
Validation loss decreased (-0.525531 --> -0.539725).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1153692
	speed: 0.1348s/iter; left time: 1813.2051s
Epoch: 13 cost time: 6.041292428970337
Epoch: 13, Steps: 154 | Train Loss: 0.889 Vali Loss: 1.740 Vali Acc: 0.471 Test Loss: 1.740 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5563798
	speed: 0.1362s/iter; left time: 1811.0827s
Epoch: 14 cost time: 5.942664623260498
Epoch: 14, Steps: 154 | Train Loss: 0.841 Vali Loss: 1.864 Vali Acc: 0.496 Test Loss: 1.864 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9563730
	speed: 0.1354s/iter; left time: 1780.0215s
Epoch: 15 cost time: 5.963649749755859
Epoch: 15, Steps: 154 | Train Loss: 0.821 Vali Loss: 1.735 Vali Acc: 0.503 Test Loss: 1.735 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.4494493
	speed: 0.1364s/iter; left time: 1771.7447s
Epoch: 16 cost time: 5.845317840576172
Epoch: 16, Steps: 154 | Train Loss: 0.793 Vali Loss: 1.768 Vali Acc: 0.526 Test Loss: 1.768 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.4192896
	speed: 0.1490s/iter; left time: 1912.6060s
Epoch: 17 cost time: 6.427953004837036
Epoch: 17, Steps: 154 | Train Loss: 0.764 Vali Loss: 1.812 Vali Acc: 0.496 Test Loss: 1.812 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.9118320
	speed: 0.1448s/iter; left time: 1836.5805s
Epoch: 18 cost time: 6.474256992340088
Epoch: 18, Steps: 154 | Train Loss: 0.745 Vali Loss: 1.840 Vali Acc: 0.512 Test Loss: 1.840 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6739669
	speed: 0.1454s/iter; left time: 1821.9323s
Epoch: 19 cost time: 6.653103590011597
Epoch: 19, Steps: 154 | Train Loss: 0.730 Vali Loss: 1.850 Vali Acc: 0.515 Test Loss: 1.850 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6178495
	speed: 0.1466s/iter; left time: 1814.3635s
Epoch: 20 cost time: 6.647125244140625
Epoch: 20, Steps: 154 | Train Loss: 0.688 Vali Loss: 2.010 Vali Acc: 0.496 Test Loss: 2.010 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.8466755
	speed: 0.1462s/iter; left time: 1786.9155s
Epoch: 21 cost time: 6.835059404373169
Epoch: 21, Steps: 154 | Train Loss: 0.688 Vali Loss: 1.858 Vali Acc: 0.502 Test Loss: 1.858 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.4873538
	speed: 0.1445s/iter; left time: 1743.9113s
Epoch: 22 cost time: 6.538848161697388
Epoch: 22, Steps: 154 | Train Loss: 0.682 Vali Loss: 1.882 Vali Acc: 0.509 Test Loss: 1.882 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5397404703974047
model parameter : 41118
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2093105
	speed: 0.0569s/iter; left time: 870.5007s
Epoch: 1 cost time: 7.893351078033447
Epoch: 1, Steps: 154 | Train Loss: 2.314 Vali Loss: 2.039 Vali Acc: 0.339 Test Loss: 2.039 Test Acc: 0.339
Validation loss decreased (inf --> -0.338585).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9314765
	speed: 0.1468s/iter; left time: 2224.3184s
Epoch: 2 cost time: 6.528260707855225
Epoch: 2, Steps: 154 | Train Loss: 1.866 Vali Loss: 1.701 Vali Acc: 0.433 Test Loss: 1.701 Test Acc: 0.433
Validation loss decreased (-0.338585 --> -0.433479).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3259370
	speed: 0.1428s/iter; left time: 2140.4053s
Epoch: 3 cost time: 6.390633821487427
Epoch: 3, Steps: 154 | Train Loss: 1.512 Vali Loss: 1.686 Vali Acc: 0.444 Test Loss: 1.686 Test Acc: 0.444
Validation loss decreased (-0.433479 --> -0.443617).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9658603
	speed: 0.1476s/iter; left time: 2189.9148s
Epoch: 4 cost time: 6.577409505844116
Epoch: 4, Steps: 154 | Train Loss: 1.346 Vali Loss: 1.630 Vali Acc: 0.481 Test Loss: 1.630 Test Acc: 0.481
Validation loss decreased (-0.443617 --> -0.480924).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3587534
	speed: 0.1417s/iter; left time: 2080.7363s
Epoch: 5 cost time: 6.477473735809326
Epoch: 5, Steps: 154 | Train Loss: 1.277 Vali Loss: 1.713 Vali Acc: 0.481 Test Loss: 1.713 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5113890
	speed: 0.1437s/iter; left time: 2088.0987s
Epoch: 6 cost time: 5.981848955154419
Epoch: 6, Steps: 154 | Train Loss: 1.228 Vali Loss: 1.559 Vali Acc: 0.513 Test Loss: 1.559 Test Acc: 0.513
Validation loss decreased (-0.480924 --> -0.513366).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9394422
	speed: 0.1422s/iter; left time: 2043.9167s
Epoch: 7 cost time: 5.958430290222168
Epoch: 7, Steps: 154 | Train Loss: 1.169 Vali Loss: 1.682 Vali Acc: 0.481 Test Loss: 1.682 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0464194
	speed: 0.1450s/iter; left time: 2062.2401s
Epoch: 8 cost time: 5.920421123504639
Epoch: 8, Steps: 154 | Train Loss: 1.139 Vali Loss: 1.848 Vali Acc: 0.474 Test Loss: 1.848 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4497285
	speed: 0.1385s/iter; left time: 1948.9676s
Epoch: 9 cost time: 5.733615875244141
Epoch: 9, Steps: 154 | Train Loss: 1.092 Vali Loss: 1.729 Vali Acc: 0.494 Test Loss: 1.729 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5804406
	speed: 0.1368s/iter; left time: 1903.7772s
Epoch: 10 cost time: 5.970034837722778
Epoch: 10, Steps: 154 | Train Loss: 1.052 Vali Loss: 1.624 Vali Acc: 0.504 Test Loss: 1.624 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6686603
	speed: 0.1356s/iter; left time: 1866.2335s
Epoch: 11 cost time: 5.646270751953125
Epoch: 11, Steps: 154 | Train Loss: 1.030 Vali Loss: 1.828 Vali Acc: 0.450 Test Loss: 1.828 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.5658549
	speed: 0.1361s/iter; left time: 1851.7169s
Epoch: 12 cost time: 5.975778102874756
Epoch: 12, Steps: 154 | Train Loss: 1.000 Vali Loss: 1.776 Vali Acc: 0.485 Test Loss: 1.776 Test Acc: 0.485
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1942255
	speed: 0.1338s/iter; left time: 1800.6705s
Epoch: 13 cost time: 5.845117807388306
Epoch: 13, Steps: 154 | Train Loss: 0.955 Vali Loss: 1.668 Vali Acc: 0.518 Test Loss: 1.668 Test Acc: 0.518
Validation loss decreased (-0.513366 --> -0.518231).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1833469
	speed: 0.1336s/iter; left time: 1777.1881s
Epoch: 14 cost time: 5.737858295440674
Epoch: 14, Steps: 154 | Train Loss: 0.923 Vali Loss: 1.731 Vali Acc: 0.488 Test Loss: 1.731 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0689209
	speed: 0.1359s/iter; left time: 1786.5506s
Epoch: 15 cost time: 6.280666351318359
Epoch: 15, Steps: 154 | Train Loss: 0.924 Vali Loss: 1.803 Vali Acc: 0.479 Test Loss: 1.803 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0366075
	speed: 0.1331s/iter; left time: 1729.5743s
Epoch: 16 cost time: 6.182868957519531
Epoch: 16, Steps: 154 | Train Loss: 0.881 Vali Loss: 1.797 Vali Acc: 0.537 Test Loss: 1.797 Test Acc: 0.537
Validation loss decreased (-0.518231 --> -0.537289).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0828465
	speed: 0.1505s/iter; left time: 1931.3795s
Epoch: 17 cost time: 6.682854890823364
Epoch: 17, Steps: 154 | Train Loss: 0.864 Vali Loss: 1.996 Vali Acc: 0.453 Test Loss: 1.996 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1918550
	speed: 0.1519s/iter; left time: 1926.1748s
Epoch: 18 cost time: 6.997110366821289
Epoch: 18, Steps: 154 | Train Loss: 0.839 Vali Loss: 1.837 Vali Acc: 0.509 Test Loss: 1.837 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8081868
	speed: 0.1447s/iter; left time: 1812.6108s
Epoch: 19 cost time: 6.447767496109009
Epoch: 19, Steps: 154 | Train Loss: 0.824 Vali Loss: 1.946 Vali Acc: 0.489 Test Loss: 1.946 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.6783563
	speed: 0.1537s/iter; left time: 1901.5649s
Epoch: 20 cost time: 7.013169050216675
Epoch: 20, Steps: 154 | Train Loss: 0.782 Vali Loss: 1.927 Vali Acc: 0.491 Test Loss: 1.927 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.1705124
	speed: 0.1534s/iter; left time: 1875.2351s
Epoch: 21 cost time: 6.898674726486206
Epoch: 21, Steps: 154 | Train Loss: 0.769 Vali Loss: 1.821 Vali Acc: 0.480 Test Loss: 1.821 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.7245467
	speed: 0.1539s/iter; left time: 1856.8320s
Epoch: 22 cost time: 6.473799228668213
Epoch: 22, Steps: 154 | Train Loss: 0.763 Vali Loss: 1.842 Vali Acc: 0.506 Test Loss: 1.842 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.6659452
	speed: 0.1498s/iter; left time: 1784.8374s
Epoch: 23 cost time: 6.895063638687134
Epoch: 23, Steps: 154 | Train Loss: 0.753 Vali Loss: 1.872 Vali Acc: 0.502 Test Loss: 1.872 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.7968020
	speed: 0.1563s/iter; left time: 1837.7009s
Epoch: 24 cost time: 6.899237394332886
Epoch: 24, Steps: 154 | Train Loss: 0.714 Vali Loss: 1.867 Vali Acc: 0.486 Test Loss: 1.867 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.3400382
	speed: 0.1479s/iter; left time: 1716.1791s
Epoch: 25 cost time: 6.683971166610718
Epoch: 25, Steps: 154 | Train Loss: 0.691 Vali Loss: 1.990 Vali Acc: 0.497 Test Loss: 1.990 Test Acc: 0.497
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.8089721
	speed: 0.1506s/iter; left time: 1724.8055s
Epoch: 26 cost time: 6.803741693496704
Epoch: 26, Steps: 154 | Train Loss: 0.672 Vali Loss: 1.909 Vali Acc: 0.489 Test Loss: 1.909 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5373073803730738
model parameter : 38446
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3394694
	speed: 0.0614s/iter; left time: 939.9571s
Epoch: 1 cost time: 8.341740131378174
Epoch: 1, Steps: 154 | Train Loss: 2.151 Vali Loss: 1.819 Vali Acc: 0.407 Test Loss: 1.819 Test Acc: 0.407
Validation loss decreased (inf --> -0.407119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4537655
	speed: 0.1479s/iter; left time: 2240.3319s
Epoch: 2 cost time: 6.739941120147705
Epoch: 2, Steps: 154 | Train Loss: 1.539 Vali Loss: 1.595 Vali Acc: 0.480 Test Loss: 1.595 Test Acc: 0.480
Validation loss decreased (-0.407119 --> -0.479708).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9463336
	speed: 0.1430s/iter; left time: 2144.3718s
Epoch: 3 cost time: 5.618829965591431
Epoch: 3, Steps: 154 | Train Loss: 1.267 Vali Loss: 1.571 Vali Acc: 0.504 Test Loss: 1.571 Test Acc: 0.504
Validation loss decreased (-0.479708 --> -0.504445).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7169747
	speed: 0.1400s/iter; left time: 2078.0693s
Epoch: 4 cost time: 6.228729248046875
Epoch: 4, Steps: 154 | Train Loss: 1.110 Vali Loss: 1.791 Vali Acc: 0.395 Test Loss: 1.791 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3061000
	speed: 0.1436s/iter; left time: 2108.1021s
Epoch: 5 cost time: 6.368197202682495
Epoch: 5, Steps: 154 | Train Loss: 1.019 Vali Loss: 1.498 Vali Acc: 0.510 Test Loss: 1.498 Test Acc: 0.510
Validation loss decreased (-0.504445 --> -0.510123).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1592140
	speed: 0.1358s/iter; left time: 1973.6987s
Epoch: 6 cost time: 5.894776344299316
Epoch: 6, Steps: 154 | Train Loss: 0.931 Vali Loss: 1.648 Vali Acc: 0.504 Test Loss: 1.648 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7194148
	speed: 0.1441s/iter; left time: 2071.1295s
Epoch: 7 cost time: 6.297433853149414
Epoch: 7, Steps: 154 | Train Loss: 0.884 Vali Loss: 1.746 Vali Acc: 0.515 Test Loss: 1.746 Test Acc: 0.515
Validation loss decreased (-0.510123 --> -0.515392).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9640914
	speed: 0.1383s/iter; left time: 1967.0710s
Epoch: 8 cost time: 6.063278436660767
Epoch: 8, Steps: 154 | Train Loss: 0.824 Vali Loss: 1.814 Vali Acc: 0.459 Test Loss: 1.814 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7548180
	speed: 0.1474s/iter; left time: 2073.1335s
Epoch: 9 cost time: 6.184767246246338
Epoch: 9, Steps: 154 | Train Loss: 0.755 Vali Loss: 1.849 Vali Acc: 0.524 Test Loss: 1.849 Test Acc: 0.524
Validation loss decreased (-0.515392 --> -0.523907).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4188852
	speed: 0.1403s/iter; left time: 1952.1354s
Epoch: 10 cost time: 6.279111385345459
Epoch: 10, Steps: 154 | Train Loss: 0.703 Vali Loss: 1.815 Vali Acc: 0.486 Test Loss: 1.815 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0918590
	speed: 0.1341s/iter; left time: 1845.7766s
Epoch: 11 cost time: 5.775301694869995
Epoch: 11, Steps: 154 | Train Loss: 0.645 Vali Loss: 1.813 Vali Acc: 0.500 Test Loss: 1.813 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4401404
	speed: 0.1458s/iter; left time: 1984.3386s
Epoch: 12 cost time: 7.222543001174927
Epoch: 12, Steps: 154 | Train Loss: 0.611 Vali Loss: 2.034 Vali Acc: 0.438 Test Loss: 2.034 Test Acc: 0.438
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.8731904
	speed: 0.1575s/iter; left time: 2119.0551s
Epoch: 13 cost time: 7.383569717407227
Epoch: 13, Steps: 154 | Train Loss: 0.552 Vali Loss: 2.061 Vali Acc: 0.495 Test Loss: 2.061 Test Acc: 0.495
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5499870
	speed: 0.1535s/iter; left time: 2041.6145s
Epoch: 14 cost time: 6.700042963027954
Epoch: 14, Steps: 154 | Train Loss: 0.525 Vali Loss: 2.186 Vali Acc: 0.499 Test Loss: 2.186 Test Acc: 0.499
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8286131
	speed: 0.1428s/iter; left time: 1877.6866s
Epoch: 15 cost time: 6.3563666343688965
Epoch: 15, Steps: 154 | Train Loss: 0.481 Vali Loss: 2.301 Vali Acc: 0.468 Test Loss: 2.301 Test Acc: 0.468
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.4461221
	speed: 0.1449s/iter; left time: 1882.0471s
Epoch: 16 cost time: 7.022929906845093
Epoch: 16, Steps: 154 | Train Loss: 0.453 Vali Loss: 2.268 Vali Acc: 0.519 Test Loss: 2.268 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.9187106
	speed: 0.1447s/iter; left time: 1858.1120s
Epoch: 17 cost time: 6.653737306594849
Epoch: 17, Steps: 154 | Train Loss: 0.425 Vali Loss: 2.352 Vali Acc: 0.501 Test Loss: 2.352 Test Acc: 0.501
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1299773
	speed: 0.1497s/iter; left time: 1898.7140s
Epoch: 18 cost time: 7.061574697494507
Epoch: 18, Steps: 154 | Train Loss: 0.426 Vali Loss: 2.746 Vali Acc: 0.427 Test Loss: 2.746 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.3396611
	speed: 0.1528s/iter; left time: 1915.0505s
Epoch: 19 cost time: 7.206544637680054
Epoch: 19, Steps: 154 | Train Loss: 0.417 Vali Loss: 2.520 Vali Acc: 0.509 Test Loss: 2.520 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5239253852392538
model parameter : 64638
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7556592
	speed: 0.0576s/iter; left time: 880.7628s
Epoch: 1 cost time: 8.0841543674469
Epoch: 1, Steps: 154 | Train Loss: 2.113 Vali Loss: 1.715 Vali Acc: 0.418 Test Loss: 1.715 Test Acc: 0.418
Validation loss decreased (inf --> -0.418069).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9878896
	speed: 0.1452s/iter; left time: 2198.7697s
Epoch: 2 cost time: 6.448516607284546
Epoch: 2, Steps: 154 | Train Loss: 1.491 Vali Loss: 1.953 Vali Acc: 0.434 Test Loss: 1.953 Test Acc: 0.434
Validation loss decreased (-0.418069 --> -0.434287).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5324121
	speed: 0.1488s/iter; left time: 2231.1188s
Epoch: 3 cost time: 6.304174184799194
Epoch: 3, Steps: 154 | Train Loss: 1.280 Vali Loss: 1.649 Vali Acc: 0.479 Test Loss: 1.649 Test Acc: 0.479
Validation loss decreased (-0.434287 --> -0.478897).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9068671
	speed: 0.1431s/iter; left time: 2122.9710s
Epoch: 4 cost time: 6.585124492645264
Epoch: 4, Steps: 154 | Train Loss: 1.179 Vali Loss: 1.686 Vali Acc: 0.478 Test Loss: 1.686 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4312460
	speed: 0.1464s/iter; left time: 2149.6043s
Epoch: 5 cost time: 6.388503313064575
Epoch: 5, Steps: 154 | Train Loss: 1.091 Vali Loss: 1.656 Vali Acc: 0.464 Test Loss: 1.656 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5043021
	speed: 0.1400s/iter; left time: 2034.6080s
Epoch: 6 cost time: 5.54549765586853
Epoch: 6, Steps: 154 | Train Loss: 1.038 Vali Loss: 1.785 Vali Acc: 0.486 Test Loss: 1.785 Test Acc: 0.486
Validation loss decreased (-0.478897 --> -0.485789).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9122840
	speed: 0.1401s/iter; left time: 2014.6815s
Epoch: 7 cost time: 5.845108270645142
Epoch: 7, Steps: 154 | Train Loss: 0.961 Vali Loss: 1.581 Vali Acc: 0.533 Test Loss: 1.581 Test Acc: 0.533
Validation loss decreased (-0.485789 --> -0.532831).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1683060
	speed: 0.1352s/iter; left time: 1923.1221s
Epoch: 8 cost time: 5.4153828620910645
Epoch: 8, Steps: 154 | Train Loss: 0.928 Vali Loss: 1.628 Vali Acc: 0.530 Test Loss: 1.628 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9184691
	speed: 0.1364s/iter; left time: 1919.0150s
Epoch: 9 cost time: 6.080028772354126
Epoch: 9, Steps: 154 | Train Loss: 0.887 Vali Loss: 1.740 Vali Acc: 0.489 Test Loss: 1.740 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7343697
	speed: 0.1412s/iter; left time: 1964.8112s
Epoch: 10 cost time: 5.693339824676514
Epoch: 10, Steps: 154 | Train Loss: 0.834 Vali Loss: 1.859 Vali Acc: 0.408 Test Loss: 1.859 Test Acc: 0.408
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6406310
	speed: 0.1295s/iter; left time: 1782.2674s
Epoch: 11 cost time: 5.742828845977783
Epoch: 11, Steps: 154 | Train Loss: 0.797 Vali Loss: 1.724 Vali Acc: 0.524 Test Loss: 1.724 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.9375695
	speed: 0.1330s/iter; left time: 1810.1634s
Epoch: 12 cost time: 5.845163345336914
Epoch: 12, Steps: 154 | Train Loss: 0.758 Vali Loss: 1.703 Vali Acc: 0.545 Test Loss: 1.703 Test Acc: 0.545
Validation loss decreased (-0.532831 --> -0.544590).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2934782
	speed: 0.1403s/iter; left time: 1887.3797s
Epoch: 13 cost time: 6.113706350326538
Epoch: 13, Steps: 154 | Train Loss: 0.727 Vali Loss: 2.023 Vali Acc: 0.493 Test Loss: 2.023 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9986555
	speed: 0.1253s/iter; left time: 1665.8253s
Epoch: 14 cost time: 5.452296733856201
Epoch: 14, Steps: 154 | Train Loss: 0.684 Vali Loss: 1.828 Vali Acc: 0.520 Test Loss: 1.828 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5042886
	speed: 0.1406s/iter; left time: 1848.0552s
Epoch: 15 cost time: 6.665677309036255
Epoch: 15, Steps: 154 | Train Loss: 0.655 Vali Loss: 2.059 Vali Acc: 0.434 Test Loss: 2.059 Test Acc: 0.434
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9882967
	speed: 0.1475s/iter; left time: 1916.5124s
Epoch: 16 cost time: 6.7956383228302
Epoch: 16, Steps: 154 | Train Loss: 0.636 Vali Loss: 1.825 Vali Acc: 0.548 Test Loss: 1.825 Test Acc: 0.548
Validation loss decreased (-0.544590 --> -0.547833).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8342615
	speed: 0.1445s/iter; left time: 1855.2610s
Epoch: 17 cost time: 6.303096294403076
Epoch: 17, Steps: 154 | Train Loss: 0.604 Vali Loss: 1.979 Vali Acc: 0.494 Test Loss: 1.979 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6629069
	speed: 0.1479s/iter; left time: 1876.0350s
Epoch: 18 cost time: 6.722434759140015
Epoch: 18, Steps: 154 | Train Loss: 0.579 Vali Loss: 1.859 Vali Acc: 0.560 Test Loss: 1.859 Test Acc: 0.560
Validation loss decreased (-0.547833 --> -0.559998).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.2894453
	speed: 0.1467s/iter; left time: 1837.5221s
Epoch: 19 cost time: 6.699562072753906
Epoch: 19, Steps: 154 | Train Loss: 0.531 Vali Loss: 1.958 Vali Acc: 0.479 Test Loss: 1.958 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7585417
	speed: 0.1510s/iter; left time: 1868.9262s
Epoch: 20 cost time: 6.561272621154785
Epoch: 20, Steps: 154 | Train Loss: 0.532 Vali Loss: 2.082 Vali Acc: 0.461 Test Loss: 2.082 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1428640
	speed: 0.1469s/iter; left time: 1794.9116s
Epoch: 21 cost time: 6.635859251022339
Epoch: 21, Steps: 154 | Train Loss: 0.493 Vali Loss: 1.962 Vali Acc: 0.503 Test Loss: 1.962 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.3895678
	speed: 0.1477s/iter; left time: 1781.9613s
Epoch: 22 cost time: 6.5597474575042725
Epoch: 22, Steps: 154 | Train Loss: 0.479 Vali Loss: 2.251 Vali Acc: 0.435 Test Loss: 2.251 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.9993443
	speed: 0.1461s/iter; left time: 1740.6874s
Epoch: 23 cost time: 6.716627359390259
Epoch: 23, Steps: 154 | Train Loss: 0.452 Vali Loss: 2.132 Vali Acc: 0.509 Test Loss: 2.132 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1163540
	speed: 0.1489s/iter; left time: 1750.3941s
Epoch: 24 cost time: 6.896046876907349
Epoch: 24, Steps: 154 | Train Loss: 0.433 Vali Loss: 2.167 Vali Acc: 0.473 Test Loss: 2.167 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.2819951
	speed: 0.1468s/iter; left time: 1703.4820s
Epoch: 25 cost time: 6.379923343658447
Epoch: 25, Steps: 154 | Train Loss: 0.448 Vali Loss: 2.267 Vali Acc: 0.468 Test Loss: 2.267 Test Acc: 0.468
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.5634615
	speed: 0.1510s/iter; left time: 1729.0467s
Epoch: 26 cost time: 6.710658311843872
Epoch: 26, Steps: 154 | Train Loss: 0.434 Vali Loss: 2.691 Vali Acc: 0.434 Test Loss: 2.691 Test Acc: 0.434
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.2611791
	speed: 0.1488s/iter; left time: 1681.4044s
Epoch: 27 cost time: 6.704601764678955
Epoch: 27, Steps: 154 | Train Loss: 0.426 Vali Loss: 2.484 Vali Acc: 0.453 Test Loss: 2.484 Test Acc: 0.453
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.6090980
	speed: 0.1493s/iter; left time: 1663.5348s
Epoch: 28 cost time: 6.372436285018921
Epoch: 28, Steps: 154 | Train Loss: 0.392 Vali Loss: 2.258 Vali Acc: 0.496 Test Loss: 2.258 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5600162206001622
model parameter : 40462
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2776966
	speed: 0.0511s/iter; left time: 781.4387s
Epoch: 1 cost time: 6.994594573974609
Epoch: 1, Steps: 154 | Train Loss: 2.233 Vali Loss: 1.945 Vali Acc: 0.372 Test Loss: 1.945 Test Acc: 0.372
Validation loss decreased (inf --> -0.371838).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4230192
	speed: 0.1293s/iter; left time: 1958.5558s
Epoch: 2 cost time: 5.1386637687683105
Epoch: 2, Steps: 154 | Train Loss: 1.673 Vali Loss: 1.883 Vali Acc: 0.415 Test Loss: 1.883 Test Acc: 0.415
Validation loss decreased (-0.371838 --> -0.415229).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2279583
	speed: 0.1201s/iter; left time: 1800.1390s
Epoch: 3 cost time: 5.070310592651367
Epoch: 3, Steps: 154 | Train Loss: 1.351 Vali Loss: 1.789 Vali Acc: 0.473 Test Loss: 1.789 Test Acc: 0.473
Validation loss decreased (-0.415229 --> -0.472813).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6377051
	speed: 0.1437s/iter; left time: 2132.7852s
Epoch: 4 cost time: 6.768180847167969
Epoch: 4, Steps: 154 | Train Loss: 1.236 Vali Loss: 1.884 Vali Acc: 0.467 Test Loss: 1.884 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1665140
	speed: 0.1457s/iter; left time: 2139.9299s
Epoch: 5 cost time: 6.1713032722473145
Epoch: 5, Steps: 154 | Train Loss: 1.146 Vali Loss: 1.658 Vali Acc: 0.511 Test Loss: 1.658 Test Acc: 0.511
Validation loss decreased (-0.472813 --> -0.510527).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3903395
	speed: 0.1560s/iter; left time: 2267.4549s
Epoch: 6 cost time: 6.9394237995147705
Epoch: 6, Steps: 154 | Train Loss: 1.069 Vali Loss: 1.684 Vali Acc: 0.521 Test Loss: 1.684 Test Acc: 0.521
Validation loss decreased (-0.510527 --> -0.521475).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9835238
	speed: 0.1445s/iter; left time: 2077.5381s
Epoch: 7 cost time: 6.57155179977417
Epoch: 7, Steps: 154 | Train Loss: 1.018 Vali Loss: 1.974 Vali Acc: 0.476 Test Loss: 1.974 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7193843
	speed: 0.1522s/iter; left time: 2164.2254s
Epoch: 8 cost time: 6.450252056121826
Epoch: 8, Steps: 154 | Train Loss: 0.943 Vali Loss: 1.577 Vali Acc: 0.540 Test Loss: 1.577 Test Acc: 0.540
Validation loss decreased (-0.521475 --> -0.539725).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5875491
	speed: 0.1562s/iter; left time: 2198.2072s
Epoch: 9 cost time: 8.055521965026855
Epoch: 9, Steps: 154 | Train Loss: 0.899 Vali Loss: 1.804 Vali Acc: 0.502 Test Loss: 1.804 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8525568
	speed: 0.1717s/iter; left time: 2389.8406s
Epoch: 10 cost time: 7.6708574295043945
Epoch: 10, Steps: 154 | Train Loss: 0.839 Vali Loss: 1.682 Vali Acc: 0.516 Test Loss: 1.682 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.3564543
	speed: 0.1697s/iter; left time: 2335.5001s
Epoch: 11 cost time: 8.46139907836914
Epoch: 11, Steps: 154 | Train Loss: 0.789 Vali Loss: 1.864 Vali Acc: 0.506 Test Loss: 1.864 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8322333
	speed: 0.1682s/iter; left time: 2288.2745s
Epoch: 12 cost time: 7.360834836959839
Epoch: 12, Steps: 154 | Train Loss: 0.783 Vali Loss: 1.797 Vali Acc: 0.532 Test Loss: 1.797 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.5366757
	speed: 0.1706s/iter; left time: 2294.6446s
Epoch: 13 cost time: 8.166300773620605
Epoch: 13, Steps: 154 | Train Loss: 0.740 Vali Loss: 1.770 Vali Acc: 0.537 Test Loss: 1.770 Test Acc: 0.537
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7881259
	speed: 0.1652s/iter; left time: 2196.4817s
Epoch: 14 cost time: 7.194048881530762
Epoch: 14, Steps: 154 | Train Loss: 0.720 Vali Loss: 1.796 Vali Acc: 0.544 Test Loss: 1.796 Test Acc: 0.544
Validation loss decreased (-0.539725 --> -0.543778).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0301363
	speed: 0.1737s/iter; left time: 2283.1692s
Epoch: 15 cost time: 8.3706796169281
Epoch: 15, Steps: 154 | Train Loss: 0.667 Vali Loss: 2.253 Vali Acc: 0.499 Test Loss: 2.253 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.9404528
	speed: 0.1723s/iter; left time: 2238.1860s
Epoch: 16 cost time: 8.029295444488525
Epoch: 16, Steps: 154 | Train Loss: 0.652 Vali Loss: 2.030 Vali Acc: 0.534 Test Loss: 2.030 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6154768
	speed: 0.1807s/iter; left time: 2319.3194s
Epoch: 17 cost time: 8.131407022476196
Epoch: 17, Steps: 154 | Train Loss: 0.628 Vali Loss: 1.889 Vali Acc: 0.524 Test Loss: 1.889 Test Acc: 0.524
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4900634
	speed: 0.1705s/iter; left time: 2162.1389s
Epoch: 18 cost time: 8.115872859954834
Epoch: 18, Steps: 154 | Train Loss: 0.598 Vali Loss: 1.922 Vali Acc: 0.535 Test Loss: 1.922 Test Acc: 0.535
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3766319
	speed: 0.1703s/iter; left time: 2134.3022s
Epoch: 19 cost time: 7.137736082077026
Epoch: 19, Steps: 154 | Train Loss: 0.567 Vali Loss: 2.020 Vali Acc: 0.554 Test Loss: 2.020 Test Acc: 0.554
Validation loss decreased (-0.543778 --> -0.554319).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6259575
	speed: 0.1704s/iter; left time: 2108.8997s
Epoch: 20 cost time: 8.121903896331787
Epoch: 20, Steps: 154 | Train Loss: 0.566 Vali Loss: 2.164 Vali Acc: 0.523 Test Loss: 2.164 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.7799815
	speed: 0.1667s/iter; left time: 2036.9964s
Epoch: 21 cost time: 7.561639070510864
Epoch: 21, Steps: 154 | Train Loss: 0.529 Vali Loss: 2.183 Vali Acc: 0.550 Test Loss: 2.183 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1413321
	speed: 0.1775s/iter; left time: 2142.4346s
Epoch: 22 cost time: 8.193429470062256
Epoch: 22, Steps: 154 | Train Loss: 0.500 Vali Loss: 2.142 Vali Acc: 0.499 Test Loss: 2.142 Test Acc: 0.499
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1863768
	speed: 0.1631s/iter; left time: 1942.5739s
Epoch: 23 cost time: 7.0888049602508545
Epoch: 23, Steps: 154 | Train Loss: 0.527 Vali Loss: 2.155 Vali Acc: 0.556 Test Loss: 2.155 Test Acc: 0.556
Validation loss decreased (-0.554319 --> -0.555534).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.7397130
	speed: 0.1582s/iter; left time: 1860.8410s
Epoch: 24 cost time: 6.297598600387573
Epoch: 24, Steps: 154 | Train Loss: 0.484 Vali Loss: 2.248 Vali Acc: 0.547 Test Loss: 2.248 Test Acc: 0.547
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1454842
	speed: 0.1518s/iter; left time: 1762.0394s
Epoch: 25 cost time: 6.863511085510254
Epoch: 25, Steps: 154 | Train Loss: 0.489 Vali Loss: 2.262 Vali Acc: 0.538 Test Loss: 2.262 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.1501894
	speed: 0.1522s/iter; left time: 1743.1594s
Epoch: 26 cost time: 6.4251179695129395
Epoch: 26, Steps: 154 | Train Loss: 0.452 Vali Loss: 2.566 Vali Acc: 0.506 Test Loss: 2.566 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.4062640
	speed: 0.1570s/iter; left time: 1773.4259s
Epoch: 27 cost time: 7.263315200805664
Epoch: 27, Steps: 154 | Train Loss: 0.449 Vali Loss: 2.432 Vali Acc: 0.515 Test Loss: 2.432 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.4907257
	speed: 0.1461s/iter; left time: 1628.2507s
Epoch: 28 cost time: 6.8183088302612305
Epoch: 28, Steps: 154 | Train Loss: 0.422 Vali Loss: 2.432 Vali Acc: 0.521 Test Loss: 2.432 Test Acc: 0.521
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.5020977
	speed: 0.1553s/iter; left time: 1706.9915s
Epoch: 29 cost time: 6.384670257568359
Epoch: 29, Steps: 154 | Train Loss: 0.424 Vali Loss: 2.453 Vali Acc: 0.522 Test Loss: 2.453 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.6127313
	speed: 0.1444s/iter; left time: 1564.7943s
Epoch: 30 cost time: 6.730494976043701
Epoch: 30, Steps: 154 | Train Loss: 0.382 Vali Loss: 2.438 Vali Acc: 0.521 Test Loss: 2.438 Test Acc: 0.521
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.2427312
	speed: 0.1480s/iter; left time: 1580.9058s
Epoch: 31 cost time: 6.087769985198975
Epoch: 31, Steps: 154 | Train Loss: 0.380 Vali Loss: 2.363 Vali Acc: 0.544 Test Loss: 2.363 Test Acc: 0.544
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.3648156
	speed: 0.1500s/iter; left time: 1579.4842s
Epoch: 32 cost time: 7.28331446647644
Epoch: 32, Steps: 154 | Train Loss: 0.378 Vali Loss: 2.432 Vali Acc: 0.538 Test Loss: 2.432 Test Acc: 0.538
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.2534286
	speed: 0.1562s/iter; left time: 1620.6887s
Epoch: 33 cost time: 7.367394208908081
Epoch: 33, Steps: 154 | Train Loss: 0.365 Vali Loss: 2.534 Vali Acc: 0.500 Test Loss: 2.534 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5555555555555556
model parameter : 40478
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0103533
	speed: 0.0638s/iter; left time: 976.0450s
Epoch: 1 cost time: 9.130018711090088
Epoch: 1, Steps: 154 | Train Loss: 2.270 Vali Loss: 1.983 Vali Acc: 0.367 Test Loss: 1.983 Test Acc: 0.367
Validation loss decreased (inf --> -0.366566).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3069564
	speed: 0.1720s/iter; left time: 2604.9340s
Epoch: 2 cost time: 8.133970737457275
Epoch: 2, Steps: 154 | Train Loss: 1.697 Vali Loss: 1.684 Vali Acc: 0.440 Test Loss: 1.684 Test Acc: 0.440
Validation loss decreased (-0.366566 --> -0.440372).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1567287
	speed: 0.1731s/iter; left time: 2595.9361s
Epoch: 3 cost time: 8.33709979057312
Epoch: 3, Steps: 154 | Train Loss: 1.357 Vali Loss: 1.765 Vali Acc: 0.465 Test Loss: 1.765 Test Acc: 0.465
Validation loss decreased (-0.440372 --> -0.465108).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5259252
	speed: 0.1752s/iter; left time: 2599.7258s
Epoch: 4 cost time: 7.839686393737793
Epoch: 4, Steps: 154 | Train Loss: 1.249 Vali Loss: 1.783 Vali Acc: 0.475 Test Loss: 1.783 Test Acc: 0.475
Validation loss decreased (-0.465108 --> -0.475246).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5712506
	speed: 0.1733s/iter; left time: 2545.2940s
Epoch: 5 cost time: 8.251862525939941
Epoch: 5, Steps: 154 | Train Loss: 1.169 Vali Loss: 1.800 Vali Acc: 0.474 Test Loss: 1.800 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1608362
	speed: 0.1667s/iter; left time: 2422.1054s
Epoch: 6 cost time: 6.892503976821899
Epoch: 6, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.971 Vali Acc: 0.458 Test Loss: 1.971 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.9491142
	speed: 0.1670s/iter; left time: 2400.3549s
Epoch: 7 cost time: 7.779903173446655
Epoch: 7, Steps: 154 | Train Loss: 1.085 Vali Loss: 1.750 Vali Acc: 0.483 Test Loss: 1.750 Test Acc: 0.483
Validation loss decreased (-0.475246 --> -0.483356).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1923397
	speed: 0.1646s/iter; left time: 2341.5561s
Epoch: 8 cost time: 7.383528232574463
Epoch: 8, Steps: 154 | Train Loss: 1.048 Vali Loss: 1.791 Vali Acc: 0.498 Test Loss: 1.791 Test Acc: 0.498
Validation loss decreased (-0.483356 --> -0.497549).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0024669
	speed: 0.1730s/iter; left time: 2433.5631s
Epoch: 9 cost time: 7.577763557434082
Epoch: 9, Steps: 154 | Train Loss: 0.989 Vali Loss: 1.843 Vali Acc: 0.493 Test Loss: 1.843 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1031142
	speed: 0.1627s/iter; left time: 2263.6248s
Epoch: 10 cost time: 7.952922821044922
Epoch: 10, Steps: 154 | Train Loss: 0.987 Vali Loss: 1.669 Vali Acc: 0.529 Test Loss: 1.669 Test Acc: 0.529
Validation loss decreased (-0.497549 --> -0.528775).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9622209
	speed: 0.1685s/iter; left time: 2319.1848s
Epoch: 11 cost time: 7.077193260192871
Epoch: 11, Steps: 154 | Train Loss: 0.939 Vali Loss: 1.678 Vali Acc: 0.486 Test Loss: 1.678 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6671715
	speed: 0.1623s/iter; left time: 2208.5931s
Epoch: 12 cost time: 7.638080358505249
Epoch: 12, Steps: 154 | Train Loss: 0.903 Vali Loss: 1.849 Vali Acc: 0.485 Test Loss: 1.849 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4518917
	speed: 0.1614s/iter; left time: 2171.3054s
Epoch: 13 cost time: 6.659188747406006
Epoch: 13, Steps: 154 | Train Loss: 0.883 Vali Loss: 1.789 Vali Acc: 0.482 Test Loss: 1.789 Test Acc: 0.482
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5413736
	speed: 0.1516s/iter; left time: 2015.8883s
Epoch: 14 cost time: 6.959606885910034
Epoch: 14, Steps: 154 | Train Loss: 0.845 Vali Loss: 1.898 Vali Acc: 0.486 Test Loss: 1.898 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.5628933
	speed: 0.1534s/iter; left time: 2016.6179s
Epoch: 15 cost time: 6.837113857269287
Epoch: 15, Steps: 154 | Train Loss: 0.805 Vali Loss: 1.638 Vali Acc: 0.531 Test Loss: 1.638 Test Acc: 0.531
Validation loss decreased (-0.528775 --> -0.530803).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5898456
	speed: 0.1566s/iter; left time: 2033.9665s
Epoch: 16 cost time: 6.635897874832153
Epoch: 16, Steps: 154 | Train Loss: 0.787 Vali Loss: 1.705 Vali Acc: 0.516 Test Loss: 1.705 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.5444431
	speed: 0.1454s/iter; left time: 1866.0369s
Epoch: 17 cost time: 6.677779912948608
Epoch: 17, Steps: 154 | Train Loss: 0.749 Vali Loss: 1.875 Vali Acc: 0.495 Test Loss: 1.875 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8026669
	speed: 0.1405s/iter; left time: 1782.0815s
Epoch: 18 cost time: 5.5244927406311035
Epoch: 18, Steps: 154 | Train Loss: 0.737 Vali Loss: 1.854 Vali Acc: 0.480 Test Loss: 1.854 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4449658
	speed: 0.1510s/iter; left time: 1892.2155s
Epoch: 19 cost time: 7.413570165634155
Epoch: 19, Steps: 154 | Train Loss: 0.711 Vali Loss: 1.897 Vali Acc: 0.512 Test Loss: 1.897 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8585091
	speed: 0.1489s/iter; left time: 1842.7946s
Epoch: 20 cost time: 6.289765357971191
Epoch: 20, Steps: 154 | Train Loss: 0.666 Vali Loss: 1.889 Vali Acc: 0.532 Test Loss: 1.889 Test Acc: 0.532
Validation loss decreased (-0.530803 --> -0.531611).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3344676
	speed: 0.1574s/iter; left time: 1924.1444s
Epoch: 21 cost time: 7.053835391998291
Epoch: 21, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.063 Vali Acc: 0.476 Test Loss: 2.063 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5117161
	speed: 0.1462s/iter; left time: 1764.7297s
Epoch: 22 cost time: 6.717605113983154
Epoch: 22, Steps: 154 | Train Loss: 0.633 Vali Loss: 1.993 Vali Acc: 0.510 Test Loss: 1.993 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.7657074
	speed: 0.1589s/iter; left time: 1892.9445s
Epoch: 23 cost time: 7.524564027786255
Epoch: 23, Steps: 154 | Train Loss: 0.599 Vali Loss: 2.062 Vali Acc: 0.521 Test Loss: 2.062 Test Acc: 0.521
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.9730910
	speed: 0.1669s/iter; left time: 1962.0209s
Epoch: 24 cost time: 8.168007850646973
Epoch: 24, Steps: 154 | Train Loss: 0.620 Vali Loss: 1.877 Vali Acc: 0.518 Test Loss: 1.877 Test Acc: 0.518
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.5497175
	speed: 0.1703s/iter; left time: 1976.0086s
Epoch: 25 cost time: 7.554784297943115
Epoch: 25, Steps: 154 | Train Loss: 0.566 Vali Loss: 2.146 Vali Acc: 0.485 Test Loss: 2.146 Test Acc: 0.485
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.3198780
	speed: 0.1692s/iter; left time: 1937.7058s
Epoch: 26 cost time: 7.962642669677734
Epoch: 26, Steps: 154 | Train Loss: 0.557 Vali Loss: 2.104 Vali Acc: 0.468 Test Loss: 2.104 Test Acc: 0.468
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6140580
	speed: 0.1655s/iter; left time: 1869.8049s
Epoch: 27 cost time: 6.817513465881348
Epoch: 27, Steps: 154 | Train Loss: 0.547 Vali Loss: 2.191 Vali Acc: 0.446 Test Loss: 2.191 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1884211
	speed: 0.1693s/iter; left time: 1885.9784s
Epoch: 28 cost time: 7.843653440475464
Epoch: 28, Steps: 154 | Train Loss: 0.524 Vali Loss: 2.129 Vali Acc: 0.485 Test Loss: 2.129 Test Acc: 0.485
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.6288574
	speed: 0.1648s/iter; left time: 1811.0386s
Epoch: 29 cost time: 7.230549097061157
Epoch: 29, Steps: 154 | Train Loss: 0.500 Vali Loss: 2.242 Vali Acc: 0.502 Test Loss: 2.242 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.5562299
	speed: 0.1457s/iter; left time: 1579.1797s
Epoch: 30 cost time: 6.052034616470337
Epoch: 30, Steps: 154 | Train Loss: 0.531 Vali Loss: 2.402 Vali Acc: 0.482 Test Loss: 2.402 Test Acc: 0.482
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5316301703163017
model parameter : 32446
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5933592
	speed: 0.0568s/iter; left time: 869.4580s
Epoch: 1 cost time: 7.828245162963867
Epoch: 1, Steps: 154 | Train Loss: 2.316 Vali Loss: 2.040 Vali Acc: 0.344 Test Loss: 2.040 Test Acc: 0.344
Validation loss decreased (inf --> -0.344262).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7868714
	speed: 0.1480s/iter; left time: 2241.2725s
Epoch: 2 cost time: 6.321039915084839
Epoch: 2, Steps: 154 | Train Loss: 1.796 Vali Loss: 1.678 Vali Acc: 0.439 Test Loss: 1.678 Test Acc: 0.439
Validation loss decreased (-0.344262 --> -0.438750).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3119744
	speed: 0.1481s/iter; left time: 2219.9185s
Epoch: 3 cost time: 6.525585412979126
Epoch: 3, Steps: 154 | Train Loss: 1.423 Vali Loss: 1.586 Vali Acc: 0.483 Test Loss: 1.586 Test Acc: 0.483
Validation loss decreased (-0.438750 --> -0.482953).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0488591
	speed: 0.1486s/iter; left time: 2204.6421s
Epoch: 4 cost time: 6.667280197143555
Epoch: 4, Steps: 154 | Train Loss: 1.279 Vali Loss: 1.786 Vali Acc: 0.477 Test Loss: 1.786 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9793793
	speed: 0.1461s/iter; left time: 2146.1642s
Epoch: 5 cost time: 6.633022308349609
Epoch: 5, Steps: 154 | Train Loss: 1.208 Vali Loss: 1.803 Vali Acc: 0.448 Test Loss: 1.803 Test Acc: 0.448
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1048100
	speed: 0.1343s/iter; left time: 1951.0689s
Epoch: 6 cost time: 5.85818886756897
Epoch: 6, Steps: 154 | Train Loss: 1.163 Vali Loss: 1.730 Vali Acc: 0.498 Test Loss: 1.730 Test Acc: 0.498
Validation loss decreased (-0.482953 --> -0.498361).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0597457
	speed: 0.1376s/iter; left time: 1978.0807s
Epoch: 7 cost time: 5.822569847106934
Epoch: 7, Steps: 154 | Train Loss: 1.116 Vali Loss: 1.730 Vali Acc: 0.504 Test Loss: 1.730 Test Acc: 0.504
Validation loss decreased (-0.498361 --> -0.504443).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4048827
	speed: 0.1376s/iter; left time: 1957.1432s
Epoch: 8 cost time: 5.973703861236572
Epoch: 8, Steps: 154 | Train Loss: 1.080 Vali Loss: 1.920 Vali Acc: 0.457 Test Loss: 1.920 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3178562
	speed: 0.1410s/iter; left time: 1983.8967s
Epoch: 9 cost time: 5.871250152587891
Epoch: 9, Steps: 154 | Train Loss: 1.049 Vali Loss: 1.730 Vali Acc: 0.483 Test Loss: 1.730 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.9143814
	speed: 0.1351s/iter; left time: 1880.4926s
Epoch: 10 cost time: 5.390585899353027
Epoch: 10, Steps: 154 | Train Loss: 1.015 Vali Loss: 2.111 Vali Acc: 0.465 Test Loss: 2.111 Test Acc: 0.465
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.7696558
	speed: 0.1368s/iter; left time: 1882.5429s
Epoch: 11 cost time: 5.738916635513306
Epoch: 11, Steps: 154 | Train Loss: 0.979 Vali Loss: 1.732 Vali Acc: 0.487 Test Loss: 1.732 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1247392
	speed: 0.1379s/iter; left time: 1876.2298s
Epoch: 12 cost time: 5.8119776248931885
Epoch: 12, Steps: 154 | Train Loss: 0.951 Vali Loss: 1.905 Vali Acc: 0.493 Test Loss: 1.905 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.8805581
	speed: 0.1365s/iter; left time: 1836.4942s
Epoch: 13 cost time: 5.683638572692871
Epoch: 13, Steps: 154 | Train Loss: 0.892 Vali Loss: 1.878 Vali Acc: 0.517 Test Loss: 1.878 Test Acc: 0.517
Validation loss decreased (-0.504443 --> -0.517418).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0720907
	speed: 0.1289s/iter; left time: 1713.5768s
Epoch: 14 cost time: 5.891417741775513
Epoch: 14, Steps: 154 | Train Loss: 0.860 Vali Loss: 1.881 Vali Acc: 0.475 Test Loss: 1.881 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8090963
	speed: 0.1378s/iter; left time: 1810.8640s
Epoch: 15 cost time: 6.547812223434448
Epoch: 15, Steps: 154 | Train Loss: 0.860 Vali Loss: 2.013 Vali Acc: 0.478 Test Loss: 2.013 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5756028
	speed: 0.1413s/iter; left time: 1836.1317s
Epoch: 16 cost time: 6.236958026885986
Epoch: 16, Steps: 154 | Train Loss: 0.831 Vali Loss: 1.994 Vali Acc: 0.453 Test Loss: 1.994 Test Acc: 0.453
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.5424316
	speed: 0.1449s/iter; left time: 1860.1272s
Epoch: 17 cost time: 6.4315807819366455
Epoch: 17, Steps: 154 | Train Loss: 0.780 Vali Loss: 1.945 Vali Acc: 0.495 Test Loss: 1.945 Test Acc: 0.495
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7904862
	speed: 0.1461s/iter; left time: 1853.3578s
Epoch: 18 cost time: 6.506929397583008
Epoch: 18, Steps: 154 | Train Loss: 0.772 Vali Loss: 1.816 Vali Acc: 0.534 Test Loss: 1.816 Test Acc: 0.534
Validation loss decreased (-0.517418 --> -0.533640).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4359688
	speed: 0.1444s/iter; left time: 1809.0575s
Epoch: 19 cost time: 6.605074405670166
Epoch: 19, Steps: 154 | Train Loss: 0.737 Vali Loss: 2.082 Vali Acc: 0.485 Test Loss: 2.082 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1084031
	speed: 0.1451s/iter; left time: 1795.5954s
Epoch: 20 cost time: 6.324509382247925
Epoch: 20, Steps: 154 | Train Loss: 0.706 Vali Loss: 1.831 Vali Acc: 0.488 Test Loss: 1.831 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.7658074
	speed: 0.1448s/iter; left time: 1769.3785s
Epoch: 21 cost time: 6.247929573059082
Epoch: 21, Steps: 154 | Train Loss: 0.713 Vali Loss: 1.928 Vali Acc: 0.509 Test Loss: 1.928 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.6202362
	speed: 0.1446s/iter; left time: 1744.9191s
Epoch: 22 cost time: 6.371789455413818
Epoch: 22, Steps: 154 | Train Loss: 0.677 Vali Loss: 1.922 Vali Acc: 0.512 Test Loss: 1.922 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.4612371
	speed: 0.1451s/iter; left time: 1729.1372s
Epoch: 23 cost time: 6.498782157897949
Epoch: 23, Steps: 154 | Train Loss: 0.659 Vali Loss: 2.044 Vali Acc: 0.494 Test Loss: 2.044 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.7761269
	speed: 0.1497s/iter; left time: 1760.2434s
Epoch: 24 cost time: 6.188206195831299
Epoch: 24, Steps: 154 | Train Loss: 0.649 Vali Loss: 1.918 Vali Acc: 0.507 Test Loss: 1.918 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6770779
	speed: 0.1466s/iter; left time: 1701.7989s
Epoch: 25 cost time: 6.193078994750977
Epoch: 25, Steps: 154 | Train Loss: 0.642 Vali Loss: 2.033 Vali Acc: 0.507 Test Loss: 2.033 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.9305654
	speed: 0.1412s/iter; left time: 1617.2801s
Epoch: 26 cost time: 6.328476190567017
Epoch: 26, Steps: 154 | Train Loss: 0.629 Vali Loss: 1.985 Vali Acc: 0.528 Test Loss: 1.985 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.9494995
	speed: 0.1469s/iter; left time: 1659.8349s
Epoch: 27 cost time: 6.482192277908325
Epoch: 27, Steps: 154 | Train Loss: 0.607 Vali Loss: 2.001 Vali Acc: 0.519 Test Loss: 2.001 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.4206146
	speed: 0.1371s/iter; left time: 1527.3036s
Epoch: 28 cost time: 5.620656728744507
Epoch: 28, Steps: 154 | Train Loss: 0.590 Vali Loss: 1.966 Vali Acc: 0.531 Test Loss: 1.966 Test Acc: 0.531
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5336577453365775
model parameter : 28446
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0588217
	speed: 0.0504s/iter; left time: 771.0852s
Epoch: 1 cost time: 6.826758146286011
Epoch: 1, Steps: 154 | Train Loss: 2.367 Vali Loss: 2.073 Vali Acc: 0.330 Test Loss: 2.073 Test Acc: 0.330
Validation loss decreased (inf --> -0.330474).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0648041
	speed: 0.1245s/iter; left time: 1886.4795s
Epoch: 2 cost time: 5.646246910095215
Epoch: 2, Steps: 154 | Train Loss: 1.875 Vali Loss: 1.750 Vali Acc: 0.423 Test Loss: 1.750 Test Acc: 0.423
Validation loss decreased (-0.330474 --> -0.422529).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9331048
	speed: 0.1272s/iter; left time: 1906.7475s
Epoch: 3 cost time: 5.180315256118774
Epoch: 3, Steps: 154 | Train Loss: 1.534 Vali Loss: 1.685 Vali Acc: 0.442 Test Loss: 1.685 Test Acc: 0.442
Validation loss decreased (-0.422529 --> -0.442400).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9766881
	speed: 0.1293s/iter; left time: 1918.8150s
Epoch: 4 cost time: 5.778712511062622
Epoch: 4, Steps: 154 | Train Loss: 1.364 Vali Loss: 1.757 Vali Acc: 0.462 Test Loss: 1.757 Test Acc: 0.462
Validation loss decreased (-0.442400 --> -0.461864).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3933532
	speed: 0.1353s/iter; left time: 1986.8639s
Epoch: 5 cost time: 5.751091003417969
Epoch: 5, Steps: 154 | Train Loss: 1.268 Vali Loss: 1.789 Vali Acc: 0.460 Test Loss: 1.789 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2488241
	speed: 0.1303s/iter; left time: 1893.5140s
Epoch: 6 cost time: 5.692834377288818
Epoch: 6, Steps: 154 | Train Loss: 1.204 Vali Loss: 1.669 Vali Acc: 0.485 Test Loss: 1.669 Test Acc: 0.485
Validation loss decreased (-0.461864 --> -0.485385).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2717422
	speed: 0.1307s/iter; left time: 1878.5902s
Epoch: 7 cost time: 5.494477033615112
Epoch: 7, Steps: 154 | Train Loss: 1.186 Vali Loss: 1.649 Vali Acc: 0.503 Test Loss: 1.649 Test Acc: 0.503
Validation loss decreased (-0.485385 --> -0.502822).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9592491
	speed: 0.1393s/iter; left time: 1981.0221s
Epoch: 8 cost time: 6.350072622299194
Epoch: 8, Steps: 154 | Train Loss: 1.145 Vali Loss: 1.738 Vali Acc: 0.490 Test Loss: 1.738 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6914782
	speed: 0.1400s/iter; left time: 1969.1788s
Epoch: 9 cost time: 6.356452941894531
Epoch: 9, Steps: 154 | Train Loss: 1.099 Vali Loss: 1.666 Vali Acc: 0.504 Test Loss: 1.666 Test Acc: 0.504
Validation loss decreased (-0.502822 --> -0.504444).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2848322
	speed: 0.1444s/iter; left time: 2009.2171s
Epoch: 10 cost time: 6.389615058898926
Epoch: 10, Steps: 154 | Train Loss: 1.073 Vali Loss: 1.724 Vali Acc: 0.501 Test Loss: 1.724 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5915937
	speed: 0.1428s/iter; left time: 1964.5644s
Epoch: 11 cost time: 6.296618461608887
Epoch: 11, Steps: 154 | Train Loss: 1.041 Vali Loss: 1.659 Vali Acc: 0.510 Test Loss: 1.659 Test Acc: 0.510
Validation loss decreased (-0.504444 --> -0.510121).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1195778
	speed: 0.1436s/iter; left time: 1954.3212s
Epoch: 12 cost time: 6.351717233657837
Epoch: 12, Steps: 154 | Train Loss: 0.991 Vali Loss: 1.949 Vali Acc: 0.483 Test Loss: 1.949 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1993285
	speed: 0.1453s/iter; left time: 1954.5563s
Epoch: 13 cost time: 6.380898952484131
Epoch: 13, Steps: 154 | Train Loss: 0.979 Vali Loss: 1.778 Vali Acc: 0.507 Test Loss: 1.778 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8333097
	speed: 0.1414s/iter; left time: 1880.9314s
Epoch: 14 cost time: 6.542845964431763
Epoch: 14, Steps: 154 | Train Loss: 0.956 Vali Loss: 1.843 Vali Acc: 0.502 Test Loss: 1.843 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9605055
	speed: 0.1409s/iter; left time: 1852.6725s
Epoch: 15 cost time: 6.405149936676025
Epoch: 15, Steps: 154 | Train Loss: 0.942 Vali Loss: 1.809 Vali Acc: 0.509 Test Loss: 1.809 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2018229
	speed: 0.1421s/iter; left time: 1846.5891s
Epoch: 16 cost time: 6.151064872741699
Epoch: 16, Steps: 154 | Train Loss: 0.921 Vali Loss: 1.814 Vali Acc: 0.508 Test Loss: 1.814 Test Acc: 0.508
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0919671
	speed: 0.1368s/iter; left time: 1756.1845s
Epoch: 17 cost time: 6.139266014099121
Epoch: 17, Steps: 154 | Train Loss: 0.877 Vali Loss: 1.711 Vali Acc: 0.541 Test Loss: 1.711 Test Acc: 0.541
Validation loss decreased (-0.510121 --> -0.540940).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.7354257
	speed: 0.1389s/iter; left time: 1761.8433s
Epoch: 18 cost time: 6.437556743621826
Epoch: 18, Steps: 154 | Train Loss: 0.840 Vali Loss: 1.807 Vali Acc: 0.521 Test Loss: 1.807 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6508560
	speed: 0.1501s/iter; left time: 1880.3843s
Epoch: 19 cost time: 6.5390989780426025
Epoch: 19, Steps: 154 | Train Loss: 0.837 Vali Loss: 1.895 Vali Acc: 0.513 Test Loss: 1.895 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.8867772
	speed: 0.1465s/iter; left time: 1813.2449s
Epoch: 20 cost time: 6.45792818069458
Epoch: 20, Steps: 154 | Train Loss: 0.826 Vali Loss: 2.013 Vali Acc: 0.494 Test Loss: 2.013 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.7333716
	speed: 0.1385s/iter; left time: 1692.9223s
Epoch: 21 cost time: 5.337620735168457
Epoch: 21, Steps: 154 | Train Loss: 0.789 Vali Loss: 1.733 Vali Acc: 0.555 Test Loss: 1.733 Test Acc: 0.555
Validation loss decreased (-0.540940 --> -0.554727).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.4871932
	speed: 0.1352s/iter; left time: 1631.4574s
Epoch: 22 cost time: 5.528120756149292
Epoch: 22, Steps: 154 | Train Loss: 0.774 Vali Loss: 1.791 Vali Acc: 0.512 Test Loss: 1.791 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4991815
	speed: 0.1382s/iter; left time: 1646.4982s
Epoch: 23 cost time: 5.864205837249756
Epoch: 23, Steps: 154 | Train Loss: 0.746 Vali Loss: 1.908 Vali Acc: 0.521 Test Loss: 1.908 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.2509032
	speed: 0.1364s/iter; left time: 1603.3618s
Epoch: 24 cost time: 5.831113338470459
Epoch: 24, Steps: 154 | Train Loss: 0.735 Vali Loss: 1.864 Vali Acc: 0.545 Test Loss: 1.864 Test Acc: 0.545
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.6978159
	speed: 0.1354s/iter; left time: 1571.0532s
Epoch: 25 cost time: 5.70731520652771
Epoch: 25, Steps: 154 | Train Loss: 0.723 Vali Loss: 1.886 Vali Acc: 0.531 Test Loss: 1.886 Test Acc: 0.531
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.7738323
	speed: 0.1316s/iter; left time: 1506.5971s
Epoch: 26 cost time: 5.6343653202056885
Epoch: 26, Steps: 154 | Train Loss: 0.706 Vali Loss: 1.962 Vali Acc: 0.521 Test Loss: 1.962 Test Acc: 0.521
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.7914703
	speed: 0.1375s/iter; left time: 1553.2694s
Epoch: 27 cost time: 5.714119911193848
Epoch: 27, Steps: 154 | Train Loss: 0.685 Vali Loss: 1.924 Vali Acc: 0.530 Test Loss: 1.924 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.5571474
	speed: 0.1327s/iter; left time: 1478.1833s
Epoch: 28 cost time: 5.812193393707275
Epoch: 28, Steps: 154 | Train Loss: 0.667 Vali Loss: 1.969 Vali Acc: 0.501 Test Loss: 1.969 Test Acc: 0.501
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.7690677
	speed: 0.1282s/iter; left time: 1408.8871s
Epoch: 29 cost time: 5.682257652282715
Epoch: 29, Steps: 154 | Train Loss: 0.661 Vali Loss: 2.092 Vali Acc: 0.501 Test Loss: 2.092 Test Acc: 0.501
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.3578900
	speed: 0.1326s/iter; left time: 1436.9192s
Epoch: 30 cost time: 6.2746007442474365
Epoch: 30, Steps: 154 | Train Loss: 0.671 Vali Loss: 2.387 Vali Acc: 0.474 Test Loss: 2.387 Test Acc: 0.474
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.8206590
	speed: 0.1388s/iter; left time: 1482.1496s
Epoch: 31 cost time: 6.366569519042969
Epoch: 31, Steps: 154 | Train Loss: 0.649 Vali Loss: 1.926 Vali Acc: 0.540 Test Loss: 1.926 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5547445255474452
model parameter : 25774
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7019460
	speed: 0.0566s/iter; left time: 865.4562s
Epoch: 1 cost time: 7.978824138641357
Epoch: 1, Steps: 154 | Train Loss: 2.128 Vali Loss: 1.838 Vali Acc: 0.400 Test Loss: 1.838 Test Acc: 0.400
Validation loss decreased (inf --> -0.399819).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1206586
	speed: 0.1428s/iter; left time: 2162.9887s
Epoch: 2 cost time: 6.489938735961914
Epoch: 2, Steps: 154 | Train Loss: 1.548 Vali Loss: 1.745 Vali Acc: 0.443 Test Loss: 1.745 Test Acc: 0.443
Validation loss decreased (-0.399819 --> -0.442805).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8096883
	speed: 0.1388s/iter; left time: 2081.3930s
Epoch: 3 cost time: 6.325779914855957
Epoch: 3, Steps: 154 | Train Loss: 1.256 Vali Loss: 1.711 Vali Acc: 0.481 Test Loss: 1.711 Test Acc: 0.481
Validation loss decreased (-0.442805 --> -0.481329).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1660210
	speed: 0.1394s/iter; left time: 2068.0756s
Epoch: 4 cost time: 6.381097078323364
Epoch: 4, Steps: 154 | Train Loss: 1.130 Vali Loss: 1.682 Vali Acc: 0.498 Test Loss: 1.682 Test Acc: 0.498
Validation loss decreased (-0.481329 --> -0.497956).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0570374
	speed: 0.1376s/iter; left time: 2020.5529s
Epoch: 5 cost time: 6.597297191619873
Epoch: 5, Steps: 154 | Train Loss: 1.038 Vali Loss: 1.959 Vali Acc: 0.485 Test Loss: 1.959 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1939631
	speed: 0.1381s/iter; left time: 2007.2473s
Epoch: 6 cost time: 6.424429178237915
Epoch: 6, Steps: 154 | Train Loss: 0.966 Vali Loss: 1.776 Vali Acc: 0.539 Test Loss: 1.776 Test Acc: 0.539
Validation loss decreased (-0.497956 --> -0.539317).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7525634
	speed: 0.1370s/iter; left time: 1970.3294s
Epoch: 7 cost time: 6.375799655914307
Epoch: 7, Steps: 154 | Train Loss: 0.900 Vali Loss: 1.746 Vali Acc: 0.532 Test Loss: 1.746 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5005340
	speed: 0.1368s/iter; left time: 1945.6791s
Epoch: 8 cost time: 6.395048141479492
Epoch: 8, Steps: 154 | Train Loss: 0.822 Vali Loss: 1.691 Vali Acc: 0.526 Test Loss: 1.691 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2960008
	speed: 0.1380s/iter; left time: 1941.2174s
Epoch: 9 cost time: 6.404617786407471
Epoch: 9, Steps: 154 | Train Loss: 0.788 Vali Loss: 1.878 Vali Acc: 0.512 Test Loss: 1.878 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.3617099
	speed: 0.1370s/iter; left time: 1906.5325s
Epoch: 10 cost time: 6.468904972076416
Epoch: 10, Steps: 154 | Train Loss: 0.747 Vali Loss: 2.006 Vali Acc: 0.509 Test Loss: 2.006 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2638134
	speed: 0.1381s/iter; left time: 1899.7527s
Epoch: 11 cost time: 6.182406187057495
Epoch: 11, Steps: 154 | Train Loss: 0.716 Vali Loss: 1.930 Vali Acc: 0.524 Test Loss: 1.930 Test Acc: 0.524
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5332044
	speed: 0.1289s/iter; left time: 1754.3391s
Epoch: 12 cost time: 5.407354831695557
Epoch: 12, Steps: 154 | Train Loss: 0.676 Vali Loss: 2.062 Vali Acc: 0.461 Test Loss: 2.062 Test Acc: 0.461
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0611563
	speed: 0.1202s/iter; left time: 1617.3932s
Epoch: 13 cost time: 5.315304756164551
Epoch: 13, Steps: 154 | Train Loss: 0.615 Vali Loss: 2.037 Vali Acc: 0.504 Test Loss: 2.037 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2397331
	speed: 0.1293s/iter; left time: 1719.3437s
Epoch: 14 cost time: 5.6985766887664795
Epoch: 14, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.176 Vali Acc: 0.523 Test Loss: 2.176 Test Acc: 0.523
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3083298
	speed: 0.1216s/iter; left time: 1598.8800s
Epoch: 15 cost time: 5.3575544357299805
Epoch: 15, Steps: 154 | Train Loss: 0.527 Vali Loss: 2.031 Vali Acc: 0.526 Test Loss: 2.031 Test Acc: 0.526
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3623189
	speed: 0.1245s/iter; left time: 1617.1793s
Epoch: 16 cost time: 5.662231922149658
Epoch: 16, Steps: 154 | Train Loss: 0.526 Vali Loss: 2.255 Vali Acc: 0.489 Test Loss: 2.255 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5393349553933495
model parameter : 58302
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8041302
	speed: 0.0493s/iter; left time: 754.2610s
Epoch: 1 cost time: 6.684142112731934
Epoch: 1, Steps: 154 | Train Loss: 2.154 Vali Loss: 1.867 Vali Acc: 0.401 Test Loss: 1.867 Test Acc: 0.401
Validation loss decreased (inf --> -0.401036).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8082564
	speed: 0.1307s/iter; left time: 1980.4667s
Epoch: 2 cost time: 6.342226028442383
Epoch: 2, Steps: 154 | Train Loss: 1.625 Vali Loss: 1.815 Vali Acc: 0.441 Test Loss: 1.815 Test Acc: 0.441
Validation loss decreased (-0.401036 --> -0.440777).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6878556
	speed: 0.1307s/iter; left time: 1960.0570s
Epoch: 3 cost time: 5.571073532104492
Epoch: 3, Steps: 154 | Train Loss: 1.331 Vali Loss: 1.928 Vali Acc: 0.457 Test Loss: 1.928 Test Acc: 0.457
Validation loss decreased (-0.440777 --> -0.456591).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8052610
	speed: 0.1230s/iter; left time: 1825.0157s
Epoch: 4 cost time: 5.477134704589844
Epoch: 4, Steps: 154 | Train Loss: 1.218 Vali Loss: 1.626 Vali Acc: 0.496 Test Loss: 1.626 Test Acc: 0.496
Validation loss decreased (-0.456591 --> -0.495523).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2980487
	speed: 0.1364s/iter; left time: 2003.1568s
Epoch: 5 cost time: 6.128698825836182
Epoch: 5, Steps: 154 | Train Loss: 1.115 Vali Loss: 1.580 Vali Acc: 0.490 Test Loss: 1.580 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8179487
	speed: 0.1384s/iter; left time: 2011.2362s
Epoch: 6 cost time: 5.7846221923828125
Epoch: 6, Steps: 154 | Train Loss: 1.053 Vali Loss: 1.594 Vali Acc: 0.539 Test Loss: 1.594 Test Acc: 0.539
Validation loss decreased (-0.495523 --> -0.538913).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6332295
	speed: 0.1380s/iter; left time: 1984.4460s
Epoch: 7 cost time: 6.35960841178894
Epoch: 7, Steps: 154 | Train Loss: 1.008 Vali Loss: 1.799 Vali Acc: 0.489 Test Loss: 1.799 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8391414
	speed: 0.1144s/iter; left time: 1626.4903s
Epoch: 8 cost time: 4.018463850021362
Epoch: 8, Steps: 154 | Train Loss: 0.945 Vali Loss: 1.684 Vali Acc: 0.522 Test Loss: 1.684 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.7737896
	speed: 0.0864s/iter; left time: 1215.8192s
Epoch: 9 cost time: 4.002696752548218
Epoch: 9, Steps: 154 | Train Loss: 0.916 Vali Loss: 1.638 Vali Acc: 0.529 Test Loss: 1.638 Test Acc: 0.529
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5723017
	speed: 0.0882s/iter; left time: 1227.0248s
Epoch: 10 cost time: 4.261928081512451
Epoch: 10, Steps: 154 | Train Loss: 0.863 Vali Loss: 1.619 Vali Acc: 0.557 Test Loss: 1.619 Test Acc: 0.557
Validation loss decreased (-0.538913 --> -0.556756).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4809504
	speed: 0.1350s/iter; left time: 1858.3536s
Epoch: 11 cost time: 6.416261911392212
Epoch: 11, Steps: 154 | Train Loss: 0.812 Vali Loss: 1.641 Vali Acc: 0.526 Test Loss: 1.641 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2565671
	speed: 0.1432s/iter; left time: 1948.1121s
Epoch: 12 cost time: 6.8529744148254395
Epoch: 12, Steps: 154 | Train Loss: 0.786 Vali Loss: 1.746 Vali Acc: 0.550 Test Loss: 1.746 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8636755
	speed: 0.1440s/iter; left time: 1937.1574s
Epoch: 13 cost time: 6.714553117752075
Epoch: 13, Steps: 154 | Train Loss: 0.792 Vali Loss: 1.810 Vali Acc: 0.519 Test Loss: 1.810 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4310277
	speed: 0.1421s/iter; left time: 1890.0364s
Epoch: 14 cost time: 6.2579193115234375
Epoch: 14, Steps: 154 | Train Loss: 0.744 Vali Loss: 1.781 Vali Acc: 0.517 Test Loss: 1.781 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7331263
	speed: 0.1433s/iter; left time: 1884.0267s
Epoch: 15 cost time: 6.664703607559204
Epoch: 15, Steps: 154 | Train Loss: 0.687 Vali Loss: 1.862 Vali Acc: 0.500 Test Loss: 1.862 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.5899431
	speed: 0.1423s/iter; left time: 1848.2831s
Epoch: 16 cost time: 6.41740083694458
Epoch: 16, Steps: 154 | Train Loss: 0.664 Vali Loss: 1.908 Vali Acc: 0.521 Test Loss: 1.908 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.4333964
	speed: 0.1455s/iter; left time: 1867.5473s
Epoch: 17 cost time: 6.414994478225708
Epoch: 17, Steps: 154 | Train Loss: 0.630 Vali Loss: 1.919 Vali Acc: 0.509 Test Loss: 1.919 Test Acc: 0.509
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.5213200
	speed: 0.1431s/iter; left time: 1814.6423s
Epoch: 18 cost time: 6.553947925567627
Epoch: 18, Steps: 154 | Train Loss: 0.611 Vali Loss: 1.804 Vali Acc: 0.491 Test Loss: 1.804 Test Acc: 0.491
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.5839949
	speed: 0.1435s/iter; left time: 1797.8404s
Epoch: 19 cost time: 6.245728015899658
Epoch: 19, Steps: 154 | Train Loss: 0.567 Vali Loss: 1.979 Vali Acc: 0.480 Test Loss: 1.979 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.6586165
	speed: 0.1425s/iter; left time: 1763.7788s
Epoch: 20 cost time: 6.266847848892212
Epoch: 20, Steps: 154 | Train Loss: 0.545 Vali Loss: 2.103 Vali Acc: 0.468 Test Loss: 2.103 Test Acc: 0.468
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.556772100567721
model parameter : 34126
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9057889
	speed: 0.0558s/iter; left time: 853.9523s
Epoch: 1 cost time: 7.538621187210083
Epoch: 1, Steps: 154 | Train Loss: 2.169 Vali Loss: 1.860 Vali Acc: 0.403 Test Loss: 1.860 Test Acc: 0.403
Validation loss decreased (inf --> -0.402658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4131099
	speed: 0.1296s/iter; left time: 1963.3703s
Epoch: 2 cost time: 4.8389105796813965
Epoch: 2, Steps: 154 | Train Loss: 1.606 Vali Loss: 1.748 Vali Acc: 0.432 Test Loss: 1.748 Test Acc: 0.432
Validation loss decreased (-0.402658 --> -0.431856).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1751007
	speed: 0.1250s/iter; left time: 1873.9530s
Epoch: 3 cost time: 5.160123586654663
Epoch: 3, Steps: 154 | Train Loss: 1.343 Vali Loss: 1.768 Vali Acc: 0.468 Test Loss: 1.768 Test Acc: 0.468
Validation loss decreased (-0.431856 --> -0.467947).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0668248
	speed: 0.1184s/iter; left time: 1757.6725s
Epoch: 4 cost time: 4.925750494003296
Epoch: 4, Steps: 154 | Train Loss: 1.242 Vali Loss: 1.735 Vali Acc: 0.491 Test Loss: 1.735 Test Acc: 0.491
Validation loss decreased (-0.467947 --> -0.491061).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6591005
	speed: 0.1176s/iter; left time: 1727.5333s
Epoch: 5 cost time: 4.951661109924316
Epoch: 5, Steps: 154 | Train Loss: 1.149 Vali Loss: 1.735 Vali Acc: 0.496 Test Loss: 1.735 Test Acc: 0.496
Validation loss decreased (-0.491061 --> -0.495927).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7744468
	speed: 0.1258s/iter; left time: 1828.2805s
Epoch: 6 cost time: 5.464835166931152
Epoch: 6, Steps: 154 | Train Loss: 1.082 Vali Loss: 1.758 Vali Acc: 0.495 Test Loss: 1.758 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0463353
	speed: 0.1214s/iter; left time: 1745.7010s
Epoch: 7 cost time: 5.2121875286102295
Epoch: 7, Steps: 154 | Train Loss: 1.014 Vali Loss: 1.695 Vali Acc: 0.514 Test Loss: 1.695 Test Acc: 0.514
Validation loss decreased (-0.495927 --> -0.514176).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7791827
	speed: 0.1228s/iter; left time: 1746.8867s
Epoch: 8 cost time: 5.2215211391448975
Epoch: 8, Steps: 154 | Train Loss: 0.954 Vali Loss: 1.815 Vali Acc: 0.502 Test Loss: 1.815 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.6911548
	speed: 0.1423s/iter; left time: 2001.4031s
Epoch: 9 cost time: 6.536396265029907
Epoch: 9, Steps: 154 | Train Loss: 0.917 Vali Loss: 1.682 Vali Acc: 0.508 Test Loss: 1.682 Test Acc: 0.508
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7144343
	speed: 0.1422s/iter; left time: 1978.8671s
Epoch: 10 cost time: 6.307313919067383
Epoch: 10, Steps: 154 | Train Loss: 0.866 Vali Loss: 1.713 Vali Acc: 0.540 Test Loss: 1.713 Test Acc: 0.540
Validation loss decreased (-0.514176 --> -0.540129).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8504663
	speed: 0.1402s/iter; left time: 1928.9203s
Epoch: 11 cost time: 6.308703899383545
Epoch: 11, Steps: 154 | Train Loss: 0.864 Vali Loss: 1.899 Vali Acc: 0.496 Test Loss: 1.899 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9083977
	speed: 0.1372s/iter; left time: 1867.3911s
Epoch: 12 cost time: 6.533440113067627
Epoch: 12, Steps: 154 | Train Loss: 0.813 Vali Loss: 1.672 Vali Acc: 0.567 Test Loss: 1.672 Test Acc: 0.567
Validation loss decreased (-0.540129 --> -0.566893).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8812588
	speed: 0.1476s/iter; left time: 1985.0726s
Epoch: 13 cost time: 6.66115140914917
Epoch: 13, Steps: 154 | Train Loss: 0.780 Vali Loss: 1.848 Vali Acc: 0.524 Test Loss: 1.848 Test Acc: 0.524
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2663518
	speed: 0.1556s/iter; left time: 2069.8211s
Epoch: 14 cost time: 7.223109483718872
Epoch: 14, Steps: 154 | Train Loss: 0.732 Vali Loss: 1.960 Vali Acc: 0.525 Test Loss: 1.960 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1940937
	speed: 0.1542s/iter; left time: 2027.0855s
Epoch: 15 cost time: 7.130321502685547
Epoch: 15, Steps: 154 | Train Loss: 0.708 Vali Loss: 1.873 Vali Acc: 0.527 Test Loss: 1.873 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6565707
	speed: 0.1540s/iter; left time: 2000.8415s
Epoch: 16 cost time: 6.73505163192749
Epoch: 16, Steps: 154 | Train Loss: 0.650 Vali Loss: 1.739 Vali Acc: 0.530 Test Loss: 1.739 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9135792
	speed: 0.1490s/iter; left time: 1912.9030s
Epoch: 17 cost time: 7.044527769088745
Epoch: 17, Steps: 154 | Train Loss: 0.634 Vali Loss: 2.039 Vali Acc: 0.506 Test Loss: 2.039 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6316068
	speed: 0.1516s/iter; left time: 1923.0715s
Epoch: 18 cost time: 6.880190849304199
Epoch: 18, Steps: 154 | Train Loss: 0.607 Vali Loss: 1.903 Vali Acc: 0.549 Test Loss: 1.903 Test Acc: 0.549
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.5228927
	speed: 0.1370s/iter; left time: 1716.5966s
Epoch: 19 cost time: 6.423669099807739
Epoch: 19, Steps: 154 | Train Loss: 0.590 Vali Loss: 1.933 Vali Acc: 0.567 Test Loss: 1.933 Test Acc: 0.567
Validation loss decreased (-0.566893 --> -0.567296).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.7365064
	speed: 0.1475s/iter; left time: 1825.7742s
Epoch: 20 cost time: 6.963467597961426
Epoch: 20, Steps: 154 | Train Loss: 0.581 Vali Loss: 1.883 Vali Acc: 0.561 Test Loss: 1.883 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4435431
	speed: 0.1364s/iter; left time: 1666.4849s
Epoch: 21 cost time: 5.621827840805054
Epoch: 21, Steps: 154 | Train Loss: 0.558 Vali Loss: 1.856 Vali Acc: 0.559 Test Loss: 1.856 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2409306
	speed: 0.1301s/iter; left time: 1570.4246s
Epoch: 22 cost time: 5.2844414710998535
Epoch: 22, Steps: 154 | Train Loss: 0.501 Vali Loss: 2.150 Vali Acc: 0.484 Test Loss: 2.150 Test Acc: 0.484
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1344215
	speed: 0.1344s/iter; left time: 1601.4498s
Epoch: 23 cost time: 5.457475900650024
Epoch: 23, Steps: 154 | Train Loss: 0.489 Vali Loss: 2.001 Vali Acc: 0.525 Test Loss: 2.001 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.6404394
	speed: 0.1320s/iter; left time: 1552.2918s
Epoch: 24 cost time: 5.355085134506226
Epoch: 24, Steps: 154 | Train Loss: 0.514 Vali Loss: 2.162 Vali Acc: 0.507 Test Loss: 2.162 Test Acc: 0.507
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.3789755
	speed: 0.1314s/iter; left time: 1525.0386s
Epoch: 25 cost time: 5.318488836288452
Epoch: 25, Steps: 154 | Train Loss: 0.452 Vali Loss: 2.173 Vali Acc: 0.480 Test Loss: 2.173 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.4928765
	speed: 0.1370s/iter; left time: 1569.2861s
Epoch: 26 cost time: 5.378870248794556
Epoch: 26, Steps: 154 | Train Loss: 0.455 Vali Loss: 2.313 Vali Acc: 0.466 Test Loss: 2.313 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.5229306
	speed: 0.1324s/iter; left time: 1495.9974s
Epoch: 27 cost time: 5.8008317947387695
Epoch: 27, Steps: 154 | Train Loss: 0.418 Vali Loss: 2.216 Vali Acc: 0.556 Test Loss: 2.216 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2470310
	speed: 0.1422s/iter; left time: 1584.0361s
Epoch: 28 cost time: 6.741164207458496
Epoch: 28, Steps: 154 | Train Loss: 0.441 Vali Loss: 2.305 Vali Acc: 0.481 Test Loss: 2.305 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.2616568
	speed: 0.1532s/iter; left time: 1683.9578s
Epoch: 29 cost time: 7.142272233963013
Epoch: 29, Steps: 154 | Train Loss: 0.400 Vali Loss: 2.233 Vali Acc: 0.512 Test Loss: 2.233 Test Acc: 0.512
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5673154906731549
model parameter : 34142
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2080302
	speed: 0.0540s/iter; left time: 825.5742s
Epoch: 1 cost time: 7.878876686096191
Epoch: 1, Steps: 154 | Train Loss: 2.304 Vali Loss: 2.060 Vali Acc: 0.326 Test Loss: 2.060 Test Acc: 0.326
Validation loss decreased (inf --> -0.326419).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7970657
	speed: 0.1531s/iter; left time: 2318.4583s
Epoch: 2 cost time: 6.876140832901001
Epoch: 2, Steps: 154 | Train Loss: 1.782 Vali Loss: 1.796 Vali Acc: 0.438 Test Loss: 1.796 Test Acc: 0.438
Validation loss decreased (-0.326419 --> -0.438344).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7201571
	speed: 0.1449s/iter; left time: 2172.5303s
Epoch: 3 cost time: 6.828806638717651
Epoch: 3, Steps: 154 | Train Loss: 1.399 Vali Loss: 1.686 Vali Acc: 0.479 Test Loss: 1.686 Test Acc: 0.479
Validation loss decreased (-0.438344 --> -0.478896).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2974844
	speed: 0.1532s/iter; left time: 2272.8265s
Epoch: 4 cost time: 6.825678825378418
Epoch: 4, Steps: 154 | Train Loss: 1.261 Vali Loss: 1.650 Vali Acc: 0.493 Test Loss: 1.650 Test Acc: 0.493
Validation loss decreased (-0.478896 --> -0.493090).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4091817
	speed: 0.1494s/iter; left time: 2194.6408s
Epoch: 5 cost time: 7.146835565567017
Epoch: 5, Steps: 154 | Train Loss: 1.186 Vali Loss: 1.622 Vali Acc: 0.498 Test Loss: 1.622 Test Acc: 0.498
Validation loss decreased (-0.493090 --> -0.497956).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6749705
	speed: 0.1570s/iter; left time: 2280.8441s
Epoch: 6 cost time: 7.270555734634399
Epoch: 6, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.740 Vali Acc: 0.515 Test Loss: 1.740 Test Acc: 0.515
Validation loss decreased (-0.497956 --> -0.514987).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7826489
	speed: 0.1516s/iter; left time: 2179.6897s
Epoch: 7 cost time: 7.058684587478638
Epoch: 7, Steps: 154 | Train Loss: 1.094 Vali Loss: 1.759 Vali Acc: 0.498 Test Loss: 1.759 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0843980
	speed: 0.1542s/iter; left time: 2192.5263s
Epoch: 8 cost time: 7.338431119918823
Epoch: 8, Steps: 154 | Train Loss: 1.033 Vali Loss: 1.644 Vali Acc: 0.506 Test Loss: 1.644 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6027364
	speed: 0.1502s/iter; left time: 2113.6722s
Epoch: 9 cost time: 6.898514270782471
Epoch: 9, Steps: 154 | Train Loss: 0.970 Vali Loss: 1.638 Vali Acc: 0.534 Test Loss: 1.638 Test Acc: 0.534
Validation loss decreased (-0.514987 --> -0.534047).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1171472
	speed: 0.1524s/iter; left time: 2120.6668s
Epoch: 10 cost time: 7.180963516235352
Epoch: 10, Steps: 154 | Train Loss: 0.952 Vali Loss: 1.658 Vali Acc: 0.505 Test Loss: 1.658 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8986081
	speed: 0.1377s/iter; left time: 1895.2944s
Epoch: 11 cost time: 5.671982288360596
Epoch: 11, Steps: 154 | Train Loss: 0.917 Vali Loss: 1.638 Vali Acc: 0.547 Test Loss: 1.638 Test Acc: 0.547
Validation loss decreased (-0.534047 --> -0.547429).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5711045
	speed: 0.1304s/iter; left time: 1774.9957s
Epoch: 12 cost time: 5.000049591064453
Epoch: 12, Steps: 154 | Train Loss: 0.855 Vali Loss: 1.635 Vali Acc: 0.535 Test Loss: 1.635 Test Acc: 0.535
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.8353403
	speed: 0.1323s/iter; left time: 1779.2822s
Epoch: 13 cost time: 5.660769701004028
Epoch: 13, Steps: 154 | Train Loss: 0.852 Vali Loss: 1.629 Vali Acc: 0.528 Test Loss: 1.629 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7254024
	speed: 0.1362s/iter; left time: 1811.8551s
Epoch: 14 cost time: 5.27390193939209
Epoch: 14, Steps: 154 | Train Loss: 0.817 Vali Loss: 1.828 Vali Acc: 0.473 Test Loss: 1.828 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0547168
	speed: 0.1253s/iter; left time: 1646.8283s
Epoch: 15 cost time: 5.289270877838135
Epoch: 15, Steps: 154 | Train Loss: 0.813 Vali Loss: 1.771 Vali Acc: 0.518 Test Loss: 1.771 Test Acc: 0.518
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.7017531
	speed: 0.1321s/iter; left time: 1716.5698s
Epoch: 16 cost time: 5.263432025909424
Epoch: 16, Steps: 154 | Train Loss: 0.760 Vali Loss: 1.834 Vali Acc: 0.528 Test Loss: 1.834 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0315511
	speed: 0.1294s/iter; left time: 1661.5596s
Epoch: 17 cost time: 5.5531229972839355
Epoch: 17, Steps: 154 | Train Loss: 0.742 Vali Loss: 1.860 Vali Acc: 0.530 Test Loss: 1.860 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.2320950
	speed: 0.1338s/iter; left time: 1696.7536s
Epoch: 18 cost time: 6.495408296585083
Epoch: 18, Steps: 154 | Train Loss: 0.729 Vali Loss: 1.923 Vali Acc: 0.514 Test Loss: 1.923 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.8249024
	speed: 0.1424s/iter; left time: 1783.5102s
Epoch: 19 cost time: 6.868356943130493
Epoch: 19, Steps: 154 | Train Loss: 0.686 Vali Loss: 1.956 Vali Acc: 0.493 Test Loss: 1.956 Test Acc: 0.493
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.5046678
	speed: 0.1473s/iter; left time: 1822.7954s
Epoch: 20 cost time: 6.618890762329102
Epoch: 20, Steps: 154 | Train Loss: 0.673 Vali Loss: 1.865 Vali Acc: 0.518 Test Loss: 1.865 Test Acc: 0.518
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.8511205
	speed: 0.1411s/iter; left time: 1724.4122s
Epoch: 21 cost time: 6.450819253921509
Epoch: 21, Steps: 154 | Train Loss: 0.650 Vali Loss: 1.762 Vali Acc: 0.531 Test Loss: 1.762 Test Acc: 0.531
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5474452554744526
model parameter : 26110
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2770333
	speed: 0.0569s/iter; left time: 870.3192s
Epoch: 1 cost time: 8.041930198669434
Epoch: 1, Steps: 154 | Train Loss: 2.342 Vali Loss: 2.096 Vali Acc: 0.322 Test Loss: 2.096 Test Acc: 0.322
Validation loss decreased (inf --> -0.321552).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2746556
	speed: 0.1536s/iter; left time: 2326.0965s
Epoch: 2 cost time: 6.66612982749939
Epoch: 2, Steps: 154 | Train Loss: 1.856 Vali Loss: 1.713 Vali Acc: 0.414 Test Loss: 1.713 Test Acc: 0.414
Validation loss decreased (-0.321552 --> -0.413608).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0984054
	speed: 0.1469s/iter; left time: 2202.2482s
Epoch: 3 cost time: 6.81099534034729
Epoch: 3, Steps: 154 | Train Loss: 1.466 Vali Loss: 1.761 Vali Acc: 0.449 Test Loss: 1.761 Test Acc: 0.449
Validation loss decreased (-0.413608 --> -0.448887).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3159993
	speed: 0.1497s/iter; left time: 2221.7735s
Epoch: 4 cost time: 6.532191514968872
Epoch: 4, Steps: 154 | Train Loss: 1.292 Vali Loss: 1.692 Vali Acc: 0.477 Test Loss: 1.692 Test Acc: 0.477
Validation loss decreased (-0.448887 --> -0.477274).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8259034
	speed: 0.1453s/iter; left time: 2133.8365s
Epoch: 5 cost time: 6.745706796646118
Epoch: 5, Steps: 154 | Train Loss: 1.216 Vali Loss: 1.942 Vali Acc: 0.451 Test Loss: 1.942 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1240680
	speed: 0.1512s/iter; left time: 2196.8930s
Epoch: 6 cost time: 6.886334657669067
Epoch: 6, Steps: 154 | Train Loss: 1.170 Vali Loss: 1.794 Vali Acc: 0.464 Test Loss: 1.794 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3567986
	speed: 0.1327s/iter; left time: 1907.5503s
Epoch: 7 cost time: 5.26904034614563
Epoch: 7, Steps: 154 | Train Loss: 1.128 Vali Loss: 1.824 Vali Acc: 0.486 Test Loss: 1.824 Test Acc: 0.486
Validation loss decreased (-0.477274 --> -0.485789).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3892151
	speed: 0.1314s/iter; left time: 1868.3150s
Epoch: 8 cost time: 6.221597671508789
Epoch: 8, Steps: 154 | Train Loss: 1.089 Vali Loss: 2.182 Vali Acc: 0.444 Test Loss: 2.182 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2390403
	speed: 0.1191s/iter; left time: 1675.2363s
Epoch: 9 cost time: 4.841736316680908
Epoch: 9, Steps: 154 | Train Loss: 1.063 Vali Loss: 1.950 Vali Acc: 0.492 Test Loss: 1.950 Test Acc: 0.492
Validation loss decreased (-0.485789 --> -0.492276).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9491200
	speed: 0.1179s/iter; left time: 1640.7232s
Epoch: 10 cost time: 4.80386209487915
Epoch: 10, Steps: 154 | Train Loss: 1.023 Vali Loss: 1.861 Vali Acc: 0.505 Test Loss: 1.861 Test Acc: 0.505
Validation loss decreased (-0.492276 --> -0.504848).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6715165
	speed: 0.1158s/iter; left time: 1593.4777s
Epoch: 11 cost time: 4.934972524642944
Epoch: 11, Steps: 154 | Train Loss: 0.977 Vali Loss: 2.086 Vali Acc: 0.468 Test Loss: 2.086 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9186430
	speed: 0.1120s/iter; left time: 1523.4793s
Epoch: 12 cost time: 4.37316370010376
Epoch: 12, Steps: 154 | Train Loss: 0.980 Vali Loss: 1.979 Vali Acc: 0.483 Test Loss: 1.979 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8582275
	speed: 0.1186s/iter; left time: 1595.3298s
Epoch: 13 cost time: 4.874459981918335
Epoch: 13, Steps: 154 | Train Loss: 0.940 Vali Loss: 1.927 Vali Acc: 0.463 Test Loss: 1.927 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0928454
	speed: 0.1193s/iter; left time: 1586.3447s
Epoch: 14 cost time: 5.0606770515441895
Epoch: 14, Steps: 154 | Train Loss: 0.934 Vali Loss: 2.066 Vali Acc: 0.455 Test Loss: 2.066 Test Acc: 0.455
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.0859933
	speed: 0.1157s/iter; left time: 1520.6202s
Epoch: 15 cost time: 4.645666122436523
Epoch: 15, Steps: 154 | Train Loss: 0.890 Vali Loss: 2.079 Vali Acc: 0.481 Test Loss: 2.079 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3145018
	speed: 0.1303s/iter; left time: 1692.2891s
Epoch: 16 cost time: 6.215345144271851
Epoch: 16, Steps: 154 | Train Loss: 0.844 Vali Loss: 1.908 Vali Acc: 0.495 Test Loss: 1.908 Test Acc: 0.495
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.5077680
	speed: 0.1403s/iter; left time: 1800.4579s
Epoch: 17 cost time: 6.292341470718384
Epoch: 17, Steps: 154 | Train Loss: 0.828 Vali Loss: 2.073 Vali Acc: 0.487 Test Loss: 2.073 Test Acc: 0.487
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.0082475
	speed: 0.1398s/iter; left time: 1772.5359s
Epoch: 18 cost time: 5.95880651473999
Epoch: 18, Steps: 154 | Train Loss: 0.810 Vali Loss: 1.850 Vali Acc: 0.514 Test Loss: 1.850 Test Acc: 0.514
Validation loss decreased (-0.504848 --> -0.513769).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0806959
	speed: 0.1369s/iter; left time: 1714.6131s
Epoch: 19 cost time: 6.112196445465088
Epoch: 19, Steps: 154 | Train Loss: 0.765 Vali Loss: 1.964 Vali Acc: 0.480 Test Loss: 1.964 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.0278542
	speed: 0.1388s/iter; left time: 1717.3467s
Epoch: 20 cost time: 6.066703796386719
Epoch: 20, Steps: 154 | Train Loss: 0.751 Vali Loss: 1.989 Vali Acc: 0.500 Test Loss: 1.989 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.5034782
	speed: 0.1371s/iter; left time: 1675.8129s
Epoch: 21 cost time: 6.0654213428497314
Epoch: 21, Steps: 154 | Train Loss: 0.767 Vali Loss: 2.203 Vali Acc: 0.492 Test Loss: 2.203 Test Acc: 0.492
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.5358669
	speed: 0.1384s/iter; left time: 1669.9964s
Epoch: 22 cost time: 6.1823461055755615
Epoch: 22, Steps: 154 | Train Loss: 0.722 Vali Loss: 1.918 Vali Acc: 0.493 Test Loss: 1.918 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.7426696
	speed: 0.1355s/iter; left time: 1613.7073s
Epoch: 23 cost time: 5.934949159622192
Epoch: 23, Steps: 154 | Train Loss: 0.699 Vali Loss: 2.285 Vali Acc: 0.486 Test Loss: 2.285 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.5191767
	speed: 0.1357s/iter; left time: 1595.1483s
Epoch: 24 cost time: 6.170541524887085
Epoch: 24, Steps: 154 | Train Loss: 0.675 Vali Loss: 2.029 Vali Acc: 0.491 Test Loss: 2.029 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.4000077
	speed: 0.1334s/iter; left time: 1547.8223s
Epoch: 25 cost time: 6.11396861076355
Epoch: 25, Steps: 154 | Train Loss: 0.683 Vali Loss: 2.355 Vali Acc: 0.481 Test Loss: 2.355 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.7521363
	speed: 0.1355s/iter; left time: 1551.1416s
Epoch: 26 cost time: 5.9415283203125
Epoch: 26, Steps: 154 | Train Loss: 0.668 Vali Loss: 2.275 Vali Acc: 0.472 Test Loss: 2.275 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.8798694
	speed: 0.1304s/iter; left time: 1473.2150s
Epoch: 27 cost time: 6.144996643066406
Epoch: 27, Steps: 154 | Train Loss: 0.636 Vali Loss: 2.046 Vali Acc: 0.497 Test Loss: 2.046 Test Acc: 0.497
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.6078814
	speed: 0.1153s/iter; left time: 1285.2897s
Epoch: 28 cost time: 4.553919792175293
Epoch: 28, Steps: 154 | Train Loss: 0.625 Vali Loss: 2.224 Vali Acc: 0.501 Test Loss: 2.224 Test Acc: 0.501
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.513787510137875
model parameter : 22110
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3459818
	speed: 0.0462s/iter; left time: 706.6981s
Epoch: 1 cost time: 6.178498029708862
Epoch: 1, Steps: 154 | Train Loss: 2.420 Vali Loss: 2.119 Vali Acc: 0.309 Test Loss: 2.119 Test Acc: 0.309
Validation loss decreased (inf --> -0.308576).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2082567
	speed: 0.1138s/iter; left time: 1724.2380s
Epoch: 2 cost time: 4.650130271911621
Epoch: 2, Steps: 154 | Train Loss: 2.001 Vali Loss: 1.795 Vali Acc: 0.416 Test Loss: 1.795 Test Acc: 0.416
Validation loss decreased (-0.308576 --> -0.415635).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3445387
	speed: 0.1134s/iter; left time: 1699.5815s
Epoch: 3 cost time: 4.40779709815979
Epoch: 3, Steps: 154 | Train Loss: 1.616 Vali Loss: 1.643 Vali Acc: 0.433 Test Loss: 1.643 Test Acc: 0.433
Validation loss decreased (-0.415635 --> -0.433479).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1119262
	speed: 0.1168s/iter; left time: 1733.8531s
Epoch: 4 cost time: 4.599937438964844
Epoch: 4, Steps: 154 | Train Loss: 1.420 Vali Loss: 1.653 Vali Acc: 0.455 Test Loss: 1.653 Test Acc: 0.455
Validation loss decreased (-0.433479 --> -0.455377).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9066027
	speed: 0.1179s/iter; left time: 1732.0829s
Epoch: 5 cost time: 4.621708393096924
Epoch: 5, Steps: 154 | Train Loss: 1.286 Vali Loss: 1.640 Vali Acc: 0.485 Test Loss: 1.640 Test Acc: 0.485
Validation loss decreased (-0.455377 --> -0.484980).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3141354
	speed: 0.1289s/iter; left time: 1872.3968s
Epoch: 6 cost time: 6.105813980102539
Epoch: 6, Steps: 154 | Train Loss: 1.247 Vali Loss: 1.669 Vali Acc: 0.494 Test Loss: 1.669 Test Acc: 0.494
Validation loss decreased (-0.484980 --> -0.493495).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4478056
	speed: 0.1373s/iter; left time: 1974.0053s
Epoch: 7 cost time: 6.3800458908081055
Epoch: 7, Steps: 154 | Train Loss: 1.188 Vali Loss: 1.664 Vali Acc: 0.477 Test Loss: 1.664 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4342793
	speed: 0.1365s/iter; left time: 1942.1051s
Epoch: 8 cost time: 5.927196025848389
Epoch: 8, Steps: 154 | Train Loss: 1.162 Vali Loss: 1.759 Vali Acc: 0.489 Test Loss: 1.759 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3641616
	speed: 0.1398s/iter; left time: 1966.5546s
Epoch: 9 cost time: 6.4392054080963135
Epoch: 9, Steps: 154 | Train Loss: 1.084 Vali Loss: 1.799 Vali Acc: 0.483 Test Loss: 1.799 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.7462469
	speed: 0.1361s/iter; left time: 1894.0843s
Epoch: 10 cost time: 6.199678421020508
Epoch: 10, Steps: 154 | Train Loss: 1.069 Vali Loss: 1.772 Vali Acc: 0.466 Test Loss: 1.772 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.7301974
	speed: 0.1348s/iter; left time: 1855.0839s
Epoch: 11 cost time: 6.092045068740845
Epoch: 11, Steps: 154 | Train Loss: 1.037 Vali Loss: 2.013 Vali Acc: 0.471 Test Loss: 2.013 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1242881
	speed: 0.1269s/iter; left time: 1726.3253s
Epoch: 12 cost time: 5.582021236419678
Epoch: 12, Steps: 154 | Train Loss: 1.004 Vali Loss: 1.972 Vali Acc: 0.473 Test Loss: 1.972 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.2313284
	speed: 0.1347s/iter; left time: 1812.5137s
Epoch: 13 cost time: 6.146536588668823
Epoch: 13, Steps: 154 | Train Loss: 0.963 Vali Loss: 1.902 Vali Acc: 0.478 Test Loss: 1.902 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4502004
	speed: 0.1277s/iter; left time: 1697.7966s
Epoch: 14 cost time: 5.852074861526489
Epoch: 14, Steps: 154 | Train Loss: 0.925 Vali Loss: 1.759 Vali Acc: 0.515 Test Loss: 1.759 Test Acc: 0.515
Validation loss decreased (-0.493495 --> -0.515392).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1674062
	speed: 0.1355s/iter; left time: 1781.7404s
Epoch: 15 cost time: 6.081430673599243
Epoch: 15, Steps: 154 | Train Loss: 0.933 Vali Loss: 1.665 Vali Acc: 0.491 Test Loss: 1.665 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5114099
	speed: 0.1333s/iter; left time: 1731.9422s
Epoch: 16 cost time: 5.971989154815674
Epoch: 16, Steps: 154 | Train Loss: 0.897 Vali Loss: 1.975 Vali Acc: 0.474 Test Loss: 1.975 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6911386
	speed: 0.1378s/iter; left time: 1768.4018s
Epoch: 17 cost time: 5.844359636306763
Epoch: 17, Steps: 154 | Train Loss: 0.881 Vali Loss: 1.805 Vali Acc: 0.488 Test Loss: 1.805 Test Acc: 0.488
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6164106
	speed: 0.1195s/iter; left time: 1515.5249s
Epoch: 18 cost time: 4.802332401275635
Epoch: 18, Steps: 154 | Train Loss: 0.864 Vali Loss: 1.690 Vali Acc: 0.538 Test Loss: 1.690 Test Acc: 0.538
Validation loss decreased (-0.515392 --> -0.538102).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9978243
	speed: 0.1168s/iter; left time: 1463.7805s
Epoch: 19 cost time: 4.622882604598999
Epoch: 19, Steps: 154 | Train Loss: 0.814 Vali Loss: 1.663 Vali Acc: 0.526 Test Loss: 1.663 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.9708121
	speed: 0.1158s/iter; left time: 1432.6668s
Epoch: 20 cost time: 4.646233081817627
Epoch: 20, Steps: 154 | Train Loss: 0.831 Vali Loss: 1.836 Vali Acc: 0.479 Test Loss: 1.836 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.4423519
	speed: 0.1176s/iter; left time: 1437.3612s
Epoch: 21 cost time: 4.526094913482666
Epoch: 21, Steps: 154 | Train Loss: 0.794 Vali Loss: 2.068 Vali Acc: 0.479 Test Loss: 2.068 Test Acc: 0.479
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.4581260
	speed: 0.1138s/iter; left time: 1372.9688s
Epoch: 22 cost time: 4.646076440811157
Epoch: 22, Steps: 154 | Train Loss: 0.782 Vali Loss: 2.135 Vali Acc: 0.480 Test Loss: 2.135 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.7086501
	speed: 0.1163s/iter; left time: 1385.7857s
Epoch: 23 cost time: 4.649970769882202
Epoch: 23, Steps: 154 | Train Loss: 0.747 Vali Loss: 1.819 Vali Acc: 0.518 Test Loss: 1.819 Test Acc: 0.518
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.1955348
	speed: 0.1140s/iter; left time: 1340.5510s
Epoch: 24 cost time: 4.766653776168823
Epoch: 24, Steps: 154 | Train Loss: 0.761 Vali Loss: 1.822 Vali Acc: 0.483 Test Loss: 1.822 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.8544945
	speed: 0.1146s/iter; left time: 1329.9510s
Epoch: 25 cost time: 4.947299003601074
Epoch: 25, Steps: 154 | Train Loss: 0.731 Vali Loss: 1.703 Vali Acc: 0.513 Test Loss: 1.703 Test Acc: 0.513
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.4312075
	speed: 0.1230s/iter; left time: 1408.3708s
Epoch: 26 cost time: 5.753391742706299
Epoch: 26, Steps: 154 | Train Loss: 0.715 Vali Loss: 2.018 Vali Acc: 0.474 Test Loss: 2.018 Test Acc: 0.474
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.5238386
	speed: 0.1269s/iter; left time: 1433.5989s
Epoch: 27 cost time: 5.671761989593506
Epoch: 27, Steps: 154 | Train Loss: 0.712 Vali Loss: 1.919 Vali Acc: 0.500 Test Loss: 1.919 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.7850466
	speed: 0.1359s/iter; left time: 1514.0002s
Epoch: 28 cost time: 5.795732259750366
Epoch: 28, Steps: 154 | Train Loss: 0.668 Vali Loss: 1.974 Vali Acc: 0.519 Test Loss: 1.974 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el3_dm16_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5381184103811841
model parameter : 19438
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9337752
	speed: 0.0690s/iter; left time: 1055.1232s
Epoch: 1 cost time: 9.829083442687988
Epoch: 1, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.280 Vali Acc: 0.426 Test Loss: 2.280 Test Acc: 0.426
Validation loss decreased (inf --> -0.426173).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9225080
	speed: 0.1622s/iter; left time: 2456.8683s
Epoch: 2 cost time: 8.207446336746216
Epoch: 2, Steps: 154 | Train Loss: 1.712 Vali Loss: 1.932 Vali Acc: 0.432 Test Loss: 1.932 Test Acc: 0.432
Validation loss decreased (-0.426173 --> -0.431854).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6421822
	speed: 0.1550s/iter; left time: 2323.9763s
Epoch: 3 cost time: 7.92324423789978
Epoch: 3, Steps: 154 | Train Loss: 1.441 Vali Loss: 1.832 Vali Acc: 0.533 Test Loss: 1.832 Test Acc: 0.533
Validation loss decreased (-0.431854 --> -0.533234).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7230883
	speed: 0.1915s/iter; left time: 2841.5969s
Epoch: 4 cost time: 10.279297590255737
Epoch: 4, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.349 Vali Acc: 0.537 Test Loss: 2.349 Test Acc: 0.537
Validation loss decreased (-0.533234 --> -0.537284).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4275150
	speed: 0.1854s/iter; left time: 2722.8399s
Epoch: 5 cost time: 10.342858791351318
Epoch: 5, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.040 Vali Acc: 0.531 Test Loss: 2.040 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5844277
	speed: 0.1862s/iter; left time: 2705.2261s
Epoch: 6 cost time: 9.156394243240356
Epoch: 6, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.504 Vali Acc: 0.526 Test Loss: 2.504 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0404344
	speed: 0.1916s/iter; left time: 2755.2701s
Epoch: 7 cost time: 9.660125255584717
Epoch: 7, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.812 Vali Acc: 0.492 Test Loss: 2.812 Test Acc: 0.492
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3046196
	speed: 0.1568s/iter; left time: 2230.2599s
Epoch: 8 cost time: 8.015984773635864
Epoch: 8, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.886 Vali Acc: 0.417 Test Loss: 3.886 Test Acc: 0.417
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.7905399
	speed: 0.1545s/iter; left time: 2174.0365s
Epoch: 9 cost time: 6.770100355148315
Epoch: 9, Steps: 154 | Train Loss: 1.403 Vali Loss: 3.479 Vali Acc: 0.447 Test Loss: 3.479 Test Acc: 0.447
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7411548
	speed: 0.1627s/iter; left time: 2264.4304s
Epoch: 10 cost time: 7.209725856781006
Epoch: 10, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.971 Vali Acc: 0.486 Test Loss: 3.971 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.4855379
	speed: 0.1427s/iter; left time: 1963.8292s
Epoch: 11 cost time: 7.2912209033966064
Epoch: 11, Steps: 154 | Train Loss: 1.224 Vali Loss: 4.596 Vali Acc: 0.382 Test Loss: 4.596 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.3299284
	speed: 0.1448s/iter; left time: 1970.8783s
Epoch: 12 cost time: 6.038684606552124
Epoch: 12, Steps: 154 | Train Loss: 1.120 Vali Loss: 4.478 Vali Acc: 0.454 Test Loss: 4.478 Test Acc: 0.454
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.2194372
	speed: 0.1530s/iter; left time: 2058.6558s
Epoch: 13 cost time: 6.930860280990601
Epoch: 13, Steps: 154 | Train Loss: 1.064 Vali Loss: 4.133 Vali Acc: 0.479 Test Loss: 4.133 Test Acc: 0.479
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.3057606
	speed: 0.1469s/iter; left time: 1953.9189s
Epoch: 14 cost time: 7.370556354522705
Epoch: 14, Steps: 154 | Train Loss: 1.001 Vali Loss: 5.989 Vali Acc: 0.414 Test Loss: 5.989 Test Acc: 0.414
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5373073803730738
model parameter : 652558
model size : 4.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7019920
	speed: 0.0750s/iter; left time: 1147.3730s
Epoch: 1 cost time: 10.49655294418335
Epoch: 1, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.052 Vali Acc: 0.465 Test Loss: 2.052 Test Acc: 0.465
Validation loss decreased (inf --> -0.464700).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5495327
	speed: 0.1652s/iter; left time: 2502.9806s
Epoch: 2 cost time: 9.085904836654663
Epoch: 2, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.052 Vali Acc: 0.501 Test Loss: 2.052 Test Acc: 0.501
Validation loss decreased (-0.464700 --> -0.500791).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6816632
	speed: 0.1664s/iter; left time: 2495.3539s
Epoch: 3 cost time: 8.120633125305176
Epoch: 3, Steps: 154 | Train Loss: 1.362 Vali Loss: 1.860 Vali Acc: 0.470 Test Loss: 1.860 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9435132
	speed: 0.1633s/iter; left time: 2423.1468s
Epoch: 4 cost time: 9.110854864120483
Epoch: 4, Steps: 154 | Train Loss: 1.280 Vali Loss: 1.974 Vali Acc: 0.516 Test Loss: 1.974 Test Acc: 0.516
Validation loss decreased (-0.500791 --> -0.515795).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6008550
	speed: 0.1633s/iter; left time: 2398.5793s
Epoch: 5 cost time: 8.994043111801147
Epoch: 5, Steps: 154 | Train Loss: 1.248 Vali Loss: 2.253 Vali Acc: 0.459 Test Loss: 2.253 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0870985
	speed: 0.1744s/iter; left time: 2534.5293s
Epoch: 6 cost time: 9.140240669250488
Epoch: 6, Steps: 154 | Train Loss: 1.142 Vali Loss: 2.683 Vali Acc: 0.478 Test Loss: 2.683 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1837032
	speed: 0.1620s/iter; left time: 2328.8060s
Epoch: 7 cost time: 9.31536602973938
Epoch: 7, Steps: 154 | Train Loss: 1.051 Vali Loss: 2.473 Vali Acc: 0.452 Test Loss: 2.473 Test Acc: 0.452
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8662575
	speed: 0.1688s/iter; left time: 2401.2395s
Epoch: 8 cost time: 8.935894012451172
Epoch: 8, Steps: 154 | Train Loss: 0.954 Vali Loss: 2.661 Vali Acc: 0.507 Test Loss: 2.661 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4318576
	speed: 0.1754s/iter; left time: 2467.4089s
Epoch: 9 cost time: 9.705867528915405
Epoch: 9, Steps: 154 | Train Loss: 0.917 Vali Loss: 3.175 Vali Acc: 0.509 Test Loss: 3.175 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.4401554
	speed: 0.1722s/iter; left time: 2395.6795s
Epoch: 10 cost time: 9.626622200012207
Epoch: 10, Steps: 154 | Train Loss: 0.842 Vali Loss: 2.833 Vali Acc: 0.506 Test Loss: 2.833 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.2587006
	speed: 0.1741s/iter; left time: 2396.0353s
Epoch: 11 cost time: 8.914770126342773
Epoch: 11, Steps: 154 | Train Loss: 0.731 Vali Loss: 3.350 Vali Acc: 0.426 Test Loss: 3.350 Test Acc: 0.426
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2616589
	speed: 0.1549s/iter; left time: 2107.2110s
Epoch: 12 cost time: 7.4037392139434814
Epoch: 12, Steps: 154 | Train Loss: 0.715 Vali Loss: 3.232 Vali Acc: 0.519 Test Loss: 3.232 Test Acc: 0.519
Validation loss decreased (-0.515795 --> -0.519432).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2463973
	speed: 0.1303s/iter; left time: 1752.4778s
Epoch: 13 cost time: 5.540921449661255
Epoch: 13, Steps: 154 | Train Loss: 0.671 Vali Loss: 3.368 Vali Acc: 0.455 Test Loss: 3.368 Test Acc: 0.455
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7986857
	speed: 0.1387s/iter; left time: 1844.5466s
Epoch: 14 cost time: 6.847703695297241
Epoch: 14, Steps: 154 | Train Loss: 0.578 Vali Loss: 3.613 Vali Acc: 0.482 Test Loss: 3.613 Test Acc: 0.482
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4933896
	speed: 0.1387s/iter; left time: 1823.6239s
Epoch: 15 cost time: 6.782188415527344
Epoch: 15, Steps: 154 | Train Loss: 0.590 Vali Loss: 4.321 Vali Acc: 0.486 Test Loss: 4.321 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2201475
	speed: 0.1273s/iter; left time: 1653.8847s
Epoch: 16 cost time: 5.268383979797363
Epoch: 16, Steps: 154 | Train Loss: 0.609 Vali Loss: 3.471 Vali Acc: 0.466 Test Loss: 3.471 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.3152869
	speed: 0.1362s/iter; left time: 1747.8121s
Epoch: 17 cost time: 6.63171648979187
Epoch: 17, Steps: 154 | Train Loss: 0.475 Vali Loss: 3.862 Vali Acc: 0.433 Test Loss: 3.862 Test Acc: 0.433
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4403228
	speed: 0.1312s/iter; left time: 1664.0579s
Epoch: 18 cost time: 5.536648750305176
Epoch: 18, Steps: 154 | Train Loss: 0.476 Vali Loss: 4.040 Vali Acc: 0.498 Test Loss: 4.040 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1063940
	speed: 0.1421s/iter; left time: 1779.9456s
Epoch: 19 cost time: 6.102346420288086
Epoch: 19, Steps: 154 | Train Loss: 0.444 Vali Loss: 3.843 Vali Acc: 0.494 Test Loss: 3.843 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2056350
	speed: 0.1536s/iter; left time: 1901.2631s
Epoch: 20 cost time: 9.385316848754883
Epoch: 20, Steps: 154 | Train Loss: 0.420 Vali Loss: 4.326 Vali Acc: 0.508 Test Loss: 4.326 Test Acc: 0.508
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.5840091
	speed: 0.1666s/iter; left time: 2036.0290s
Epoch: 21 cost time: 8.310635089874268
Epoch: 21, Steps: 154 | Train Loss: 0.422 Vali Loss: 4.056 Vali Acc: 0.473 Test Loss: 4.056 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6420866
	speed: 0.1755s/iter; left time: 2117.9238s
Epoch: 22 cost time: 9.32080864906311
Epoch: 22, Steps: 154 | Train Loss: 0.403 Vali Loss: 3.923 Vali Acc: 0.494 Test Loss: 3.923 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5194647201946472
model parameter : 459150
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6205351
	speed: 0.0715s/iter; left time: 1094.0160s
Epoch: 1 cost time: 9.933119058609009
Epoch: 1, Steps: 154 | Train Loss: 1.943 Vali Loss: 1.860 Vali Acc: 0.457 Test Loss: 1.860 Test Acc: 0.457
Validation loss decreased (inf --> -0.456997).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5199789
	speed: 0.1670s/iter; left time: 2528.8790s
Epoch: 2 cost time: 9.33239459991455
Epoch: 2, Steps: 154 | Train Loss: 1.494 Vali Loss: 1.941 Vali Acc: 0.507 Test Loss: 1.941 Test Acc: 0.507
Validation loss decreased (-0.456997 --> -0.506874).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5280493
	speed: 0.1640s/iter; left time: 2459.3354s
Epoch: 3 cost time: 8.745427131652832
Epoch: 3, Steps: 154 | Train Loss: 1.338 Vali Loss: 1.867 Vali Acc: 0.466 Test Loss: 1.867 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5828443
	speed: 0.1772s/iter; left time: 2630.1740s
Epoch: 4 cost time: 9.40772008895874
Epoch: 4, Steps: 154 | Train Loss: 1.280 Vali Loss: 1.958 Vali Acc: 0.404 Test Loss: 1.958 Test Acc: 0.404
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4194121
	speed: 0.1678s/iter; left time: 2464.7848s
Epoch: 5 cost time: 9.400256156921387
Epoch: 5, Steps: 154 | Train Loss: 1.236 Vali Loss: 2.304 Vali Acc: 0.530 Test Loss: 2.304 Test Acc: 0.530
Validation loss decreased (-0.506874 --> -0.530391).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2428288
	speed: 0.1675s/iter; left time: 2434.1010s
Epoch: 6 cost time: 8.12636113166809
Epoch: 6, Steps: 154 | Train Loss: 1.141 Vali Loss: 2.111 Vali Acc: 0.500 Test Loss: 2.111 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3008962
	speed: 0.1455s/iter; left time: 2091.6120s
Epoch: 7 cost time: 7.3407135009765625
Epoch: 7, Steps: 154 | Train Loss: 1.076 Vali Loss: 2.449 Vali Acc: 0.490 Test Loss: 2.449 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2461767
	speed: 0.1556s/iter; left time: 2212.5643s
Epoch: 8 cost time: 8.09594178199768
Epoch: 8, Steps: 154 | Train Loss: 0.984 Vali Loss: 2.834 Vali Acc: 0.470 Test Loss: 2.834 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.9825522
	speed: 0.1276s/iter; left time: 1795.8866s
Epoch: 9 cost time: 5.586459159851074
Epoch: 9, Steps: 154 | Train Loss: 0.928 Vali Loss: 2.587 Vali Acc: 0.519 Test Loss: 2.587 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.9895627
	speed: 0.1291s/iter; left time: 1796.5919s
Epoch: 10 cost time: 5.672893524169922
Epoch: 10, Steps: 154 | Train Loss: 0.880 Vali Loss: 2.645 Vali Acc: 0.487 Test Loss: 2.645 Test Acc: 0.487
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6700181
	speed: 0.1246s/iter; left time: 1714.5873s
Epoch: 11 cost time: 5.726578712463379
Epoch: 11, Steps: 154 | Train Loss: 0.782 Vali Loss: 2.658 Vali Acc: 0.474 Test Loss: 2.658 Test Acc: 0.474
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.2968570
	speed: 0.1199s/iter; left time: 1631.7734s
Epoch: 12 cost time: 5.289386987686157
Epoch: 12, Steps: 154 | Train Loss: 0.771 Vali Loss: 3.255 Vali Acc: 0.548 Test Loss: 3.255 Test Acc: 0.548
Validation loss decreased (-0.530391 --> -0.548224).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5922609
	speed: 0.1211s/iter; left time: 1628.6878s
Epoch: 13 cost time: 6.2029335498809814
Epoch: 13, Steps: 154 | Train Loss: 0.685 Vali Loss: 3.305 Vali Acc: 0.519 Test Loss: 3.305 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5260313
	speed: 0.1238s/iter; left time: 1645.8409s
Epoch: 14 cost time: 5.403506517410278
Epoch: 14, Steps: 154 | Train Loss: 0.612 Vali Loss: 3.687 Vali Acc: 0.492 Test Loss: 3.687 Test Acc: 0.492
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8909265
	speed: 0.1224s/iter; left time: 1608.9175s
Epoch: 15 cost time: 5.818070888519287
Epoch: 15, Steps: 154 | Train Loss: 0.579 Vali Loss: 3.551 Vali Acc: 0.524 Test Loss: 3.551 Test Acc: 0.524
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5587259
	speed: 0.1284s/iter; left time: 1667.4973s
Epoch: 16 cost time: 7.023452997207642
Epoch: 16, Steps: 154 | Train Loss: 0.540 Vali Loss: 3.724 Vali Acc: 0.530 Test Loss: 3.724 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.6816291
	speed: 0.1501s/iter; left time: 1926.8467s
Epoch: 17 cost time: 7.8686699867248535
Epoch: 17, Steps: 154 | Train Loss: 0.559 Vali Loss: 4.047 Vali Acc: 0.457 Test Loss: 4.047 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3657410
	speed: 0.1497s/iter; left time: 1898.7029s
Epoch: 18 cost time: 7.808966159820557
Epoch: 18, Steps: 154 | Train Loss: 0.463 Vali Loss: 3.778 Vali Acc: 0.491 Test Loss: 3.778 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2812839
	speed: 0.1496s/iter; left time: 1874.7695s
Epoch: 19 cost time: 7.67313027381897
Epoch: 19, Steps: 154 | Train Loss: 0.417 Vali Loss: 3.805 Vali Acc: 0.517 Test Loss: 3.805 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0153259
	speed: 0.1501s/iter; left time: 1857.6428s
Epoch: 20 cost time: 7.7587175369262695
Epoch: 20, Steps: 154 | Train Loss: 0.429 Vali Loss: 4.321 Vali Acc: 0.524 Test Loss: 4.321 Test Acc: 0.524
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1044859
	speed: 0.1500s/iter; left time: 1833.3643s
Epoch: 21 cost time: 7.692765235900879
Epoch: 21, Steps: 154 | Train Loss: 0.451 Vali Loss: 3.650 Vali Acc: 0.474 Test Loss: 3.650 Test Acc: 0.474
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3527871
	speed: 0.1522s/iter; left time: 1836.3130s
Epoch: 22 cost time: 7.7692551612854
Epoch: 22, Steps: 154 | Train Loss: 0.365 Vali Loss: 3.856 Vali Acc: 0.458 Test Loss: 3.856 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5482562854825629
model parameter : 459278
model size : 4.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.3214490
	speed: 0.0649s/iter; left time: 993.3159s
Epoch: 1 cost time: 9.206082582473755
Epoch: 1, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.152 Vali Acc: 0.410 Test Loss: 2.152 Test Acc: 0.410
Validation loss decreased (inf --> -0.409549).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7902989
	speed: 0.1465s/iter; left time: 2219.6385s
Epoch: 2 cost time: 7.842291831970215
Epoch: 2, Steps: 154 | Train Loss: 1.386 Vali Loss: 1.943 Vali Acc: 0.462 Test Loss: 1.943 Test Acc: 0.462
Validation loss decreased (-0.409549 --> -0.462268).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9496664
	speed: 0.1450s/iter; left time: 2173.9566s
Epoch: 3 cost time: 7.914124250411987
Epoch: 3, Steps: 154 | Train Loss: 1.276 Vali Loss: 2.649 Vali Acc: 0.462 Test Loss: 2.649 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4955070
	speed: 0.1383s/iter; left time: 2052.1898s
Epoch: 4 cost time: 6.088661193847656
Epoch: 4, Steps: 154 | Train Loss: 1.243 Vali Loss: 1.924 Vali Acc: 0.483 Test Loss: 1.924 Test Acc: 0.483
Validation loss decreased (-0.462268 --> -0.483355).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0747161
	speed: 0.1144s/iter; left time: 1680.5479s
Epoch: 5 cost time: 5.086129903793335
Epoch: 5, Steps: 154 | Train Loss: 1.146 Vali Loss: 2.131 Vali Acc: 0.496 Test Loss: 2.131 Test Acc: 0.496
Validation loss decreased (-0.483355 --> -0.495518).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8435985
	speed: 0.1134s/iter; left time: 1648.4387s
Epoch: 6 cost time: 5.025619268417358
Epoch: 6, Steps: 154 | Train Loss: 1.073 Vali Loss: 2.307 Vali Acc: 0.451 Test Loss: 2.307 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4015834
	speed: 0.1138s/iter; left time: 1635.5500s
Epoch: 7 cost time: 5.157533407211304
Epoch: 7, Steps: 154 | Train Loss: 0.986 Vali Loss: 2.283 Vali Acc: 0.482 Test Loss: 2.283 Test Acc: 0.482
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8991417
	speed: 0.1127s/iter; left time: 1603.0572s
Epoch: 8 cost time: 4.479247808456421
Epoch: 8, Steps: 154 | Train Loss: 0.912 Vali Loss: 2.592 Vali Acc: 0.404 Test Loss: 2.592 Test Acc: 0.404
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.0425780
	speed: 0.1176s/iter; left time: 1654.5676s
Epoch: 9 cost time: 5.331315755844116
Epoch: 9, Steps: 154 | Train Loss: 0.869 Vali Loss: 2.209 Vali Acc: 0.549 Test Loss: 2.209 Test Acc: 0.549
Validation loss decreased (-0.495518 --> -0.549451).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2985548
	speed: 0.1156s/iter; left time: 1608.1823s
Epoch: 10 cost time: 4.9638402462005615
Epoch: 10, Steps: 154 | Train Loss: 0.784 Vali Loss: 2.725 Vali Acc: 0.477 Test Loss: 2.725 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5051135
	speed: 0.1197s/iter; left time: 1646.8127s
Epoch: 11 cost time: 5.212501287460327
Epoch: 11, Steps: 154 | Train Loss: 0.705 Vali Loss: 3.179 Vali Acc: 0.422 Test Loss: 3.179 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4625376
	speed: 0.1333s/iter; left time: 1813.7186s
Epoch: 12 cost time: 7.90172815322876
Epoch: 12, Steps: 154 | Train Loss: 0.657 Vali Loss: 3.003 Vali Acc: 0.497 Test Loss: 3.003 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3347687
	speed: 0.1504s/iter; left time: 2023.5039s
Epoch: 13 cost time: 7.950235843658447
Epoch: 13, Steps: 154 | Train Loss: 0.596 Vali Loss: 2.783 Vali Acc: 0.476 Test Loss: 2.783 Test Acc: 0.476
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.1210445
	speed: 0.1486s/iter; left time: 1975.7541s
Epoch: 14 cost time: 7.913251638412476
Epoch: 14, Steps: 154 | Train Loss: 0.557 Vali Loss: 3.171 Vali Acc: 0.493 Test Loss: 3.171 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.4491194
	speed: 0.1498s/iter; left time: 1969.3931s
Epoch: 15 cost time: 8.071894645690918
Epoch: 15, Steps: 154 | Train Loss: 0.478 Vali Loss: 3.746 Vali Acc: 0.463 Test Loss: 3.746 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.5441635
	speed: 0.1515s/iter; left time: 1967.7443s
Epoch: 16 cost time: 7.684274435043335
Epoch: 16, Steps: 154 | Train Loss: 0.441 Vali Loss: 3.079 Vali Acc: 0.537 Test Loss: 3.079 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2805613
	speed: 0.1504s/iter; left time: 1931.1130s
Epoch: 17 cost time: 8.07693886756897
Epoch: 17, Steps: 154 | Train Loss: 0.472 Vali Loss: 3.166 Vali Acc: 0.465 Test Loss: 3.166 Test Acc: 0.465
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2490159
	speed: 0.1575s/iter; left time: 1997.7363s
Epoch: 18 cost time: 8.362160444259644
Epoch: 18, Steps: 154 | Train Loss: 0.410 Vali Loss: 3.431 Vali Acc: 0.522 Test Loss: 3.431 Test Acc: 0.522
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9958388
	speed: 0.1609s/iter; left time: 2015.6866s
Epoch: 19 cost time: 8.313713550567627
Epoch: 19, Steps: 154 | Train Loss: 0.407 Vali Loss: 3.472 Vali Acc: 0.476 Test Loss: 3.472 Test Acc: 0.476
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5494728304947283
model parameter : 395022
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9894550
	speed: 0.0424s/iter; left time: 648.9381s
Epoch: 1 cost time: 5.702130079269409
Epoch: 1, Steps: 154 | Train Loss: 2.010 Vali Loss: 1.910 Vali Acc: 0.432 Test Loss: 1.910 Test Acc: 0.432
Validation loss decreased (inf --> -0.431854).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0568979
	speed: 0.1179s/iter; left time: 1785.2597s
Epoch: 2 cost time: 4.241387844085693
Epoch: 2, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.237 Vali Acc: 0.487 Test Loss: 2.237 Test Acc: 0.487
Validation loss decreased (-0.431854 --> -0.487001).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0985858
	speed: 0.1178s/iter; left time: 1765.5094s
Epoch: 3 cost time: 4.272104978561401
Epoch: 3, Steps: 154 | Train Loss: 1.250 Vali Loss: 1.923 Vali Acc: 0.503 Test Loss: 1.923 Test Acc: 0.503
Validation loss decreased (-0.487001 --> -0.503225).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8144044
	speed: 0.1117s/iter; left time: 1656.7962s
Epoch: 4 cost time: 4.53803277015686
Epoch: 4, Steps: 154 | Train Loss: 1.203 Vali Loss: 1.927 Vali Acc: 0.479 Test Loss: 1.927 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4210960
	speed: 0.1129s/iter; left time: 1658.1519s
Epoch: 5 cost time: 4.158984422683716
Epoch: 5, Steps: 154 | Train Loss: 1.117 Vali Loss: 1.999 Vali Acc: 0.515 Test Loss: 1.999 Test Acc: 0.515
Validation loss decreased (-0.503225 --> -0.514579).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5907838
	speed: 0.1135s/iter; left time: 1649.1563s
Epoch: 6 cost time: 4.391246557235718
Epoch: 6, Steps: 154 | Train Loss: 1.033 Vali Loss: 2.047 Vali Acc: 0.528 Test Loss: 2.047 Test Acc: 0.528
Validation loss decreased (-0.514579 --> -0.527555).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2573127
	speed: 0.1133s/iter; left time: 1628.3986s
Epoch: 7 cost time: 4.08170485496521
Epoch: 7, Steps: 154 | Train Loss: 0.969 Vali Loss: 2.220 Vali Acc: 0.476 Test Loss: 2.220 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0556487
	speed: 0.1068s/iter; left time: 1519.1207s
Epoch: 8 cost time: 4.332604169845581
Epoch: 8, Steps: 154 | Train Loss: 0.856 Vali Loss: 2.278 Vali Acc: 0.505 Test Loss: 2.278 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4208812
	speed: 0.1151s/iter; left time: 1619.9108s
Epoch: 9 cost time: 4.241934299468994
Epoch: 9, Steps: 154 | Train Loss: 0.800 Vali Loss: 2.291 Vali Acc: 0.536 Test Loss: 2.291 Test Acc: 0.536
Validation loss decreased (-0.527555 --> -0.535662).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3280348
	speed: 0.1129s/iter; left time: 1570.6603s
Epoch: 10 cost time: 3.943870782852173
Epoch: 10, Steps: 154 | Train Loss: 0.741 Vali Loss: 2.388 Vali Acc: 0.484 Test Loss: 2.388 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1926874
	speed: 0.1061s/iter; left time: 1459.7468s
Epoch: 11 cost time: 4.1804773807525635
Epoch: 11, Steps: 154 | Train Loss: 0.723 Vali Loss: 2.388 Vali Acc: 0.507 Test Loss: 2.388 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4405649
	speed: 0.1060s/iter; left time: 1441.8430s
Epoch: 12 cost time: 4.041240692138672
Epoch: 12, Steps: 154 | Train Loss: 0.592 Vali Loss: 2.464 Vali Acc: 0.481 Test Loss: 2.464 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1955240
	speed: 0.1093s/iter; left time: 1470.4025s
Epoch: 13 cost time: 4.138636827468872
Epoch: 13, Steps: 154 | Train Loss: 0.594 Vali Loss: 2.832 Vali Acc: 0.464 Test Loss: 2.832 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5612852
	speed: 0.1127s/iter; left time: 1499.1238s
Epoch: 14 cost time: 4.380234241485596
Epoch: 14, Steps: 154 | Train Loss: 0.565 Vali Loss: 2.939 Vali Acc: 0.530 Test Loss: 2.939 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0783672
	speed: 0.1119s/iter; left time: 1470.6658s
Epoch: 15 cost time: 4.092881202697754
Epoch: 15, Steps: 154 | Train Loss: 0.548 Vali Loss: 2.893 Vali Acc: 0.510 Test Loss: 2.893 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.5394571
	speed: 0.1096s/iter; left time: 1423.1956s
Epoch: 16 cost time: 4.161895990371704
Epoch: 16, Steps: 154 | Train Loss: 0.501 Vali Loss: 2.913 Vali Acc: 0.499 Test Loss: 2.913 Test Acc: 0.499
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.6297095
	speed: 0.1117s/iter; left time: 1433.3426s
Epoch: 17 cost time: 3.986105442047119
Epoch: 17, Steps: 154 | Train Loss: 0.496 Vali Loss: 3.017 Vali Acc: 0.459 Test Loss: 3.017 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5598424
	speed: 0.1092s/iter; left time: 1385.2331s
Epoch: 18 cost time: 4.116467714309692
Epoch: 18, Steps: 154 | Train Loss: 0.411 Vali Loss: 3.112 Vali Acc: 0.479 Test Loss: 3.112 Test Acc: 0.479
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.2228300
	speed: 0.1171s/iter; left time: 1467.5075s
Epoch: 19 cost time: 4.211875677108765
Epoch: 19, Steps: 154 | Train Loss: 0.381 Vali Loss: 2.908 Vali Acc: 0.502 Test Loss: 2.908 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5356853203568532
model parameter : 363022
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7914314
	speed: 0.0395s/iter; left time: 604.4166s
Epoch: 1 cost time: 5.316667795181274
Epoch: 1, Steps: 154 | Train Loss: 2.092 Vali Loss: 1.890 Vali Acc: 0.419 Test Loss: 1.890 Test Acc: 0.419
Validation loss decreased (inf --> -0.419284).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2138498
	speed: 0.1128s/iter; left time: 1709.0712s
Epoch: 2 cost time: 3.9611117839813232
Epoch: 2, Steps: 154 | Train Loss: 1.433 Vali Loss: 1.879 Vali Acc: 0.473 Test Loss: 1.879 Test Acc: 0.473
Validation loss decreased (-0.419284 --> -0.473217).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2274045
	speed: 0.1099s/iter; left time: 1647.9210s
Epoch: 3 cost time: 4.235649108886719
Epoch: 3, Steps: 154 | Train Loss: 1.292 Vali Loss: 2.435 Vali Acc: 0.427 Test Loss: 2.435 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7575353
	speed: 0.1128s/iter; left time: 1673.4323s
Epoch: 4 cost time: 3.909398317337036
Epoch: 4, Steps: 154 | Train Loss: 1.194 Vali Loss: 2.042 Vali Acc: 0.505 Test Loss: 2.042 Test Acc: 0.505
Validation loss decreased (-0.473217 --> -0.504846).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0209768
	speed: 0.1093s/iter; left time: 1604.6599s
Epoch: 5 cost time: 4.174280643463135
Epoch: 5, Steps: 154 | Train Loss: 1.081 Vali Loss: 2.016 Vali Acc: 0.460 Test Loss: 2.016 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6621020
	speed: 0.1110s/iter; left time: 1612.5269s
Epoch: 6 cost time: 4.160125017166138
Epoch: 6, Steps: 154 | Train Loss: 1.033 Vali Loss: 2.730 Vali Acc: 0.426 Test Loss: 2.730 Test Acc: 0.426
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3005645
	speed: 0.1019s/iter; left time: 1465.6358s
Epoch: 7 cost time: 3.803370237350464
Epoch: 7, Steps: 154 | Train Loss: 0.924 Vali Loss: 2.030 Vali Acc: 0.540 Test Loss: 2.030 Test Acc: 0.540
Validation loss decreased (-0.504846 --> -0.539720).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1171721
	speed: 0.0986s/iter; left time: 1402.7259s
Epoch: 8 cost time: 3.7945525646209717
Epoch: 8, Steps: 154 | Train Loss: 0.865 Vali Loss: 2.292 Vali Acc: 0.481 Test Loss: 2.292 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9041453
	speed: 0.0967s/iter; left time: 1360.4100s
Epoch: 9 cost time: 3.69791579246521
Epoch: 9, Steps: 154 | Train Loss: 0.782 Vali Loss: 2.144 Vali Acc: 0.544 Test Loss: 2.144 Test Acc: 0.544
Validation loss decreased (-0.539720 --> -0.544180).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4424235
	speed: 0.0967s/iter; left time: 1345.0588s
Epoch: 10 cost time: 3.9758079051971436
Epoch: 10, Steps: 154 | Train Loss: 0.715 Vali Loss: 2.160 Vali Acc: 0.511 Test Loss: 2.160 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7568487
	speed: 0.0998s/iter; left time: 1373.8875s
Epoch: 11 cost time: 3.406294107437134
Epoch: 11, Steps: 154 | Train Loss: 0.651 Vali Loss: 2.460 Vali Acc: 0.502 Test Loss: 2.460 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7418005
	speed: 0.0948s/iter; left time: 1289.8108s
Epoch: 12 cost time: 3.865648031234741
Epoch: 12, Steps: 154 | Train Loss: 0.607 Vali Loss: 2.582 Vali Acc: 0.508 Test Loss: 2.582 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0817405
	speed: 0.1025s/iter; left time: 1378.5343s
Epoch: 13 cost time: 3.9012787342071533
Epoch: 13, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.582 Vali Acc: 0.474 Test Loss: 2.582 Test Acc: 0.474
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2357648
	speed: 0.0981s/iter; left time: 1304.3274s
Epoch: 14 cost time: 3.779176712036133
Epoch: 14, Steps: 154 | Train Loss: 0.481 Vali Loss: 3.074 Vali Acc: 0.459 Test Loss: 3.074 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3882917
	speed: 0.1026s/iter; left time: 1348.7408s
Epoch: 15 cost time: 4.091376304626465
Epoch: 15, Steps: 154 | Train Loss: 0.455 Vali Loss: 3.834 Vali Acc: 0.483 Test Loss: 3.834 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0838514
	speed: 0.1047s/iter; left time: 1360.3631s
Epoch: 16 cost time: 4.002103090286255
Epoch: 16, Steps: 154 | Train Loss: 0.452 Vali Loss: 2.727 Vali Acc: 0.478 Test Loss: 2.727 Test Acc: 0.478
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2291814
	speed: 0.1070s/iter; left time: 1373.0898s
Epoch: 17 cost time: 4.090640544891357
Epoch: 17, Steps: 154 | Train Loss: 0.395 Vali Loss: 2.923 Vali Acc: 0.515 Test Loss: 2.923 Test Acc: 0.515
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.4211978
	speed: 0.1093s/iter; left time: 1386.5285s
Epoch: 18 cost time: 4.06649374961853
Epoch: 18, Steps: 154 | Train Loss: 0.384 Vali Loss: 3.197 Vali Acc: 0.481 Test Loss: 3.197 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.6595474
	speed: 0.1124s/iter; left time: 1408.5192s
Epoch: 19 cost time: 4.339057445526123
Epoch: 19, Steps: 154 | Train Loss: 0.380 Vali Loss: 3.090 Vali Acc: 0.472 Test Loss: 3.090 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5442011354420113
model parameter : 341646
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4555988
	speed: 0.0815s/iter; left time: 1247.2609s
Epoch: 1 cost time: 11.761353492736816
Epoch: 1, Steps: 154 | Train Loss: 2.064 Vali Loss: 2.463 Vali Acc: 0.459 Test Loss: 2.463 Test Acc: 0.459
Validation loss decreased (inf --> -0.459424).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5772225
	speed: 0.1818s/iter; left time: 2754.2498s
Epoch: 2 cost time: 10.315288543701172
Epoch: 2, Steps: 154 | Train Loss: 1.815 Vali Loss: 4.032 Vali Acc: 0.391 Test Loss: 4.032 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0148401
	speed: 0.1870s/iter; left time: 2804.0251s
Epoch: 3 cost time: 10.800644874572754
Epoch: 3, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.083 Vali Acc: 0.452 Test Loss: 2.083 Test Acc: 0.452
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.5522759
	speed: 0.1878s/iter; left time: 2787.4434s
Epoch: 4 cost time: 10.959721088409424
Epoch: 4, Steps: 154 | Train Loss: 1.400 Vali Loss: 1.849 Vali Acc: 0.489 Test Loss: 1.849 Test Acc: 0.489
Validation loss decreased (-0.459424 --> -0.488627).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7479569
	speed: 0.1950s/iter; left time: 2863.9695s
Epoch: 5 cost time: 11.088433980941772
Epoch: 5, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.510 Vali Acc: 0.506 Test Loss: 2.510 Test Acc: 0.506
Validation loss decreased (-0.488627 --> -0.506058).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6952684
	speed: 0.1909s/iter; left time: 2774.2310s
Epoch: 6 cost time: 11.097387552261353
Epoch: 6, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.369 Vali Acc: 0.479 Test Loss: 2.369 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7427429
	speed: 0.1917s/iter; left time: 2755.9159s
Epoch: 7 cost time: 10.879755020141602
Epoch: 7, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.754 Vali Acc: 0.464 Test Loss: 2.754 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.3142250
	speed: 0.1537s/iter; left time: 2185.8988s
Epoch: 8 cost time: 7.518108129501343
Epoch: 8, Steps: 154 | Train Loss: 1.443 Vali Loss: 3.467 Vali Acc: 0.519 Test Loss: 3.467 Test Acc: 0.519
Validation loss decreased (-0.506058 --> -0.519430).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5167979
	speed: 0.1434s/iter; left time: 2017.6762s
Epoch: 9 cost time: 7.030204772949219
Epoch: 9, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.853 Vali Acc: 0.351 Test Loss: 3.853 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9415147
	speed: 0.1449s/iter; left time: 2016.3387s
Epoch: 10 cost time: 6.669177770614624
Epoch: 10, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.664 Vali Acc: 0.468 Test Loss: 3.664 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9207921
	speed: 0.1316s/iter; left time: 1810.3346s
Epoch: 11 cost time: 6.358995676040649
Epoch: 11, Steps: 154 | Train Loss: 1.150 Vali Loss: 3.900 Vali Acc: 0.492 Test Loss: 3.900 Test Acc: 0.492
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3851897
	speed: 0.1400s/iter; left time: 1905.6093s
Epoch: 12 cost time: 6.6774680614471436
Epoch: 12, Steps: 154 | Train Loss: 1.111 Vali Loss: 4.542 Vali Acc: 0.442 Test Loss: 4.542 Test Acc: 0.442
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7316138
	speed: 0.1418s/iter; left time: 1908.1103s
Epoch: 13 cost time: 6.704693794250488
Epoch: 13, Steps: 154 | Train Loss: 1.007 Vali Loss: 4.028 Vali Acc: 0.456 Test Loss: 4.028 Test Acc: 0.456
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6820019
	speed: 0.1386s/iter; left time: 1843.2145s
Epoch: 14 cost time: 7.067539930343628
Epoch: 14, Steps: 154 | Train Loss: 0.921 Vali Loss: 4.231 Vali Acc: 0.413 Test Loss: 4.231 Test Acc: 0.413
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6544778
	speed: 0.1779s/iter; left time: 2338.9530s
Epoch: 15 cost time: 10.712828397750854
Epoch: 15, Steps: 154 | Train Loss: 0.886 Vali Loss: 4.407 Vali Acc: 0.410 Test Loss: 4.407 Test Acc: 0.410
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.6743280
	speed: 0.1864s/iter; left time: 2421.2486s
Epoch: 16 cost time: 10.666032791137695
Epoch: 16, Steps: 154 | Train Loss: 0.668 Vali Loss: 5.466 Vali Acc: 0.501 Test Loss: 5.466 Test Acc: 0.501
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.6582042
	speed: 0.1906s/iter; left time: 2447.1514s
Epoch: 17 cost time: 11.025344848632812
Epoch: 17, Steps: 154 | Train Loss: 0.609 Vali Loss: 5.556 Vali Acc: 0.407 Test Loss: 5.556 Test Acc: 0.407
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.6647960
	speed: 0.1757s/iter; left time: 2228.7166s
Epoch: 18 cost time: 9.78039026260376
Epoch: 18, Steps: 154 | Train Loss: 0.607 Vali Loss: 4.686 Vali Acc: 0.465 Test Loss: 4.686 Test Acc: 0.465
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5194647201946472
model parameter : 586766
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9384131
	speed: 0.0735s/iter; left time: 1124.0752s
Epoch: 1 cost time: 10.52664303779602
Epoch: 1, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.303 Vali Acc: 0.414 Test Loss: 2.303 Test Acc: 0.414
Validation loss decreased (inf --> -0.414008).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3339150
	speed: 0.1637s/iter; left time: 2479.7431s
Epoch: 2 cost time: 9.572694063186646
Epoch: 2, Steps: 154 | Train Loss: 1.494 Vali Loss: 1.943 Vali Acc: 0.523 Test Loss: 1.943 Test Acc: 0.523
Validation loss decreased (-0.414008 --> -0.523095).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6746050
	speed: 0.1558s/iter; left time: 2336.3027s
Epoch: 3 cost time: 8.466963052749634
Epoch: 3, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.002 Vali Acc: 0.511 Test Loss: 2.002 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9172910
	speed: 0.1575s/iter; left time: 2337.1471s
Epoch: 4 cost time: 9.446945190429688
Epoch: 4, Steps: 154 | Train Loss: 1.311 Vali Loss: 1.866 Vali Acc: 0.480 Test Loss: 1.866 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2596135
	speed: 0.1620s/iter; left time: 2379.5015s
Epoch: 5 cost time: 9.542266368865967
Epoch: 5, Steps: 154 | Train Loss: 1.194 Vali Loss: 2.174 Vali Acc: 0.464 Test Loss: 2.174 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5347246
	speed: 0.1361s/iter; left time: 1978.0236s
Epoch: 6 cost time: 6.0796520709991455
Epoch: 6, Steps: 154 | Train Loss: 1.159 Vali Loss: 2.246 Vali Acc: 0.513 Test Loss: 2.246 Test Acc: 0.513
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9308925
	speed: 0.1293s/iter; left time: 1859.3807s
Epoch: 7 cost time: 6.796693801879883
Epoch: 7, Steps: 154 | Train Loss: 1.156 Vali Loss: 2.320 Vali Acc: 0.487 Test Loss: 2.320 Test Acc: 0.487
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.0125204
	speed: 0.1277s/iter; left time: 1815.7053s
Epoch: 8 cost time: 6.527359962463379
Epoch: 8, Steps: 154 | Train Loss: 1.026 Vali Loss: 2.869 Vali Acc: 0.498 Test Loss: 2.869 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.7116335
	speed: 0.1149s/iter; left time: 1616.2285s
Epoch: 9 cost time: 5.00346040725708
Epoch: 9, Steps: 154 | Train Loss: 0.961 Vali Loss: 2.685 Vali Acc: 0.521 Test Loss: 2.685 Test Acc: 0.521
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.5940299
	speed: 0.1151s/iter; left time: 1601.3683s
Epoch: 10 cost time: 4.98186469078064
Epoch: 10, Steps: 154 | Train Loss: 0.881 Vali Loss: 2.972 Vali Acc: 0.481 Test Loss: 2.972 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.0022545
	speed: 0.1189s/iter; left time: 1636.6370s
Epoch: 11 cost time: 5.951440334320068
Epoch: 11, Steps: 154 | Train Loss: 0.856 Vali Loss: 3.031 Vali Acc: 0.498 Test Loss: 3.031 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.2802690
	speed: 0.1267s/iter; left time: 1724.3410s
Epoch: 12 cost time: 5.976359605789185
Epoch: 12, Steps: 154 | Train Loss: 0.773 Vali Loss: 3.615 Vali Acc: 0.428 Test Loss: 3.615 Test Acc: 0.428
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5231143552311436
model parameter : 393358
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9697084
	speed: 0.0745s/iter; left time: 1139.1909s
Epoch: 1 cost time: 10.684987783432007
Epoch: 1, Steps: 154 | Train Loss: 1.965 Vali Loss: 1.828 Vali Acc: 0.487 Test Loss: 1.828 Test Acc: 0.487
Validation loss decreased (inf --> -0.487005).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2598398
	speed: 0.1568s/iter; left time: 2375.5396s
Epoch: 2 cost time: 9.012439727783203
Epoch: 2, Steps: 154 | Train Loss: 1.501 Vali Loss: 1.938 Vali Acc: 0.523 Test Loss: 1.938 Test Acc: 0.523
Validation loss decreased (-0.487005 --> -0.523095).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7951839
	speed: 0.1557s/iter; left time: 2333.8319s
Epoch: 3 cost time: 9.146906852722168
Epoch: 3, Steps: 154 | Train Loss: 1.368 Vali Loss: 1.945 Vali Acc: 0.474 Test Loss: 1.945 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6398580
	speed: 0.1609s/iter; left time: 2387.0436s
Epoch: 4 cost time: 9.082852363586426
Epoch: 4, Steps: 154 | Train Loss: 1.255 Vali Loss: 2.032 Vali Acc: 0.506 Test Loss: 2.032 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2069607
	speed: 0.1565s/iter; left time: 2298.8061s
Epoch: 5 cost time: 8.971552848815918
Epoch: 5, Steps: 154 | Train Loss: 1.155 Vali Loss: 2.416 Vali Acc: 0.408 Test Loss: 2.416 Test Acc: 0.408
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5679914
	speed: 0.1598s/iter; left time: 2322.5509s
Epoch: 6 cost time: 9.322442054748535
Epoch: 6, Steps: 154 | Train Loss: 1.140 Vali Loss: 2.474 Vali Acc: 0.487 Test Loss: 2.474 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 3.1999145
	speed: 0.1548s/iter; left time: 2225.5993s
Epoch: 7 cost time: 8.661192417144775
Epoch: 7, Steps: 154 | Train Loss: 1.044 Vali Loss: 3.202 Vali Acc: 0.400 Test Loss: 3.202 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.4404516
	speed: 0.1568s/iter; left time: 2230.4139s
Epoch: 8 cost time: 9.587193250656128
Epoch: 8, Steps: 154 | Train Loss: 0.974 Vali Loss: 3.782 Vali Acc: 0.415 Test Loss: 3.782 Test Acc: 0.415
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.2264162
	speed: 0.1640s/iter; left time: 2307.6724s
Epoch: 9 cost time: 9.52859878540039
Epoch: 9, Steps: 154 | Train Loss: 0.908 Vali Loss: 3.054 Vali Acc: 0.526 Test Loss: 3.054 Test Acc: 0.526
Validation loss decreased (-0.523095 --> -0.525517).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4078375
	speed: 0.1538s/iter; left time: 2140.2594s
Epoch: 10 cost time: 7.420368671417236
Epoch: 10, Steps: 154 | Train Loss: 0.789 Vali Loss: 2.946 Vali Acc: 0.507 Test Loss: 2.946 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7643985
	speed: 0.1237s/iter; left time: 1701.6630s
Epoch: 11 cost time: 6.0988242626190186
Epoch: 11, Steps: 154 | Train Loss: 0.725 Vali Loss: 2.964 Vali Acc: 0.483 Test Loss: 2.964 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.5817057
	speed: 0.1278s/iter; left time: 1739.5175s
Epoch: 12 cost time: 6.622154235839844
Epoch: 12, Steps: 154 | Train Loss: 0.684 Vali Loss: 3.046 Vali Acc: 0.447 Test Loss: 3.046 Test Acc: 0.447
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2553256
	speed: 0.1284s/iter; left time: 1727.3730s
Epoch: 13 cost time: 5.9177329540252686
Epoch: 13, Steps: 154 | Train Loss: 0.625 Vali Loss: 3.536 Vali Acc: 0.470 Test Loss: 3.536 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.6532976
	speed: 0.1294s/iter; left time: 1721.2381s
Epoch: 14 cost time: 6.673254728317261
Epoch: 14, Steps: 154 | Train Loss: 0.542 Vali Loss: 3.544 Vali Acc: 0.519 Test Loss: 3.544 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8516706
	speed: 0.1307s/iter; left time: 1718.5146s
Epoch: 15 cost time: 5.7587199211120605
Epoch: 15, Steps: 154 | Train Loss: 0.586 Vali Loss: 3.623 Vali Acc: 0.499 Test Loss: 3.623 Test Acc: 0.499
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.5839072
	speed: 0.1183s/iter; left time: 1537.4637s
Epoch: 16 cost time: 5.437673568725586
Epoch: 16, Steps: 154 | Train Loss: 0.544 Vali Loss: 3.316 Vali Acc: 0.542 Test Loss: 3.316 Test Acc: 0.542
Validation loss decreased (-0.525517 --> -0.541735).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4752664
	speed: 0.1403s/iter; left time: 1801.1643s
Epoch: 17 cost time: 8.920911073684692
Epoch: 17, Steps: 154 | Train Loss: 0.506 Vali Loss: 3.310 Vali Acc: 0.540 Test Loss: 3.310 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.2583325
	speed: 0.1614s/iter; left time: 2046.6938s
Epoch: 18 cost time: 9.193355560302734
Epoch: 18, Steps: 154 | Train Loss: 0.524 Vali Loss: 3.643 Vali Acc: 0.463 Test Loss: 3.643 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1574736
	speed: 0.1619s/iter; left time: 2029.0680s
Epoch: 19 cost time: 9.157073736190796
Epoch: 19, Steps: 154 | Train Loss: 0.468 Vali Loss: 3.670 Vali Acc: 0.452 Test Loss: 3.670 Test Acc: 0.452
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0858328
	speed: 0.1635s/iter; left time: 2023.3858s
Epoch: 20 cost time: 9.55594778060913
Epoch: 20, Steps: 154 | Train Loss: 0.456 Vali Loss: 3.947 Vali Acc: 0.450 Test Loss: 3.947 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1594277
	speed: 0.1642s/iter; left time: 2006.5004s
Epoch: 21 cost time: 9.434811115264893
Epoch: 21, Steps: 154 | Train Loss: 0.396 Vali Loss: 3.681 Vali Acc: 0.495 Test Loss: 3.681 Test Acc: 0.495
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.3014193
	speed: 0.1655s/iter; left time: 1996.9049s
Epoch: 22 cost time: 9.406478881835938
Epoch: 22, Steps: 154 | Train Loss: 0.405 Vali Loss: 4.457 Vali Acc: 0.420 Test Loss: 4.457 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.2205230
	speed: 0.1630s/iter; left time: 1941.3408s
Epoch: 23 cost time: 9.483339786529541
Epoch: 23, Steps: 154 | Train Loss: 0.388 Vali Loss: 3.863 Vali Acc: 0.431 Test Loss: 3.863 Test Acc: 0.431
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.3769507
	speed: 0.1658s/iter; left time: 1949.8799s
Epoch: 24 cost time: 9.516514301300049
Epoch: 24, Steps: 154 | Train Loss: 0.361 Vali Loss: 4.330 Vali Acc: 0.479 Test Loss: 4.330 Test Acc: 0.479
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.0120075
	speed: 0.1629s/iter; left time: 1890.8415s
Epoch: 25 cost time: 9.383486270904541
Epoch: 25, Steps: 154 | Train Loss: 0.336 Vali Loss: 4.290 Vali Acc: 0.515 Test Loss: 4.290 Test Acc: 0.515
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2383667
	speed: 0.1629s/iter; left time: 1865.3815s
Epoch: 26 cost time: 9.431782960891724
Epoch: 26, Steps: 154 | Train Loss: 0.337 Vali Loss: 4.505 Vali Acc: 0.505 Test Loss: 4.505 Test Acc: 0.505
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5417680454176804
model parameter : 393486
model size : 3.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4674287
	speed: 0.0477s/iter; left time: 729.2627s
Epoch: 1 cost time: 6.308594226837158
Epoch: 1, Steps: 154 | Train Loss: 1.955 Vali Loss: 1.882 Vali Acc: 0.448 Test Loss: 1.882 Test Acc: 0.448
Validation loss decreased (inf --> -0.448481).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4071892
	speed: 0.1187s/iter; left time: 1798.6096s
Epoch: 2 cost time: 6.079559803009033
Epoch: 2, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.135 Vali Acc: 0.418 Test Loss: 2.135 Test Acc: 0.418
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4974414
	speed: 0.1215s/iter; left time: 1821.1023s
Epoch: 3 cost time: 6.133289337158203
Epoch: 3, Steps: 154 | Train Loss: 1.303 Vali Loss: 2.028 Vali Acc: 0.505 Test Loss: 2.028 Test Acc: 0.505
Validation loss decreased (-0.448481 --> -0.505251).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7024342
	speed: 0.1243s/iter; left time: 1844.9947s
Epoch: 4 cost time: 6.027075529098511
Epoch: 4, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.151 Vali Acc: 0.480 Test Loss: 2.151 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4790306
	speed: 0.1178s/iter; left time: 1729.1943s
Epoch: 5 cost time: 5.594413995742798
Epoch: 5, Steps: 154 | Train Loss: 1.147 Vali Loss: 2.318 Vali Acc: 0.479 Test Loss: 2.318 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0150267
	speed: 0.1236s/iter; left time: 1795.8055s
Epoch: 6 cost time: 6.266679286956787
Epoch: 6, Steps: 154 | Train Loss: 1.032 Vali Loss: 2.442 Vali Acc: 0.515 Test Loss: 2.442 Test Acc: 0.515
Validation loss decreased (-0.505251 --> -0.514980).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8252549
	speed: 0.1399s/iter; left time: 2012.0561s
Epoch: 7 cost time: 8.929866075515747
Epoch: 7, Steps: 154 | Train Loss: 0.959 Vali Loss: 2.449 Vali Acc: 0.506 Test Loss: 2.449 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0272548
	speed: 0.1626s/iter; left time: 2313.0763s
Epoch: 8 cost time: 9.400807857513428
Epoch: 8, Steps: 154 | Train Loss: 0.896 Vali Loss: 2.521 Vali Acc: 0.478 Test Loss: 2.521 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6112998
	speed: 0.1585s/iter; left time: 2229.2692s
Epoch: 9 cost time: 9.451306581497192
Epoch: 9, Steps: 154 | Train Loss: 0.830 Vali Loss: 2.412 Vali Acc: 0.491 Test Loss: 2.412 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3319911
	speed: 0.1596s/iter; left time: 2220.2617s
Epoch: 10 cost time: 9.462186574935913
Epoch: 10, Steps: 154 | Train Loss: 0.783 Vali Loss: 2.739 Vali Acc: 0.481 Test Loss: 2.739 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1214159
	speed: 0.1536s/iter; left time: 2114.0172s
Epoch: 11 cost time: 9.075964212417603
Epoch: 11, Steps: 154 | Train Loss: 0.683 Vali Loss: 2.583 Vali Acc: 0.476 Test Loss: 2.583 Test Acc: 0.476
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.4063583
	speed: 0.1568s/iter; left time: 2132.9289s
Epoch: 12 cost time: 9.056691408157349
Epoch: 12, Steps: 154 | Train Loss: 0.605 Vali Loss: 2.610 Vali Acc: 0.540 Test Loss: 2.610 Test Acc: 0.540
Validation loss decreased (-0.514980 --> -0.539714).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3296806
	speed: 0.1596s/iter; left time: 2146.5164s
Epoch: 13 cost time: 9.180108785629272
Epoch: 13, Steps: 154 | Train Loss: 0.653 Vali Loss: 2.668 Vali Acc: 0.494 Test Loss: 2.668 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2898338
	speed: 0.1534s/iter; left time: 2040.6212s
Epoch: 14 cost time: 8.412887334823608
Epoch: 14, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.982 Vali Acc: 0.489 Test Loss: 2.982 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5755035
	speed: 0.1481s/iter; left time: 1947.1857s
Epoch: 15 cost time: 8.153676509857178
Epoch: 15, Steps: 154 | Train Loss: 0.497 Vali Loss: 2.939 Vali Acc: 0.506 Test Loss: 2.939 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3202048
	speed: 0.1466s/iter; left time: 1904.7191s
Epoch: 16 cost time: 8.736366987228394
Epoch: 16, Steps: 154 | Train Loss: 0.522 Vali Loss: 3.247 Vali Acc: 0.433 Test Loss: 3.247 Test Acc: 0.433
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5914983
	speed: 0.1481s/iter; left time: 1901.6438s
Epoch: 17 cost time: 6.026165246963501
Epoch: 17, Steps: 154 | Train Loss: 0.468 Vali Loss: 3.139 Vali Acc: 0.499 Test Loss: 3.139 Test Acc: 0.499
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.5615752
	speed: 0.1293s/iter; left time: 1640.5001s
Epoch: 18 cost time: 6.89328145980835
Epoch: 18, Steps: 154 | Train Loss: 0.432 Vali Loss: 2.998 Vali Acc: 0.521 Test Loss: 2.998 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.6413733
	speed: 0.1280s/iter; left time: 1603.3479s
Epoch: 19 cost time: 6.216200351715088
Epoch: 19, Steps: 154 | Train Loss: 0.391 Vali Loss: 3.057 Vali Acc: 0.481 Test Loss: 3.057 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.3334317
	speed: 0.1224s/iter; left time: 1514.5085s
Epoch: 20 cost time: 5.455754041671753
Epoch: 20, Steps: 154 | Train Loss: 0.384 Vali Loss: 3.330 Vali Acc: 0.528 Test Loss: 3.330 Test Acc: 0.528
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2993257
	speed: 0.1293s/iter; left time: 1580.5383s
Epoch: 21 cost time: 6.6974945068359375
Epoch: 21, Steps: 154 | Train Loss: 0.384 Vali Loss: 3.645 Vali Acc: 0.528 Test Loss: 3.645 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6168858
	speed: 0.1341s/iter; left time: 1618.3793s
Epoch: 22 cost time: 7.528105735778809
Epoch: 22, Steps: 154 | Train Loss: 0.347 Vali Loss: 3.365 Vali Acc: 0.491 Test Loss: 3.365 Test Acc: 0.491
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5397404703974047
model parameter : 329230
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4489597
	speed: 0.0478s/iter; left time: 730.9573s
Epoch: 1 cost time: 6.456515789031982
Epoch: 1, Steps: 154 | Train Loss: 1.997 Vali Loss: 1.749 Vali Acc: 0.411 Test Loss: 1.749 Test Acc: 0.411
Validation loss decreased (inf --> -0.410769).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1765341
	speed: 0.1195s/iter; left time: 1809.6527s
Epoch: 2 cost time: 5.092717409133911
Epoch: 2, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.189 Vali Acc: 0.463 Test Loss: 2.189 Test Acc: 0.463
Validation loss decreased (-0.410769 --> -0.462671).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0535412
	speed: 0.1194s/iter; left time: 1789.4449s
Epoch: 3 cost time: 5.026233673095703
Epoch: 3, Steps: 154 | Train Loss: 1.264 Vali Loss: 1.717 Vali Acc: 0.519 Test Loss: 1.717 Test Acc: 0.519
Validation loss decreased (-0.462671 --> -0.519448).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3218335
	speed: 0.1187s/iter; left time: 1761.7080s
Epoch: 4 cost time: 5.153726577758789
Epoch: 4, Steps: 154 | Train Loss: 1.174 Vali Loss: 2.058 Vali Acc: 0.494 Test Loss: 2.058 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0180305
	speed: 0.1170s/iter; left time: 1718.5465s
Epoch: 5 cost time: 4.966753244400024
Epoch: 5, Steps: 154 | Train Loss: 1.124 Vali Loss: 2.370 Vali Acc: 0.500 Test Loss: 2.370 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2337524
	speed: 0.1246s/iter; left time: 1810.8517s
Epoch: 6 cost time: 5.252389192581177
Epoch: 6, Steps: 154 | Train Loss: 1.037 Vali Loss: 2.745 Vali Acc: 0.479 Test Loss: 2.745 Test Acc: 0.479
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3538430
	speed: 0.1236s/iter; left time: 1777.4323s
Epoch: 7 cost time: 5.143205881118774
Epoch: 7, Steps: 154 | Train Loss: 0.979 Vali Loss: 2.449 Vali Acc: 0.444 Test Loss: 2.449 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.2241355
	speed: 0.1215s/iter; left time: 1727.6354s
Epoch: 8 cost time: 5.208449125289917
Epoch: 8, Steps: 154 | Train Loss: 0.876 Vali Loss: 2.895 Vali Acc: 0.429 Test Loss: 2.895 Test Acc: 0.429
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.6388838
	speed: 0.1226s/iter; left time: 1725.1520s
Epoch: 9 cost time: 5.137508869171143
Epoch: 9, Steps: 154 | Train Loss: 0.811 Vali Loss: 2.244 Vali Acc: 0.490 Test Loss: 2.244 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.6751988
	speed: 0.1197s/iter; left time: 1665.1755s
Epoch: 10 cost time: 5.052769660949707
Epoch: 10, Steps: 154 | Train Loss: 0.760 Vali Loss: 2.891 Vali Acc: 0.451 Test Loss: 2.891 Test Acc: 0.451
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2735926
	speed: 0.1167s/iter; left time: 1606.5140s
Epoch: 11 cost time: 5.1384265422821045
Epoch: 11, Steps: 154 | Train Loss: 0.710 Vali Loss: 2.449 Vali Acc: 0.494 Test Loss: 2.449 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6138024
	speed: 0.1178s/iter; left time: 1602.6086s
Epoch: 12 cost time: 4.977176189422607
Epoch: 12, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.589 Vali Acc: 0.487 Test Loss: 2.589 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.4100346
	speed: 0.1186s/iter; left time: 1595.3349s
Epoch: 13 cost time: 5.237514019012451
Epoch: 13, Steps: 154 | Train Loss: 0.609 Vali Loss: 2.418 Vali Acc: 0.515 Test Loss: 2.418 Test Acc: 0.515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5194647201946472
model parameter : 297230
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0117292
	speed: 0.0390s/iter; left time: 596.8476s
Epoch: 1 cost time: 5.262914657592773
Epoch: 1, Steps: 154 | Train Loss: 2.103 Vali Loss: 1.797 Vali Acc: 0.424 Test Loss: 1.797 Test Acc: 0.424
Validation loss decreased (inf --> -0.423745).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9874603
	speed: 0.1052s/iter; left time: 1592.8810s
Epoch: 2 cost time: 4.1778013706207275
Epoch: 2, Steps: 154 | Train Loss: 1.418 Vali Loss: 1.872 Vali Acc: 0.459 Test Loss: 1.872 Test Acc: 0.459
Validation loss decreased (-0.423745 --> -0.458619).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2891532
	speed: 0.1055s/iter; left time: 1581.7127s
Epoch: 3 cost time: 4.113042593002319
Epoch: 3, Steps: 154 | Train Loss: 1.235 Vali Loss: 1.884 Vali Acc: 0.460 Test Loss: 1.884 Test Acc: 0.460
Validation loss decreased (-0.458619 --> -0.460241).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0657668
	speed: 0.1068s/iter; left time: 1585.3218s
Epoch: 4 cost time: 4.167997360229492
Epoch: 4, Steps: 154 | Train Loss: 1.175 Vali Loss: 2.320 Vali Acc: 0.492 Test Loss: 2.320 Test Acc: 0.492
Validation loss decreased (-0.460241 --> -0.492272).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1077894
	speed: 0.1067s/iter; left time: 1566.7796s
Epoch: 5 cost time: 4.12056565284729
Epoch: 5, Steps: 154 | Train Loss: 1.088 Vali Loss: 1.965 Vali Acc: 0.510 Test Loss: 1.965 Test Acc: 0.510
Validation loss decreased (-0.492272 --> -0.509713).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2864802
	speed: 0.1000s/iter; left time: 1453.0242s
Epoch: 6 cost time: 3.892583131790161
Epoch: 6, Steps: 154 | Train Loss: 1.033 Vali Loss: 2.307 Vali Acc: 0.506 Test Loss: 2.307 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9176947
	speed: 0.1117s/iter; left time: 1606.3669s
Epoch: 7 cost time: 4.3684563636779785
Epoch: 7, Steps: 154 | Train Loss: 0.959 Vali Loss: 2.363 Vali Acc: 0.502 Test Loss: 2.363 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7509042
	speed: 0.1038s/iter; left time: 1476.5937s
Epoch: 8 cost time: 4.593069791793823
Epoch: 8, Steps: 154 | Train Loss: 0.893 Vali Loss: 2.114 Vali Acc: 0.543 Test Loss: 2.114 Test Acc: 0.543
Validation loss decreased (-0.509713 --> -0.543369).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3127452
	speed: 0.1139s/iter; left time: 1602.1728s
Epoch: 9 cost time: 4.7653820514678955
Epoch: 9, Steps: 154 | Train Loss: 0.841 Vali Loss: 2.276 Vali Acc: 0.494 Test Loss: 2.276 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6518786
	speed: 0.1236s/iter; left time: 1719.4191s
Epoch: 10 cost time: 5.8868231773376465
Epoch: 10, Steps: 154 | Train Loss: 0.716 Vali Loss: 2.761 Vali Acc: 0.405 Test Loss: 2.761 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.7673784
	speed: 0.1332s/iter; left time: 1833.5691s
Epoch: 11 cost time: 5.631304502487183
Epoch: 11, Steps: 154 | Train Loss: 0.686 Vali Loss: 2.666 Vali Acc: 0.479 Test Loss: 2.666 Test Acc: 0.479
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4928582
	speed: 0.1375s/iter; left time: 1870.7023s
Epoch: 12 cost time: 6.166671276092529
Epoch: 12, Steps: 154 | Train Loss: 0.618 Vali Loss: 2.376 Vali Acc: 0.544 Test Loss: 2.376 Test Acc: 0.544
Validation loss decreased (-0.543369 --> -0.543772).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9080493
	speed: 0.1348s/iter; left time: 1813.9427s
Epoch: 13 cost time: 6.0313146114349365
Epoch: 13, Steps: 154 | Train Loss: 0.578 Vali Loss: 2.589 Vali Acc: 0.469 Test Loss: 2.589 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5856274
	speed: 0.1375s/iter; left time: 1828.1563s
Epoch: 14 cost time: 5.749717950820923
Epoch: 14, Steps: 154 | Train Loss: 0.539 Vali Loss: 2.675 Vali Acc: 0.511 Test Loss: 2.675 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1616896
	speed: 0.1370s/iter; left time: 1801.2221s
Epoch: 15 cost time: 6.269711017608643
Epoch: 15, Steps: 154 | Train Loss: 0.492 Vali Loss: 2.546 Vali Acc: 0.539 Test Loss: 2.546 Test Acc: 0.539
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3393061
	speed: 0.1382s/iter; left time: 1794.7382s
Epoch: 16 cost time: 5.977176189422607
Epoch: 16, Steps: 154 | Train Loss: 0.481 Vali Loss: 2.657 Vali Acc: 0.534 Test Loss: 2.657 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4916297
	speed: 0.1397s/iter; left time: 1792.8433s
Epoch: 17 cost time: 5.802203893661499
Epoch: 17, Steps: 154 | Train Loss: 0.453 Vali Loss: 2.688 Vali Acc: 0.529 Test Loss: 2.688 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3627442
	speed: 0.1345s/iter; left time: 1706.0605s
Epoch: 18 cost time: 5.966553688049316
Epoch: 18, Steps: 154 | Train Loss: 0.420 Vali Loss: 3.032 Vali Acc: 0.505 Test Loss: 3.032 Test Acc: 0.505
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3394302
	speed: 0.1344s/iter; left time: 1684.3369s
Epoch: 19 cost time: 5.381084203720093
Epoch: 19, Steps: 154 | Train Loss: 0.420 Vali Loss: 3.097 Vali Acc: 0.461 Test Loss: 3.097 Test Acc: 0.461
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2732895
	speed: 0.1344s/iter; left time: 1663.6356s
Epoch: 20 cost time: 6.112856864929199
Epoch: 20, Steps: 154 | Train Loss: 0.342 Vali Loss: 3.056 Vali Acc: 0.551 Test Loss: 3.056 Test Acc: 0.551
Validation loss decreased (-0.543772 --> -0.551064).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.6288236
	speed: 0.1348s/iter; left time: 1647.4317s
Epoch: 21 cost time: 5.414657354354858
Epoch: 21, Steps: 154 | Train Loss: 0.369 Vali Loss: 2.999 Vali Acc: 0.530 Test Loss: 2.999 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5628175
	speed: 0.1385s/iter; left time: 1670.7622s
Epoch: 22 cost time: 6.042381525039673
Epoch: 22, Steps: 154 | Train Loss: 0.335 Vali Loss: 2.993 Vali Acc: 0.508 Test Loss: 2.993 Test Acc: 0.508
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2911625
	speed: 0.1193s/iter; left time: 1421.3772s
Epoch: 23 cost time: 4.945117712020874
Epoch: 23, Steps: 154 | Train Loss: 0.372 Vali Loss: 2.866 Vali Acc: 0.526 Test Loss: 2.866 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1495787
	speed: 0.1184s/iter; left time: 1392.5674s
Epoch: 24 cost time: 4.206394672393799
Epoch: 24, Steps: 154 | Train Loss: 0.314 Vali Loss: 3.322 Vali Acc: 0.500 Test Loss: 3.322 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1772002
	speed: 0.1234s/iter; left time: 1431.5610s
Epoch: 25 cost time: 5.398457765579224
Epoch: 25, Steps: 154 | Train Loss: 0.346 Vali Loss: 3.264 Vali Acc: 0.529 Test Loss: 3.264 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.3569259
	speed: 0.1190s/iter; left time: 1363.2005s
Epoch: 26 cost time: 4.597141742706299
Epoch: 26, Steps: 154 | Train Loss: 0.299 Vali Loss: 3.508 Vali Acc: 0.538 Test Loss: 3.508 Test Acc: 0.538
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.4728529
	speed: 0.1181s/iter; left time: 1334.0784s
Epoch: 27 cost time: 4.458956956863403
Epoch: 27, Steps: 154 | Train Loss: 0.306 Vali Loss: 3.556 Vali Acc: 0.457 Test Loss: 3.556 Test Acc: 0.457
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0842878
	speed: 0.1213s/iter; left time: 1351.8209s
Epoch: 28 cost time: 5.453827381134033
Epoch: 28, Steps: 154 | Train Loss: 0.286 Vali Loss: 3.801 Vali Acc: 0.524 Test Loss: 3.801 Test Acc: 0.524
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.7013262
	speed: 0.1186s/iter; left time: 1302.7985s
Epoch: 29 cost time: 4.454077243804932
Epoch: 29, Steps: 154 | Train Loss: 0.357 Vali Loss: 3.385 Vali Acc: 0.535 Test Loss: 3.385 Test Acc: 0.535
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.4101712
	speed: 0.1228s/iter; left time: 1330.1864s
Epoch: 30 cost time: 4.696686744689941
Epoch: 30, Steps: 154 | Train Loss: 0.321 Vali Loss: 3.416 Vali Acc: 0.542 Test Loss: 3.416 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.551094890510949
model parameter : 275854
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8499171
	speed: 0.0889s/iter; left time: 1360.7145s
Epoch: 1 cost time: 13.25855565071106
Epoch: 1, Steps: 154 | Train Loss: 2.061 Vali Loss: 2.306 Vali Acc: 0.442 Test Loss: 2.306 Test Acc: 0.442
Validation loss decreased (inf --> -0.441988).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0173185
	speed: 0.2079s/iter; left time: 3149.2947s
Epoch: 2 cost time: 11.430329322814941
Epoch: 2, Steps: 154 | Train Loss: 1.785 Vali Loss: 1.825 Vali Acc: 0.486 Test Loss: 1.825 Test Acc: 0.486
Validation loss decreased (-0.441988 --> -0.485789).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4125187
	speed: 0.2128s/iter; left time: 3190.5593s
Epoch: 3 cost time: 12.156662940979004
Epoch: 3, Steps: 154 | Train Loss: 1.394 Vali Loss: 1.974 Vali Acc: 0.484 Test Loss: 1.974 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6080225
	speed: 0.2182s/iter; left time: 3238.0728s
Epoch: 4 cost time: 12.107132196426392
Epoch: 4, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.093 Vali Acc: 0.502 Test Loss: 2.093 Test Acc: 0.502
Validation loss decreased (-0.485789 --> -0.501601).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8515800
	speed: 0.2166s/iter; left time: 3180.4715s
Epoch: 5 cost time: 11.950847625732422
Epoch: 5, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.674 Vali Acc: 0.431 Test Loss: 2.674 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.5036809
	speed: 0.2216s/iter; left time: 3220.0901s
Epoch: 6 cost time: 12.046078443527222
Epoch: 6, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.350 Vali Acc: 0.468 Test Loss: 3.350 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.1191523
	speed: 0.2209s/iter; left time: 3176.2934s
Epoch: 7 cost time: 12.894028902053833
Epoch: 7, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.904 Vali Acc: 0.440 Test Loss: 2.904 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2053845
	speed: 0.2204s/iter; left time: 3135.0652s
Epoch: 8 cost time: 13.437007427215576
Epoch: 8, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.995 Vali Acc: 0.472 Test Loss: 2.995 Test Acc: 0.472
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.6866956
	speed: 0.2212s/iter; left time: 3111.9601s
Epoch: 9 cost time: 13.64865756034851
Epoch: 9, Steps: 154 | Train Loss: 1.323 Vali Loss: 3.621 Vali Acc: 0.443 Test Loss: 3.621 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7251724
	speed: 0.2241s/iter; left time: 3118.5121s
Epoch: 10 cost time: 13.579506158828735
Epoch: 10, Steps: 154 | Train Loss: 1.236 Vali Loss: 3.886 Vali Acc: 0.446 Test Loss: 3.886 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.7004694
	speed: 0.1773s/iter; left time: 2439.5800s
Epoch: 11 cost time: 9.347659349441528
Epoch: 11, Steps: 154 | Train Loss: 1.117 Vali Loss: 4.135 Vali Acc: 0.387 Test Loss: 4.135 Test Acc: 0.387
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3001691
	speed: 0.1777s/iter; left time: 2418.0117s
Epoch: 12 cost time: 8.637945652008057
Epoch: 12, Steps: 154 | Train Loss: 1.035 Vali Loss: 5.540 Vali Acc: 0.410 Test Loss: 5.540 Test Acc: 0.410
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.8795201
	speed: 0.1717s/iter; left time: 2310.5460s
Epoch: 13 cost time: 8.396159410476685
Epoch: 13, Steps: 154 | Train Loss: 1.012 Vali Loss: 5.466 Vali Acc: 0.449 Test Loss: 5.466 Test Acc: 0.449
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.9706004
	speed: 0.1682s/iter; left time: 2237.2281s
Epoch: 14 cost time: 7.953770637512207
Epoch: 14, Steps: 154 | Train Loss: 0.902 Vali Loss: 5.001 Vali Acc: 0.468 Test Loss: 5.001 Test Acc: 0.468
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5016220600162206
model parameter : 553870
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7685524
	speed: 0.0677s/iter; left time: 1035.1534s
Epoch: 1 cost time: 8.563660383224487
Epoch: 1, Steps: 154 | Train Loss: 1.962 Vali Loss: 1.969 Vali Acc: 0.401 Test Loss: 1.969 Test Acc: 0.401
Validation loss decreased (inf --> -0.400629).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8445244
	speed: 0.1483s/iter; left time: 2245.6908s
Epoch: 2 cost time: 8.80249285697937
Epoch: 2, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.167 Vali Acc: 0.478 Test Loss: 2.167 Test Acc: 0.478
Validation loss decreased (-0.400629 --> -0.478081).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4422034
	speed: 0.1784s/iter; left time: 2674.4399s
Epoch: 3 cost time: 10.793437004089355
Epoch: 3, Steps: 154 | Train Loss: 1.345 Vali Loss: 1.867 Vali Acc: 0.469 Test Loss: 1.867 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9763549
	speed: 0.1592s/iter; left time: 2362.3067s
Epoch: 4 cost time: 8.01466703414917
Epoch: 4, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.560 Vali Acc: 0.526 Test Loss: 2.560 Test Acc: 0.526
Validation loss decreased (-0.478081 --> -0.525522).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1873814
	speed: 0.1561s/iter; left time: 2292.1901s
Epoch: 5 cost time: 9.253430366516113
Epoch: 5, Steps: 154 | Train Loss: 1.218 Vali Loss: 2.330 Vali Acc: 0.434 Test Loss: 2.330 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1722071
	speed: 0.1700s/iter; left time: 2470.2574s
Epoch: 6 cost time: 9.699877262115479
Epoch: 6, Steps: 154 | Train Loss: 1.150 Vali Loss: 2.789 Vali Acc: 0.521 Test Loss: 2.789 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9037973
	speed: 0.1723s/iter; left time: 2477.0711s
Epoch: 7 cost time: 10.524815797805786
Epoch: 7, Steps: 154 | Train Loss: 1.114 Vali Loss: 2.344 Vali Acc: 0.519 Test Loss: 2.344 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.2291993
	speed: 0.1763s/iter; left time: 2506.8414s
Epoch: 8 cost time: 10.433208465576172
Epoch: 8, Steps: 154 | Train Loss: 1.061 Vali Loss: 2.935 Vali Acc: 0.467 Test Loss: 2.935 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5385675
	speed: 0.1732s/iter; left time: 2436.5198s
Epoch: 9 cost time: 10.054715394973755
Epoch: 9, Steps: 154 | Train Loss: 0.967 Vali Loss: 2.643 Vali Acc: 0.483 Test Loss: 2.643 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7074360
	speed: 0.1750s/iter; left time: 2435.4744s
Epoch: 10 cost time: 10.13210415840149
Epoch: 10, Steps: 154 | Train Loss: 0.924 Vali Loss: 3.189 Vali Acc: 0.444 Test Loss: 3.189 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6672205
	speed: 0.1743s/iter; left time: 2398.3682s
Epoch: 11 cost time: 10.47828197479248
Epoch: 11, Steps: 154 | Train Loss: 0.819 Vali Loss: 3.257 Vali Acc: 0.435 Test Loss: 3.257 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.1346992
	speed: 0.1672s/iter; left time: 2275.3164s
Epoch: 12 cost time: 9.984763622283936
Epoch: 12, Steps: 154 | Train Loss: 0.721 Vali Loss: 3.338 Vali Acc: 0.534 Test Loss: 3.338 Test Acc: 0.534
Validation loss decreased (-0.525522 --> -0.534435).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0975517
	speed: 0.1642s/iter; left time: 2209.5693s
Epoch: 13 cost time: 7.625624418258667
Epoch: 13, Steps: 154 | Train Loss: 0.703 Vali Loss: 3.219 Vali Acc: 0.480 Test Loss: 3.219 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1460454
	speed: 0.1339s/iter; left time: 1781.1857s
Epoch: 14 cost time: 7.272501230239868
Epoch: 14, Steps: 154 | Train Loss: 0.614 Vali Loss: 3.557 Vali Acc: 0.464 Test Loss: 3.557 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.8984856
	speed: 0.1367s/iter; left time: 1797.5335s
Epoch: 15 cost time: 7.768504858016968
Epoch: 15, Steps: 154 | Train Loss: 0.583 Vali Loss: 3.557 Vali Acc: 0.432 Test Loss: 3.557 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6127955
	speed: 0.1385s/iter; left time: 1799.0048s
Epoch: 16 cost time: 7.1603991985321045
Epoch: 16, Steps: 154 | Train Loss: 0.538 Vali Loss: 3.240 Vali Acc: 0.485 Test Loss: 3.240 Test Acc: 0.485
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2962961
	speed: 0.1169s/iter; left time: 1500.9369s
Epoch: 17 cost time: 5.040484189987183
Epoch: 17, Steps: 154 | Train Loss: 0.507 Vali Loss: 3.635 Vali Acc: 0.490 Test Loss: 3.635 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4554151
	speed: 0.1237s/iter; left time: 1569.0224s
Epoch: 18 cost time: 5.888880252838135
Epoch: 18, Steps: 154 | Train Loss: 0.524 Vali Loss: 3.327 Vali Acc: 0.490 Test Loss: 3.327 Test Acc: 0.490
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0849682
	speed: 0.1284s/iter; left time: 1608.2670s
Epoch: 19 cost time: 6.838979721069336
Epoch: 19, Steps: 154 | Train Loss: 0.451 Vali Loss: 3.765 Vali Acc: 0.472 Test Loss: 3.765 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1411328
	speed: 0.1364s/iter; left time: 1688.3572s
Epoch: 20 cost time: 8.09306788444519
Epoch: 20, Steps: 154 | Train Loss: 0.423 Vali Loss: 3.518 Vali Acc: 0.466 Test Loss: 3.518 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.5633759
	speed: 0.1701s/iter; left time: 2078.4657s
Epoch: 21 cost time: 10.068629503250122
Epoch: 21, Steps: 154 | Train Loss: 0.427 Vali Loss: 4.271 Vali Acc: 0.484 Test Loss: 4.271 Test Acc: 0.484
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.2602935
	speed: 0.1740s/iter; left time: 2099.1782s
Epoch: 22 cost time: 10.623665571212769
Epoch: 22, Steps: 154 | Train Loss: 0.424 Vali Loss: 4.084 Vali Acc: 0.502 Test Loss: 4.084 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5344687753446877
model parameter : 360462
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9070722
	speed: 0.0747s/iter; left time: 1143.5760s
Epoch: 1 cost time: 10.896825551986694
Epoch: 1, Steps: 154 | Train Loss: 1.906 Vali Loss: 1.887 Vali Acc: 0.450 Test Loss: 1.887 Test Acc: 0.450
Validation loss decreased (inf --> -0.450103).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3784753
	speed: 0.1704s/iter; left time: 2580.6573s
Epoch: 2 cost time: 9.910346269607544
Epoch: 2, Steps: 154 | Train Loss: 1.474 Vali Loss: 1.795 Vali Acc: 0.498 Test Loss: 1.795 Test Acc: 0.498
Validation loss decreased (-0.450103 --> -0.498360).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0090725
	speed: 0.1703s/iter; left time: 2552.9430s
Epoch: 3 cost time: 10.287210941314697
Epoch: 3, Steps: 154 | Train Loss: 1.366 Vali Loss: 1.905 Vali Acc: 0.520 Test Loss: 1.905 Test Acc: 0.520
Validation loss decreased (-0.498360 --> -0.520257).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6188579
	speed: 0.1721s/iter; left time: 2554.3147s
Epoch: 4 cost time: 9.869410753250122
Epoch: 4, Steps: 154 | Train Loss: 1.301 Vali Loss: 1.866 Vali Acc: 0.448 Test Loss: 1.866 Test Acc: 0.448
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3558013
	speed: 0.1674s/iter; left time: 2458.8824s
Epoch: 5 cost time: 9.50246810913086
Epoch: 5, Steps: 154 | Train Loss: 1.214 Vali Loss: 2.190 Vali Acc: 0.492 Test Loss: 2.190 Test Acc: 0.492
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3487909
	speed: 0.1716s/iter; left time: 2493.2733s
Epoch: 6 cost time: 10.106858491897583
Epoch: 6, Steps: 154 | Train Loss: 1.153 Vali Loss: 2.487 Vali Acc: 0.449 Test Loss: 2.487 Test Acc: 0.449
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3908064
	speed: 0.1702s/iter; left time: 2447.2968s
Epoch: 7 cost time: 9.837938070297241
Epoch: 7, Steps: 154 | Train Loss: 1.123 Vali Loss: 2.507 Vali Acc: 0.494 Test Loss: 2.507 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8030009
	speed: 0.1383s/iter; left time: 1967.0769s
Epoch: 8 cost time: 5.02674674987793
Epoch: 8, Steps: 154 | Train Loss: 1.046 Vali Loss: 2.876 Vali Acc: 0.493 Test Loss: 2.876 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.9152495
	speed: 0.1360s/iter; left time: 1913.6994s
Epoch: 9 cost time: 7.261469125747681
Epoch: 9, Steps: 154 | Train Loss: 0.951 Vali Loss: 2.595 Vali Acc: 0.469 Test Loss: 2.595 Test Acc: 0.469
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1713642
	speed: 0.1402s/iter; left time: 1950.6352s
Epoch: 10 cost time: 8.226278066635132
Epoch: 10, Steps: 154 | Train Loss: 0.885 Vali Loss: 2.825 Vali Acc: 0.521 Test Loss: 2.825 Test Acc: 0.521
Validation loss decreased (-0.520257 --> -0.520653).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7309602
	speed: 0.1376s/iter; left time: 1893.1406s
Epoch: 11 cost time: 6.5237226486206055
Epoch: 11, Steps: 154 | Train Loss: 0.883 Vali Loss: 2.630 Vali Acc: 0.528 Test Loss: 2.630 Test Acc: 0.528
Validation loss decreased (-0.520653 --> -0.527954).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5086827
	speed: 0.1246s/iter; left time: 1695.0364s
Epoch: 12 cost time: 6.661027908325195
Epoch: 12, Steps: 154 | Train Loss: 0.756 Vali Loss: 2.857 Vali Acc: 0.527 Test Loss: 2.857 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.7341756
	speed: 0.1287s/iter; left time: 1731.3838s
Epoch: 13 cost time: 6.563676357269287
Epoch: 13, Steps: 154 | Train Loss: 0.708 Vali Loss: 3.341 Vali Acc: 0.462 Test Loss: 3.341 Test Acc: 0.462
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.4226306
	speed: 0.1261s/iter; left time: 1677.0761s
Epoch: 14 cost time: 5.561208963394165
Epoch: 14, Steps: 154 | Train Loss: 0.623 Vali Loss: 2.969 Vali Acc: 0.487 Test Loss: 2.969 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4816171
	speed: 0.1361s/iter; left time: 1789.3093s
Epoch: 15 cost time: 9.583009004592896
Epoch: 15, Steps: 154 | Train Loss: 0.590 Vali Loss: 3.179 Vali Acc: 0.453 Test Loss: 3.179 Test Acc: 0.453
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5335120
	speed: 0.1660s/iter; left time: 2156.7359s
Epoch: 16 cost time: 9.563438892364502
Epoch: 16, Steps: 154 | Train Loss: 0.549 Vali Loss: 3.445 Vali Acc: 0.489 Test Loss: 3.445 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5865237
	speed: 0.1653s/iter; left time: 2121.6625s
Epoch: 17 cost time: 9.825557231903076
Epoch: 17, Steps: 154 | Train Loss: 0.532 Vali Loss: 3.624 Vali Acc: 0.448 Test Loss: 3.624 Test Acc: 0.448
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.5662966
	speed: 0.1658s/iter; left time: 2102.9595s
Epoch: 18 cost time: 9.527580499649048
Epoch: 18, Steps: 154 | Train Loss: 0.520 Vali Loss: 3.422 Vali Acc: 0.474 Test Loss: 3.422 Test Acc: 0.474
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2667444
	speed: 0.1617s/iter; left time: 2026.2856s
Epoch: 19 cost time: 9.207918882369995
Epoch: 19, Steps: 154 | Train Loss: 0.496 Vali Loss: 3.708 Vali Acc: 0.521 Test Loss: 3.708 Test Acc: 0.521
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0080584
	speed: 0.1541s/iter; left time: 1906.4904s
Epoch: 20 cost time: 8.744582891464233
Epoch: 20, Steps: 154 | Train Loss: 0.415 Vali Loss: 3.664 Vali Acc: 0.535 Test Loss: 3.664 Test Acc: 0.535
Validation loss decreased (-0.527954 --> -0.534838).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3765732
	speed: 0.1595s/iter; left time: 1949.1240s
Epoch: 21 cost time: 8.931288957595825
Epoch: 21, Steps: 154 | Train Loss: 0.391 Vali Loss: 3.161 Vali Acc: 0.545 Test Loss: 3.161 Test Acc: 0.545
Validation loss decreased (-0.534838 --> -0.544575).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.6203904
	speed: 0.1618s/iter; left time: 1952.9527s
Epoch: 22 cost time: 9.473389387130737
Epoch: 22, Steps: 154 | Train Loss: 0.418 Vali Loss: 3.682 Vali Acc: 0.532 Test Loss: 3.682 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.7108753
	speed: 0.1649s/iter; left time: 1964.0441s
Epoch: 23 cost time: 9.627148866653442
Epoch: 23, Steps: 154 | Train Loss: 0.331 Vali Loss: 3.847 Vali Acc: 0.560 Test Loss: 3.847 Test Acc: 0.560
Validation loss decreased (-0.544575 --> -0.559978).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0390480
	speed: 0.1623s/iter; left time: 1908.6627s
Epoch: 24 cost time: 9.464633464813232
Epoch: 24, Steps: 154 | Train Loss: 0.387 Vali Loss: 3.855 Vali Acc: 0.534 Test Loss: 3.855 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.1220667
	speed: 0.1463s/iter; left time: 1698.0777s
Epoch: 25 cost time: 6.412053108215332
Epoch: 25, Steps: 154 | Train Loss: 0.351 Vali Loss: 3.680 Vali Acc: 0.510 Test Loss: 3.680 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.1309138
	speed: 0.1270s/iter; left time: 1453.7901s
Epoch: 26 cost time: 6.691130876541138
Epoch: 26, Steps: 154 | Train Loss: 0.319 Vali Loss: 3.533 Vali Acc: 0.538 Test Loss: 3.533 Test Acc: 0.538
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.3629917
	speed: 0.1197s/iter; left time: 1352.5707s
Epoch: 27 cost time: 5.171084642410278
Epoch: 27, Steps: 154 | Train Loss: 0.328 Vali Loss: 4.730 Vali Acc: 0.537 Test Loss: 4.730 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.3831338
	speed: 0.1271s/iter; left time: 1416.1409s
Epoch: 28 cost time: 6.608414173126221
Epoch: 28, Steps: 154 | Train Loss: 0.303 Vali Loss: 4.075 Vali Acc: 0.560 Test Loss: 4.075 Test Acc: 0.560
Validation loss decreased (-0.559978 --> -0.560381).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.2056650
	speed: 0.1279s/iter; left time: 1405.5526s
Epoch: 29 cost time: 7.1316611766815186
Epoch: 29, Steps: 154 | Train Loss: 0.329 Vali Loss: 4.430 Vali Acc: 0.509 Test Loss: 4.430 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.5871560
	speed: 0.1254s/iter; left time: 1358.4732s
Epoch: 30 cost time: 5.833391189575195
Epoch: 30, Steps: 154 | Train Loss: 0.291 Vali Loss: 4.619 Vali Acc: 0.516 Test Loss: 4.619 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.2226711
	speed: 0.1225s/iter; left time: 1308.4742s
Epoch: 31 cost time: 5.237714529037476
Epoch: 31, Steps: 154 | Train Loss: 0.301 Vali Loss: 4.015 Vali Acc: 0.527 Test Loss: 4.015 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0781794
	speed: 0.1124s/iter; left time: 1183.3777s
Epoch: 32 cost time: 7.264282703399658
Epoch: 32, Steps: 154 | Train Loss: 0.245 Vali Loss: 4.737 Vali Acc: 0.524 Test Loss: 4.737 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.1168487
	speed: 0.1457s/iter; left time: 1510.8727s
Epoch: 33 cost time: 8.050621032714844
Epoch: 33, Steps: 154 | Train Loss: 0.273 Vali Loss: 4.198 Vali Acc: 0.531 Test Loss: 4.198 Test Acc: 0.531
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.6752837
	speed: 0.1466s/iter; left time: 1497.8765s
Epoch: 34 cost time: 6.325489282608032
Epoch: 34, Steps: 154 | Train Loss: 0.278 Vali Loss: 4.473 Vali Acc: 0.482 Test Loss: 4.473 Test Acc: 0.482
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.2121871
	speed: 0.0732s/iter; left time: 736.4611s
Epoch: 35 cost time: 3.1436171531677246
Epoch: 35, Steps: 154 | Train Loss: 0.276 Vali Loss: 4.040 Vali Acc: 0.514 Test Loss: 4.040 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.1603731
	speed: 0.0590s/iter; left time: 584.9174s
Epoch: 36 cost time: 2.829636812210083
Epoch: 36, Steps: 154 | Train Loss: 0.254 Vali Loss: 4.366 Vali Acc: 0.526 Test Loss: 4.366 Test Acc: 0.526
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0272967
	speed: 0.0644s/iter; left time: 627.9900s
Epoch: 37 cost time: 2.853713274002075
Epoch: 37, Steps: 154 | Train Loss: 0.252 Vali Loss: 4.113 Vali Acc: 0.532 Test Loss: 4.113 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.4203213
	speed: 0.1223s/iter; left time: 1174.4558s
Epoch: 38 cost time: 7.981670618057251
Epoch: 38, Steps: 154 | Train Loss: 0.214 Vali Loss: 4.554 Vali Acc: 0.483 Test Loss: 4.554 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5604217356042174
model parameter : 360590
model size : 3.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7550695
	speed: 0.0657s/iter; left time: 1005.6614s
Epoch: 1 cost time: 9.27044939994812
Epoch: 1, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.070 Vali Acc: 0.451 Test Loss: 2.070 Test Acc: 0.451
Validation loss decreased (inf --> -0.451317).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6115209
	speed: 0.1416s/iter; left time: 2145.1193s
Epoch: 2 cost time: 7.469648361206055
Epoch: 2, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.308 Vali Acc: 0.450 Test Loss: 2.308 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1540149
	speed: 0.1385s/iter; left time: 2076.1296s
Epoch: 3 cost time: 7.886030912399292
Epoch: 3, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.056 Vali Acc: 0.475 Test Loss: 2.056 Test Acc: 0.475
Validation loss decreased (-0.451317 --> -0.475243).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9153953
	speed: 0.1489s/iter; left time: 2209.1611s
Epoch: 4 cost time: 8.1393301486969
Epoch: 4, Steps: 154 | Train Loss: 1.224 Vali Loss: 2.302 Vali Acc: 0.419 Test Loss: 2.302 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9044862
	speed: 0.1542s/iter; left time: 2264.5114s
Epoch: 5 cost time: 8.87392258644104
Epoch: 5, Steps: 154 | Train Loss: 1.160 Vali Loss: 1.927 Vali Acc: 0.514 Test Loss: 1.927 Test Acc: 0.514
Validation loss decreased (-0.475243 --> -0.513768).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7071671
	speed: 0.1562s/iter; left time: 2269.4952s
Epoch: 6 cost time: 8.96237564086914
Epoch: 6, Steps: 154 | Train Loss: 1.074 Vali Loss: 2.023 Vali Acc: 0.519 Test Loss: 2.023 Test Acc: 0.519
Validation loss decreased (-0.513768 --> -0.519444).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1594138
	speed: 0.1572s/iter; left time: 2260.7446s
Epoch: 7 cost time: 9.016098499298096
Epoch: 7, Steps: 154 | Train Loss: 0.975 Vali Loss: 2.668 Vali Acc: 0.508 Test Loss: 2.668 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0084834
	speed: 0.1595s/iter; left time: 2268.8138s
Epoch: 8 cost time: 8.942050457000732
Epoch: 8, Steps: 154 | Train Loss: 0.945 Vali Loss: 2.258 Vali Acc: 0.522 Test Loss: 2.258 Test Acc: 0.522
Validation loss decreased (-0.519444 --> -0.521875).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4864839
	speed: 0.1365s/iter; left time: 1920.8981s
Epoch: 9 cost time: 6.965212821960449
Epoch: 9, Steps: 154 | Train Loss: 0.854 Vali Loss: 2.533 Vali Acc: 0.520 Test Loss: 2.533 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1223174
	speed: 0.1256s/iter; left time: 1748.2099s
Epoch: 10 cost time: 5.881300449371338
Epoch: 10, Steps: 154 | Train Loss: 0.802 Vali Loss: 2.541 Vali Acc: 0.499 Test Loss: 2.541 Test Acc: 0.499
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6479441
	speed: 0.1258s/iter; left time: 1731.6169s
Epoch: 11 cost time: 6.2178871631622314
Epoch: 11, Steps: 154 | Train Loss: 0.731 Vali Loss: 2.703 Vali Acc: 0.542 Test Loss: 2.703 Test Acc: 0.542
Validation loss decreased (-0.521875 --> -0.541741).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5879462
	speed: 0.1177s/iter; left time: 1601.4734s
Epoch: 12 cost time: 5.307332992553711
Epoch: 12, Steps: 154 | Train Loss: 0.709 Vali Loss: 2.563 Vali Acc: 0.534 Test Loss: 2.563 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.7113025
	speed: 0.1266s/iter; left time: 1703.7639s
Epoch: 13 cost time: 6.365920782089233
Epoch: 13, Steps: 154 | Train Loss: 0.601 Vali Loss: 2.972 Vali Acc: 0.487 Test Loss: 2.972 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.5337889
	speed: 0.1256s/iter; left time: 1669.9996s
Epoch: 14 cost time: 6.560678482055664
Epoch: 14, Steps: 154 | Train Loss: 0.539 Vali Loss: 2.706 Vali Acc: 0.524 Test Loss: 2.706 Test Acc: 0.524
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2783166
	speed: 0.1512s/iter; left time: 1988.0430s
Epoch: 15 cost time: 9.180474996566772
Epoch: 15, Steps: 154 | Train Loss: 0.510 Vali Loss: 2.941 Vali Acc: 0.492 Test Loss: 2.941 Test Acc: 0.492
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3965013
	speed: 0.1549s/iter; left time: 2012.9352s
Epoch: 16 cost time: 9.21530556678772
Epoch: 16, Steps: 154 | Train Loss: 0.501 Vali Loss: 3.195 Vali Acc: 0.455 Test Loss: 3.195 Test Acc: 0.455
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2892200
	speed: 0.1572s/iter; left time: 2018.2149s
Epoch: 17 cost time: 9.174772262573242
Epoch: 17, Steps: 154 | Train Loss: 0.516 Vali Loss: 3.018 Vali Acc: 0.483 Test Loss: 3.018 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.4276195
	speed: 0.1592s/iter; left time: 2019.1133s
Epoch: 18 cost time: 9.152077913284302
Epoch: 18, Steps: 154 | Train Loss: 0.449 Vali Loss: 3.368 Vali Acc: 0.529 Test Loss: 3.368 Test Acc: 0.529
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.4672159
	speed: 0.1496s/iter; left time: 1874.4744s
Epoch: 19 cost time: 8.20047116279602
Epoch: 19, Steps: 154 | Train Loss: 0.447 Vali Loss: 3.134 Vali Acc: 0.527 Test Loss: 3.134 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.4903744
	speed: 0.1526s/iter; left time: 1887.8392s
Epoch: 20 cost time: 8.772888422012329
Epoch: 20, Steps: 154 | Train Loss: 0.400 Vali Loss: 3.195 Vali Acc: 0.503 Test Loss: 3.195 Test Acc: 0.503
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.8625835
	speed: 0.1524s/iter; left time: 1862.7347s
Epoch: 21 cost time: 8.859569549560547
Epoch: 21, Steps: 154 | Train Loss: 0.392 Vali Loss: 3.385 Vali Acc: 0.520 Test Loss: 3.385 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5417680454176804
model parameter : 296334
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7838423
	speed: 0.0443s/iter; left time: 678.4823s
Epoch: 1 cost time: 5.9563117027282715
Epoch: 1, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.111 Vali Acc: 0.406 Test Loss: 2.111 Test Acc: 0.406
Validation loss decreased (inf --> -0.405494).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9204414
	speed: 0.1144s/iter; left time: 1733.3357s
Epoch: 2 cost time: 4.652453184127808
Epoch: 2, Steps: 154 | Train Loss: 1.384 Vali Loss: 1.827 Vali Acc: 0.501 Test Loss: 1.827 Test Acc: 0.501
Validation loss decreased (-0.405494 --> -0.500793).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3683757
	speed: 0.1187s/iter; left time: 1779.4417s
Epoch: 3 cost time: 4.92967963218689
Epoch: 3, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.083 Vali Acc: 0.470 Test Loss: 2.083 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1069866
	speed: 0.1049s/iter; left time: 1556.3537s
Epoch: 4 cost time: 3.9680657386779785
Epoch: 4, Steps: 154 | Train Loss: 1.188 Vali Loss: 2.308 Vali Acc: 0.475 Test Loss: 2.308 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.8388093
	speed: 0.1043s/iter; left time: 1531.5023s
Epoch: 5 cost time: 4.109195709228516
Epoch: 5, Steps: 154 | Train Loss: 1.132 Vali Loss: 1.961 Vali Acc: 0.464 Test Loss: 1.961 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.7348918
	speed: 0.1069s/iter; left time: 1552.8050s
Epoch: 6 cost time: 4.025752067565918
Epoch: 6, Steps: 154 | Train Loss: 1.034 Vali Loss: 2.154 Vali Acc: 0.486 Test Loss: 2.154 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.3608084
	speed: 0.1029s/iter; left time: 1479.4727s
Epoch: 7 cost time: 3.759052038192749
Epoch: 7, Steps: 154 | Train Loss: 0.978 Vali Loss: 2.396 Vali Acc: 0.463 Test Loss: 2.396 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.5829443
	speed: 0.1061s/iter; left time: 1509.4091s
Epoch: 8 cost time: 3.9145541191101074
Epoch: 8, Steps: 154 | Train Loss: 0.890 Vali Loss: 2.216 Vali Acc: 0.457 Test Loss: 2.216 Test Acc: 0.457
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.8174004
	speed: 0.1033s/iter; left time: 1453.7188s
Epoch: 9 cost time: 3.9953601360321045
Epoch: 9, Steps: 154 | Train Loss: 0.855 Vali Loss: 2.586 Vali Acc: 0.518 Test Loss: 2.586 Test Acc: 0.518
Validation loss decreased (-0.500793 --> -0.517817).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7213676
	speed: 0.1081s/iter; left time: 1504.8790s
Epoch: 10 cost time: 3.946784257888794
Epoch: 10, Steps: 154 | Train Loss: 0.796 Vali Loss: 2.487 Vali Acc: 0.475 Test Loss: 2.487 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4367091
	speed: 0.1085s/iter; left time: 1493.6649s
Epoch: 11 cost time: 4.6290271282196045
Epoch: 11, Steps: 154 | Train Loss: 0.714 Vali Loss: 2.663 Vali Acc: 0.504 Test Loss: 2.663 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0892746
	speed: 0.1116s/iter; left time: 1518.8440s
Epoch: 12 cost time: 4.47446608543396
Epoch: 12, Steps: 154 | Train Loss: 0.656 Vali Loss: 3.162 Vali Acc: 0.450 Test Loss: 3.162 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3120264
	speed: 0.1163s/iter; left time: 1564.7654s
Epoch: 13 cost time: 5.117327451705933
Epoch: 13, Steps: 154 | Train Loss: 0.622 Vali Loss: 2.551 Vali Acc: 0.479 Test Loss: 2.551 Test Acc: 0.479
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5694707
	speed: 0.1182s/iter; left time: 1571.6685s
Epoch: 14 cost time: 5.003422021865845
Epoch: 14, Steps: 154 | Train Loss: 0.570 Vali Loss: 2.583 Vali Acc: 0.554 Test Loss: 2.583 Test Acc: 0.554
Validation loss decreased (-0.517817 --> -0.553908).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5828880
	speed: 0.1123s/iter; left time: 1476.3793s
Epoch: 15 cost time: 4.812826871871948
Epoch: 15, Steps: 154 | Train Loss: 0.521 Vali Loss: 2.552 Vali Acc: 0.517 Test Loss: 2.552 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2347255
	speed: 0.1128s/iter; left time: 1465.9339s
Epoch: 16 cost time: 4.890748023986816
Epoch: 16, Steps: 154 | Train Loss: 0.490 Vali Loss: 2.944 Vali Acc: 0.500 Test Loss: 2.944 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8840896
	speed: 0.1162s/iter; left time: 1491.8218s
Epoch: 17 cost time: 4.985427141189575
Epoch: 17, Steps: 154 | Train Loss: 0.486 Vali Loss: 2.938 Vali Acc: 0.461 Test Loss: 2.938 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5114393
	speed: 0.1151s/iter; left time: 1459.5127s
Epoch: 18 cost time: 4.66999626159668
Epoch: 18, Steps: 154 | Train Loss: 0.435 Vali Loss: 3.082 Vali Acc: 0.469 Test Loss: 3.082 Test Acc: 0.469
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5771359
	speed: 0.1062s/iter; left time: 1330.9075s
Epoch: 19 cost time: 4.38979434967041
Epoch: 19, Steps: 154 | Train Loss: 0.462 Vali Loss: 3.012 Vali Acc: 0.524 Test Loss: 3.012 Test Acc: 0.524
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0776273
	speed: 0.1134s/iter; left time: 1403.6469s
Epoch: 20 cost time: 4.854047060012817
Epoch: 20, Steps: 154 | Train Loss: 0.381 Vali Loss: 3.418 Vali Acc: 0.472 Test Loss: 3.418 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1336010
	speed: 0.1106s/iter; left time: 1351.3770s
Epoch: 21 cost time: 4.6686460971832275
Epoch: 21, Steps: 154 | Train Loss: 0.431 Vali Loss: 3.320 Vali Acc: 0.495 Test Loss: 3.320 Test Acc: 0.495
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.2856414
	speed: 0.1122s/iter; left time: 1354.2403s
Epoch: 22 cost time: 4.695600271224976
Epoch: 22, Steps: 154 | Train Loss: 0.408 Vali Loss: 3.186 Vali Acc: 0.505 Test Loss: 3.186 Test Acc: 0.505
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.7899232
	speed: 0.1138s/iter; left time: 1355.1790s
Epoch: 23 cost time: 4.823921203613281
Epoch: 23, Steps: 154 | Train Loss: 0.349 Vali Loss: 3.434 Vali Acc: 0.457 Test Loss: 3.434 Test Acc: 0.457
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2319024
	speed: 0.1155s/iter; left time: 1357.7233s
Epoch: 24 cost time: 4.82023549079895
Epoch: 24, Steps: 154 | Train Loss: 0.343 Vali Loss: 3.290 Vali Acc: 0.534 Test Loss: 3.290 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5539334955393349
model parameter : 264334
model size : 3.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4514039
	speed: 0.0379s/iter; left time: 579.7565s
Epoch: 1 cost time: 5.01272177696228
Epoch: 1, Steps: 154 | Train Loss: 2.057 Vali Loss: 1.888 Vali Acc: 0.380 Test Loss: 1.888 Test Acc: 0.380
Validation loss decreased (inf --> -0.380354).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1163411
	speed: 0.0967s/iter; left time: 1464.3705s
Epoch: 2 cost time: 3.8574678897857666
Epoch: 2, Steps: 154 | Train Loss: 1.393 Vali Loss: 1.931 Vali Acc: 0.429 Test Loss: 1.931 Test Acc: 0.429
Validation loss decreased (-0.380354 --> -0.428610).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1710342
	speed: 0.0994s/iter; left time: 1490.4056s
Epoch: 3 cost time: 3.627429723739624
Epoch: 3, Steps: 154 | Train Loss: 1.259 Vali Loss: 2.287 Vali Acc: 0.452 Test Loss: 2.287 Test Acc: 0.452
Validation loss decreased (-0.428610 --> -0.452126).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8179022
	speed: 0.0950s/iter; left time: 1409.6057s
Epoch: 4 cost time: 3.7719967365264893
Epoch: 4, Steps: 154 | Train Loss: 1.171 Vali Loss: 2.027 Vali Acc: 0.445 Test Loss: 2.027 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9339166
	speed: 0.0974s/iter; left time: 1430.5139s
Epoch: 5 cost time: 3.7783467769622803
Epoch: 5, Steps: 154 | Train Loss: 1.087 Vali Loss: 1.836 Vali Acc: 0.530 Test Loss: 1.836 Test Acc: 0.530
Validation loss decreased (-0.452126 --> -0.530395).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1682767
	speed: 0.0956s/iter; left time: 1389.1104s
Epoch: 6 cost time: 4.691507339477539
Epoch: 6, Steps: 154 | Train Loss: 1.004 Vali Loss: 1.907 Vali Acc: 0.463 Test Loss: 1.907 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.4919409
	speed: 0.1064s/iter; left time: 1529.9589s
Epoch: 7 cost time: 4.478757381439209
Epoch: 7, Steps: 154 | Train Loss: 0.961 Vali Loss: 2.005 Vali Acc: 0.539 Test Loss: 2.005 Test Acc: 0.539
Validation loss decreased (-0.530395 --> -0.538504).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1252259
	speed: 0.1079s/iter; left time: 1534.1490s
Epoch: 8 cost time: 4.419308662414551
Epoch: 8, Steps: 154 | Train Loss: 0.915 Vali Loss: 2.132 Vali Acc: 0.496 Test Loss: 2.132 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7714874
	speed: 0.1044s/iter; left time: 1468.2151s
Epoch: 9 cost time: 4.328097820281982
Epoch: 9, Steps: 154 | Train Loss: 0.846 Vali Loss: 2.248 Vali Acc: 0.454 Test Loss: 2.248 Test Acc: 0.454
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1708443
	speed: 0.1090s/iter; left time: 1516.6410s
Epoch: 10 cost time: 4.493210554122925
Epoch: 10, Steps: 154 | Train Loss: 0.783 Vali Loss: 2.130 Vali Acc: 0.504 Test Loss: 2.130 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0409371
	speed: 0.1085s/iter; left time: 1493.4155s
Epoch: 11 cost time: 4.437495470046997
Epoch: 11, Steps: 154 | Train Loss: 0.698 Vali Loss: 2.497 Vali Acc: 0.533 Test Loss: 2.497 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.5964732
	speed: 0.1071s/iter; left time: 1457.1487s
Epoch: 12 cost time: 4.428420782089233
Epoch: 12, Steps: 154 | Train Loss: 0.639 Vali Loss: 2.151 Vali Acc: 0.558 Test Loss: 2.151 Test Acc: 0.558
Validation loss decreased (-0.538504 --> -0.557967).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2763098
	speed: 0.1103s/iter; left time: 1483.3334s
Epoch: 13 cost time: 4.492609024047852
Epoch: 13, Steps: 154 | Train Loss: 0.614 Vali Loss: 2.754 Vali Acc: 0.520 Test Loss: 2.754 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6765828
	speed: 0.1089s/iter; left time: 1448.6229s
Epoch: 14 cost time: 4.371943950653076
Epoch: 14, Steps: 154 | Train Loss: 0.584 Vali Loss: 2.350 Vali Acc: 0.481 Test Loss: 2.350 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2259897
	speed: 0.1046s/iter; left time: 1374.5485s
Epoch: 15 cost time: 4.475511074066162
Epoch: 15, Steps: 154 | Train Loss: 0.542 Vali Loss: 2.483 Vali Acc: 0.512 Test Loss: 2.483 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5517055
	speed: 0.1104s/iter; left time: 1433.7209s
Epoch: 16 cost time: 4.466900587081909
Epoch: 16, Steps: 154 | Train Loss: 0.518 Vali Loss: 2.998 Vali Acc: 0.494 Test Loss: 2.998 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4026523
	speed: 0.1035s/iter; left time: 1328.2881s
Epoch: 17 cost time: 4.423771619796753
Epoch: 17, Steps: 154 | Train Loss: 0.508 Vali Loss: 2.631 Vali Acc: 0.522 Test Loss: 2.631 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.8347359
	speed: 0.1071s/iter; left time: 1358.2875s
Epoch: 18 cost time: 4.31734037399292
Epoch: 18, Steps: 154 | Train Loss: 0.464 Vali Loss: 2.425 Vali Acc: 0.512 Test Loss: 2.425 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3963698
	speed: 0.1096s/iter; left time: 1372.6063s
Epoch: 19 cost time: 4.49483060836792
Epoch: 19, Steps: 154 | Train Loss: 0.449 Vali Loss: 2.781 Vali Acc: 0.519 Test Loss: 2.781 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.4355370
	speed: 0.0999s/iter; left time: 1235.7207s
Epoch: 20 cost time: 3.714055299758911
Epoch: 20, Steps: 154 | Train Loss: 0.424 Vali Loss: 2.967 Vali Acc: 0.497 Test Loss: 2.967 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3831809
	speed: 0.0955s/iter; left time: 1166.8922s
Epoch: 21 cost time: 3.704371690750122
Epoch: 21, Steps: 154 | Train Loss: 0.393 Vali Loss: 2.590 Vali Acc: 0.548 Test Loss: 2.590 Test Acc: 0.548
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5105946
	speed: 0.0990s/iter; left time: 1194.9339s
Epoch: 22 cost time: 3.730426073074341
Epoch: 22, Steps: 154 | Train Loss: 0.389 Vali Loss: 3.586 Vali Acc: 0.503 Test Loss: 3.586 Test Acc: 0.503
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm128_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5579886455798865
model parameter : 242958
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4346931
	speed: 0.0573s/iter; left time: 876.2912s
Epoch: 1 cost time: 8.02247142791748
Epoch: 1, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.101 Vali Acc: 0.387 Test Loss: 2.101 Test Acc: 0.387
Validation loss decreased (inf --> -0.387246).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1374681
	speed: 0.1262s/iter; left time: 1911.6957s
Epoch: 2 cost time: 6.025540113449097
Epoch: 2, Steps: 154 | Train Loss: 1.477 Vali Loss: 1.870 Vali Acc: 0.509 Test Loss: 1.870 Test Acc: 0.509
Validation loss decreased (-0.387246 --> -0.508497).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7268107
	speed: 0.1398s/iter; left time: 2095.3918s
Epoch: 3 cost time: 8.839592695236206
Epoch: 3, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.134 Vali Acc: 0.459 Test Loss: 2.134 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0477462
	speed: 0.1486s/iter; left time: 2205.4037s
Epoch: 4 cost time: 8.837598085403442
Epoch: 4, Steps: 154 | Train Loss: 1.272 Vali Loss: 2.135 Vali Acc: 0.524 Test Loss: 2.135 Test Acc: 0.524
Validation loss decreased (-0.508497 --> -0.523499).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6010746
	speed: 0.1513s/iter; left time: 2222.4875s
Epoch: 5 cost time: 8.747362852096558
Epoch: 5, Steps: 154 | Train Loss: 1.213 Vali Loss: 2.298 Vali Acc: 0.461 Test Loss: 2.298 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9774040
	speed: 0.1457s/iter; left time: 2117.4190s
Epoch: 6 cost time: 8.376320838928223
Epoch: 6, Steps: 154 | Train Loss: 1.072 Vali Loss: 2.768 Vali Acc: 0.463 Test Loss: 2.768 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7842715
	speed: 0.1473s/iter; left time: 2118.1580s
Epoch: 7 cost time: 8.345953941345215
Epoch: 7, Steps: 154 | Train Loss: 0.939 Vali Loss: 2.583 Vali Acc: 0.496 Test Loss: 2.583 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6885504
	speed: 0.1400s/iter; left time: 1991.4981s
Epoch: 8 cost time: 7.629798889160156
Epoch: 8, Steps: 154 | Train Loss: 0.880 Vali Loss: 2.601 Vali Acc: 0.468 Test Loss: 2.601 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.4995678
	speed: 0.1459s/iter; left time: 2053.1173s
Epoch: 9 cost time: 8.576435327529907
Epoch: 9, Steps: 154 | Train Loss: 0.769 Vali Loss: 2.620 Vali Acc: 0.495 Test Loss: 2.620 Test Acc: 0.495
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5466859
	speed: 0.1503s/iter; left time: 2091.0775s
Epoch: 10 cost time: 8.556740283966064
Epoch: 10, Steps: 154 | Train Loss: 0.705 Vali Loss: 3.333 Vali Acc: 0.513 Test Loss: 3.333 Test Acc: 0.513
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.8565741
	speed: 0.1523s/iter; left time: 2096.3739s
Epoch: 11 cost time: 8.710971355438232
Epoch: 11, Steps: 154 | Train Loss: 0.628 Vali Loss: 3.353 Vali Acc: 0.437 Test Loss: 3.353 Test Acc: 0.437
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6471865
	speed: 0.1540s/iter; left time: 2096.0773s
Epoch: 12 cost time: 8.601210355758667
Epoch: 12, Steps: 154 | Train Loss: 0.569 Vali Loss: 3.321 Vali Acc: 0.485 Test Loss: 3.321 Test Acc: 0.485
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3754963
	speed: 0.1501s/iter; left time: 2018.7369s
Epoch: 13 cost time: 7.526794910430908
Epoch: 13, Steps: 154 | Train Loss: 0.532 Vali Loss: 3.271 Vali Acc: 0.502 Test Loss: 3.271 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.8312026
	speed: 0.1169s/iter; left time: 1555.3081s
Epoch: 14 cost time: 5.890081882476807
Epoch: 14, Steps: 154 | Train Loss: 0.454 Vali Loss: 3.760 Vali Acc: 0.452 Test Loss: 3.760 Test Acc: 0.452
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5235198702351987
model parameter : 293774
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7343055
	speed: 0.0389s/iter; left time: 595.6472s
Epoch: 1 cost time: 5.174137830734253
Epoch: 1, Steps: 154 | Train Loss: 1.986 Vali Loss: 2.338 Vali Acc: 0.407 Test Loss: 2.338 Test Acc: 0.407
Validation loss decreased (inf --> -0.406708).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6887932
	speed: 0.0978s/iter; left time: 1481.9263s
Epoch: 2 cost time: 3.8853893280029297
Epoch: 2, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.069 Vali Acc: 0.467 Test Loss: 2.069 Test Acc: 0.467
Validation loss decreased (-0.406708 --> -0.467133).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5248412
	speed: 0.1019s/iter; left time: 1527.2320s
Epoch: 3 cost time: 4.122421026229858
Epoch: 3, Steps: 154 | Train Loss: 1.225 Vali Loss: 1.851 Vali Acc: 0.515 Test Loss: 1.851 Test Acc: 0.515
Validation loss decreased (-0.467133 --> -0.514580).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9863061
	speed: 0.1014s/iter; left time: 1504.6756s
Epoch: 4 cost time: 4.451093435287476
Epoch: 4, Steps: 154 | Train Loss: 1.141 Vali Loss: 1.963 Vali Acc: 0.482 Test Loss: 1.963 Test Acc: 0.482
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7610767
	speed: 0.1047s/iter; left time: 1537.7302s
Epoch: 5 cost time: 4.475349187850952
Epoch: 5, Steps: 154 | Train Loss: 1.058 Vali Loss: 1.791 Vali Acc: 0.550 Test Loss: 1.791 Test Acc: 0.550
Validation loss decreased (-0.514580 --> -0.549860).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8816632
	speed: 0.1074s/iter; left time: 1560.3058s
Epoch: 6 cost time: 4.641678810119629
Epoch: 6, Steps: 154 | Train Loss: 0.977 Vali Loss: 2.217 Vali Acc: 0.472 Test Loss: 2.217 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3479989
	speed: 0.1096s/iter; left time: 1575.6951s
Epoch: 7 cost time: 4.802750110626221
Epoch: 7, Steps: 154 | Train Loss: 0.880 Vali Loss: 1.999 Vali Acc: 0.495 Test Loss: 1.999 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.5597234
	speed: 0.1102s/iter; left time: 1567.5812s
Epoch: 8 cost time: 4.535472393035889
Epoch: 8, Steps: 154 | Train Loss: 0.807 Vali Loss: 2.025 Vali Acc: 0.505 Test Loss: 2.025 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6424832
	speed: 0.1068s/iter; left time: 1502.3091s
Epoch: 9 cost time: 4.583840847015381
Epoch: 9, Steps: 154 | Train Loss: 0.726 Vali Loss: 2.260 Vali Acc: 0.518 Test Loss: 2.260 Test Acc: 0.518
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.7628143
	speed: 0.1111s/iter; left time: 1546.5378s
Epoch: 10 cost time: 4.711112022399902
Epoch: 10, Steps: 154 | Train Loss: 0.649 Vali Loss: 2.445 Vali Acc: 0.533 Test Loss: 2.445 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.1970487
	speed: 0.1150s/iter; left time: 1583.1968s
Epoch: 11 cost time: 4.7072594165802
Epoch: 11, Steps: 154 | Train Loss: 0.585 Vali Loss: 2.553 Vali Acc: 0.511 Test Loss: 2.553 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.6043254
	speed: 0.1090s/iter; left time: 1483.3252s
Epoch: 12 cost time: 4.700590133666992
Epoch: 12, Steps: 154 | Train Loss: 0.542 Vali Loss: 2.639 Vali Acc: 0.480 Test Loss: 2.639 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.4675175
	speed: 0.1087s/iter; left time: 1462.3429s
Epoch: 13 cost time: 4.662900686264038
Epoch: 13, Steps: 154 | Train Loss: 0.519 Vali Loss: 2.372 Vali Acc: 0.485 Test Loss: 2.372 Test Acc: 0.485
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6139197
	speed: 0.1143s/iter; left time: 1520.3455s
Epoch: 14 cost time: 4.8774802684783936
Epoch: 14, Steps: 154 | Train Loss: 0.482 Vali Loss: 2.508 Vali Acc: 0.554 Test Loss: 2.508 Test Acc: 0.554
Validation loss decreased (-0.549860 --> -0.553908).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2918134
	speed: 0.1099s/iter; left time: 1444.5070s
Epoch: 15 cost time: 4.699584245681763
Epoch: 15, Steps: 154 | Train Loss: 0.450 Vali Loss: 2.505 Vali Acc: 0.501 Test Loss: 2.505 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5566902
	speed: 0.1062s/iter; left time: 1379.4123s
Epoch: 16 cost time: 4.5311598777771
Epoch: 16, Steps: 154 | Train Loss: 0.385 Vali Loss: 2.956 Vali Acc: 0.528 Test Loss: 2.956 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0176485
	speed: 0.1105s/iter; left time: 1419.1140s
Epoch: 17 cost time: 4.712621212005615
Epoch: 17, Steps: 154 | Train Loss: 0.358 Vali Loss: 3.208 Vali Acc: 0.479 Test Loss: 3.208 Test Acc: 0.479
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4373137
	speed: 0.1017s/iter; left time: 1290.4375s
Epoch: 18 cost time: 3.9637293815612793
Epoch: 18, Steps: 154 | Train Loss: 0.330 Vali Loss: 3.081 Vali Acc: 0.531 Test Loss: 3.081 Test Acc: 0.531
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.4088520
	speed: 0.0999s/iter; left time: 1251.6204s
Epoch: 19 cost time: 3.938124418258667
Epoch: 19, Steps: 154 | Train Loss: 0.321 Vali Loss: 3.161 Vali Acc: 0.479 Test Loss: 3.161 Test Acc: 0.479
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.3511674
	speed: 0.1030s/iter; left time: 1274.8228s
Epoch: 20 cost time: 3.8844618797302246
Epoch: 20, Steps: 154 | Train Loss: 0.308 Vali Loss: 3.522 Vali Acc: 0.450 Test Loss: 3.522 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.2380106
	speed: 0.0993s/iter; left time: 1213.5713s
Epoch: 21 cost time: 3.9402382373809814
Epoch: 21, Steps: 154 | Train Loss: 0.276 Vali Loss: 3.157 Vali Acc: 0.519 Test Loss: 3.157 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0456686
	speed: 0.1025s/iter; left time: 1236.4880s
Epoch: 22 cost time: 4.00004243850708
Epoch: 22, Steps: 154 | Train Loss: 0.274 Vali Loss: 3.545 Vali Acc: 0.426 Test Loss: 3.545 Test Acc: 0.426
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0660179
	speed: 0.1046s/iter; left time: 1246.3462s
Epoch: 23 cost time: 4.114156723022461
Epoch: 23, Steps: 154 | Train Loss: 0.249 Vali Loss: 3.344 Vali Acc: 0.512 Test Loss: 3.344 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1918509
	speed: 0.1027s/iter; left time: 1207.2774s
Epoch: 24 cost time: 4.0340142250061035
Epoch: 24, Steps: 154 | Train Loss: 0.220 Vali Loss: 3.535 Vali Acc: 0.506 Test Loss: 3.535 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5539334955393349
model parameter : 197070
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0789371
	speed: 0.0452s/iter; left time: 691.0804s
Epoch: 1 cost time: 6.166051149368286
Epoch: 1, Steps: 154 | Train Loss: 2.022 Vali Loss: 1.713 Vali Acc: 0.456 Test Loss: 1.713 Test Acc: 0.456
Validation loss decreased (inf --> -0.456187).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8493499
	speed: 0.1092s/iter; left time: 1654.3034s
Epoch: 2 cost time: 4.384079933166504
Epoch: 2, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.021 Vali Acc: 0.472 Test Loss: 2.021 Test Acc: 0.472
Validation loss decreased (-0.456187 --> -0.471999).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3164933
	speed: 0.1070s/iter; left time: 1604.8174s
Epoch: 3 cost time: 4.643185377120972
Epoch: 3, Steps: 154 | Train Loss: 1.255 Vali Loss: 2.104 Vali Acc: 0.465 Test Loss: 2.104 Test Acc: 0.465
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0141603
	speed: 0.1145s/iter; left time: 1698.5544s
Epoch: 4 cost time: 4.7272889614105225
Epoch: 4, Steps: 154 | Train Loss: 1.156 Vali Loss: 1.846 Vali Acc: 0.506 Test Loss: 1.846 Test Acc: 0.506
Validation loss decreased (-0.471999 --> -0.505659).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3060061
	speed: 0.1067s/iter; left time: 1566.2935s
Epoch: 5 cost time: 4.676465272903442
Epoch: 5, Steps: 154 | Train Loss: 1.059 Vali Loss: 2.041 Vali Acc: 0.485 Test Loss: 2.041 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8274025
	speed: 0.1062s/iter; left time: 1543.7717s
Epoch: 6 cost time: 4.60646653175354
Epoch: 6, Steps: 154 | Train Loss: 0.999 Vali Loss: 2.075 Vali Acc: 0.527 Test Loss: 2.075 Test Acc: 0.527
Validation loss decreased (-0.505659 --> -0.526743).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6416564
	speed: 0.1113s/iter; left time: 1600.5648s
Epoch: 7 cost time: 4.639716625213623
Epoch: 7, Steps: 154 | Train Loss: 0.885 Vali Loss: 2.136 Vali Acc: 0.452 Test Loss: 2.136 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1257037
	speed: 0.1021s/iter; left time: 1452.4645s
Epoch: 8 cost time: 4.434916019439697
Epoch: 8, Steps: 154 | Train Loss: 0.811 Vali Loss: 2.812 Vali Acc: 0.489 Test Loss: 2.812 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3603766
	speed: 0.1067s/iter; left time: 1500.8997s
Epoch: 9 cost time: 4.607513904571533
Epoch: 9, Steps: 154 | Train Loss: 0.776 Vali Loss: 2.266 Vali Acc: 0.507 Test Loss: 2.266 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.7217587
	speed: 0.1146s/iter; left time: 1595.1825s
Epoch: 10 cost time: 4.821174144744873
Epoch: 10, Steps: 154 | Train Loss: 0.651 Vali Loss: 2.246 Vali Acc: 0.526 Test Loss: 2.246 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6944126
	speed: 0.1079s/iter; left time: 1484.5681s
Epoch: 11 cost time: 4.5906407833099365
Epoch: 11, Steps: 154 | Train Loss: 0.646 Vali Loss: 2.613 Vali Acc: 0.474 Test Loss: 2.613 Test Acc: 0.474
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.7424784
	speed: 0.1093s/iter; left time: 1486.6866s
Epoch: 12 cost time: 4.662584066390991
Epoch: 12, Steps: 154 | Train Loss: 0.565 Vali Loss: 2.593 Vali Acc: 0.522 Test Loss: 2.593 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.5469424
	speed: 0.1048s/iter; left time: 1409.6027s
Epoch: 13 cost time: 4.0000550746917725
Epoch: 13, Steps: 154 | Train Loss: 0.508 Vali Loss: 2.672 Vali Acc: 0.544 Test Loss: 2.672 Test Acc: 0.544
Validation loss decreased (-0.526743 --> -0.544174).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8769711
	speed: 0.1002s/iter; left time: 1332.8271s
Epoch: 14 cost time: 3.7953414916992188
Epoch: 14, Steps: 154 | Train Loss: 0.471 Vali Loss: 2.633 Vali Acc: 0.517 Test Loss: 2.633 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6211184
	speed: 0.0977s/iter; left time: 1283.6782s
Epoch: 15 cost time: 3.918131113052368
Epoch: 15, Steps: 154 | Train Loss: 0.413 Vali Loss: 2.874 Vali Acc: 0.540 Test Loss: 2.874 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3029774
	speed: 0.0999s/iter; left time: 1298.0750s
Epoch: 16 cost time: 3.825741767883301
Epoch: 16, Steps: 154 | Train Loss: 0.372 Vali Loss: 3.025 Vali Acc: 0.476 Test Loss: 3.025 Test Acc: 0.476
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1410080
	speed: 0.0988s/iter; left time: 1267.8480s
Epoch: 17 cost time: 3.878467559814453
Epoch: 17, Steps: 154 | Train Loss: 0.373 Vali Loss: 2.914 Vali Acc: 0.553 Test Loss: 2.914 Test Acc: 0.553
Validation loss decreased (-0.544174 --> -0.552688).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3516018
	speed: 0.0962s/iter; left time: 1219.7177s
Epoch: 18 cost time: 3.6477530002593994
Epoch: 18, Steps: 154 | Train Loss: 0.324 Vali Loss: 3.217 Vali Acc: 0.524 Test Loss: 3.217 Test Acc: 0.524
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1785762
	speed: 0.0949s/iter; left time: 1189.3658s
Epoch: 19 cost time: 3.840606927871704
Epoch: 19, Steps: 154 | Train Loss: 0.295 Vali Loss: 3.095 Vali Acc: 0.517 Test Loss: 3.095 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.4471096
	speed: 0.1065s/iter; left time: 1317.5989s
Epoch: 20 cost time: 4.862484931945801
Epoch: 20, Steps: 154 | Train Loss: 0.307 Vali Loss: 3.365 Vali Acc: 0.517 Test Loss: 3.365 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.3198737
	speed: 0.1084s/iter; left time: 1324.9174s
Epoch: 21 cost time: 4.638651371002197
Epoch: 21, Steps: 154 | Train Loss: 0.252 Vali Loss: 3.524 Vali Acc: 0.518 Test Loss: 3.524 Test Acc: 0.518
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1320215
	speed: 0.1076s/iter; left time: 1298.0038s
Epoch: 22 cost time: 4.414757966995239
Epoch: 22, Steps: 154 | Train Loss: 0.227 Vali Loss: 3.397 Vali Acc: 0.523 Test Loss: 3.397 Test Acc: 0.523
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.7597849
	speed: 0.1128s/iter; left time: 1343.9421s
Epoch: 23 cost time: 4.7706403732299805
Epoch: 23, Steps: 154 | Train Loss: 0.250 Vali Loss: 3.850 Vali Acc: 0.503 Test Loss: 3.850 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0342601
	speed: 0.1114s/iter; left time: 1310.0367s
Epoch: 24 cost time: 4.57398533821106
Epoch: 24, Steps: 154 | Train Loss: 0.242 Vali Loss: 3.468 Vali Acc: 0.544 Test Loss: 3.468 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0896915
	speed: 0.1081s/iter; left time: 1254.3258s
Epoch: 25 cost time: 4.598881721496582
Epoch: 25, Steps: 154 | Train Loss: 0.211 Vali Loss: 3.615 Vali Acc: 0.505 Test Loss: 3.615 Test Acc: 0.505
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2901843
	speed: 0.1118s/iter; left time: 1279.8349s
Epoch: 26 cost time: 4.895582437515259
Epoch: 26, Steps: 154 | Train Loss: 0.219 Vali Loss: 3.654 Vali Acc: 0.543 Test Loss: 3.654 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0135291
	speed: 0.1115s/iter; left time: 1259.4841s
Epoch: 27 cost time: 4.66414737701416
Epoch: 27, Steps: 154 | Train Loss: 0.161 Vali Loss: 3.940 Vali Acc: 0.527 Test Loss: 3.940 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5527169505271695
model parameter : 197134
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0108492
	speed: 0.0455s/iter; left time: 696.4825s
Epoch: 1 cost time: 6.014629364013672
Epoch: 1, Steps: 154 | Train Loss: 2.079 Vali Loss: 1.830 Vali Acc: 0.420 Test Loss: 1.830 Test Acc: 0.420
Validation loss decreased (inf --> -0.420095).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4423075
	speed: 0.1079s/iter; left time: 1634.8147s
Epoch: 2 cost time: 4.435603380203247
Epoch: 2, Steps: 154 | Train Loss: 1.419 Vali Loss: 1.914 Vali Acc: 0.484 Test Loss: 1.914 Test Acc: 0.484
Validation loss decreased (-0.420095 --> -0.483760).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0672225
	speed: 0.1078s/iter; left time: 1616.0143s
Epoch: 3 cost time: 4.258467674255371
Epoch: 3, Steps: 154 | Train Loss: 1.212 Vali Loss: 1.872 Vali Acc: 0.517 Test Loss: 1.872 Test Acc: 0.517
Validation loss decreased (-0.483760 --> -0.517418).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6951183
	speed: 0.1103s/iter; left time: 1636.1557s
Epoch: 4 cost time: 4.329720973968506
Epoch: 4, Steps: 154 | Train Loss: 1.149 Vali Loss: 1.914 Vali Acc: 0.496 Test Loss: 1.914 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4209678
	speed: 0.0998s/iter; left time: 1465.9102s
Epoch: 5 cost time: 3.7748656272888184
Epoch: 5, Steps: 154 | Train Loss: 1.060 Vali Loss: 1.902 Vali Acc: 0.490 Test Loss: 1.902 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4063125
	speed: 0.0939s/iter; left time: 1363.9741s
Epoch: 6 cost time: 3.6737887859344482
Epoch: 6, Steps: 154 | Train Loss: 0.965 Vali Loss: 2.232 Vali Acc: 0.496 Test Loss: 2.232 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.1214653
	speed: 0.0900s/iter; left time: 1294.2295s
Epoch: 7 cost time: 3.68707537651062
Epoch: 7, Steps: 154 | Train Loss: 0.911 Vali Loss: 2.074 Vali Acc: 0.527 Test Loss: 2.074 Test Acc: 0.527
Validation loss decreased (-0.517418 --> -0.526743).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4200814
	speed: 0.0960s/iter; left time: 1365.9415s
Epoch: 8 cost time: 3.71408748626709
Epoch: 8, Steps: 154 | Train Loss: 0.849 Vali Loss: 2.318 Vali Acc: 0.461 Test Loss: 2.318 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2556195
	speed: 0.0976s/iter; left time: 1373.4326s
Epoch: 9 cost time: 3.8192365169525146
Epoch: 9, Steps: 154 | Train Loss: 0.778 Vali Loss: 2.396 Vali Acc: 0.503 Test Loss: 2.396 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6868067
	speed: 0.0958s/iter; left time: 1332.7941s
Epoch: 10 cost time: 3.777709722518921
Epoch: 10, Steps: 154 | Train Loss: 0.713 Vali Loss: 2.253 Vali Acc: 0.535 Test Loss: 2.253 Test Acc: 0.535
Validation loss decreased (-0.526743 --> -0.535257).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8046612
	speed: 0.0965s/iter; left time: 1327.3168s
Epoch: 11 cost time: 3.695211887359619
Epoch: 11, Steps: 154 | Train Loss: 0.661 Vali Loss: 2.186 Vali Acc: 0.506 Test Loss: 2.186 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8125399
	speed: 0.1049s/iter; left time: 1427.5513s
Epoch: 12 cost time: 4.513826370239258
Epoch: 12, Steps: 154 | Train Loss: 0.576 Vali Loss: 2.479 Vali Acc: 0.542 Test Loss: 2.479 Test Acc: 0.542
Validation loss decreased (-0.535257 --> -0.541743).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4789863
	speed: 0.1057s/iter; left time: 1422.1599s
Epoch: 13 cost time: 4.311315536499023
Epoch: 13, Steps: 154 | Train Loss: 0.546 Vali Loss: 2.530 Vali Acc: 0.491 Test Loss: 2.530 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6121193
	speed: 0.1101s/iter; left time: 1464.2843s
Epoch: 14 cost time: 4.363276481628418
Epoch: 14, Steps: 154 | Train Loss: 0.501 Vali Loss: 2.736 Vali Acc: 0.521 Test Loss: 2.736 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.2273290
	speed: 0.1049s/iter; left time: 1378.9871s
Epoch: 15 cost time: 4.566615343093872
Epoch: 15, Steps: 154 | Train Loss: 0.453 Vali Loss: 2.468 Vali Acc: 0.532 Test Loss: 2.468 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2487238
	speed: 0.1066s/iter; left time: 1384.4783s
Epoch: 16 cost time: 4.509902715682983
Epoch: 16, Steps: 154 | Train Loss: 0.439 Vali Loss: 2.618 Vali Acc: 0.483 Test Loss: 2.618 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5399014
	speed: 0.1098s/iter; left time: 1409.0146s
Epoch: 17 cost time: 4.595543384552002
Epoch: 17, Steps: 154 | Train Loss: 0.392 Vali Loss: 2.686 Vali Acc: 0.528 Test Loss: 2.686 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2013985
	speed: 0.1055s/iter; left time: 1337.5080s
Epoch: 18 cost time: 4.196968078613281
Epoch: 18, Steps: 154 | Train Loss: 0.348 Vali Loss: 3.098 Vali Acc: 0.526 Test Loss: 3.098 Test Acc: 0.526
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2088983
	speed: 0.1137s/iter; left time: 1424.1719s
Epoch: 19 cost time: 4.854666709899902
Epoch: 19, Steps: 154 | Train Loss: 0.349 Vali Loss: 2.893 Vali Acc: 0.512 Test Loss: 2.893 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1392498
	speed: 0.1131s/iter; left time: 1400.0971s
Epoch: 20 cost time: 4.36550760269165
Epoch: 20, Steps: 154 | Train Loss: 0.322 Vali Loss: 2.891 Vali Acc: 0.518 Test Loss: 2.891 Test Acc: 0.518
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.5048764
	speed: 0.1130s/iter; left time: 1381.3386s
Epoch: 21 cost time: 4.7875964641571045
Epoch: 21, Steps: 154 | Train Loss: 0.302 Vali Loss: 3.047 Vali Acc: 0.532 Test Loss: 3.047 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3776152
	speed: 0.1121s/iter; left time: 1352.5179s
Epoch: 22 cost time: 4.741852760314941
Epoch: 22, Steps: 154 | Train Loss: 0.294 Vali Loss: 2.882 Vali Acc: 0.530 Test Loss: 2.882 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5417680454176804
model parameter : 165006
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2563143
	speed: 0.0447s/iter; left time: 684.6022s
Epoch: 1 cost time: 6.121378421783447
Epoch: 1, Steps: 154 | Train Loss: 2.123 Vali Loss: 1.881 Vali Acc: 0.381 Test Loss: 1.881 Test Acc: 0.381
Validation loss decreased (inf --> -0.380760).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6559561
	speed: 0.1008s/iter; left time: 1527.3755s
Epoch: 2 cost time: 3.7466251850128174
Epoch: 2, Steps: 154 | Train Loss: 1.454 Vali Loss: 1.966 Vali Acc: 0.427 Test Loss: 1.966 Test Acc: 0.427
Validation loss decreased (-0.380760 --> -0.427393).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2020571
	speed: 0.0952s/iter; left time: 1427.5674s
Epoch: 3 cost time: 3.7046968936920166
Epoch: 3, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.125 Vali Acc: 0.461 Test Loss: 2.125 Test Acc: 0.461
Validation loss decreased (-0.427393 --> -0.461049).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8132065
	speed: 0.0990s/iter; left time: 1469.2532s
Epoch: 4 cost time: 3.914933204650879
Epoch: 4, Steps: 154 | Train Loss: 1.163 Vali Loss: 2.045 Vali Acc: 0.427 Test Loss: 2.045 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5121871
	speed: 0.0977s/iter; left time: 1434.1235s
Epoch: 5 cost time: 4.059252738952637
Epoch: 5, Steps: 154 | Train Loss: 1.078 Vali Loss: 2.111 Vali Acc: 0.471 Test Loss: 2.111 Test Acc: 0.471
Validation loss decreased (-0.461049 --> -0.471187).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7745337
	speed: 0.1000s/iter; left time: 1452.8706s
Epoch: 6 cost time: 3.840233564376831
Epoch: 6, Steps: 154 | Train Loss: 1.013 Vali Loss: 1.880 Vali Acc: 0.480 Test Loss: 1.880 Test Acc: 0.480
Validation loss decreased (-0.471187 --> -0.479705).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4905012
	speed: 0.0987s/iter; left time: 1418.8163s
Epoch: 7 cost time: 3.730437755584717
Epoch: 7, Steps: 154 | Train Loss: 0.946 Vali Loss: 2.321 Vali Acc: 0.452 Test Loss: 2.321 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6874343
	speed: 0.1003s/iter; left time: 1425.9683s
Epoch: 8 cost time: 4.58341646194458
Epoch: 8, Steps: 154 | Train Loss: 0.910 Vali Loss: 1.718 Vali Acc: 0.550 Test Loss: 1.718 Test Acc: 0.550
Validation loss decreased (-0.479705 --> -0.550267).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6909763
	speed: 0.1053s/iter; left time: 1481.7658s
Epoch: 9 cost time: 4.122246980667114
Epoch: 9, Steps: 154 | Train Loss: 0.799 Vali Loss: 2.319 Vali Acc: 0.443 Test Loss: 2.319 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.7956871
	speed: 0.1033s/iter; left time: 1437.6336s
Epoch: 10 cost time: 4.261143207550049
Epoch: 10, Steps: 154 | Train Loss: 0.746 Vali Loss: 1.900 Vali Acc: 0.528 Test Loss: 1.900 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0995241
	speed: 0.1057s/iter; left time: 1454.7105s
Epoch: 11 cost time: 4.417975187301636
Epoch: 11, Steps: 154 | Train Loss: 0.681 Vali Loss: 2.051 Vali Acc: 0.521 Test Loss: 2.051 Test Acc: 0.521
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3497603
	speed: 0.1271s/iter; left time: 1729.1660s
Epoch: 12 cost time: 5.250298976898193
Epoch: 12, Steps: 154 | Train Loss: 0.628 Vali Loss: 2.005 Vali Acc: 0.499 Test Loss: 2.005 Test Acc: 0.499
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7843202
	speed: 0.1311s/iter; left time: 1763.1091s
Epoch: 13 cost time: 6.041218042373657
Epoch: 13, Steps: 154 | Train Loss: 0.627 Vali Loss: 2.221 Vali Acc: 0.494 Test Loss: 2.221 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6247420
	speed: 0.1292s/iter; left time: 1718.4896s
Epoch: 14 cost time: 5.450533866882324
Epoch: 14, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.417 Vali Acc: 0.508 Test Loss: 2.417 Test Acc: 0.508
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.4878689
	speed: 0.1302s/iter; left time: 1711.0418s
Epoch: 15 cost time: 5.3285768032073975
Epoch: 15, Steps: 154 | Train Loss: 0.502 Vali Loss: 2.359 Vali Acc: 0.509 Test Loss: 2.359 Test Acc: 0.509
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2452968
	speed: 0.1292s/iter; left time: 1678.3674s
Epoch: 16 cost time: 5.900965213775635
Epoch: 16, Steps: 154 | Train Loss: 0.459 Vali Loss: 2.655 Vali Acc: 0.476 Test Loss: 2.655 Test Acc: 0.476
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.8679048
	speed: 0.1251s/iter; left time: 1606.2497s
Epoch: 17 cost time: 5.487677574157715
Epoch: 17, Steps: 154 | Train Loss: 0.431 Vali Loss: 2.403 Vali Acc: 0.543 Test Loss: 2.403 Test Acc: 0.543
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.6164407
	speed: 0.1274s/iter; left time: 1616.3671s
Epoch: 18 cost time: 5.043665647506714
Epoch: 18, Steps: 154 | Train Loss: 0.393 Vali Loss: 2.471 Vali Acc: 0.511 Test Loss: 2.471 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5502838605028386
model parameter : 149006
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8866463
	speed: 0.0467s/iter; left time: 713.8406s
Epoch: 1 cost time: 6.600467205047607
Epoch: 1, Steps: 154 | Train Loss: 2.176 Vali Loss: 1.895 Vali Acc: 0.408 Test Loss: 1.895 Test Acc: 0.408
Validation loss decreased (inf --> -0.407929).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9364179
	speed: 0.1259s/iter; left time: 1906.8151s
Epoch: 2 cost time: 5.069556713104248
Epoch: 2, Steps: 154 | Train Loss: 1.511 Vali Loss: 1.819 Vali Acc: 0.473 Test Loss: 1.819 Test Acc: 0.473
Validation loss decreased (-0.407929 --> -0.473218).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9566799
	speed: 0.1308s/iter; left time: 1961.4414s
Epoch: 3 cost time: 5.874395132064819
Epoch: 3, Steps: 154 | Train Loss: 1.273 Vali Loss: 1.754 Vali Acc: 0.494 Test Loss: 1.754 Test Acc: 0.494
Validation loss decreased (-0.473218 --> -0.493494).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0083481
	speed: 0.1157s/iter; left time: 1716.3139s
Epoch: 4 cost time: 4.519979238510132
Epoch: 4, Steps: 154 | Train Loss: 1.153 Vali Loss: 1.910 Vali Acc: 0.475 Test Loss: 1.910 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7911684
	speed: 0.1154s/iter; left time: 1694.9806s
Epoch: 5 cost time: 4.353548049926758
Epoch: 5, Steps: 154 | Train Loss: 1.118 Vali Loss: 1.652 Vali Acc: 0.496 Test Loss: 1.652 Test Acc: 0.496
Validation loss decreased (-0.493494 --> -0.496334).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4392073
	speed: 0.1159s/iter; left time: 1684.4604s
Epoch: 6 cost time: 4.58818507194519
Epoch: 6, Steps: 154 | Train Loss: 1.037 Vali Loss: 1.743 Vali Acc: 0.513 Test Loss: 1.743 Test Acc: 0.513
Validation loss decreased (-0.496334 --> -0.513365).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8920013
	speed: 0.1044s/iter; left time: 1500.3319s
Epoch: 7 cost time: 4.184206485748291
Epoch: 7, Steps: 154 | Train Loss: 0.959 Vali Loss: 1.885 Vali Acc: 0.447 Test Loss: 1.885 Test Acc: 0.447
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6107148
	speed: 0.1150s/iter; left time: 1635.4666s
Epoch: 8 cost time: 4.043632984161377
Epoch: 8, Steps: 154 | Train Loss: 0.910 Vali Loss: 1.710 Vali Acc: 0.537 Test Loss: 1.710 Test Acc: 0.537
Validation loss decreased (-0.513365 --> -0.536885).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6975492
	speed: 0.1157s/iter; left time: 1628.1040s
Epoch: 9 cost time: 5.00221061706543
Epoch: 9, Steps: 154 | Train Loss: 0.869 Vali Loss: 1.800 Vali Acc: 0.519 Test Loss: 1.800 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3940133
	speed: 0.1080s/iter; left time: 1503.3025s
Epoch: 10 cost time: 4.437376260757446
Epoch: 10, Steps: 154 | Train Loss: 0.784 Vali Loss: 2.063 Vali Acc: 0.514 Test Loss: 2.063 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.9192195
	speed: 0.1229s/iter; left time: 1691.8702s
Epoch: 11 cost time: 5.1618332862854
Epoch: 11, Steps: 154 | Train Loss: 0.750 Vali Loss: 2.029 Vali Acc: 0.478 Test Loss: 2.029 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4549587
	speed: 0.1291s/iter; left time: 1756.4325s
Epoch: 12 cost time: 5.797576665878296
Epoch: 12, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.163 Vali Acc: 0.491 Test Loss: 2.163 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2393487
	speed: 0.1256s/iter; left time: 1689.6463s
Epoch: 13 cost time: 5.189422369003296
Epoch: 13, Steps: 154 | Train Loss: 0.632 Vali Loss: 2.093 Vali Acc: 0.530 Test Loss: 2.093 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5779003
	speed: 0.1278s/iter; left time: 1699.4558s
Epoch: 14 cost time: 5.026841402053833
Epoch: 14, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.045 Vali Acc: 0.528 Test Loss: 2.045 Test Acc: 0.528
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6552759
	speed: 0.1290s/iter; left time: 1695.3751s
Epoch: 15 cost time: 5.421406030654907
Epoch: 15, Steps: 154 | Train Loss: 0.526 Vali Loss: 2.166 Vali Acc: 0.518 Test Loss: 2.166 Test Acc: 0.518
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.7666935
	speed: 0.1262s/iter; left time: 1639.6989s
Epoch: 16 cost time: 5.319711208343506
Epoch: 16, Steps: 154 | Train Loss: 0.533 Vali Loss: 2.276 Vali Acc: 0.475 Test Loss: 2.276 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.8237273
	speed: 0.1284s/iter; left time: 1648.8857s
Epoch: 17 cost time: 4.764980792999268
Epoch: 17, Steps: 154 | Train Loss: 0.477 Vali Loss: 2.371 Vali Acc: 0.504 Test Loss: 2.371 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.4486445
	speed: 0.1252s/iter; left time: 1588.3798s
Epoch: 18 cost time: 5.705213785171509
Epoch: 18, Steps: 154 | Train Loss: 0.441 Vali Loss: 2.505 Vali Acc: 0.494 Test Loss: 2.505 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5369018653690186
model parameter : 138318
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0780902
	speed: 0.0748s/iter; left time: 1143.7800s
Epoch: 1 cost time: 11.006099939346313
Epoch: 1, Steps: 154 | Train Loss: 1.970 Vali Loss: 1.854 Vali Acc: 0.435 Test Loss: 1.854 Test Acc: 0.435
Validation loss decreased (inf --> -0.434694).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2444999
	speed: 0.1716s/iter; left time: 2599.5752s
Epoch: 2 cost time: 9.518392324447632
Epoch: 2, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.327 Vali Acc: 0.433 Test Loss: 2.327 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5207552
	speed: 0.1743s/iter; left time: 2613.3786s
Epoch: 3 cost time: 10.262213706970215
Epoch: 3, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.490 Vali Acc: 0.489 Test Loss: 2.490 Test Acc: 0.489
Validation loss decreased (-0.434694 --> -0.489026).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6605985
	speed: 0.1773s/iter; left time: 2631.2619s
Epoch: 4 cost time: 10.511983871459961
Epoch: 4, Steps: 154 | Train Loss: 1.301 Vali Loss: 2.330 Vali Acc: 0.496 Test Loss: 2.330 Test Acc: 0.496
Validation loss decreased (-0.489026 --> -0.495516).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7139642
	speed: 0.1333s/iter; left time: 1957.8366s
Epoch: 5 cost time: 4.814934015274048
Epoch: 5, Steps: 154 | Train Loss: 1.159 Vali Loss: 2.228 Vali Acc: 0.513 Test Loss: 2.228 Test Acc: 0.513
Validation loss decreased (-0.495516 --> -0.512954).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0428221
	speed: 0.1129s/iter; left time: 1639.9161s
Epoch: 6 cost time: 6.0493693351745605
Epoch: 6, Steps: 154 | Train Loss: 1.083 Vali Loss: 2.463 Vali Acc: 0.524 Test Loss: 2.463 Test Acc: 0.524
Validation loss decreased (-0.512954 --> -0.523495).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2046902
	speed: 0.1279s/iter; left time: 1838.8683s
Epoch: 7 cost time: 6.570621728897095
Epoch: 7, Steps: 154 | Train Loss: 0.963 Vali Loss: 2.567 Vali Acc: 0.421 Test Loss: 2.567 Test Acc: 0.421
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5147860
	speed: 0.1204s/iter; left time: 1712.3249s
Epoch: 8 cost time: 6.14275050163269
Epoch: 8, Steps: 154 | Train Loss: 0.850 Vali Loss: 2.933 Vali Acc: 0.495 Test Loss: 2.933 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.4883854
	speed: 0.1254s/iter; left time: 1764.5238s
Epoch: 9 cost time: 5.3158278465271
Epoch: 9, Steps: 154 | Train Loss: 0.782 Vali Loss: 2.881 Vali Acc: 0.495 Test Loss: 2.881 Test Acc: 0.495
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2479723
	speed: 0.1270s/iter; left time: 1766.7975s
Epoch: 10 cost time: 6.21121072769165
Epoch: 10, Steps: 154 | Train Loss: 0.702 Vali Loss: 3.092 Vali Acc: 0.483 Test Loss: 3.092 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3520739
	speed: 0.1454s/iter; left time: 2001.2818s
Epoch: 11 cost time: 9.504028797149658
Epoch: 11, Steps: 154 | Train Loss: 0.635 Vali Loss: 3.260 Vali Acc: 0.539 Test Loss: 3.260 Test Acc: 0.539
Validation loss decreased (-0.523495 --> -0.538897).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4697653
	speed: 0.1589s/iter; left time: 2162.4567s
Epoch: 12 cost time: 8.904601097106934
Epoch: 12, Steps: 154 | Train Loss: 0.576 Vali Loss: 3.530 Vali Acc: 0.497 Test Loss: 3.530 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2262551
	speed: 0.1613s/iter; left time: 2170.5519s
Epoch: 13 cost time: 9.036659479141235
Epoch: 13, Steps: 154 | Train Loss: 0.500 Vali Loss: 3.686 Vali Acc: 0.526 Test Loss: 3.686 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3203118
	speed: 0.1597s/iter; left time: 2123.2267s
Epoch: 14 cost time: 9.478866577148438
Epoch: 14, Steps: 154 | Train Loss: 0.448 Vali Loss: 3.436 Vali Acc: 0.524 Test Loss: 3.436 Test Acc: 0.524
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.5985634
	speed: 0.1636s/iter; left time: 2151.1323s
Epoch: 15 cost time: 9.383544683456421
Epoch: 15, Steps: 154 | Train Loss: 0.443 Vali Loss: 3.317 Vali Acc: 0.521 Test Loss: 3.317 Test Acc: 0.521
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.4173892
	speed: 0.1543s/iter; left time: 2004.8931s
Epoch: 16 cost time: 8.717022895812988
Epoch: 16, Steps: 154 | Train Loss: 0.379 Vali Loss: 3.799 Vali Acc: 0.472 Test Loss: 3.799 Test Acc: 0.472
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.2297900
	speed: 0.1571s/iter; left time: 2017.0621s
Epoch: 17 cost time: 9.155012607574463
Epoch: 17, Steps: 154 | Train Loss: 0.370 Vali Loss: 3.892 Vali Acc: 0.486 Test Loss: 3.892 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2753482
	speed: 0.1562s/iter; left time: 1981.2038s
Epoch: 18 cost time: 9.259267330169678
Epoch: 18, Steps: 154 | Train Loss: 0.317 Vali Loss: 3.948 Vali Acc: 0.493 Test Loss: 3.948 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.3731060
	speed: 0.1618s/iter; left time: 2027.8115s
Epoch: 19 cost time: 9.442038536071777
Epoch: 19, Steps: 154 | Train Loss: 0.319 Vali Loss: 4.109 Vali Acc: 0.514 Test Loss: 4.109 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.2915316
	speed: 0.1546s/iter; left time: 1913.7669s
Epoch: 20 cost time: 8.753934860229492
Epoch: 20, Steps: 154 | Train Loss: 0.288 Vali Loss: 4.197 Vali Acc: 0.488 Test Loss: 4.197 Test Acc: 0.488
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.3472027
	speed: 0.1417s/iter; left time: 1731.8605s
Epoch: 21 cost time: 6.140565395355225
Epoch: 21, Steps: 154 | Train Loss: 0.243 Vali Loss: 4.812 Vali Acc: 0.448 Test Loss: 4.812 Test Acc: 0.448
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5389294403892944
model parameter : 260750
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5813420
	speed: 0.0389s/iter; left time: 595.5403s
Epoch: 1 cost time: 5.074902057647705
Epoch: 1, Steps: 154 | Train Loss: 2.015 Vali Loss: 1.992 Vali Acc: 0.405 Test Loss: 1.992 Test Acc: 0.405
Validation loss decreased (inf --> -0.405090).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9961323
	speed: 0.0882s/iter; left time: 1335.2159s
Epoch: 2 cost time: 3.917673110961914
Epoch: 2, Steps: 154 | Train Loss: 1.384 Vali Loss: 1.764 Vali Acc: 0.491 Test Loss: 1.764 Test Acc: 0.491
Validation loss decreased (-0.405090 --> -0.490656).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2993531
	speed: 0.0968s/iter; left time: 1451.7371s
Epoch: 3 cost time: 3.720226287841797
Epoch: 3, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.090 Vali Acc: 0.492 Test Loss: 2.090 Test Acc: 0.492
Validation loss decreased (-0.490656 --> -0.492274).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6277600
	speed: 0.0962s/iter; left time: 1426.7832s
Epoch: 4 cost time: 3.699284076690674
Epoch: 4, Steps: 154 | Train Loss: 1.126 Vali Loss: 1.848 Vali Acc: 0.521 Test Loss: 1.848 Test Acc: 0.521
Validation loss decreased (-0.492274 --> -0.521474).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8474956
	speed: 0.0994s/iter; left time: 1460.2508s
Epoch: 5 cost time: 4.386713743209839
Epoch: 5, Steps: 154 | Train Loss: 1.062 Vali Loss: 1.966 Vali Acc: 0.515 Test Loss: 1.966 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0339061
	speed: 0.1116s/iter; left time: 1621.6762s
Epoch: 6 cost time: 4.716592073440552
Epoch: 6, Steps: 154 | Train Loss: 0.983 Vali Loss: 2.095 Vali Acc: 0.490 Test Loss: 2.095 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2869895
	speed: 0.1133s/iter; left time: 1628.4253s
Epoch: 7 cost time: 4.8805036544799805
Epoch: 7, Steps: 154 | Train Loss: 0.901 Vali Loss: 2.368 Vali Acc: 0.483 Test Loss: 2.368 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8664101
	speed: 0.1127s/iter; left time: 1602.4587s
Epoch: 8 cost time: 5.00153923034668
Epoch: 8, Steps: 154 | Train Loss: 0.848 Vali Loss: 2.502 Vali Acc: 0.502 Test Loss: 2.502 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9350069
	speed: 0.1136s/iter; left time: 1598.5578s
Epoch: 9 cost time: 5.037971258163452
Epoch: 9, Steps: 154 | Train Loss: 0.782 Vali Loss: 2.398 Vali Acc: 0.479 Test Loss: 2.398 Test Acc: 0.479
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3703197
	speed: 0.1136s/iter; left time: 1580.8111s
Epoch: 10 cost time: 4.972980260848999
Epoch: 10, Steps: 154 | Train Loss: 0.692 Vali Loss: 2.576 Vali Acc: 0.486 Test Loss: 2.576 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6307825
	speed: 0.1172s/iter; left time: 1613.1375s
Epoch: 11 cost time: 5.078341484069824
Epoch: 11, Steps: 154 | Train Loss: 0.645 Vali Loss: 2.650 Vali Acc: 0.445 Test Loss: 2.650 Test Acc: 0.445
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6454263
	speed: 0.1130s/iter; left time: 1537.7712s
Epoch: 12 cost time: 4.916675090789795
Epoch: 12, Steps: 154 | Train Loss: 0.576 Vali Loss: 2.465 Vali Acc: 0.556 Test Loss: 2.465 Test Acc: 0.556
Validation loss decreased (-0.521474 --> -0.556342).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1821740
	speed: 0.1090s/iter; left time: 1465.9068s
Epoch: 13 cost time: 4.5549938678741455
Epoch: 13, Steps: 154 | Train Loss: 0.557 Vali Loss: 2.643 Vali Acc: 0.499 Test Loss: 2.643 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7017113
	speed: 0.1107s/iter; left time: 1472.3002s
Epoch: 14 cost time: 4.865401983261108
Epoch: 14, Steps: 154 | Train Loss: 0.478 Vali Loss: 2.887 Vali Acc: 0.482 Test Loss: 2.887 Test Acc: 0.482
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.4541667
	speed: 0.1114s/iter; left time: 1464.5171s
Epoch: 15 cost time: 4.740535020828247
Epoch: 15, Steps: 154 | Train Loss: 0.430 Vali Loss: 2.854 Vali Acc: 0.500 Test Loss: 2.854 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4669489
	speed: 0.1123s/iter; left time: 1458.6973s
Epoch: 16 cost time: 4.797756671905518
Epoch: 16, Steps: 154 | Train Loss: 0.438 Vali Loss: 2.916 Vali Acc: 0.483 Test Loss: 2.916 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0336877
	speed: 0.1118s/iter; left time: 1435.2364s
Epoch: 17 cost time: 4.666123628616333
Epoch: 17, Steps: 154 | Train Loss: 0.350 Vali Loss: 3.074 Vali Acc: 0.515 Test Loss: 3.074 Test Acc: 0.515
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.3548453
	speed: 0.1100s/iter; left time: 1394.9715s
Epoch: 18 cost time: 4.5859880447387695
Epoch: 18, Steps: 154 | Train Loss: 0.334 Vali Loss: 2.952 Vali Acc: 0.519 Test Loss: 2.952 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.5727154
	speed: 0.1058s/iter; left time: 1324.9549s
Epoch: 19 cost time: 4.48124098777771
Epoch: 19, Steps: 154 | Train Loss: 0.369 Vali Loss: 3.088 Vali Acc: 0.513 Test Loss: 3.088 Test Acc: 0.513
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.3906741
	speed: 0.1078s/iter; left time: 1333.4747s
Epoch: 20 cost time: 4.1380884647369385
Epoch: 20, Steps: 154 | Train Loss: 0.317 Vali Loss: 3.472 Vali Acc: 0.429 Test Loss: 3.472 Test Acc: 0.429
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1261451
	speed: 0.1005s/iter; left time: 1228.3932s
Epoch: 21 cost time: 3.933675527572632
Epoch: 21, Steps: 154 | Train Loss: 0.270 Vali Loss: 3.537 Vali Acc: 0.517 Test Loss: 3.537 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.4830256
	speed: 0.1003s/iter; left time: 1210.5498s
Epoch: 22 cost time: 3.836540699005127
Epoch: 22, Steps: 154 | Train Loss: 0.261 Vali Loss: 3.657 Vali Acc: 0.506 Test Loss: 3.657 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5563665855636658
model parameter : 164046
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8555024
	speed: 0.0386s/iter; left time: 590.7906s
Epoch: 1 cost time: 5.064800262451172
Epoch: 1, Steps: 154 | Train Loss: 1.973 Vali Loss: 1.864 Vali Acc: 0.380 Test Loss: 1.864 Test Acc: 0.380
Validation loss decreased (inf --> -0.379543).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5736263
	speed: 0.0957s/iter; left time: 1449.2878s
Epoch: 2 cost time: 3.7057878971099854
Epoch: 2, Steps: 154 | Train Loss: 1.411 Vali Loss: 1.835 Vali Acc: 0.457 Test Loss: 1.835 Test Acc: 0.457
Validation loss decreased (-0.379543 --> -0.457403).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5193663
	speed: 0.0952s/iter; left time: 1427.7651s
Epoch: 3 cost time: 4.0288379192352295
Epoch: 3, Steps: 154 | Train Loss: 1.242 Vali Loss: 1.807 Vali Acc: 0.453 Test Loss: 1.807 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0526916
	speed: 0.1094s/iter; left time: 1623.3696s
Epoch: 4 cost time: 4.520951747894287
Epoch: 4, Steps: 154 | Train Loss: 1.139 Vali Loss: 2.088 Vali Acc: 0.489 Test Loss: 2.088 Test Acc: 0.489
Validation loss decreased (-0.457403 --> -0.488625).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5220498
	speed: 0.1098s/iter; left time: 1612.8600s
Epoch: 5 cost time: 4.7707788944244385
Epoch: 5, Steps: 154 | Train Loss: 1.051 Vali Loss: 1.982 Vali Acc: 0.515 Test Loss: 1.982 Test Acc: 0.515
Validation loss decreased (-0.488625 --> -0.514579).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9396188
	speed: 0.1125s/iter; left time: 1634.2815s
Epoch: 6 cost time: 4.850949048995972
Epoch: 6, Steps: 154 | Train Loss: 0.993 Vali Loss: 2.140 Vali Acc: 0.492 Test Loss: 2.140 Test Acc: 0.492
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8725836
	speed: 0.1100s/iter; left time: 1582.0413s
Epoch: 7 cost time: 4.65288519859314
Epoch: 7, Steps: 154 | Train Loss: 0.920 Vali Loss: 2.162 Vali Acc: 0.523 Test Loss: 2.162 Test Acc: 0.523
Validation loss decreased (-0.514579 --> -0.523093).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9180065
	speed: 0.1112s/iter; left time: 1581.6200s
Epoch: 8 cost time: 4.678309202194214
Epoch: 8, Steps: 154 | Train Loss: 0.825 Vali Loss: 2.250 Vali Acc: 0.503 Test Loss: 2.250 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4270962
	speed: 0.1107s/iter; left time: 1558.0405s
Epoch: 9 cost time: 4.603888511657715
Epoch: 9, Steps: 154 | Train Loss: 0.749 Vali Loss: 2.751 Vali Acc: 0.496 Test Loss: 2.751 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.3186506
	speed: 0.1108s/iter; left time: 1541.7616s
Epoch: 10 cost time: 4.842873573303223
Epoch: 10, Steps: 154 | Train Loss: 0.672 Vali Loss: 2.815 Vali Acc: 0.502 Test Loss: 2.815 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8421534
	speed: 0.1107s/iter; left time: 1523.6726s
Epoch: 11 cost time: 4.485623836517334
Epoch: 11, Steps: 154 | Train Loss: 0.662 Vali Loss: 2.602 Vali Acc: 0.507 Test Loss: 2.602 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3499225
	speed: 0.1102s/iter; left time: 1499.0522s
Epoch: 12 cost time: 4.7500550746917725
Epoch: 12, Steps: 154 | Train Loss: 0.562 Vali Loss: 2.652 Vali Acc: 0.498 Test Loss: 2.652 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.4846297
	speed: 0.1124s/iter; left time: 1512.0133s
Epoch: 13 cost time: 4.876266002655029
Epoch: 13, Steps: 154 | Train Loss: 0.510 Vali Loss: 2.538 Vali Acc: 0.534 Test Loss: 2.538 Test Acc: 0.534
Validation loss decreased (-0.523093 --> -0.534038).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3209960
	speed: 0.1120s/iter; left time: 1489.5598s
Epoch: 14 cost time: 4.909789562225342
Epoch: 14, Steps: 154 | Train Loss: 0.471 Vali Loss: 2.657 Vali Acc: 0.534 Test Loss: 2.657 Test Acc: 0.534
Validation loss decreased (-0.534038 --> -0.534442).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5952560
	speed: 0.1139s/iter; left time: 1497.7743s
Epoch: 15 cost time: 4.664809942245483
Epoch: 15, Steps: 154 | Train Loss: 0.428 Vali Loss: 2.899 Vali Acc: 0.536 Test Loss: 2.899 Test Acc: 0.536
Validation loss decreased (-0.534442 --> -0.535656).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2685021
	speed: 0.1137s/iter; left time: 1476.6432s
Epoch: 16 cost time: 4.995734930038452
Epoch: 16, Steps: 154 | Train Loss: 0.409 Vali Loss: 2.865 Vali Acc: 0.526 Test Loss: 2.865 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2849844
	speed: 0.1132s/iter; left time: 1452.5119s
Epoch: 17 cost time: 4.9424355030059814
Epoch: 17, Steps: 154 | Train Loss: 0.372 Vali Loss: 3.256 Vali Acc: 0.479 Test Loss: 3.256 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4918566
	speed: 0.1064s/iter; left time: 1349.8251s
Epoch: 18 cost time: 3.8299777507781982
Epoch: 18, Steps: 154 | Train Loss: 0.321 Vali Loss: 3.136 Vali Acc: 0.543 Test Loss: 3.136 Test Acc: 0.543
Validation loss decreased (-0.535656 --> -0.542548).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0237609
	speed: 0.0907s/iter; left time: 1136.3724s
Epoch: 19 cost time: 3.562772512435913
Epoch: 19, Steps: 154 | Train Loss: 0.315 Vali Loss: 3.127 Vali Acc: 0.524 Test Loss: 3.127 Test Acc: 0.524
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.3987556
	speed: 0.0902s/iter; left time: 1116.6327s
Epoch: 20 cost time: 3.6359329223632812
Epoch: 20, Steps: 154 | Train Loss: 0.287 Vali Loss: 3.227 Vali Acc: 0.562 Test Loss: 3.227 Test Acc: 0.562
Validation loss decreased (-0.542548 --> -0.562417).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1850301
	speed: 0.0966s/iter; left time: 1180.9232s
Epoch: 21 cost time: 3.956629991531372
Epoch: 21, Steps: 154 | Train Loss: 0.257 Vali Loss: 3.144 Vali Acc: 0.539 Test Loss: 3.144 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1593950
	speed: 0.1023s/iter; left time: 1235.0126s
Epoch: 22 cost time: 4.019577264785767
Epoch: 22, Steps: 154 | Train Loss: 0.256 Vali Loss: 3.928 Vali Acc: 0.488 Test Loss: 3.928 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0623519
	speed: 0.0994s/iter; left time: 1183.9791s
Epoch: 23 cost time: 3.9709393978118896
Epoch: 23, Steps: 154 | Train Loss: 0.260 Vali Loss: 3.680 Vali Acc: 0.512 Test Loss: 3.680 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2131057
	speed: 0.0992s/iter; left time: 1166.1819s
Epoch: 24 cost time: 3.92026424407959
Epoch: 24, Steps: 154 | Train Loss: 0.233 Vali Loss: 3.516 Vali Acc: 0.545 Test Loss: 3.516 Test Acc: 0.545
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1595200
	speed: 0.1149s/iter; left time: 1333.1348s
Epoch: 25 cost time: 4.656601190567017
Epoch: 25, Steps: 154 | Train Loss: 0.219 Vali Loss: 3.447 Vali Acc: 0.524 Test Loss: 3.447 Test Acc: 0.524
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.4249960
	speed: 0.1162s/iter; left time: 1330.9829s
Epoch: 26 cost time: 4.7966063022613525
Epoch: 26, Steps: 154 | Train Loss: 0.233 Vali Loss: 4.019 Vali Acc: 0.555 Test Loss: 4.019 Test Acc: 0.555
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.1564825
	speed: 0.1138s/iter; left time: 1285.2432s
Epoch: 27 cost time: 4.4725501537323
Epoch: 27, Steps: 154 | Train Loss: 0.212 Vali Loss: 3.639 Vali Acc: 0.524 Test Loss: 3.639 Test Acc: 0.524
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.1093226
	speed: 0.1116s/iter; left time: 1243.2884s
Epoch: 28 cost time: 4.606719732284546
Epoch: 28, Steps: 154 | Train Loss: 0.175 Vali Loss: 3.721 Vali Acc: 0.545 Test Loss: 3.721 Test Acc: 0.545
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0238416
	speed: 0.1128s/iter; left time: 1239.9080s
Epoch: 29 cost time: 4.717152118682861
Epoch: 29, Steps: 154 | Train Loss: 0.156 Vali Loss: 4.301 Vali Acc: 0.491 Test Loss: 4.301 Test Acc: 0.491
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0359808
	speed: 0.1116s/iter; left time: 1208.6450s
Epoch: 30 cost time: 4.7625837326049805
Epoch: 30, Steps: 154 | Train Loss: 0.177 Vali Loss: 4.071 Vali Acc: 0.502 Test Loss: 4.071 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5624493106244931
model parameter : 164110
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8493046
	speed: 0.0417s/iter; left time: 638.0192s
Epoch: 1 cost time: 5.551574230194092
Epoch: 1, Steps: 154 | Train Loss: 2.108 Vali Loss: 1.763 Vali Acc: 0.430 Test Loss: 1.763 Test Acc: 0.430
Validation loss decreased (inf --> -0.429828).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1497902
	speed: 0.1085s/iter; left time: 1642.9569s
Epoch: 2 cost time: 4.72369122505188
Epoch: 2, Steps: 154 | Train Loss: 1.437 Vali Loss: 1.849 Vali Acc: 0.483 Test Loss: 1.849 Test Acc: 0.483
Validation loss decreased (-0.429828 --> -0.482544).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9550376
	speed: 0.1074s/iter; left time: 1610.2888s
Epoch: 3 cost time: 4.444531440734863
Epoch: 3, Steps: 154 | Train Loss: 1.215 Vali Loss: 1.937 Vali Acc: 0.497 Test Loss: 1.937 Test Acc: 0.497
Validation loss decreased (-0.482544 --> -0.496737).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9497024
	speed: 0.1040s/iter; left time: 1543.4852s
Epoch: 4 cost time: 4.401201248168945
Epoch: 4, Steps: 154 | Train Loss: 1.120 Vali Loss: 1.978 Vali Acc: 0.502 Test Loss: 1.978 Test Acc: 0.502
Validation loss decreased (-0.496737 --> -0.501602).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1083889
	speed: 0.1052s/iter; left time: 1545.4938s
Epoch: 5 cost time: 4.317958354949951
Epoch: 5, Steps: 154 | Train Loss: 1.051 Vali Loss: 1.912 Vali Acc: 0.524 Test Loss: 1.912 Test Acc: 0.524
Validation loss decreased (-0.501602 --> -0.524312).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3767277
	speed: 0.1073s/iter; left time: 1559.3066s
Epoch: 6 cost time: 4.432624578475952
Epoch: 6, Steps: 154 | Train Loss: 0.984 Vali Loss: 1.797 Vali Acc: 0.512 Test Loss: 1.797 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0954121
	speed: 0.0974s/iter; left time: 1400.2156s
Epoch: 7 cost time: 3.606825113296509
Epoch: 7, Steps: 154 | Train Loss: 0.945 Vali Loss: 2.386 Vali Acc: 0.489 Test Loss: 2.386 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6584170
	speed: 0.0969s/iter; left time: 1378.0358s
Epoch: 8 cost time: 3.7429354190826416
Epoch: 8, Steps: 154 | Train Loss: 0.870 Vali Loss: 2.371 Vali Acc: 0.510 Test Loss: 2.371 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6543600
	speed: 0.0961s/iter; left time: 1351.9454s
Epoch: 9 cost time: 3.8559768199920654
Epoch: 9, Steps: 154 | Train Loss: 0.804 Vali Loss: 2.265 Vali Acc: 0.474 Test Loss: 2.265 Test Acc: 0.474
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.8615384
	speed: 0.0945s/iter; left time: 1315.1685s
Epoch: 10 cost time: 3.7563867568969727
Epoch: 10, Steps: 154 | Train Loss: 0.752 Vali Loss: 2.063 Vali Acc: 0.540 Test Loss: 2.063 Test Acc: 0.540
Validation loss decreased (-0.524312 --> -0.539720).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2240861
	speed: 0.0949s/iter; left time: 1305.9473s
Epoch: 11 cost time: 3.612431764602661
Epoch: 11, Steps: 154 | Train Loss: 0.651 Vali Loss: 2.502 Vali Acc: 0.480 Test Loss: 2.502 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.4976784
	speed: 0.0972s/iter; left time: 1322.2137s
Epoch: 12 cost time: 3.764418125152588
Epoch: 12, Steps: 154 | Train Loss: 0.586 Vali Loss: 2.258 Vali Acc: 0.468 Test Loss: 2.258 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.8488781
	speed: 0.0913s/iter; left time: 1227.9918s
Epoch: 13 cost time: 3.7580883502960205
Epoch: 13, Steps: 154 | Train Loss: 0.553 Vali Loss: 2.333 Vali Acc: 0.537 Test Loss: 2.333 Test Acc: 0.537
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7718629
	speed: 0.1051s/iter; left time: 1398.2710s
Epoch: 14 cost time: 4.383723974227905
Epoch: 14, Steps: 154 | Train Loss: 0.523 Vali Loss: 2.556 Vali Acc: 0.524 Test Loss: 2.556 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.3914852
	speed: 0.1088s/iter; left time: 1430.2979s
Epoch: 15 cost time: 4.607000827789307
Epoch: 15, Steps: 154 | Train Loss: 0.525 Vali Loss: 2.633 Vali Acc: 0.494 Test Loss: 2.633 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.8238770
	speed: 0.1049s/iter; left time: 1362.9714s
Epoch: 16 cost time: 4.554593086242676
Epoch: 16, Steps: 154 | Train Loss: 0.432 Vali Loss: 2.846 Vali Acc: 0.515 Test Loss: 2.846 Test Acc: 0.515
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1327589
	speed: 0.1071s/iter; left time: 1374.4367s
Epoch: 17 cost time: 4.258941173553467
Epoch: 17, Steps: 154 | Train Loss: 0.393 Vali Loss: 2.566 Vali Acc: 0.528 Test Loss: 2.566 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.2123503
	speed: 0.1053s/iter; left time: 1335.6436s
Epoch: 18 cost time: 4.571375846862793
Epoch: 18, Steps: 154 | Train Loss: 0.404 Vali Loss: 2.822 Vali Acc: 0.541 Test Loss: 2.822 Test Acc: 0.541
Validation loss decreased (-0.539720 --> -0.540523).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3433491
	speed: 0.1065s/iter; left time: 1334.6366s
Epoch: 19 cost time: 4.522265434265137
Epoch: 19, Steps: 154 | Train Loss: 0.347 Vali Loss: 2.764 Vali Acc: 0.503 Test Loss: 2.764 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1692173
	speed: 0.1066s/iter; left time: 1319.1443s
Epoch: 20 cost time: 4.344910383224487
Epoch: 20, Steps: 154 | Train Loss: 0.306 Vali Loss: 2.792 Vali Acc: 0.525 Test Loss: 2.792 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.6715755
	speed: 0.1102s/iter; left time: 1346.7799s
Epoch: 21 cost time: 4.539527416229248
Epoch: 21, Steps: 154 | Train Loss: 0.305 Vali Loss: 3.234 Vali Acc: 0.536 Test Loss: 3.234 Test Acc: 0.536
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1447970
	speed: 0.1087s/iter; left time: 1312.0438s
Epoch: 22 cost time: 4.446556329727173
Epoch: 22, Steps: 154 | Train Loss: 0.300 Vali Loss: 2.933 Vali Acc: 0.512 Test Loss: 2.933 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0108231
	speed: 0.1093s/iter; left time: 1301.6815s
Epoch: 23 cost time: 4.303147792816162
Epoch: 23, Steps: 154 | Train Loss: 0.284 Vali Loss: 3.101 Vali Acc: 0.510 Test Loss: 3.101 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.2263835
	speed: 0.1038s/iter; left time: 1220.7594s
Epoch: 24 cost time: 4.133442163467407
Epoch: 24, Steps: 154 | Train Loss: 0.245 Vali Loss: 3.331 Vali Acc: 0.508 Test Loss: 3.331 Test Acc: 0.508
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1528489
	speed: 0.0983s/iter; left time: 1140.7248s
Epoch: 25 cost time: 4.203392028808594
Epoch: 25, Steps: 154 | Train Loss: 0.245 Vali Loss: 3.234 Vali Acc: 0.544 Test Loss: 3.234 Test Acc: 0.544
Validation loss decreased (-0.540523 --> -0.544169).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0452173
	speed: 0.1025s/iter; left time: 1173.9590s
Epoch: 26 cost time: 4.199526786804199
Epoch: 26, Steps: 154 | Train Loss: 0.213 Vali Loss: 3.286 Vali Acc: 0.526 Test Loss: 3.286 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.3298168
	speed: 0.0963s/iter; left time: 1088.1071s
Epoch: 27 cost time: 3.5777854919433594
Epoch: 27, Steps: 154 | Train Loss: 0.239 Vali Loss: 3.573 Vali Acc: 0.513 Test Loss: 3.573 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.4082777
	speed: 0.0981s/iter; left time: 1093.0274s
Epoch: 28 cost time: 3.6973354816436768
Epoch: 28, Steps: 154 | Train Loss: 0.194 Vali Loss: 3.504 Vali Acc: 0.509 Test Loss: 3.504 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0266802
	speed: 0.0936s/iter; left time: 1028.1550s
Epoch: 29 cost time: 3.7121639251708984
Epoch: 29, Steps: 154 | Train Loss: 0.212 Vali Loss: 3.679 Vali Acc: 0.521 Test Loss: 3.679 Test Acc: 0.521
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0368893
	speed: 0.0933s/iter; left time: 1010.7859s
Epoch: 30 cost time: 3.3475730419158936
Epoch: 30, Steps: 154 | Train Loss: 0.203 Vali Loss: 3.230 Vali Acc: 0.516 Test Loss: 3.230 Test Acc: 0.516
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.3131375
	speed: 0.0937s/iter; left time: 1000.9578s
Epoch: 31 cost time: 3.7381765842437744
Epoch: 31, Steps: 154 | Train Loss: 0.184 Vali Loss: 3.770 Vali Acc: 0.503 Test Loss: 3.770 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.1278948
	speed: 0.0927s/iter; left time: 975.7525s
Epoch: 32 cost time: 3.7535946369171143
Epoch: 32, Steps: 154 | Train Loss: 0.191 Vali Loss: 3.479 Vali Acc: 0.490 Test Loss: 3.479 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0427996
	speed: 0.0925s/iter; left time: 959.9568s
Epoch: 33 cost time: 3.7344367504119873
Epoch: 33, Steps: 154 | Train Loss: 0.152 Vali Loss: 3.672 Vali Acc: 0.504 Test Loss: 3.672 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.1117677
	speed: 0.1051s/iter; left time: 1073.6756s
Epoch: 34 cost time: 4.460027694702148
Epoch: 34, Steps: 154 | Train Loss: 0.165 Vali Loss: 4.072 Vali Acc: 0.505 Test Loss: 4.072 Test Acc: 0.505
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.4444006
	speed: 0.1035s/iter; left time: 1041.7871s
Epoch: 35 cost time: 4.261192083358765
Epoch: 35, Steps: 154 | Train Loss: 0.160 Vali Loss: 3.811 Vali Acc: 0.503 Test Loss: 3.811 Test Acc: 0.503
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5442011354420113
model parameter : 131982
model size : 1.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3861489
	speed: 0.0415s/iter; left time: 634.2829s
Epoch: 1 cost time: 5.556018114089966
Epoch: 1, Steps: 154 | Train Loss: 2.195 Vali Loss: 1.887 Vali Acc: 0.410 Test Loss: 1.887 Test Acc: 0.410
Validation loss decreased (inf --> -0.409957).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6341650
	speed: 0.1008s/iter; left time: 1526.3869s
Epoch: 2 cost time: 4.131133556365967
Epoch: 2, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.036 Vali Acc: 0.446 Test Loss: 2.036 Test Acc: 0.446
Validation loss decreased (-0.409957 --> -0.446452).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1685872
	speed: 0.1007s/iter; left time: 1510.4127s
Epoch: 3 cost time: 4.167623043060303
Epoch: 3, Steps: 154 | Train Loss: 1.217 Vali Loss: 2.234 Vali Acc: 0.451 Test Loss: 2.234 Test Acc: 0.451
Validation loss decreased (-0.446452 --> -0.450505).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0778702
	speed: 0.1043s/iter; left time: 1548.1714s
Epoch: 4 cost time: 4.175089359283447
Epoch: 4, Steps: 154 | Train Loss: 1.172 Vali Loss: 2.407 Vali Acc: 0.437 Test Loss: 2.407 Test Acc: 0.437
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0750302
	speed: 0.1038s/iter; left time: 1524.1505s
Epoch: 5 cost time: 4.402794361114502
Epoch: 5, Steps: 154 | Train Loss: 1.079 Vali Loss: 2.131 Vali Acc: 0.475 Test Loss: 2.131 Test Acc: 0.475
Validation loss decreased (-0.450505 --> -0.474837).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9151303
	speed: 0.1061s/iter; left time: 1542.4101s
Epoch: 6 cost time: 4.122020959854126
Epoch: 6, Steps: 154 | Train Loss: 1.018 Vali Loss: 1.780 Vali Acc: 0.460 Test Loss: 1.780 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9269534
	speed: 0.0970s/iter; left time: 1394.0197s
Epoch: 7 cost time: 3.993647575378418
Epoch: 7, Steps: 154 | Train Loss: 0.955 Vali Loss: 2.245 Vali Acc: 0.463 Test Loss: 2.245 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2136549
	speed: 0.1202s/iter; left time: 1709.2235s
Epoch: 8 cost time: 5.61944842338562
Epoch: 8, Steps: 154 | Train Loss: 0.885 Vali Loss: 1.988 Vali Acc: 0.479 Test Loss: 1.988 Test Acc: 0.479
Validation loss decreased (-0.474837 --> -0.479299).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0606358
	speed: 0.1211s/iter; left time: 1704.0160s
Epoch: 9 cost time: 4.829118251800537
Epoch: 9, Steps: 154 | Train Loss: 0.825 Vali Loss: 1.864 Vali Acc: 0.511 Test Loss: 1.864 Test Acc: 0.511
Validation loss decreased (-0.479299 --> -0.510930).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9580954
	speed: 0.1277s/iter; left time: 1777.5908s
Epoch: 10 cost time: 5.585207223892212
Epoch: 10, Steps: 154 | Train Loss: 0.736 Vali Loss: 2.113 Vali Acc: 0.493 Test Loss: 2.113 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5967221
	speed: 0.1118s/iter; left time: 1537.8808s
Epoch: 11 cost time: 3.660538673400879
Epoch: 11, Steps: 154 | Train Loss: 0.693 Vali Loss: 2.179 Vali Acc: 0.482 Test Loss: 2.179 Test Acc: 0.482
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7134308
	speed: 0.1134s/iter; left time: 1542.9468s
Epoch: 12 cost time: 4.800418376922607
Epoch: 12, Steps: 154 | Train Loss: 0.609 Vali Loss: 2.014 Vali Acc: 0.505 Test Loss: 2.014 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2353886
	speed: 0.1062s/iter; left time: 1428.7641s
Epoch: 13 cost time: 4.153104066848755
Epoch: 13, Steps: 154 | Train Loss: 0.573 Vali Loss: 2.204 Vali Acc: 0.541 Test Loss: 2.204 Test Acc: 0.541
Validation loss decreased (-0.510930 --> -0.540935).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6472970
	speed: 0.1179s/iter; left time: 1567.5525s
Epoch: 14 cost time: 4.742477178573608
Epoch: 14, Steps: 154 | Train Loss: 0.582 Vali Loss: 2.549 Vali Acc: 0.469 Test Loss: 2.549 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4049903
	speed: 0.1081s/iter; left time: 1421.5904s
Epoch: 15 cost time: 4.715134382247925
Epoch: 15, Steps: 154 | Train Loss: 0.511 Vali Loss: 2.247 Vali Acc: 0.552 Test Loss: 2.247 Test Acc: 0.552
Validation loss decreased (-0.540935 --> -0.552289).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4796535
	speed: 0.1188s/iter; left time: 1543.3133s
Epoch: 16 cost time: 4.317837476730347
Epoch: 16, Steps: 154 | Train Loss: 0.462 Vali Loss: 2.275 Vali Acc: 0.459 Test Loss: 2.275 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6697986
	speed: 0.1115s/iter; left time: 1431.7364s
Epoch: 17 cost time: 4.56883692741394
Epoch: 17, Steps: 154 | Train Loss: 0.431 Vali Loss: 2.344 Vali Acc: 0.487 Test Loss: 2.344 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.4375715
	speed: 0.1104s/iter; left time: 1400.2510s
Epoch: 18 cost time: 4.712307929992676
Epoch: 18, Steps: 154 | Train Loss: 0.409 Vali Loss: 2.552 Vali Acc: 0.501 Test Loss: 2.552 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2006828
	speed: 0.1263s/iter; left time: 1582.1890s
Epoch: 19 cost time: 5.33548641204834
Epoch: 19, Steps: 154 | Train Loss: 0.398 Vali Loss: 2.293 Vali Acc: 0.524 Test Loss: 2.293 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2251519
	speed: 0.1203s/iter; left time: 1489.2932s
Epoch: 20 cost time: 4.610387325286865
Epoch: 20, Steps: 154 | Train Loss: 0.339 Vali Loss: 2.667 Vali Acc: 0.511 Test Loss: 2.667 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4133786
	speed: 0.1253s/iter; left time: 1531.3451s
Epoch: 21 cost time: 5.528175354003906
Epoch: 21, Steps: 154 | Train Loss: 0.336 Vali Loss: 2.468 Vali Acc: 0.539 Test Loss: 2.468 Test Acc: 0.539
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3322876
	speed: 0.1196s/iter; left time: 1442.9829s
Epoch: 22 cost time: 4.6287009716033936
Epoch: 22, Steps: 154 | Train Loss: 0.304 Vali Loss: 2.829 Vali Acc: 0.462 Test Loss: 2.829 Test Acc: 0.462
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3913624
	speed: 0.1224s/iter; left time: 1457.8305s
Epoch: 23 cost time: 5.169331312179565
Epoch: 23, Steps: 154 | Train Loss: 0.297 Vali Loss: 2.822 Vali Acc: 0.503 Test Loss: 2.822 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2854144
	speed: 0.1217s/iter; left time: 1430.6973s
Epoch: 24 cost time: 5.041089057922363
Epoch: 24, Steps: 154 | Train Loss: 0.281 Vali Loss: 2.848 Vali Acc: 0.480 Test Loss: 2.848 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.3183106
	speed: 0.1304s/iter; left time: 1513.8541s
Epoch: 25 cost time: 5.599144697189331
Epoch: 25, Steps: 154 | Train Loss: 0.277 Vali Loss: 2.972 Vali Acc: 0.490 Test Loss: 2.972 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5523114355231143
model parameter : 115982
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8038007
	speed: 0.0484s/iter; left time: 741.0412s
Epoch: 1 cost time: 6.427278280258179
Epoch: 1, Steps: 154 | Train Loss: 2.207 Vali Loss: 1.931 Vali Acc: 0.388 Test Loss: 1.931 Test Acc: 0.388
Validation loss decreased (inf --> -0.387653).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8492637
	speed: 0.1210s/iter; left time: 1832.8610s
Epoch: 2 cost time: 5.59963321685791
Epoch: 2, Steps: 154 | Train Loss: 1.559 Vali Loss: 1.980 Vali Acc: 0.445 Test Loss: 1.980 Test Acc: 0.445
Validation loss decreased (-0.387653 --> -0.445236).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9739172
	speed: 0.1279s/iter; left time: 1916.9166s
Epoch: 3 cost time: 5.245845556259155
Epoch: 3, Steps: 154 | Train Loss: 1.272 Vali Loss: 1.810 Vali Acc: 0.487 Test Loss: 1.810 Test Acc: 0.487
Validation loss decreased (-0.445236 --> -0.486600).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7318718
	speed: 0.1174s/iter; left time: 1741.9949s
Epoch: 4 cost time: 5.333435535430908
Epoch: 4, Steps: 154 | Train Loss: 1.179 Vali Loss: 2.054 Vali Acc: 0.466 Test Loss: 2.054 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6889267
	speed: 0.1237s/iter; left time: 1815.9783s
Epoch: 5 cost time: 4.977615833282471
Epoch: 5, Steps: 154 | Train Loss: 1.109 Vali Loss: 1.901 Vali Acc: 0.490 Test Loss: 1.901 Test Acc: 0.490
Validation loss decreased (-0.486600 --> -0.489843).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0468104
	speed: 0.1214s/iter; left time: 1764.4024s
Epoch: 6 cost time: 5.404160499572754
Epoch: 6, Steps: 154 | Train Loss: 1.035 Vali Loss: 2.005 Vali Acc: 0.482 Test Loss: 2.005 Test Acc: 0.482
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9130049
	speed: 0.1125s/iter; left time: 1616.6981s
Epoch: 7 cost time: 4.017363548278809
Epoch: 7, Steps: 154 | Train Loss: 0.960 Vali Loss: 1.869 Vali Acc: 0.490 Test Loss: 1.869 Test Acc: 0.490
Validation loss decreased (-0.489843 --> -0.490249).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0167679
	speed: 0.1077s/iter; left time: 1531.8715s
Epoch: 8 cost time: 4.4629762172698975
Epoch: 8, Steps: 154 | Train Loss: 0.921 Vali Loss: 2.164 Vali Acc: 0.502 Test Loss: 2.164 Test Acc: 0.502
Validation loss decreased (-0.490249 --> -0.501600).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7683547
	speed: 0.1061s/iter; left time: 1492.6118s
Epoch: 9 cost time: 3.7047314643859863
Epoch: 9, Steps: 154 | Train Loss: 0.855 Vali Loss: 2.366 Vali Acc: 0.427 Test Loss: 2.366 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1261809
	speed: 0.1101s/iter; left time: 1531.7802s
Epoch: 10 cost time: 4.107454299926758
Epoch: 10, Steps: 154 | Train Loss: 0.820 Vali Loss: 2.214 Vali Acc: 0.487 Test Loss: 2.214 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8062845
	speed: 0.1020s/iter; left time: 1404.1468s
Epoch: 11 cost time: 3.8369078636169434
Epoch: 11, Steps: 154 | Train Loss: 0.739 Vali Loss: 2.192 Vali Acc: 0.497 Test Loss: 2.192 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.6720572
	speed: 0.1149s/iter; left time: 1563.2544s
Epoch: 12 cost time: 4.527797698974609
Epoch: 12, Steps: 154 | Train Loss: 0.722 Vali Loss: 1.974 Vali Acc: 0.529 Test Loss: 1.974 Test Acc: 0.529
Validation loss decreased (-0.501600 --> -0.529177).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8184224
	speed: 0.1069s/iter; left time: 1437.8805s
Epoch: 13 cost time: 4.274244785308838
Epoch: 13, Steps: 154 | Train Loss: 0.654 Vali Loss: 2.023 Vali Acc: 0.506 Test Loss: 2.023 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7631058
	speed: 0.1181s/iter; left time: 1570.7191s
Epoch: 14 cost time: 5.156347751617432
Epoch: 14, Steps: 154 | Train Loss: 0.610 Vali Loss: 2.098 Vali Acc: 0.492 Test Loss: 2.098 Test Acc: 0.492
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1943192
	speed: 0.1191s/iter; left time: 1565.9917s
Epoch: 15 cost time: 5.469430685043335
Epoch: 15, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.194 Vali Acc: 0.534 Test Loss: 2.194 Test Acc: 0.534
Validation loss decreased (-0.529177 --> -0.534041).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7776464
	speed: 0.1266s/iter; left time: 1644.5251s
Epoch: 16 cost time: 5.014962911605835
Epoch: 16, Steps: 154 | Train Loss: 0.525 Vali Loss: 2.081 Vali Acc: 0.544 Test Loss: 2.081 Test Acc: 0.544
Validation loss decreased (-0.534041 --> -0.543775).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6037525
	speed: 0.1114s/iter; left time: 1430.6369s
Epoch: 17 cost time: 5.012384414672852
Epoch: 17, Steps: 154 | Train Loss: 0.484 Vali Loss: 2.215 Vali Acc: 0.538 Test Loss: 2.215 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.4296617
	speed: 0.1213s/iter; left time: 1538.7520s
Epoch: 18 cost time: 4.934422016143799
Epoch: 18, Steps: 154 | Train Loss: 0.470 Vali Loss: 2.551 Vali Acc: 0.498 Test Loss: 2.551 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4523896
	speed: 0.1158s/iter; left time: 1450.3480s
Epoch: 19 cost time: 5.2440855503082275
Epoch: 19, Steps: 154 | Train Loss: 0.434 Vali Loss: 2.255 Vali Acc: 0.489 Test Loss: 2.255 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.7913060
	speed: 0.1227s/iter; left time: 1518.1347s
Epoch: 20 cost time: 4.717102289199829
Epoch: 20, Steps: 154 | Train Loss: 0.391 Vali Loss: 2.360 Vali Acc: 0.522 Test Loss: 2.360 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.3488814
	speed: 0.1221s/iter; left time: 1492.4532s
Epoch: 21 cost time: 5.316971302032471
Epoch: 21, Steps: 154 | Train Loss: 0.333 Vali Loss: 2.751 Vali Acc: 0.499 Test Loss: 2.751 Test Acc: 0.499
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.2433224
	speed: 0.1223s/iter; left time: 1476.1208s
Epoch: 22 cost time: 4.64399528503418
Epoch: 22, Steps: 154 | Train Loss: 0.354 Vali Loss: 2.373 Vali Acc: 0.513 Test Loss: 2.373 Test Acc: 0.513
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.5835339
	speed: 0.1100s/iter; left time: 1310.9572s
Epoch: 23 cost time: 4.130098581314087
Epoch: 23, Steps: 154 | Train Loss: 0.320 Vali Loss: 2.775 Vali Acc: 0.495 Test Loss: 2.775 Test Acc: 0.495
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.4703673
	speed: 0.1087s/iter; left time: 1278.2162s
Epoch: 24 cost time: 4.6259191036224365
Epoch: 24, Steps: 154 | Train Loss: 0.298 Vali Loss: 2.594 Vali Acc: 0.533 Test Loss: 2.594 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2388695
	speed: 0.1136s/iter; left time: 1317.9647s
Epoch: 25 cost time: 4.543894290924072
Epoch: 25, Steps: 154 | Train Loss: 0.293 Vali Loss: 2.909 Vali Acc: 0.500 Test Loss: 2.909 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.1131001
	speed: 0.1120s/iter; left time: 1282.0914s
Epoch: 26 cost time: 4.560571908950806
Epoch: 26, Steps: 154 | Train Loss: 0.283 Vali Loss: 2.906 Vali Acc: 0.494 Test Loss: 2.906 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5437956204379562
model parameter : 105294
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0715139
	speed: 0.0494s/iter; left time: 755.8291s
Epoch: 1 cost time: 6.482681512832642
Epoch: 1, Steps: 154 | Train Loss: 2.030 Vali Loss: 1.838 Vali Acc: 0.429 Test Loss: 1.838 Test Acc: 0.429
Validation loss decreased (inf --> -0.429422).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7498497
	speed: 0.1246s/iter; left time: 1887.7822s
Epoch: 2 cost time: 7.079685926437378
Epoch: 2, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.161 Vali Acc: 0.524 Test Loss: 2.161 Test Acc: 0.524
Validation loss decreased (-0.429422 --> -0.523498).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6714367
	speed: 0.1264s/iter; left time: 1894.7506s
Epoch: 3 cost time: 6.639449834823608
Epoch: 3, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.385 Vali Acc: 0.507 Test Loss: 2.385 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1300400
	speed: 0.1178s/iter; left time: 1747.5660s
Epoch: 4 cost time: 5.464925289154053
Epoch: 4, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.184 Vali Acc: 0.468 Test Loss: 2.184 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4722711
	speed: 0.1156s/iter; left time: 1698.2006s
Epoch: 5 cost time: 6.132645606994629
Epoch: 5, Steps: 154 | Train Loss: 1.184 Vali Loss: 2.645 Vali Acc: 0.414 Test Loss: 2.645 Test Acc: 0.414
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.6189836
	speed: 0.1351s/iter; left time: 1963.5186s
Epoch: 6 cost time: 9.19968843460083
Epoch: 6, Steps: 154 | Train Loss: 1.041 Vali Loss: 2.679 Vali Acc: 0.459 Test Loss: 2.679 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.5741861
	speed: 0.1531s/iter; left time: 2201.4323s
Epoch: 7 cost time: 8.471477270126343
Epoch: 7, Steps: 154 | Train Loss: 0.998 Vali Loss: 2.628 Vali Acc: 0.502 Test Loss: 2.628 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.4948747
	speed: 0.1574s/iter; left time: 2238.3772s
Epoch: 8 cost time: 8.682810306549072
Epoch: 8, Steps: 154 | Train Loss: 0.890 Vali Loss: 2.721 Vali Acc: 0.486 Test Loss: 2.721 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.9571337
	speed: 0.1557s/iter; left time: 2190.5497s
Epoch: 9 cost time: 9.12416124343872
Epoch: 9, Steps: 154 | Train Loss: 0.796 Vali Loss: 3.068 Vali Acc: 0.442 Test Loss: 3.068 Test Acc: 0.442
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.3799495
	speed: 0.1538s/iter; left time: 2139.6189s
Epoch: 10 cost time: 9.023892879486084
Epoch: 10, Steps: 154 | Train Loss: 0.721 Vali Loss: 3.461 Vali Acc: 0.391 Test Loss: 3.461 Test Acc: 0.391
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.7650048
	speed: 0.1518s/iter; left time: 2088.2698s
Epoch: 11 cost time: 8.212891340255737
Epoch: 11, Steps: 154 | Train Loss: 0.653 Vali Loss: 3.333 Vali Acc: 0.532 Test Loss: 3.333 Test Acc: 0.532
Validation loss decreased (-0.523498 --> -0.532002).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4233787
	speed: 0.1555s/iter; left time: 2115.9263s
Epoch: 12 cost time: 8.885428428649902
Epoch: 12, Steps: 154 | Train Loss: 0.592 Vali Loss: 3.534 Vali Acc: 0.487 Test Loss: 3.534 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5477566
	speed: 0.1551s/iter; left time: 2086.7626s
Epoch: 13 cost time: 9.237976551055908
Epoch: 13, Steps: 154 | Train Loss: 0.507 Vali Loss: 3.446 Vali Acc: 0.444 Test Loss: 3.446 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0392051
	speed: 0.1602s/iter; left time: 2131.1351s
Epoch: 14 cost time: 9.333328008651733
Epoch: 14, Steps: 154 | Train Loss: 0.446 Vali Loss: 3.783 Vali Acc: 0.480 Test Loss: 3.783 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2440181
	speed: 0.1558s/iter; left time: 2048.4000s
Epoch: 15 cost time: 8.906745672225952
Epoch: 15, Steps: 154 | Train Loss: 0.431 Vali Loss: 3.890 Vali Acc: 0.464 Test Loss: 3.890 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1717845
	speed: 0.1589s/iter; left time: 2063.6901s
Epoch: 16 cost time: 9.226051092147827
Epoch: 16, Steps: 154 | Train Loss: 0.367 Vali Loss: 3.803 Vali Acc: 0.492 Test Loss: 3.803 Test Acc: 0.492
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.6699613
	speed: 0.1385s/iter; left time: 1777.5651s
Epoch: 17 cost time: 6.737120628356934
Epoch: 17, Steps: 154 | Train Loss: 0.330 Vali Loss: 3.977 Vali Acc: 0.502 Test Loss: 3.977 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0475208
	speed: 0.1236s/iter; left time: 1567.2473s
Epoch: 18 cost time: 6.120041370391846
Epoch: 18, Steps: 154 | Train Loss: 0.317 Vali Loss: 4.128 Vali Acc: 0.475 Test Loss: 4.128 Test Acc: 0.475
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2972902
	speed: 0.1191s/iter; left time: 1491.5910s
Epoch: 19 cost time: 4.691688299179077
Epoch: 19, Steps: 154 | Train Loss: 0.255 Vali Loss: 4.097 Vali Acc: 0.508 Test Loss: 4.097 Test Acc: 0.508
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.5160182
	speed: 0.1129s/iter; left time: 1397.6555s
Epoch: 20 cost time: 5.965170860290527
Epoch: 20, Steps: 154 | Train Loss: 0.299 Vali Loss: 4.581 Vali Acc: 0.534 Test Loss: 4.581 Test Acc: 0.534
Validation loss decreased (-0.532002 --> -0.533612).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3431889
	speed: 0.1200s/iter; left time: 1465.9314s
Epoch: 21 cost time: 5.377093076705933
Epoch: 21, Steps: 154 | Train Loss: 0.229 Vali Loss: 4.628 Vali Acc: 0.441 Test Loss: 4.628 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1800161
	speed: 0.1170s/iter; left time: 1411.4781s
Epoch: 22 cost time: 5.52553653717041
Epoch: 22, Steps: 154 | Train Loss: 0.202 Vali Loss: 4.653 Vali Acc: 0.449 Test Loss: 4.653 Test Acc: 0.449
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0592844
	speed: 0.1366s/iter; left time: 1627.0456s
Epoch: 23 cost time: 9.157656908035278
Epoch: 23, Steps: 154 | Train Loss: 0.244 Vali Loss: 4.832 Vali Acc: 0.445 Test Loss: 4.832 Test Acc: 0.445
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0479612
	speed: 0.1570s/iter; left time: 1846.7206s
Epoch: 24 cost time: 8.88552188873291
Epoch: 24, Steps: 154 | Train Loss: 0.188 Vali Loss: 4.872 Vali Acc: 0.461 Test Loss: 4.872 Test Acc: 0.461
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.3209896
	speed: 0.1515s/iter; left time: 1757.8045s
Epoch: 25 cost time: 8.170906066894531
Epoch: 25, Steps: 154 | Train Loss: 0.191 Vali Loss: 4.783 Vali Acc: 0.475 Test Loss: 4.783 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0121607
	speed: 0.1560s/iter; left time: 1786.2960s
Epoch: 26 cost time: 8.783979654312134
Epoch: 26, Steps: 154 | Train Loss: 0.166 Vali Loss: 5.455 Vali Acc: 0.483 Test Loss: 5.455 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0589691
	speed: 0.1495s/iter; left time: 1688.4539s
Epoch: 27 cost time: 8.598578929901123
Epoch: 27, Steps: 154 | Train Loss: 0.172 Vali Loss: 5.435 Vali Acc: 0.444 Test Loss: 5.435 Test Acc: 0.444
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.3537377
	speed: 0.1515s/iter; left time: 1688.0106s
Epoch: 28 cost time: 8.65899658203125
Epoch: 28, Steps: 154 | Train Loss: 0.174 Vali Loss: 5.258 Vali Acc: 0.481 Test Loss: 5.258 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.2873817
	speed: 0.1520s/iter; left time: 1670.5072s
Epoch: 29 cost time: 8.423695802688599
Epoch: 29, Steps: 154 | Train Loss: 0.151 Vali Loss: 4.879 Vali Acc: 0.500 Test Loss: 4.879 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0214251
	speed: 0.1533s/iter; left time: 1661.5170s
Epoch: 30 cost time: 8.996328592300415
Epoch: 30, Steps: 154 | Train Loss: 0.183 Vali Loss: 6.385 Vali Acc: 0.443 Test Loss: 6.385 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5336577453365775
model parameter : 244238
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3141897
	speed: 0.0441s/iter; left time: 675.4626s
Epoch: 1 cost time: 6.042435884475708
Epoch: 1, Steps: 154 | Train Loss: 2.017 Vali Loss: 1.992 Vali Acc: 0.408 Test Loss: 1.992 Test Acc: 0.408
Validation loss decreased (inf --> -0.408334).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4750892
	speed: 0.1145s/iter; left time: 1733.6907s
Epoch: 2 cost time: 4.864990472793579
Epoch: 2, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.195 Vali Acc: 0.402 Test Loss: 2.195 Test Acc: 0.402
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3026564
	speed: 0.1099s/iter; left time: 1647.2518s
Epoch: 3 cost time: 4.390291452407837
Epoch: 3, Steps: 154 | Train Loss: 1.253 Vali Loss: 1.827 Vali Acc: 0.484 Test Loss: 1.827 Test Acc: 0.484
Validation loss decreased (-0.408334 --> -0.484167).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8581038
	speed: 0.1015s/iter; left time: 1505.4738s
Epoch: 4 cost time: 4.052632570266724
Epoch: 4, Steps: 154 | Train Loss: 1.135 Vali Loss: 2.067 Vali Acc: 0.425 Test Loss: 2.067 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0752368
	speed: 0.0986s/iter; left time: 1447.3160s
Epoch: 5 cost time: 3.5173299312591553
Epoch: 5, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.983 Vali Acc: 0.473 Test Loss: 1.983 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7006562
	speed: 0.0893s/iter; left time: 1297.2222s
Epoch: 6 cost time: 3.411247491836548
Epoch: 6, Steps: 154 | Train Loss: 1.021 Vali Loss: 2.163 Vali Acc: 0.473 Test Loss: 2.163 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3092304
	speed: 0.0937s/iter; left time: 1347.6659s
Epoch: 7 cost time: 3.8933968544006348
Epoch: 7, Steps: 154 | Train Loss: 0.961 Vali Loss: 2.641 Vali Acc: 0.382 Test Loss: 2.641 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.1402855
	speed: 0.0974s/iter; left time: 1385.1544s
Epoch: 8 cost time: 3.662010908126831
Epoch: 8, Steps: 154 | Train Loss: 0.882 Vali Loss: 2.043 Vali Acc: 0.519 Test Loss: 2.043 Test Acc: 0.519
Validation loss decreased (-0.484167 --> -0.519444).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3177136
	speed: 0.0986s/iter; left time: 1386.7444s
Epoch: 9 cost time: 3.8335647583007812
Epoch: 9, Steps: 154 | Train Loss: 0.794 Vali Loss: 2.297 Vali Acc: 0.524 Test Loss: 2.297 Test Acc: 0.524
Validation loss decreased (-0.519444 --> -0.524308).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0672228
	speed: 0.0980s/iter; left time: 1363.5849s
Epoch: 10 cost time: 4.73287558555603
Epoch: 10, Steps: 154 | Train Loss: 0.708 Vali Loss: 2.321 Vali Acc: 0.509 Test Loss: 2.321 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5605183
	speed: 0.1125s/iter; left time: 1548.3800s
Epoch: 11 cost time: 4.8924572467803955
Epoch: 11, Steps: 154 | Train Loss: 0.660 Vali Loss: 2.450 Vali Acc: 0.515 Test Loss: 2.450 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.6288564
	speed: 0.1129s/iter; left time: 1536.8838s
Epoch: 12 cost time: 4.733078956604004
Epoch: 12, Steps: 154 | Train Loss: 0.611 Vali Loss: 2.445 Vali Acc: 0.531 Test Loss: 2.445 Test Acc: 0.531
Validation loss decreased (-0.524308 --> -0.531200).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5658826
	speed: 0.1095s/iter; left time: 1473.2520s
Epoch: 13 cost time: 4.578719139099121
Epoch: 13, Steps: 154 | Train Loss: 0.528 Vali Loss: 2.802 Vali Acc: 0.435 Test Loss: 2.802 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8099244
	speed: 0.1079s/iter; left time: 1434.9527s
Epoch: 14 cost time: 4.676155090332031
Epoch: 14, Steps: 154 | Train Loss: 0.505 Vali Loss: 2.757 Vali Acc: 0.501 Test Loss: 2.757 Test Acc: 0.501
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5674699
	speed: 0.1088s/iter; left time: 1429.9496s
Epoch: 15 cost time: 4.273092031478882
Epoch: 15, Steps: 154 | Train Loss: 0.437 Vali Loss: 3.051 Vali Acc: 0.452 Test Loss: 3.051 Test Acc: 0.452
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6769764
	speed: 0.1089s/iter; left time: 1414.2734s
Epoch: 16 cost time: 4.599461793899536
Epoch: 16, Steps: 154 | Train Loss: 0.418 Vali Loss: 2.948 Vali Acc: 0.502 Test Loss: 2.948 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.2565915
	speed: 0.1100s/iter; left time: 1412.1229s
Epoch: 17 cost time: 4.501530170440674
Epoch: 17, Steps: 154 | Train Loss: 0.387 Vali Loss: 2.885 Vali Acc: 0.533 Test Loss: 2.885 Test Acc: 0.533
Validation loss decreased (-0.531200 --> -0.532818).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2378422
	speed: 0.1098s/iter; left time: 1392.6419s
Epoch: 18 cost time: 4.646498680114746
Epoch: 18, Steps: 154 | Train Loss: 0.352 Vali Loss: 3.219 Vali Acc: 0.494 Test Loss: 3.219 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4839335
	speed: 0.1103s/iter; left time: 1381.8061s
Epoch: 19 cost time: 4.425016641616821
Epoch: 19, Steps: 154 | Train Loss: 0.357 Vali Loss: 3.341 Vali Acc: 0.444 Test Loss: 3.341 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3974413
	speed: 0.1097s/iter; left time: 1358.0781s
Epoch: 20 cost time: 4.547646760940552
Epoch: 20, Steps: 154 | Train Loss: 0.324 Vali Loss: 3.360 Vali Acc: 0.499 Test Loss: 3.360 Test Acc: 0.499
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.6638368
	speed: 0.1125s/iter; left time: 1374.7996s
Epoch: 21 cost time: 4.621855735778809
Epoch: 21, Steps: 154 | Train Loss: 0.286 Vali Loss: 3.454 Vali Acc: 0.496 Test Loss: 3.454 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.8338684
	speed: 0.1095s/iter; left time: 1320.7445s
Epoch: 22 cost time: 4.552761077880859
Epoch: 22, Steps: 154 | Train Loss: 0.265 Vali Loss: 3.415 Vali Acc: 0.481 Test Loss: 3.415 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0456494
	speed: 0.1099s/iter; left time: 1308.6634s
Epoch: 23 cost time: 4.500980854034424
Epoch: 23, Steps: 154 | Train Loss: 0.234 Vali Loss: 3.280 Vali Acc: 0.525 Test Loss: 3.280 Test Acc: 0.525
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.3470014
	speed: 0.1093s/iter; left time: 1285.0330s
Epoch: 24 cost time: 4.014280796051025
Epoch: 24, Steps: 154 | Train Loss: 0.260 Vali Loss: 3.570 Vali Acc: 0.500 Test Loss: 3.570 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0637739
	speed: 0.1015s/iter; left time: 1177.6054s
Epoch: 25 cost time: 4.039360284805298
Epoch: 25, Steps: 154 | Train Loss: 0.247 Vali Loss: 3.602 Vali Acc: 0.525 Test Loss: 3.602 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.3390424
	speed: 0.0981s/iter; left time: 1123.5927s
Epoch: 26 cost time: 3.777329444885254
Epoch: 26, Steps: 154 | Train Loss: 0.218 Vali Loss: 3.603 Vali Acc: 0.536 Test Loss: 3.603 Test Acc: 0.536
Validation loss decreased (-0.532818 --> -0.536055).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.2326508
	speed: 0.1016s/iter; left time: 1148.0828s
Epoch: 27 cost time: 3.960481643676758
Epoch: 27, Steps: 154 | Train Loss: 0.229 Vali Loss: 3.816 Vali Acc: 0.513 Test Loss: 3.816 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.2911325
	speed: 0.0927s/iter; left time: 1033.3963s
Epoch: 28 cost time: 3.8471481800079346
Epoch: 28, Steps: 154 | Train Loss: 0.187 Vali Loss: 3.805 Vali Acc: 0.524 Test Loss: 3.805 Test Acc: 0.524
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0788402
	speed: 0.1019s/iter; left time: 1119.8546s
Epoch: 29 cost time: 4.007234573364258
Epoch: 29, Steps: 154 | Train Loss: 0.195 Vali Loss: 3.991 Vali Acc: 0.518 Test Loss: 3.991 Test Acc: 0.518
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0111282
	speed: 0.0991s/iter; left time: 1074.2215s
Epoch: 30 cost time: 3.965449333190918
Epoch: 30, Steps: 154 | Train Loss: 0.182 Vali Loss: 4.052 Vali Acc: 0.517 Test Loss: 4.052 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0825563
	speed: 0.1151s/iter; left time: 1229.7618s
Epoch: 31 cost time: 7.036393165588379
Epoch: 31, Steps: 154 | Train Loss: 0.198 Vali Loss: 4.240 Vali Acc: 0.491 Test Loss: 4.240 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0357542
	speed: 0.1516s/iter; left time: 1595.9445s
Epoch: 32 cost time: 6.5629191398620605
Epoch: 32, Steps: 154 | Train Loss: 0.171 Vali Loss: 4.021 Vali Acc: 0.508 Test Loss: 4.021 Test Acc: 0.508
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0209824
	speed: 0.1601s/iter; left time: 1660.6252s
Epoch: 33 cost time: 6.182886600494385
Epoch: 33, Steps: 154 | Train Loss: 0.198 Vali Loss: 4.343 Vali Acc: 0.485 Test Loss: 4.343 Test Acc: 0.485
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0529011
	speed: 0.1391s/iter; left time: 1421.5149s
Epoch: 34 cost time: 4.090197563171387
Epoch: 34, Steps: 154 | Train Loss: 0.136 Vali Loss: 4.211 Vali Acc: 0.506 Test Loss: 4.211 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0555860
	speed: 0.1024s/iter; left time: 1030.9810s
Epoch: 35 cost time: 4.61088490486145
Epoch: 35, Steps: 154 | Train Loss: 0.191 Vali Loss: 3.821 Vali Acc: 0.524 Test Loss: 3.821 Test Acc: 0.524
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0382508
	speed: 0.1068s/iter; left time: 1058.1462s
Epoch: 36 cost time: 5.366460084915161
Epoch: 36, Steps: 154 | Train Loss: 0.127 Vali Loss: 4.466 Vali Acc: 0.506 Test Loss: 4.466 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5360908353609084
model parameter : 147534
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4261553
	speed: 0.0630s/iter; left time: 963.3656s
Epoch: 1 cost time: 8.891371011734009
Epoch: 1, Steps: 154 | Train Loss: 2.000 Vali Loss: 1.959 Vali Acc: 0.414 Test Loss: 1.959 Test Acc: 0.414
Validation loss decreased (inf --> -0.414011).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5549042
	speed: 0.1625s/iter; left time: 2460.8853s
Epoch: 2 cost time: 7.490044355392456
Epoch: 2, Steps: 154 | Train Loss: 1.380 Vali Loss: 1.959 Vali Acc: 0.412 Test Loss: 1.959 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6783415
	speed: 0.1487s/iter; left time: 2230.1369s
Epoch: 3 cost time: 6.199520587921143
Epoch: 3, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.022 Vali Acc: 0.476 Test Loss: 2.022 Test Acc: 0.476
Validation loss decreased (-0.414011 --> -0.476460).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3046532
	speed: 0.1589s/iter; left time: 2358.1151s
Epoch: 4 cost time: 6.7371368408203125
Epoch: 4, Steps: 154 | Train Loss: 1.167 Vali Loss: 2.021 Vali Acc: 0.474 Test Loss: 2.021 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9950710
	speed: 0.1616s/iter; left time: 2373.4561s
Epoch: 5 cost time: 6.349295139312744
Epoch: 5, Steps: 154 | Train Loss: 1.066 Vali Loss: 1.843 Vali Acc: 0.521 Test Loss: 1.843 Test Acc: 0.521
Validation loss decreased (-0.476460 --> -0.520663).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4770337
	speed: 0.1683s/iter; left time: 2446.1092s
Epoch: 6 cost time: 6.947665452957153
Epoch: 6, Steps: 154 | Train Loss: 1.004 Vali Loss: 1.889 Vali Acc: 0.511 Test Loss: 1.889 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6015052
	speed: 0.1363s/iter; left time: 1959.8726s
Epoch: 7 cost time: 4.940858840942383
Epoch: 7, Steps: 154 | Train Loss: 0.899 Vali Loss: 2.454 Vali Acc: 0.423 Test Loss: 2.454 Test Acc: 0.423
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7730608
	speed: 0.1220s/iter; left time: 1735.4245s
Epoch: 8 cost time: 5.037532091140747
Epoch: 8, Steps: 154 | Train Loss: 0.848 Vali Loss: 2.597 Vali Acc: 0.483 Test Loss: 2.597 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.7769024
	speed: 0.1300s/iter; left time: 1828.8523s
Epoch: 9 cost time: 5.180808067321777
Epoch: 9, Steps: 154 | Train Loss: 0.757 Vali Loss: 2.323 Vali Acc: 0.491 Test Loss: 2.323 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6567444
	speed: 0.1313s/iter; left time: 1826.7752s
Epoch: 10 cost time: 5.352259635925293
Epoch: 10, Steps: 154 | Train Loss: 0.720 Vali Loss: 2.153 Vali Acc: 0.549 Test Loss: 2.153 Test Acc: 0.549
Validation loss decreased (-0.520663 --> -0.548640).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8328835
	speed: 0.1717s/iter; left time: 2362.0871s
Epoch: 11 cost time: 8.22385859489441
Epoch: 11, Steps: 154 | Train Loss: 0.626 Vali Loss: 2.381 Vali Acc: 0.504 Test Loss: 2.381 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7347265
	speed: 0.1761s/iter; left time: 2396.6920s
Epoch: 12 cost time: 6.983596563339233
Epoch: 12, Steps: 154 | Train Loss: 0.572 Vali Loss: 2.624 Vali Acc: 0.460 Test Loss: 2.624 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1112269
	speed: 0.1934s/iter; left time: 2602.1142s
Epoch: 13 cost time: 7.990544557571411
Epoch: 13, Steps: 154 | Train Loss: 0.555 Vali Loss: 2.499 Vali Acc: 0.532 Test Loss: 2.499 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8741077
	speed: 0.1934s/iter; left time: 2572.5100s
Epoch: 14 cost time: 8.130519151687622
Epoch: 14, Steps: 154 | Train Loss: 0.468 Vali Loss: 2.791 Vali Acc: 0.502 Test Loss: 2.791 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1867542
	speed: 0.1810s/iter; left time: 2379.1113s
Epoch: 15 cost time: 7.139192581176758
Epoch: 15, Steps: 154 | Train Loss: 0.431 Vali Loss: 3.115 Vali Acc: 0.450 Test Loss: 3.115 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1467624
	speed: 0.1799s/iter; left time: 2337.1026s
Epoch: 16 cost time: 6.588959693908691
Epoch: 16, Steps: 154 | Train Loss: 0.413 Vali Loss: 3.374 Vali Acc: 0.431 Test Loss: 3.374 Test Acc: 0.431
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2236963
	speed: 0.1673s/iter; left time: 2147.3014s
Epoch: 17 cost time: 7.372377634048462
Epoch: 17, Steps: 154 | Train Loss: 0.375 Vali Loss: 2.859 Vali Acc: 0.554 Test Loss: 2.859 Test Acc: 0.554
Validation loss decreased (-0.548640 --> -0.553499).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4836720
	speed: 0.1647s/iter; left time: 2088.7798s
Epoch: 18 cost time: 6.069664478302002
Epoch: 18, Steps: 154 | Train Loss: 0.315 Vali Loss: 2.982 Vali Acc: 0.525 Test Loss: 2.982 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5346529
	speed: 0.1705s/iter; left time: 2135.7841s
Epoch: 19 cost time: 7.702113389968872
Epoch: 19, Steps: 154 | Train Loss: 0.325 Vali Loss: 3.170 Vali Acc: 0.523 Test Loss: 3.170 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3538436
	speed: 0.1574s/iter; left time: 1948.2586s
Epoch: 20 cost time: 5.820414781570435
Epoch: 20, Steps: 154 | Train Loss: 0.304 Vali Loss: 3.609 Vali Acc: 0.485 Test Loss: 3.609 Test Acc: 0.485
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2183417
	speed: 0.1700s/iter; left time: 2077.4639s
Epoch: 21 cost time: 7.039609909057617
Epoch: 21, Steps: 154 | Train Loss: 0.267 Vali Loss: 3.524 Vali Acc: 0.530 Test Loss: 3.524 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0175461
	speed: 0.1577s/iter; left time: 1902.7147s
Epoch: 22 cost time: 6.904385566711426
Epoch: 22, Steps: 154 | Train Loss: 0.271 Vali Loss: 3.735 Vali Acc: 0.513 Test Loss: 3.735 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0855622
	speed: 0.1881s/iter; left time: 2241.3646s
Epoch: 23 cost time: 7.217034101486206
Epoch: 23, Steps: 154 | Train Loss: 0.238 Vali Loss: 3.641 Vali Acc: 0.530 Test Loss: 3.641 Test Acc: 0.530
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.3465682
	speed: 0.1770s/iter; left time: 2081.6797s
Epoch: 24 cost time: 8.432575464248657
Epoch: 24, Steps: 154 | Train Loss: 0.239 Vali Loss: 3.959 Vali Acc: 0.506 Test Loss: 3.959 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.2088792
	speed: 0.1830s/iter; left time: 2124.0684s
Epoch: 25 cost time: 6.481653928756714
Epoch: 25, Steps: 154 | Train Loss: 0.243 Vali Loss: 4.008 Vali Acc: 0.481 Test Loss: 4.008 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.8621279
	speed: 0.1471s/iter; left time: 1684.9121s
Epoch: 26 cost time: 5.887807130813599
Epoch: 26, Steps: 154 | Train Loss: 0.220 Vali Loss: 3.723 Vali Acc: 0.556 Test Loss: 3.723 Test Acc: 0.556
Validation loss decreased (-0.553499 --> -0.555924).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.7838767
	speed: 0.1458s/iter; left time: 1646.6229s
Epoch: 27 cost time: 5.582692861557007
Epoch: 27, Steps: 154 | Train Loss: 0.215 Vali Loss: 3.794 Vali Acc: 0.541 Test Loss: 3.794 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.2216495
	speed: 0.1322s/iter; left time: 1473.1655s
Epoch: 28 cost time: 6.375811815261841
Epoch: 28, Steps: 154 | Train Loss: 0.192 Vali Loss: 3.919 Vali Acc: 0.519 Test Loss: 3.919 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0676562
	speed: 0.1824s/iter; left time: 2004.6097s
Epoch: 29 cost time: 7.312878847122192
Epoch: 29, Steps: 154 | Train Loss: 0.186 Vali Loss: 4.071 Vali Acc: 0.505 Test Loss: 4.071 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.1170682
	speed: 0.1845s/iter; left time: 1998.6583s
Epoch: 30 cost time: 7.436113357543945
Epoch: 30, Steps: 154 | Train Loss: 0.190 Vali Loss: 3.908 Vali Acc: 0.541 Test Loss: 3.908 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0787294
	speed: 0.1746s/iter; left time: 1864.8782s
Epoch: 31 cost time: 6.843322038650513
Epoch: 31, Steps: 154 | Train Loss: 0.184 Vali Loss: 3.927 Vali Acc: 0.530 Test Loss: 3.927 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0483771
	speed: 0.1669s/iter; left time: 1756.8885s
Epoch: 32 cost time: 6.073513746261597
Epoch: 32, Steps: 154 | Train Loss: 0.162 Vali Loss: 4.139 Vali Acc: 0.498 Test Loss: 4.139 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0450580
	speed: 0.1682s/iter; left time: 1744.5342s
Epoch: 33 cost time: 7.357926607131958
Epoch: 33, Steps: 154 | Train Loss: 0.147 Vali Loss: 4.408 Vali Acc: 0.525 Test Loss: 4.408 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.2537074
	speed: 0.1751s/iter; left time: 1789.1814s
Epoch: 34 cost time: 6.707970142364502
Epoch: 34, Steps: 154 | Train Loss: 0.134 Vali Loss: 4.063 Vali Acc: 0.532 Test Loss: 4.063 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.6506032
	speed: 0.1491s/iter; left time: 1500.3098s
Epoch: 35 cost time: 5.655920505523682
Epoch: 35, Steps: 154 | Train Loss: 0.196 Vali Loss: 4.743 Vali Acc: 0.498 Test Loss: 4.743 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.5637597
	speed: 0.1416s/iter; left time: 1403.5144s
Epoch: 36 cost time: 5.555712938308716
Epoch: 36, Steps: 154 | Train Loss: 0.158 Vali Loss: 4.186 Vali Acc: 0.551 Test Loss: 4.186 Test Acc: 0.551
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5559610705596107
model parameter : 147598
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7376639
	speed: 0.0474s/iter; left time: 725.2699s
Epoch: 1 cost time: 6.224494218826294
Epoch: 1, Steps: 154 | Train Loss: 2.059 Vali Loss: 1.890 Vali Acc: 0.399 Test Loss: 1.890 Test Acc: 0.399
Validation loss decreased (inf --> -0.399008).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3408378
	speed: 0.1191s/iter; left time: 1804.3345s
Epoch: 2 cost time: 4.941753149032593
Epoch: 2, Steps: 154 | Train Loss: 1.425 Vali Loss: 1.968 Vali Acc: 0.457 Test Loss: 1.968 Test Acc: 0.457
Validation loss decreased (-0.399008 --> -0.456996).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6563199
	speed: 0.1505s/iter; left time: 2256.6322s
Epoch: 3 cost time: 6.2729811668396
Epoch: 3, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.053 Vali Acc: 0.460 Test Loss: 2.053 Test Acc: 0.460
Validation loss decreased (-0.456996 --> -0.460239).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9864911
	speed: 0.1539s/iter; left time: 2283.5912s
Epoch: 4 cost time: 5.799025297164917
Epoch: 4, Steps: 154 | Train Loss: 1.152 Vali Loss: 1.988 Vali Acc: 0.479 Test Loss: 1.988 Test Acc: 0.479
Validation loss decreased (-0.460239 --> -0.479299).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1370556
	speed: 0.1473s/iter; left time: 2162.9453s
Epoch: 5 cost time: 5.774285793304443
Epoch: 5, Steps: 154 | Train Loss: 1.085 Vali Loss: 1.977 Vali Acc: 0.505 Test Loss: 1.977 Test Acc: 0.505
Validation loss decreased (-0.479299 --> -0.504846).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1171938
	speed: 0.1589s/iter; left time: 2308.2918s
Epoch: 6 cost time: 6.863765001296997
Epoch: 6, Steps: 154 | Train Loss: 1.035 Vali Loss: 2.023 Vali Acc: 0.522 Test Loss: 2.023 Test Acc: 0.522
Validation loss decreased (-0.504846 --> -0.521878).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0144625
	speed: 0.1598s/iter; left time: 2297.3579s
Epoch: 7 cost time: 6.590298652648926
Epoch: 7, Steps: 154 | Train Loss: 0.940 Vali Loss: 1.924 Vali Acc: 0.537 Test Loss: 1.924 Test Acc: 0.537
Validation loss decreased (-0.521878 --> -0.536883).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1142195
	speed: 0.1693s/iter; left time: 2407.3006s
Epoch: 8 cost time: 6.841026067733765
Epoch: 8, Steps: 154 | Train Loss: 0.863 Vali Loss: 1.971 Vali Acc: 0.525 Test Loss: 1.971 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2779259
	speed: 0.1457s/iter; left time: 2050.2750s
Epoch: 9 cost time: 5.26632022857666
Epoch: 9, Steps: 154 | Train Loss: 0.809 Vali Loss: 2.071 Vali Acc: 0.538 Test Loss: 2.071 Test Acc: 0.538
Validation loss decreased (-0.536883 --> -0.537692).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9487196
	speed: 0.1423s/iter; left time: 1980.3981s
Epoch: 10 cost time: 5.604860544204712
Epoch: 10, Steps: 154 | Train Loss: 0.753 Vali Loss: 2.177 Vali Acc: 0.498 Test Loss: 2.177 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0769347
	speed: 0.1403s/iter; left time: 1930.3367s
Epoch: 11 cost time: 5.807849407196045
Epoch: 11, Steps: 154 | Train Loss: 0.688 Vali Loss: 2.181 Vali Acc: 0.514 Test Loss: 2.181 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0645633
	speed: 0.1492s/iter; left time: 2030.0648s
Epoch: 12 cost time: 5.688687086105347
Epoch: 12, Steps: 154 | Train Loss: 0.614 Vali Loss: 2.382 Vali Acc: 0.509 Test Loss: 2.382 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5171859
	speed: 0.1571s/iter; left time: 2113.1687s
Epoch: 13 cost time: 6.530743598937988
Epoch: 13, Steps: 154 | Train Loss: 0.572 Vali Loss: 2.943 Vali Acc: 0.498 Test Loss: 2.943 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5963750
	speed: 0.1575s/iter; left time: 2094.1947s
Epoch: 14 cost time: 6.995879411697388
Epoch: 14, Steps: 154 | Train Loss: 0.514 Vali Loss: 2.616 Vali Acc: 0.504 Test Loss: 2.616 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8477416
	speed: 0.1571s/iter; left time: 2064.6120s
Epoch: 15 cost time: 5.862944602966309
Epoch: 15, Steps: 154 | Train Loss: 0.520 Vali Loss: 2.952 Vali Acc: 0.485 Test Loss: 2.952 Test Acc: 0.485
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1586456
	speed: 0.1439s/iter; left time: 1869.3425s
Epoch: 16 cost time: 5.761249780654907
Epoch: 16, Steps: 154 | Train Loss: 0.488 Vali Loss: 2.501 Vali Acc: 0.563 Test Loss: 2.501 Test Acc: 0.563
Validation loss decreased (-0.537692 --> -0.562830).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8698456
	speed: 0.1459s/iter; left time: 1872.3877s
Epoch: 17 cost time: 6.0447165966033936
Epoch: 17, Steps: 154 | Train Loss: 0.429 Vali Loss: 2.618 Vali Acc: 0.549 Test Loss: 2.618 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3976593
	speed: 0.1576s/iter; left time: 1998.5072s
Epoch: 18 cost time: 6.559353351593018
Epoch: 18, Steps: 154 | Train Loss: 0.419 Vali Loss: 2.824 Vali Acc: 0.534 Test Loss: 2.824 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.6705028
	speed: 0.1588s/iter; left time: 1990.0939s
Epoch: 19 cost time: 6.098413467407227
Epoch: 19, Steps: 154 | Train Loss: 0.382 Vali Loss: 2.686 Vali Acc: 0.513 Test Loss: 2.686 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.7949182
	speed: 0.1522s/iter; left time: 1883.8892s
Epoch: 20 cost time: 5.536736726760864
Epoch: 20, Steps: 154 | Train Loss: 0.370 Vali Loss: 2.708 Vali Acc: 0.523 Test Loss: 2.708 Test Acc: 0.523
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.4243738
	speed: 0.1475s/iter; left time: 1802.6618s
Epoch: 21 cost time: 5.438379526138306
Epoch: 21, Steps: 154 | Train Loss: 0.330 Vali Loss: 2.837 Vali Acc: 0.529 Test Loss: 2.837 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0806271
	speed: 0.1337s/iter; left time: 1613.8183s
Epoch: 22 cost time: 4.682563304901123
Epoch: 22, Steps: 154 | Train Loss: 0.311 Vali Loss: 2.859 Vali Acc: 0.541 Test Loss: 2.859 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.1632348
	speed: 0.1237s/iter; left time: 1473.5006s
Epoch: 23 cost time: 4.782264709472656
Epoch: 23, Steps: 154 | Train Loss: 0.297 Vali Loss: 2.839 Vali Acc: 0.511 Test Loss: 2.839 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.8476036
	speed: 0.1260s/iter; left time: 1481.0981s
Epoch: 24 cost time: 4.460747241973877
Epoch: 24, Steps: 154 | Train Loss: 0.261 Vali Loss: 3.037 Vali Acc: 0.533 Test Loss: 3.037 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.5206448
	speed: 0.1375s/iter; left time: 1595.5410s
Epoch: 25 cost time: 5.399489879608154
Epoch: 25, Steps: 154 | Train Loss: 0.265 Vali Loss: 3.041 Vali Acc: 0.539 Test Loss: 3.041 Test Acc: 0.539
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2661775
	speed: 0.1560s/iter; left time: 1786.8110s
Epoch: 26 cost time: 6.467437505722046
Epoch: 26, Steps: 154 | Train Loss: 0.246 Vali Loss: 3.142 Vali Acc: 0.547 Test Loss: 3.142 Test Acc: 0.547
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5628548256285483
model parameter : 115470
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0842104
	speed: 0.0516s/iter; left time: 790.2616s
Epoch: 1 cost time: 7.334683656692505
Epoch: 1, Steps: 154 | Train Loss: 2.191 Vali Loss: 1.987 Vali Acc: 0.410 Test Loss: 1.987 Test Acc: 0.410
Validation loss decreased (inf --> -0.410361).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4708920
	speed: 0.1428s/iter; left time: 2162.3629s
Epoch: 2 cost time: 5.639693737030029
Epoch: 2, Steps: 154 | Train Loss: 1.492 Vali Loss: 1.682 Vali Acc: 0.480 Test Loss: 1.682 Test Acc: 0.480
Validation loss decreased (-0.410361 --> -0.479707).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1993928
	speed: 0.1331s/iter; left time: 1995.4940s
Epoch: 3 cost time: 5.053102493286133
Epoch: 3, Steps: 154 | Train Loss: 1.259 Vali Loss: 1.770 Vali Acc: 0.481 Test Loss: 1.770 Test Acc: 0.481
Validation loss decreased (-0.479707 --> -0.481329).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2238958
	speed: 0.1440s/iter; left time: 2136.8964s
Epoch: 4 cost time: 7.496905565261841
Epoch: 4, Steps: 154 | Train Loss: 1.165 Vali Loss: 2.361 Vali Acc: 0.456 Test Loss: 2.361 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6988542
	speed: 0.1746s/iter; left time: 2563.7239s
Epoch: 5 cost time: 7.550793886184692
Epoch: 5, Steps: 154 | Train Loss: 1.102 Vali Loss: 2.031 Vali Acc: 0.481 Test Loss: 2.031 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.6207477
	speed: 0.1867s/iter; left time: 2713.3825s
Epoch: 6 cost time: 8.38543176651001
Epoch: 6, Steps: 154 | Train Loss: 1.044 Vali Loss: 2.014 Vali Acc: 0.476 Test Loss: 2.014 Test Acc: 0.476
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.7058054
	speed: 0.1823s/iter; left time: 2620.9638s
Epoch: 7 cost time: 7.9236626625061035
Epoch: 7, Steps: 154 | Train Loss: 0.993 Vali Loss: 2.100 Vali Acc: 0.454 Test Loss: 2.100 Test Acc: 0.454
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8527841
	speed: 0.1842s/iter; left time: 2619.4670s
Epoch: 8 cost time: 8.138801097869873
Epoch: 8, Steps: 154 | Train Loss: 0.894 Vali Loss: 1.943 Vali Acc: 0.509 Test Loss: 1.943 Test Acc: 0.509
Validation loss decreased (-0.481329 --> -0.508496).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2689749
	speed: 0.1807s/iter; left time: 2542.2480s
Epoch: 9 cost time: 8.121669292449951
Epoch: 9, Steps: 154 | Train Loss: 0.865 Vali Loss: 2.475 Vali Acc: 0.473 Test Loss: 2.475 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4224963
	speed: 0.1816s/iter; left time: 2527.2109s
Epoch: 10 cost time: 7.868143320083618
Epoch: 10, Steps: 154 | Train Loss: 0.802 Vali Loss: 2.579 Vali Acc: 0.435 Test Loss: 2.579 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0751541
	speed: 0.1796s/iter; left time: 2471.5721s
Epoch: 11 cost time: 7.968706846237183
Epoch: 11, Steps: 154 | Train Loss: 0.780 Vali Loss: 2.130 Vali Acc: 0.477 Test Loss: 2.130 Test Acc: 0.477
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4178722
	speed: 0.1818s/iter; left time: 2473.9429s
Epoch: 12 cost time: 7.860783338546753
Epoch: 12, Steps: 154 | Train Loss: 0.731 Vali Loss: 2.111 Vali Acc: 0.489 Test Loss: 2.111 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.4252436
	speed: 0.1810s/iter; left time: 2435.1562s
Epoch: 13 cost time: 8.17620587348938
Epoch: 13, Steps: 154 | Train Loss: 0.660 Vali Loss: 2.102 Vali Acc: 0.537 Test Loss: 2.102 Test Acc: 0.537
Validation loss decreased (-0.508496 --> -0.536881).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0652213
	speed: 0.1763s/iter; left time: 2344.2808s
Epoch: 14 cost time: 7.334726333618164
Epoch: 14, Steps: 154 | Train Loss: 0.615 Vali Loss: 2.237 Vali Acc: 0.506 Test Loss: 2.237 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5625905
	speed: 0.1668s/iter; left time: 2192.4989s
Epoch: 15 cost time: 7.1745569705963135
Epoch: 15, Steps: 154 | Train Loss: 0.579 Vali Loss: 2.575 Vali Acc: 0.444 Test Loss: 2.575 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7392390
	speed: 0.1453s/iter; left time: 1888.2376s
Epoch: 16 cost time: 4.4983954429626465
Epoch: 16, Steps: 154 | Train Loss: 0.542 Vali Loss: 2.426 Vali Acc: 0.488 Test Loss: 2.426 Test Acc: 0.488
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.3776082
	speed: 0.1153s/iter; left time: 1479.8957s
Epoch: 17 cost time: 4.223262071609497
Epoch: 17, Steps: 154 | Train Loss: 0.477 Vali Loss: 2.498 Vali Acc: 0.507 Test Loss: 2.498 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4869815
	speed: 0.1109s/iter; left time: 1406.9076s
Epoch: 18 cost time: 4.262357711791992
Epoch: 18, Steps: 154 | Train Loss: 0.451 Vali Loss: 2.409 Vali Acc: 0.505 Test Loss: 2.409 Test Acc: 0.505
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1428396
	speed: 0.1377s/iter; left time: 1725.6262s
Epoch: 19 cost time: 5.468647718429565
Epoch: 19, Steps: 154 | Train Loss: 0.415 Vali Loss: 2.744 Vali Acc: 0.476 Test Loss: 2.744 Test Acc: 0.476
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3497657
	speed: 0.1520s/iter; left time: 1881.5141s
Epoch: 20 cost time: 5.99845290184021
Epoch: 20, Steps: 154 | Train Loss: 0.409 Vali Loss: 2.726 Vali Acc: 0.501 Test Loss: 2.726 Test Acc: 0.501
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.1432225
	speed: 0.1593s/iter; left time: 1946.2544s
Epoch: 21 cost time: 6.492820739746094
Epoch: 21, Steps: 154 | Train Loss: 0.380 Vali Loss: 2.655 Vali Acc: 0.477 Test Loss: 2.655 Test Acc: 0.477
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.1623416
	speed: 0.1586s/iter; left time: 1913.7452s
Epoch: 22 cost time: 6.826460838317871
Epoch: 22, Steps: 154 | Train Loss: 0.368 Vali Loss: 3.078 Vali Acc: 0.504 Test Loss: 3.078 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3159438
	speed: 0.1675s/iter; left time: 1996.0110s
Epoch: 23 cost time: 6.248807668685913
Epoch: 23, Steps: 154 | Train Loss: 0.308 Vali Loss: 3.052 Vali Acc: 0.519 Test Loss: 3.052 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5369018653690186
model parameter : 99470
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3008089
	speed: 0.0587s/iter; left time: 898.4749s
Epoch: 1 cost time: 8.393782615661621
Epoch: 1, Steps: 154 | Train Loss: 2.221 Vali Loss: 1.846 Vali Acc: 0.391 Test Loss: 1.846 Test Acc: 0.391
Validation loss decreased (inf --> -0.391304).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1987826
	speed: 0.1642s/iter; left time: 2486.5395s
Epoch: 2 cost time: 6.435396909713745
Epoch: 2, Steps: 154 | Train Loss: 1.534 Vali Loss: 1.700 Vali Acc: 0.446 Test Loss: 1.700 Test Acc: 0.446
Validation loss decreased (-0.391304 --> -0.446455).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0969591
	speed: 0.1691s/iter; left time: 2535.5908s
Epoch: 3 cost time: 7.133265018463135
Epoch: 3, Steps: 154 | Train Loss: 1.261 Vali Loss: 1.694 Vali Acc: 0.494 Test Loss: 1.694 Test Acc: 0.494
Validation loss decreased (-0.446455 --> -0.494306).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3032452
	speed: 0.1634s/iter; left time: 2424.4933s
Epoch: 4 cost time: 6.988354444503784
Epoch: 4, Steps: 154 | Train Loss: 1.187 Vali Loss: 1.668 Vali Acc: 0.515 Test Loss: 1.668 Test Acc: 0.515
Validation loss decreased (-0.494306 --> -0.515393).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6133801
	speed: 0.1653s/iter; left time: 2427.3507s
Epoch: 5 cost time: 6.909195184707642
Epoch: 5, Steps: 154 | Train Loss: 1.117 Vali Loss: 1.754 Vali Acc: 0.473 Test Loss: 1.754 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0757020
	speed: 0.1770s/iter; left time: 2572.5242s
Epoch: 6 cost time: 7.1322596073150635
Epoch: 6, Steps: 154 | Train Loss: 1.045 Vali Loss: 1.768 Vali Acc: 0.541 Test Loss: 1.768 Test Acc: 0.541
Validation loss decreased (-0.515393 --> -0.541345).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9841720
	speed: 0.1594s/iter; left time: 2291.9378s
Epoch: 7 cost time: 5.470295667648315
Epoch: 7, Steps: 154 | Train Loss: 1.017 Vali Loss: 1.819 Vali Acc: 0.511 Test Loss: 1.819 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7243356
	speed: 0.1309s/iter; left time: 1862.0044s
Epoch: 8 cost time: 4.757695913314819
Epoch: 8, Steps: 154 | Train Loss: 0.931 Vali Loss: 2.282 Vali Acc: 0.484 Test Loss: 2.282 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9759209
	speed: 0.1267s/iter; left time: 1782.0684s
Epoch: 9 cost time: 5.440514802932739
Epoch: 9, Steps: 154 | Train Loss: 0.889 Vali Loss: 1.796 Vali Acc: 0.511 Test Loss: 1.796 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8511882
	speed: 0.1522s/iter; left time: 2117.6267s
Epoch: 10 cost time: 6.031493902206421
Epoch: 10, Steps: 154 | Train Loss: 0.839 Vali Loss: 1.928 Vali Acc: 0.497 Test Loss: 1.928 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5394362
	speed: 0.1521s/iter; left time: 2092.5632s
Epoch: 11 cost time: 6.385370969772339
Epoch: 11, Steps: 154 | Train Loss: 0.778 Vali Loss: 2.116 Vali Acc: 0.512 Test Loss: 2.116 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2134017
	speed: 0.1600s/iter; left time: 2177.5804s
Epoch: 12 cost time: 6.731826543807983
Epoch: 12, Steps: 154 | Train Loss: 0.746 Vali Loss: 1.820 Vali Acc: 0.537 Test Loss: 1.820 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.8294328
	speed: 0.1449s/iter; left time: 1949.7869s
Epoch: 13 cost time: 5.12928318977356
Epoch: 13, Steps: 154 | Train Loss: 0.706 Vali Loss: 1.953 Vali Acc: 0.470 Test Loss: 1.953 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.7529495
	speed: 0.1271s/iter; left time: 1690.1434s
Epoch: 14 cost time: 4.246192455291748
Epoch: 14, Steps: 154 | Train Loss: 0.648 Vali Loss: 1.992 Vali Acc: 0.475 Test Loss: 1.992 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.5575363
	speed: 0.1067s/iter; left time: 1402.9180s
Epoch: 15 cost time: 3.9837567806243896
Epoch: 15, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.200 Vali Acc: 0.559 Test Loss: 2.200 Test Acc: 0.559
Validation loss decreased (-0.541345 --> -0.559183).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6626286
	speed: 0.1096s/iter; left time: 1424.0930s
Epoch: 16 cost time: 4.010778188705444
Epoch: 16, Steps: 154 | Train Loss: 0.573 Vali Loss: 2.337 Vali Acc: 0.515 Test Loss: 2.337 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.4662634
	speed: 0.1090s/iter; left time: 1399.7563s
Epoch: 17 cost time: 4.1739068031311035
Epoch: 17, Steps: 154 | Train Loss: 0.512 Vali Loss: 2.196 Vali Acc: 0.531 Test Loss: 2.196 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3981425
	speed: 0.1184s/iter; left time: 1501.4919s
Epoch: 18 cost time: 4.401216268539429
Epoch: 18, Steps: 154 | Train Loss: 0.465 Vali Loss: 2.331 Vali Acc: 0.538 Test Loss: 2.331 Test Acc: 0.538
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8626462
	speed: 0.1281s/iter; left time: 1604.8292s
Epoch: 19 cost time: 4.80224084854126
Epoch: 19, Steps: 154 | Train Loss: 0.455 Vali Loss: 2.269 Vali Acc: 0.534 Test Loss: 2.269 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4764218
	speed: 0.1446s/iter; left time: 1789.3097s
Epoch: 20 cost time: 6.037832975387573
Epoch: 20, Steps: 154 | Train Loss: 0.416 Vali Loss: 2.664 Vali Acc: 0.494 Test Loss: 2.664 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4488735
	speed: 0.1478s/iter; left time: 1806.4819s
Epoch: 21 cost time: 5.597578763961792
Epoch: 21, Steps: 154 | Train Loss: 0.394 Vali Loss: 2.942 Vali Acc: 0.518 Test Loss: 2.942 Test Acc: 0.518
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0672408
	speed: 0.1500s/iter; left time: 1810.5993s
Epoch: 22 cost time: 6.07822322845459
Epoch: 22, Steps: 154 | Train Loss: 0.383 Vali Loss: 2.512 Vali Acc: 0.549 Test Loss: 2.512 Test Acc: 0.549
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.7262183
	speed: 0.1440s/iter; left time: 1715.7469s
Epoch: 23 cost time: 4.897386074066162
Epoch: 23, Steps: 154 | Train Loss: 0.375 Vali Loss: 2.703 Vali Acc: 0.502 Test Loss: 2.703 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.5222736
	speed: 0.1290s/iter; left time: 1517.2468s
Epoch: 24 cost time: 4.930973529815674
Epoch: 24, Steps: 154 | Train Loss: 0.335 Vali Loss: 2.484 Vali Acc: 0.552 Test Loss: 2.484 Test Acc: 0.552
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.6207127
	speed: 0.1342s/iter; left time: 1557.5913s
Epoch: 25 cost time: 4.96033501625061
Epoch: 25, Steps: 154 | Train Loss: 0.321 Vali Loss: 2.842 Vali Acc: 0.471 Test Loss: 2.842 Test Acc: 0.471
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm64_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5592051905920519
model parameter : 88782
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7243335
	speed: 0.0586s/iter; left time: 895.9398s
Epoch: 1 cost time: 7.818541049957275
Epoch: 1, Steps: 154 | Train Loss: 1.984 Vali Loss: 1.849 Vali Acc: 0.408 Test Loss: 1.849 Test Acc: 0.408
Validation loss decreased (inf --> -0.407524).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1967130
	speed: 0.1507s/iter; left time: 2282.3199s
Epoch: 2 cost time: 5.970393896102905
Epoch: 2, Steps: 154 | Train Loss: 1.439 Vali Loss: 1.776 Vali Acc: 0.471 Test Loss: 1.776 Test Acc: 0.471
Validation loss decreased (-0.407524 --> -0.471191).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2517552
	speed: 0.1432s/iter; left time: 2146.6961s
Epoch: 3 cost time: 5.862790107727051
Epoch: 3, Steps: 154 | Train Loss: 1.254 Vali Loss: 1.978 Vali Acc: 0.470 Test Loss: 1.978 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6120595
	speed: 0.1511s/iter; left time: 2242.1520s
Epoch: 4 cost time: 6.617878675460815
Epoch: 4, Steps: 154 | Train Loss: 1.129 Vali Loss: 1.736 Vali Acc: 0.526 Test Loss: 1.736 Test Acc: 0.526
Validation loss decreased (-0.471191 --> -0.526341).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5078536
	speed: 0.1440s/iter; left time: 2114.8554s
Epoch: 5 cost time: 5.370857000350952
Epoch: 5, Steps: 154 | Train Loss: 1.022 Vali Loss: 1.859 Vali Acc: 0.524 Test Loss: 1.859 Test Acc: 0.524
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7670912
	speed: 0.1342s/iter; left time: 1950.0533s
Epoch: 6 cost time: 5.13834285736084
Epoch: 6, Steps: 154 | Train Loss: 0.938 Vali Loss: 1.976 Vali Acc: 0.431 Test Loss: 1.976 Test Acc: 0.431
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6305029
	speed: 0.1244s/iter; left time: 1788.9046s
Epoch: 7 cost time: 5.656307935714722
Epoch: 7, Steps: 154 | Train Loss: 0.870 Vali Loss: 1.937 Vali Acc: 0.509 Test Loss: 1.937 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.4331224
	speed: 0.1417s/iter; left time: 2014.9933s
Epoch: 8 cost time: 5.209508180618286
Epoch: 8, Steps: 154 | Train Loss: 0.764 Vali Loss: 2.003 Vali Acc: 0.506 Test Loss: 2.003 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.6488646
	speed: 0.1316s/iter; left time: 1852.0133s
Epoch: 9 cost time: 4.894639730453491
Epoch: 9, Steps: 154 | Train Loss: 0.665 Vali Loss: 2.016 Vali Acc: 0.502 Test Loss: 2.016 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0022596
	speed: 0.1351s/iter; left time: 1879.4851s
Epoch: 10 cost time: 5.267237424850464
Epoch: 10, Steps: 154 | Train Loss: 0.631 Vali Loss: 2.237 Vali Acc: 0.472 Test Loss: 2.237 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.6872920
	speed: 0.1363s/iter; left time: 1876.2273s
Epoch: 11 cost time: 5.208178997039795
Epoch: 11, Steps: 154 | Train Loss: 0.575 Vali Loss: 2.303 Vali Acc: 0.529 Test Loss: 2.303 Test Acc: 0.529
Validation loss decreased (-0.526341 --> -0.528769).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1040726
	speed: 0.1321s/iter; left time: 1796.9125s
Epoch: 12 cost time: 5.073154926300049
Epoch: 12, Steps: 154 | Train Loss: 0.503 Vali Loss: 2.556 Vali Acc: 0.463 Test Loss: 2.556 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5911531
	speed: 0.1340s/iter; left time: 1802.1954s
Epoch: 13 cost time: 5.236109256744385
Epoch: 13, Steps: 154 | Train Loss: 0.482 Vali Loss: 2.602 Vali Acc: 0.494 Test Loss: 2.602 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.3084917
	speed: 0.1310s/iter; left time: 1742.1160s
Epoch: 14 cost time: 5.02390718460083
Epoch: 14, Steps: 154 | Train Loss: 0.412 Vali Loss: 2.769 Vali Acc: 0.500 Test Loss: 2.769 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4062612
	speed: 0.1338s/iter; left time: 1759.0341s
Epoch: 15 cost time: 5.552361965179443
Epoch: 15, Steps: 154 | Train Loss: 0.416 Vali Loss: 2.734 Vali Acc: 0.451 Test Loss: 2.734 Test Acc: 0.451
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5586984
	speed: 0.1312s/iter; left time: 1704.5514s
Epoch: 16 cost time: 5.122130870819092
Epoch: 16, Steps: 154 | Train Loss: 0.376 Vali Loss: 3.397 Vali Acc: 0.440 Test Loss: 3.397 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0958240
	speed: 0.1341s/iter; left time: 1721.2316s
Epoch: 17 cost time: 5.841755628585815
Epoch: 17, Steps: 154 | Train Loss: 0.349 Vali Loss: 2.977 Vali Acc: 0.477 Test Loss: 2.977 Test Acc: 0.477
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3994815
	speed: 0.1448s/iter; left time: 1836.7588s
Epoch: 18 cost time: 5.97482967376709
Epoch: 18, Steps: 154 | Train Loss: 0.355 Vali Loss: 3.026 Vali Acc: 0.471 Test Loss: 3.026 Test Acc: 0.471
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.1904535
	speed: 0.1485s/iter; left time: 1860.9164s
Epoch: 19 cost time: 5.551633834838867
Epoch: 19, Steps: 154 | Train Loss: 0.331 Vali Loss: 3.139 Vali Acc: 0.456 Test Loss: 3.139 Test Acc: 0.456
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.2933930
	speed: 0.1463s/iter; left time: 1811.0628s
Epoch: 20 cost time: 6.164292335510254
Epoch: 20, Steps: 154 | Train Loss: 0.318 Vali Loss: 3.339 Vali Acc: 0.444 Test Loss: 3.339 Test Acc: 0.444
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.2087487
	speed: 0.1402s/iter; left time: 1713.2843s
Epoch: 21 cost time: 4.910472393035889
Epoch: 21, Steps: 154 | Train Loss: 0.286 Vali Loss: 3.291 Vali Acc: 0.479 Test Loss: 3.291 Test Acc: 0.479
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5287915652879156
model parameter : 138958
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3382120
	speed: 0.0676s/iter; left time: 1035.0651s
Epoch: 1 cost time: 9.336532592773438
Epoch: 1, Steps: 154 | Train Loss: 2.148 Vali Loss: 1.887 Vali Acc: 0.363 Test Loss: 1.887 Test Acc: 0.363
Validation loss decreased (inf --> -0.362917).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1628896
	speed: 0.1809s/iter; left time: 2740.4190s
Epoch: 2 cost time: 7.125086069107056
Epoch: 2, Steps: 154 | Train Loss: 1.529 Vali Loss: 1.668 Vali Acc: 0.465 Test Loss: 1.668 Test Acc: 0.465
Validation loss decreased (-0.362917 --> -0.464704).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8357528
	speed: 0.1745s/iter; left time: 2615.6944s
Epoch: 3 cost time: 7.87099027633667
Epoch: 3, Steps: 154 | Train Loss: 1.250 Vali Loss: 1.679 Vali Acc: 0.476 Test Loss: 1.679 Test Acc: 0.476
Validation loss decreased (-0.464704 --> -0.476463).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1185849
	speed: 0.1760s/iter; left time: 2611.0782s
Epoch: 4 cost time: 7.2693610191345215
Epoch: 4, Steps: 154 | Train Loss: 1.122 Vali Loss: 1.639 Vali Acc: 0.487 Test Loss: 1.639 Test Acc: 0.487
Validation loss decreased (-0.476463 --> -0.486602).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0845586
	speed: 0.1701s/iter; left time: 2498.6100s
Epoch: 5 cost time: 7.4387125968933105
Epoch: 5, Steps: 154 | Train Loss: 1.020 Vali Loss: 1.855 Vali Acc: 0.478 Test Loss: 1.855 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3301710
	speed: 0.1766s/iter; left time: 2566.3090s
Epoch: 6 cost time: 7.638261556625366
Epoch: 6, Steps: 154 | Train Loss: 0.974 Vali Loss: 1.697 Vali Acc: 0.536 Test Loss: 1.697 Test Acc: 0.536
Validation loss decreased (-0.486602 --> -0.536074).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1478525
	speed: 0.1757s/iter; left time: 2525.6339s
Epoch: 7 cost time: 7.469998121261597
Epoch: 7, Steps: 154 | Train Loss: 0.901 Vali Loss: 1.847 Vali Acc: 0.506 Test Loss: 1.847 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6807414
	speed: 0.1634s/iter; left time: 2324.6722s
Epoch: 8 cost time: 6.044639825820923
Epoch: 8, Steps: 154 | Train Loss: 0.847 Vali Loss: 2.055 Vali Acc: 0.491 Test Loss: 2.055 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.3950704
	speed: 0.1601s/iter; left time: 2251.8083s
Epoch: 9 cost time: 6.18134617805481
Epoch: 9, Steps: 154 | Train Loss: 0.774 Vali Loss: 2.039 Vali Acc: 0.506 Test Loss: 2.039 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1704690
	speed: 0.1599s/iter; left time: 2225.3229s
Epoch: 10 cost time: 6.429330348968506
Epoch: 10, Steps: 154 | Train Loss: 0.749 Vali Loss: 1.916 Vali Acc: 0.478 Test Loss: 1.916 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8636006
	speed: 0.1480s/iter; left time: 2036.9107s
Epoch: 11 cost time: 4.918110132217407
Epoch: 11, Steps: 154 | Train Loss: 0.674 Vali Loss: 1.910 Vali Acc: 0.520 Test Loss: 1.910 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.8386808
	speed: 0.1633s/iter; left time: 2221.9112s
Epoch: 12 cost time: 6.467798948287964
Epoch: 12, Steps: 154 | Train Loss: 0.641 Vali Loss: 1.980 Vali Acc: 0.532 Test Loss: 1.980 Test Acc: 0.532
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4075036
	speed: 0.1710s/iter; left time: 2299.9660s
Epoch: 13 cost time: 6.11681056022644
Epoch: 13, Steps: 154 | Train Loss: 0.588 Vali Loss: 2.179 Vali Acc: 0.473 Test Loss: 2.179 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.4957672
	speed: 0.1605s/iter; left time: 2134.0297s
Epoch: 14 cost time: 5.681635141372681
Epoch: 14, Steps: 154 | Train Loss: 0.607 Vali Loss: 2.244 Vali Acc: 0.440 Test Loss: 2.244 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.4404496
	speed: 0.1290s/iter; left time: 1696.0936s
Epoch: 15 cost time: 4.959803819656372
Epoch: 15, Steps: 154 | Train Loss: 0.529 Vali Loss: 2.112 Vali Acc: 0.552 Test Loss: 2.112 Test Acc: 0.552
Validation loss decreased (-0.536074 --> -0.552290).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4655178
	speed: 0.1421s/iter; left time: 1845.8493s
Epoch: 16 cost time: 6.913914442062378
Epoch: 16, Steps: 154 | Train Loss: 0.512 Vali Loss: 2.439 Vali Acc: 0.472 Test Loss: 2.439 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3943568
	speed: 0.1696s/iter; left time: 2176.9567s
Epoch: 17 cost time: 6.712038278579712
Epoch: 17, Steps: 154 | Train Loss: 0.474 Vali Loss: 2.438 Vali Acc: 0.455 Test Loss: 2.438 Test Acc: 0.455
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3209863
	speed: 0.1835s/iter; left time: 2327.9444s
Epoch: 18 cost time: 7.258955955505371
Epoch: 18, Steps: 154 | Train Loss: 0.456 Vali Loss: 2.286 Vali Acc: 0.532 Test Loss: 2.286 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3077816
	speed: 0.1763s/iter; left time: 2208.8272s
Epoch: 19 cost time: 6.9113929271698
Epoch: 19, Steps: 154 | Train Loss: 0.405 Vali Loss: 2.494 Vali Acc: 0.508 Test Loss: 2.494 Test Acc: 0.508
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3785517
	speed: 0.1804s/iter; left time: 2232.3367s
Epoch: 20 cost time: 7.136824607849121
Epoch: 20, Steps: 154 | Train Loss: 0.401 Vali Loss: 2.575 Vali Acc: 0.492 Test Loss: 2.575 Test Acc: 0.492
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.5485381
	speed: 0.1748s/iter; left time: 2136.0517s
Epoch: 21 cost time: 7.172936677932739
Epoch: 21, Steps: 154 | Train Loss: 0.374 Vali Loss: 2.541 Vali Acc: 0.521 Test Loss: 2.541 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.3036461
	speed: 0.1832s/iter; left time: 2210.4392s
Epoch: 22 cost time: 7.651360034942627
Epoch: 22, Steps: 154 | Train Loss: 0.367 Vali Loss: 2.682 Vali Acc: 0.473 Test Loss: 2.682 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.2074101
	speed: 0.1779s/iter; left time: 2119.0503s
Epoch: 23 cost time: 8.168074131011963
Epoch: 23, Steps: 154 | Train Loss: 0.341 Vali Loss: 2.733 Vali Acc: 0.526 Test Loss: 2.733 Test Acc: 0.526
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1402642
	speed: 0.1730s/iter; left time: 2034.7742s
Epoch: 24 cost time: 5.88292384147644
Epoch: 24, Steps: 154 | Train Loss: 0.316 Vali Loss: 2.655 Vali Acc: 0.523 Test Loss: 2.655 Test Acc: 0.523
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.2986530
	speed: 0.1406s/iter; left time: 1631.0889s
Epoch: 25 cost time: 5.684068918228149
Epoch: 25, Steps: 154 | Train Loss: 0.316 Vali Loss: 2.896 Vali Acc: 0.494 Test Loss: 2.896 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5523114355231143
model parameter : 90606
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3074627
	speed: 0.0593s/iter; left time: 907.6069s
Epoch: 1 cost time: 8.332022666931152
Epoch: 1, Steps: 154 | Train Loss: 2.098 Vali Loss: 1.955 Vali Acc: 0.399 Test Loss: 1.955 Test Acc: 0.399
Validation loss decreased (inf --> -0.398602).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5771096
	speed: 0.1646s/iter; left time: 2493.5195s
Epoch: 2 cost time: 6.082716226577759
Epoch: 2, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.115 Vali Acc: 0.445 Test Loss: 2.115 Test Acc: 0.445
Validation loss decreased (-0.398602 --> -0.445234).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4063632
	speed: 0.1585s/iter; left time: 2376.8946s
Epoch: 3 cost time: 6.530291795730591
Epoch: 3, Steps: 154 | Train Loss: 1.253 Vali Loss: 1.919 Vali Acc: 0.476 Test Loss: 1.919 Test Acc: 0.476
Validation loss decreased (-0.445234 --> -0.475650).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1199192
	speed: 0.1614s/iter; left time: 2394.6453s
Epoch: 4 cost time: 5.8314783573150635
Epoch: 4, Steps: 154 | Train Loss: 1.148 Vali Loss: 1.879 Vali Acc: 0.466 Test Loss: 1.879 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6779405
	speed: 0.1320s/iter; left time: 1938.3438s
Epoch: 5 cost time: 4.944930553436279
Epoch: 5, Steps: 154 | Train Loss: 1.052 Vali Loss: 1.835 Vali Acc: 0.503 Test Loss: 1.835 Test Acc: 0.503
Validation loss decreased (-0.475650 --> -0.503226).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6014141
	speed: 0.1231s/iter; left time: 1788.5249s
Epoch: 6 cost time: 4.631253242492676
Epoch: 6, Steps: 154 | Train Loss: 0.983 Vali Loss: 1.763 Vali Acc: 0.477 Test Loss: 1.763 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8616214
	speed: 0.1533s/iter; left time: 2204.0191s
Epoch: 7 cost time: 6.247765779495239
Epoch: 7, Steps: 154 | Train Loss: 0.909 Vali Loss: 1.988 Vali Acc: 0.470 Test Loss: 1.988 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7115070
	speed: 0.1533s/iter; left time: 2180.0890s
Epoch: 8 cost time: 6.322587251663208
Epoch: 8, Steps: 154 | Train Loss: 0.873 Vali Loss: 1.996 Vali Acc: 0.487 Test Loss: 1.996 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.8762061
	speed: 0.1506s/iter; left time: 2118.5700s
Epoch: 9 cost time: 5.704934358596802
Epoch: 9, Steps: 154 | Train Loss: 0.797 Vali Loss: 1.987 Vali Acc: 0.534 Test Loss: 1.987 Test Acc: 0.534
Validation loss decreased (-0.503226 --> -0.534043).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6088648
	speed: 0.1519s/iter; left time: 2113.8820s
Epoch: 10 cost time: 6.075229167938232
Epoch: 10, Steps: 154 | Train Loss: 0.747 Vali Loss: 1.930 Vali Acc: 0.504 Test Loss: 1.930 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8517890
	speed: 0.1466s/iter; left time: 2017.0755s
Epoch: 11 cost time: 5.727069139480591
Epoch: 11, Steps: 154 | Train Loss: 0.698 Vali Loss: 2.121 Vali Acc: 0.504 Test Loss: 2.121 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4546137
	speed: 0.1547s/iter; left time: 2105.5552s
Epoch: 12 cost time: 5.858782529830933
Epoch: 12, Steps: 154 | Train Loss: 0.617 Vali Loss: 2.008 Vali Acc: 0.500 Test Loss: 2.008 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4628637
	speed: 0.1553s/iter; left time: 2088.6395s
Epoch: 13 cost time: 6.193716764450073
Epoch: 13, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.267 Vali Acc: 0.459 Test Loss: 2.267 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3439501
	speed: 0.1338s/iter; left time: 1779.2032s
Epoch: 14 cost time: 5.021518230438232
Epoch: 14, Steps: 154 | Train Loss: 0.560 Vali Loss: 2.159 Vali Acc: 0.506 Test Loss: 2.159 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.4607087
	speed: 0.1400s/iter; left time: 1840.5420s
Epoch: 15 cost time: 6.7388012409210205
Epoch: 15, Steps: 154 | Train Loss: 0.512 Vali Loss: 2.319 Vali Acc: 0.479 Test Loss: 2.319 Test Acc: 0.479
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.9994754
	speed: 0.1612s/iter; left time: 2094.1648s
Epoch: 16 cost time: 6.3705503940582275
Epoch: 16, Steps: 154 | Train Loss: 0.479 Vali Loss: 2.398 Vali Acc: 0.487 Test Loss: 2.398 Test Acc: 0.487
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.5253807
	speed: 0.1625s/iter; left time: 2085.4520s
Epoch: 17 cost time: 6.430824518203735
Epoch: 17, Steps: 154 | Train Loss: 0.441 Vali Loss: 2.453 Vali Acc: 0.475 Test Loss: 2.453 Test Acc: 0.475
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1436146
	speed: 0.1611s/iter; left time: 2042.8832s
Epoch: 18 cost time: 6.7048516273498535
Epoch: 18, Steps: 154 | Train Loss: 0.424 Vali Loss: 2.588 Vali Acc: 0.455 Test Loss: 2.588 Test Acc: 0.455
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.3813218
	speed: 0.1533s/iter; left time: 1920.7219s
Epoch: 19 cost time: 5.683268308639526
Epoch: 19, Steps: 154 | Train Loss: 0.412 Vali Loss: 2.465 Vali Acc: 0.504 Test Loss: 2.465 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5340632603406326
model parameter : 90638
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2255037
	speed: 0.0484s/iter; left time: 740.4353s
Epoch: 1 cost time: 6.6880598068237305
Epoch: 1, Steps: 154 | Train Loss: 2.149 Vali Loss: 1.851 Vali Acc: 0.406 Test Loss: 1.851 Test Acc: 0.406
Validation loss decreased (inf --> -0.405902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9926925
	speed: 0.1540s/iter; left time: 2332.7693s
Epoch: 2 cost time: 6.361252784729004
Epoch: 2, Steps: 154 | Train Loss: 1.497 Vali Loss: 1.949 Vali Acc: 0.452 Test Loss: 1.949 Test Acc: 0.452
Validation loss decreased (-0.405902 --> -0.452130).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2898388
	speed: 0.1475s/iter; left time: 2211.3584s
Epoch: 3 cost time: 5.834381580352783
Epoch: 3, Steps: 154 | Train Loss: 1.277 Vali Loss: 1.947 Vali Acc: 0.478 Test Loss: 1.947 Test Acc: 0.478
Validation loss decreased (-0.452130 --> -0.477677).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2665383
	speed: 0.1494s/iter; left time: 2216.7232s
Epoch: 4 cost time: 5.575209379196167
Epoch: 4, Steps: 154 | Train Loss: 1.165 Vali Loss: 1.987 Vali Acc: 0.428 Test Loss: 1.987 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0357248
	speed: 0.1407s/iter; left time: 2066.3906s
Epoch: 5 cost time: 5.176208019256592
Epoch: 5, Steps: 154 | Train Loss: 1.084 Vali Loss: 1.911 Vali Acc: 0.501 Test Loss: 1.911 Test Acc: 0.501
Validation loss decreased (-0.477677 --> -0.501197).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2002876
	speed: 0.1319s/iter; left time: 1916.0003s
Epoch: 6 cost time: 4.527294397354126
Epoch: 6, Steps: 154 | Train Loss: 1.034 Vali Loss: 1.814 Vali Acc: 0.498 Test Loss: 1.814 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2592503
	speed: 0.1196s/iter; left time: 1720.1705s
Epoch: 7 cost time: 4.414457321166992
Epoch: 7, Steps: 154 | Train Loss: 0.954 Vali Loss: 1.933 Vali Acc: 0.468 Test Loss: 1.933 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7904004
	speed: 0.1215s/iter; left time: 1728.5500s
Epoch: 8 cost time: 5.114893198013306
Epoch: 8, Steps: 154 | Train Loss: 0.916 Vali Loss: 1.797 Vali Acc: 0.519 Test Loss: 1.797 Test Acc: 0.519
Validation loss decreased (-0.501197 --> -0.519041).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1072682
	speed: 0.1277s/iter; left time: 1796.0982s
Epoch: 9 cost time: 4.680863618850708
Epoch: 9, Steps: 154 | Train Loss: 0.865 Vali Loss: 1.861 Vali Acc: 0.520 Test Loss: 1.861 Test Acc: 0.520
Validation loss decreased (-0.519041 --> -0.519852).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6932209
	speed: 0.1260s/iter; left time: 1753.0128s
Epoch: 10 cost time: 5.090428352355957
Epoch: 10, Steps: 154 | Train Loss: 0.795 Vali Loss: 1.969 Vali Acc: 0.502 Test Loss: 1.969 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8214583
	speed: 0.1215s/iter; left time: 1671.7024s
Epoch: 11 cost time: 4.881555557250977
Epoch: 11, Steps: 154 | Train Loss: 0.749 Vali Loss: 1.995 Vali Acc: 0.504 Test Loss: 1.995 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4886180
	speed: 0.1330s/iter; left time: 1809.8699s
Epoch: 12 cost time: 5.808248043060303
Epoch: 12, Steps: 154 | Train Loss: 0.744 Vali Loss: 2.275 Vali Acc: 0.458 Test Loss: 2.275 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.8862128
	speed: 0.1505s/iter; left time: 2024.0071s
Epoch: 13 cost time: 5.778829097747803
Epoch: 13, Steps: 154 | Train Loss: 0.693 Vali Loss: 2.183 Vali Acc: 0.519 Test Loss: 2.183 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.4012250
	speed: 0.1485s/iter; left time: 1974.5980s
Epoch: 14 cost time: 6.31112813949585
Epoch: 14, Steps: 154 | Train Loss: 0.653 Vali Loss: 1.917 Vali Acc: 0.517 Test Loss: 1.917 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.0035447
	speed: 0.1401s/iter; left time: 1841.0729s
Epoch: 15 cost time: 5.113659620285034
Epoch: 15, Steps: 154 | Train Loss: 0.605 Vali Loss: 2.320 Vali Acc: 0.426 Test Loss: 2.320 Test Acc: 0.426
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.6825311
	speed: 0.1276s/iter; left time: 1657.6314s
Epoch: 16 cost time: 5.704713821411133
Epoch: 16, Steps: 154 | Train Loss: 0.595 Vali Loss: 2.327 Vali Acc: 0.469 Test Loss: 2.327 Test Acc: 0.469
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3232696
	speed: 0.1759s/iter; left time: 2258.6214s
Epoch: 17 cost time: 7.479269981384277
Epoch: 17, Steps: 154 | Train Loss: 0.561 Vali Loss: 2.354 Vali Acc: 0.443 Test Loss: 2.354 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.3281415
	speed: 0.1815s/iter; left time: 2301.5841s
Epoch: 18 cost time: 7.725653409957886
Epoch: 18, Steps: 154 | Train Loss: 0.534 Vali Loss: 2.212 Vali Acc: 0.478 Test Loss: 2.212 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.5135655
	speed: 0.1843s/iter; left time: 2308.7785s
Epoch: 19 cost time: 7.76161527633667
Epoch: 19, Steps: 154 | Train Loss: 0.473 Vali Loss: 2.481 Vali Acc: 0.473 Test Loss: 2.481 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5198702351987023
model parameter : 74574
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5322413
	speed: 0.0642s/iter; left time: 982.2552s
Epoch: 1 cost time: 9.076774597167969
Epoch: 1, Steps: 154 | Train Loss: 2.202 Vali Loss: 1.864 Vali Acc: 0.397 Test Loss: 1.864 Test Acc: 0.397
Validation loss decreased (inf --> -0.397386).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0722711
	speed: 0.1728s/iter; left time: 2617.6083s
Epoch: 2 cost time: 7.6348185539245605
Epoch: 2, Steps: 154 | Train Loss: 1.594 Vali Loss: 1.738 Vali Acc: 0.448 Test Loss: 1.738 Test Acc: 0.448
Validation loss decreased (-0.397386 --> -0.447671).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5603091
	speed: 0.1730s/iter; left time: 2594.2297s
Epoch: 3 cost time: 7.665514230728149
Epoch: 3, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.074 Vali Acc: 0.429 Test Loss: 2.074 Test Acc: 0.429
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1285585
	speed: 0.1770s/iter; left time: 2626.4563s
Epoch: 4 cost time: 7.03221583366394
Epoch: 4, Steps: 154 | Train Loss: 1.219 Vali Loss: 1.656 Vali Acc: 0.497 Test Loss: 1.656 Test Acc: 0.497
Validation loss decreased (-0.447671 --> -0.496739).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7245957
	speed: 0.1730s/iter; left time: 2540.4371s
Epoch: 5 cost time: 7.147132396697998
Epoch: 5, Steps: 154 | Train Loss: 1.151 Vali Loss: 1.803 Vali Acc: 0.468 Test Loss: 1.803 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8861310
	speed: 0.1637s/iter; left time: 2378.6713s
Epoch: 6 cost time: 6.150167465209961
Epoch: 6, Steps: 154 | Train Loss: 1.095 Vali Loss: 1.803 Vali Acc: 0.502 Test Loss: 1.803 Test Acc: 0.502
Validation loss decreased (-0.496739 --> -0.502415).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0773767
	speed: 0.1679s/iter; left time: 2414.0551s
Epoch: 7 cost time: 6.931897878646851
Epoch: 7, Steps: 154 | Train Loss: 1.040 Vali Loss: 1.816 Vali Acc: 0.494 Test Loss: 1.816 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8960529
	speed: 0.1545s/iter; left time: 2197.9504s
Epoch: 8 cost time: 5.794745922088623
Epoch: 8, Steps: 154 | Train Loss: 0.983 Vali Loss: 2.060 Vali Acc: 0.482 Test Loss: 2.060 Test Acc: 0.482
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3558428
	speed: 0.1592s/iter; left time: 2240.3928s
Epoch: 9 cost time: 6.143383741378784
Epoch: 9, Steps: 154 | Train Loss: 0.941 Vali Loss: 1.765 Vali Acc: 0.523 Test Loss: 1.765 Test Acc: 0.523
Validation loss decreased (-0.502415 --> -0.523097).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0828059
	speed: 0.1579s/iter; left time: 2196.8498s
Epoch: 10 cost time: 6.540069818496704
Epoch: 10, Steps: 154 | Train Loss: 0.887 Vali Loss: 1.853 Vali Acc: 0.514 Test Loss: 1.853 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1258256
	speed: 0.1623s/iter; left time: 2233.2221s
Epoch: 11 cost time: 6.428400754928589
Epoch: 11, Steps: 154 | Train Loss: 0.838 Vali Loss: 1.941 Vali Acc: 0.500 Test Loss: 1.941 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9603631
	speed: 0.1347s/iter; left time: 1832.5257s
Epoch: 12 cost time: 4.328436374664307
Epoch: 12, Steps: 154 | Train Loss: 0.802 Vali Loss: 2.181 Vali Acc: 0.485 Test Loss: 2.181 Test Acc: 0.485
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.8763907
	speed: 0.1160s/iter; left time: 1561.1835s
Epoch: 13 cost time: 4.515343427658081
Epoch: 13, Steps: 154 | Train Loss: 0.738 Vali Loss: 2.070 Vali Acc: 0.504 Test Loss: 2.070 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.6886437
	speed: 0.1343s/iter; left time: 1786.0640s
Epoch: 14 cost time: 5.1321940422058105
Epoch: 14, Steps: 154 | Train Loss: 0.705 Vali Loss: 2.212 Vali Acc: 0.459 Test Loss: 2.212 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3321032
	speed: 0.1496s/iter; left time: 1967.0610s
Epoch: 15 cost time: 6.13701605796814
Epoch: 15, Steps: 154 | Train Loss: 0.679 Vali Loss: 1.921 Vali Acc: 0.499 Test Loss: 1.921 Test Acc: 0.499
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.5763888
	speed: 0.1618s/iter; left time: 2102.0094s
Epoch: 16 cost time: 6.330072402954102
Epoch: 16, Steps: 154 | Train Loss: 0.630 Vali Loss: 2.052 Vali Acc: 0.526 Test Loss: 2.052 Test Acc: 0.526
Validation loss decreased (-0.523097 --> -0.525932).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6271280
	speed: 0.1595s/iter; left time: 2047.9003s
Epoch: 17 cost time: 6.994175910949707
Epoch: 17, Steps: 154 | Train Loss: 0.606 Vali Loss: 2.083 Vali Acc: 0.499 Test Loss: 2.083 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6830493
	speed: 0.1544s/iter; left time: 1958.1134s
Epoch: 18 cost time: 6.1612303256988525
Epoch: 18, Steps: 154 | Train Loss: 0.579 Vali Loss: 2.195 Vali Acc: 0.533 Test Loss: 2.195 Test Acc: 0.533
Validation loss decreased (-0.525932 --> -0.532825).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3577572
	speed: 0.1593s/iter; left time: 1995.9933s
Epoch: 19 cost time: 6.10320520401001
Epoch: 19, Steps: 154 | Train Loss: 0.546 Vali Loss: 2.232 Vali Acc: 0.501 Test Loss: 2.232 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8755838
	speed: 0.1529s/iter; left time: 1891.8735s
Epoch: 20 cost time: 6.413127899169922
Epoch: 20, Steps: 154 | Train Loss: 0.511 Vali Loss: 2.319 Vali Acc: 0.481 Test Loss: 2.319 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2412787
	speed: 0.1261s/iter; left time: 1540.8557s
Epoch: 21 cost time: 4.890598297119141
Epoch: 21, Steps: 154 | Train Loss: 0.505 Vali Loss: 2.379 Vali Acc: 0.507 Test Loss: 2.379 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8074534
	speed: 0.1206s/iter; left time: 1454.9260s
Epoch: 22 cost time: 4.8051598072052
Epoch: 22, Steps: 154 | Train Loss: 0.451 Vali Loss: 2.109 Vali Acc: 0.529 Test Loss: 2.109 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.4034221
	speed: 0.1370s/iter; left time: 1632.6061s
Epoch: 23 cost time: 5.720813989639282
Epoch: 23, Steps: 154 | Train Loss: 0.450 Vali Loss: 2.214 Vali Acc: 0.548 Test Loss: 2.214 Test Acc: 0.548
Validation loss decreased (-0.532825 --> -0.547829).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2329768
	speed: 0.1560s/iter; left time: 1834.2203s
Epoch: 24 cost time: 6.380926847457886
Epoch: 24, Steps: 154 | Train Loss: 0.452 Vali Loss: 2.559 Vali Acc: 0.530 Test Loss: 2.559 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.6498826
	speed: 0.1561s/iter; left time: 1811.3166s
Epoch: 25 cost time: 5.684079885482788
Epoch: 25, Steps: 154 | Train Loss: 0.404 Vali Loss: 2.968 Vali Acc: 0.462 Test Loss: 2.968 Test Acc: 0.462
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.9944033
	speed: 0.1520s/iter; left time: 1741.1020s
Epoch: 26 cost time: 6.171914577484131
Epoch: 26, Steps: 154 | Train Loss: 0.411 Vali Loss: 2.594 Vali Acc: 0.466 Test Loss: 2.594 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.5184189
	speed: 0.1555s/iter; left time: 1757.0724s
Epoch: 27 cost time: 6.073439121246338
Epoch: 27, Steps: 154 | Train Loss: 0.384 Vali Loss: 2.484 Vali Acc: 0.524 Test Loss: 2.484 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.1037173
	speed: 0.1475s/iter; left time: 1644.0234s
Epoch: 28 cost time: 5.721227169036865
Epoch: 28, Steps: 154 | Train Loss: 0.371 Vali Loss: 2.533 Vali Acc: 0.529 Test Loss: 2.533 Test Acc: 0.529
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.1899051
	speed: 0.1280s/iter; left time: 1406.0627s
Epoch: 29 cost time: 4.431937217712402
Epoch: 29, Steps: 154 | Train Loss: 0.382 Vali Loss: 2.651 Vali Acc: 0.512 Test Loss: 2.651 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.3531619
	speed: 0.1231s/iter; left time: 1333.5454s
Epoch: 30 cost time: 5.242673873901367
Epoch: 30, Steps: 154 | Train Loss: 0.333 Vali Loss: 2.768 Vali Acc: 0.524 Test Loss: 2.768 Test Acc: 0.524
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.4387023
	speed: 0.1420s/iter; left time: 1516.5454s
Epoch: 31 cost time: 5.403002023696899
Epoch: 31, Steps: 154 | Train Loss: 0.344 Vali Loss: 2.753 Vali Acc: 0.511 Test Loss: 2.753 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.3080193
	speed: 0.1412s/iter; left time: 1486.4430s
Epoch: 32 cost time: 5.23021936416626
Epoch: 32, Steps: 154 | Train Loss: 0.334 Vali Loss: 3.054 Vali Acc: 0.473 Test Loss: 3.054 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.4464820
	speed: 0.1350s/iter; left time: 1400.3574s
Epoch: 33 cost time: 5.094997882843018
Epoch: 33, Steps: 154 | Train Loss: 0.304 Vali Loss: 2.744 Vali Acc: 0.518 Test Loss: 2.744 Test Acc: 0.518
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5478507704785077
model parameter : 66574
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2062497
	speed: 0.0498s/iter; left time: 761.7468s
Epoch: 1 cost time: 6.681862831115723
Epoch: 1, Steps: 154 | Train Loss: 2.290 Vali Loss: 2.011 Vali Acc: 0.358 Test Loss: 2.011 Test Acc: 0.358
Validation loss decreased (inf --> -0.358050).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5704122
	speed: 0.1468s/iter; left time: 2223.3595s
Epoch: 2 cost time: 5.865516424179077
Epoch: 2, Steps: 154 | Train Loss: 1.726 Vali Loss: 1.643 Vali Acc: 0.468 Test Loss: 1.643 Test Acc: 0.468
Validation loss decreased (-0.358050 --> -0.467542).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1780027
	speed: 0.1520s/iter; left time: 2279.3774s
Epoch: 3 cost time: 6.086120128631592
Epoch: 3, Steps: 154 | Train Loss: 1.353 Vali Loss: 1.871 Vali Acc: 0.456 Test Loss: 1.871 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.2219350
	speed: 0.1398s/iter; left time: 2074.2057s
Epoch: 4 cost time: 4.526874780654907
Epoch: 4, Steps: 154 | Train Loss: 1.222 Vali Loss: 1.740 Vali Acc: 0.483 Test Loss: 1.740 Test Acc: 0.483
Validation loss decreased (-0.467542 --> -0.482951).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1975800
	speed: 0.1232s/iter; left time: 1808.5721s
Epoch: 5 cost time: 4.372457027435303
Epoch: 5, Steps: 154 | Train Loss: 1.155 Vali Loss: 1.725 Vali Acc: 0.490 Test Loss: 1.725 Test Acc: 0.490
Validation loss decreased (-0.482951 --> -0.490250).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2167317
	speed: 0.1316s/iter; left time: 1911.7955s
Epoch: 6 cost time: 5.931377649307251
Epoch: 6, Steps: 154 | Train Loss: 1.108 Vali Loss: 1.758 Vali Acc: 0.503 Test Loss: 1.758 Test Acc: 0.503
Validation loss decreased (-0.490250 --> -0.502821).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2646600
	speed: 0.1468s/iter; left time: 2110.6622s
Epoch: 7 cost time: 5.6556737422943115
Epoch: 7, Steps: 154 | Train Loss: 1.063 Vali Loss: 1.824 Vali Acc: 0.504 Test Loss: 1.824 Test Acc: 0.504
Validation loss decreased (-0.502821 --> -0.504442).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3726438
	speed: 0.1476s/iter; left time: 2099.1137s
Epoch: 8 cost time: 5.804275035858154
Epoch: 8, Steps: 154 | Train Loss: 1.012 Vali Loss: 1.745 Vali Acc: 0.521 Test Loss: 1.745 Test Acc: 0.521
Validation loss decreased (-0.504442 --> -0.520664).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6251402
	speed: 0.1437s/iter; left time: 2021.5086s
Epoch: 9 cost time: 5.567316293716431
Epoch: 9, Steps: 154 | Train Loss: 0.971 Vali Loss: 1.717 Vali Acc: 0.488 Test Loss: 1.717 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0925504
	speed: 0.1467s/iter; left time: 2041.2491s
Epoch: 10 cost time: 5.840025186538696
Epoch: 10, Steps: 154 | Train Loss: 0.920 Vali Loss: 1.684 Vali Acc: 0.535 Test Loss: 1.684 Test Acc: 0.535
Validation loss decreased (-0.520664 --> -0.535263).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8130728
	speed: 0.1480s/iter; left time: 2037.0670s
Epoch: 11 cost time: 5.620741367340088
Epoch: 11, Steps: 154 | Train Loss: 0.863 Vali Loss: 1.854 Vali Acc: 0.539 Test Loss: 1.854 Test Acc: 0.539
Validation loss decreased (-0.535263 --> -0.538911).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3686323
	speed: 0.1320s/iter; left time: 1796.1108s
Epoch: 12 cost time: 5.023742198944092
Epoch: 12, Steps: 154 | Train Loss: 0.816 Vali Loss: 1.814 Vali Acc: 0.519 Test Loss: 1.814 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9349129
	speed: 0.1327s/iter; left time: 1785.0335s
Epoch: 13 cost time: 5.3249828815460205
Epoch: 13, Steps: 154 | Train Loss: 0.797 Vali Loss: 2.002 Vali Acc: 0.511 Test Loss: 2.002 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.4748787
	speed: 0.1428s/iter; left time: 1899.1921s
Epoch: 14 cost time: 5.35800313949585
Epoch: 14, Steps: 154 | Train Loss: 0.743 Vali Loss: 2.029 Vali Acc: 0.481 Test Loss: 2.029 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6782980
	speed: 0.1279s/iter; left time: 1681.4837s
Epoch: 15 cost time: 5.123083829879761
Epoch: 15, Steps: 154 | Train Loss: 0.722 Vali Loss: 1.929 Vali Acc: 0.509 Test Loss: 1.929 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.4272617
	speed: 0.1292s/iter; left time: 1678.4480s
Epoch: 16 cost time: 4.71269154548645
Epoch: 16, Steps: 154 | Train Loss: 0.703 Vali Loss: 2.153 Vali Acc: 0.509 Test Loss: 2.153 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0372485
	speed: 0.1251s/iter; left time: 1606.3828s
Epoch: 17 cost time: 4.739462852478027
Epoch: 17, Steps: 154 | Train Loss: 0.649 Vali Loss: 2.274 Vali Acc: 0.479 Test Loss: 2.274 Test Acc: 0.479
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.4776961
	speed: 0.1283s/iter; left time: 1627.1417s
Epoch: 18 cost time: 4.935812950134277
Epoch: 18, Steps: 154 | Train Loss: 0.624 Vali Loss: 1.996 Vali Acc: 0.524 Test Loss: 1.996 Test Acc: 0.524
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.5810685
	speed: 0.1303s/iter; left time: 1632.7117s
Epoch: 19 cost time: 4.8137266635894775
Epoch: 19, Steps: 154 | Train Loss: 0.611 Vali Loss: 2.109 Vali Acc: 0.494 Test Loss: 2.109 Test Acc: 0.494
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.1044058
	speed: 0.1264s/iter; left time: 1563.8792s
Epoch: 20 cost time: 4.772098541259766
Epoch: 20, Steps: 154 | Train Loss: 0.593 Vali Loss: 2.035 Vali Acc: 0.502 Test Loss: 2.035 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.2300980
	speed: 0.1351s/iter; left time: 1650.8278s
Epoch: 21 cost time: 5.45001220703125
Epoch: 21, Steps: 154 | Train Loss: 0.557 Vali Loss: 2.332 Vali Acc: 0.468 Test Loss: 2.332 Test Acc: 0.468
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5389294403892944
model parameter : 61230
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4540769
	speed: 0.0506s/iter; left time: 774.3615s
Epoch: 1 cost time: 6.660667896270752
Epoch: 1, Steps: 154 | Train Loss: 2.057 Vali Loss: 1.943 Vali Acc: 0.378 Test Loss: 1.943 Test Acc: 0.378
Validation loss decreased (inf --> -0.377515).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5924547
	speed: 0.1269s/iter; left time: 1921.4483s
Epoch: 2 cost time: 4.615119695663452
Epoch: 2, Steps: 154 | Train Loss: 1.451 Vali Loss: 1.702 Vali Acc: 0.485 Test Loss: 1.702 Test Acc: 0.485
Validation loss decreased (-0.377515 --> -0.485384).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6672065
	speed: 0.1337s/iter; left time: 2004.7092s
Epoch: 3 cost time: 5.528286695480347
Epoch: 3, Steps: 154 | Train Loss: 1.252 Vali Loss: 2.351 Vali Acc: 0.437 Test Loss: 2.351 Test Acc: 0.437
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6350085
	speed: 0.1392s/iter; left time: 2065.3253s
Epoch: 4 cost time: 5.629944562911987
Epoch: 4, Steps: 154 | Train Loss: 1.150 Vali Loss: 1.766 Vali Acc: 0.528 Test Loss: 1.766 Test Acc: 0.528
Validation loss decreased (-0.485384 --> -0.527557).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8869328
	speed: 0.1460s/iter; left time: 2143.9339s
Epoch: 5 cost time: 5.417573928833008
Epoch: 5, Steps: 154 | Train Loss: 1.035 Vali Loss: 2.099 Vali Acc: 0.468 Test Loss: 2.099 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.6871828
	speed: 0.1411s/iter; left time: 2049.6743s
Epoch: 6 cost time: 5.376734018325806
Epoch: 6, Steps: 154 | Train Loss: 0.930 Vali Loss: 2.094 Vali Acc: 0.485 Test Loss: 2.094 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.5960830
	speed: 0.1246s/iter; left time: 1791.7149s
Epoch: 7 cost time: 4.590451717376709
Epoch: 7, Steps: 154 | Train Loss: 0.899 Vali Loss: 2.205 Vali Acc: 0.467 Test Loss: 2.205 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.6810899
	speed: 0.1251s/iter; left time: 1780.0051s
Epoch: 8 cost time: 4.959571599960327
Epoch: 8, Steps: 154 | Train Loss: 0.857 Vali Loss: 2.074 Vali Acc: 0.507 Test Loss: 2.074 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.8325346
	speed: 0.1571s/iter; left time: 2209.5596s
Epoch: 9 cost time: 5.910863399505615
Epoch: 9, Steps: 154 | Train Loss: 0.732 Vali Loss: 2.224 Vali Acc: 0.471 Test Loss: 2.224 Test Acc: 0.471
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.7636371
	speed: 0.1623s/iter; left time: 2258.2913s
Epoch: 10 cost time: 6.456423997879028
Epoch: 10, Steps: 154 | Train Loss: 0.704 Vali Loss: 2.353 Vali Acc: 0.455 Test Loss: 2.353 Test Acc: 0.455
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.3142186
	speed: 0.1675s/iter; left time: 2305.0978s
Epoch: 11 cost time: 6.978943347930908
Epoch: 11, Steps: 154 | Train Loss: 0.631 Vali Loss: 2.391 Vali Acc: 0.494 Test Loss: 2.391 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.5215807
	speed: 0.1745s/iter; left time: 2373.8341s
Epoch: 12 cost time: 7.5891640186309814
Epoch: 12, Steps: 154 | Train Loss: 0.558 Vali Loss: 2.507 Vali Acc: 0.485 Test Loss: 2.507 Test Acc: 0.485
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.0025347
	speed: 0.1619s/iter; left time: 2178.6278s
Epoch: 13 cost time: 6.734948635101318
Epoch: 13, Steps: 154 | Train Loss: 0.504 Vali Loss: 2.698 Vali Acc: 0.427 Test Loss: 2.698 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7586031
	speed: 0.1604s/iter; left time: 2132.7776s
Epoch: 14 cost time: 6.415799379348755
Epoch: 14, Steps: 154 | Train Loss: 0.475 Vali Loss: 2.806 Vali Acc: 0.480 Test Loss: 2.806 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5275750202757502
model parameter : 122318
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9526156
	speed: 0.0463s/iter; left time: 708.0054s
Epoch: 1 cost time: 6.929532051086426
Epoch: 1, Steps: 154 | Train Loss: 2.123 Vali Loss: 1.858 Vali Acc: 0.397 Test Loss: 1.858 Test Acc: 0.397
Validation loss decreased (inf --> -0.397386).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6482086
	speed: 0.1499s/iter; left time: 2269.9960s
Epoch: 2 cost time: 5.972581148147583
Epoch: 2, Steps: 154 | Train Loss: 1.459 Vali Loss: 1.916 Vali Acc: 0.447 Test Loss: 1.916 Test Acc: 0.447
Validation loss decreased (-0.397386 --> -0.446858).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3300915
	speed: 0.1554s/iter; left time: 2330.4212s
Epoch: 3 cost time: 6.3841233253479
Epoch: 3, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.068 Vali Acc: 0.471 Test Loss: 2.068 Test Acc: 0.471
Validation loss decreased (-0.446858 --> -0.470782).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0111204
	speed: 0.1322s/iter; left time: 1962.4024s
Epoch: 4 cost time: 4.046767234802246
Epoch: 4, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.957 Vali Acc: 0.474 Test Loss: 1.957 Test Acc: 0.474
Validation loss decreased (-0.470782 --> -0.473622).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3620703
	speed: 0.1176s/iter; left time: 1727.1799s
Epoch: 5 cost time: 4.542095184326172
Epoch: 5, Steps: 154 | Train Loss: 1.047 Vali Loss: 1.771 Vali Acc: 0.488 Test Loss: 1.771 Test Acc: 0.488
Validation loss decreased (-0.473622 --> -0.488222).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9227815
	speed: 0.1359s/iter; left time: 1974.7622s
Epoch: 6 cost time: 5.948346138000488
Epoch: 6, Steps: 154 | Train Loss: 0.966 Vali Loss: 1.829 Vali Acc: 0.498 Test Loss: 1.829 Test Acc: 0.498
Validation loss decreased (-0.488222 --> -0.498360).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5643373
	speed: 0.1526s/iter; left time: 2194.2846s
Epoch: 7 cost time: 6.04157829284668
Epoch: 7, Steps: 154 | Train Loss: 0.900 Vali Loss: 1.835 Vali Acc: 0.497 Test Loss: 1.835 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8193086
	speed: 0.1528s/iter; left time: 2173.3608s
Epoch: 8 cost time: 5.9242260456085205
Epoch: 8, Steps: 154 | Train Loss: 0.872 Vali Loss: 1.798 Vali Acc: 0.523 Test Loss: 1.798 Test Acc: 0.523
Validation loss decreased (-0.498360 --> -0.523096).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7848675
	speed: 0.1573s/iter; left time: 2212.3805s
Epoch: 9 cost time: 6.386544466018677
Epoch: 9, Steps: 154 | Train Loss: 0.804 Vali Loss: 1.933 Vali Acc: 0.496 Test Loss: 1.933 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.3134026
	speed: 0.1535s/iter; left time: 2136.6477s
Epoch: 10 cost time: 6.213119029998779
Epoch: 10, Steps: 154 | Train Loss: 0.740 Vali Loss: 2.046 Vali Acc: 0.489 Test Loss: 2.046 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.9129783
	speed: 0.1586s/iter; left time: 2182.2804s
Epoch: 11 cost time: 6.165128469467163
Epoch: 11, Steps: 154 | Train Loss: 0.696 Vali Loss: 2.072 Vali Acc: 0.431 Test Loss: 2.072 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.0374749
	speed: 0.1558s/iter; left time: 2119.4360s
Epoch: 12 cost time: 6.457846641540527
Epoch: 12, Steps: 154 | Train Loss: 0.639 Vali Loss: 2.099 Vali Acc: 0.463 Test Loss: 2.099 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.2881156
	speed: 0.1530s/iter; left time: 2058.7111s
Epoch: 13 cost time: 5.610891342163086
Epoch: 13, Steps: 154 | Train Loss: 0.615 Vali Loss: 2.102 Vali Acc: 0.479 Test Loss: 2.102 Test Acc: 0.479
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7207646
	speed: 0.1534s/iter; left time: 2039.8839s
Epoch: 14 cost time: 5.954072952270508
Epoch: 14, Steps: 154 | Train Loss: 0.573 Vali Loss: 2.174 Vali Acc: 0.503 Test Loss: 2.174 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.5196378
	speed: 0.1545s/iter; left time: 2031.1771s
Epoch: 15 cost time: 6.162927865982056
Epoch: 15, Steps: 154 | Train Loss: 0.526 Vali Loss: 2.258 Vali Acc: 0.520 Test Loss: 2.258 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.6318367
	speed: 0.1397s/iter; left time: 1814.6303s
Epoch: 16 cost time: 4.740709543228149
Epoch: 16, Steps: 154 | Train Loss: 0.531 Vali Loss: 2.568 Vali Acc: 0.462 Test Loss: 2.568 Test Acc: 0.462
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.7623634
	speed: 0.1269s/iter; left time: 1628.3846s
Epoch: 17 cost time: 4.771627187728882
Epoch: 17, Steps: 154 | Train Loss: 0.468 Vali Loss: 2.348 Vali Acc: 0.525 Test Loss: 2.348 Test Acc: 0.525
Validation loss decreased (-0.523096 --> -0.525118).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4513104
	speed: 0.1348s/iter; left time: 1710.0234s
Epoch: 18 cost time: 4.956430673599243
Epoch: 18, Steps: 154 | Train Loss: 0.427 Vali Loss: 2.491 Vali Acc: 0.484 Test Loss: 2.491 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4018404
	speed: 0.1402s/iter; left time: 1756.2967s
Epoch: 19 cost time: 5.312034606933594
Epoch: 19, Steps: 154 | Train Loss: 0.422 Vali Loss: 2.466 Vali Acc: 0.515 Test Loss: 2.466 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.6425713
	speed: 0.1452s/iter; left time: 1796.5658s
Epoch: 20 cost time: 5.605237722396851
Epoch: 20, Steps: 154 | Train Loss: 0.381 Vali Loss: 2.573 Vali Acc: 0.527 Test Loss: 2.573 Test Acc: 0.527
Validation loss decreased (-0.525118 --> -0.526738).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.3665338
	speed: 0.1339s/iter; left time: 1636.4799s
Epoch: 21 cost time: 5.2611634731292725
Epoch: 21, Steps: 154 | Train Loss: 0.365 Vali Loss: 2.510 Vali Acc: 0.525 Test Loss: 2.510 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1290199
	speed: 0.1320s/iter; left time: 1592.5985s
Epoch: 22 cost time: 4.429224967956543
Epoch: 22, Steps: 154 | Train Loss: 0.338 Vali Loss: 2.845 Vali Acc: 0.478 Test Loss: 2.845 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.3673528
	speed: 0.1156s/iter; left time: 1376.9047s
Epoch: 23 cost time: 4.081852674484253
Epoch: 23, Steps: 154 | Train Loss: 0.340 Vali Loss: 2.678 Vali Acc: 0.527 Test Loss: 2.678 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.4394172
	speed: 0.1158s/iter; left time: 1361.6309s
Epoch: 24 cost time: 4.583976984024048
Epoch: 24, Steps: 154 | Train Loss: 0.336 Vali Loss: 2.820 Vali Acc: 0.532 Test Loss: 2.820 Test Acc: 0.532
Validation loss decreased (-0.526738 --> -0.531602).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.1195284
	speed: 0.1488s/iter; left time: 1727.0893s
Epoch: 25 cost time: 6.028461217880249
Epoch: 25, Steps: 154 | Train Loss: 0.314 Vali Loss: 2.869 Vali Acc: 0.478 Test Loss: 2.869 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.2430747
	speed: 0.1432s/iter; left time: 1639.4381s
Epoch: 26 cost time: 5.854304790496826
Epoch: 26, Steps: 154 | Train Loss: 0.286 Vali Loss: 3.088 Vali Acc: 0.502 Test Loss: 3.088 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.2069427
	speed: 0.1492s/iter; left time: 1685.2555s
Epoch: 27 cost time: 5.894317388534546
Epoch: 27, Steps: 154 | Train Loss: 0.269 Vali Loss: 2.863 Vali Acc: 0.506 Test Loss: 2.863 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.3820033
	speed: 0.1450s/iter; left time: 1616.2613s
Epoch: 28 cost time: 5.6213884353637695
Epoch: 28, Steps: 154 | Train Loss: 0.277 Vali Loss: 3.008 Vali Acc: 0.528 Test Loss: 3.008 Test Acc: 0.528
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.1428811
	speed: 0.1518s/iter; left time: 1668.3753s
Epoch: 29 cost time: 6.049658298492432
Epoch: 29, Steps: 154 | Train Loss: 0.269 Vali Loss: 3.150 Vali Acc: 0.530 Test Loss: 3.150 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.8756666
	speed: 0.1407s/iter; left time: 1524.7873s
Epoch: 30 cost time: 4.706046104431152
Epoch: 30, Steps: 154 | Train Loss: 0.244 Vali Loss: 3.202 Vali Acc: 0.520 Test Loss: 3.202 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.5244073
	speed: 0.1291s/iter; left time: 1379.2279s
Epoch: 31 cost time: 4.917722463607788
Epoch: 31, Steps: 154 | Train Loss: 0.249 Vali Loss: 3.347 Vali Acc: 0.502 Test Loss: 3.347 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.3511765
	speed: 0.1420s/iter; left time: 1495.0708s
Epoch: 32 cost time: 5.989659309387207
Epoch: 32, Steps: 154 | Train Loss: 0.241 Vali Loss: 3.345 Vali Acc: 0.532 Test Loss: 3.345 Test Acc: 0.532
Validation loss decreased (-0.531602 --> -0.532408).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0165662
	speed: 0.1505s/iter; left time: 1561.6228s
Epoch: 33 cost time: 5.423175811767578
Epoch: 33, Steps: 154 | Train Loss: 0.225 Vali Loss: 3.270 Vali Acc: 0.536 Test Loss: 3.270 Test Acc: 0.536
Validation loss decreased (-0.532408 --> -0.535653).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.1213840
	speed: 0.1482s/iter; left time: 1514.0505s
Epoch: 34 cost time: 6.04215145111084
Epoch: 34, Steps: 154 | Train Loss: 0.237 Vali Loss: 3.572 Vali Acc: 0.530 Test Loss: 3.572 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.1438684
	speed: 0.1459s/iter; left time: 1468.3156s
Epoch: 35 cost time: 5.409398317337036
Epoch: 35, Steps: 154 | Train Loss: 0.214 Vali Loss: 3.408 Vali Acc: 0.512 Test Loss: 3.408 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.4097574
	speed: 0.1419s/iter; left time: 1405.9053s
Epoch: 36 cost time: 5.521596193313599
Epoch: 36, Steps: 154 | Train Loss: 0.183 Vali Loss: 3.521 Vali Acc: 0.521 Test Loss: 3.521 Test Acc: 0.521
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0601119
	speed: 0.1185s/iter; left time: 1156.5924s
Epoch: 37 cost time: 4.160699844360352
Epoch: 37, Steps: 154 | Train Loss: 0.215 Vali Loss: 3.820 Vali Acc: 0.522 Test Loss: 3.820 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.3176653
	speed: 0.1182s/iter; left time: 1134.6329s
Epoch: 38 cost time: 4.847752571105957
Epoch: 38, Steps: 154 | Train Loss: 0.198 Vali Loss: 3.585 Vali Acc: 0.484 Test Loss: 3.585 Test Acc: 0.484
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0469128
	speed: 0.1291s/iter; left time: 1220.2263s
Epoch: 39 cost time: 4.796600103378296
Epoch: 39, Steps: 154 | Train Loss: 0.209 Vali Loss: 3.524 Vali Acc: 0.536 Test Loss: 3.524 Test Acc: 0.536
Validation loss decreased (-0.535653 --> -0.536056).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0171450
	speed: 0.1261s/iter; left time: 1171.9534s
Epoch: 40 cost time: 4.768827199935913
Epoch: 40, Steps: 154 | Train Loss: 0.179 Vali Loss: 3.869 Vali Acc: 0.482 Test Loss: 3.869 Test Acc: 0.482
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.0826684
	speed: 0.1342s/iter; left time: 1226.6625s
Epoch: 41 cost time: 4.776774168014526
Epoch: 41, Steps: 154 | Train Loss: 0.191 Vali Loss: 3.865 Vali Acc: 0.545 Test Loss: 3.865 Test Acc: 0.545
Validation loss decreased (-0.536056 --> -0.544974).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.3252689
	speed: 0.1318s/iter; left time: 1184.4416s
Epoch: 42 cost time: 4.832628488540649
Epoch: 42, Steps: 154 | Train Loss: 0.182 Vali Loss: 3.936 Vali Acc: 0.513 Test Loss: 3.936 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 0.0377771
	speed: 0.1242s/iter; left time: 1096.9816s
Epoch: 43 cost time: 4.508702516555786
Epoch: 43, Steps: 154 | Train Loss: 0.170 Vali Loss: 3.902 Vali Acc: 0.511 Test Loss: 3.902 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 0.3762609
	speed: 0.1434s/iter; left time: 1244.3661s
Epoch: 44 cost time: 5.443441152572632
Epoch: 44, Steps: 154 | Train Loss: 0.158 Vali Loss: 3.727 Vali Acc: 0.513 Test Loss: 3.727 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.1854709
	speed: 0.1335s/iter; left time: 1137.9406s
Epoch: 45 cost time: 4.753427028656006
Epoch: 45, Steps: 154 | Train Loss: 0.149 Vali Loss: 3.772 Vali Acc: 0.519 Test Loss: 3.772 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 0.0107512
	speed: 0.1234s/iter; left time: 1033.1264s
Epoch: 46 cost time: 4.799527406692505
Epoch: 46, Steps: 154 | Train Loss: 0.152 Vali Loss: 3.896 Vali Acc: 0.497 Test Loss: 3.896 Test Acc: 0.497
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 0.2264529
	speed: 0.1376s/iter; left time: 1130.4802s
Epoch: 47 cost time: 5.182755708694458
Epoch: 47, Steps: 154 | Train Loss: 0.175 Vali Loss: 3.902 Vali Acc: 0.495 Test Loss: 3.902 Test Acc: 0.495
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 48 | loss: 0.0369837
	speed: 0.1363s/iter; left time: 1099.1285s
Epoch: 48 cost time: 5.199667930603027
Epoch: 48, Steps: 154 | Train Loss: 0.161 Vali Loss: 3.974 Vali Acc: 0.515 Test Loss: 3.974 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 49 | loss: 0.0328206
	speed: 0.1420s/iter; left time: 1122.8335s
Epoch: 49 cost time: 5.1112425327301025
Epoch: 49, Steps: 154 | Train Loss: 0.166 Vali Loss: 4.150 Vali Acc: 0.509 Test Loss: 4.150 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 50 | loss: 0.1093655
	speed: 0.1316s/iter; left time: 1020.8726s
Epoch: 50 cost time: 5.124749422073364
Epoch: 50, Steps: 154 | Train Loss: 0.126 Vali Loss: 4.464 Vali Acc: 0.516 Test Loss: 4.464 Test Acc: 0.516
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 51 | loss: 0.2643028
	speed: 0.1393s/iter; left time: 1058.8976s
Epoch: 51 cost time: 5.292020559310913
Epoch: 51, Steps: 154 | Train Loss: 0.141 Vali Loss: 4.389 Vali Acc: 0.474 Test Loss: 4.389 Test Acc: 0.474
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5450121654501217
model parameter : 73966
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1160319
	speed: 0.0637s/iter; left time: 974.9484s
Epoch: 1 cost time: 8.974377393722534
Epoch: 1, Steps: 154 | Train Loss: 2.143 Vali Loss: 1.835 Vali Acc: 0.412 Test Loss: 1.835 Test Acc: 0.412
Validation loss decreased (inf --> -0.411579).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1605449
	speed: 0.1740s/iter; left time: 2634.8703s
Epoch: 2 cost time: 7.08626651763916
Epoch: 2, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.092 Vali Acc: 0.432 Test Loss: 2.092 Test Acc: 0.432
Validation loss decreased (-0.411579 --> -0.431853).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6571089
	speed: 0.1618s/iter; left time: 2426.5547s
Epoch: 3 cost time: 5.984801292419434
Epoch: 3, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.172 Vali Acc: 0.446 Test Loss: 2.172 Test Acc: 0.446
Validation loss decreased (-0.431853 --> -0.446045).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2994919
	speed: 0.1423s/iter; left time: 2112.1888s
Epoch: 4 cost time: 6.118138313293457
Epoch: 4, Steps: 154 | Train Loss: 1.172 Vali Loss: 1.872 Vali Acc: 0.449 Test Loss: 1.872 Test Acc: 0.449
Validation loss decreased (-0.446045 --> -0.449292).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2653266
	speed: 0.1499s/iter; left time: 2201.2082s
Epoch: 5 cost time: 6.068893194198608
Epoch: 5, Steps: 154 | Train Loss: 1.089 Vali Loss: 2.129 Vali Acc: 0.461 Test Loss: 2.129 Test Acc: 0.461
Validation loss decreased (-0.449292 --> -0.460644).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4061861
	speed: 0.1526s/iter; left time: 2218.1493s
Epoch: 6 cost time: 6.3935112953186035
Epoch: 6, Steps: 154 | Train Loss: 0.986 Vali Loss: 2.122 Vali Acc: 0.453 Test Loss: 2.122 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0738661
	speed: 0.1515s/iter; left time: 2177.7604s
Epoch: 7 cost time: 5.698765993118286
Epoch: 7, Steps: 154 | Train Loss: 0.947 Vali Loss: 1.733 Vali Acc: 0.528 Test Loss: 1.733 Test Acc: 0.528
Validation loss decreased (-0.460644 --> -0.527963).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3068106
	speed: 0.1424s/iter; left time: 2025.9350s
Epoch: 8 cost time: 5.332868814468384
Epoch: 8, Steps: 154 | Train Loss: 0.876 Vali Loss: 1.824 Vali Acc: 0.530 Test Loss: 1.824 Test Acc: 0.530
Validation loss decreased (-0.527963 --> -0.529584).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3716454
	speed: 0.1435s/iter; left time: 2018.7238s
Epoch: 9 cost time: 5.244004011154175
Epoch: 9, Steps: 154 | Train Loss: 0.817 Vali Loss: 1.814 Vali Acc: 0.505 Test Loss: 1.814 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8995242
	speed: 0.1396s/iter; left time: 1941.8634s
Epoch: 10 cost time: 4.862665891647339
Epoch: 10, Steps: 154 | Train Loss: 0.770 Vali Loss: 1.903 Vali Acc: 0.504 Test Loss: 1.903 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.5371303
	speed: 0.1254s/iter; left time: 1725.0847s
Epoch: 11 cost time: 4.60478138923645
Epoch: 11, Steps: 154 | Train Loss: 0.719 Vali Loss: 1.991 Vali Acc: 0.505 Test Loss: 1.991 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.5751100
	speed: 0.1360s/iter; left time: 1850.8473s
Epoch: 12 cost time: 6.090591192245483
Epoch: 12, Steps: 154 | Train Loss: 0.691 Vali Loss: 2.010 Vali Acc: 0.462 Test Loss: 2.010 Test Acc: 0.462
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6244617
	speed: 0.1490s/iter; left time: 2004.3462s
Epoch: 13 cost time: 5.908839464187622
Epoch: 13, Steps: 154 | Train Loss: 0.629 Vali Loss: 2.045 Vali Acc: 0.511 Test Loss: 2.045 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5026984
	speed: 0.1463s/iter; left time: 1945.1798s
Epoch: 14 cost time: 5.676630020141602
Epoch: 14, Steps: 154 | Train Loss: 0.589 Vali Loss: 2.085 Vali Acc: 0.486 Test Loss: 2.085 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3739637
	speed: 0.1446s/iter; left time: 1900.1207s
Epoch: 15 cost time: 5.802139759063721
Epoch: 15, Steps: 154 | Train Loss: 0.547 Vali Loss: 1.973 Vali Acc: 0.547 Test Loss: 1.973 Test Acc: 0.547
Validation loss decreased (-0.529584 --> -0.546614).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4077989
	speed: 0.1501s/iter; left time: 1949.6133s
Epoch: 16 cost time: 5.926689147949219
Epoch: 16, Steps: 154 | Train Loss: 0.512 Vali Loss: 2.230 Vali Acc: 0.531 Test Loss: 2.230 Test Acc: 0.531
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6438448
	speed: 0.1436s/iter; left time: 1843.5204s
Epoch: 17 cost time: 5.651059150695801
Epoch: 17, Steps: 154 | Train Loss: 0.488 Vali Loss: 2.188 Vali Acc: 0.508 Test Loss: 2.188 Test Acc: 0.508
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2962964
	speed: 0.1469s/iter; left time: 1863.0484s
Epoch: 18 cost time: 5.732004165649414
Epoch: 18, Steps: 154 | Train Loss: 0.442 Vali Loss: 2.191 Vali Acc: 0.500 Test Loss: 2.191 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.4407036
	speed: 0.1481s/iter; left time: 1855.3310s
Epoch: 19 cost time: 5.669770240783691
Epoch: 19, Steps: 154 | Train Loss: 0.430 Vali Loss: 2.293 Vali Acc: 0.523 Test Loss: 2.293 Test Acc: 0.523
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.4549742
	speed: 0.1454s/iter; left time: 1799.3834s
Epoch: 20 cost time: 5.5598039627075195
Epoch: 20, Steps: 154 | Train Loss: 0.419 Vali Loss: 2.447 Vali Acc: 0.504 Test Loss: 2.447 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.3061864
	speed: 0.1445s/iter; left time: 1765.8543s
Epoch: 21 cost time: 5.48912787437439
Epoch: 21, Steps: 154 | Train Loss: 0.356 Vali Loss: 2.450 Vali Acc: 0.541 Test Loss: 2.450 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2405449
	speed: 0.1443s/iter; left time: 1741.2666s
Epoch: 22 cost time: 5.6647961139678955
Epoch: 22, Steps: 154 | Train Loss: 0.368 Vali Loss: 2.654 Vali Acc: 0.483 Test Loss: 2.654 Test Acc: 0.483
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.3635811
	speed: 0.1487s/iter; left time: 1771.8982s
Epoch: 23 cost time: 5.633606433868408
Epoch: 23, Steps: 154 | Train Loss: 0.325 Vali Loss: 2.694 Vali Acc: 0.517 Test Loss: 2.694 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2674282
	speed: 0.1436s/iter; left time: 1688.2547s
Epoch: 24 cost time: 5.0824785232543945
Epoch: 24, Steps: 154 | Train Loss: 0.316 Vali Loss: 2.613 Vali Acc: 0.532 Test Loss: 2.613 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.2455213
	speed: 0.1144s/iter; left time: 1327.1813s
Epoch: 25 cost time: 3.8470635414123535
Epoch: 25, Steps: 154 | Train Loss: 0.319 Vali Loss: 2.733 Vali Acc: 0.529 Test Loss: 2.733 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5466342254663422
model parameter : 73998
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0660651
	speed: 0.0448s/iter; left time: 685.0982s
Epoch: 1 cost time: 6.329613208770752
Epoch: 1, Steps: 154 | Train Loss: 2.161 Vali Loss: 1.803 Vali Acc: 0.414 Test Loss: 1.803 Test Acc: 0.414
Validation loss decreased (inf --> -0.414013).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6838233
	speed: 0.1223s/iter; left time: 1853.1403s
Epoch: 2 cost time: 5.107779026031494
Epoch: 2, Steps: 154 | Train Loss: 1.507 Vali Loss: 1.813 Vali Acc: 0.453 Test Loss: 1.813 Test Acc: 0.453
Validation loss decreased (-0.414013 --> -0.452537).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3263413
	speed: 0.1242s/iter; left time: 1861.8176s
Epoch: 3 cost time: 4.736207723617554
Epoch: 3, Steps: 154 | Train Loss: 1.305 Vali Loss: 2.000 Vali Acc: 0.457 Test Loss: 2.000 Test Acc: 0.457
Validation loss decreased (-0.452537 --> -0.457401).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8858989
	speed: 0.1223s/iter; left time: 1814.7484s
Epoch: 4 cost time: 4.451940536499023
Epoch: 4, Steps: 154 | Train Loss: 1.200 Vali Loss: 1.786 Vali Acc: 0.452 Test Loss: 1.786 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3543760
	speed: 0.1308s/iter; left time: 1921.0547s
Epoch: 5 cost time: 5.668267011642456
Epoch: 5, Steps: 154 | Train Loss: 1.105 Vali Loss: 1.884 Vali Acc: 0.509 Test Loss: 1.884 Test Acc: 0.509
Validation loss decreased (-0.457401 --> -0.509308).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8816427
	speed: 0.1385s/iter; left time: 2012.6512s
Epoch: 6 cost time: 5.433934211730957
Epoch: 6, Steps: 154 | Train Loss: 1.038 Vali Loss: 1.958 Vali Acc: 0.440 Test Loss: 1.958 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8983866
	speed: 0.1392s/iter; left time: 2000.9150s
Epoch: 7 cost time: 5.608470916748047
Epoch: 7, Steps: 154 | Train Loss: 0.984 Vali Loss: 1.768 Vali Acc: 0.524 Test Loss: 1.768 Test Acc: 0.524
Validation loss decreased (-0.509308 --> -0.523908).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9775032
	speed: 0.1254s/iter; left time: 1783.3944s
Epoch: 8 cost time: 4.570091485977173
Epoch: 8, Steps: 154 | Train Loss: 0.958 Vali Loss: 1.826 Vali Acc: 0.488 Test Loss: 1.826 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.8877005
	speed: 0.1241s/iter; left time: 1746.1550s
Epoch: 9 cost time: 4.629542350769043
Epoch: 9, Steps: 154 | Train Loss: 0.873 Vali Loss: 1.921 Vali Acc: 0.482 Test Loss: 1.921 Test Acc: 0.482
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.8830614
	speed: 0.1365s/iter; left time: 1898.8849s
Epoch: 10 cost time: 5.625557899475098
Epoch: 10, Steps: 154 | Train Loss: 0.831 Vali Loss: 1.803 Vali Acc: 0.486 Test Loss: 1.803 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5708426
	speed: 0.1366s/iter; left time: 1879.6731s
Epoch: 11 cost time: 5.079242467880249
Epoch: 11, Steps: 154 | Train Loss: 0.792 Vali Loss: 1.916 Vali Acc: 0.479 Test Loss: 1.916 Test Acc: 0.479
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.5840573
	speed: 0.1314s/iter; left time: 1788.3941s
Epoch: 12 cost time: 5.694782018661499
Epoch: 12, Steps: 154 | Train Loss: 0.750 Vali Loss: 1.936 Vali Acc: 0.511 Test Loss: 1.936 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.6442553
	speed: 0.1814s/iter; left time: 2440.4064s
Epoch: 13 cost time: 7.509356498718262
Epoch: 13, Steps: 154 | Train Loss: 0.738 Vali Loss: 1.992 Vali Acc: 0.525 Test Loss: 1.992 Test Acc: 0.525
Validation loss decreased (-0.523908 --> -0.524716).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6048833
	speed: 0.1732s/iter; left time: 2303.0855s
Epoch: 14 cost time: 6.700010538101196
Epoch: 14, Steps: 154 | Train Loss: 0.683 Vali Loss: 2.047 Vali Acc: 0.460 Test Loss: 2.047 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7986940
	speed: 0.1628s/iter; left time: 2139.8154s
Epoch: 15 cost time: 6.36301589012146
Epoch: 15, Steps: 154 | Train Loss: 0.645 Vali Loss: 1.969 Vali Acc: 0.471 Test Loss: 1.969 Test Acc: 0.471
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5195255
	speed: 0.1588s/iter; left time: 2063.0993s
Epoch: 16 cost time: 6.426939010620117
Epoch: 16, Steps: 154 | Train Loss: 0.626 Vali Loss: 2.157 Vali Acc: 0.496 Test Loss: 2.157 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8612636
	speed: 0.1621s/iter; left time: 2080.8292s
Epoch: 17 cost time: 6.349239826202393
Epoch: 17, Steps: 154 | Train Loss: 0.560 Vali Loss: 2.258 Vali Acc: 0.457 Test Loss: 2.258 Test Acc: 0.457
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4695857
	speed: 0.1677s/iter; left time: 2127.4075s
Epoch: 18 cost time: 6.898022651672363
Epoch: 18, Steps: 154 | Train Loss: 0.573 Vali Loss: 2.211 Vali Acc: 0.480 Test Loss: 2.211 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4509749
	speed: 0.1648s/iter; left time: 2065.0203s
Epoch: 19 cost time: 5.725268840789795
Epoch: 19, Steps: 154 | Train Loss: 0.502 Vali Loss: 2.401 Vali Acc: 0.497 Test Loss: 2.401 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2332447
	speed: 0.1508s/iter; left time: 1865.8457s
Epoch: 20 cost time: 5.880369663238525
Epoch: 20, Steps: 154 | Train Loss: 0.519 Vali Loss: 2.194 Vali Acc: 0.521 Test Loss: 2.194 Test Acc: 0.521
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2884734
	speed: 0.1406s/iter; left time: 1718.0721s
Epoch: 21 cost time: 5.157709360122681
Epoch: 21, Steps: 154 | Train Loss: 0.514 Vali Loss: 2.405 Vali Acc: 0.502 Test Loss: 2.405 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.7290856
	speed: 0.1483s/iter; left time: 1790.0282s
Epoch: 22 cost time: 6.43583083152771
Epoch: 22, Steps: 154 | Train Loss: 0.465 Vali Loss: 2.644 Vali Acc: 0.463 Test Loss: 2.644 Test Acc: 0.463
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2230179
	speed: 0.1571s/iter; left time: 1871.7817s
Epoch: 23 cost time: 5.63747763633728
Epoch: 23, Steps: 154 | Train Loss: 0.467 Vali Loss: 2.657 Vali Acc: 0.476 Test Loss: 2.657 Test Acc: 0.476
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5247364152473641
model parameter : 57934
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1499534
	speed: 0.0582s/iter; left time: 890.3901s
Epoch: 1 cost time: 7.90382981300354
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 1.912 Vali Acc: 0.389 Test Loss: 1.912 Test Acc: 0.389
Validation loss decreased (inf --> -0.388870).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6600921
	speed: 0.1500s/iter; left time: 2271.8828s
Epoch: 2 cost time: 5.779257297515869
Epoch: 2, Steps: 154 | Train Loss: 1.641 Vali Loss: 1.729 Vali Acc: 0.439 Test Loss: 1.729 Test Acc: 0.439
Validation loss decreased (-0.388870 --> -0.438750).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5734940
	speed: 0.1623s/iter; left time: 2433.3919s
Epoch: 3 cost time: 6.714309453964233
Epoch: 3, Steps: 154 | Train Loss: 1.336 Vali Loss: 1.809 Vali Acc: 0.470 Test Loss: 1.809 Test Acc: 0.470
Validation loss decreased (-0.438750 --> -0.470379).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8758477
	speed: 0.1599s/iter; left time: 2372.1261s
Epoch: 4 cost time: 6.582720041275024
Epoch: 4, Steps: 154 | Train Loss: 1.225 Vali Loss: 1.922 Vali Acc: 0.459 Test Loss: 1.922 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5101503
	speed: 0.1613s/iter; left time: 2368.3904s
Epoch: 5 cost time: 6.857388496398926
Epoch: 5, Steps: 154 | Train Loss: 1.162 Vali Loss: 1.924 Vali Acc: 0.459 Test Loss: 1.924 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9376994
	speed: 0.1709s/iter; left time: 2482.8494s
Epoch: 6 cost time: 6.4783031940460205
Epoch: 6, Steps: 154 | Train Loss: 1.088 Vali Loss: 1.820 Vali Acc: 0.502 Test Loss: 1.820 Test Acc: 0.502
Validation loss decreased (-0.470379 --> -0.502415).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0562025
	speed: 0.1552s/iter; left time: 2231.3909s
Epoch: 7 cost time: 6.614049911499023
Epoch: 7, Steps: 154 | Train Loss: 1.023 Vali Loss: 1.852 Vali Acc: 0.484 Test Loss: 1.852 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7662707
	speed: 0.1678s/iter; left time: 2386.7032s
Epoch: 8 cost time: 6.975858211517334
Epoch: 8, Steps: 154 | Train Loss: 0.996 Vali Loss: 2.084 Vali Acc: 0.476 Test Loss: 2.084 Test Acc: 0.476
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0732914
	speed: 0.1534s/iter; left time: 2158.1419s
Epoch: 9 cost time: 5.9701008796691895
Epoch: 9, Steps: 154 | Train Loss: 0.935 Vali Loss: 2.031 Vali Acc: 0.483 Test Loss: 2.031 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.5360789
	speed: 0.1645s/iter; left time: 2289.6729s
Epoch: 10 cost time: 8.448382377624512
Epoch: 10, Steps: 154 | Train Loss: 0.906 Vali Loss: 2.258 Vali Acc: 0.475 Test Loss: 2.258 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.9566600
	speed: 0.2026s/iter; left time: 2787.9874s
Epoch: 11 cost time: 8.24741792678833
Epoch: 11, Steps: 154 | Train Loss: 0.864 Vali Loss: 2.069 Vali Acc: 0.494 Test Loss: 2.069 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.8358678
	speed: 0.1852s/iter; left time: 2520.1956s
Epoch: 12 cost time: 7.365223407745361
Epoch: 12, Steps: 154 | Train Loss: 0.847 Vali Loss: 2.163 Vali Acc: 0.471 Test Loss: 2.163 Test Acc: 0.471
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.7954455
	speed: 0.1927s/iter; left time: 2591.8945s
Epoch: 13 cost time: 8.157814264297485
Epoch: 13, Steps: 154 | Train Loss: 0.778 Vali Loss: 2.040 Vali Acc: 0.494 Test Loss: 2.040 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.9037762
	speed: 0.1876s/iter; left time: 2494.9201s
Epoch: 14 cost time: 7.437288284301758
Epoch: 14, Steps: 154 | Train Loss: 0.758 Vali Loss: 1.959 Vali Acc: 0.516 Test Loss: 1.959 Test Acc: 0.516
Validation loss decreased (-0.502415 --> -0.515795).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6230723
	speed: 0.1783s/iter; left time: 2343.8071s
Epoch: 15 cost time: 6.868185997009277
Epoch: 15, Steps: 154 | Train Loss: 0.687 Vali Loss: 1.830 Vali Acc: 0.513 Test Loss: 1.830 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.7417457
	speed: 0.1883s/iter; left time: 2446.2222s
Epoch: 16 cost time: 8.132468938827515
Epoch: 16, Steps: 154 | Train Loss: 0.689 Vali Loss: 2.243 Vali Acc: 0.479 Test Loss: 2.243 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6473166
	speed: 0.1829s/iter; left time: 2347.6503s
Epoch: 17 cost time: 7.018060684204102
Epoch: 17, Steps: 154 | Train Loss: 0.621 Vali Loss: 2.187 Vali Acc: 0.506 Test Loss: 2.187 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.3154202
	speed: 0.1684s/iter; left time: 2135.2114s
Epoch: 18 cost time: 6.5727620124816895
Epoch: 18, Steps: 154 | Train Loss: 0.617 Vali Loss: 2.010 Vali Acc: 0.509 Test Loss: 2.010 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6799560
	speed: 0.1631s/iter; left time: 2043.4626s
Epoch: 19 cost time: 6.41888427734375
Epoch: 19, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.127 Vali Acc: 0.508 Test Loss: 2.127 Test Acc: 0.508
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.7039354
	speed: 0.1582s/iter; left time: 1958.3022s
Epoch: 20 cost time: 5.9284892082214355
Epoch: 20, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.245 Vali Acc: 0.484 Test Loss: 2.245 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.5324995
	speed: 0.1735s/iter; left time: 2120.7842s
Epoch: 21 cost time: 7.503254652023315
Epoch: 21, Steps: 154 | Train Loss: 0.539 Vali Loss: 2.191 Vali Acc: 0.525 Test Loss: 2.191 Test Acc: 0.525
Validation loss decreased (-0.515795 --> -0.524715).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.5396465
	speed: 0.1664s/iter; left time: 2008.2627s
Epoch: 22 cost time: 5.950831651687622
Epoch: 22, Steps: 154 | Train Loss: 0.500 Vali Loss: 2.524 Vali Acc: 0.496 Test Loss: 2.524 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3719517
	speed: 0.1716s/iter; left time: 2044.1584s
Epoch: 23 cost time: 7.42729640007019
Epoch: 23, Steps: 154 | Train Loss: 0.506 Vali Loss: 2.283 Vali Acc: 0.509 Test Loss: 2.283 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.7853962
	speed: 0.1725s/iter; left time: 2028.8023s
Epoch: 24 cost time: 6.1484997272491455
Epoch: 24, Steps: 154 | Train Loss: 0.463 Vali Loss: 2.532 Vali Acc: 0.470 Test Loss: 2.532 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.7099143
	speed: 0.1606s/iter; left time: 1863.2795s
Epoch: 25 cost time: 6.418144226074219
Epoch: 25, Steps: 154 | Train Loss: 0.457 Vali Loss: 2.410 Vali Acc: 0.513 Test Loss: 2.410 Test Acc: 0.513
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.3017937
	speed: 0.1785s/iter; left time: 2043.4405s
Epoch: 26 cost time: 7.788956880569458
Epoch: 26, Steps: 154 | Train Loss: 0.422 Vali Loss: 2.628 Vali Acc: 0.476 Test Loss: 2.628 Test Acc: 0.476
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.7454981
	speed: 0.1770s/iter; left time: 1999.3029s
Epoch: 27 cost time: 6.851518869400024
Epoch: 27, Steps: 154 | Train Loss: 0.407 Vali Loss: 2.446 Vali Acc: 0.472 Test Loss: 2.446 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.3414809
	speed: 0.1631s/iter; left time: 1817.7046s
Epoch: 28 cost time: 6.379148006439209
Epoch: 28, Steps: 154 | Train Loss: 0.399 Vali Loss: 2.630 Vali Acc: 0.517 Test Loss: 2.630 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.4881586
	speed: 0.1501s/iter; left time: 1649.6309s
Epoch: 29 cost time: 5.632683515548706
Epoch: 29, Steps: 154 | Train Loss: 0.381 Vali Loss: 3.006 Vali Acc: 0.487 Test Loss: 3.006 Test Acc: 0.487
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.1983051
	speed: 0.1678s/iter; left time: 1818.1428s
Epoch: 30 cost time: 7.444882392883301
Epoch: 30, Steps: 154 | Train Loss: 0.378 Vali Loss: 2.899 Vali Acc: 0.502 Test Loss: 2.899 Test Acc: 0.502
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.2274418
	speed: 0.1853s/iter; left time: 1978.9044s
Epoch: 31 cost time: 7.5805823802948
Epoch: 31, Steps: 154 | Train Loss: 0.375 Vali Loss: 2.633 Vali Acc: 0.516 Test Loss: 2.633 Test Acc: 0.516
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5247364152473641
model parameter : 49934
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0592947
	speed: 0.0547s/iter; left time: 836.2675s
Epoch: 1 cost time: 7.531941175460815
Epoch: 1, Steps: 154 | Train Loss: 2.335 Vali Loss: 2.083 Vali Acc: 0.337 Test Loss: 2.083 Test Acc: 0.337
Validation loss decreased (inf --> -0.337368).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8093412
	speed: 0.1474s/iter; left time: 2232.4442s
Epoch: 2 cost time: 6.425673723220825
Epoch: 2, Steps: 154 | Train Loss: 1.788 Vali Loss: 1.694 Vali Acc: 0.440 Test Loss: 1.694 Test Acc: 0.440
Validation loss decreased (-0.337368 --> -0.440372).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1535630
	speed: 0.1758s/iter; left time: 2635.5258s
Epoch: 3 cost time: 7.476298809051514
Epoch: 3, Steps: 154 | Train Loss: 1.372 Vali Loss: 1.637 Vali Acc: 0.471 Test Loss: 1.637 Test Acc: 0.471
Validation loss decreased (-0.440372 --> -0.471192).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0258465
	speed: 0.1835s/iter; left time: 2722.3270s
Epoch: 4 cost time: 7.850370168685913
Epoch: 4, Steps: 154 | Train Loss: 1.246 Vali Loss: 1.827 Vali Acc: 0.474 Test Loss: 1.827 Test Acc: 0.474
Validation loss decreased (-0.471192 --> -0.473623).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4553639
	speed: 0.1780s/iter; left time: 2613.6938s
Epoch: 5 cost time: 7.023364782333374
Epoch: 5, Steps: 154 | Train Loss: 1.154 Vali Loss: 1.841 Vali Acc: 0.465 Test Loss: 1.841 Test Acc: 0.465
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8644061
	speed: 0.1728s/iter; left time: 2511.1763s
Epoch: 6 cost time: 6.8045973777771
Epoch: 6, Steps: 154 | Train Loss: 1.102 Vali Loss: 1.845 Vali Acc: 0.496 Test Loss: 1.845 Test Acc: 0.496
Validation loss decreased (-0.473623 --> -0.496332).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1632624
	speed: 0.1567s/iter; left time: 2253.4290s
Epoch: 7 cost time: 6.072030782699585
Epoch: 7, Steps: 154 | Train Loss: 1.063 Vali Loss: 1.797 Vali Acc: 0.467 Test Loss: 1.797 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9676599
	speed: 0.1661s/iter; left time: 2362.2671s
Epoch: 8 cost time: 7.167948246002197
Epoch: 8, Steps: 154 | Train Loss: 1.013 Vali Loss: 2.042 Vali Acc: 0.503 Test Loss: 2.042 Test Acc: 0.503
Validation loss decreased (-0.496332 --> -0.502818).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3264763
	speed: 0.1812s/iter; left time: 2549.8687s
Epoch: 9 cost time: 7.104417085647583
Epoch: 9, Steps: 154 | Train Loss: 0.959 Vali Loss: 1.841 Vali Acc: 0.504 Test Loss: 1.841 Test Acc: 0.504
Validation loss decreased (-0.502818 --> -0.504037).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6674225
	speed: 0.1643s/iter; left time: 2285.7635s
Epoch: 10 cost time: 5.936757564544678
Epoch: 10, Steps: 154 | Train Loss: 0.923 Vali Loss: 1.748 Vali Acc: 0.536 Test Loss: 1.748 Test Acc: 0.536
Validation loss decreased (-0.504037 --> -0.535668).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9440093
	speed: 0.1677s/iter; left time: 2307.3453s
Epoch: 11 cost time: 6.411646366119385
Epoch: 11, Steps: 154 | Train Loss: 0.880 Vali Loss: 1.677 Vali Acc: 0.529 Test Loss: 1.677 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7963543
	speed: 0.1441s/iter; left time: 1960.9213s
Epoch: 12 cost time: 5.306034564971924
Epoch: 12, Steps: 154 | Train Loss: 0.853 Vali Loss: 1.868 Vali Acc: 0.511 Test Loss: 1.868 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9034465
	speed: 0.1596s/iter; left time: 2147.1795s
Epoch: 13 cost time: 6.635511636734009
Epoch: 13, Steps: 154 | Train Loss: 0.795 Vali Loss: 1.813 Vali Acc: 0.498 Test Loss: 1.813 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.6099277
	speed: 0.1585s/iter; left time: 2108.2934s
Epoch: 14 cost time: 5.5553138256073
Epoch: 14, Steps: 154 | Train Loss: 0.754 Vali Loss: 1.876 Vali Acc: 0.539 Test Loss: 1.876 Test Acc: 0.539
Validation loss decreased (-0.535668 --> -0.539316).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7783174
	speed: 0.1619s/iter; left time: 2127.5483s
Epoch: 15 cost time: 6.684711456298828
Epoch: 15, Steps: 154 | Train Loss: 0.742 Vali Loss: 2.079 Vali Acc: 0.513 Test Loss: 2.079 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.9589483
	speed: 0.1617s/iter; left time: 2100.5170s
Epoch: 16 cost time: 5.5821168422698975
Epoch: 16, Steps: 154 | Train Loss: 0.695 Vali Loss: 1.989 Vali Acc: 0.472 Test Loss: 1.989 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6797013
	speed: 0.1491s/iter; left time: 1914.0223s
Epoch: 17 cost time: 6.102051496505737
Epoch: 17, Steps: 154 | Train Loss: 0.708 Vali Loss: 1.986 Vali Acc: 0.491 Test Loss: 1.986 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7315574
	speed: 0.1338s/iter; left time: 1697.5096s
Epoch: 18 cost time: 4.519262075424194
Epoch: 18, Steps: 154 | Train Loss: 0.647 Vali Loss: 1.897 Vali Acc: 0.512 Test Loss: 1.897 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3261518
	speed: 0.1231s/iter; left time: 1542.8951s
Epoch: 19 cost time: 4.286168575286865
Epoch: 19, Steps: 154 | Train Loss: 0.615 Vali Loss: 2.026 Vali Acc: 0.491 Test Loss: 2.026 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.8320401
	speed: 0.1058s/iter; left time: 1309.1497s
Epoch: 20 cost time: 4.002486705780029
Epoch: 20, Steps: 154 | Train Loss: 0.597 Vali Loss: 2.148 Vali Acc: 0.479 Test Loss: 2.148 Test Acc: 0.479
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.3799888
	speed: 0.1145s/iter; left time: 1399.2625s
Epoch: 21 cost time: 4.210099220275879
Epoch: 21, Steps: 154 | Train Loss: 0.580 Vali Loss: 2.000 Vali Acc: 0.499 Test Loss: 2.000 Test Acc: 0.499
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.7022208
	speed: 0.1082s/iter; left time: 1305.9615s
Epoch: 22 cost time: 4.288110733032227
Epoch: 22, Steps: 154 | Train Loss: 0.551 Vali Loss: 2.269 Vali Acc: 0.458 Test Loss: 2.269 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.7175797
	speed: 0.1575s/iter; left time: 1876.0634s
Epoch: 23 cost time: 6.724426984786987
Epoch: 23, Steps: 154 | Train Loss: 0.532 Vali Loss: 2.054 Vali Acc: 0.495 Test Loss: 2.054 Test Acc: 0.495
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.2348058
	speed: 0.1679s/iter; left time: 1974.8374s
Epoch: 24 cost time: 6.913644075393677
Epoch: 24, Steps: 154 | Train Loss: 0.520 Vali Loss: 2.046 Vali Acc: 0.506 Test Loss: 2.046 Test Acc: 0.506
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5393349553933495
model parameter : 44590
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7915571
	speed: 0.0721s/iter; left time: 1103.1099s
Epoch: 1 cost time: 10.130705118179321
Epoch: 1, Steps: 154 | Train Loss: 1.986 Vali Loss: 1.794 Vali Acc: 0.419 Test Loss: 1.794 Test Acc: 0.419
Validation loss decreased (inf --> -0.419285).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3752205
	speed: 0.1937s/iter; left time: 2933.9825s
Epoch: 2 cost time: 8.362647771835327
Epoch: 2, Steps: 154 | Train Loss: 1.407 Vali Loss: 1.710 Vali Acc: 0.500 Test Loss: 1.710 Test Acc: 0.500
Validation loss decreased (-0.419285 --> -0.500388).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2165236
	speed: 0.1919s/iter; left time: 2877.5271s
Epoch: 3 cost time: 8.485480785369873
Epoch: 3, Steps: 154 | Train Loss: 1.220 Vali Loss: 1.855 Vali Acc: 0.500 Test Loss: 1.855 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.5501242
	speed: 0.1958s/iter; left time: 2905.1707s
Epoch: 4 cost time: 8.164594650268555
Epoch: 4, Steps: 154 | Train Loss: 1.107 Vali Loss: 1.988 Vali Acc: 0.459 Test Loss: 1.988 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2504922
	speed: 0.1940s/iter; left time: 2848.9024s
Epoch: 5 cost time: 8.22356653213501
Epoch: 5, Steps: 154 | Train Loss: 1.030 Vali Loss: 1.866 Vali Acc: 0.531 Test Loss: 1.866 Test Acc: 0.531
Validation loss decreased (-0.500388 --> -0.530800).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4939568
	speed: 0.1898s/iter; left time: 2757.4471s
Epoch: 6 cost time: 7.6339216232299805
Epoch: 6, Steps: 154 | Train Loss: 0.962 Vali Loss: 2.086 Vali Acc: 0.525 Test Loss: 2.086 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1979747
	speed: 0.1926s/iter; left time: 2768.4559s
Epoch: 7 cost time: 7.075048208236694
Epoch: 7, Steps: 154 | Train Loss: 0.899 Vali Loss: 1.946 Vali Acc: 0.521 Test Loss: 1.946 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0720066
	speed: 0.1565s/iter; left time: 2225.3173s
Epoch: 8 cost time: 6.222564220428467
Epoch: 8, Steps: 154 | Train Loss: 0.829 Vali Loss: 2.484 Vali Acc: 0.399 Test Loss: 2.484 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3241886
	speed: 0.1695s/iter; left time: 2384.4554s
Epoch: 9 cost time: 7.351943254470825
Epoch: 9, Steps: 154 | Train Loss: 0.765 Vali Loss: 2.570 Vali Acc: 0.491 Test Loss: 2.570 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6822574
	speed: 0.1798s/iter; left time: 2502.4347s
Epoch: 10 cost time: 7.64463210105896
Epoch: 10, Steps: 154 | Train Loss: 0.702 Vali Loss: 2.339 Vali Acc: 0.494 Test Loss: 2.339 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.6037958
	speed: 0.1837s/iter; left time: 2527.5049s
Epoch: 11 cost time: 7.617348670959473
Epoch: 11, Steps: 154 | Train Loss: 0.608 Vali Loss: 2.503 Vali Acc: 0.496 Test Loss: 2.503 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.7803161
	speed: 0.1802s/iter; left time: 2452.4558s
Epoch: 12 cost time: 7.346594333648682
Epoch: 12, Steps: 154 | Train Loss: 0.591 Vali Loss: 2.443 Vali Acc: 0.516 Test Loss: 2.443 Test Acc: 0.516
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.7215408
	speed: 0.1598s/iter; left time: 2150.0016s
Epoch: 13 cost time: 6.455973148345947
Epoch: 13, Steps: 154 | Train Loss: 0.529 Vali Loss: 2.533 Vali Acc: 0.484 Test Loss: 2.533 Test Acc: 0.484
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.2593746
	speed: 0.1694s/iter; left time: 2253.0516s
Epoch: 14 cost time: 7.165719985961914
Epoch: 14, Steps: 154 | Train Loss: 0.513 Vali Loss: 2.695 Vali Acc: 0.495 Test Loss: 2.695 Test Acc: 0.495
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.5018024
	speed: 0.1729s/iter; left time: 2272.5589s
Epoch: 15 cost time: 7.2672224044799805
Epoch: 15, Steps: 154 | Train Loss: 0.435 Vali Loss: 2.865 Vali Acc: 0.479 Test Loss: 2.865 Test Acc: 0.479
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5308191403081914
model parameter : 113998
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9796892
	speed: 0.0564s/iter; left time: 862.5241s
Epoch: 1 cost time: 7.694454193115234
Epoch: 1, Steps: 154 | Train Loss: 2.168 Vali Loss: 1.903 Vali Acc: 0.401 Test Loss: 1.903 Test Acc: 0.401
Validation loss decreased (inf --> -0.400630).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6216928
	speed: 0.1569s/iter; left time: 2376.1687s
Epoch: 2 cost time: 6.254887580871582
Epoch: 2, Steps: 154 | Train Loss: 1.490 Vali Loss: 1.750 Vali Acc: 0.468 Test Loss: 1.750 Test Acc: 0.468
Validation loss decreased (-0.400630 --> -0.467947).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7826818
	speed: 0.1673s/iter; left time: 2507.9584s
Epoch: 3 cost time: 6.920233249664307
Epoch: 3, Steps: 154 | Train Loss: 1.229 Vali Loss: 1.733 Vali Acc: 0.518 Test Loss: 1.733 Test Acc: 0.518
Validation loss decreased (-0.467947 --> -0.517825).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2606473
	speed: 0.1687s/iter; left time: 2504.0622s
Epoch: 4 cost time: 7.014807462692261
Epoch: 4, Steps: 154 | Train Loss: 1.124 Vali Loss: 1.607 Vali Acc: 0.535 Test Loss: 1.607 Test Acc: 0.535
Validation loss decreased (-0.517825 --> -0.535264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7228045
	speed: 0.1664s/iter; left time: 2443.5039s
Epoch: 5 cost time: 6.773752927780151
Epoch: 5, Steps: 154 | Train Loss: 1.040 Vali Loss: 1.739 Vali Acc: 0.528 Test Loss: 1.739 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9918379
	speed: 0.1740s/iter; left time: 2528.8239s
Epoch: 6 cost time: 7.133152484893799
Epoch: 6, Steps: 154 | Train Loss: 0.988 Vali Loss: 1.736 Vali Acc: 0.532 Test Loss: 1.736 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2882781
	speed: 0.1584s/iter; left time: 2277.6413s
Epoch: 7 cost time: 6.177180767059326
Epoch: 7, Steps: 154 | Train Loss: 0.925 Vali Loss: 1.664 Vali Acc: 0.521 Test Loss: 1.664 Test Acc: 0.521
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.0437336
	speed: 0.1577s/iter; left time: 2243.2693s
Epoch: 8 cost time: 6.816373109817505
Epoch: 8, Steps: 154 | Train Loss: 0.872 Vali Loss: 1.739 Vali Acc: 0.545 Test Loss: 1.739 Test Acc: 0.545
Validation loss decreased (-0.535264 --> -0.544995).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7294298
	speed: 0.1734s/iter; left time: 2439.9899s
Epoch: 9 cost time: 6.7901411056518555
Epoch: 9, Steps: 154 | Train Loss: 0.797 Vali Loss: 1.968 Vali Acc: 0.536 Test Loss: 1.968 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.5402984
	speed: 0.1674s/iter; left time: 2329.6950s
Epoch: 10 cost time: 6.887750148773193
Epoch: 10, Steps: 154 | Train Loss: 0.769 Vali Loss: 1.779 Vali Acc: 0.489 Test Loss: 1.779 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.7222189
	speed: 0.1674s/iter; left time: 2304.2389s
Epoch: 11 cost time: 6.669851541519165
Epoch: 11, Steps: 154 | Train Loss: 0.733 Vali Loss: 1.967 Vali Acc: 0.505 Test Loss: 1.967 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8093804
	speed: 0.1577s/iter; left time: 2146.4376s
Epoch: 12 cost time: 6.63961386680603
Epoch: 12, Steps: 154 | Train Loss: 0.684 Vali Loss: 1.847 Vali Acc: 0.529 Test Loss: 1.847 Test Acc: 0.529
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9282037
	speed: 0.1601s/iter; left time: 2154.1068s
Epoch: 13 cost time: 6.516004323959351
Epoch: 13, Steps: 154 | Train Loss: 0.669 Vali Loss: 2.136 Vali Acc: 0.427 Test Loss: 2.136 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.3160973
	speed: 0.1675s/iter; left time: 2228.0191s
Epoch: 14 cost time: 6.994656801223755
Epoch: 14, Steps: 154 | Train Loss: 0.612 Vali Loss: 1.995 Vali Acc: 0.513 Test Loss: 1.995 Test Acc: 0.513
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.8455189
	speed: 0.1667s/iter; left time: 2191.0665s
Epoch: 15 cost time: 6.80122184753418
Epoch: 15, Steps: 154 | Train Loss: 0.586 Vali Loss: 2.022 Vali Acc: 0.544 Test Loss: 2.022 Test Acc: 0.544
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.7338233
	speed: 0.1639s/iter; left time: 2129.5335s
Epoch: 16 cost time: 6.605813980102539
Epoch: 16, Steps: 154 | Train Loss: 0.528 Vali Loss: 2.235 Vali Acc: 0.485 Test Loss: 2.235 Test Acc: 0.485
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.2475374
	speed: 0.1577s/iter; left time: 2024.9501s
Epoch: 17 cost time: 6.604081153869629
Epoch: 17, Steps: 154 | Train Loss: 0.508 Vali Loss: 2.302 Vali Acc: 0.532 Test Loss: 2.302 Test Acc: 0.532
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.0560668
	speed: 0.1671s/iter; left time: 2119.8933s
Epoch: 18 cost time: 6.604004621505737
Epoch: 18, Steps: 154 | Train Loss: 0.495 Vali Loss: 2.260 Vali Acc: 0.534 Test Loss: 2.260 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5450121654501217
model parameter : 65646
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3478343
	speed: 0.0584s/iter; left time: 893.0361s
Epoch: 1 cost time: 8.034623384475708
Epoch: 1, Steps: 154 | Train Loss: 2.092 Vali Loss: 1.828 Vali Acc: 0.387 Test Loss: 1.828 Test Acc: 0.387
Validation loss decreased (inf --> -0.387249).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3158301
	speed: 0.1561s/iter; left time: 2364.3198s
Epoch: 2 cost time: 6.354580402374268
Epoch: 2, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.035 Vali Acc: 0.454 Test Loss: 2.035 Test Acc: 0.454
Validation loss decreased (-0.387249 --> -0.453751).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3755971
	speed: 0.1636s/iter; left time: 2453.0081s
Epoch: 3 cost time: 7.346637010574341
Epoch: 3, Steps: 154 | Train Loss: 1.245 Vali Loss: 1.780 Vali Acc: 0.485 Test Loss: 1.780 Test Acc: 0.485
Validation loss decreased (-0.453751 --> -0.484573).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1379014
	speed: 0.1869s/iter; left time: 2773.7453s
Epoch: 4 cost time: 7.704070091247559
Epoch: 4, Steps: 154 | Train Loss: 1.154 Vali Loss: 1.714 Vali Acc: 0.525 Test Loss: 1.714 Test Acc: 0.525
Validation loss decreased (-0.484573 --> -0.524719).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2065693
	speed: 0.1934s/iter; left time: 2840.0493s
Epoch: 5 cost time: 7.554806232452393
Epoch: 5, Steps: 154 | Train Loss: 1.062 Vali Loss: 2.159 Vali Acc: 0.457 Test Loss: 2.159 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0165772
	speed: 0.1785s/iter; left time: 2594.2579s
Epoch: 6 cost time: 7.206388235092163
Epoch: 6, Steps: 154 | Train Loss: 1.013 Vali Loss: 1.686 Vali Acc: 0.495 Test Loss: 1.686 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2954220
	speed: 0.1795s/iter; left time: 2581.2392s
Epoch: 7 cost time: 7.292051315307617
Epoch: 7, Steps: 154 | Train Loss: 0.976 Vali Loss: 2.057 Vali Acc: 0.451 Test Loss: 2.057 Test Acc: 0.451
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.0876772
	speed: 0.1774s/iter; left time: 2522.6711s
Epoch: 8 cost time: 6.628110408782959
Epoch: 8, Steps: 154 | Train Loss: 0.885 Vali Loss: 1.884 Vali Acc: 0.514 Test Loss: 1.884 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5136080
	speed: 0.1517s/iter; left time: 2134.5539s
Epoch: 9 cost time: 6.013045072555542
Epoch: 9, Steps: 154 | Train Loss: 0.854 Vali Loss: 1.872 Vali Acc: 0.503 Test Loss: 1.872 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.5472863
	speed: 0.1585s/iter; left time: 2205.2390s
Epoch: 10 cost time: 7.095166444778442
Epoch: 10, Steps: 154 | Train Loss: 0.760 Vali Loss: 1.844 Vali Acc: 0.528 Test Loss: 1.844 Test Acc: 0.528
Validation loss decreased (-0.524719 --> -0.528368).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3691920
	speed: 0.1645s/iter; left time: 2263.1733s
Epoch: 11 cost time: 6.0893714427948
Epoch: 11, Steps: 154 | Train Loss: 0.754 Vali Loss: 1.886 Vali Acc: 0.544 Test Loss: 1.886 Test Acc: 0.544
Validation loss decreased (-0.528368 --> -0.543777).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9082663
	speed: 0.1563s/iter; left time: 2127.0735s
Epoch: 12 cost time: 6.096349000930786
Epoch: 12, Steps: 154 | Train Loss: 0.681 Vali Loss: 2.064 Vali Acc: 0.505 Test Loss: 2.064 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.5346054
	speed: 0.1562s/iter; left time: 2100.7968s
Epoch: 13 cost time: 6.748371362686157
Epoch: 13, Steps: 154 | Train Loss: 0.630 Vali Loss: 2.227 Vali Acc: 0.541 Test Loss: 2.227 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.7654276
	speed: 0.1671s/iter; left time: 2222.1060s
Epoch: 14 cost time: 6.673079490661621
Epoch: 14, Steps: 154 | Train Loss: 0.608 Vali Loss: 2.145 Vali Acc: 0.546 Test Loss: 2.145 Test Acc: 0.546
Validation loss decreased (-0.543777 --> -0.545802).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.6011310
	speed: 0.1656s/iter; left time: 2177.2239s
Epoch: 15 cost time: 6.849169015884399
Epoch: 15, Steps: 154 | Train Loss: 0.572 Vali Loss: 2.146 Vali Acc: 0.556 Test Loss: 2.146 Test Acc: 0.556
Validation loss decreased (-0.545802 --> -0.555534).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4592043
	speed: 0.1677s/iter; left time: 2178.0462s
Epoch: 16 cost time: 6.811652898788452
Epoch: 16, Steps: 154 | Train Loss: 0.529 Vali Loss: 2.210 Vali Acc: 0.510 Test Loss: 2.210 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3150880
	speed: 0.1683s/iter; left time: 2160.4155s
Epoch: 17 cost time: 6.85854697227478
Epoch: 17, Steps: 154 | Train Loss: 0.502 Vali Loss: 2.273 Vali Acc: 0.528 Test Loss: 2.273 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.7103248
	speed: 0.1663s/iter; left time: 2109.0589s
Epoch: 18 cost time: 6.778138637542725
Epoch: 18, Steps: 154 | Train Loss: 0.485 Vali Loss: 2.409 Vali Acc: 0.534 Test Loss: 2.409 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.3906190
	speed: 0.1701s/iter; left time: 2130.9624s
Epoch: 19 cost time: 6.908249139785767
Epoch: 19, Steps: 154 | Train Loss: 0.433 Vali Loss: 2.345 Vali Acc: 0.560 Test Loss: 2.345 Test Acc: 0.560
Validation loss decreased (-0.555534 --> -0.560398).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2301219
	speed: 0.1703s/iter; left time: 2107.1677s
Epoch: 20 cost time: 6.758309364318848
Epoch: 20, Steps: 154 | Train Loss: 0.415 Vali Loss: 2.389 Vali Acc: 0.538 Test Loss: 2.389 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.9328390
	speed: 0.1672s/iter; left time: 2042.8697s
Epoch: 21 cost time: 7.316144227981567
Epoch: 21, Steps: 154 | Train Loss: 0.393 Vali Loss: 2.436 Vali Acc: 0.508 Test Loss: 2.436 Test Acc: 0.508
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0745281
	speed: 0.1603s/iter; left time: 1934.0436s
Epoch: 22 cost time: 5.978527784347534
Epoch: 22, Steps: 154 | Train Loss: 0.387 Vali Loss: 2.679 Vali Acc: 0.509 Test Loss: 2.679 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.2966177
	speed: 0.1543s/iter; left time: 1838.3927s
Epoch: 23 cost time: 6.472891330718994
Epoch: 23, Steps: 154 | Train Loss: 0.363 Vali Loss: 2.765 Vali Acc: 0.505 Test Loss: 2.765 Test Acc: 0.505
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.3010989
	speed: 0.1637s/iter; left time: 1924.4843s
Epoch: 24 cost time: 6.645933389663696
Epoch: 24, Steps: 154 | Train Loss: 0.344 Vali Loss: 2.596 Vali Acc: 0.539 Test Loss: 2.596 Test Acc: 0.539
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.2596579
	speed: 0.1642s/iter; left time: 1905.3135s
Epoch: 25 cost time: 6.819767951965332
Epoch: 25, Steps: 154 | Train Loss: 0.317 Vali Loss: 2.724 Vali Acc: 0.512 Test Loss: 2.724 Test Acc: 0.512
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.2832464
	speed: 0.1629s/iter; left time: 1865.5839s
Epoch: 26 cost time: 6.556764602661133
Epoch: 26, Steps: 154 | Train Loss: 0.320 Vali Loss: 2.831 Vali Acc: 0.529 Test Loss: 2.831 Test Acc: 0.529
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.1963526
	speed: 0.1596s/iter; left time: 1803.1713s
Epoch: 27 cost time: 6.2949066162109375
Epoch: 27, Steps: 154 | Train Loss: 0.308 Vali Loss: 2.839 Vali Acc: 0.495 Test Loss: 2.839 Test Acc: 0.495
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.5779034
	speed: 0.1614s/iter; left time: 1798.8011s
Epoch: 28 cost time: 6.562988519668579
Epoch: 28, Steps: 154 | Train Loss: 0.269 Vali Loss: 2.897 Vali Acc: 0.538 Test Loss: 2.897 Test Acc: 0.538
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.2956114
	speed: 0.1621s/iter; left time: 1780.8887s
Epoch: 29 cost time: 6.280377626419067
Epoch: 29, Steps: 154 | Train Loss: 0.266 Vali Loss: 3.234 Vali Acc: 0.472 Test Loss: 3.234 Test Acc: 0.472
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5604217356042174
model parameter : 65678
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7135360
	speed: 0.0621s/iter; left time: 949.5146s
Epoch: 1 cost time: 8.849389553070068
Epoch: 1, Steps: 154 | Train Loss: 2.211 Vali Loss: 1.940 Vali Acc: 0.358 Test Loss: 1.940 Test Acc: 0.358
Validation loss decreased (inf --> -0.358050).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4510018
	speed: 0.1807s/iter; left time: 2736.4930s
Epoch: 2 cost time: 6.9012086391448975
Epoch: 2, Steps: 154 | Train Loss: 1.581 Vali Loss: 1.910 Vali Acc: 0.436 Test Loss: 1.910 Test Acc: 0.436
Validation loss decreased (-0.358050 --> -0.436315).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1596133
	speed: 0.1768s/iter; left time: 2650.2351s
Epoch: 3 cost time: 7.311800479888916
Epoch: 3, Steps: 154 | Train Loss: 1.304 Vali Loss: 1.977 Vali Acc: 0.466 Test Loss: 1.977 Test Acc: 0.466
Validation loss decreased (-0.436315 --> -0.465917).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7743413
	speed: 0.1796s/iter; left time: 2664.7055s
Epoch: 4 cost time: 6.183875799179077
Epoch: 4, Steps: 154 | Train Loss: 1.201 Vali Loss: 1.854 Vali Acc: 0.478 Test Loss: 1.854 Test Acc: 0.478
Validation loss decreased (-0.465917 --> -0.478084).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0520709
	speed: 0.1677s/iter; left time: 2462.5446s
Epoch: 5 cost time: 7.465444326400757
Epoch: 5, Steps: 154 | Train Loss: 1.106 Vali Loss: 1.994 Vali Acc: 0.481 Test Loss: 1.994 Test Acc: 0.481
Validation loss decreased (-0.478084 --> -0.480515).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4391477
	speed: 0.1736s/iter; left time: 2522.7998s
Epoch: 6 cost time: 6.571688175201416
Epoch: 6, Steps: 154 | Train Loss: 1.055 Vali Loss: 1.751 Vali Acc: 0.502 Test Loss: 1.751 Test Acc: 0.502
Validation loss decreased (-0.480515 --> -0.501605).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3279698
	speed: 0.1713s/iter; left time: 2462.4481s
Epoch: 7 cost time: 7.264153957366943
Epoch: 7, Steps: 154 | Train Loss: 1.013 Vali Loss: 2.110 Vali Acc: 0.487 Test Loss: 2.110 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8802603
	speed: 0.1680s/iter; left time: 2389.0379s
Epoch: 8 cost time: 6.2080018520355225
Epoch: 8, Steps: 154 | Train Loss: 0.952 Vali Loss: 1.740 Vali Acc: 0.524 Test Loss: 1.740 Test Acc: 0.524
Validation loss decreased (-0.501605 --> -0.523908).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9164470
	speed: 0.1668s/iter; left time: 2346.6888s
Epoch: 9 cost time: 6.849990606307983
Epoch: 9, Steps: 154 | Train Loss: 0.870 Vali Loss: 1.745 Vali Acc: 0.542 Test Loss: 1.745 Test Acc: 0.542
Validation loss decreased (-0.523908 --> -0.541751).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5494470
	speed: 0.1622s/iter; left time: 2257.1447s
Epoch: 10 cost time: 6.240796089172363
Epoch: 10, Steps: 154 | Train Loss: 0.829 Vali Loss: 1.833 Vali Acc: 0.516 Test Loss: 1.833 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8202338
	speed: 0.1689s/iter; left time: 2324.8379s
Epoch: 11 cost time: 6.9437949657440186
Epoch: 11, Steps: 154 | Train Loss: 0.798 Vali Loss: 1.865 Vali Acc: 0.504 Test Loss: 1.865 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.6356592
	speed: 0.1739s/iter; left time: 2366.1651s
Epoch: 12 cost time: 7.164308547973633
Epoch: 12, Steps: 154 | Train Loss: 0.761 Vali Loss: 1.938 Vali Acc: 0.518 Test Loss: 1.938 Test Acc: 0.518
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5178933
	speed: 0.1747s/iter; left time: 2350.6588s
Epoch: 13 cost time: 7.168994188308716
Epoch: 13, Steps: 154 | Train Loss: 0.723 Vali Loss: 2.152 Vali Acc: 0.502 Test Loss: 2.152 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8836744
	speed: 0.1737s/iter; left time: 2310.1609s
Epoch: 14 cost time: 6.513406038284302
Epoch: 14, Steps: 154 | Train Loss: 0.693 Vali Loss: 2.045 Vali Acc: 0.514 Test Loss: 2.045 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.6422467
	speed: 0.1637s/iter; left time: 2151.6049s
Epoch: 15 cost time: 6.439605236053467
Epoch: 15, Steps: 154 | Train Loss: 0.661 Vali Loss: 2.101 Vali Acc: 0.536 Test Loss: 2.101 Test Acc: 0.536
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.8677950
	speed: 0.1643s/iter; left time: 2134.9001s
Epoch: 16 cost time: 6.938170909881592
Epoch: 16, Steps: 154 | Train Loss: 0.611 Vali Loss: 2.303 Vali Acc: 0.514 Test Loss: 2.303 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8468823
	speed: 0.1708s/iter; left time: 2193.1050s
Epoch: 17 cost time: 6.938458442687988
Epoch: 17, Steps: 154 | Train Loss: 0.615 Vali Loss: 2.223 Vali Acc: 0.525 Test Loss: 2.223 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.3626430
	speed: 0.1674s/iter; left time: 2122.5592s
Epoch: 18 cost time: 6.942873239517212
Epoch: 18, Steps: 154 | Train Loss: 0.555 Vali Loss: 2.306 Vali Acc: 0.512 Test Loss: 2.306 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.5506393
	speed: 0.1665s/iter; left time: 2085.6048s
Epoch: 19 cost time: 6.53629469871521
Epoch: 19, Steps: 154 | Train Loss: 0.542 Vali Loss: 2.344 Vali Acc: 0.530 Test Loss: 2.344 Test Acc: 0.530
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5417680454176804
model parameter : 49614
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0807505
	speed: 0.0637s/iter; left time: 974.3702s
Epoch: 1 cost time: 8.693609237670898
Epoch: 1, Steps: 154 | Train Loss: 2.258 Vali Loss: 1.974 Vali Acc: 0.351 Test Loss: 1.974 Test Acc: 0.351
Validation loss decreased (inf --> -0.351156).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7563746
	speed: 0.1710s/iter; left time: 2589.9236s
Epoch: 2 cost time: 6.839877605438232
Epoch: 2, Steps: 154 | Train Loss: 1.659 Vali Loss: 1.714 Vali Acc: 0.449 Test Loss: 1.714 Test Acc: 0.449
Validation loss decreased (-0.351156 --> -0.449293).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9008377
	speed: 0.1644s/iter; left time: 2464.5899s
Epoch: 3 cost time: 6.218531608581543
Epoch: 3, Steps: 154 | Train Loss: 1.345 Vali Loss: 1.815 Vali Acc: 0.475 Test Loss: 1.815 Test Acc: 0.475
Validation loss decreased (-0.449293 --> -0.475245).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9112201
	speed: 0.1648s/iter; left time: 2445.7873s
Epoch: 4 cost time: 5.890131950378418
Epoch: 4, Steps: 154 | Train Loss: 1.228 Vali Loss: 1.817 Vali Acc: 0.484 Test Loss: 1.817 Test Acc: 0.484
Validation loss decreased (-0.475245 --> -0.483761).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8742731
	speed: 0.1673s/iter; left time: 2456.9738s
Epoch: 5 cost time: 6.31246542930603
Epoch: 5, Steps: 154 | Train Loss: 1.154 Vali Loss: 1.896 Vali Acc: 0.470 Test Loss: 1.896 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9878297
	speed: 0.1689s/iter; left time: 2453.8648s
Epoch: 6 cost time: 6.26481819152832
Epoch: 6, Steps: 154 | Train Loss: 1.085 Vali Loss: 1.768 Vali Acc: 0.485 Test Loss: 1.768 Test Acc: 0.485
Validation loss decreased (-0.483761 --> -0.485384).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0513378
	speed: 0.1916s/iter; left time: 2754.3521s
Epoch: 7 cost time: 7.378939867019653
Epoch: 7, Steps: 154 | Train Loss: 1.033 Vali Loss: 2.030 Vali Acc: 0.491 Test Loss: 2.030 Test Acc: 0.491
Validation loss decreased (-0.485384 --> -0.491464).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3764197
	speed: 0.1982s/iter; left time: 2818.6774s
Epoch: 8 cost time: 8.211791038513184
Epoch: 8, Steps: 154 | Train Loss: 0.974 Vali Loss: 2.180 Vali Acc: 0.460 Test Loss: 2.180 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1543754
	speed: 0.2076s/iter; left time: 2921.2766s
Epoch: 9 cost time: 8.140786170959473
Epoch: 9, Steps: 154 | Train Loss: 0.957 Vali Loss: 2.078 Vali Acc: 0.496 Test Loss: 2.078 Test Acc: 0.496
Validation loss decreased (-0.491464 --> -0.495519).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8259333
	speed: 0.1955s/iter; left time: 2720.9831s
Epoch: 10 cost time: 7.948632717132568
Epoch: 10, Steps: 154 | Train Loss: 0.909 Vali Loss: 1.836 Vali Acc: 0.509 Test Loss: 1.836 Test Acc: 0.509
Validation loss decreased (-0.495519 --> -0.508903).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7614275
	speed: 0.2035s/iter; left time: 2799.7012s
Epoch: 11 cost time: 7.827164888381958
Epoch: 11, Steps: 154 | Train Loss: 0.836 Vali Loss: 2.039 Vali Acc: 0.516 Test Loss: 2.039 Test Acc: 0.516
Validation loss decreased (-0.508903 --> -0.515795).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9604861
	speed: 0.1944s/iter; left time: 2644.7834s
Epoch: 12 cost time: 7.8699951171875
Epoch: 12, Steps: 154 | Train Loss: 0.816 Vali Loss: 2.135 Vali Acc: 0.476 Test Loss: 2.135 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.8065239
	speed: 0.1907s/iter; left time: 2564.8319s
Epoch: 13 cost time: 8.485546350479126
Epoch: 13, Steps: 154 | Train Loss: 0.786 Vali Loss: 2.371 Vali Acc: 0.459 Test Loss: 2.371 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6680350
	speed: 0.2074s/iter; left time: 2758.4562s
Epoch: 14 cost time: 8.698634147644043
Epoch: 14, Steps: 154 | Train Loss: 0.744 Vali Loss: 1.973 Vali Acc: 0.521 Test Loss: 1.973 Test Acc: 0.521
Validation loss decreased (-0.515795 --> -0.520662).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5705947
	speed: 0.2152s/iter; left time: 2829.3386s
Epoch: 15 cost time: 9.322531700134277
Epoch: 15, Steps: 154 | Train Loss: 0.711 Vali Loss: 2.008 Vali Acc: 0.526 Test Loss: 2.008 Test Acc: 0.526
Validation loss decreased (-0.520662 --> -0.526338).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6142911
	speed: 0.2208s/iter; left time: 2868.4135s
Epoch: 16 cost time: 8.935275554656982
Epoch: 16, Steps: 154 | Train Loss: 0.705 Vali Loss: 2.115 Vali Acc: 0.509 Test Loss: 2.115 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3317024
	speed: 0.1819s/iter; left time: 2335.1309s
Epoch: 17 cost time: 7.3667473793029785
Epoch: 17, Steps: 154 | Train Loss: 0.634 Vali Loss: 2.139 Vali Acc: 0.488 Test Loss: 2.139 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5915049
	speed: 0.1721s/iter; left time: 2182.6800s
Epoch: 18 cost time: 6.828596830368042
Epoch: 18, Steps: 154 | Train Loss: 0.642 Vali Loss: 2.767 Vali Acc: 0.478 Test Loss: 2.767 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.6439654
	speed: 0.1876s/iter; left time: 2351.0446s
Epoch: 19 cost time: 7.691679954528809
Epoch: 19, Steps: 154 | Train Loss: 0.628 Vali Loss: 2.663 Vali Acc: 0.468 Test Loss: 2.663 Test Acc: 0.468
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.5743239
	speed: 0.1888s/iter; left time: 2336.7342s
Epoch: 20 cost time: 7.6369006633758545
Epoch: 20, Steps: 154 | Train Loss: 0.596 Vali Loss: 2.353 Vali Acc: 0.504 Test Loss: 2.353 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.1728721
	speed: 0.1901s/iter; left time: 2322.9391s
Epoch: 21 cost time: 7.57990837097168
Epoch: 21, Steps: 154 | Train Loss: 0.562 Vali Loss: 2.630 Vali Acc: 0.489 Test Loss: 2.630 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2467167
	speed: 0.1845s/iter; left time: 2226.0755s
Epoch: 22 cost time: 7.236525297164917
Epoch: 22, Steps: 154 | Train Loss: 0.559 Vali Loss: 3.082 Vali Acc: 0.451 Test Loss: 3.082 Test Acc: 0.451
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.7483974
	speed: 0.1728s/iter; left time: 2058.0600s
Epoch: 23 cost time: 6.158181667327881
Epoch: 23, Steps: 154 | Train Loss: 0.552 Vali Loss: 2.256 Vali Acc: 0.550 Test Loss: 2.256 Test Acc: 0.550
Validation loss decreased (-0.526338 --> -0.550261).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.3519235
	speed: 0.1604s/iter; left time: 1886.5285s
Epoch: 24 cost time: 6.743535041809082
Epoch: 24, Steps: 154 | Train Loss: 0.523 Vali Loss: 2.686 Vali Acc: 0.496 Test Loss: 2.686 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 1.0214601
	speed: 0.1754s/iter; left time: 2035.5671s
Epoch: 25 cost time: 6.966994285583496
Epoch: 25, Steps: 154 | Train Loss: 0.488 Vali Loss: 2.899 Vali Acc: 0.453 Test Loss: 2.899 Test Acc: 0.453
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.4017076
	speed: 0.1801s/iter; left time: 2062.0971s
Epoch: 26 cost time: 7.15058445930481
Epoch: 26, Steps: 154 | Train Loss: 0.471 Vali Loss: 2.708 Vali Acc: 0.498 Test Loss: 2.708 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.3400537
	speed: 0.1699s/iter; left time: 1919.0115s
Epoch: 27 cost time: 6.6783363819122314
Epoch: 27, Steps: 154 | Train Loss: 0.454 Vali Loss: 2.733 Vali Acc: 0.509 Test Loss: 2.733 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.2146149
	speed: 0.1692s/iter; left time: 1885.2581s
Epoch: 28 cost time: 6.62212872505188
Epoch: 28, Steps: 154 | Train Loss: 0.446 Vali Loss: 2.780 Vali Acc: 0.510 Test Loss: 2.780 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.2348038
	speed: 0.1744s/iter; left time: 1915.9657s
Epoch: 29 cost time: 6.7351813316345215
Epoch: 29, Steps: 154 | Train Loss: 0.423 Vali Loss: 2.710 Vali Acc: 0.475 Test Loss: 2.710 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.6214865
	speed: 0.1518s/iter; left time: 1644.5884s
Epoch: 30 cost time: 5.546113729476929
Epoch: 30, Steps: 154 | Train Loss: 0.409 Vali Loss: 3.116 Vali Acc: 0.502 Test Loss: 3.116 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.3742145
	speed: 0.1508s/iter; left time: 1610.7530s
Epoch: 31 cost time: 6.142317295074463
Epoch: 31, Steps: 154 | Train Loss: 0.414 Vali Loss: 2.642 Vali Acc: 0.507 Test Loss: 2.642 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.3677052
	speed: 0.1663s/iter; left time: 1750.8886s
Epoch: 32 cost time: 6.966397523880005
Epoch: 32, Steps: 154 | Train Loss: 0.393 Vali Loss: 2.702 Vali Acc: 0.494 Test Loss: 2.702 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.1204085
	speed: 0.1736s/iter; left time: 1801.1143s
Epoch: 33 cost time: 6.8526318073272705
Epoch: 33, Steps: 154 | Train Loss: 0.376 Vali Loss: 3.181 Vali Acc: 0.498 Test Loss: 3.181 Test Acc: 0.498
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5502838605028386
model parameter : 41614
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6011715
	speed: 0.0702s/iter; left time: 1074.4628s
Epoch: 1 cost time: 9.891220331192017
Epoch: 1, Steps: 154 | Train Loss: 2.341 Vali Loss: 2.084 Vali Acc: 0.329 Test Loss: 2.084 Test Acc: 0.329
Validation loss decreased (inf --> -0.328852).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8525795
	speed: 0.1878s/iter; left time: 2844.1396s
Epoch: 2 cost time: 6.5280091762542725
Epoch: 2, Steps: 154 | Train Loss: 1.848 Vali Loss: 1.755 Vali Acc: 0.430 Test Loss: 1.755 Test Acc: 0.430
Validation loss decreased (-0.328852 --> -0.429828).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2992951
	speed: 0.1701s/iter; left time: 2549.8257s
Epoch: 3 cost time: 6.838865280151367
Epoch: 3, Steps: 154 | Train Loss: 1.414 Vali Loss: 1.644 Vali Acc: 0.493 Test Loss: 1.644 Test Acc: 0.493
Validation loss decreased (-0.429828 --> -0.493090).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0899714
	speed: 0.1697s/iter; left time: 2518.3589s
Epoch: 4 cost time: 6.688263416290283
Epoch: 4, Steps: 154 | Train Loss: 1.220 Vali Loss: 1.757 Vali Acc: 0.477 Test Loss: 1.757 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6668891
	speed: 0.1723s/iter; left time: 2530.4895s
Epoch: 5 cost time: 6.747125625610352
Epoch: 5, Steps: 154 | Train Loss: 1.174 Vali Loss: 1.863 Vali Acc: 0.503 Test Loss: 1.863 Test Acc: 0.503
Validation loss decreased (-0.493090 --> -0.502820).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6820633
	speed: 0.1762s/iter; left time: 2560.8417s
Epoch: 6 cost time: 6.568568229675293
Epoch: 6, Steps: 154 | Train Loss: 1.114 Vali Loss: 1.702 Vali Acc: 0.528 Test Loss: 1.702 Test Acc: 0.528
Validation loss decreased (-0.502820 --> -0.528369).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3208981
	speed: 0.1763s/iter; left time: 2535.2681s
Epoch: 7 cost time: 6.930344581604004
Epoch: 7, Steps: 154 | Train Loss: 1.088 Vali Loss: 1.777 Vali Acc: 0.494 Test Loss: 1.777 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9338894
	speed: 0.1568s/iter; left time: 2230.4822s
Epoch: 8 cost time: 5.869229316711426
Epoch: 8, Steps: 154 | Train Loss: 1.017 Vali Loss: 1.873 Vali Acc: 0.502 Test Loss: 1.873 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9175026
	speed: 0.1642s/iter; left time: 2309.8109s
Epoch: 9 cost time: 6.30403208732605
Epoch: 9, Steps: 154 | Train Loss: 0.982 Vali Loss: 1.876 Vali Acc: 0.513 Test Loss: 1.876 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8113000
	speed: 0.1711s/iter; left time: 2380.7636s
Epoch: 10 cost time: 6.548202991485596
Epoch: 10, Steps: 154 | Train Loss: 0.938 Vali Loss: 1.851 Vali Acc: 0.527 Test Loss: 1.851 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8470938
	speed: 0.1665s/iter; left time: 2291.7263s
Epoch: 11 cost time: 6.691318035125732
Epoch: 11, Steps: 154 | Train Loss: 0.898 Vali Loss: 1.766 Vali Acc: 0.517 Test Loss: 1.766 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0277196
	speed: 0.1668s/iter; left time: 2269.7726s
Epoch: 12 cost time: 6.750117778778076
Epoch: 12, Steps: 154 | Train Loss: 0.889 Vali Loss: 1.873 Vali Acc: 0.515 Test Loss: 1.873 Test Acc: 0.515
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6700400
	speed: 0.1694s/iter; left time: 2279.1033s
Epoch: 13 cost time: 6.7053306102752686
Epoch: 13, Steps: 154 | Train Loss: 0.828 Vali Loss: 1.720 Vali Acc: 0.514 Test Loss: 1.720 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1166134
	speed: 0.1826s/iter; left time: 2427.8869s
Epoch: 14 cost time: 7.6092047691345215
Epoch: 14, Steps: 154 | Train Loss: 0.811 Vali Loss: 1.875 Vali Acc: 0.514 Test Loss: 1.875 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.9021078
	speed: 0.1796s/iter; left time: 2361.4760s
Epoch: 15 cost time: 6.432126045227051
Epoch: 15, Steps: 154 | Train Loss: 0.777 Vali Loss: 2.144 Vali Acc: 0.459 Test Loss: 2.144 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.7541096
	speed: 0.1807s/iter; left time: 2347.3219s
Epoch: 16 cost time: 7.314759254455566
Epoch: 16, Steps: 154 | Train Loss: 0.765 Vali Loss: 1.838 Vali Acc: 0.504 Test Loss: 1.838 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm32_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5283860502838605
model parameter : 36270
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9529337
	speed: 0.0593s/iter; left time: 906.7717s
Epoch: 1 cost time: 8.167623043060303
Epoch: 1, Steps: 154 | Train Loss: 2.146 Vali Loss: 1.781 Vali Acc: 0.421 Test Loss: 1.781 Test Acc: 0.421
Validation loss decreased (inf --> -0.421312).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2019472
	speed: 0.1747s/iter; left time: 2646.4093s
Epoch: 2 cost time: 6.390237331390381
Epoch: 2, Steps: 154 | Train Loss: 1.544 Vali Loss: 1.787 Vali Acc: 0.441 Test Loss: 1.787 Test Acc: 0.441
Validation loss decreased (-0.421312 --> -0.440777).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2085627
	speed: 0.1544s/iter; left time: 2314.4833s
Epoch: 3 cost time: 6.0089240074157715
Epoch: 3, Steps: 154 | Train Loss: 1.252 Vali Loss: 1.771 Vali Acc: 0.449 Test Loss: 1.771 Test Acc: 0.449
Validation loss decreased (-0.440777 --> -0.449293).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5917298
	speed: 0.1886s/iter; left time: 2798.3773s
Epoch: 4 cost time: 8.102729797363281
Epoch: 4, Steps: 154 | Train Loss: 1.101 Vali Loss: 1.770 Vali Acc: 0.494 Test Loss: 1.770 Test Acc: 0.494
Validation loss decreased (-0.449293 --> -0.493900).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3082159
	speed: 0.2162s/iter; left time: 3175.3558s
Epoch: 5 cost time: 9.293017864227295
Epoch: 5, Steps: 154 | Train Loss: 1.024 Vali Loss: 1.637 Vali Acc: 0.476 Test Loss: 1.637 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1684495
	speed: 0.2184s/iter; left time: 3172.9364s
Epoch: 6 cost time: 8.624418497085571
Epoch: 6, Steps: 154 | Train Loss: 0.933 Vali Loss: 1.746 Vali Acc: 0.516 Test Loss: 1.746 Test Acc: 0.516
Validation loss decreased (-0.493900 --> -0.515798).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8216828
	speed: 0.2002s/iter; left time: 2877.9129s
Epoch: 7 cost time: 8.035262823104858
Epoch: 7, Steps: 154 | Train Loss: 0.882 Vali Loss: 1.804 Vali Acc: 0.514 Test Loss: 1.804 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3700017
	speed: 0.1998s/iter; left time: 2841.1885s
Epoch: 8 cost time: 8.516841173171997
Epoch: 8, Steps: 154 | Train Loss: 0.815 Vali Loss: 1.797 Vali Acc: 0.486 Test Loss: 1.797 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1536380
	speed: 0.2086s/iter; left time: 2934.7773s
Epoch: 9 cost time: 8.850860834121704
Epoch: 9, Steps: 154 | Train Loss: 0.776 Vali Loss: 1.834 Vali Acc: 0.485 Test Loss: 1.834 Test Acc: 0.485
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.9458953
	speed: 0.1994s/iter; left time: 2774.5039s
Epoch: 10 cost time: 7.716277599334717
Epoch: 10, Steps: 154 | Train Loss: 0.721 Vali Loss: 1.976 Vali Acc: 0.477 Test Loss: 1.976 Test Acc: 0.477
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2234116
	speed: 0.1651s/iter; left time: 2271.9094s
Epoch: 11 cost time: 6.71405029296875
Epoch: 11, Steps: 154 | Train Loss: 0.679 Vali Loss: 1.953 Vali Acc: 0.457 Test Loss: 1.953 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5280970
	speed: 0.1685s/iter; left time: 2292.2309s
Epoch: 12 cost time: 7.121603488922119
Epoch: 12, Steps: 154 | Train Loss: 0.614 Vali Loss: 1.933 Vali Acc: 0.527 Test Loss: 1.933 Test Acc: 0.527
Validation loss decreased (-0.515798 --> -0.526745).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5211203
	speed: 0.1785s/iter; left time: 2400.7829s
Epoch: 13 cost time: 7.881009578704834
Epoch: 13, Steps: 154 | Train Loss: 0.577 Vali Loss: 2.111 Vali Acc: 0.504 Test Loss: 2.111 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.6081461
	speed: 0.1837s/iter; left time: 2442.8485s
Epoch: 14 cost time: 6.87780499458313
Epoch: 14, Steps: 154 | Train Loss: 0.545 Vali Loss: 2.118 Vali Acc: 0.469 Test Loss: 2.118 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5225929
	speed: 0.1871s/iter; left time: 2459.0049s
Epoch: 15 cost time: 7.490713357925415
Epoch: 15, Steps: 154 | Train Loss: 0.521 Vali Loss: 2.397 Vali Acc: 0.432 Test Loss: 2.397 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5097927
	speed: 0.1840s/iter; left time: 2390.5817s
Epoch: 16 cost time: 7.291491746902466
Epoch: 16, Steps: 154 | Train Loss: 0.474 Vali Loss: 2.233 Vali Acc: 0.490 Test Loss: 2.233 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.4662105
	speed: 0.1758s/iter; left time: 2257.1561s
Epoch: 17 cost time: 6.6573646068573
Epoch: 17, Steps: 154 | Train Loss: 0.470 Vali Loss: 2.273 Vali Acc: 0.455 Test Loss: 2.273 Test Acc: 0.455
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4828305
	speed: 0.1675s/iter; left time: 2123.9312s
Epoch: 18 cost time: 6.355804920196533
Epoch: 18, Steps: 154 | Train Loss: 0.435 Vali Loss: 2.402 Vali Acc: 0.475 Test Loss: 2.402 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6390218
	speed: 0.1758s/iter; left time: 2202.4608s
Epoch: 19 cost time: 6.949583292007446
Epoch: 19, Steps: 154 | Train Loss: 0.415 Vali Loss: 2.630 Vali Acc: 0.464 Test Loss: 2.630 Test Acc: 0.464
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2654743
	speed: 0.1796s/iter; left time: 2223.0887s
Epoch: 20 cost time: 7.110829830169678
Epoch: 20, Steps: 154 | Train Loss: 0.400 Vali Loss: 2.526 Vali Acc: 0.502 Test Loss: 2.526 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.5749361
	speed: 0.1861s/iter; left time: 2273.9564s
Epoch: 21 cost time: 6.7838006019592285
Epoch: 21, Steps: 154 | Train Loss: 0.392 Vali Loss: 2.570 Vali Acc: 0.461 Test Loss: 2.570 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6566619
	speed: 0.1761s/iter; left time: 2124.3991s
Epoch: 22 cost time: 7.130363702774048
Epoch: 22, Steps: 154 | Train Loss: 0.410 Vali Loss: 2.672 Vali Acc: 0.471 Test Loss: 2.672 Test Acc: 0.471
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5267639902676399
model parameter : 67694
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4438672
	speed: 0.0540s/iter; left time: 825.6100s
Epoch: 1 cost time: 7.300991535186768
Epoch: 1, Steps: 154 | Train Loss: 2.149 Vali Loss: 1.884 Vali Acc: 0.391 Test Loss: 1.884 Test Acc: 0.391
Validation loss decreased (inf --> -0.391303).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8622731
	speed: 0.1697s/iter; left time: 2569.8449s
Epoch: 2 cost time: 6.72174596786499
Epoch: 2, Steps: 154 | Train Loss: 1.601 Vali Loss: 1.766 Vali Acc: 0.440 Test Loss: 1.766 Test Acc: 0.440
Validation loss decreased (-0.391303 --> -0.439966).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9368563
	speed: 0.1763s/iter; left time: 2643.7695s
Epoch: 3 cost time: 7.529918670654297
Epoch: 3, Steps: 154 | Train Loss: 1.312 Vali Loss: 1.634 Vali Acc: 0.487 Test Loss: 1.634 Test Acc: 0.487
Validation loss decreased (-0.439966 --> -0.487413).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7600730
	speed: 0.1941s/iter; left time: 2879.6244s
Epoch: 4 cost time: 7.353969573974609
Epoch: 4, Steps: 154 | Train Loss: 1.202 Vali Loss: 1.727 Vali Acc: 0.485 Test Loss: 1.727 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0035373
	speed: 0.1933s/iter; left time: 2838.7846s
Epoch: 5 cost time: 8.050659418106079
Epoch: 5, Steps: 154 | Train Loss: 1.118 Vali Loss: 1.611 Vali Acc: 0.530 Test Loss: 1.611 Test Acc: 0.530
Validation loss decreased (-0.487413 --> -0.530398).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6955273
	speed: 0.2096s/iter; left time: 3045.1810s
Epoch: 6 cost time: 8.621004819869995
Epoch: 6, Steps: 154 | Train Loss: 1.033 Vali Loss: 1.689 Vali Acc: 0.505 Test Loss: 1.689 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7477615
	speed: 0.2098s/iter; left time: 3016.1484s
Epoch: 7 cost time: 7.512603282928467
Epoch: 7, Steps: 154 | Train Loss: 0.981 Vali Loss: 1.636 Vali Acc: 0.506 Test Loss: 1.636 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9613981
	speed: 0.1699s/iter; left time: 2416.5273s
Epoch: 8 cost time: 6.890301704406738
Epoch: 8, Steps: 154 | Train Loss: 0.922 Vali Loss: 1.636 Vali Acc: 0.528 Test Loss: 1.636 Test Acc: 0.528
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.9761850
	speed: 0.1768s/iter; left time: 2487.3984s
Epoch: 9 cost time: 6.786279916763306
Epoch: 9, Steps: 154 | Train Loss: 0.887 Vali Loss: 1.755 Vali Acc: 0.479 Test Loss: 1.755 Test Acc: 0.479
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.8535398
	speed: 0.1658s/iter; left time: 2306.6645s
Epoch: 10 cost time: 6.403313398361206
Epoch: 10, Steps: 154 | Train Loss: 0.847 Vali Loss: 1.747 Vali Acc: 0.518 Test Loss: 1.747 Test Acc: 0.518
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.8296113
	speed: 0.1715s/iter; left time: 2360.0928s
Epoch: 11 cost time: 6.894735813140869
Epoch: 11, Steps: 154 | Train Loss: 0.815 Vali Loss: 1.698 Vali Acc: 0.536 Test Loss: 1.698 Test Acc: 0.536
Validation loss decreased (-0.530398 --> -0.536479).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4694228
	speed: 0.1772s/iter; left time: 2410.5188s
Epoch: 12 cost time: 6.4746763706207275
Epoch: 12, Steps: 154 | Train Loss: 0.754 Vali Loss: 1.791 Vali Acc: 0.506 Test Loss: 1.791 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6681698
	speed: 0.1724s/iter; left time: 2319.1924s
Epoch: 13 cost time: 6.796329021453857
Epoch: 13, Steps: 154 | Train Loss: 0.749 Vali Loss: 1.780 Vali Acc: 0.484 Test Loss: 1.780 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.6275215
	speed: 0.1751s/iter; left time: 2328.1643s
Epoch: 14 cost time: 6.592425107955933
Epoch: 14, Steps: 154 | Train Loss: 0.712 Vali Loss: 1.910 Vali Acc: 0.459 Test Loss: 1.910 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4022980
	speed: 0.1602s/iter; left time: 2105.5019s
Epoch: 15 cost time: 6.397304058074951
Epoch: 15, Steps: 154 | Train Loss: 0.674 Vali Loss: 2.029 Vali Acc: 0.509 Test Loss: 2.029 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.4704377
	speed: 0.1727s/iter; left time: 2243.2697s
Epoch: 16 cost time: 6.932705402374268
Epoch: 16, Steps: 154 | Train Loss: 0.630 Vali Loss: 1.903 Vali Acc: 0.487 Test Loss: 1.903 Test Acc: 0.487
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5794835
	speed: 0.1740s/iter; left time: 2233.1146s
Epoch: 17 cost time: 6.553897857666016
Epoch: 17, Steps: 154 | Train Loss: 0.612 Vali Loss: 2.049 Vali Acc: 0.444 Test Loss: 2.049 Test Acc: 0.444
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.4186946
	speed: 0.1641s/iter; left time: 2080.7849s
Epoch: 18 cost time: 6.090443134307861
Epoch: 18, Steps: 154 | Train Loss: 0.590 Vali Loss: 2.015 Vali Acc: 0.490 Test Loss: 2.015 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.6641826
	speed: 0.1646s/iter; left time: 2062.8287s
Epoch: 19 cost time: 6.241521835327148
Epoch: 19, Steps: 154 | Train Loss: 0.582 Vali Loss: 1.975 Vali Acc: 0.534 Test Loss: 1.975 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.7220365
	speed: 0.1521s/iter; left time: 1881.7340s
Epoch: 20 cost time: 6.239583492279053
Epoch: 20, Steps: 154 | Train Loss: 0.537 Vali Loss: 2.002 Vali Acc: 0.497 Test Loss: 2.002 Test Acc: 0.497
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.3952727
	speed: 0.1844s/iter; left time: 2254.1069s
Epoch: 21 cost time: 7.18485164642334
Epoch: 21, Steps: 154 | Train Loss: 0.501 Vali Loss: 2.136 Vali Acc: 0.509 Test Loss: 2.136 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5364963503649635
model parameter : 43518
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8495352
	speed: 0.0613s/iter; left time: 938.5988s
Epoch: 1 cost time: 8.703889846801758
Epoch: 1, Steps: 154 | Train Loss: 2.243 Vali Loss: 2.015 Vali Acc: 0.353 Test Loss: 2.015 Test Acc: 0.353
Validation loss decreased (inf --> -0.352778).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1521757
	speed: 0.1787s/iter; left time: 2706.0786s
Epoch: 2 cost time: 6.7188215255737305
Epoch: 2, Steps: 154 | Train Loss: 1.684 Vali Loss: 1.760 Vali Acc: 0.424 Test Loss: 1.760 Test Acc: 0.424
Validation loss decreased (-0.352778 --> -0.424151).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2356701
	speed: 0.1711s/iter; left time: 2565.1854s
Epoch: 3 cost time: 6.406657695770264
Epoch: 3, Steps: 154 | Train Loss: 1.351 Vali Loss: 1.849 Vali Acc: 0.454 Test Loss: 1.849 Test Acc: 0.454
Validation loss decreased (-0.424151 --> -0.453753).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8747580
	speed: 0.1593s/iter; left time: 2363.7555s
Epoch: 4 cost time: 6.246603727340698
Epoch: 4, Steps: 154 | Train Loss: 1.205 Vali Loss: 1.876 Vali Acc: 0.442 Test Loss: 1.876 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8509560
	speed: 0.1680s/iter; left time: 2466.8072s
Epoch: 5 cost time: 6.4117677211761475
Epoch: 5, Steps: 154 | Train Loss: 1.110 Vali Loss: 1.706 Vali Acc: 0.478 Test Loss: 1.706 Test Acc: 0.478
Validation loss decreased (-0.453753 --> -0.477680).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1079032
	speed: 0.1724s/iter; left time: 2505.0392s
Epoch: 6 cost time: 6.762124538421631
Epoch: 6, Steps: 154 | Train Loss: 1.040 Vali Loss: 1.686 Vali Acc: 0.509 Test Loss: 1.686 Test Acc: 0.509
Validation loss decreased (-0.477680 --> -0.508904).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8639761
	speed: 0.1746s/iter; left time: 2510.9299s
Epoch: 7 cost time: 6.485449314117432
Epoch: 7, Steps: 154 | Train Loss: 0.992 Vali Loss: 1.698 Vali Acc: 0.492 Test Loss: 1.698 Test Acc: 0.492
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0091271
	speed: 0.1687s/iter; left time: 2399.3023s
Epoch: 8 cost time: 6.1776018142700195
Epoch: 8, Steps: 154 | Train Loss: 0.945 Vali Loss: 1.720 Vali Acc: 0.504 Test Loss: 1.720 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.8377697
	speed: 0.1685s/iter; left time: 2370.8562s
Epoch: 9 cost time: 6.123944997787476
Epoch: 9, Steps: 154 | Train Loss: 0.899 Vali Loss: 1.854 Vali Acc: 0.492 Test Loss: 1.854 Test Acc: 0.492
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4947386
	speed: 0.1841s/iter; left time: 2562.0753s
Epoch: 10 cost time: 7.481633901596069
Epoch: 10, Steps: 154 | Train Loss: 0.854 Vali Loss: 1.783 Vali Acc: 0.493 Test Loss: 1.783 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3919256
	speed: 0.1901s/iter; left time: 2615.4860s
Epoch: 11 cost time: 7.416150331497192
Epoch: 11, Steps: 154 | Train Loss: 0.822 Vali Loss: 1.786 Vali Acc: 0.500 Test Loss: 1.786 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3160503
	speed: 0.1841s/iter; left time: 2505.6987s
Epoch: 12 cost time: 7.406123876571655
Epoch: 12, Steps: 154 | Train Loss: 0.753 Vali Loss: 1.714 Vali Acc: 0.517 Test Loss: 1.714 Test Acc: 0.517
Validation loss decreased (-0.508904 --> -0.516609).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4633842
	speed: 0.1584s/iter; left time: 2131.2512s
Epoch: 13 cost time: 5.719897508621216
Epoch: 13, Steps: 154 | Train Loss: 0.724 Vali Loss: 1.742 Vali Acc: 0.543 Test Loss: 1.742 Test Acc: 0.543
Validation loss decreased (-0.516609 --> -0.542562).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5393094
	speed: 0.1660s/iter; left time: 2207.7443s
Epoch: 14 cost time: 6.766647100448608
Epoch: 14, Steps: 154 | Train Loss: 0.702 Vali Loss: 1.805 Vali Acc: 0.538 Test Loss: 1.805 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.5056992
	speed: 0.1669s/iter; left time: 2194.4560s
Epoch: 15 cost time: 5.969897508621216
Epoch: 15, Steps: 154 | Train Loss: 0.656 Vali Loss: 1.834 Vali Acc: 0.487 Test Loss: 1.834 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3322905
	speed: 0.1676s/iter; left time: 2177.6024s
Epoch: 16 cost time: 6.784711122512817
Epoch: 16, Steps: 154 | Train Loss: 0.646 Vali Loss: 1.885 Vali Acc: 0.498 Test Loss: 1.885 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6116586
	speed: 0.1601s/iter; left time: 2054.9087s
Epoch: 17 cost time: 5.7473063468933105
Epoch: 17, Steps: 154 | Train Loss: 0.600 Vali Loss: 2.097 Vali Acc: 0.476 Test Loss: 2.097 Test Acc: 0.476
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4023957
	speed: 0.1797s/iter; left time: 2279.0611s
Epoch: 18 cost time: 7.3492751121521
Epoch: 18, Steps: 154 | Train Loss: 0.583 Vali Loss: 2.358 Vali Acc: 0.496 Test Loss: 2.358 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8430962
	speed: 0.1915s/iter; left time: 2399.4604s
Epoch: 19 cost time: 7.676605224609375
Epoch: 19, Steps: 154 | Train Loss: 0.549 Vali Loss: 2.046 Vali Acc: 0.509 Test Loss: 2.046 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2901143
	speed: 0.1736s/iter; left time: 2147.7171s
Epoch: 20 cost time: 6.035992383956909
Epoch: 20, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.274 Vali Acc: 0.502 Test Loss: 2.274 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2790467
	speed: 0.1739s/iter; left time: 2124.6269s
Epoch: 21 cost time: 7.165751218795776
Epoch: 21, Steps: 154 | Train Loss: 0.506 Vali Loss: 2.232 Vali Acc: 0.541 Test Loss: 2.232 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.4229578
	speed: 0.1661s/iter; left time: 2004.7567s
Epoch: 22 cost time: 6.125305652618408
Epoch: 22, Steps: 154 | Train Loss: 0.490 Vali Loss: 2.440 Vali Acc: 0.498 Test Loss: 2.440 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.3936692
	speed: 0.1674s/iter; left time: 1994.4487s
Epoch: 23 cost time: 6.290844678878784
Epoch: 23, Steps: 154 | Train Loss: 0.471 Vali Loss: 2.437 Vali Acc: 0.466 Test Loss: 2.437 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5425790754257908
model parameter : 43534
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6839858
	speed: 0.0596s/iter; left time: 911.2691s
Epoch: 1 cost time: 8.135610580444336
Epoch: 1, Steps: 154 | Train Loss: 2.327 Vali Loss: 2.035 Vali Acc: 0.326 Test Loss: 2.035 Test Acc: 0.326
Validation loss decreased (inf --> -0.325608).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6926219
	speed: 0.1637s/iter; left time: 2479.1134s
Epoch: 2 cost time: 6.0560595989227295
Epoch: 2, Steps: 154 | Train Loss: 1.758 Vali Loss: 1.842 Vali Acc: 0.419 Test Loss: 1.842 Test Acc: 0.419
Validation loss decreased (-0.325608 --> -0.419284).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6829256
	speed: 0.1624s/iter; left time: 2434.9753s
Epoch: 3 cost time: 5.89373254776001
Epoch: 3, Steps: 154 | Train Loss: 1.369 Vali Loss: 1.793 Vali Acc: 0.460 Test Loss: 1.793 Test Acc: 0.460
Validation loss decreased (-0.419284 --> -0.460242).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8979707
	speed: 0.1573s/iter; left time: 2334.8489s
Epoch: 4 cost time: 5.6389687061309814
Epoch: 4, Steps: 154 | Train Loss: 1.264 Vali Loss: 1.861 Vali Acc: 0.468 Test Loss: 1.861 Test Acc: 0.468
Validation loss decreased (-0.460242 --> -0.467540).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3012003
	speed: 0.1596s/iter; left time: 2343.4013s
Epoch: 5 cost time: 5.854089975357056
Epoch: 5, Steps: 154 | Train Loss: 1.197 Vali Loss: 2.056 Vali Acc: 0.441 Test Loss: 2.056 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9702444
	speed: 0.1649s/iter; left time: 2396.0813s
Epoch: 6 cost time: 6.1124958992004395
Epoch: 6, Steps: 154 | Train Loss: 1.106 Vali Loss: 1.906 Vali Acc: 0.459 Test Loss: 1.906 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7513347
	speed: 0.1659s/iter; left time: 2384.7669s
Epoch: 7 cost time: 6.192826271057129
Epoch: 7, Steps: 154 | Train Loss: 1.080 Vali Loss: 2.082 Vali Acc: 0.464 Test Loss: 2.082 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8109643
	speed: 0.1660s/iter; left time: 2360.6097s
Epoch: 8 cost time: 6.436421871185303
Epoch: 8, Steps: 154 | Train Loss: 1.034 Vali Loss: 2.025 Vali Acc: 0.451 Test Loss: 2.025 Test Acc: 0.451
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.5857209
	speed: 0.1667s/iter; left time: 2345.1487s
Epoch: 9 cost time: 6.353924989700317
Epoch: 9, Steps: 154 | Train Loss: 0.998 Vali Loss: 2.035 Vali Acc: 0.481 Test Loss: 2.035 Test Acc: 0.481
Validation loss decreased (-0.467540 --> -0.480515).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6377066
	speed: 0.1776s/iter; left time: 2470.6795s
Epoch: 10 cost time: 6.344908237457275
Epoch: 10, Steps: 154 | Train Loss: 0.964 Vali Loss: 1.938 Vali Acc: 0.474 Test Loss: 1.938 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9231703
	speed: 0.1598s/iter; left time: 2199.5744s
Epoch: 11 cost time: 6.09576678276062
Epoch: 11, Steps: 154 | Train Loss: 0.925 Vali Loss: 1.963 Vali Acc: 0.487 Test Loss: 1.963 Test Acc: 0.487
Validation loss decreased (-0.480515 --> -0.486598).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9383301
	speed: 0.1698s/iter; left time: 2310.5441s
Epoch: 12 cost time: 6.606578588485718
Epoch: 12, Steps: 154 | Train Loss: 0.882 Vali Loss: 1.887 Vali Acc: 0.491 Test Loss: 1.887 Test Acc: 0.491
Validation loss decreased (-0.486598 --> -0.491060).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7675468
	speed: 0.1793s/iter; left time: 2412.7882s
Epoch: 13 cost time: 7.171160936355591
Epoch: 13, Steps: 154 | Train Loss: 0.863 Vali Loss: 1.888 Vali Acc: 0.496 Test Loss: 1.888 Test Acc: 0.496
Validation loss decreased (-0.491060 --> -0.496331).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5571102
	speed: 0.1837s/iter; left time: 2442.7562s
Epoch: 14 cost time: 7.119055986404419
Epoch: 14, Steps: 154 | Train Loss: 0.842 Vali Loss: 1.871 Vali Acc: 0.487 Test Loss: 1.871 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7668021
	speed: 0.1721s/iter; left time: 2262.1881s
Epoch: 15 cost time: 6.084988832473755
Epoch: 15, Steps: 154 | Train Loss: 0.795 Vali Loss: 2.085 Vali Acc: 0.474 Test Loss: 2.085 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6725386
	speed: 0.1643s/iter; left time: 2134.1108s
Epoch: 16 cost time: 6.065771579742432
Epoch: 16, Steps: 154 | Train Loss: 0.773 Vali Loss: 1.917 Vali Acc: 0.478 Test Loss: 1.917 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.6508573
	speed: 0.1724s/iter; left time: 2213.0921s
Epoch: 17 cost time: 6.4803948402404785
Epoch: 17, Steps: 154 | Train Loss: 0.724 Vali Loss: 1.948 Vali Acc: 0.474 Test Loss: 1.948 Test Acc: 0.474
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.9058943
	speed: 0.1634s/iter; left time: 2072.7288s
Epoch: 18 cost time: 5.9509971141815186
Epoch: 18, Steps: 154 | Train Loss: 0.727 Vali Loss: 2.148 Vali Acc: 0.453 Test Loss: 2.148 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.3580039
	speed: 0.1699s/iter; left time: 2128.5785s
Epoch: 19 cost time: 6.709190130233765
Epoch: 19, Steps: 154 | Train Loss: 0.681 Vali Loss: 2.067 Vali Acc: 0.465 Test Loss: 2.067 Test Acc: 0.465
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.0250257
	speed: 0.1777s/iter; left time: 2199.0526s
Epoch: 20 cost time: 6.75445818901062
Epoch: 20, Steps: 154 | Train Loss: 0.654 Vali Loss: 1.889 Vali Acc: 0.498 Test Loss: 1.889 Test Acc: 0.498
Validation loss decreased (-0.496331 --> -0.498359).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.5283403
	speed: 0.1757s/iter; left time: 2146.7912s
Epoch: 21 cost time: 6.81414270401001
Epoch: 21, Steps: 154 | Train Loss: 0.633 Vali Loss: 1.996 Vali Acc: 0.485 Test Loss: 1.996 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5841768
	speed: 0.1725s/iter; left time: 2082.1373s
Epoch: 22 cost time: 6.4562976360321045
Epoch: 22, Steps: 154 | Train Loss: 0.607 Vali Loss: 2.165 Vali Acc: 0.476 Test Loss: 2.165 Test Acc: 0.476
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.7580893
	speed: 0.1688s/iter; left time: 2011.5029s
Epoch: 23 cost time: 6.281325340270996
Epoch: 23, Steps: 154 | Train Loss: 0.583 Vali Loss: 2.370 Vali Acc: 0.501 Test Loss: 2.370 Test Acc: 0.501
Validation loss decreased (-0.498359 --> -0.500787).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.3475127
	speed: 0.1650s/iter; left time: 1940.7840s
Epoch: 24 cost time: 6.5047221183776855
Epoch: 24, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.300 Vali Acc: 0.474 Test Loss: 2.300 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4465307
	speed: 0.1665s/iter; left time: 1932.1161s
Epoch: 25 cost time: 6.258507966995239
Epoch: 25, Steps: 154 | Train Loss: 0.575 Vali Loss: 2.588 Vali Acc: 0.452 Test Loss: 2.588 Test Acc: 0.452
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.5862699
	speed: 0.1850s/iter; left time: 2118.5216s
Epoch: 26 cost time: 8.761152505874634
Epoch: 26, Steps: 154 | Train Loss: 0.525 Vali Loss: 2.676 Vali Acc: 0.461 Test Loss: 2.676 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.7596179
	speed: 0.2028s/iter; left time: 2290.9081s
Epoch: 27 cost time: 8.590351581573486
Epoch: 27, Steps: 154 | Train Loss: 0.527 Vali Loss: 2.369 Vali Acc: 0.489 Test Loss: 2.369 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.1550413
	speed: 0.2176s/iter; left time: 2424.7128s
Epoch: 28 cost time: 8.77714729309082
Epoch: 28, Steps: 154 | Train Loss: 0.511 Vali Loss: 2.446 Vali Acc: 0.460 Test Loss: 2.446 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.7022773
	speed: 0.2255s/iter; left time: 2478.0622s
Epoch: 29 cost time: 9.298720359802246
Epoch: 29, Steps: 154 | Train Loss: 0.481 Vali Loss: 2.290 Vali Acc: 0.475 Test Loss: 2.290 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.1961234
	speed: 0.2199s/iter; left time: 2383.0874s
Epoch: 30 cost time: 8.71371078491211
Epoch: 30, Steps: 154 | Train Loss: 0.474 Vali Loss: 2.159 Vali Acc: 0.489 Test Loss: 2.159 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.5567082
	speed: 0.2110s/iter; left time: 2253.3235s
Epoch: 31 cost time: 8.124474048614502
Epoch: 31, Steps: 154 | Train Loss: 0.455 Vali Loss: 2.396 Vali Acc: 0.503 Test Loss: 2.396 Test Acc: 0.503
Validation loss decreased (-0.500787 --> -0.503220).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.3313270
	speed: 0.2059s/iter; left time: 2168.0114s
Epoch: 32 cost time: 8.229557752609253
Epoch: 32, Steps: 154 | Train Loss: 0.459 Vali Loss: 2.414 Vali Acc: 0.481 Test Loss: 2.414 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.3562221
	speed: 0.2095s/iter; left time: 2172.6643s
Epoch: 33 cost time: 8.310120820999146
Epoch: 33, Steps: 154 | Train Loss: 0.460 Vali Loss: 2.304 Vali Acc: 0.483 Test Loss: 2.304 Test Acc: 0.483
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.3996005
	speed: 0.2022s/iter; left time: 2066.0293s
Epoch: 34 cost time: 7.927570104598999
Epoch: 34, Steps: 154 | Train Loss: 0.449 Vali Loss: 2.550 Vali Acc: 0.481 Test Loss: 2.550 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.7181902
	speed: 0.2034s/iter; left time: 2047.1722s
Epoch: 35 cost time: 7.6494972705841064
Epoch: 35, Steps: 154 | Train Loss: 0.439 Vali Loss: 2.494 Vali Acc: 0.504 Test Loss: 2.494 Test Acc: 0.504
Validation loss decreased (-0.503220 --> -0.504030).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.4594094
	speed: 0.2032s/iter; left time: 2013.8598s
Epoch: 36 cost time: 7.986236095428467
Epoch: 36, Steps: 154 | Train Loss: 0.406 Vali Loss: 2.849 Vali Acc: 0.477 Test Loss: 2.849 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.1309624
	speed: 0.1941s/iter; left time: 1893.8965s
Epoch: 37 cost time: 8.188091278076172
Epoch: 37, Steps: 154 | Train Loss: 0.386 Vali Loss: 2.582 Vali Acc: 0.472 Test Loss: 2.582 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.3842431
	speed: 0.1736s/iter; left time: 1666.8073s
Epoch: 38 cost time: 6.36323356628418
Epoch: 38, Steps: 154 | Train Loss: 0.392 Vali Loss: 2.768 Vali Acc: 0.494 Test Loss: 2.768 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.5516543
	speed: 0.1727s/iter; left time: 1631.8422s
Epoch: 39 cost time: 7.433631896972656
Epoch: 39, Steps: 154 | Train Loss: 0.394 Vali Loss: 3.085 Vali Acc: 0.470 Test Loss: 3.085 Test Acc: 0.470
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.1971663
	speed: 0.1831s/iter; left time: 1701.9710s
Epoch: 40 cost time: 7.661499500274658
Epoch: 40, Steps: 154 | Train Loss: 0.372 Vali Loss: 2.716 Vali Acc: 0.488 Test Loss: 2.716 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.3346311
	speed: 0.1874s/iter; left time: 1713.0011s
Epoch: 41 cost time: 7.401220321655273
Epoch: 41, Steps: 154 | Train Loss: 0.363 Vali Loss: 2.785 Vali Acc: 0.494 Test Loss: 2.785 Test Acc: 0.494
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.2800717
	speed: 0.1832s/iter; left time: 1646.2900s
Epoch: 42 cost time: 6.989145755767822
Epoch: 42, Steps: 154 | Train Loss: 0.394 Vali Loss: 3.016 Vali Acc: 0.458 Test Loss: 3.016 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.6148565
	speed: 0.1783s/iter; left time: 1574.5286s
Epoch: 43 cost time: 6.816133499145508
Epoch: 43, Steps: 154 | Train Loss: 0.388 Vali Loss: 2.711 Vali Acc: 0.474 Test Loss: 2.711 Test Acc: 0.474
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.2731996
	speed: 0.1736s/iter; left time: 1507.0279s
Epoch: 44 cost time: 6.6102294921875
Epoch: 44, Steps: 154 | Train Loss: 0.371 Vali Loss: 2.911 Vali Acc: 0.485 Test Loss: 2.911 Test Acc: 0.485
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.6376584
	speed: 0.1990s/iter; left time: 1696.7237s
Epoch: 45 cost time: 7.283902645111084
Epoch: 45, Steps: 154 | Train Loss: 0.352 Vali Loss: 2.792 Vali Acc: 0.481 Test Loss: 2.792 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5040551500405515
model parameter : 35502
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1817231
	speed: 0.0710s/iter; left time: 1086.2375s
Epoch: 1 cost time: 9.582951307296753
Epoch: 1, Steps: 154 | Train Loss: 2.345 Vali Loss: 2.098 Vali Acc: 0.323 Test Loss: 2.098 Test Acc: 0.323
Validation loss decreased (inf --> -0.323174).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5460072
	speed: 0.2061s/iter; left time: 3121.9183s
Epoch: 2 cost time: 8.694422960281372
Epoch: 2, Steps: 154 | Train Loss: 1.883 Vali Loss: 1.743 Vali Acc: 0.404 Test Loss: 1.743 Test Acc: 0.404
Validation loss decreased (-0.323174 --> -0.404281).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8509281
	speed: 0.2087s/iter; left time: 3129.0264s
Epoch: 3 cost time: 7.6854870319366455
Epoch: 3, Steps: 154 | Train Loss: 1.469 Vali Loss: 1.684 Vali Acc: 0.460 Test Loss: 1.684 Test Acc: 0.460
Validation loss decreased (-0.404281 --> -0.460243).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9261527
	speed: 0.1889s/iter; left time: 2802.7440s
Epoch: 4 cost time: 8.068620681762695
Epoch: 4, Steps: 154 | Train Loss: 1.285 Vali Loss: 1.791 Vali Acc: 0.468 Test Loss: 1.791 Test Acc: 0.468
Validation loss decreased (-0.460243 --> -0.468352).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5397750
	speed: 0.1892s/iter; left time: 2777.9626s
Epoch: 5 cost time: 6.729834079742432
Epoch: 5, Steps: 154 | Train Loss: 1.222 Vali Loss: 1.847 Vali Acc: 0.465 Test Loss: 1.847 Test Acc: 0.465
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1455321
	speed: 0.1680s/iter; left time: 2441.2165s
Epoch: 6 cost time: 6.444549083709717
Epoch: 6, Steps: 154 | Train Loss: 1.169 Vali Loss: 1.740 Vali Acc: 0.492 Test Loss: 1.740 Test Acc: 0.492
Validation loss decreased (-0.468352 --> -0.492278).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2268050
	speed: 0.1980s/iter; left time: 2847.0254s
Epoch: 7 cost time: 8.821782112121582
Epoch: 7, Steps: 154 | Train Loss: 1.114 Vali Loss: 1.704 Vali Acc: 0.497 Test Loss: 1.704 Test Acc: 0.497
Validation loss decreased (-0.492278 --> -0.496739).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1148793
	speed: 0.2102s/iter; left time: 2990.1664s
Epoch: 8 cost time: 8.060919046401978
Epoch: 8, Steps: 154 | Train Loss: 1.076 Vali Loss: 1.659 Vali Acc: 0.513 Test Loss: 1.659 Test Acc: 0.513
Validation loss decreased (-0.496739 --> -0.513365).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5996318
	speed: 0.1866s/iter; left time: 2625.1726s
Epoch: 9 cost time: 7.0860278606414795
Epoch: 9, Steps: 154 | Train Loss: 1.020 Vali Loss: 1.826 Vali Acc: 0.496 Test Loss: 1.826 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8868251
	speed: 0.2011s/iter; left time: 2798.1417s
Epoch: 10 cost time: 8.009801387786865
Epoch: 10, Steps: 154 | Train Loss: 0.988 Vali Loss: 1.687 Vali Acc: 0.498 Test Loss: 1.687 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3979940
	speed: 0.2025s/iter; left time: 2786.7861s
Epoch: 11 cost time: 7.2871904373168945
Epoch: 11, Steps: 154 | Train Loss: 0.987 Vali Loss: 1.647 Vali Acc: 0.491 Test Loss: 1.647 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.9076521
	speed: 0.1674s/iter; left time: 2278.4431s
Epoch: 12 cost time: 6.603247165679932
Epoch: 12, Steps: 154 | Train Loss: 0.919 Vali Loss: 1.735 Vali Acc: 0.495 Test Loss: 1.735 Test Acc: 0.495
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6805272
	speed: 0.1824s/iter; left time: 2454.0645s
Epoch: 13 cost time: 8.342604637145996
Epoch: 13, Steps: 154 | Train Loss: 0.879 Vali Loss: 2.104 Vali Acc: 0.453 Test Loss: 2.104 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.0830343
	speed: 0.1981s/iter; left time: 2634.3648s
Epoch: 14 cost time: 7.5051398277282715
Epoch: 14, Steps: 154 | Train Loss: 0.861 Vali Loss: 1.928 Vali Acc: 0.474 Test Loss: 1.928 Test Acc: 0.474
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6447365
	speed: 0.2103s/iter; left time: 2764.9711s
Epoch: 15 cost time: 9.206421852111816
Epoch: 15, Steps: 154 | Train Loss: 0.837 Vali Loss: 1.761 Vali Acc: 0.498 Test Loss: 1.761 Test Acc: 0.498
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1456329
	speed: 0.2104s/iter; left time: 2732.7340s
Epoch: 16 cost time: 8.122605085372925
Epoch: 16, Steps: 154 | Train Loss: 0.814 Vali Loss: 1.992 Vali Acc: 0.457 Test Loss: 1.992 Test Acc: 0.457
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.8220633
	speed: 0.1708s/iter; left time: 2192.8338s
Epoch: 17 cost time: 6.206579923629761
Epoch: 17, Steps: 154 | Train Loss: 0.781 Vali Loss: 1.857 Vali Acc: 0.499 Test Loss: 1.857 Test Acc: 0.499
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.7848120
	speed: 0.1973s/iter; left time: 2502.5113s
Epoch: 18 cost time: 8.755494594573975
Epoch: 18, Steps: 154 | Train Loss: 0.770 Vali Loss: 1.842 Vali Acc: 0.502 Test Loss: 1.842 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.51338199513382
model parameter : 31502
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1194029
	speed: 0.0622s/iter; left time: 951.8994s
Epoch: 1 cost time: 8.712398052215576
Epoch: 1, Steps: 154 | Train Loss: 2.354 Vali Loss: 2.135 Vali Acc: 0.314 Test Loss: 2.135 Test Acc: 0.314
Validation loss decreased (inf --> -0.313847).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2840610
	speed: 0.2174s/iter; left time: 3293.2932s
Epoch: 2 cost time: 8.521230936050415
Epoch: 2, Steps: 154 | Train Loss: 2.044 Vali Loss: 1.883 Vali Acc: 0.413 Test Loss: 1.883 Test Acc: 0.413
Validation loss decreased (-0.313847 --> -0.413201).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8475392
	speed: 0.2168s/iter; left time: 3250.3626s
Epoch: 3 cost time: 8.712526798248291
Epoch: 3, Steps: 154 | Train Loss: 1.687 Vali Loss: 1.738 Vali Acc: 0.409 Test Loss: 1.738 Test Acc: 0.409
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7405118
	speed: 0.2099s/iter; left time: 3114.1654s
Epoch: 4 cost time: 8.601925134658813
Epoch: 4, Steps: 154 | Train Loss: 1.422 Vali Loss: 1.689 Vali Acc: 0.468 Test Loss: 1.689 Test Acc: 0.468
Validation loss decreased (-0.413201 --> -0.467542).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0714177
	speed: 0.2231s/iter; left time: 3276.6768s
Epoch: 5 cost time: 8.988306283950806
Epoch: 5, Steps: 154 | Train Loss: 1.273 Vali Loss: 1.618 Vali Acc: 0.490 Test Loss: 1.618 Test Acc: 0.490
Validation loss decreased (-0.467542 --> -0.489846).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2166444
	speed: 0.1997s/iter; left time: 2901.5274s
Epoch: 6 cost time: 6.766418695449829
Epoch: 6, Steps: 154 | Train Loss: 1.220 Vali Loss: 1.671 Vali Acc: 0.489 Test Loss: 1.671 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8908492
	speed: 0.2051s/iter; left time: 2948.8222s
Epoch: 7 cost time: 8.771245956420898
Epoch: 7, Steps: 154 | Train Loss: 1.186 Vali Loss: 1.709 Vali Acc: 0.507 Test Loss: 1.709 Test Acc: 0.507
Validation loss decreased (-0.489846 --> -0.506877).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7760553
	speed: 0.2161s/iter; left time: 3073.3376s
Epoch: 8 cost time: 8.769095182418823
Epoch: 8, Steps: 154 | Train Loss: 1.144 Vali Loss: 1.792 Vali Acc: 0.474 Test Loss: 1.792 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1446226
	speed: 0.2097s/iter; left time: 2950.0166s
Epoch: 9 cost time: 7.868112802505493
Epoch: 9, Steps: 154 | Train Loss: 1.104 Vali Loss: 1.810 Vali Acc: 0.500 Test Loss: 1.810 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.5263691
	speed: 0.2110s/iter; left time: 2936.0034s
Epoch: 10 cost time: 8.083381652832031
Epoch: 10, Steps: 154 | Train Loss: 1.069 Vali Loss: 1.648 Vali Acc: 0.506 Test Loss: 1.648 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1680521
	speed: 0.2132s/iter; left time: 2934.1772s
Epoch: 11 cost time: 10.157935857772827
Epoch: 11, Steps: 154 | Train Loss: 1.058 Vali Loss: 1.798 Vali Acc: 0.495 Test Loss: 1.798 Test Acc: 0.495
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6131423
	speed: 0.2383s/iter; left time: 3242.2516s
Epoch: 12 cost time: 9.496390342712402
Epoch: 12, Steps: 154 | Train Loss: 1.012 Vali Loss: 1.752 Vali Acc: 0.485 Test Loss: 1.752 Test Acc: 0.485
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.7918584
	speed: 0.2395s/iter; left time: 3222.2463s
Epoch: 13 cost time: 9.737826824188232
Epoch: 13, Steps: 154 | Train Loss: 0.988 Vali Loss: 1.857 Vali Acc: 0.485 Test Loss: 1.857 Test Acc: 0.485
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.8462833
	speed: 0.2423s/iter; left time: 3222.4605s
Epoch: 14 cost time: 10.481672763824463
Epoch: 14, Steps: 154 | Train Loss: 0.958 Vali Loss: 1.808 Vali Acc: 0.506 Test Loss: 1.808 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0577848
	speed: 0.2296s/iter; left time: 3017.6987s
Epoch: 15 cost time: 8.738367557525635
Epoch: 15, Steps: 154 | Train Loss: 0.931 Vali Loss: 1.794 Vali Acc: 0.504 Test Loss: 1.794 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.6727104
	speed: 0.2382s/iter; left time: 3094.1011s
Epoch: 16 cost time: 10.415879487991333
Epoch: 16, Steps: 154 | Train Loss: 0.916 Vali Loss: 1.897 Vali Acc: 0.481 Test Loss: 1.897 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.2114264
	speed: 0.2757s/iter; left time: 3539.4682s
Epoch: 17 cost time: 12.954529523849487
Epoch: 17, Steps: 154 | Train Loss: 0.889 Vali Loss: 1.842 Vali Acc: 0.502 Test Loss: 1.842 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5068937550689375
model parameter : 28830
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1826851
	speed: 0.0947s/iter; left time: 1448.4533s
Epoch: 1 cost time: 13.268576622009277
Epoch: 1, Steps: 154 | Train Loss: 2.184 Vali Loss: 1.935 Vali Acc: 0.399 Test Loss: 1.935 Test Acc: 0.399
Validation loss decreased (inf --> -0.399413).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5987117
	speed: 0.2760s/iter; left time: 4181.2753s
Epoch: 2 cost time: 11.920038223266602
Epoch: 2, Steps: 154 | Train Loss: 1.610 Vali Loss: 1.628 Vali Acc: 0.489 Test Loss: 1.628 Test Acc: 0.489
Validation loss decreased (-0.399413 --> -0.489440).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0233868
	speed: 0.2651s/iter; left time: 3974.9492s
Epoch: 3 cost time: 8.79855990409851
Epoch: 3, Steps: 154 | Train Loss: 1.256 Vali Loss: 1.677 Vali Acc: 0.516 Test Loss: 1.677 Test Acc: 0.516
Validation loss decreased (-0.489440 --> -0.516204).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3238238
	speed: 0.2231s/iter; left time: 3309.9360s
Epoch: 4 cost time: 11.193902969360352
Epoch: 4, Steps: 154 | Train Loss: 1.134 Vali Loss: 1.722 Vali Acc: 0.495 Test Loss: 1.722 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.7385910
	speed: 0.2820s/iter; left time: 4140.9961s
Epoch: 5 cost time: 11.276845693588257
Epoch: 5, Steps: 154 | Train Loss: 1.010 Vali Loss: 1.754 Vali Acc: 0.525 Test Loss: 1.754 Test Acc: 0.525
Validation loss decreased (-0.516204 --> -0.525124).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5318694
	speed: 0.2624s/iter; left time: 3812.2630s
Epoch: 6 cost time: 10.263265371322632
Epoch: 6, Steps: 154 | Train Loss: 0.948 Vali Loss: 1.794 Vali Acc: 0.487 Test Loss: 1.794 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9297710
	speed: 0.2703s/iter; left time: 3886.5252s
Epoch: 7 cost time: 11.638731241226196
Epoch: 7, Steps: 154 | Train Loss: 0.896 Vali Loss: 1.824 Vali Acc: 0.511 Test Loss: 1.824 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7792286
	speed: 0.2749s/iter; left time: 3910.1992s
Epoch: 8 cost time: 10.598592042922974
Epoch: 8, Steps: 154 | Train Loss: 0.850 Vali Loss: 1.978 Vali Acc: 0.451 Test Loss: 1.978 Test Acc: 0.451
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.5393648
	speed: 0.2433s/iter; left time: 3423.3303s
Epoch: 9 cost time: 8.483937501907349
Epoch: 9, Steps: 154 | Train Loss: 0.766 Vali Loss: 2.073 Vali Acc: 0.473 Test Loss: 2.073 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.1900544
	speed: 0.2572s/iter; left time: 3578.5721s
Epoch: 10 cost time: 11.359167575836182
Epoch: 10, Steps: 154 | Train Loss: 0.748 Vali Loss: 2.055 Vali Acc: 0.501 Test Loss: 2.055 Test Acc: 0.501
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.5882100
	speed: 0.2760s/iter; left time: 3797.9055s
Epoch: 11 cost time: 10.77039647102356
Epoch: 11, Steps: 154 | Train Loss: 0.687 Vali Loss: 2.056 Vali Acc: 0.462 Test Loss: 2.056 Test Acc: 0.462
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3441073
	speed: 0.2524s/iter; left time: 3434.2305s
Epoch: 12 cost time: 10.70169973373413
Epoch: 12, Steps: 154 | Train Loss: 0.631 Vali Loss: 2.288 Vali Acc: 0.466 Test Loss: 2.288 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.8360687
	speed: 0.2677s/iter; left time: 3601.8915s
Epoch: 13 cost time: 11.037832975387573
Epoch: 13, Steps: 154 | Train Loss: 0.589 Vali Loss: 2.080 Vali Acc: 0.537 Test Loss: 2.080 Test Acc: 0.537
Validation loss decreased (-0.525124 --> -0.536881).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7412586
	speed: 0.2451s/iter; left time: 3260.1082s
Epoch: 14 cost time: 9.763984680175781
Epoch: 14, Steps: 154 | Train Loss: 0.544 Vali Loss: 2.218 Vali Acc: 0.459 Test Loss: 2.218 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.2267609
	speed: 0.2583s/iter; left time: 3395.6031s
Epoch: 15 cost time: 10.44976806640625
Epoch: 15, Steps: 154 | Train Loss: 0.501 Vali Loss: 2.348 Vali Acc: 0.467 Test Loss: 2.348 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.3942912
	speed: 0.2584s/iter; left time: 3356.9152s
Epoch: 16 cost time: 10.84581208229065
Epoch: 16, Steps: 154 | Train Loss: 0.499 Vali Loss: 2.483 Vali Acc: 0.433 Test Loss: 2.483 Test Acc: 0.433
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4847667
	speed: 0.2733s/iter; left time: 3508.3125s
Epoch: 17 cost time: 11.751282453536987
Epoch: 17, Steps: 154 | Train Loss: 0.474 Vali Loss: 2.542 Vali Acc: 0.441 Test Loss: 2.542 Test Acc: 0.441
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3067742
	speed: 0.2564s/iter; left time: 3252.0287s
Epoch: 18 cost time: 9.536638975143433
Epoch: 18, Steps: 154 | Train Loss: 0.433 Vali Loss: 2.497 Vali Acc: 0.500 Test Loss: 2.497 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.5394899
	speed: 0.2501s/iter; left time: 3133.4705s
Epoch: 19 cost time: 10.719223260879517
Epoch: 19, Steps: 154 | Train Loss: 0.414 Vali Loss: 2.510 Vali Acc: 0.464 Test Loss: 2.510 Test Acc: 0.464
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.5395489
	speed: 0.2510s/iter; left time: 3105.7693s
Epoch: 20 cost time: 10.023794889450073
Epoch: 20, Steps: 154 | Train Loss: 0.399 Vali Loss: 2.667 Vali Acc: 0.466 Test Loss: 2.667 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.3446261
	speed: 0.2327s/iter; left time: 2844.2021s
Epoch: 21 cost time: 8.960367679595947
Epoch: 21, Steps: 154 | Train Loss: 0.394 Vali Loss: 2.836 Vali Acc: 0.458 Test Loss: 2.836 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2396716
	speed: 0.2496s/iter; left time: 3011.4017s
Epoch: 22 cost time: 11.193425178527832
Epoch: 22, Steps: 154 | Train Loss: 0.373 Vali Loss: 2.804 Vali Acc: 0.468 Test Loss: 2.804 Test Acc: 0.468
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4870206
	speed: 0.2608s/iter; left time: 3106.3685s
Epoch: 23 cost time: 10.327603816986084
Epoch: 23, Steps: 154 | Train Loss: 0.369 Vali Loss: 2.996 Vali Acc: 0.492 Test Loss: 2.996 Test Acc: 0.492
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5369018653690186
model parameter : 59246
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5338855
	speed: 0.0726s/iter; left time: 1110.4604s
Epoch: 1 cost time: 9.945797681808472
Epoch: 1, Steps: 154 | Train Loss: 2.197 Vali Loss: 1.884 Vali Acc: 0.397 Test Loss: 1.884 Test Acc: 0.397
Validation loss decreased (inf --> -0.396980).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4831533
	speed: 0.2218s/iter; left time: 3359.7223s
Epoch: 2 cost time: 8.462204933166504
Epoch: 2, Steps: 154 | Train Loss: 1.624 Vali Loss: 1.885 Vali Acc: 0.436 Test Loss: 1.885 Test Acc: 0.436
Validation loss decreased (-0.396980 --> -0.436315).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0803670
	speed: 0.2198s/iter; left time: 3295.2550s
Epoch: 3 cost time: 9.00267481803894
Epoch: 3, Steps: 154 | Train Loss: 1.306 Vali Loss: 1.676 Vali Acc: 0.468 Test Loss: 1.676 Test Acc: 0.468
Validation loss decreased (-0.436315 --> -0.468353).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4893219
	speed: 0.2246s/iter; left time: 3332.3889s
Epoch: 4 cost time: 8.397734880447388
Epoch: 4, Steps: 154 | Train Loss: 1.181 Vali Loss: 1.618 Vali Acc: 0.495 Test Loss: 1.618 Test Acc: 0.495
Validation loss decreased (-0.468353 --> -0.494712).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4515802
	speed: 0.2008s/iter; left time: 2949.4242s
Epoch: 5 cost time: 8.093771934509277
Epoch: 5, Steps: 154 | Train Loss: 1.079 Vali Loss: 1.703 Vali Acc: 0.480 Test Loss: 1.703 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1068926
	speed: 0.2253s/iter; left time: 3274.2733s
Epoch: 6 cost time: 9.356815814971924
Epoch: 6, Steps: 154 | Train Loss: 1.019 Vali Loss: 1.605 Vali Acc: 0.517 Test Loss: 1.605 Test Acc: 0.517
Validation loss decreased (-0.494712 --> -0.517016).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7358921
	speed: 0.2195s/iter; left time: 3155.6323s
Epoch: 7 cost time: 8.084274291992188
Epoch: 7, Steps: 154 | Train Loss: 0.988 Vali Loss: 1.643 Vali Acc: 0.512 Test Loss: 1.643 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9591736
	speed: 0.2190s/iter; left time: 3114.3028s
Epoch: 8 cost time: 9.27021050453186
Epoch: 8, Steps: 154 | Train Loss: 0.930 Vali Loss: 1.732 Vali Acc: 0.497 Test Loss: 1.732 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6087383
	speed: 0.2195s/iter; left time: 3087.6190s
Epoch: 9 cost time: 8.738377809524536
Epoch: 9, Steps: 154 | Train Loss: 0.868 Vali Loss: 1.660 Vali Acc: 0.535 Test Loss: 1.660 Test Acc: 0.535
Validation loss decreased (-0.517016 --> -0.534858).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5091480
	speed: 0.2121s/iter; left time: 2950.7586s
Epoch: 10 cost time: 8.174861669540405
Epoch: 10, Steps: 154 | Train Loss: 0.845 Vali Loss: 1.706 Vali Acc: 0.498 Test Loss: 1.706 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0507371
	speed: 0.2151s/iter; left time: 2959.9246s
Epoch: 11 cost time: 9.005614995956421
Epoch: 11, Steps: 154 | Train Loss: 0.825 Vali Loss: 1.692 Vali Acc: 0.543 Test Loss: 1.692 Test Acc: 0.543
Validation loss decreased (-0.534858 --> -0.543373).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1469024
	speed: 0.2180s/iter; left time: 2966.5513s
Epoch: 12 cost time: 8.347618341445923
Epoch: 12, Steps: 154 | Train Loss: 0.807 Vali Loss: 1.843 Vali Acc: 0.505 Test Loss: 1.843 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6619810
	speed: 0.2105s/iter; left time: 2832.0960s
Epoch: 13 cost time: 8.802655458450317
Epoch: 13, Steps: 154 | Train Loss: 0.742 Vali Loss: 1.841 Vali Acc: 0.511 Test Loss: 1.841 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.9275547
	speed: 0.2585s/iter; left time: 3437.3760s
Epoch: 14 cost time: 10.749118089675903
Epoch: 14, Steps: 154 | Train Loss: 0.715 Vali Loss: 1.944 Vali Acc: 0.540 Test Loss: 1.944 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.7931408
	speed: 0.2594s/iter; left time: 3409.3384s
Epoch: 15 cost time: 10.333961486816406
Epoch: 15, Steps: 154 | Train Loss: 0.684 Vali Loss: 1.870 Vali Acc: 0.533 Test Loss: 1.870 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6309922
	speed: 0.2509s/iter; left time: 3259.0085s
Epoch: 16 cost time: 10.825050354003906
Epoch: 16, Steps: 154 | Train Loss: 0.687 Vali Loss: 1.912 Vali Acc: 0.517 Test Loss: 1.912 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1783093
	speed: 0.2565s/iter; left time: 3293.0233s
Epoch: 17 cost time: 10.131673574447632
Epoch: 17, Steps: 154 | Train Loss: 0.643 Vali Loss: 1.877 Vali Acc: 0.524 Test Loss: 1.877 Test Acc: 0.524
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.5772136
	speed: 0.2423s/iter; left time: 3073.4112s
Epoch: 18 cost time: 10.019493579864502
Epoch: 18, Steps: 154 | Train Loss: 0.627 Vali Loss: 1.997 Vali Acc: 0.512 Test Loss: 1.997 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.5747603
	speed: 0.2555s/iter; left time: 3200.8202s
Epoch: 19 cost time: 10.675745010375977
Epoch: 19, Steps: 154 | Train Loss: 0.566 Vali Loss: 2.118 Vali Acc: 0.504 Test Loss: 2.118 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.7461373
	speed: 0.2409s/iter; left time: 2980.8517s
Epoch: 20 cost time: 9.102682828903198
Epoch: 20, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.042 Vali Acc: 0.483 Test Loss: 2.042 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.4889204
	speed: 0.2466s/iter; left time: 3013.7666s
Epoch: 21 cost time: 10.410012006759644
Epoch: 21, Steps: 154 | Train Loss: 0.557 Vali Loss: 2.022 Vali Acc: 0.515 Test Loss: 2.022 Test Acc: 0.515
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5433901054339011
model parameter : 35070
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8980159
	speed: 0.0780s/iter; left time: 1193.7879s
Epoch: 1 cost time: 10.936753273010254
Epoch: 1, Steps: 154 | Train Loss: 2.231 Vali Loss: 1.974 Vali Acc: 0.363 Test Loss: 1.974 Test Acc: 0.363
Validation loss decreased (inf --> -0.363322).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6165684
	speed: 0.2113s/iter; left time: 3200.5760s
Epoch: 2 cost time: 7.689319372177124
Epoch: 2, Steps: 154 | Train Loss: 1.686 Vali Loss: 1.741 Vali Acc: 0.436 Test Loss: 1.741 Test Acc: 0.436
Validation loss decreased (-0.363322 --> -0.436317).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7808346
	speed: 0.2216s/iter; left time: 3321.9079s
Epoch: 3 cost time: 9.458796262741089
Epoch: 3, Steps: 154 | Train Loss: 1.342 Vali Loss: 1.799 Vali Acc: 0.423 Test Loss: 1.799 Test Acc: 0.423
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1793052
	speed: 0.2417s/iter; left time: 3586.0689s
Epoch: 4 cost time: 10.068669080734253
Epoch: 4, Steps: 154 | Train Loss: 1.215 Vali Loss: 1.726 Vali Acc: 0.482 Test Loss: 1.726 Test Acc: 0.482
Validation loss decreased (-0.436317 --> -0.482140).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4970697
	speed: 0.2409s/iter; left time: 3537.5296s
Epoch: 5 cost time: 9.449881792068481
Epoch: 5, Steps: 154 | Train Loss: 1.156 Vali Loss: 1.884 Vali Acc: 0.483 Test Loss: 1.884 Test Acc: 0.483
Validation loss decreased (-0.482140 --> -0.482544).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5152659
	speed: 0.2345s/iter; left time: 3408.1870s
Epoch: 6 cost time: 10.328073740005493
Epoch: 6, Steps: 154 | Train Loss: 1.075 Vali Loss: 1.902 Vali Acc: 0.448 Test Loss: 1.902 Test Acc: 0.448
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8146466
	speed: 0.2450s/iter; left time: 3522.5706s
Epoch: 7 cost time: 9.767118215560913
Epoch: 7, Steps: 154 | Train Loss: 0.993 Vali Loss: 1.924 Vali Acc: 0.485 Test Loss: 1.924 Test Acc: 0.485
Validation loss decreased (-0.482544 --> -0.485382).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5885790
	speed: 0.2061s/iter; left time: 2931.3712s
Epoch: 8 cost time: 7.437207937240601
Epoch: 8, Steps: 154 | Train Loss: 0.985 Vali Loss: 1.871 Vali Acc: 0.456 Test Loss: 1.871 Test Acc: 0.456
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1945533
	speed: 0.2240s/iter; left time: 3151.4358s
Epoch: 9 cost time: 9.815796613693237
Epoch: 9, Steps: 154 | Train Loss: 0.924 Vali Loss: 1.824 Vali Acc: 0.515 Test Loss: 1.824 Test Acc: 0.515
Validation loss decreased (-0.485382 --> -0.515391).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8572448
	speed: 0.2346s/iter; left time: 3264.9725s
Epoch: 10 cost time: 9.566789627075195
Epoch: 10, Steps: 154 | Train Loss: 0.873 Vali Loss: 1.952 Vali Acc: 0.490 Test Loss: 1.952 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.6229905
	speed: 0.2294s/iter; left time: 3157.0610s
Epoch: 11 cost time: 9.633134841918945
Epoch: 11, Steps: 154 | Train Loss: 0.848 Vali Loss: 1.864 Vali Acc: 0.498 Test Loss: 1.864 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9141581
	speed: 0.2389s/iter; left time: 3251.2538s
Epoch: 12 cost time: 9.264800786972046
Epoch: 12, Steps: 154 | Train Loss: 0.814 Vali Loss: 2.081 Vali Acc: 0.508 Test Loss: 2.081 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0359634
	speed: 0.2134s/iter; left time: 2871.3848s
Epoch: 13 cost time: 7.925906419754028
Epoch: 13, Steps: 154 | Train Loss: 0.762 Vali Loss: 1.835 Vali Acc: 0.517 Test Loss: 1.835 Test Acc: 0.517
Validation loss decreased (-0.515391 --> -0.517013).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6674064
	speed: 0.2245s/iter; left time: 2985.5975s
Epoch: 14 cost time: 9.995166301727295
Epoch: 14, Steps: 154 | Train Loss: 0.743 Vali Loss: 1.942 Vali Acc: 0.493 Test Loss: 1.942 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1260343
	speed: 0.2418s/iter; left time: 3178.3416s
Epoch: 15 cost time: 9.536285877227783
Epoch: 15, Steps: 154 | Train Loss: 0.711 Vali Loss: 2.062 Vali Acc: 0.476 Test Loss: 2.062 Test Acc: 0.476
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6043500
	speed: 0.2260s/iter; left time: 2936.5766s
Epoch: 16 cost time: 8.927954912185669
Epoch: 16, Steps: 154 | Train Loss: 0.672 Vali Loss: 1.947 Vali Acc: 0.534 Test Loss: 1.947 Test Acc: 0.534
Validation loss decreased (-0.517013 --> -0.534449).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6984316
	speed: 0.2282s/iter; left time: 2929.0835s
Epoch: 17 cost time: 9.179056644439697
Epoch: 17, Steps: 154 | Train Loss: 0.645 Vali Loss: 2.030 Vali Acc: 0.492 Test Loss: 2.030 Test Acc: 0.492
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5551490
	speed: 0.2382s/iter; left time: 3020.7924s
Epoch: 18 cost time: 9.928118467330933
Epoch: 18, Steps: 154 | Train Loss: 0.626 Vali Loss: 2.186 Vali Acc: 0.469 Test Loss: 2.186 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4935498
	speed: 0.2445s/iter; left time: 3062.9904s
Epoch: 19 cost time: 9.972585439682007
Epoch: 19, Steps: 154 | Train Loss: 0.608 Vali Loss: 2.068 Vali Acc: 0.532 Test Loss: 2.068 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.7757878
	speed: 0.2362s/iter; left time: 2922.5230s
Epoch: 20 cost time: 8.677003145217896
Epoch: 20, Steps: 154 | Train Loss: 0.600 Vali Loss: 2.361 Vali Acc: 0.485 Test Loss: 2.361 Test Acc: 0.485
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.7051769
	speed: 0.2246s/iter; left time: 2744.7002s
Epoch: 21 cost time: 8.011858701705933
Epoch: 21, Steps: 154 | Train Loss: 0.561 Vali Loss: 2.079 Vali Acc: 0.525 Test Loss: 2.079 Test Acc: 0.525
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.5993831
	speed: 0.1764s/iter; left time: 2128.5541s
Epoch: 22 cost time: 7.258849620819092
Epoch: 22, Steps: 154 | Train Loss: 0.562 Vali Loss: 2.322 Vali Acc: 0.509 Test Loss: 2.322 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.6728933
	speed: 0.1967s/iter; left time: 2343.0719s
Epoch: 23 cost time: 8.075600147247314
Epoch: 23, Steps: 154 | Train Loss: 0.516 Vali Loss: 2.284 Vali Acc: 0.472 Test Loss: 2.284 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.5914966
	speed: 0.1973s/iter; left time: 2319.8371s
Epoch: 24 cost time: 7.962382078170776
Epoch: 24, Steps: 154 | Train Loss: 0.516 Vali Loss: 2.358 Vali Acc: 0.507 Test Loss: 2.358 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.2709126
	speed: 0.2123s/iter; left time: 2464.1765s
Epoch: 25 cost time: 8.203504800796509
Epoch: 25, Steps: 154 | Train Loss: 0.485 Vali Loss: 2.390 Vali Acc: 0.500 Test Loss: 2.390 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.3729476
	speed: 0.2079s/iter; left time: 2380.5128s
Epoch: 26 cost time: 8.07135534286499
Epoch: 26, Steps: 154 | Train Loss: 0.479 Vali Loss: 2.362 Vali Acc: 0.494 Test Loss: 2.362 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5344687753446877
model parameter : 35086
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0748801
	speed: 0.0690s/iter; left time: 1055.9063s
Epoch: 1 cost time: 9.814216375350952
Epoch: 1, Steps: 154 | Train Loss: 2.306 Vali Loss: 2.096 Vali Acc: 0.328 Test Loss: 2.096 Test Acc: 0.328
Validation loss decreased (inf --> -0.328041).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8004194
	speed: 0.1973s/iter; left time: 2989.1540s
Epoch: 2 cost time: 7.551957845687866
Epoch: 2, Steps: 154 | Train Loss: 1.815 Vali Loss: 1.765 Vali Acc: 0.418 Test Loss: 1.765 Test Acc: 0.418
Validation loss decreased (-0.328041 --> -0.418068).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5010858
	speed: 0.1905s/iter; left time: 2855.7704s
Epoch: 3 cost time: 7.155577659606934
Epoch: 3, Steps: 154 | Train Loss: 1.405 Vali Loss: 1.732 Vali Acc: 0.453 Test Loss: 1.732 Test Acc: 0.453
Validation loss decreased (-0.418068 --> -0.453348).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6744953
	speed: 0.1803s/iter; left time: 2674.7645s
Epoch: 4 cost time: 7.027557611465454
Epoch: 4, Steps: 154 | Train Loss: 1.256 Vali Loss: 1.895 Vali Acc: 0.462 Test Loss: 1.895 Test Acc: 0.462
Validation loss decreased (-0.453348 --> -0.462268).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3522716
	speed: 0.1943s/iter; left time: 2852.9418s
Epoch: 5 cost time: 8.004297971725464
Epoch: 5, Steps: 154 | Train Loss: 1.184 Vali Loss: 1.725 Vali Acc: 0.483 Test Loss: 1.725 Test Acc: 0.483
Validation loss decreased (-0.462268 --> -0.483357).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0034877
	speed: 0.2003s/iter; left time: 2910.9136s
Epoch: 6 cost time: 8.24613881111145
Epoch: 6, Steps: 154 | Train Loss: 1.115 Vali Loss: 1.866 Vali Acc: 0.479 Test Loss: 1.866 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0354631
	speed: 0.2062s/iter; left time: 2965.2484s
Epoch: 7 cost time: 7.636215448379517
Epoch: 7, Steps: 154 | Train Loss: 1.070 Vali Loss: 1.893 Vali Acc: 0.467 Test Loss: 1.893 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1635839
	speed: 0.1918s/iter; left time: 2728.3241s
Epoch: 8 cost time: 7.678829669952393
Epoch: 8, Steps: 154 | Train Loss: 1.019 Vali Loss: 1.676 Vali Acc: 0.512 Test Loss: 1.676 Test Acc: 0.512
Validation loss decreased (-0.483357 --> -0.511743).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8801476
	speed: 0.1906s/iter; left time: 2682.1430s
Epoch: 9 cost time: 7.334088563919067
Epoch: 9, Steps: 154 | Train Loss: 0.991 Vali Loss: 1.810 Vali Acc: 0.483 Test Loss: 1.810 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3793521
	speed: 0.1914s/iter; left time: 2663.2382s
Epoch: 10 cost time: 6.7087414264678955
Epoch: 10, Steps: 154 | Train Loss: 0.942 Vali Loss: 1.711 Vali Acc: 0.526 Test Loss: 1.711 Test Acc: 0.526
Validation loss decreased (-0.511743 --> -0.525530).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7651182
	speed: 0.1919s/iter; left time: 2640.5534s
Epoch: 11 cost time: 8.237152576446533
Epoch: 11, Steps: 154 | Train Loss: 0.905 Vali Loss: 1.989 Vali Acc: 0.484 Test Loss: 1.989 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0055498
	speed: 0.2095s/iter; left time: 2850.0865s
Epoch: 12 cost time: 8.509441375732422
Epoch: 12, Steps: 154 | Train Loss: 0.878 Vali Loss: 1.739 Vali Acc: 0.521 Test Loss: 1.739 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1239254
	speed: 0.2065s/iter; left time: 2777.8975s
Epoch: 13 cost time: 8.096718788146973
Epoch: 13, Steps: 154 | Train Loss: 0.857 Vali Loss: 1.982 Vali Acc: 0.500 Test Loss: 1.982 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8556786
	speed: 0.1900s/iter; left time: 2526.6545s
Epoch: 14 cost time: 7.109127521514893
Epoch: 14, Steps: 154 | Train Loss: 0.805 Vali Loss: 1.945 Vali Acc: 0.490 Test Loss: 1.945 Test Acc: 0.490
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.6905727
	speed: 0.2018s/iter; left time: 2652.5845s
Epoch: 15 cost time: 9.599630355834961
Epoch: 15, Steps: 154 | Train Loss: 0.798 Vali Loss: 1.824 Vali Acc: 0.512 Test Loss: 1.824 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.3509579
	speed: 0.2322s/iter; left time: 3016.6146s
Epoch: 16 cost time: 8.965672731399536
Epoch: 16, Steps: 154 | Train Loss: 0.780 Vali Loss: 1.784 Vali Acc: 0.487 Test Loss: 1.784 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.5541910
	speed: 0.2306s/iter; left time: 2960.6435s
Epoch: 17 cost time: 9.572366714477539
Epoch: 17, Steps: 154 | Train Loss: 0.766 Vali Loss: 1.885 Vali Acc: 0.494 Test Loss: 1.885 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.7772372
	speed: 0.2296s/iter; left time: 2912.1616s
Epoch: 18 cost time: 9.347237348556519
Epoch: 18, Steps: 154 | Train Loss: 0.730 Vali Loss: 1.941 Vali Acc: 0.509 Test Loss: 1.941 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.7652139
	speed: 0.2338s/iter; left time: 2929.3507s
Epoch: 19 cost time: 9.868973731994629
Epoch: 19, Steps: 154 | Train Loss: 0.705 Vali Loss: 1.919 Vali Acc: 0.497 Test Loss: 1.919 Test Acc: 0.497
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.8903282
	speed: 0.2326s/iter; left time: 2878.1644s
Epoch: 20 cost time: 9.552469730377197
Epoch: 20, Steps: 154 | Train Loss: 0.681 Vali Loss: 1.947 Vali Acc: 0.484 Test Loss: 1.947 Test Acc: 0.484
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5255474452554745
model parameter : 27054
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8006310
	speed: 0.0803s/iter; left time: 1228.1059s
Epoch: 1 cost time: 11.367577314376831
Epoch: 1, Steps: 154 | Train Loss: 2.282 Vali Loss: 2.035 Vali Acc: 0.336 Test Loss: 2.035 Test Acc: 0.336
Validation loss decreased (inf --> -0.335746).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7038310
	speed: 0.2372s/iter; left time: 3592.3912s
Epoch: 2 cost time: 9.569576263427734
Epoch: 2, Steps: 154 | Train Loss: 1.795 Vali Loss: 1.827 Vali Acc: 0.429 Test Loss: 1.827 Test Acc: 0.429
Validation loss decreased (-0.335746 --> -0.428611).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2092350
	speed: 0.2268s/iter; left time: 3399.8835s
Epoch: 3 cost time: 9.20471715927124
Epoch: 3, Steps: 154 | Train Loss: 1.439 Vali Loss: 1.786 Vali Acc: 0.466 Test Loss: 1.786 Test Acc: 0.466
Validation loss decreased (-0.428611 --> -0.465919).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1892701
	speed: 0.2576s/iter; left time: 3822.4802s
Epoch: 4 cost time: 11.271202802658081
Epoch: 4, Steps: 154 | Train Loss: 1.288 Vali Loss: 1.879 Vali Acc: 0.453 Test Loss: 1.879 Test Acc: 0.453
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2494701
	speed: 0.2590s/iter; left time: 3802.9229s
Epoch: 5 cost time: 10.713200330734253
Epoch: 5, Steps: 154 | Train Loss: 1.216 Vali Loss: 1.872 Vali Acc: 0.461 Test Loss: 1.872 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8471258
	speed: 0.2693s/iter; left time: 3913.1074s
Epoch: 6 cost time: 11.584277629852295
Epoch: 6, Steps: 154 | Train Loss: 1.160 Vali Loss: 1.722 Vali Acc: 0.497 Test Loss: 1.722 Test Acc: 0.497
Validation loss decreased (-0.465919 --> -0.497144).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9110165
	speed: 0.2396s/iter; left time: 3444.8257s
Epoch: 7 cost time: 9.54700756072998
Epoch: 7, Steps: 154 | Train Loss: 1.118 Vali Loss: 1.812 Vali Acc: 0.460 Test Loss: 1.812 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9062315
	speed: 0.2382s/iter; left time: 3387.4682s
Epoch: 8 cost time: 10.220773935317993
Epoch: 8, Steps: 154 | Train Loss: 1.089 Vali Loss: 1.754 Vali Acc: 0.485 Test Loss: 1.754 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6143131
	speed: 0.2227s/iter; left time: 3132.6522s
Epoch: 9 cost time: 8.643117904663086
Epoch: 9, Steps: 154 | Train Loss: 1.064 Vali Loss: 1.940 Vali Acc: 0.483 Test Loss: 1.940 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8123543
	speed: 0.2282s/iter; left time: 3174.8840s
Epoch: 10 cost time: 9.59670901298523
Epoch: 10, Steps: 154 | Train Loss: 1.027 Vali Loss: 1.816 Vali Acc: 0.481 Test Loss: 1.816 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.2838972
	speed: 0.2303s/iter; left time: 3168.8570s
Epoch: 11 cost time: 9.244625329971313
Epoch: 11, Steps: 154 | Train Loss: 0.982 Vali Loss: 1.811 Vali Acc: 0.469 Test Loss: 1.811 Test Acc: 0.469
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3073548
	speed: 0.2136s/iter; left time: 2906.5003s
Epoch: 12 cost time: 8.085177421569824
Epoch: 12, Steps: 154 | Train Loss: 0.959 Vali Loss: 2.044 Vali Acc: 0.472 Test Loss: 2.044 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.9036881
	speed: 0.1871s/iter; left time: 2517.5358s
Epoch: 13 cost time: 7.181457042694092
Epoch: 13, Steps: 154 | Train Loss: 0.962 Vali Loss: 1.787 Vali Acc: 0.500 Test Loss: 1.787 Test Acc: 0.500
Validation loss decreased (-0.497144 --> -0.500388).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0535350
	speed: 0.1976s/iter; left time: 2627.7244s
Epoch: 14 cost time: 8.429509401321411
Epoch: 14, Steps: 154 | Train Loss: 0.918 Vali Loss: 1.745 Vali Acc: 0.512 Test Loss: 1.745 Test Acc: 0.512
Validation loss decreased (-0.500388 --> -0.512148).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7478089
	speed: 0.2167s/iter; left time: 2848.8465s
Epoch: 15 cost time: 8.496115684509277
Epoch: 15, Steps: 154 | Train Loss: 0.874 Vali Loss: 1.781 Vali Acc: 0.514 Test Loss: 1.781 Test Acc: 0.514
Validation loss decreased (-0.512148 --> -0.513770).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3178079
	speed: 0.2062s/iter; left time: 2679.3071s
Epoch: 16 cost time: 7.961421966552734
Epoch: 16, Steps: 154 | Train Loss: 0.859 Vali Loss: 2.051 Vali Acc: 0.496 Test Loss: 2.051 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.3217610
	speed: 0.2121s/iter; left time: 2722.4341s
Epoch: 17 cost time: 8.2447190284729
Epoch: 17, Steps: 154 | Train Loss: 0.836 Vali Loss: 1.797 Vali Acc: 0.492 Test Loss: 1.797 Test Acc: 0.492
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8123721
	speed: 0.2102s/iter; left time: 2666.5848s
Epoch: 18 cost time: 8.379729747772217
Epoch: 18, Steps: 154 | Train Loss: 0.827 Vali Loss: 1.744 Vali Acc: 0.521 Test Loss: 1.744 Test Acc: 0.521
Validation loss decreased (-0.513770 --> -0.521475).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.7060953
	speed: 0.2088s/iter; left time: 2615.8701s
Epoch: 19 cost time: 8.191791534423828
Epoch: 19, Steps: 154 | Train Loss: 0.795 Vali Loss: 2.008 Vali Acc: 0.482 Test Loss: 2.008 Test Acc: 0.482
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.0829877
	speed: 0.2103s/iter; left time: 2602.0515s
Epoch: 20 cost time: 8.515336990356445
Epoch: 20, Steps: 154 | Train Loss: 0.777 Vali Loss: 2.053 Vali Acc: 0.469 Test Loss: 2.053 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2391768
	speed: 0.2092s/iter; left time: 2556.5867s
Epoch: 21 cost time: 8.108051776885986
Epoch: 21, Steps: 154 | Train Loss: 0.745 Vali Loss: 2.042 Vali Acc: 0.499 Test Loss: 2.042 Test Acc: 0.499
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8309441
	speed: 0.1904s/iter; left time: 2297.7597s
Epoch: 22 cost time: 6.862055063247681
Epoch: 22, Steps: 154 | Train Loss: 0.740 Vali Loss: 1.850 Vali Acc: 0.494 Test Loss: 1.850 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.2921854
	speed: 0.1778s/iter; left time: 2118.7010s
Epoch: 23 cost time: 6.758112192153931
Epoch: 23, Steps: 154 | Train Loss: 0.717 Vali Loss: 1.989 Vali Acc: 0.487 Test Loss: 1.989 Test Acc: 0.487
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.3988251
	speed: 0.2032s/iter; left time: 2388.8890s
Epoch: 24 cost time: 8.124884605407715
Epoch: 24, Steps: 154 | Train Loss: 0.680 Vali Loss: 1.994 Vali Acc: 0.491 Test Loss: 1.994 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.7385134
	speed: 0.2116s/iter; left time: 2455.5125s
Epoch: 25 cost time: 8.599869012832642
Epoch: 25, Steps: 154 | Train Loss: 0.678 Vali Loss: 1.911 Vali Acc: 0.519 Test Loss: 1.911 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.8318682
	speed: 0.2255s/iter; left time: 2582.7003s
Epoch: 26 cost time: 8.737416744232178
Epoch: 26, Steps: 154 | Train Loss: 0.676 Vali Loss: 1.876 Vali Acc: 0.520 Test Loss: 1.876 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.3742067
	speed: 0.2007s/iter; left time: 2267.5456s
Epoch: 27 cost time: 7.340823411941528
Epoch: 27, Steps: 154 | Train Loss: 0.643 Vali Loss: 1.949 Vali Acc: 0.493 Test Loss: 1.949 Test Acc: 0.493
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.5194373
	speed: 0.1981s/iter; left time: 2207.1437s
Epoch: 28 cost time: 8.567707538604736
Epoch: 28, Steps: 154 | Train Loss: 0.650 Vali Loss: 2.135 Vali Acc: 0.492 Test Loss: 2.135 Test Acc: 0.492
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5214922952149229
model parameter : 23054
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4011762
	speed: 0.0620s/iter; left time: 948.6326s
Epoch: 1 cost time: 8.776129722595215
Epoch: 1, Steps: 154 | Train Loss: 2.389 Vali Loss: 2.100 Vali Acc: 0.326 Test Loss: 2.100 Test Acc: 0.326
Validation loss decreased (inf --> -0.326013).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4583284
	speed: 0.1959s/iter; left time: 2967.4567s
Epoch: 2 cost time: 7.965564489364624
Epoch: 2, Steps: 154 | Train Loss: 1.976 Vali Loss: 1.847 Vali Acc: 0.406 Test Loss: 1.847 Test Acc: 0.406
Validation loss decreased (-0.326013 --> -0.405497).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6630437
	speed: 0.1956s/iter; left time: 2933.1372s
Epoch: 3 cost time: 7.449865341186523
Epoch: 3, Steps: 154 | Train Loss: 1.648 Vali Loss: 1.705 Vali Acc: 0.421 Test Loss: 1.705 Test Acc: 0.421
Validation loss decreased (-0.405497 --> -0.421313).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8154247
	speed: 0.1804s/iter; left time: 2676.9644s
Epoch: 4 cost time: 7.178945302963257
Epoch: 4, Steps: 154 | Train Loss: 1.402 Vali Loss: 1.741 Vali Acc: 0.462 Test Loss: 1.741 Test Acc: 0.462
Validation loss decreased (-0.421313 --> -0.461864).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2150958
	speed: 0.2005s/iter; left time: 2944.6165s
Epoch: 5 cost time: 7.548743486404419
Epoch: 5, Steps: 154 | Train Loss: 1.291 Vali Loss: 1.723 Vali Acc: 0.463 Test Loss: 1.723 Test Acc: 0.463
Validation loss decreased (-0.461864 --> -0.463081).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6574047
	speed: 0.1697s/iter; left time: 2465.4356s
Epoch: 6 cost time: 6.349273443222046
Epoch: 6, Steps: 154 | Train Loss: 1.228 Vali Loss: 1.833 Vali Acc: 0.466 Test Loss: 1.833 Test Acc: 0.466
Validation loss decreased (-0.463081 --> -0.465918).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2250109
	speed: 0.1820s/iter; left time: 2616.0029s
Epoch: 7 cost time: 7.659751892089844
Epoch: 7, Steps: 154 | Train Loss: 1.184 Vali Loss: 1.963 Vali Acc: 0.455 Test Loss: 1.963 Test Acc: 0.455
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8413845
	speed: 0.1957s/iter; left time: 2784.1127s
Epoch: 8 cost time: 7.342963457107544
Epoch: 8, Steps: 154 | Train Loss: 1.129 Vali Loss: 1.728 Vali Acc: 0.497 Test Loss: 1.728 Test Acc: 0.497
Validation loss decreased (-0.465918 --> -0.496739).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0563085
	speed: 0.1952s/iter; left time: 2746.0263s
Epoch: 9 cost time: 7.723677158355713
Epoch: 9, Steps: 154 | Train Loss: 1.102 Vali Loss: 1.906 Vali Acc: 0.469 Test Loss: 1.906 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2800137
	speed: 0.1994s/iter; left time: 2775.0417s
Epoch: 10 cost time: 8.056102991104126
Epoch: 10, Steps: 154 | Train Loss: 1.069 Vali Loss: 1.824 Vali Acc: 0.494 Test Loss: 1.824 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6293626
	speed: 0.1985s/iter; left time: 2731.3164s
Epoch: 11 cost time: 8.094421625137329
Epoch: 11, Steps: 154 | Train Loss: 1.022 Vali Loss: 1.805 Vali Acc: 0.472 Test Loss: 1.805 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.9862745
	speed: 0.1930s/iter; left time: 2626.6585s
Epoch: 12 cost time: 6.494018077850342
Epoch: 12, Steps: 154 | Train Loss: 1.004 Vali Loss: 1.902 Vali Acc: 0.492 Test Loss: 1.902 Test Acc: 0.492
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.5938936
	speed: 0.1722s/iter; left time: 2316.6239s
Epoch: 13 cost time: 6.760455846786499
Epoch: 13, Steps: 154 | Train Loss: 0.993 Vali Loss: 1.695 Vali Acc: 0.508 Test Loss: 1.695 Test Acc: 0.508
Validation loss decreased (-0.496739 --> -0.507688).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1780684
	speed: 0.1837s/iter; left time: 2442.6690s
Epoch: 14 cost time: 7.0259270668029785
Epoch: 14, Steps: 154 | Train Loss: 0.953 Vali Loss: 1.858 Vali Acc: 0.476 Test Loss: 1.858 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3079330
	speed: 0.1971s/iter; left time: 2590.9622s
Epoch: 15 cost time: 7.956755876541138
Epoch: 15, Steps: 154 | Train Loss: 0.921 Vali Loss: 1.729 Vali Acc: 0.522 Test Loss: 1.729 Test Acc: 0.522
Validation loss decreased (-0.507688 --> -0.521881).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6139028
	speed: 0.1997s/iter; left time: 2594.3703s
Epoch: 16 cost time: 8.070780754089355
Epoch: 16, Steps: 154 | Train Loss: 0.908 Vali Loss: 1.834 Vali Acc: 0.505 Test Loss: 1.834 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1567862
	speed: 0.2064s/iter; left time: 2649.7828s
Epoch: 17 cost time: 7.81746768951416
Epoch: 17, Steps: 154 | Train Loss: 0.898 Vali Loss: 1.703 Vali Acc: 0.508 Test Loss: 1.703 Test Acc: 0.508
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5272045
	speed: 0.1981s/iter; left time: 2512.8339s
Epoch: 18 cost time: 7.964414834976196
Epoch: 18, Steps: 154 | Train Loss: 0.866 Vali Loss: 1.809 Vali Acc: 0.495 Test Loss: 1.809 Test Acc: 0.495
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.8493132
	speed: 0.1890s/iter; left time: 2368.5571s
Epoch: 19 cost time: 7.5871665477752686
Epoch: 19, Steps: 154 | Train Loss: 0.877 Vali Loss: 1.879 Vali Acc: 0.504 Test Loss: 1.879 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8392189
	speed: 0.1998s/iter; left time: 2472.8979s
Epoch: 20 cost time: 7.636000871658325
Epoch: 20, Steps: 154 | Train Loss: 0.820 Vali Loss: 1.947 Vali Acc: 0.492 Test Loss: 1.947 Test Acc: 0.492
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.4476981
	speed: 0.1971s/iter; left time: 2408.7217s
Epoch: 21 cost time: 7.431352853775024
Epoch: 21, Steps: 154 | Train Loss: 0.812 Vali Loss: 1.763 Vali Acc: 0.511 Test Loss: 1.763 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.8816467
	speed: 0.1816s/iter; left time: 2191.9291s
Epoch: 22 cost time: 6.638285398483276
Epoch: 22, Steps: 154 | Train Loss: 0.777 Vali Loss: 1.952 Vali Acc: 0.494 Test Loss: 1.952 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.8007717
	speed: 0.1924s/iter; left time: 2291.5315s
Epoch: 23 cost time: 7.207913875579834
Epoch: 23, Steps: 154 | Train Loss: 0.759 Vali Loss: 1.738 Vali Acc: 0.509 Test Loss: 1.738 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.6754277
	speed: 0.1919s/iter; left time: 2256.9017s
Epoch: 24 cost time: 7.2502477169036865
Epoch: 24, Steps: 154 | Train Loss: 0.762 Vali Loss: 1.904 Vali Acc: 0.498 Test Loss: 1.904 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.5752118
	speed: 0.1891s/iter; left time: 2194.8344s
Epoch: 25 cost time: 6.762861251831055
Epoch: 25, Steps: 154 | Train Loss: 0.725 Vali Loss: 1.919 Vali Acc: 0.499 Test Loss: 1.919 Test Acc: 0.499
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5218978102189781
model parameter : 20382
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7907516
	speed: 0.0660s/iter; left time: 1010.5466s
Epoch: 1 cost time: 9.756707906723022
Epoch: 1, Steps: 154 | Train Loss: 2.189 Vali Loss: 1.901 Vali Acc: 0.364 Test Loss: 1.901 Test Acc: 0.364
Validation loss decreased (inf --> -0.364133).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1721352
	speed: 0.2172s/iter; left time: 3290.2554s
Epoch: 2 cost time: 8.442409753799438
Epoch: 2, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.003 Vali Acc: 0.419 Test Loss: 2.003 Test Acc: 0.419
Validation loss decreased (-0.364133 --> -0.418877).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7986184
	speed: 0.2139s/iter; left time: 3206.8021s
Epoch: 3 cost time: 9.07351803779602
Epoch: 3, Steps: 154 | Train Loss: 1.284 Vali Loss: 1.799 Vali Acc: 0.476 Test Loss: 1.799 Test Acc: 0.476
Validation loss decreased (-0.418877 --> -0.475651).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4155483
	speed: 0.2090s/iter; left time: 3101.0511s
Epoch: 4 cost time: 7.335983753204346
Epoch: 4, Steps: 154 | Train Loss: 1.136 Vali Loss: 1.914 Vali Acc: 0.473 Test Loss: 1.914 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0827811
	speed: 0.2012s/iter; left time: 2954.4659s
Epoch: 5 cost time: 8.656846761703491
Epoch: 5, Steps: 154 | Train Loss: 1.025 Vali Loss: 1.881 Vali Acc: 0.480 Test Loss: 1.881 Test Acc: 0.480
Validation loss decreased (-0.475651 --> -0.480111).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9433595
	speed: 0.1938s/iter; left time: 2816.4601s
Epoch: 6 cost time: 7.9195473194122314
Epoch: 6, Steps: 154 | Train Loss: 0.967 Vali Loss: 1.748 Vali Acc: 0.493 Test Loss: 1.748 Test Acc: 0.493
Validation loss decreased (-0.480111 --> -0.492683).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9512900
	speed: 0.2125s/iter; left time: 3055.6448s
Epoch: 7 cost time: 8.552639484405518
Epoch: 7, Steps: 154 | Train Loss: 0.919 Vali Loss: 1.846 Vali Acc: 0.521 Test Loss: 1.846 Test Acc: 0.521
Validation loss decreased (-0.492683 --> -0.520663).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5509540
	speed: 0.2114s/iter; left time: 3006.2132s
Epoch: 8 cost time: 8.939199686050415
Epoch: 8, Steps: 154 | Train Loss: 0.838 Vali Loss: 1.836 Vali Acc: 0.478 Test Loss: 1.836 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0909266
	speed: 0.1888s/iter; left time: 2655.8086s
Epoch: 9 cost time: 6.283836126327515
Epoch: 9, Steps: 154 | Train Loss: 0.789 Vali Loss: 1.949 Vali Acc: 0.473 Test Loss: 1.949 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7441283
	speed: 0.1837s/iter; left time: 2556.4124s
Epoch: 10 cost time: 8.677997589111328
Epoch: 10, Steps: 154 | Train Loss: 0.745 Vali Loss: 1.909 Vali Acc: 0.519 Test Loss: 1.909 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8991040
	speed: 0.2063s/iter; left time: 2838.6202s
Epoch: 11 cost time: 8.363786220550537
Epoch: 11, Steps: 154 | Train Loss: 0.696 Vali Loss: 1.912 Vali Acc: 0.507 Test Loss: 1.912 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.8066070
	speed: 0.2059s/iter; left time: 2802.2364s
Epoch: 12 cost time: 7.717553377151489
Epoch: 12, Steps: 154 | Train Loss: 0.666 Vali Loss: 2.114 Vali Acc: 0.498 Test Loss: 2.114 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.4546770
	speed: 0.2026s/iter; left time: 2725.8861s
Epoch: 13 cost time: 8.175888538360596
Epoch: 13, Steps: 154 | Train Loss: 0.627 Vali Loss: 2.194 Vali Acc: 0.502 Test Loss: 2.194 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7180064
	speed: 0.2034s/iter; left time: 2704.4688s
Epoch: 14 cost time: 8.198310375213623
Epoch: 14, Steps: 154 | Train Loss: 0.585 Vali Loss: 2.066 Vali Acc: 0.523 Test Loss: 2.066 Test Acc: 0.523
Validation loss decreased (-0.520663 --> -0.522688).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5534202
	speed: 0.1799s/iter; left time: 2365.1656s
Epoch: 15 cost time: 6.445389270782471
Epoch: 15, Steps: 154 | Train Loss: 0.560 Vali Loss: 2.391 Vali Acc: 0.485 Test Loss: 2.391 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2454399
	speed: 0.1875s/iter; left time: 2435.2336s
Epoch: 16 cost time: 8.070492267608643
Epoch: 16, Steps: 154 | Train Loss: 0.515 Vali Loss: 2.490 Vali Acc: 0.448 Test Loss: 2.490 Test Acc: 0.448
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.4709720
	speed: 0.1973s/iter; left time: 2532.6469s
Epoch: 17 cost time: 8.08578896522522
Epoch: 17, Steps: 154 | Train Loss: 0.511 Vali Loss: 2.421 Vali Acc: 0.486 Test Loss: 2.421 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.5765989
	speed: 0.1964s/iter; left time: 2490.4415s
Epoch: 18 cost time: 7.283461809158325
Epoch: 18, Steps: 154 | Train Loss: 0.473 Vali Loss: 2.416 Vali Acc: 0.506 Test Loss: 2.416 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.5730020
	speed: 0.2105s/iter; left time: 2637.0008s
Epoch: 19 cost time: 8.538435220718384
Epoch: 19, Steps: 154 | Train Loss: 0.430 Vali Loss: 2.578 Vali Acc: 0.487 Test Loss: 2.578 Test Acc: 0.487
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.1871805
	speed: 0.2133s/iter; left time: 2639.8914s
Epoch: 20 cost time: 8.480339050292969
Epoch: 20, Steps: 154 | Train Loss: 0.411 Vali Loss: 2.522 Vali Acc: 0.485 Test Loss: 2.522 Test Acc: 0.485
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.1127788
	speed: 0.1925s/iter; left time: 2353.0353s
Epoch: 21 cost time: 7.478911876678467
Epoch: 21, Steps: 154 | Train Loss: 0.406 Vali Loss: 2.671 Vali Acc: 0.428 Test Loss: 2.671 Test Acc: 0.428
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.5867083
	speed: 0.1963s/iter; left time: 2368.5585s
Epoch: 22 cost time: 8.004878520965576
Epoch: 22, Steps: 154 | Train Loss: 0.389 Vali Loss: 2.564 Vali Acc: 0.489 Test Loss: 2.564 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2122751
	speed: 0.1865s/iter; left time: 2221.4408s
Epoch: 23 cost time: 7.260676622390747
Epoch: 23, Steps: 154 | Train Loss: 0.376 Vali Loss: 2.827 Vali Acc: 0.468 Test Loss: 2.827 Test Acc: 0.468
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1524329
	speed: 0.1939s/iter; left time: 2279.7915s
Epoch: 24 cost time: 7.545230150222778
Epoch: 24, Steps: 154 | Train Loss: 0.362 Vali Loss: 2.681 Vali Acc: 0.483 Test Loss: 2.681 Test Acc: 0.483
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5227088402270884
model parameter : 55022
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2873988
	speed: 0.0588s/iter; left time: 899.7175s
Epoch: 1 cost time: 8.097491264343262
Epoch: 1, Steps: 154 | Train Loss: 2.187 Vali Loss: 1.887 Vali Acc: 0.390 Test Loss: 1.887 Test Acc: 0.390
Validation loss decreased (inf --> -0.390087).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7704631
	speed: 0.1764s/iter; left time: 2671.7348s
Epoch: 2 cost time: 7.19941520690918
Epoch: 2, Steps: 154 | Train Loss: 1.652 Vali Loss: 1.805 Vali Acc: 0.429 Test Loss: 1.805 Test Acc: 0.429
Validation loss decreased (-0.390087 --> -0.429422).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7995185
	speed: 0.1755s/iter; left time: 2631.4092s
Epoch: 3 cost time: 6.390457391738892
Epoch: 3, Steps: 154 | Train Loss: 1.340 Vali Loss: 1.807 Vali Acc: 0.463 Test Loss: 1.807 Test Acc: 0.463
Validation loss decreased (-0.429422 --> -0.463080).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3413352
	speed: 0.1856s/iter; left time: 2753.5664s
Epoch: 4 cost time: 8.114037275314331
Epoch: 4, Steps: 154 | Train Loss: 1.212 Vali Loss: 1.739 Vali Acc: 0.464 Test Loss: 1.739 Test Acc: 0.464
Validation loss decreased (-0.463080 --> -0.464297).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7250613
	speed: 0.2039s/iter; left time: 2994.8371s
Epoch: 5 cost time: 7.824035167694092
Epoch: 5, Steps: 154 | Train Loss: 1.115 Vali Loss: 1.726 Vali Acc: 0.475 Test Loss: 1.726 Test Acc: 0.475
Validation loss decreased (-0.464297 --> -0.474841).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6965003
	speed: 0.1832s/iter; left time: 2661.5560s
Epoch: 6 cost time: 6.527048110961914
Epoch: 6, Steps: 154 | Train Loss: 1.075 Vali Loss: 1.695 Vali Acc: 0.497 Test Loss: 1.695 Test Acc: 0.497
Validation loss decreased (-0.474841 --> -0.497144).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0203424
	speed: 0.1789s/iter; left time: 2572.4771s
Epoch: 7 cost time: 7.238321781158447
Epoch: 7, Steps: 154 | Train Loss: 0.995 Vali Loss: 1.663 Vali Acc: 0.505 Test Loss: 1.663 Test Acc: 0.505
Validation loss decreased (-0.497144 --> -0.505255).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8843631
	speed: 0.1874s/iter; left time: 2665.4342s
Epoch: 8 cost time: 7.3274476528167725
Epoch: 8, Steps: 154 | Train Loss: 0.945 Vali Loss: 1.668 Vali Acc: 0.521 Test Loss: 1.668 Test Acc: 0.521
Validation loss decreased (-0.505255 --> -0.520665).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8764951
	speed: 0.1830s/iter; left time: 2575.0539s
Epoch: 9 cost time: 6.509264707565308
Epoch: 9, Steps: 154 | Train Loss: 0.941 Vali Loss: 1.733 Vali Acc: 0.491 Test Loss: 1.733 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6288623
	speed: 0.1784s/iter; left time: 2482.1720s
Epoch: 10 cost time: 6.97742223739624
Epoch: 10, Steps: 154 | Train Loss: 0.868 Vali Loss: 1.659 Vali Acc: 0.539 Test Loss: 1.659 Test Acc: 0.539
Validation loss decreased (-0.520665 --> -0.538507).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.4053158
	speed: 0.1726s/iter; left time: 2375.2282s
Epoch: 11 cost time: 6.435765266418457
Epoch: 11, Steps: 154 | Train Loss: 0.878 Vali Loss: 1.635 Vali Acc: 0.545 Test Loss: 1.635 Test Acc: 0.545
Validation loss decreased (-0.538507 --> -0.544996).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4318188
	speed: 0.1778s/iter; left time: 2418.9428s
Epoch: 12 cost time: 6.738974332809448
Epoch: 12, Steps: 154 | Train Loss: 0.820 Vali Loss: 1.775 Vali Acc: 0.506 Test Loss: 1.775 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.7189854
	speed: 0.1899s/iter; left time: 2554.5200s
Epoch: 13 cost time: 7.210500717163086
Epoch: 13, Steps: 154 | Train Loss: 0.804 Vali Loss: 1.864 Vali Acc: 0.479 Test Loss: 1.864 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6044781
	speed: 0.1857s/iter; left time: 2469.0344s
Epoch: 14 cost time: 7.0858001708984375
Epoch: 14, Steps: 154 | Train Loss: 0.759 Vali Loss: 1.740 Vali Acc: 0.538 Test Loss: 1.740 Test Acc: 0.538
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9686155
	speed: 0.1838s/iter; left time: 2416.5415s
Epoch: 15 cost time: 7.1167871952056885
Epoch: 15, Steps: 154 | Train Loss: 0.737 Vali Loss: 1.740 Vali Acc: 0.502 Test Loss: 1.740 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3608250
	speed: 0.1810s/iter; left time: 2351.1822s
Epoch: 16 cost time: 6.871675968170166
Epoch: 16, Steps: 154 | Train Loss: 0.725 Vali Loss: 1.866 Vali Acc: 0.490 Test Loss: 1.866 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3056296
	speed: 0.1876s/iter; left time: 2408.5494s
Epoch: 17 cost time: 6.822591304779053
Epoch: 17, Steps: 154 | Train Loss: 0.707 Vali Loss: 1.922 Vali Acc: 0.463 Test Loss: 1.922 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.2206171
	speed: 0.1953s/iter; left time: 2477.3768s
Epoch: 18 cost time: 8.803950071334839
Epoch: 18, Steps: 154 | Train Loss: 0.658 Vali Loss: 1.890 Vali Acc: 0.487 Test Loss: 1.890 Test Acc: 0.487
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.3975530
	speed: 0.2163s/iter; left time: 2710.3348s
Epoch: 19 cost time: 8.335022211074829
Epoch: 19, Steps: 154 | Train Loss: 0.627 Vali Loss: 1.854 Vali Acc: 0.506 Test Loss: 1.854 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.4115190
	speed: 0.2249s/iter; left time: 2782.5682s
Epoch: 20 cost time: 8.384194374084473
Epoch: 20, Steps: 154 | Train Loss: 0.601 Vali Loss: 1.989 Vali Acc: 0.442 Test Loss: 1.989 Test Acc: 0.442
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.9700571
	speed: 0.2102s/iter; left time: 2568.6311s
Epoch: 21 cost time: 8.604778289794922
Epoch: 21, Steps: 154 | Train Loss: 0.595 Vali Loss: 1.960 Vali Acc: 0.461 Test Loss: 1.960 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5450121654501217
model parameter : 30846
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7143257
	speed: 0.0695s/iter; left time: 1063.5033s
Epoch: 1 cost time: 9.828750848770142
Epoch: 1, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.003 Vali Acc: 0.369 Test Loss: 2.003 Test Acc: 0.369
Validation loss decreased (inf --> -0.369404).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1490755
	speed: 0.2129s/iter; left time: 3224.9865s
Epoch: 2 cost time: 8.342551946640015
Epoch: 2, Steps: 154 | Train Loss: 1.710 Vali Loss: 1.759 Vali Acc: 0.435 Test Loss: 1.759 Test Acc: 0.435
Validation loss decreased (-0.369404 --> -0.434694).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3233442
	speed: 0.1984s/iter; left time: 2973.9293s
Epoch: 3 cost time: 6.375750541687012
Epoch: 3, Steps: 154 | Train Loss: 1.395 Vali Loss: 1.912 Vali Acc: 0.451 Test Loss: 1.912 Test Acc: 0.451
Validation loss decreased (-0.434694 --> -0.450914).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9858268
	speed: 0.1755s/iter; left time: 2603.5832s
Epoch: 4 cost time: 6.284173250198364
Epoch: 4, Steps: 154 | Train Loss: 1.267 Vali Loss: 1.910 Vali Acc: 0.472 Test Loss: 1.910 Test Acc: 0.472
Validation loss decreased (-0.450914 --> -0.471595).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0793606
	speed: 0.1930s/iter; left time: 2834.6970s
Epoch: 5 cost time: 7.748090982437134
Epoch: 5, Steps: 154 | Train Loss: 1.149 Vali Loss: 1.804 Vali Acc: 0.500 Test Loss: 1.804 Test Acc: 0.500
Validation loss decreased (-0.471595 --> -0.499982).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7839517
	speed: 0.1861s/iter; left time: 2704.4337s
Epoch: 6 cost time: 6.261669397354126
Epoch: 6, Steps: 154 | Train Loss: 1.079 Vali Loss: 1.699 Vali Acc: 0.508 Test Loss: 1.699 Test Acc: 0.508
Validation loss decreased (-0.499982 --> -0.508093).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2400916
	speed: 0.1906s/iter; left time: 2740.9708s
Epoch: 7 cost time: 7.54434871673584
Epoch: 7, Steps: 154 | Train Loss: 1.025 Vali Loss: 1.718 Vali Acc: 0.494 Test Loss: 1.718 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9533336
	speed: 0.1891s/iter; left time: 2689.3984s
Epoch: 8 cost time: 6.865719556808472
Epoch: 8, Steps: 154 | Train Loss: 0.964 Vali Loss: 1.787 Vali Acc: 0.517 Test Loss: 1.787 Test Acc: 0.517
Validation loss decreased (-0.508093 --> -0.517419).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7328676
	speed: 0.1783s/iter; left time: 2508.1762s
Epoch: 9 cost time: 6.568522691726685
Epoch: 9, Steps: 154 | Train Loss: 0.944 Vali Loss: 1.804 Vali Acc: 0.512 Test Loss: 1.804 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2141354
	speed: 0.1839s/iter; left time: 2558.8443s
Epoch: 10 cost time: 6.540454387664795
Epoch: 10, Steps: 154 | Train Loss: 0.889 Vali Loss: 2.023 Vali Acc: 0.494 Test Loss: 2.023 Test Acc: 0.494
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.6508292
	speed: 0.1830s/iter; left time: 2517.7215s
Epoch: 11 cost time: 7.176573991775513
Epoch: 11, Steps: 154 | Train Loss: 0.860 Vali Loss: 1.840 Vali Acc: 0.506 Test Loss: 1.840 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8067849
	speed: 0.1878s/iter; left time: 2554.7838s
Epoch: 12 cost time: 7.016506671905518
Epoch: 12, Steps: 154 | Train Loss: 0.823 Vali Loss: 1.829 Vali Acc: 0.524 Test Loss: 1.829 Test Acc: 0.524
Validation loss decreased (-0.517419 --> -0.523907).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7952102
	speed: 0.1796s/iter; left time: 2416.0105s
Epoch: 13 cost time: 6.628738164901733
Epoch: 13, Steps: 154 | Train Loss: 0.782 Vali Loss: 1.898 Vali Acc: 0.500 Test Loss: 1.898 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5949429
	speed: 0.1641s/iter; left time: 2182.7095s
Epoch: 14 cost time: 6.751368522644043
Epoch: 14, Steps: 154 | Train Loss: 0.754 Vali Loss: 1.817 Vali Acc: 0.534 Test Loss: 1.817 Test Acc: 0.534
Validation loss decreased (-0.523907 --> -0.533640).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3568868
	speed: 0.2014s/iter; left time: 2647.1239s
Epoch: 15 cost time: 7.8951475620269775
Epoch: 15, Steps: 154 | Train Loss: 0.726 Vali Loss: 1.939 Vali Acc: 0.477 Test Loss: 1.939 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.9829811
	speed: 0.1960s/iter; left time: 2546.2721s
Epoch: 16 cost time: 7.687047004699707
Epoch: 16, Steps: 154 | Train Loss: 0.690 Vali Loss: 1.916 Vali Acc: 0.516 Test Loss: 1.916 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.6302571
	speed: 0.1973s/iter; left time: 2533.2028s
Epoch: 17 cost time: 7.1179563999176025
Epoch: 17, Steps: 154 | Train Loss: 0.673 Vali Loss: 2.044 Vali Acc: 0.517 Test Loss: 2.044 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.4277643
	speed: 0.1858s/iter; left time: 2356.5600s
Epoch: 18 cost time: 7.424526214599609
Epoch: 18, Steps: 154 | Train Loss: 0.638 Vali Loss: 2.008 Vali Acc: 0.499 Test Loss: 2.008 Test Acc: 0.499
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6492965
	speed: 0.2063s/iter; left time: 2584.3736s
Epoch: 19 cost time: 7.557110786437988
Epoch: 19, Steps: 154 | Train Loss: 0.632 Vali Loss: 2.114 Vali Acc: 0.499 Test Loss: 2.114 Test Acc: 0.499
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.9298737
	speed: 0.1886s/iter; left time: 2333.4540s
Epoch: 20 cost time: 6.661121368408203
Epoch: 20, Steps: 154 | Train Loss: 0.593 Vali Loss: 2.090 Vali Acc: 0.503 Test Loss: 2.090 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9477867
	speed: 0.1881s/iter; left time: 2299.0542s
Epoch: 21 cost time: 6.6925835609436035
Epoch: 21, Steps: 154 | Train Loss: 0.569 Vali Loss: 2.000 Vali Acc: 0.514 Test Loss: 2.000 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.7703592
	speed: 0.1930s/iter; left time: 2328.8970s
Epoch: 22 cost time: 7.4848551750183105
Epoch: 22, Steps: 154 | Train Loss: 0.565 Vali Loss: 2.049 Vali Acc: 0.522 Test Loss: 2.049 Test Acc: 0.522
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.3466636
	speed: 0.2082s/iter; left time: 2480.1931s
Epoch: 23 cost time: 7.403392791748047
Epoch: 23, Steps: 154 | Train Loss: 0.541 Vali Loss: 2.193 Vali Acc: 0.519 Test Loss: 2.193 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.4087245
	speed: 0.2009s/iter; left time: 2362.6559s
Epoch: 24 cost time: 7.683516025543213
Epoch: 24, Steps: 154 | Train Loss: 0.531 Vali Loss: 2.180 Vali Acc: 0.523 Test Loss: 2.180 Test Acc: 0.523
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5336577453365775
model parameter : 30862
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4199629
	speed: 0.0612s/iter; left time: 936.2944s
Epoch: 1 cost time: 8.280840873718262
Epoch: 1, Steps: 154 | Train Loss: 2.334 Vali Loss: 2.116 Vali Acc: 0.316 Test Loss: 2.116 Test Acc: 0.316
Validation loss decreased (inf --> -0.316281).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4275231
	speed: 0.1831s/iter; left time: 2773.9747s
Epoch: 2 cost time: 6.329484701156616
Epoch: 2, Steps: 154 | Train Loss: 1.910 Vali Loss: 1.831 Vali Acc: 0.406 Test Loss: 1.831 Test Acc: 0.406
Validation loss decreased (-0.316281 --> -0.406308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5957850
	speed: 0.2024s/iter; left time: 3034.0705s
Epoch: 3 cost time: 7.356681823730469
Epoch: 3, Steps: 154 | Train Loss: 1.463 Vali Loss: 1.789 Vali Acc: 0.441 Test Loss: 1.789 Test Acc: 0.441
Validation loss decreased (-0.406308 --> -0.440777).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0518798
	speed: 0.1991s/iter; left time: 2955.1005s
Epoch: 4 cost time: 6.842140197753906
Epoch: 4, Steps: 154 | Train Loss: 1.282 Vali Loss: 1.858 Vali Acc: 0.459 Test Loss: 1.858 Test Acc: 0.459
Validation loss decreased (-0.440777 --> -0.459430).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4090511
	speed: 0.2032s/iter; left time: 2984.0368s
Epoch: 5 cost time: 7.0012030601501465
Epoch: 5, Steps: 154 | Train Loss: 1.205 Vali Loss: 1.794 Vali Acc: 0.473 Test Loss: 1.794 Test Acc: 0.473
Validation loss decreased (-0.459430 --> -0.472813).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7315307
	speed: 0.1955s/iter; left time: 2841.1007s
Epoch: 6 cost time: 6.706921100616455
Epoch: 6, Steps: 154 | Train Loss: 1.156 Vali Loss: 1.793 Vali Acc: 0.485 Test Loss: 1.793 Test Acc: 0.485
Validation loss decreased (-0.472813 --> -0.484978).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2073411
	speed: 0.1854s/iter; left time: 2664.9168s
Epoch: 7 cost time: 6.530487537384033
Epoch: 7, Steps: 154 | Train Loss: 1.099 Vali Loss: 1.785 Vali Acc: 0.492 Test Loss: 1.785 Test Acc: 0.492
Validation loss decreased (-0.484978 --> -0.491872).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2131333
	speed: 0.1855s/iter; left time: 2638.6354s
Epoch: 8 cost time: 6.6050920486450195
Epoch: 8, Steps: 154 | Train Loss: 1.048 Vali Loss: 1.830 Vali Acc: 0.498 Test Loss: 1.830 Test Acc: 0.498
Validation loss decreased (-0.491872 --> -0.498360).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1691333
	speed: 0.2017s/iter; left time: 2837.9994s
Epoch: 9 cost time: 7.234478235244751
Epoch: 9, Steps: 154 | Train Loss: 1.002 Vali Loss: 1.690 Vali Acc: 0.508 Test Loss: 1.690 Test Acc: 0.508
Validation loss decreased (-0.498360 --> -0.508093).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4374992
	speed: 0.1929s/iter; left time: 2684.0444s
Epoch: 10 cost time: 7.2198169231414795
Epoch: 10, Steps: 154 | Train Loss: 0.983 Vali Loss: 1.818 Vali Acc: 0.494 Test Loss: 1.818 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8172960
	speed: 0.2009s/iter; left time: 2764.7903s
Epoch: 11 cost time: 6.7587034702301025
Epoch: 11, Steps: 154 | Train Loss: 0.947 Vali Loss: 1.718 Vali Acc: 0.534 Test Loss: 1.718 Test Acc: 0.534
Validation loss decreased (-0.508093 --> -0.534046).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8668395
	speed: 0.1957s/iter; left time: 2662.3141s
Epoch: 12 cost time: 7.101683616638184
Epoch: 12, Steps: 154 | Train Loss: 0.901 Vali Loss: 1.709 Vali Acc: 0.532 Test Loss: 1.709 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3741689
	speed: 0.1972s/iter; left time: 2653.2333s
Epoch: 13 cost time: 6.317439556121826
Epoch: 13, Steps: 154 | Train Loss: 0.880 Vali Loss: 1.662 Vali Acc: 0.520 Test Loss: 1.662 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1370782
	speed: 0.1780s/iter; left time: 2367.7281s
Epoch: 14 cost time: 6.396446466445923
Epoch: 14, Steps: 154 | Train Loss: 0.884 Vali Loss: 1.663 Vali Acc: 0.538 Test Loss: 1.663 Test Acc: 0.538
Validation loss decreased (-0.534046 --> -0.537696).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.7934631
	speed: 0.1941s/iter; left time: 2551.4455s
Epoch: 15 cost time: 6.6779913902282715
Epoch: 15, Steps: 154 | Train Loss: 0.861 Vali Loss: 1.751 Vali Acc: 0.535 Test Loss: 1.751 Test Acc: 0.535
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5227980
	speed: 0.1931s/iter; left time: 2508.1582s
Epoch: 16 cost time: 6.040767431259155
Epoch: 16, Steps: 154 | Train Loss: 0.808 Vali Loss: 1.730 Vali Acc: 0.534 Test Loss: 1.730 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9288009
	speed: 0.1846s/iter; left time: 2369.2904s
Epoch: 17 cost time: 6.2040770053863525
Epoch: 17, Steps: 154 | Train Loss: 0.798 Vali Loss: 1.744 Vali Acc: 0.551 Test Loss: 1.744 Test Acc: 0.551
Validation loss decreased (-0.537696 --> -0.550672).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1456560
	speed: 0.1896s/iter; left time: 2404.1661s
Epoch: 18 cost time: 6.561413288116455
Epoch: 18, Steps: 154 | Train Loss: 0.763 Vali Loss: 1.827 Vali Acc: 0.513 Test Loss: 1.827 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.4460055
	speed: 0.2040s/iter; left time: 2556.1730s
Epoch: 19 cost time: 6.475236415863037
Epoch: 19, Steps: 154 | Train Loss: 0.756 Vali Loss: 1.846 Vali Acc: 0.534 Test Loss: 1.846 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.8388770
	speed: 0.1815s/iter; left time: 2246.6557s
Epoch: 20 cost time: 6.01303768157959
Epoch: 20, Steps: 154 | Train Loss: 0.726 Vali Loss: 1.794 Vali Acc: 0.532 Test Loss: 1.794 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.0145252
	speed: 0.1875s/iter; left time: 2291.7492s
Epoch: 21 cost time: 5.930097818374634
Epoch: 21, Steps: 154 | Train Loss: 0.699 Vali Loss: 1.940 Vali Acc: 0.504 Test Loss: 1.940 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.5949835
	speed: 0.1972s/iter; left time: 2379.7720s
Epoch: 22 cost time: 6.860698938369751
Epoch: 22, Steps: 154 | Train Loss: 0.704 Vali Loss: 1.804 Vali Acc: 0.538 Test Loss: 1.804 Test Acc: 0.538
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.7505894
	speed: 0.2009s/iter; left time: 2393.4089s
Epoch: 23 cost time: 6.713003158569336
Epoch: 23, Steps: 154 | Train Loss: 0.653 Vali Loss: 1.995 Vali Acc: 0.487 Test Loss: 1.995 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.6979972
	speed: 0.2039s/iter; left time: 2398.2451s
Epoch: 24 cost time: 6.5483996868133545
Epoch: 24, Steps: 154 | Train Loss: 0.648 Vali Loss: 2.028 Vali Acc: 0.530 Test Loss: 2.028 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.4599495
	speed: 0.2063s/iter; left time: 2394.0463s
Epoch: 25 cost time: 6.280555486679077
Epoch: 25, Steps: 154 | Train Loss: 0.651 Vali Loss: 1.951 Vali Acc: 0.545 Test Loss: 1.951 Test Acc: 0.545
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.2673424
	speed: 0.2195s/iter; left time: 2513.9115s
Epoch: 26 cost time: 8.04168438911438
Epoch: 26, Steps: 154 | Train Loss: 0.632 Vali Loss: 1.997 Vali Acc: 0.520 Test Loss: 1.997 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.6592893
	speed: 0.2387s/iter; left time: 2697.0857s
Epoch: 27 cost time: 8.288197755813599
Epoch: 27, Steps: 154 | Train Loss: 0.616 Vali Loss: 2.273 Vali Acc: 0.524 Test Loss: 2.273 Test Acc: 0.524
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5506893755068938
model parameter : 22830
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1737502
	speed: 0.0736s/iter; left time: 1126.0175s
Epoch: 1 cost time: 9.79557180404663
Epoch: 1, Steps: 154 | Train Loss: 2.291 Vali Loss: 2.047 Vali Acc: 0.330 Test Loss: 2.047 Test Acc: 0.330
Validation loss decreased (inf --> -0.329663).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7718008
	speed: 0.2374s/iter; left time: 3596.2231s
Epoch: 2 cost time: 8.222360134124756
Epoch: 2, Steps: 154 | Train Loss: 1.894 Vali Loss: 1.755 Vali Acc: 0.411 Test Loss: 1.755 Test Acc: 0.411
Validation loss decreased (-0.329663 --> -0.411175).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4696840
	speed: 0.2202s/iter; left time: 3301.4281s
Epoch: 3 cost time: 6.902911424636841
Epoch: 3, Steps: 154 | Train Loss: 1.503 Vali Loss: 1.727 Vali Acc: 0.442 Test Loss: 1.727 Test Acc: 0.442
Validation loss decreased (-0.411175 --> -0.442400).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1746570
	speed: 0.2194s/iter; left time: 3255.0447s
Epoch: 4 cost time: 7.012922286987305
Epoch: 4, Steps: 154 | Train Loss: 1.329 Vali Loss: 1.711 Vali Acc: 0.445 Test Loss: 1.711 Test Acc: 0.445
Validation loss decreased (-0.442400 --> -0.444833).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4068406
	speed: 0.2038s/iter; left time: 2992.6659s
Epoch: 5 cost time: 7.152756452560425
Epoch: 5, Steps: 154 | Train Loss: 1.233 Vali Loss: 1.708 Vali Acc: 0.474 Test Loss: 1.708 Test Acc: 0.474
Validation loss decreased (-0.444833 --> -0.474030).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3329151
	speed: 0.2053s/iter; left time: 2983.2050s
Epoch: 6 cost time: 6.097485303878784
Epoch: 6, Steps: 154 | Train Loss: 1.172 Vali Loss: 1.828 Vali Acc: 0.479 Test Loss: 1.828 Test Acc: 0.479
Validation loss decreased (-0.474030 --> -0.478895).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3581340
	speed: 0.1918s/iter; left time: 2758.0254s
Epoch: 7 cost time: 6.435887336730957
Epoch: 7, Steps: 154 | Train Loss: 1.150 Vali Loss: 1.728 Vali Acc: 0.475 Test Loss: 1.728 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9997731
	speed: 0.2270s/iter; left time: 3229.0362s
Epoch: 8 cost time: 7.398183107376099
Epoch: 8, Steps: 154 | Train Loss: 1.098 Vali Loss: 1.682 Vali Acc: 0.490 Test Loss: 1.682 Test Acc: 0.490
Validation loss decreased (-0.478895 --> -0.490251).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7233269
	speed: 0.2244s/iter; left time: 3157.5850s
Epoch: 9 cost time: 7.571491718292236
Epoch: 9, Steps: 154 | Train Loss: 1.065 Vali Loss: 1.722 Vali Acc: 0.514 Test Loss: 1.722 Test Acc: 0.514
Validation loss decreased (-0.490251 --> -0.513770).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2004201
	speed: 0.2265s/iter; left time: 3152.2609s
Epoch: 10 cost time: 8.150348424911499
Epoch: 10, Steps: 154 | Train Loss: 1.041 Vali Loss: 1.892 Vali Acc: 0.492 Test Loss: 1.892 Test Acc: 0.492
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2601368
	speed: 0.2275s/iter; left time: 3131.1100s
Epoch: 11 cost time: 7.470534801483154
Epoch: 11, Steps: 154 | Train Loss: 1.033 Vali Loss: 1.892 Vali Acc: 0.485 Test Loss: 1.892 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8087540
	speed: 0.2333s/iter; left time: 3173.9977s
Epoch: 12 cost time: 7.405251741409302
Epoch: 12, Steps: 154 | Train Loss: 0.980 Vali Loss: 1.990 Vali Acc: 0.475 Test Loss: 1.990 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.8605015
	speed: 0.2463s/iter; left time: 3313.7480s
Epoch: 13 cost time: 8.08246397972107
Epoch: 13, Steps: 154 | Train Loss: 0.955 Vali Loss: 1.717 Vali Acc: 0.510 Test Loss: 1.717 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.9704481
	speed: 0.2142s/iter; left time: 2848.2734s
Epoch: 14 cost time: 7.7267656326293945
Epoch: 14, Steps: 154 | Train Loss: 0.932 Vali Loss: 1.789 Vali Acc: 0.504 Test Loss: 1.789 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8058282
	speed: 0.2209s/iter; left time: 2903.6948s
Epoch: 15 cost time: 6.7682929039001465
Epoch: 15, Steps: 154 | Train Loss: 0.917 Vali Loss: 1.833 Vali Acc: 0.506 Test Loss: 1.833 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.0454839
	speed: 0.2127s/iter; left time: 2763.3392s
Epoch: 16 cost time: 8.0152587890625
Epoch: 16, Steps: 154 | Train Loss: 0.892 Vali Loss: 1.901 Vali Acc: 0.499 Test Loss: 1.901 Test Acc: 0.499
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.7441716
	speed: 0.2287s/iter; left time: 2936.0252s
Epoch: 17 cost time: 7.3042755126953125
Epoch: 17, Steps: 154 | Train Loss: 0.859 Vali Loss: 1.973 Vali Acc: 0.489 Test Loss: 1.973 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.8349536
	speed: 0.2254s/iter; left time: 2858.2291s
Epoch: 18 cost time: 7.729865550994873
Epoch: 18, Steps: 154 | Train Loss: 0.855 Vali Loss: 1.765 Vali Acc: 0.521 Test Loss: 1.765 Test Acc: 0.521
Validation loss decreased (-0.513770 --> -0.521069).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.7518815
	speed: 0.2308s/iter; left time: 2891.6948s
Epoch: 19 cost time: 7.829007863998413
Epoch: 19, Steps: 154 | Train Loss: 0.823 Vali Loss: 1.842 Vali Acc: 0.500 Test Loss: 1.842 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8690556
	speed: 0.2195s/iter; left time: 2716.2302s
Epoch: 20 cost time: 7.10805344581604
Epoch: 20, Steps: 154 | Train Loss: 0.818 Vali Loss: 2.035 Vali Acc: 0.515 Test Loss: 2.035 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.5028431
	speed: 0.2249s/iter; left time: 2748.2787s
Epoch: 21 cost time: 6.938908100128174
Epoch: 21, Steps: 154 | Train Loss: 0.792 Vali Loss: 1.786 Vali Acc: 0.525 Test Loss: 1.786 Test Acc: 0.525
Validation loss decreased (-0.521069 --> -0.525124).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.5981834
	speed: 0.2327s/iter; left time: 2807.5488s
Epoch: 22 cost time: 9.045439004898071
Epoch: 22, Steps: 154 | Train Loss: 0.777 Vali Loss: 1.783 Vali Acc: 0.528 Test Loss: 1.783 Test Acc: 0.528
Validation loss decreased (-0.525124 --> -0.528368).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.4358904
	speed: 0.2501s/iter; left time: 2979.8402s
Epoch: 23 cost time: 8.110524415969849
Epoch: 23, Steps: 154 | Train Loss: 0.741 Vali Loss: 1.881 Vali Acc: 0.503 Test Loss: 1.881 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.6926252
	speed: 0.2496s/iter; left time: 2934.7929s
Epoch: 24 cost time: 8.668709516525269
Epoch: 24, Steps: 154 | Train Loss: 0.723 Vali Loss: 1.898 Vali Acc: 0.505 Test Loss: 1.898 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.5977023
	speed: 0.2312s/iter; left time: 2682.6778s
Epoch: 25 cost time: 7.191263914108276
Epoch: 25, Steps: 154 | Train Loss: 0.706 Vali Loss: 1.921 Vali Acc: 0.521 Test Loss: 1.921 Test Acc: 0.521
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.0245548
	speed: 0.2265s/iter; left time: 2593.1450s
Epoch: 26 cost time: 7.904627323150635
Epoch: 26, Steps: 154 | Train Loss: 0.693 Vali Loss: 1.847 Vali Acc: 0.534 Test Loss: 1.847 Test Acc: 0.534
Validation loss decreased (-0.528368 --> -0.534045).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.7200403
	speed: 0.2448s/iter; left time: 2765.4451s
Epoch: 27 cost time: 7.977029800415039
Epoch: 27, Steps: 154 | Train Loss: 0.694 Vali Loss: 1.911 Vali Acc: 0.545 Test Loss: 1.911 Test Acc: 0.545
Validation loss decreased (-0.534045 --> -0.545399).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.8130503
	speed: 0.2385s/iter; left time: 2657.4087s
Epoch: 28 cost time: 8.215714931488037
Epoch: 28, Steps: 154 | Train Loss: 0.692 Vali Loss: 1.948 Vali Acc: 0.527 Test Loss: 1.948 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.8756781
	speed: 0.2360s/iter; left time: 2593.6218s
Epoch: 29 cost time: 7.6206278800964355
Epoch: 29, Steps: 154 | Train Loss: 0.670 Vali Loss: 1.902 Vali Acc: 0.513 Test Loss: 1.902 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.5735968
	speed: 0.2341s/iter; left time: 2536.1951s
Epoch: 30 cost time: 7.910672903060913
Epoch: 30, Steps: 154 | Train Loss: 0.658 Vali Loss: 1.896 Vali Acc: 0.503 Test Loss: 1.896 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.7985139
	speed: 0.2412s/iter; left time: 2575.9451s
Epoch: 31 cost time: 7.38004732131958
Epoch: 31, Steps: 154 | Train Loss: 0.625 Vali Loss: 1.990 Vali Acc: 0.485 Test Loss: 1.990 Test Acc: 0.485
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.9073153
	speed: 0.2150s/iter; left time: 2263.2103s
Epoch: 32 cost time: 7.609881639480591
Epoch: 32, Steps: 154 | Train Loss: 0.619 Vali Loss: 1.869 Vali Acc: 0.543 Test Loss: 1.869 Test Acc: 0.543
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.5275990
	speed: 0.2491s/iter; left time: 2583.4386s
Epoch: 33 cost time: 8.076478719711304
Epoch: 33, Steps: 154 | Train Loss: 0.624 Vali Loss: 1.934 Vali Acc: 0.520 Test Loss: 1.934 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.5894199
	speed: 0.2446s/iter; left time: 2499.4392s
Epoch: 34 cost time: 8.293610572814941
Epoch: 34, Steps: 154 | Train Loss: 0.611 Vali Loss: 1.956 Vali Acc: 0.509 Test Loss: 1.956 Test Acc: 0.509
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.4363331
	speed: 0.2456s/iter; left time: 2471.5085s
Epoch: 35 cost time: 7.042889356613159
Epoch: 35, Steps: 154 | Train Loss: 0.592 Vali Loss: 1.943 Vali Acc: 0.538 Test Loss: 1.943 Test Acc: 0.538
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.2406912
	speed: 0.2376s/iter; left time: 2354.3881s
Epoch: 36 cost time: 8.420206308364868
Epoch: 36, Steps: 154 | Train Loss: 0.572 Vali Loss: 2.126 Vali Acc: 0.512 Test Loss: 2.126 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.4933962
	speed: 0.2267s/iter; left time: 2211.8099s
Epoch: 37 cost time: 7.504537105560303
Epoch: 37, Steps: 154 | Train Loss: 0.571 Vali Loss: 2.247 Vali Acc: 0.500 Test Loss: 2.247 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5454176804541768
model parameter : 18830
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0913050
	speed: 0.0694s/iter; left time: 1061.3171s
Epoch: 1 cost time: 9.490983724594116
Epoch: 1, Steps: 154 | Train Loss: 2.381 Vali Loss: 2.131 Vali Acc: 0.313 Test Loss: 2.131 Test Acc: 0.313
Validation loss decreased (inf --> -0.313442).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8605471
	speed: 0.2172s/iter; left time: 3289.5868s
Epoch: 2 cost time: 6.411034107208252
Epoch: 2, Steps: 154 | Train Loss: 2.061 Vali Loss: 1.910 Vali Acc: 0.379 Test Loss: 1.910 Test Acc: 0.379
Validation loss decreased (-0.313442 --> -0.379137).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7922533
	speed: 0.2094s/iter; left time: 3140.0717s
Epoch: 3 cost time: 7.285753011703491
Epoch: 3, Steps: 154 | Train Loss: 1.716 Vali Loss: 1.747 Vali Acc: 0.419 Test Loss: 1.747 Test Acc: 0.419
Validation loss decreased (-0.379137 --> -0.419285).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1890303
	speed: 0.2010s/iter; left time: 2983.0098s
Epoch: 4 cost time: 6.617755651473999
Epoch: 4, Steps: 154 | Train Loss: 1.433 Vali Loss: 1.746 Vali Acc: 0.452 Test Loss: 1.746 Test Acc: 0.452
Validation loss decreased (-0.419285 --> -0.451726).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4791297
	speed: 0.2131s/iter; left time: 3129.7721s
Epoch: 5 cost time: 7.727319240570068
Epoch: 5, Steps: 154 | Train Loss: 1.303 Vali Loss: 1.603 Vali Acc: 0.493 Test Loss: 1.603 Test Acc: 0.493
Validation loss decreased (-0.451726 --> -0.493090).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0758188
	speed: 0.2096s/iter; left time: 3045.9759s
Epoch: 6 cost time: 6.8364574909210205
Epoch: 6, Steps: 154 | Train Loss: 1.233 Vali Loss: 1.730 Vali Acc: 0.474 Test Loss: 1.730 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5412488
	speed: 0.2258s/iter; left time: 3246.7802s
Epoch: 7 cost time: 7.519046306610107
Epoch: 7, Steps: 154 | Train Loss: 1.175 Vali Loss: 1.782 Vali Acc: 0.479 Test Loss: 1.782 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8419715
	speed: 0.2193s/iter; left time: 3119.6598s
Epoch: 8 cost time: 6.7700865268707275
Epoch: 8, Steps: 154 | Train Loss: 1.145 Vali Loss: 1.653 Vali Acc: 0.502 Test Loss: 1.653 Test Acc: 0.502
Validation loss decreased (-0.493090 --> -0.502417).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2477809
	speed: 0.2165s/iter; left time: 3046.5269s
Epoch: 9 cost time: 7.404966831207275
Epoch: 9, Steps: 154 | Train Loss: 1.100 Vali Loss: 1.888 Vali Acc: 0.480 Test Loss: 1.888 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.6264010
	speed: 0.2124s/iter; left time: 2955.9056s
Epoch: 10 cost time: 7.163236379623413
Epoch: 10, Steps: 154 | Train Loss: 1.066 Vali Loss: 1.898 Vali Acc: 0.481 Test Loss: 1.898 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1747738
	speed: 0.2234s/iter; left time: 3074.4292s
Epoch: 11 cost time: 7.272880792617798
Epoch: 11, Steps: 154 | Train Loss: 1.032 Vali Loss: 1.851 Vali Acc: 0.479 Test Loss: 1.851 Test Acc: 0.479
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3383325
	speed: 0.2154s/iter; left time: 2930.8845s
Epoch: 12 cost time: 6.892333745956421
Epoch: 12, Steps: 154 | Train Loss: 1.014 Vali Loss: 1.706 Vali Acc: 0.513 Test Loss: 1.706 Test Acc: 0.513
Validation loss decreased (-0.502417 --> -0.512554).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3213341
	speed: 0.2164s/iter; left time: 2910.6830s
Epoch: 13 cost time: 7.907514810562134
Epoch: 13, Steps: 154 | Train Loss: 0.982 Vali Loss: 1.769 Vali Acc: 0.491 Test Loss: 1.769 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.5920073
	speed: 0.2173s/iter; left time: 2890.5363s
Epoch: 14 cost time: 7.472734451293945
Epoch: 14, Steps: 154 | Train Loss: 0.986 Vali Loss: 1.811 Vali Acc: 0.498 Test Loss: 1.811 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3218027
	speed: 0.2385s/iter; left time: 3135.4919s
Epoch: 15 cost time: 8.492820978164673
Epoch: 15, Steps: 154 | Train Loss: 0.941 Vali Loss: 1.736 Vali Acc: 0.512 Test Loss: 1.736 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9392075
	speed: 0.2476s/iter; left time: 3216.2857s
Epoch: 16 cost time: 8.6273672580719
Epoch: 16, Steps: 154 | Train Loss: 0.906 Vali Loss: 2.049 Vali Acc: 0.483 Test Loss: 2.049 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0715190
	speed: 0.2596s/iter; left time: 3332.0740s
Epoch: 17 cost time: 9.097221851348877
Epoch: 17, Steps: 154 | Train Loss: 0.903 Vali Loss: 1.751 Vali Acc: 0.509 Test Loss: 1.751 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.0140061
	speed: 0.2582s/iter; left time: 3275.0867s
Epoch: 18 cost time: 9.274912118911743
Epoch: 18, Steps: 154 | Train Loss: 0.861 Vali Loss: 1.804 Vali Acc: 0.513 Test Loss: 1.804 Test Acc: 0.513
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.8082275
	speed: 0.2703s/iter; left time: 3386.7185s
Epoch: 19 cost time: 9.473631381988525
Epoch: 19, Steps: 154 | Train Loss: 0.857 Vali Loss: 1.766 Vali Acc: 0.509 Test Loss: 1.766 Test Acc: 0.509
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.5904414
	speed: 0.2468s/iter; left time: 3053.9072s
Epoch: 20 cost time: 8.526923418045044
Epoch: 20, Steps: 154 | Train Loss: 0.848 Vali Loss: 1.765 Vali Acc: 0.506 Test Loss: 1.765 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.3075882
	speed: 0.2381s/iter; left time: 2909.6844s
Epoch: 21 cost time: 8.046129703521729
Epoch: 21, Steps: 154 | Train Loss: 0.825 Vali Loss: 2.190 Vali Acc: 0.487 Test Loss: 2.190 Test Acc: 0.487
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.3053977
	speed: 0.2200s/iter; left time: 2655.2170s
Epoch: 22 cost time: 7.260787487030029
Epoch: 22, Steps: 154 | Train Loss: 0.796 Vali Loss: 1.806 Vali Acc: 0.507 Test Loss: 1.806 Test Acc: 0.507
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el2_dm16_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5125709651257097
model parameter : 16158
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2953227
	speed: 0.0776s/iter; left time: 1187.5874s
Epoch: 1 cost time: 11.198016881942749
Epoch: 1, Steps: 154 | Train Loss: 2.113 Vali Loss: 2.150 Vali Acc: 0.410 Test Loss: 2.150 Test Acc: 0.410
Validation loss decreased (inf --> -0.409954).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0904386
	speed: 0.2622s/iter; left time: 3971.0852s
Epoch: 2 cost time: 9.286009311676025
Epoch: 2, Steps: 154 | Train Loss: 1.838 Vali Loss: 2.657 Vali Acc: 0.451 Test Loss: 2.657 Test Acc: 0.451
Validation loss decreased (-0.409954 --> -0.450906).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8846595
	speed: 0.2581s/iter; left time: 3869.1586s
Epoch: 3 cost time: 8.741130590438843
Epoch: 3, Steps: 154 | Train Loss: 1.625 Vali Loss: 3.971 Vali Acc: 0.389 Test Loss: 3.971 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1294022
	speed: 0.2792s/iter; left time: 4143.5133s
Epoch: 4 cost time: 9.38052487373352
Epoch: 4, Steps: 154 | Train Loss: 1.671 Vali Loss: 3.352 Vali Acc: 0.358 Test Loss: 3.352 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2045559
	speed: 0.2519s/iter; left time: 3699.6659s
Epoch: 5 cost time: 8.120007038116455
Epoch: 5, Steps: 154 | Train Loss: 1.429 Vali Loss: 4.212 Vali Acc: 0.443 Test Loss: 4.212 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.5433067
	speed: 0.2391s/iter; left time: 3474.4462s
Epoch: 6 cost time: 8.216893196105957
Epoch: 6, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.368 Vali Acc: 0.461 Test Loss: 3.368 Test Acc: 0.461
Validation loss decreased (-0.450906 --> -0.460631).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4560692
	speed: 0.2167s/iter; left time: 3115.9070s
Epoch: 7 cost time: 7.517444610595703
Epoch: 7, Steps: 154 | Train Loss: 1.261 Vali Loss: 3.924 Vali Acc: 0.393 Test Loss: 3.924 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7005181
	speed: 0.2403s/iter; left time: 3418.2242s
Epoch: 8 cost time: 8.506311893463135
Epoch: 8, Steps: 154 | Train Loss: 1.184 Vali Loss: 4.621 Vali Acc: 0.380 Test Loss: 4.621 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4335825
	speed: 0.2573s/iter; left time: 3620.2186s
Epoch: 9 cost time: 8.401656866073608
Epoch: 9, Steps: 154 | Train Loss: 1.038 Vali Loss: 3.905 Vali Acc: 0.527 Test Loss: 3.905 Test Acc: 0.527
Validation loss decreased (-0.460631 --> -0.527130).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3304477
	speed: 0.2495s/iter; left time: 3471.5807s
Epoch: 10 cost time: 8.700923442840576
Epoch: 10, Steps: 154 | Train Loss: 1.003 Vali Loss: 4.922 Vali Acc: 0.463 Test Loss: 4.922 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.5144732
	speed: 0.2496s/iter; left time: 3434.3533s
Epoch: 11 cost time: 7.971855640411377
Epoch: 11, Steps: 154 | Train Loss: 0.907 Vali Loss: 5.167 Vali Acc: 0.470 Test Loss: 5.167 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4410077
	speed: 0.2407s/iter; left time: 3275.5413s
Epoch: 12 cost time: 9.272095918655396
Epoch: 12, Steps: 154 | Train Loss: 0.816 Vali Loss: 4.823 Vali Acc: 0.503 Test Loss: 4.823 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4343025
	speed: 0.2362s/iter; left time: 3177.0410s
Epoch: 13 cost time: 7.146317481994629
Epoch: 13, Steps: 154 | Train Loss: 0.711 Vali Loss: 4.830 Vali Acc: 0.487 Test Loss: 4.830 Test Acc: 0.487
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3643808
	speed: 0.2425s/iter; left time: 3225.3316s
Epoch: 14 cost time: 8.519657135009766
Epoch: 14, Steps: 154 | Train Loss: 0.723 Vali Loss: 5.655 Vali Acc: 0.460 Test Loss: 5.655 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.9638324
	speed: 0.2529s/iter; left time: 3323.9951s
Epoch: 15 cost time: 9.764867544174194
Epoch: 15, Steps: 154 | Train Loss: 0.646 Vali Loss: 4.604 Vali Acc: 0.496 Test Loss: 4.604 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.9172639
	speed: 0.2788s/iter; left time: 3621.8076s
Epoch: 16 cost time: 9.713064908981323
Epoch: 16, Steps: 154 | Train Loss: 0.585 Vali Loss: 5.452 Vali Acc: 0.464 Test Loss: 5.452 Test Acc: 0.464
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.6039557
	speed: 0.2592s/iter; left time: 3327.2379s
Epoch: 17 cost time: 8.547811031341553
Epoch: 17, Steps: 154 | Train Loss: 0.556 Vali Loss: 4.602 Vali Acc: 0.479 Test Loss: 4.602 Test Acc: 0.479
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.3052438
	speed: 0.2489s/iter; left time: 3156.2951s
Epoch: 18 cost time: 8.0739004611969
Epoch: 18, Steps: 154 | Train Loss: 0.493 Vali Loss: 5.533 Vali Acc: 0.505 Test Loss: 5.533 Test Acc: 0.505
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1779456
	speed: 0.2479s/iter; left time: 3106.3782s
Epoch: 19 cost time: 8.869694948196411
Epoch: 19, Steps: 154 | Train Loss: 0.472 Vali Loss: 6.707 Vali Acc: 0.429 Test Loss: 6.707 Test Acc: 0.429
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.527169505271695
model parameter : 520078
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0354652
	speed: 0.0855s/iter; left time: 1307.6390s
Epoch: 1 cost time: 11.551900386810303
Epoch: 1, Steps: 154 | Train Loss: 1.997 Vali Loss: 1.768 Vali Acc: 0.465 Test Loss: 1.768 Test Acc: 0.465
Validation loss decreased (inf --> -0.464703).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7548040
	speed: 0.2390s/iter; left time: 3620.1250s
Epoch: 2 cost time: 6.9141716957092285
Epoch: 2, Steps: 154 | Train Loss: 1.508 Vali Loss: 1.949 Vali Acc: 0.478 Test Loss: 1.949 Test Acc: 0.478
Validation loss decreased (-0.464703 --> -0.478083).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0707762
	speed: 0.2153s/iter; left time: 3228.6661s
Epoch: 3 cost time: 8.34518837928772
Epoch: 3, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.242 Vali Acc: 0.431 Test Loss: 2.242 Test Acc: 0.431
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3450031
	speed: 0.2380s/iter; left time: 3531.0076s
Epoch: 4 cost time: 6.893152952194214
Epoch: 4, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.438 Vali Acc: 0.485 Test Loss: 2.438 Test Acc: 0.485
Validation loss decreased (-0.478083 --> -0.485377).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0186007
	speed: 0.2267s/iter; left time: 3329.5179s
Epoch: 5 cost time: 8.719619035720825
Epoch: 5, Steps: 154 | Train Loss: 1.263 Vali Loss: 2.408 Vali Acc: 0.474 Test Loss: 2.408 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1544013
	speed: 0.2487s/iter; left time: 3614.0199s
Epoch: 6 cost time: 8.176021099090576
Epoch: 6, Steps: 154 | Train Loss: 1.147 Vali Loss: 2.845 Vali Acc: 0.517 Test Loss: 2.845 Test Acc: 0.517
Validation loss decreased (-0.485377 --> -0.517409).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1210165
	speed: 0.2319s/iter; left time: 3333.8514s
Epoch: 7 cost time: 9.39876651763916
Epoch: 7, Steps: 154 | Train Loss: 1.097 Vali Loss: 2.731 Vali Acc: 0.499 Test Loss: 2.731 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4584738
	speed: 0.2354s/iter; left time: 3348.1839s
Epoch: 8 cost time: 7.653196096420288
Epoch: 8, Steps: 154 | Train Loss: 0.983 Vali Loss: 3.329 Vali Acc: 0.488 Test Loss: 3.329 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5133874
	speed: 0.2321s/iter; left time: 3265.6012s
Epoch: 9 cost time: 8.36469030380249
Epoch: 9, Steps: 154 | Train Loss: 0.876 Vali Loss: 3.403 Vali Acc: 0.527 Test Loss: 3.403 Test Acc: 0.527
Validation loss decreased (-0.517409 --> -0.527135).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5341929
	speed: 0.2597s/iter; left time: 3613.1309s
Epoch: 10 cost time: 8.00092625617981
Epoch: 10, Steps: 154 | Train Loss: 0.834 Vali Loss: 3.380 Vali Acc: 0.477 Test Loss: 3.380 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9539868
	speed: 0.2433s/iter; left time: 3348.2280s
Epoch: 11 cost time: 8.92627501487732
Epoch: 11, Steps: 154 | Train Loss: 0.760 Vali Loss: 3.677 Vali Acc: 0.444 Test Loss: 3.677 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4008818
	speed: 0.2500s/iter; left time: 3401.3598s
Epoch: 12 cost time: 7.082021713256836
Epoch: 12, Steps: 154 | Train Loss: 0.720 Vali Loss: 3.447 Vali Acc: 0.524 Test Loss: 3.447 Test Acc: 0.524
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2861809
	speed: 0.2472s/iter; left time: 3325.8204s
Epoch: 13 cost time: 8.731263160705566
Epoch: 13, Steps: 154 | Train Loss: 0.627 Vali Loss: 3.656 Vali Acc: 0.493 Test Loss: 3.656 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8248755
	speed: 0.2519s/iter; left time: 3350.4625s
Epoch: 14 cost time: 8.027518510818481
Epoch: 14, Steps: 154 | Train Loss: 0.606 Vali Loss: 3.922 Vali Acc: 0.461 Test Loss: 3.922 Test Acc: 0.461
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.2728052
	speed: 0.2470s/iter; left time: 3246.1888s
Epoch: 15 cost time: 8.514597177505493
Epoch: 15, Steps: 154 | Train Loss: 0.525 Vali Loss: 3.790 Vali Acc: 0.476 Test Loss: 3.790 Test Acc: 0.476
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.4540351
	speed: 0.2415s/iter; left time: 3137.6961s
Epoch: 16 cost time: 7.512155055999756
Epoch: 16, Steps: 154 | Train Loss: 0.479 Vali Loss: 3.989 Vali Acc: 0.480 Test Loss: 3.989 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.1245653
	speed: 0.2358s/iter; left time: 3026.3613s
Epoch: 17 cost time: 8.820710182189941
Epoch: 17, Steps: 154 | Train Loss: 0.452 Vali Loss: 4.236 Vali Acc: 0.448 Test Loss: 4.236 Test Acc: 0.448
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5405602
	speed: 0.2590s/iter; left time: 3284.3721s
Epoch: 18 cost time: 7.517646312713623
Epoch: 18, Steps: 154 | Train Loss: 0.426 Vali Loss: 4.446 Vali Acc: 0.459 Test Loss: 4.446 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.3531161
	speed: 0.2538s/iter; left time: 3179.3595s
Epoch: 19 cost time: 8.894686937332153
Epoch: 19, Steps: 154 | Train Loss: 0.434 Vali Loss: 4.173 Vali Acc: 0.426 Test Loss: 4.173 Test Acc: 0.426
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.527169505271695
model parameter : 326670
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0535576
	speed: 0.0807s/iter; left time: 1234.9717s
Epoch: 1 cost time: 10.88849139213562
Epoch: 1, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.062 Vali Acc: 0.442 Test Loss: 2.062 Test Acc: 0.442
Validation loss decreased (inf --> -0.441585).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5932412
	speed: 0.2600s/iter; left time: 3937.8635s
Epoch: 2 cost time: 9.113227367401123
Epoch: 2, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.400 Vali Acc: 0.371 Test Loss: 2.400 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.1935633
	speed: 0.2664s/iter; left time: 3993.6223s
Epoch: 3 cost time: 8.21523380279541
Epoch: 3, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.033 Vali Acc: 0.474 Test Loss: 2.033 Test Acc: 0.474
Validation loss decreased (-0.441585 --> -0.473621).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9045945
	speed: 0.2418s/iter; left time: 3587.9997s
Epoch: 4 cost time: 9.21882939338684
Epoch: 4, Steps: 154 | Train Loss: 1.297 Vali Loss: 2.302 Vali Acc: 0.505 Test Loss: 2.302 Test Acc: 0.505
Validation loss decreased (-0.473621 --> -0.504843).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6366144
	speed: 0.2687s/iter; left time: 3945.8955s
Epoch: 5 cost time: 8.850003719329834
Epoch: 5, Steps: 154 | Train Loss: 1.207 Vali Loss: 2.616 Vali Acc: 0.519 Test Loss: 2.616 Test Acc: 0.519
Validation loss decreased (-0.504843 --> -0.519033).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8431838
	speed: 0.2732s/iter; left time: 3969.1663s
Epoch: 6 cost time: 9.750904083251953
Epoch: 6, Steps: 154 | Train Loss: 1.157 Vali Loss: 2.219 Vali Acc: 0.551 Test Loss: 2.219 Test Acc: 0.551
Validation loss decreased (-0.519033 --> -0.551073).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6234126
	speed: 0.2710s/iter; left time: 3895.7097s
Epoch: 7 cost time: 9.077575206756592
Epoch: 7, Steps: 154 | Train Loss: 1.046 Vali Loss: 2.349 Vali Acc: 0.486 Test Loss: 2.349 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5690923
	speed: 0.2671s/iter; left time: 3798.3360s
Epoch: 8 cost time: 9.231858015060425
Epoch: 8, Steps: 154 | Train Loss: 0.963 Vali Loss: 2.893 Vali Acc: 0.495 Test Loss: 2.893 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9102605
	speed: 0.2881s/iter; left time: 4053.6095s
Epoch: 9 cost time: 9.402967691421509
Epoch: 9, Steps: 154 | Train Loss: 0.876 Vali Loss: 2.668 Vali Acc: 0.516 Test Loss: 2.668 Test Acc: 0.516
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8688626
	speed: 0.2466s/iter; left time: 3430.9468s
Epoch: 10 cost time: 8.349337339401245
Epoch: 10, Steps: 154 | Train Loss: 0.789 Vali Loss: 2.733 Vali Acc: 0.479 Test Loss: 2.733 Test Acc: 0.479
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4846201
	speed: 0.2581s/iter; left time: 3551.8448s
Epoch: 11 cost time: 8.480651378631592
Epoch: 11, Steps: 154 | Train Loss: 0.726 Vali Loss: 3.048 Vali Acc: 0.458 Test Loss: 3.048 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.2103209
	speed: 0.2451s/iter; left time: 3334.6734s
Epoch: 12 cost time: 8.55169153213501
Epoch: 12, Steps: 154 | Train Loss: 0.679 Vali Loss: 3.009 Vali Acc: 0.463 Test Loss: 3.009 Test Acc: 0.463
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1270674
	speed: 0.2580s/iter; left time: 3470.5462s
Epoch: 13 cost time: 7.802289962768555
Epoch: 13, Steps: 154 | Train Loss: 0.627 Vali Loss: 3.380 Vali Acc: 0.442 Test Loss: 3.380 Test Acc: 0.442
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3204308
	speed: 0.2450s/iter; left time: 3257.5961s
Epoch: 14 cost time: 8.454846143722534
Epoch: 14, Steps: 154 | Train Loss: 0.590 Vali Loss: 3.391 Vali Acc: 0.453 Test Loss: 3.391 Test Acc: 0.453
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3637873
	speed: 0.2744s/iter; left time: 3607.0019s
Epoch: 15 cost time: 8.54802131652832
Epoch: 15, Steps: 154 | Train Loss: 0.544 Vali Loss: 3.331 Vali Acc: 0.534 Test Loss: 3.331 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.5588266
	speed: 0.2602s/iter; left time: 3380.4667s
Epoch: 16 cost time: 8.947381019592285
Epoch: 16, Steps: 154 | Train Loss: 0.507 Vali Loss: 3.354 Vali Acc: 0.516 Test Loss: 3.354 Test Acc: 0.516
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.551094890510949
model parameter : 326798
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9449837
	speed: 0.0898s/iter; left time: 1373.9501s
Epoch: 1 cost time: 12.11415410041809
Epoch: 1, Steps: 154 | Train Loss: 1.982 Vali Loss: 1.833 Vali Acc: 0.440 Test Loss: 1.833 Test Acc: 0.440
Validation loss decreased (inf --> -0.440371).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3412411
	speed: 0.2572s/iter; left time: 3895.1939s
Epoch: 2 cost time: 8.289809703826904
Epoch: 2, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.195 Vali Acc: 0.461 Test Loss: 2.195 Test Acc: 0.461
Validation loss decreased (-0.440371 --> -0.460643).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8821024
	speed: 0.2352s/iter; left time: 3525.9446s
Epoch: 3 cost time: 7.77716326713562
Epoch: 3, Steps: 154 | Train Loss: 1.316 Vali Loss: 2.025 Vali Acc: 0.509 Test Loss: 2.025 Test Acc: 0.509
Validation loss decreased (-0.460643 --> -0.509307).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4412838
	speed: 0.2590s/iter; left time: 3843.2264s
Epoch: 4 cost time: 7.677142381668091
Epoch: 4, Steps: 154 | Train Loss: 1.242 Vali Loss: 2.421 Vali Acc: 0.496 Test Loss: 2.421 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0105089
	speed: 0.2412s/iter; left time: 3542.1578s
Epoch: 5 cost time: 7.903095483779907
Epoch: 5, Steps: 154 | Train Loss: 1.130 Vali Loss: 2.389 Vali Acc: 0.533 Test Loss: 2.389 Test Acc: 0.533
Validation loss decreased (-0.509307 --> -0.533228).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6534035
	speed: 0.2560s/iter; left time: 3720.6602s
Epoch: 6 cost time: 9.00939393043518
Epoch: 6, Steps: 154 | Train Loss: 1.118 Vali Loss: 2.465 Vali Acc: 0.448 Test Loss: 2.465 Test Acc: 0.448
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0060108
	speed: 0.2316s/iter; left time: 3329.1610s
Epoch: 7 cost time: 7.806732177734375
Epoch: 7, Steps: 154 | Train Loss: 0.995 Vali Loss: 2.408 Vali Acc: 0.498 Test Loss: 2.408 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8719707
	speed: 0.2597s/iter; left time: 3693.1900s
Epoch: 8 cost time: 9.793942213058472
Epoch: 8, Steps: 154 | Train Loss: 0.940 Vali Loss: 2.468 Vali Acc: 0.515 Test Loss: 2.468 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.5793560
	speed: 0.2422s/iter; left time: 3408.0607s
Epoch: 9 cost time: 7.392333269119263
Epoch: 9, Steps: 154 | Train Loss: 0.854 Vali Loss: 2.642 Vali Acc: 0.489 Test Loss: 2.642 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.0468270
	speed: 0.2412s/iter; left time: 3356.6531s
Epoch: 10 cost time: 9.126798629760742
Epoch: 10, Steps: 154 | Train Loss: 0.827 Vali Loss: 2.688 Vali Acc: 0.479 Test Loss: 2.688 Test Acc: 0.479
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4942092
	speed: 0.2366s/iter; left time: 3255.3147s
Epoch: 11 cost time: 6.890840291976929
Epoch: 11, Steps: 154 | Train Loss: 0.753 Vali Loss: 3.206 Vali Acc: 0.491 Test Loss: 3.206 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3586085
	speed: 0.2252s/iter; left time: 3064.3219s
Epoch: 12 cost time: 7.807636022567749
Epoch: 12, Steps: 154 | Train Loss: 0.669 Vali Loss: 3.167 Vali Acc: 0.469 Test Loss: 3.167 Test Acc: 0.469
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6498145
	speed: 0.2244s/iter; left time: 3018.5818s
Epoch: 13 cost time: 6.880624294281006
Epoch: 13, Steps: 154 | Train Loss: 0.645 Vali Loss: 2.856 Vali Acc: 0.526 Test Loss: 2.856 Test Acc: 0.526
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6871989
	speed: 0.2203s/iter; left time: 2929.4896s
Epoch: 14 cost time: 6.809020042419434
Epoch: 14, Steps: 154 | Train Loss: 0.582 Vali Loss: 2.987 Vali Acc: 0.543 Test Loss: 2.987 Test Acc: 0.543
Validation loss decreased (-0.533228 --> -0.542549).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0936319
	speed: 0.2351s/iter; left time: 3090.4479s
Epoch: 15 cost time: 7.879957437515259
Epoch: 15, Steps: 154 | Train Loss: 0.562 Vali Loss: 3.209 Vali Acc: 0.500 Test Loss: 3.209 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.4201285
	speed: 0.2114s/iter; left time: 2745.9747s
Epoch: 16 cost time: 7.556549072265625
Epoch: 16, Steps: 154 | Train Loss: 0.518 Vali Loss: 3.212 Vali Acc: 0.528 Test Loss: 3.212 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0571554
	speed: 0.2463s/iter; left time: 3161.3043s
Epoch: 17 cost time: 8.50291132926941
Epoch: 17, Steps: 154 | Train Loss: 0.454 Vali Loss: 3.423 Vali Acc: 0.526 Test Loss: 3.423 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.6221766
	speed: 0.2133s/iter; left time: 2705.4362s
Epoch: 18 cost time: 6.999824285507202
Epoch: 18, Steps: 154 | Train Loss: 0.460 Vali Loss: 3.387 Vali Acc: 0.515 Test Loss: 3.387 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3316336
	speed: 0.2485s/iter; left time: 3113.2029s
Epoch: 19 cost time: 8.387349843978882
Epoch: 19, Steps: 154 | Train Loss: 0.440 Vali Loss: 3.219 Vali Acc: 0.532 Test Loss: 3.219 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.4724276
	speed: 0.2297s/iter; left time: 2842.3109s
Epoch: 20 cost time: 5.96270489692688
Epoch: 20, Steps: 154 | Train Loss: 0.388 Vali Loss: 3.364 Vali Acc: 0.501 Test Loss: 3.364 Test Acc: 0.501
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.3640935
	speed: 0.2163s/iter; left time: 2643.7445s
Epoch: 21 cost time: 6.866022348403931
Epoch: 21, Steps: 154 | Train Loss: 0.373 Vali Loss: 3.714 Vali Acc: 0.536 Test Loss: 3.714 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.4063428
	speed: 0.1951s/iter; left time: 2353.7674s
Epoch: 22 cost time: 5.89894962310791
Epoch: 22, Steps: 154 | Train Loss: 0.337 Vali Loss: 3.706 Vali Acc: 0.510 Test Loss: 3.706 Test Acc: 0.510
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2190137
	speed: 0.2044s/iter; left time: 2435.0454s
Epoch: 23 cost time: 6.243683815002441
Epoch: 23, Steps: 154 | Train Loss: 0.327 Vali Loss: 3.699 Vali Acc: 0.508 Test Loss: 3.699 Test Acc: 0.508
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.4783959
	speed: 0.1781s/iter; left time: 2094.3576s
Epoch: 24 cost time: 5.8007588386535645
Epoch: 24, Steps: 154 | Train Loss: 0.327 Vali Loss: 3.778 Vali Acc: 0.489 Test Loss: 3.778 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5425790754257908
model parameter : 262542
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4918475
	speed: 0.0640s/iter; left time: 979.8821s
Epoch: 1 cost time: 8.20003604888916
Epoch: 1, Steps: 154 | Train Loss: 2.110 Vali Loss: 1.889 Vali Acc: 0.397 Test Loss: 1.889 Test Acc: 0.397
Validation loss decreased (inf --> -0.396575).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2847723
	speed: 0.1950s/iter; left time: 2954.1417s
Epoch: 2 cost time: 4.91354513168335
Epoch: 2, Steps: 154 | Train Loss: 1.463 Vali Loss: 1.928 Vali Acc: 0.480 Test Loss: 1.928 Test Acc: 0.480
Validation loss decreased (-0.396575 --> -0.479705).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7825580
	speed: 0.1716s/iter; left time: 2573.1976s
Epoch: 3 cost time: 5.1636433601379395
Epoch: 3, Steps: 154 | Train Loss: 1.284 Vali Loss: 2.133 Vali Acc: 0.492 Test Loss: 2.133 Test Acc: 0.492
Validation loss decreased (-0.479705 --> -0.492274).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1261154
	speed: 0.1984s/iter; left time: 2943.7764s
Epoch: 4 cost time: 5.474651098251343
Epoch: 4, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.238 Vali Acc: 0.472 Test Loss: 2.238 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9972421
	speed: 0.1833s/iter; left time: 2691.2167s
Epoch: 5 cost time: 5.476317405700684
Epoch: 5, Steps: 154 | Train Loss: 1.135 Vali Loss: 2.561 Vali Acc: 0.461 Test Loss: 2.561 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5667274
	speed: 0.1932s/iter; left time: 2807.8799s
Epoch: 6 cost time: 5.771104574203491
Epoch: 6, Steps: 154 | Train Loss: 1.061 Vali Loss: 2.494 Vali Acc: 0.502 Test Loss: 2.494 Test Acc: 0.502
Validation loss decreased (-0.492274 --> -0.502003).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9907152
	speed: 0.1997s/iter; left time: 2870.7424s
Epoch: 7 cost time: 6.068448066711426
Epoch: 7, Steps: 154 | Train Loss: 0.988 Vali Loss: 2.872 Vali Acc: 0.466 Test Loss: 2.872 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9547085
	speed: 0.2077s/iter; left time: 2954.4595s
Epoch: 8 cost time: 5.757230997085571
Epoch: 8, Steps: 154 | Train Loss: 0.905 Vali Loss: 2.263 Vali Acc: 0.497 Test Loss: 2.263 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7977904
	speed: 0.2161s/iter; left time: 3040.5595s
Epoch: 9 cost time: 6.370854139328003
Epoch: 9, Steps: 154 | Train Loss: 0.834 Vali Loss: 2.981 Vali Acc: 0.461 Test Loss: 2.981 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8319148
	speed: 0.2035s/iter; left time: 2831.2604s
Epoch: 10 cost time: 5.517366170883179
Epoch: 10, Steps: 154 | Train Loss: 0.775 Vali Loss: 2.772 Vali Acc: 0.509 Test Loss: 2.772 Test Acc: 0.509
Validation loss decreased (-0.502003 --> -0.508488).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1685693
	speed: 0.2153s/iter; left time: 2962.1638s
Epoch: 11 cost time: 6.1066954135894775
Epoch: 11, Steps: 154 | Train Loss: 0.687 Vali Loss: 2.819 Vali Acc: 0.507 Test Loss: 2.819 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.7870994
	speed: 0.2078s/iter; left time: 2827.7537s
Epoch: 12 cost time: 5.63429594039917
Epoch: 12, Steps: 154 | Train Loss: 0.647 Vali Loss: 2.834 Vali Acc: 0.492 Test Loss: 2.834 Test Acc: 0.492
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7480624
	speed: 0.2130s/iter; left time: 2865.6777s
Epoch: 13 cost time: 6.113478183746338
Epoch: 13, Steps: 154 | Train Loss: 0.634 Vali Loss: 2.706 Vali Acc: 0.541 Test Loss: 2.706 Test Acc: 0.541
Validation loss decreased (-0.508488 --> -0.540524).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6684199
	speed: 0.2005s/iter; left time: 2666.4195s
Epoch: 14 cost time: 6.2674713134765625
Epoch: 14, Steps: 154 | Train Loss: 0.556 Vali Loss: 2.636 Vali Acc: 0.479 Test Loss: 2.636 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.4576102
	speed: 0.2065s/iter; left time: 2714.6522s
Epoch: 15 cost time: 5.566492795944214
Epoch: 15, Steps: 154 | Train Loss: 0.512 Vali Loss: 2.965 Vali Acc: 0.493 Test Loss: 2.965 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.4314555
	speed: 0.1942s/iter; left time: 2522.2394s
Epoch: 16 cost time: 5.286485195159912
Epoch: 16, Steps: 154 | Train Loss: 0.482 Vali Loss: 2.939 Vali Acc: 0.516 Test Loss: 2.939 Test Acc: 0.516
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9904751
	speed: 0.2108s/iter; left time: 2705.5454s
Epoch: 17 cost time: 5.902430534362793
Epoch: 17, Steps: 154 | Train Loss: 0.485 Vali Loss: 3.423 Vali Acc: 0.460 Test Loss: 3.423 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.1065406
	speed: 0.1930s/iter; left time: 2447.5721s
Epoch: 18 cost time: 5.7246623039245605
Epoch: 18, Steps: 154 | Train Loss: 0.461 Vali Loss: 3.444 Vali Acc: 0.464 Test Loss: 3.444 Test Acc: 0.464
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.2557990
	speed: 0.2012s/iter; left time: 2521.3232s
Epoch: 19 cost time: 5.761788606643677
Epoch: 19, Steps: 154 | Train Loss: 0.403 Vali Loss: 3.471 Vali Acc: 0.521 Test Loss: 3.471 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6513144
	speed: 0.1846s/iter; left time: 2284.1377s
Epoch: 20 cost time: 5.3743674755096436
Epoch: 20, Steps: 154 | Train Loss: 0.408 Vali Loss: 3.453 Vali Acc: 0.508 Test Loss: 3.453 Test Acc: 0.508
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2428036
	speed: 0.2094s/iter; left time: 2559.5426s
Epoch: 21 cost time: 6.1103246212005615
Epoch: 21, Steps: 154 | Train Loss: 0.356 Vali Loss: 3.414 Vali Acc: 0.515 Test Loss: 3.414 Test Acc: 0.515
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.5525203
	speed: 0.2054s/iter; left time: 2478.9270s
Epoch: 22 cost time: 6.0241241455078125
Epoch: 22, Steps: 154 | Train Loss: 0.327 Vali Loss: 3.392 Vali Acc: 0.494 Test Loss: 3.392 Test Acc: 0.494
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.5809827
	speed: 0.2080s/iter; left time: 2477.6839s
Epoch: 23 cost time: 5.567486524581909
Epoch: 23, Steps: 154 | Train Loss: 0.349 Vali Loss: 3.535 Vali Acc: 0.509 Test Loss: 3.535 Test Acc: 0.509
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.540551500405515
model parameter : 230542
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6244651
	speed: 0.0672s/iter; left time: 1028.0378s
Epoch: 1 cost time: 8.669084072113037
Epoch: 1, Steps: 154 | Train Loss: 2.145 Vali Loss: 1.893 Vali Acc: 0.381 Test Loss: 1.893 Test Acc: 0.381
Validation loss decreased (inf --> -0.380760).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7022371
	speed: 0.2187s/iter; left time: 3313.0435s
Epoch: 2 cost time: 6.334589242935181
Epoch: 2, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.058 Vali Acc: 0.457 Test Loss: 2.058 Test Acc: 0.457
Validation loss decreased (-0.380760 --> -0.456995).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1840266
	speed: 0.2111s/iter; left time: 3165.6224s
Epoch: 3 cost time: 6.78259539604187
Epoch: 3, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.011 Vali Acc: 0.484 Test Loss: 2.011 Test Acc: 0.484
Validation loss decreased (-0.456995 --> -0.484165).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5745165
	speed: 0.2168s/iter; left time: 3217.5579s
Epoch: 4 cost time: 5.63905930519104
Epoch: 4, Steps: 154 | Train Loss: 1.193 Vali Loss: 2.266 Vali Acc: 0.427 Test Loss: 2.266 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2848103
	speed: 0.2274s/iter; left time: 3339.3091s
Epoch: 5 cost time: 6.912159442901611
Epoch: 5, Steps: 154 | Train Loss: 1.144 Vali Loss: 2.077 Vali Acc: 0.522 Test Loss: 2.077 Test Acc: 0.522
Validation loss decreased (-0.484165 --> -0.522283).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7419088
	speed: 0.2352s/iter; left time: 3416.9685s
Epoch: 6 cost time: 7.20646858215332
Epoch: 6, Steps: 154 | Train Loss: 1.055 Vali Loss: 2.133 Vali Acc: 0.468 Test Loss: 2.133 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2186550
	speed: 0.2350s/iter; left time: 3379.1919s
Epoch: 7 cost time: 6.8328001499176025
Epoch: 7, Steps: 154 | Train Loss: 0.962 Vali Loss: 2.302 Vali Acc: 0.477 Test Loss: 2.302 Test Acc: 0.477
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8321130
	speed: 0.2317s/iter; left time: 3295.1072s
Epoch: 8 cost time: 6.5150465965271
Epoch: 8, Steps: 154 | Train Loss: 0.910 Vali Loss: 2.099 Vali Acc: 0.554 Test Loss: 2.099 Test Acc: 0.554
Validation loss decreased (-0.522283 --> -0.553913).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1788647
	speed: 0.2278s/iter; left time: 3205.3728s
Epoch: 9 cost time: 6.926951885223389
Epoch: 9, Steps: 154 | Train Loss: 0.807 Vali Loss: 2.494 Vali Acc: 0.475 Test Loss: 2.494 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3564934
	speed: 0.2180s/iter; left time: 3033.5095s
Epoch: 10 cost time: 6.238415241241455
Epoch: 10, Steps: 154 | Train Loss: 0.765 Vali Loss: 2.414 Vali Acc: 0.464 Test Loss: 2.414 Test Acc: 0.464
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.0530926
	speed: 0.2206s/iter; left time: 3035.4832s
Epoch: 11 cost time: 6.669830560684204
Epoch: 11, Steps: 154 | Train Loss: 0.697 Vali Loss: 2.543 Vali Acc: 0.503 Test Loss: 2.543 Test Acc: 0.503
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.5849527
	speed: 0.2358s/iter; left time: 3208.7121s
Epoch: 12 cost time: 6.046552419662476
Epoch: 12, Steps: 154 | Train Loss: 0.665 Vali Loss: 2.559 Vali Acc: 0.479 Test Loss: 2.559 Test Acc: 0.479
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3392717
	speed: 0.2110s/iter; left time: 2838.8459s
Epoch: 13 cost time: 6.927271366119385
Epoch: 13, Steps: 154 | Train Loss: 0.618 Vali Loss: 2.681 Vali Acc: 0.511 Test Loss: 2.681 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.5678925
	speed: 0.2236s/iter; left time: 2973.4705s
Epoch: 14 cost time: 6.140980958938599
Epoch: 14, Steps: 154 | Train Loss: 0.591 Vali Loss: 2.595 Vali Acc: 0.488 Test Loss: 2.595 Test Acc: 0.488
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6500922
	speed: 0.2187s/iter; left time: 2875.0087s
Epoch: 15 cost time: 6.822603702545166
Epoch: 15, Steps: 154 | Train Loss: 0.547 Vali Loss: 2.819 Vali Acc: 0.495 Test Loss: 2.819 Test Acc: 0.495
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.3487414
	speed: 0.2215s/iter; left time: 2877.3707s
Epoch: 16 cost time: 6.79326057434082
Epoch: 16, Steps: 154 | Train Loss: 0.497 Vali Loss: 2.907 Vali Acc: 0.490 Test Loss: 2.907 Test Acc: 0.490
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.7490795
	speed: 0.2414s/iter; left time: 3098.8169s
Epoch: 17 cost time: 7.119240045547485
Epoch: 17, Steps: 154 | Train Loss: 0.464 Vali Loss: 2.843 Vali Acc: 0.526 Test Loss: 2.843 Test Acc: 0.526
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.8498136
	speed: 0.2473s/iter; left time: 3135.9498s
Epoch: 18 cost time: 6.527585506439209
Epoch: 18, Steps: 154 | Train Loss: 0.427 Vali Loss: 2.925 Vali Acc: 0.482 Test Loss: 2.925 Test Acc: 0.482
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5539334955393349
model parameter : 209166
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1193500
	speed: 0.0875s/iter; left time: 1338.4503s
Epoch: 1 cost time: 11.441973686218262
Epoch: 1, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.212 Vali Acc: 0.414 Test Loss: 2.212 Test Acc: 0.414
Validation loss decreased (inf --> -0.414414).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6919837
	speed: 0.2373s/iter; left time: 3594.5545s
Epoch: 2 cost time: 7.679893255233765
Epoch: 2, Steps: 154 | Train Loss: 1.851 Vali Loss: 3.080 Vali Acc: 0.394 Test Loss: 3.080 Test Acc: 0.394
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9491959
	speed: 0.2320s/iter; left time: 3478.6208s
Epoch: 3 cost time: 8.34587287902832
Epoch: 3, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.966 Vali Acc: 0.438 Test Loss: 2.966 Test Acc: 0.438
Validation loss decreased (-0.414414 --> -0.437521).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2964931
	speed: 0.2334s/iter; left time: 3463.2147s
Epoch: 4 cost time: 7.640451908111572
Epoch: 4, Steps: 154 | Train Loss: 1.664 Vali Loss: 3.822 Vali Acc: 0.452 Test Loss: 3.822 Test Acc: 0.452
Validation loss decreased (-0.437521 --> -0.451705).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5024091
	speed: 0.2360s/iter; left time: 3465.5259s
Epoch: 5 cost time: 7.600994110107422
Epoch: 5, Steps: 154 | Train Loss: 1.532 Vali Loss: 3.796 Vali Acc: 0.364 Test Loss: 3.796 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7162453
	speed: 0.2497s/iter; left time: 3628.4311s
Epoch: 6 cost time: 8.369487047195435
Epoch: 6, Steps: 154 | Train Loss: 1.403 Vali Loss: 4.172 Vali Acc: 0.417 Test Loss: 4.172 Test Acc: 0.417
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4266660
	speed: 0.2424s/iter; left time: 3484.3859s
Epoch: 7 cost time: 8.710883140563965
Epoch: 7, Steps: 154 | Train Loss: 1.231 Vali Loss: 3.818 Vali Acc: 0.492 Test Loss: 3.818 Test Acc: 0.492
Validation loss decreased (-0.451705 --> -0.492257).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9590390
	speed: 0.2822s/iter; left time: 4013.6716s
Epoch: 8 cost time: 10.02457332611084
Epoch: 8, Steps: 154 | Train Loss: 1.091 Vali Loss: 4.732 Vali Acc: 0.399 Test Loss: 4.732 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2142957
	speed: 0.2504s/iter; left time: 3522.7140s
Epoch: 9 cost time: 8.843105792999268
Epoch: 9, Steps: 154 | Train Loss: 1.103 Vali Loss: 4.442 Vali Acc: 0.506 Test Loss: 4.442 Test Acc: 0.506
Validation loss decreased (-0.492257 --> -0.505633).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5200301
	speed: 0.2679s/iter; left time: 3727.5492s
Epoch: 10 cost time: 9.485756158828735
Epoch: 10, Steps: 154 | Train Loss: 0.942 Vali Loss: 4.705 Vali Acc: 0.476 Test Loss: 4.705 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7784212
	speed: 0.2596s/iter; left time: 3572.1042s
Epoch: 11 cost time: 9.221574306488037
Epoch: 11, Steps: 154 | Train Loss: 0.835 Vali Loss: 5.388 Vali Acc: 0.445 Test Loss: 5.388 Test Acc: 0.445
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.5660187
	speed: 0.2469s/iter; left time: 3359.2301s
Epoch: 12 cost time: 8.624078512191772
Epoch: 12, Steps: 154 | Train Loss: 0.753 Vali Loss: 5.048 Vali Acc: 0.468 Test Loss: 5.048 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3346870
	speed: 0.2547s/iter; left time: 3427.1509s
Epoch: 13 cost time: 8.26449704170227
Epoch: 13, Steps: 154 | Train Loss: 0.675 Vali Loss: 6.735 Vali Acc: 0.388 Test Loss: 6.735 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3547142
	speed: 0.2480s/iter; left time: 3298.7998s
Epoch: 14 cost time: 8.701679468154907
Epoch: 14, Steps: 154 | Train Loss: 0.708 Vali Loss: 5.985 Vali Acc: 0.428 Test Loss: 5.985 Test Acc: 0.428
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3666486
	speed: 0.2448s/iter; left time: 3218.3486s
Epoch: 15 cost time: 8.336714267730713
Epoch: 15, Steps: 154 | Train Loss: 0.630 Vali Loss: 5.903 Vali Acc: 0.459 Test Loss: 5.903 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.7990668
	speed: 0.2353s/iter; left time: 3056.9278s
Epoch: 16 cost time: 8.310449600219727
Epoch: 16, Steps: 154 | Train Loss: 0.497 Vali Loss: 5.978 Vali Acc: 0.429 Test Loss: 5.978 Test Acc: 0.429
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2480932
	speed: 0.2396s/iter; left time: 3075.9884s
Epoch: 17 cost time: 8.117430448532104
Epoch: 17, Steps: 154 | Train Loss: 0.491 Vali Loss: 6.416 Vali Acc: 0.421 Test Loss: 6.416 Test Acc: 0.421
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.9472287
	speed: 0.2395s/iter; left time: 3037.2232s
Epoch: 18 cost time: 9.230563879013062
Epoch: 18, Steps: 154 | Train Loss: 0.516 Vali Loss: 6.402 Vali Acc: 0.504 Test Loss: 6.402 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9579591
	speed: 0.2613s/iter; left time: 3273.7191s
Epoch: 19 cost time: 8.856935739517212
Epoch: 19, Steps: 154 | Train Loss: 0.426 Vali Loss: 5.778 Vali Acc: 0.469 Test Loss: 5.778 Test Acc: 0.469
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5056772100567721
model parameter : 487182
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9145550
	speed: 0.0875s/iter; left time: 1339.5083s
Epoch: 1 cost time: 11.76901626586914
Epoch: 1, Steps: 154 | Train Loss: 2.016 Vali Loss: 1.809 Vali Acc: 0.449 Test Loss: 1.809 Test Acc: 0.449
Validation loss decreased (inf --> -0.448887).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1523595
	speed: 0.2516s/iter; left time: 3810.9676s
Epoch: 2 cost time: 8.557560205459595
Epoch: 2, Steps: 154 | Train Loss: 1.482 Vali Loss: 1.911 Vali Acc: 0.462 Test Loss: 1.911 Test Acc: 0.462
Validation loss decreased (-0.448887 --> -0.462268).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0783685
	speed: 0.2519s/iter; left time: 3777.3548s
Epoch: 3 cost time: 8.300445556640625
Epoch: 3, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.400 Vali Acc: 0.450 Test Loss: 2.400 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5293820
	speed: 0.2582s/iter; left time: 3831.5373s
Epoch: 4 cost time: 8.484714031219482
Epoch: 4, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.536 Vali Acc: 0.285 Test Loss: 3.536 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7011718
	speed: 0.2730s/iter; left time: 4008.6366s
Epoch: 5 cost time: 9.40496015548706
Epoch: 5, Steps: 154 | Train Loss: 1.255 Vali Loss: 2.358 Vali Acc: 0.505 Test Loss: 2.358 Test Acc: 0.505
Validation loss decreased (-0.462268 --> -0.505248).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9068905
	speed: 0.2658s/iter; left time: 3862.4982s
Epoch: 6 cost time: 9.194006204605103
Epoch: 6, Steps: 154 | Train Loss: 1.177 Vali Loss: 3.286 Vali Acc: 0.468 Test Loss: 3.286 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2885137
	speed: 0.2631s/iter; left time: 3782.7029s
Epoch: 7 cost time: 9.532950162887573
Epoch: 7, Steps: 154 | Train Loss: 1.094 Vali Loss: 3.157 Vali Acc: 0.435 Test Loss: 3.157 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9146761
	speed: 0.2605s/iter; left time: 3705.1670s
Epoch: 8 cost time: 8.169430017471313
Epoch: 8, Steps: 154 | Train Loss: 0.975 Vali Loss: 2.898 Vali Acc: 0.463 Test Loss: 2.898 Test Acc: 0.463
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6956952
	speed: 0.2320s/iter; left time: 3263.8294s
Epoch: 9 cost time: 7.758904457092285
Epoch: 9, Steps: 154 | Train Loss: 0.963 Vali Loss: 2.891 Vali Acc: 0.481 Test Loss: 2.891 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2737153
	speed: 0.2381s/iter; left time: 3313.6420s
Epoch: 10 cost time: 7.257816553115845
Epoch: 10, Steps: 154 | Train Loss: 0.876 Vali Loss: 3.148 Vali Acc: 0.492 Test Loss: 3.148 Test Acc: 0.492
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4884520
	speed: 0.2308s/iter; left time: 3175.6722s
Epoch: 11 cost time: 7.594905376434326
Epoch: 11, Steps: 154 | Train Loss: 0.817 Vali Loss: 3.185 Vali Acc: 0.486 Test Loss: 3.185 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.8769023
	speed: 0.2495s/iter; left time: 3394.4647s
Epoch: 12 cost time: 7.4350526332855225
Epoch: 12, Steps: 154 | Train Loss: 0.747 Vali Loss: 4.357 Vali Acc: 0.396 Test Loss: 4.357 Test Acc: 0.396
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.4087120
	speed: 0.2326s/iter; left time: 3129.2195s
Epoch: 13 cost time: 7.261627197265625
Epoch: 13, Steps: 154 | Train Loss: 0.706 Vali Loss: 3.796 Vali Acc: 0.516 Test Loss: 3.796 Test Acc: 0.516
Validation loss decreased (-0.505248 --> -0.515777).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2275521
	speed: 0.2526s/iter; left time: 3359.5265s
Epoch: 14 cost time: 7.971757888793945
Epoch: 14, Steps: 154 | Train Loss: 0.619 Vali Loss: 3.947 Vali Acc: 0.468 Test Loss: 3.947 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8325995
	speed: 0.2366s/iter; left time: 3109.5950s
Epoch: 15 cost time: 7.9111857414245605
Epoch: 15, Steps: 154 | Train Loss: 0.620 Vali Loss: 3.978 Vali Acc: 0.523 Test Loss: 3.978 Test Acc: 0.523
Validation loss decreased (-0.515777 --> -0.522669).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5210446
	speed: 0.2483s/iter; left time: 3225.0446s
Epoch: 16 cost time: 7.633229732513428
Epoch: 16, Steps: 154 | Train Loss: 0.559 Vali Loss: 4.254 Vali Acc: 0.487 Test Loss: 4.254 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.5191131
	speed: 0.2082s/iter; left time: 2672.3563s
Epoch: 17 cost time: 7.077843189239502
Epoch: 17, Steps: 154 | Train Loss: 0.505 Vali Loss: 4.338 Vali Acc: 0.489 Test Loss: 4.338 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.5853072
	speed: 0.2267s/iter; left time: 2875.0730s
Epoch: 18 cost time: 6.877710819244385
Epoch: 18, Steps: 154 | Train Loss: 0.495 Vali Loss: 4.382 Vali Acc: 0.473 Test Loss: 4.382 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.5206438
	speed: 0.2121s/iter; left time: 2657.0215s
Epoch: 19 cost time: 6.9297685623168945
Epoch: 19, Steps: 154 | Train Loss: 0.470 Vali Loss: 4.573 Vali Acc: 0.515 Test Loss: 4.573 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.1789194
	speed: 0.2254s/iter; left time: 2788.8226s
Epoch: 20 cost time: 7.353901386260986
Epoch: 20, Steps: 154 | Train Loss: 0.417 Vali Loss: 4.218 Vali Acc: 0.524 Test Loss: 4.218 Test Acc: 0.524
Validation loss decreased (-0.522669 --> -0.524289).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.4251079
	speed: 0.2230s/iter; left time: 2725.1005s
Epoch: 21 cost time: 6.909871816635132
Epoch: 21, Steps: 154 | Train Loss: 0.391 Vali Loss: 4.758 Vali Acc: 0.457 Test Loss: 4.758 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.6008955
	speed: 0.2273s/iter; left time: 2743.4279s
Epoch: 22 cost time: 7.9015748500823975
Epoch: 22, Steps: 154 | Train Loss: 0.348 Vali Loss: 4.706 Vali Acc: 0.472 Test Loss: 4.706 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.3301678
	speed: 0.2263s/iter; left time: 2695.9125s
Epoch: 23 cost time: 7.201636075973511
Epoch: 23, Steps: 154 | Train Loss: 0.357 Vali Loss: 4.350 Vali Acc: 0.487 Test Loss: 4.350 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3091986
	speed: 0.2267s/iter; left time: 2666.1430s
Epoch: 24 cost time: 7.0593626499176025
Epoch: 24, Steps: 154 | Train Loss: 0.375 Vali Loss: 4.443 Vali Acc: 0.526 Test Loss: 4.443 Test Acc: 0.526
Validation loss decreased (-0.524289 --> -0.526314).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0833617
	speed: 0.2298s/iter; left time: 2667.2824s
Epoch: 25 cost time: 7.526620626449585
Epoch: 25, Steps: 154 | Train Loss: 0.292 Vali Loss: 4.916 Vali Acc: 0.505 Test Loss: 4.916 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0263281
	speed: 0.2310s/iter; left time: 2645.2460s
Epoch: 26 cost time: 7.712370872497559
Epoch: 26, Steps: 154 | Train Loss: 0.252 Vali Loss: 5.169 Vali Acc: 0.496 Test Loss: 5.169 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3789798
	speed: 0.2353s/iter; left time: 2658.2103s
Epoch: 27 cost time: 7.648521423339844
Epoch: 27, Steps: 154 | Train Loss: 0.323 Vali Loss: 5.163 Vali Acc: 0.467 Test Loss: 5.163 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.1817362
	speed: 0.2453s/iter; left time: 2733.5786s
Epoch: 28 cost time: 8.910600423812866
Epoch: 28, Steps: 154 | Train Loss: 0.263 Vali Loss: 5.285 Vali Acc: 0.448 Test Loss: 5.285 Test Acc: 0.448
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.4178879
	speed: 0.2509s/iter; left time: 2756.8313s
Epoch: 29 cost time: 8.365947008132935
Epoch: 29, Steps: 154 | Train Loss: 0.228 Vali Loss: 4.923 Vali Acc: 0.477 Test Loss: 4.923 Test Acc: 0.477
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.5358081
	speed: 0.2802s/iter; left time: 3036.0173s
Epoch: 30 cost time: 8.204342603683472
Epoch: 30, Steps: 154 | Train Loss: 0.232 Vali Loss: 4.790 Vali Acc: 0.506 Test Loss: 4.790 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.2790148
	speed: 0.2504s/iter; left time: 2674.6001s
Epoch: 31 cost time: 8.816070079803467
Epoch: 31, Steps: 154 | Train Loss: 0.222 Vali Loss: 5.579 Vali Acc: 0.425 Test Loss: 5.579 Test Acc: 0.425
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0088539
	speed: 0.2327s/iter; left time: 2449.8985s
Epoch: 32 cost time: 8.464622735977173
Epoch: 32, Steps: 154 | Train Loss: 0.205 Vali Loss: 5.121 Vali Acc: 0.509 Test Loss: 5.121 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.1035871
	speed: 0.2611s/iter; left time: 2708.5259s
Epoch: 33 cost time: 8.769301652908325
Epoch: 33, Steps: 154 | Train Loss: 0.188 Vali Loss: 5.468 Vali Acc: 0.496 Test Loss: 5.468 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.1803945
	speed: 0.2622s/iter; left time: 2679.4063s
Epoch: 34 cost time: 8.035498857498169
Epoch: 34, Steps: 154 | Train Loss: 0.235 Vali Loss: 5.534 Vali Acc: 0.494 Test Loss: 5.534 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5263584752635847
model parameter : 293774
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4607213
	speed: 0.0845s/iter; left time: 1292.9733s
Epoch: 1 cost time: 11.1950843334198
Epoch: 1, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.350 Vali Acc: 0.382 Test Loss: 2.350 Test Acc: 0.382
Validation loss decreased (inf --> -0.381972).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4212209
	speed: 0.2393s/iter; left time: 3624.3634s
Epoch: 2 cost time: 8.713945865631104
Epoch: 2, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.005 Vali Acc: 0.510 Test Loss: 2.005 Test Acc: 0.510
Validation loss decreased (-0.381972 --> -0.510118).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6177150
	speed: 0.2341s/iter; left time: 3509.5832s
Epoch: 3 cost time: 8.396386861801147
Epoch: 3, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.087 Vali Acc: 0.503 Test Loss: 2.087 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.6417925
	speed: 0.2703s/iter; left time: 4010.3909s
Epoch: 4 cost time: 9.68145489692688
Epoch: 4, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.612 Vali Acc: 0.512 Test Loss: 2.612 Test Acc: 0.512
Validation loss decreased (-0.510118 --> -0.511734).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3861645
	speed: 0.2696s/iter; left time: 3959.4093s
Epoch: 5 cost time: 9.609971761703491
Epoch: 5, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.158 Vali Acc: 0.494 Test Loss: 2.158 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3858099
	speed: 0.2720s/iter; left time: 3952.9680s
Epoch: 6 cost time: 9.96294355392456
Epoch: 6, Steps: 154 | Train Loss: 1.150 Vali Loss: 3.022 Vali Acc: 0.517 Test Loss: 3.022 Test Acc: 0.517
Validation loss decreased (-0.511734 --> -0.517001).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.6917148
	speed: 0.2650s/iter; left time: 3809.6861s
Epoch: 7 cost time: 9.765841007232666
Epoch: 7, Steps: 154 | Train Loss: 1.048 Vali Loss: 2.707 Vali Acc: 0.499 Test Loss: 2.707 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8402618
	speed: 0.2700s/iter; left time: 3839.6110s
Epoch: 8 cost time: 7.716856002807617
Epoch: 8, Steps: 154 | Train Loss: 0.969 Vali Loss: 2.800 Vali Acc: 0.507 Test Loss: 2.800 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3802998
	speed: 0.2534s/iter; left time: 3565.0632s
Epoch: 9 cost time: 8.31151556968689
Epoch: 9, Steps: 154 | Train Loss: 0.891 Vali Loss: 2.861 Vali Acc: 0.472 Test Loss: 2.861 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2836672
	speed: 0.2640s/iter; left time: 3673.2758s
Epoch: 10 cost time: 9.14551329612732
Epoch: 10, Steps: 154 | Train Loss: 0.797 Vali Loss: 3.188 Vali Acc: 0.534 Test Loss: 3.188 Test Acc: 0.534
Validation loss decreased (-0.517001 --> -0.533626).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7762133
	speed: 0.2454s/iter; left time: 3376.6712s
Epoch: 11 cost time: 8.424590110778809
Epoch: 11, Steps: 154 | Train Loss: 0.758 Vali Loss: 2.963 Vali Acc: 0.513 Test Loss: 2.963 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6082608
	speed: 0.2248s/iter; left time: 3059.1912s
Epoch: 12 cost time: 8.166141271591187
Epoch: 12, Steps: 154 | Train Loss: 0.685 Vali Loss: 3.031 Vali Acc: 0.529 Test Loss: 3.031 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5537749
	speed: 0.2317s/iter; left time: 3116.6768s
Epoch: 13 cost time: 7.318027019500732
Epoch: 13, Steps: 154 | Train Loss: 0.622 Vali Loss: 3.450 Vali Acc: 0.491 Test Loss: 3.450 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.4377070
	speed: 0.2232s/iter; left time: 2967.9985s
Epoch: 14 cost time: 7.114345550537109
Epoch: 14, Steps: 154 | Train Loss: 0.608 Vali Loss: 3.488 Vali Acc: 0.511 Test Loss: 3.488 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.3274325
	speed: 0.2275s/iter; left time: 2990.1305s
Epoch: 15 cost time: 7.214057445526123
Epoch: 15, Steps: 154 | Train Loss: 0.521 Vali Loss: 3.467 Vali Acc: 0.481 Test Loss: 3.467 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.2870860
	speed: 0.2051s/iter; left time: 2663.9029s
Epoch: 16 cost time: 6.313691854476929
Epoch: 16, Steps: 154 | Train Loss: 0.512 Vali Loss: 3.588 Vali Acc: 0.514 Test Loss: 3.588 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.1582786
	speed: 0.2118s/iter; left time: 2718.4030s
Epoch: 17 cost time: 6.601743459701538
Epoch: 17, Steps: 154 | Train Loss: 0.478 Vali Loss: 3.705 Vali Acc: 0.534 Test Loss: 3.705 Test Acc: 0.534
Validation loss decreased (-0.533626 --> -0.534432).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3971804
	speed: 0.2007s/iter; left time: 2545.3426s
Epoch: 18 cost time: 6.852529287338257
Epoch: 18, Steps: 154 | Train Loss: 0.469 Vali Loss: 3.667 Vali Acc: 0.507 Test Loss: 3.667 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6561622
	speed: 0.2226s/iter; left time: 2789.3467s
Epoch: 19 cost time: 7.384454965591431
Epoch: 19, Steps: 154 | Train Loss: 0.398 Vali Loss: 3.741 Vali Acc: 0.530 Test Loss: 3.741 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2277301
	speed: 0.2310s/iter; left time: 2859.0471s
Epoch: 20 cost time: 7.824944257736206
Epoch: 20, Steps: 154 | Train Loss: 0.392 Vali Loss: 3.861 Vali Acc: 0.541 Test Loss: 3.861 Test Acc: 0.541
Validation loss decreased (-0.534432 --> -0.541324).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2399943
	speed: 0.2493s/iter; left time: 3046.0870s
Epoch: 21 cost time: 8.338836669921875
Epoch: 21, Steps: 154 | Train Loss: 0.353 Vali Loss: 4.372 Vali Acc: 0.506 Test Loss: 4.372 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1654435
	speed: 0.2365s/iter; left time: 2853.4281s
Epoch: 22 cost time: 7.87192964553833
Epoch: 22, Steps: 154 | Train Loss: 0.343 Vali Loss: 3.698 Vali Acc: 0.531 Test Loss: 3.698 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0503769
	speed: 0.2410s/iter; left time: 2871.0980s
Epoch: 23 cost time: 7.723865985870361
Epoch: 23, Steps: 154 | Train Loss: 0.336 Vali Loss: 4.382 Vali Acc: 0.508 Test Loss: 4.382 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.7273028
	speed: 0.2288s/iter; left time: 2689.9917s
Epoch: 24 cost time: 7.497146844863892
Epoch: 24, Steps: 154 | Train Loss: 0.330 Vali Loss: 4.206 Vali Acc: 0.524 Test Loss: 4.206 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2816246
	speed: 0.2541s/iter; left time: 2948.6723s
Epoch: 25 cost time: 8.15151047706604
Epoch: 25, Steps: 154 | Train Loss: 0.298 Vali Loss: 4.103 Vali Acc: 0.521 Test Loss: 4.103 Test Acc: 0.521
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.2798949
	speed: 0.2272s/iter; left time: 2602.1017s
Epoch: 26 cost time: 7.382299184799194
Epoch: 26, Steps: 154 | Train Loss: 0.282 Vali Loss: 4.499 Vali Acc: 0.524 Test Loss: 4.499 Test Acc: 0.524
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0237301
	speed: 0.2376s/iter; left time: 2684.1148s
Epoch: 27 cost time: 7.076910972595215
Epoch: 27, Steps: 154 | Train Loss: 0.289 Vali Loss: 4.342 Vali Acc: 0.514 Test Loss: 4.342 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.4350297
	speed: 0.2399s/iter; left time: 2673.5108s
Epoch: 28 cost time: 8.40734338760376
Epoch: 28, Steps: 154 | Train Loss: 0.259 Vali Loss: 4.229 Vali Acc: 0.532 Test Loss: 4.229 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0285520
	speed: 0.2138s/iter; left time: 2349.2216s
Epoch: 29 cost time: 7.68691349029541
Epoch: 29, Steps: 154 | Train Loss: 0.238 Vali Loss: 4.378 Vali Acc: 0.528 Test Loss: 4.378 Test Acc: 0.528
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.4494252
	speed: 0.2366s/iter; left time: 2563.0986s
Epoch: 30 cost time: 7.904106140136719
Epoch: 30, Steps: 154 | Train Loss: 0.242 Vali Loss: 4.086 Vali Acc: 0.496 Test Loss: 4.086 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5413625304136253
model parameter : 293902
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0078261
	speed: 0.0852s/iter; left time: 1303.4866s
Epoch: 1 cost time: 11.42610239982605
Epoch: 1, Steps: 154 | Train Loss: 2.020 Vali Loss: 2.064 Vali Acc: 0.418 Test Loss: 2.064 Test Acc: 0.418
Validation loss decreased (inf --> -0.418471).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1717949
	speed: 0.2345s/iter; left time: 3551.6254s
Epoch: 2 cost time: 8.047770023345947
Epoch: 2, Steps: 154 | Train Loss: 1.437 Vali Loss: 1.849 Vali Acc: 0.478 Test Loss: 1.849 Test Acc: 0.478
Validation loss decreased (-0.418471 --> -0.478084).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8326554
	speed: 0.2482s/iter; left time: 3721.3378s
Epoch: 3 cost time: 8.767367601394653
Epoch: 3, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.369 Vali Acc: 0.441 Test Loss: 2.369 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4686394
	speed: 0.2426s/iter; left time: 3600.5901s
Epoch: 4 cost time: 8.768647909164429
Epoch: 4, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.642 Vali Acc: 0.436 Test Loss: 2.642 Test Acc: 0.436
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0937939
	speed: 0.2475s/iter; left time: 3634.1049s
Epoch: 5 cost time: 8.299034118652344
Epoch: 5, Steps: 154 | Train Loss: 1.217 Vali Loss: 2.560 Vali Acc: 0.487 Test Loss: 2.560 Test Acc: 0.487
Validation loss decreased (-0.478084 --> -0.486592).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8615889
	speed: 0.2489s/iter; left time: 3617.0210s
Epoch: 6 cost time: 8.591056108474731
Epoch: 6, Steps: 154 | Train Loss: 1.140 Vali Loss: 2.150 Vali Acc: 0.515 Test Loss: 2.150 Test Acc: 0.515
Validation loss decreased (-0.486592 --> -0.514577).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9804119
	speed: 0.2514s/iter; left time: 3614.7583s
Epoch: 7 cost time: 8.620069026947021
Epoch: 7, Steps: 154 | Train Loss: 1.019 Vali Loss: 2.887 Vali Acc: 0.511 Test Loss: 2.887 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2360753
	speed: 0.2402s/iter; left time: 3416.1382s
Epoch: 8 cost time: 8.184735536575317
Epoch: 8, Steps: 154 | Train Loss: 0.955 Vali Loss: 2.277 Vali Acc: 0.531 Test Loss: 2.277 Test Acc: 0.531
Validation loss decreased (-0.514577 --> -0.531202).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1492459
	speed: 0.2506s/iter; left time: 3525.8629s
Epoch: 9 cost time: 8.00410795211792
Epoch: 9, Steps: 154 | Train Loss: 0.845 Vali Loss: 2.480 Vali Acc: 0.506 Test Loss: 2.480 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8957784
	speed: 0.2574s/iter; left time: 3582.3793s
Epoch: 10 cost time: 8.38447093963623
Epoch: 10, Steps: 154 | Train Loss: 0.825 Vali Loss: 2.457 Vali Acc: 0.511 Test Loss: 2.457 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2302160
	speed: 0.2517s/iter; left time: 3463.2705s
Epoch: 11 cost time: 7.741825819015503
Epoch: 11, Steps: 154 | Train Loss: 0.736 Vali Loss: 2.800 Vali Acc: 0.541 Test Loss: 2.800 Test Acc: 0.541
Validation loss decreased (-0.531202 --> -0.540524).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1606029
	speed: 0.2248s/iter; left time: 3059.0791s
Epoch: 12 cost time: 7.776337146759033
Epoch: 12, Steps: 154 | Train Loss: 0.661 Vali Loss: 2.820 Vali Acc: 0.540 Test Loss: 2.820 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1828527
	speed: 0.2210s/iter; left time: 2973.3565s
Epoch: 13 cost time: 7.705702543258667
Epoch: 13, Steps: 154 | Train Loss: 0.593 Vali Loss: 2.989 Vali Acc: 0.500 Test Loss: 2.989 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.4678070
	speed: 0.2213s/iter; left time: 2943.3390s
Epoch: 14 cost time: 8.00071120262146
Epoch: 14, Steps: 154 | Train Loss: 0.593 Vali Loss: 2.935 Vali Acc: 0.491 Test Loss: 2.935 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.3760394
	speed: 0.2205s/iter; left time: 2898.7182s
Epoch: 15 cost time: 7.837145090103149
Epoch: 15, Steps: 154 | Train Loss: 0.528 Vali Loss: 2.956 Vali Acc: 0.525 Test Loss: 2.956 Test Acc: 0.525
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.4501216
	speed: 0.2275s/iter; left time: 2955.0368s
Epoch: 16 cost time: 8.130566835403442
Epoch: 16, Steps: 154 | Train Loss: 0.549 Vali Loss: 3.081 Vali Acc: 0.502 Test Loss: 3.081 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9590569
	speed: 0.2353s/iter; left time: 3020.0929s
Epoch: 17 cost time: 7.8915016651153564
Epoch: 17, Steps: 154 | Train Loss: 0.510 Vali Loss: 3.197 Vali Acc: 0.541 Test Loss: 3.197 Test Acc: 0.541
Validation loss decreased (-0.540524 --> -0.541331).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3686758
	speed: 0.2214s/iter; left time: 2808.1379s
Epoch: 18 cost time: 6.2575132846832275
Epoch: 18, Steps: 154 | Train Loss: 0.424 Vali Loss: 3.622 Vali Acc: 0.479 Test Loss: 3.622 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.3044005
	speed: 0.2311s/iter; left time: 2896.0144s
Epoch: 19 cost time: 6.8372321128845215
Epoch: 19, Steps: 154 | Train Loss: 0.434 Vali Loss: 3.431 Vali Acc: 0.526 Test Loss: 3.431 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.4598533
	speed: 0.2283s/iter; left time: 2824.8063s
Epoch: 20 cost time: 7.350952863693237
Epoch: 20, Steps: 154 | Train Loss: 0.345 Vali Loss: 3.377 Vali Acc: 0.526 Test Loss: 3.377 Test Acc: 0.526
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.5513335
	speed: 0.2354s/iter; left time: 2876.5691s
Epoch: 21 cost time: 7.472442388534546
Epoch: 21, Steps: 154 | Train Loss: 0.380 Vali Loss: 3.604 Vali Acc: 0.524 Test Loss: 3.604 Test Acc: 0.524
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.3907100
	speed: 0.2314s/iter; left time: 2792.7563s
Epoch: 22 cost time: 7.33315634727478
Epoch: 22, Steps: 154 | Train Loss: 0.383 Vali Loss: 3.499 Vali Acc: 0.528 Test Loss: 3.499 Test Acc: 0.528
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2273669
	speed: 0.2336s/iter; left time: 2782.6506s
Epoch: 23 cost time: 7.066094875335693
Epoch: 23, Steps: 154 | Train Loss: 0.318 Vali Loss: 3.781 Vali Acc: 0.506 Test Loss: 3.781 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 1.1186609
	speed: 0.2129s/iter; left time: 2503.6124s
Epoch: 24 cost time: 7.240340948104858
Epoch: 24, Steps: 154 | Train Loss: 0.324 Vali Loss: 3.740 Vali Acc: 0.504 Test Loss: 3.740 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.3289747
	speed: 0.2471s/iter; left time: 2867.5524s
Epoch: 25 cost time: 7.0707786083221436
Epoch: 25, Steps: 154 | Train Loss: 0.313 Vali Loss: 3.826 Vali Acc: 0.469 Test Loss: 3.826 Test Acc: 0.469
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.4307926
	speed: 0.2308s/iter; left time: 2643.4191s
Epoch: 26 cost time: 7.8700480461120605
Epoch: 26, Steps: 154 | Train Loss: 0.324 Vali Loss: 3.645 Vali Acc: 0.517 Test Loss: 3.645 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.1582814
	speed: 0.2211s/iter; left time: 2498.2033s
Epoch: 27 cost time: 7.243020296096802
Epoch: 27, Steps: 154 | Train Loss: 0.292 Vali Loss: 3.942 Vali Acc: 0.533 Test Loss: 3.942 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5413625304136253
model parameter : 229646
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5262449
	speed: 0.0697s/iter; left time: 1065.7560s
Epoch: 1 cost time: 8.849817037582397
Epoch: 1, Steps: 154 | Train Loss: 2.106 Vali Loss: 1.851 Vali Acc: 0.385 Test Loss: 1.851 Test Acc: 0.385
Validation loss decreased (inf --> -0.385221).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1082952
	speed: 0.2132s/iter; left time: 3229.3159s
Epoch: 2 cost time: 5.999727249145508
Epoch: 2, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.006 Vali Acc: 0.461 Test Loss: 2.006 Test Acc: 0.461
Validation loss decreased (-0.385221 --> -0.461051).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2730147
	speed: 0.2068s/iter; left time: 3101.1806s
Epoch: 3 cost time: 6.247982978820801
Epoch: 3, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.099 Vali Acc: 0.474 Test Loss: 2.099 Test Acc: 0.474
Validation loss decreased (-0.461051 --> -0.474432).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2067196
	speed: 0.2233s/iter; left time: 3313.8840s
Epoch: 4 cost time: 6.3813910484313965
Epoch: 4, Steps: 154 | Train Loss: 1.181 Vali Loss: 1.922 Vali Acc: 0.496 Test Loss: 1.922 Test Acc: 0.496
Validation loss decreased (-0.474432 --> -0.496331).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7342001
	speed: 0.2233s/iter; left time: 3278.4775s
Epoch: 5 cost time: 6.407044410705566
Epoch: 5, Steps: 154 | Train Loss: 1.123 Vali Loss: 2.190 Vali Acc: 0.506 Test Loss: 2.190 Test Acc: 0.506
Validation loss decreased (-0.496331 --> -0.506466).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9381841
	speed: 0.2143s/iter; left time: 3113.2719s
Epoch: 6 cost time: 6.011831283569336
Epoch: 6, Steps: 154 | Train Loss: 1.058 Vali Loss: 2.225 Vali Acc: 0.469 Test Loss: 2.225 Test Acc: 0.469
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8530655
	speed: 0.2134s/iter; left time: 3068.6203s
Epoch: 7 cost time: 5.533479452133179
Epoch: 7, Steps: 154 | Train Loss: 0.965 Vali Loss: 2.469 Vali Acc: 0.469 Test Loss: 2.469 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7639486
	speed: 0.2088s/iter; left time: 2969.9742s
Epoch: 8 cost time: 7.395520925521851
Epoch: 8, Steps: 154 | Train Loss: 0.907 Vali Loss: 2.379 Vali Acc: 0.493 Test Loss: 2.379 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5265570
	speed: 0.2294s/iter; left time: 3226.9921s
Epoch: 9 cost time: 5.809226036071777
Epoch: 9, Steps: 154 | Train Loss: 0.857 Vali Loss: 2.190 Vali Acc: 0.541 Test Loss: 2.190 Test Acc: 0.541
Validation loss decreased (-0.506466 --> -0.540530).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6224847
	speed: 0.2311s/iter; left time: 3216.1536s
Epoch: 10 cost time: 7.174370050430298
Epoch: 10, Steps: 154 | Train Loss: 0.767 Vali Loss: 2.698 Vali Acc: 0.489 Test Loss: 2.698 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.6908645
	speed: 0.2150s/iter; left time: 2958.4796s
Epoch: 11 cost time: 5.986844062805176
Epoch: 11, Steps: 154 | Train Loss: 0.680 Vali Loss: 2.459 Vali Acc: 0.536 Test Loss: 2.459 Test Acc: 0.536
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1306108
	speed: 0.2368s/iter; left time: 3221.9785s
Epoch: 12 cost time: 6.617546319961548
Epoch: 12, Steps: 154 | Train Loss: 0.656 Vali Loss: 2.677 Vali Acc: 0.470 Test Loss: 2.677 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3468172
	speed: 0.1988s/iter; left time: 2674.5697s
Epoch: 13 cost time: 6.392600774765015
Epoch: 13, Steps: 154 | Train Loss: 0.590 Vali Loss: 2.856 Vali Acc: 0.535 Test Loss: 2.856 Test Acc: 0.535
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.4891295
	speed: 0.2344s/iter; left time: 3116.8824s
Epoch: 14 cost time: 6.6031341552734375
Epoch: 14, Steps: 154 | Train Loss: 0.596 Vali Loss: 2.637 Vali Acc: 0.531 Test Loss: 2.637 Test Acc: 0.531
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.7897314
	speed: 0.2139s/iter; left time: 2811.5183s
Epoch: 15 cost time: 6.599342584609985
Epoch: 15, Steps: 154 | Train Loss: 0.505 Vali Loss: 2.652 Vali Acc: 0.511 Test Loss: 2.652 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1371617
	speed: 0.1773s/iter; left time: 2302.9968s
Epoch: 16 cost time: 5.12200927734375
Epoch: 16, Steps: 154 | Train Loss: 0.480 Vali Loss: 2.823 Vali Acc: 0.527 Test Loss: 2.823 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2040876
	speed: 0.1730s/iter; left time: 2220.4648s
Epoch: 17 cost time: 4.973548412322998
Epoch: 17, Steps: 154 | Train Loss: 0.482 Vali Loss: 3.022 Vali Acc: 0.497 Test Loss: 3.022 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5833988
	speed: 0.1757s/iter; left time: 2228.0154s
Epoch: 18 cost time: 6.105844020843506
Epoch: 18, Steps: 154 | Train Loss: 0.420 Vali Loss: 3.229 Vali Acc: 0.485 Test Loss: 3.229 Test Acc: 0.485
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.4357289
	speed: 0.1732s/iter; left time: 2169.4643s
Epoch: 19 cost time: 5.436747074127197
Epoch: 19, Steps: 154 | Train Loss: 0.445 Vali Loss: 2.982 Vali Acc: 0.526 Test Loss: 2.982 Test Acc: 0.526
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.540551500405515
model parameter : 197646
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8149494
	speed: 0.0636s/iter; left time: 972.7086s
Epoch: 1 cost time: 7.905769109725952
Epoch: 1, Steps: 154 | Train Loss: 2.115 Vali Loss: 1.913 Vali Acc: 0.401 Test Loss: 1.913 Test Acc: 0.401
Validation loss decreased (inf --> -0.400630).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2338207
	speed: 0.1866s/iter; left time: 2826.2880s
Epoch: 2 cost time: 5.524503946304321
Epoch: 2, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.345 Vali Acc: 0.416 Test Loss: 2.345 Test Acc: 0.416
Validation loss decreased (-0.400630 --> -0.416440).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8343711
	speed: 0.2016s/iter; left time: 3022.6987s
Epoch: 3 cost time: 5.563562870025635
Epoch: 3, Steps: 154 | Train Loss: 1.264 Vali Loss: 1.940 Vali Acc: 0.463 Test Loss: 1.940 Test Acc: 0.463
Validation loss decreased (-0.416440 --> -0.462673).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4670112
	speed: 0.1949s/iter; left time: 2891.6428s
Epoch: 4 cost time: 5.482824087142944
Epoch: 4, Steps: 154 | Train Loss: 1.162 Vali Loss: 2.013 Vali Acc: 0.466 Test Loss: 2.013 Test Acc: 0.466
Validation loss decreased (-0.462673 --> -0.465917).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1439402
	speed: 0.2070s/iter; left time: 3039.7875s
Epoch: 5 cost time: 5.971686124801636
Epoch: 5, Steps: 154 | Train Loss: 1.100 Vali Loss: 2.326 Vali Acc: 0.491 Test Loss: 2.326 Test Acc: 0.491
Validation loss decreased (-0.465917 --> -0.491461).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0885757
	speed: 0.2048s/iter; left time: 2976.5618s
Epoch: 6 cost time: 5.638376951217651
Epoch: 6, Steps: 154 | Train Loss: 1.057 Vali Loss: 2.247 Vali Acc: 0.474 Test Loss: 2.247 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7247100
	speed: 0.1978s/iter; left time: 2844.1399s
Epoch: 7 cost time: 5.8465142250061035
Epoch: 7, Steps: 154 | Train Loss: 0.996 Vali Loss: 2.300 Vali Acc: 0.497 Test Loss: 2.300 Test Acc: 0.497
Validation loss decreased (-0.491461 --> -0.497138).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8479520
	speed: 0.1909s/iter; left time: 2715.6237s
Epoch: 8 cost time: 5.287399530410767
Epoch: 8, Steps: 154 | Train Loss: 0.931 Vali Loss: 2.518 Vali Acc: 0.466 Test Loss: 2.518 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0501053
	speed: 0.2002s/iter; left time: 2816.5457s
Epoch: 9 cost time: 5.689924001693726
Epoch: 9, Steps: 154 | Train Loss: 0.891 Vali Loss: 2.350 Vali Acc: 0.481 Test Loss: 2.350 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7211796
	speed: 0.2096s/iter; left time: 2915.9449s
Epoch: 10 cost time: 5.894006013870239
Epoch: 10, Steps: 154 | Train Loss: 0.855 Vali Loss: 2.294 Vali Acc: 0.468 Test Loss: 2.294 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8690571
	speed: 0.2187s/iter; left time: 3009.4293s
Epoch: 11 cost time: 6.7106404304504395
Epoch: 11, Steps: 154 | Train Loss: 0.776 Vali Loss: 2.487 Vali Acc: 0.491 Test Loss: 2.487 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.9431860
	speed: 0.2170s/iter; left time: 2952.8896s
Epoch: 12 cost time: 6.049581527709961
Epoch: 12, Steps: 154 | Train Loss: 0.746 Vali Loss: 2.822 Vali Acc: 0.467 Test Loss: 2.822 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1662999
	speed: 0.2039s/iter; left time: 2743.5642s
Epoch: 13 cost time: 5.625082015991211
Epoch: 13, Steps: 154 | Train Loss: 0.690 Vali Loss: 2.609 Vali Acc: 0.519 Test Loss: 2.609 Test Acc: 0.519
Validation loss decreased (-0.497138 --> -0.519033).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5039940
	speed: 0.1996s/iter; left time: 2654.5972s
Epoch: 14 cost time: 5.168343782424927
Epoch: 14, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.683 Vali Acc: 0.530 Test Loss: 2.683 Test Acc: 0.530
Validation loss decreased (-0.519033 --> -0.529576).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3940133
	speed: 0.1988s/iter; left time: 2613.6838s
Epoch: 15 cost time: 5.4803760051727295
Epoch: 15, Steps: 154 | Train Loss: 0.572 Vali Loss: 2.986 Vali Acc: 0.484 Test Loss: 2.986 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0805473
	speed: 0.1954s/iter; left time: 2538.3794s
Epoch: 16 cost time: 5.287289619445801
Epoch: 16, Steps: 154 | Train Loss: 0.564 Vali Loss: 2.865 Vali Acc: 0.469 Test Loss: 2.865 Test Acc: 0.469
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.2358686
	speed: 0.1871s/iter; left time: 2402.4383s
Epoch: 17 cost time: 5.237810134887695
Epoch: 17, Steps: 154 | Train Loss: 0.493 Vali Loss: 2.898 Vali Acc: 0.487 Test Loss: 2.898 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.9003888
	speed: 0.1783s/iter; left time: 2261.1663s
Epoch: 18 cost time: 5.752670526504517
Epoch: 18, Steps: 154 | Train Loss: 0.493 Vali Loss: 2.944 Vali Acc: 0.464 Test Loss: 2.944 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.1596304
	speed: 0.1921s/iter; left time: 2406.6480s
Epoch: 19 cost time: 5.67385458946228
Epoch: 19, Steps: 154 | Train Loss: 0.443 Vali Loss: 2.905 Vali Acc: 0.512 Test Loss: 2.905 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.5007204
	speed: 0.1863s/iter; left time: 2305.0280s
Epoch: 20 cost time: 4.918983221054077
Epoch: 20, Steps: 154 | Train Loss: 0.429 Vali Loss: 3.013 Vali Acc: 0.497 Test Loss: 3.013 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1136680
	speed: 0.1830s/iter; left time: 2236.1597s
Epoch: 21 cost time: 5.752574682235718
Epoch: 21, Steps: 154 | Train Loss: 0.405 Vali Loss: 3.089 Vali Acc: 0.497 Test Loss: 3.089 Test Acc: 0.497
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.3777639
	speed: 0.1924s/iter; left time: 2321.8802s
Epoch: 22 cost time: 5.615529298782349
Epoch: 22, Steps: 154 | Train Loss: 0.397 Vali Loss: 3.344 Vali Acc: 0.476 Test Loss: 3.344 Test Acc: 0.476
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.2292381
	speed: 0.2043s/iter; left time: 2434.1070s
Epoch: 23 cost time: 6.297074556350708
Epoch: 23, Steps: 154 | Train Loss: 0.358 Vali Loss: 3.379 Vali Acc: 0.504 Test Loss: 3.379 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.1557036
	speed: 0.1943s/iter; left time: 2284.7371s
Epoch: 24 cost time: 5.662745714187622
Epoch: 24, Steps: 154 | Train Loss: 0.365 Vali Loss: 3.473 Vali Acc: 0.527 Test Loss: 3.473 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5296025952960259
model parameter : 176270
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6323225
	speed: 0.0488s/iter; left time: 746.4899s
Epoch: 1 cost time: 7.151808023452759
Epoch: 1, Steps: 154 | Train Loss: 2.115 Vali Loss: 2.327 Vali Acc: 0.439 Test Loss: 2.327 Test Acc: 0.439
Validation loss decreased (inf --> -0.438744).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3655223
	speed: 0.1977s/iter; left time: 2995.0052s
Epoch: 2 cost time: 6.479355812072754
Epoch: 2, Steps: 154 | Train Loss: 1.857 Vali Loss: 3.010 Vali Acc: 0.415 Test Loss: 3.010 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.3347591
	speed: 0.2004s/iter; left time: 3005.2353s
Epoch: 3 cost time: 7.452222108840942
Epoch: 3, Steps: 154 | Train Loss: 1.723 Vali Loss: 3.432 Vali Acc: 0.354 Test Loss: 3.432 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.8264896
	speed: 0.2171s/iter; left time: 3221.7201s
Epoch: 4 cost time: 7.267099857330322
Epoch: 4, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.925 Vali Acc: 0.450 Test Loss: 2.925 Test Acc: 0.450
Validation loss decreased (-0.438744 --> -0.449687).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9166810
	speed: 0.2074s/iter; left time: 3046.3379s
Epoch: 5 cost time: 7.318137884140015
Epoch: 5, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.981 Vali Acc: 0.413 Test Loss: 2.981 Test Acc: 0.413
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1686879
	speed: 0.2129s/iter; left time: 3093.4660s
Epoch: 6 cost time: 7.023922443389893
Epoch: 6, Steps: 154 | Train Loss: 1.391 Vali Loss: 3.933 Vali Acc: 0.423 Test Loss: 3.933 Test Acc: 0.423
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4403609
	speed: 0.2182s/iter; left time: 3136.9397s
Epoch: 7 cost time: 7.097476005554199
Epoch: 7, Steps: 154 | Train Loss: 1.257 Vali Loss: 4.307 Vali Acc: 0.431 Test Loss: 4.307 Test Acc: 0.431
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.9163607
	speed: 0.2117s/iter; left time: 3010.7491s
Epoch: 8 cost time: 7.290926694869995
Epoch: 8, Steps: 154 | Train Loss: 1.170 Vali Loss: 4.761 Vali Acc: 0.427 Test Loss: 4.761 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7618383
	speed: 0.2323s/iter; left time: 3268.5564s
Epoch: 9 cost time: 7.748721122741699
Epoch: 9, Steps: 154 | Train Loss: 1.040 Vali Loss: 5.034 Vali Acc: 0.430 Test Loss: 5.034 Test Acc: 0.430
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.9086093
	speed: 0.2166s/iter; left time: 3014.4731s
Epoch: 10 cost time: 7.283713102340698
Epoch: 10, Steps: 154 | Train Loss: 0.917 Vali Loss: 4.410 Vali Acc: 0.466 Test Loss: 4.410 Test Acc: 0.466
Validation loss decreased (-0.449687 --> -0.465487).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7099579
	speed: 0.2240s/iter; left time: 3083.0142s
Epoch: 11 cost time: 7.566359996795654
Epoch: 11, Steps: 154 | Train Loss: 0.833 Vali Loss: 5.149 Vali Acc: 0.444 Test Loss: 5.149 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9121319
	speed: 0.2174s/iter; left time: 2958.2397s
Epoch: 12 cost time: 7.2975172996521
Epoch: 12, Steps: 154 | Train Loss: 0.748 Vali Loss: 5.677 Vali Acc: 0.434 Test Loss: 5.677 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5365735
	speed: 0.2160s/iter; left time: 2906.4781s
Epoch: 13 cost time: 7.744657278060913
Epoch: 13, Steps: 154 | Train Loss: 0.715 Vali Loss: 6.723 Vali Acc: 0.410 Test Loss: 6.723 Test Acc: 0.410
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8283779
	speed: 0.2002s/iter; left time: 2663.0056s
Epoch: 14 cost time: 6.557990789413452
Epoch: 14, Steps: 154 | Train Loss: 0.719 Vali Loss: 7.090 Vali Acc: 0.412 Test Loss: 7.090 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.5116618
	speed: 0.1973s/iter; left time: 2594.0902s
Epoch: 15 cost time: 5.85430121421814
Epoch: 15, Steps: 154 | Train Loss: 0.673 Vali Loss: 6.185 Vali Acc: 0.416 Test Loss: 6.185 Test Acc: 0.416
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.7393876
	speed: 0.1851s/iter; left time: 2404.7513s
Epoch: 16 cost time: 5.31270694732666
Epoch: 16, Steps: 154 | Train Loss: 0.531 Vali Loss: 6.629 Vali Acc: 0.414 Test Loss: 6.629 Test Acc: 0.414
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6693203
	speed: 0.1907s/iter; left time: 2448.3493s
Epoch: 17 cost time: 6.291418075561523
Epoch: 17, Steps: 154 | Train Loss: 0.528 Vali Loss: 6.916 Vali Acc: 0.387 Test Loss: 6.916 Test Acc: 0.387
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3306718
	speed: 0.1984s/iter; left time: 2515.9327s
Epoch: 18 cost time: 6.136987924575806
Epoch: 18, Steps: 154 | Train Loss: 0.439 Vali Loss: 6.608 Vali Acc: 0.429 Test Loss: 6.608 Test Acc: 0.429
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.7860991
	speed: 0.1974s/iter; left time: 2473.5959s
Epoch: 19 cost time: 5.535490274429321
Epoch: 19, Steps: 154 | Train Loss: 0.513 Vali Loss: 7.765 Vali Acc: 0.413 Test Loss: 7.765 Test Acc: 0.413
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.3317688
	speed: 0.1864s/iter; left time: 2306.7115s
Epoch: 20 cost time: 5.464864730834961
Epoch: 20, Steps: 154 | Train Loss: 0.447 Vali Loss: 7.605 Vali Acc: 0.433 Test Loss: 7.605 Test Acc: 0.433
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.46553122465531227
model parameter : 470734
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.2044123
	speed: 0.0608s/iter; left time: 930.1392s
Epoch: 1 cost time: 7.480411052703857
Epoch: 1, Steps: 154 | Train Loss: 2.006 Vali Loss: 1.717 Vali Acc: 0.457 Test Loss: 1.717 Test Acc: 0.457
Validation loss decreased (inf --> -0.456998).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2080553
	speed: 0.1709s/iter; left time: 2588.4699s
Epoch: 2 cost time: 5.719986915588379
Epoch: 2, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.111 Vali Acc: 0.485 Test Loss: 2.111 Test Acc: 0.485
Validation loss decreased (-0.456998 --> -0.484975).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2788581
	speed: 0.1756s/iter; left time: 2632.9566s
Epoch: 3 cost time: 5.542184829711914
Epoch: 3, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.420 Vali Acc: 0.410 Test Loss: 2.420 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.7036040
	speed: 0.1898s/iter; left time: 2816.3972s
Epoch: 4 cost time: 6.161039352416992
Epoch: 4, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.490 Vali Acc: 0.508 Test Loss: 2.490 Test Acc: 0.508
Validation loss decreased (-0.484975 --> -0.508085).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0773907
	speed: 0.1935s/iter; left time: 2841.0386s
Epoch: 5 cost time: 6.892813444137573
Epoch: 5, Steps: 154 | Train Loss: 1.242 Vali Loss: 2.850 Vali Acc: 0.397 Test Loss: 2.850 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7545146
	speed: 0.2079s/iter; left time: 3020.8131s
Epoch: 6 cost time: 6.74989914894104
Epoch: 6, Steps: 154 | Train Loss: 1.193 Vali Loss: 2.479 Vali Acc: 0.456 Test Loss: 2.479 Test Acc: 0.456
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0630000
	speed: 0.2224s/iter; left time: 3197.7244s
Epoch: 7 cost time: 7.3569886684417725
Epoch: 7, Steps: 154 | Train Loss: 1.084 Vali Loss: 2.648 Vali Acc: 0.448 Test Loss: 2.648 Test Acc: 0.448
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3339989
	speed: 0.2266s/iter; left time: 3222.3362s
Epoch: 8 cost time: 7.719322919845581
Epoch: 8, Steps: 154 | Train Loss: 0.989 Vali Loss: 3.177 Vali Acc: 0.415 Test Loss: 3.177 Test Acc: 0.415
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9047172
	speed: 0.2208s/iter; left time: 3106.7502s
Epoch: 9 cost time: 6.424771308898926
Epoch: 9, Steps: 154 | Train Loss: 0.887 Vali Loss: 3.480 Vali Acc: 0.470 Test Loss: 3.480 Test Acc: 0.470
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.9880109
	speed: 0.2113s/iter; left time: 2939.9184s
Epoch: 10 cost time: 7.292940139770508
Epoch: 10, Steps: 154 | Train Loss: 0.840 Vali Loss: 3.069 Vali Acc: 0.530 Test Loss: 3.069 Test Acc: 0.530
Validation loss decreased (-0.508085 --> -0.530383).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0323360
	speed: 0.2223s/iter; left time: 3059.6770s
Epoch: 11 cost time: 6.837163686752319
Epoch: 11, Steps: 154 | Train Loss: 0.761 Vali Loss: 3.527 Vali Acc: 0.488 Test Loss: 3.527 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5395575
	speed: 0.2137s/iter; left time: 2908.3360s
Epoch: 12 cost time: 7.206486225128174
Epoch: 12, Steps: 154 | Train Loss: 0.663 Vali Loss: 3.659 Vali Acc: 0.436 Test Loss: 3.659 Test Acc: 0.436
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7793512
	speed: 0.2089s/iter; left time: 2810.9460s
Epoch: 13 cost time: 7.229565858840942
Epoch: 13, Steps: 154 | Train Loss: 0.684 Vali Loss: 3.847 Vali Acc: 0.464 Test Loss: 3.847 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7150420
	speed: 0.2005s/iter; left time: 2666.9501s
Epoch: 14 cost time: 7.067261219024658
Epoch: 14, Steps: 154 | Train Loss: 0.644 Vali Loss: 3.509 Vali Acc: 0.498 Test Loss: 3.509 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.4602430
	speed: 0.2062s/iter; left time: 2711.1501s
Epoch: 15 cost time: 6.833418846130371
Epoch: 15, Steps: 154 | Train Loss: 0.563 Vali Loss: 3.619 Vali Acc: 0.505 Test Loss: 3.619 Test Acc: 0.505
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4201195
	speed: 0.2051s/iter; left time: 2664.7149s
Epoch: 16 cost time: 7.244452714920044
Epoch: 16, Steps: 154 | Train Loss: 0.553 Vali Loss: 4.028 Vali Acc: 0.501 Test Loss: 4.028 Test Acc: 0.501
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.5315355
	speed: 0.1805s/iter; left time: 2316.6744s
Epoch: 17 cost time: 5.399042367935181
Epoch: 17, Steps: 154 | Train Loss: 0.495 Vali Loss: 3.960 Vali Acc: 0.545 Test Loss: 3.960 Test Acc: 0.545
Validation loss decreased (-0.530383 --> -0.545378).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4930392
	speed: 0.1892s/iter; left time: 2399.6906s
Epoch: 18 cost time: 6.244642496109009
Epoch: 18, Steps: 154 | Train Loss: 0.442 Vali Loss: 4.217 Vali Acc: 0.508 Test Loss: 4.217 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5885699
	speed: 0.1954s/iter; left time: 2448.3970s
Epoch: 19 cost time: 6.883467435836792
Epoch: 19, Steps: 154 | Train Loss: 0.432 Vali Loss: 4.170 Vali Acc: 0.543 Test Loss: 4.170 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1417908
	speed: 0.2117s/iter; left time: 2619.5898s
Epoch: 20 cost time: 5.930510520935059
Epoch: 20, Steps: 154 | Train Loss: 0.376 Vali Loss: 4.573 Vali Acc: 0.477 Test Loss: 4.573 Test Acc: 0.477
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.6546932
	speed: 0.1970s/iter; left time: 2406.9722s
Epoch: 21 cost time: 6.359202861785889
Epoch: 21, Steps: 154 | Train Loss: 0.406 Vali Loss: 4.189 Vali Acc: 0.504 Test Loss: 4.189 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.1706345
	speed: 0.2054s/iter; left time: 2478.0661s
Epoch: 22 cost time: 6.026011228561401
Epoch: 22, Steps: 154 | Train Loss: 0.385 Vali Loss: 4.622 Vali Acc: 0.502 Test Loss: 4.622 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2439548
	speed: 0.2094s/iter; left time: 2494.2293s
Epoch: 23 cost time: 7.02183198928833
Epoch: 23, Steps: 154 | Train Loss: 0.321 Vali Loss: 4.446 Vali Acc: 0.501 Test Loss: 4.446 Test Acc: 0.501
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0315753
	speed: 0.1974s/iter; left time: 2321.3486s
Epoch: 24 cost time: 5.759078741073608
Epoch: 24, Steps: 154 | Train Loss: 0.317 Vali Loss: 4.559 Vali Acc: 0.481 Test Loss: 4.559 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.8340608
	speed: 0.1849s/iter; left time: 2145.7291s
Epoch: 25 cost time: 7.190447568893433
Epoch: 25, Steps: 154 | Train Loss: 0.335 Vali Loss: 5.074 Vali Acc: 0.500 Test Loss: 5.074 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1435734
	speed: 0.1911s/iter; left time: 2188.3991s
Epoch: 26 cost time: 5.547307729721069
Epoch: 26, Steps: 154 | Train Loss: 0.306 Vali Loss: 4.801 Vali Acc: 0.476 Test Loss: 4.801 Test Acc: 0.476
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.3914219
	speed: 0.1820s/iter; left time: 2056.0223s
Epoch: 27 cost time: 6.802225351333618
Epoch: 27, Steps: 154 | Train Loss: 0.301 Vali Loss: 4.677 Vali Acc: 0.499 Test Loss: 4.677 Test Acc: 0.499
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5454176804541768
model parameter : 277326
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1652312
	speed: 0.0738s/iter; left time: 1128.6269s
Epoch: 1 cost time: 8.75052261352539
Epoch: 1, Steps: 154 | Train Loss: 1.971 Vali Loss: 1.822 Vali Acc: 0.478 Test Loss: 1.822 Test Acc: 0.478
Validation loss decreased (inf --> -0.478084).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5566024
	speed: 0.2452s/iter; left time: 3713.8946s
Epoch: 2 cost time: 9.159793376922607
Epoch: 2, Steps: 154 | Train Loss: 1.486 Vali Loss: 1.852 Vali Acc: 0.518 Test Loss: 1.852 Test Acc: 0.518
Validation loss decreased (-0.478084 --> -0.518230).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7499771
	speed: 0.2751s/iter; left time: 4124.3969s
Epoch: 3 cost time: 11.179411172866821
Epoch: 3, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.086 Vali Acc: 0.484 Test Loss: 2.086 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8018700
	speed: 0.3285s/iter; left time: 4873.9571s
Epoch: 4 cost time: 13.2890784740448
Epoch: 4, Steps: 154 | Train Loss: 1.288 Vali Loss: 2.660 Vali Acc: 0.440 Test Loss: 2.660 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0263507
	speed: 0.3218s/iter; left time: 4726.3268s
Epoch: 5 cost time: 10.841912746429443
Epoch: 5, Steps: 154 | Train Loss: 1.241 Vali Loss: 2.278 Vali Acc: 0.481 Test Loss: 2.278 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.6533407
	speed: 0.3218s/iter; left time: 4675.9207s
Epoch: 6 cost time: 11.616289377212524
Epoch: 6, Steps: 154 | Train Loss: 1.197 Vali Loss: 2.725 Vali Acc: 0.431 Test Loss: 2.725 Test Acc: 0.431
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.2677070
	speed: 0.3159s/iter; left time: 4541.0008s
Epoch: 7 cost time: 9.684281826019287
Epoch: 7, Steps: 154 | Train Loss: 1.130 Vali Loss: 2.663 Vali Acc: 0.552 Test Loss: 2.663 Test Acc: 0.552
Validation loss decreased (-0.518230 --> -0.551474).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8804861
	speed: 0.3059s/iter; left time: 4351.2341s
Epoch: 8 cost time: 11.873213052749634
Epoch: 8, Steps: 154 | Train Loss: 1.022 Vali Loss: 2.669 Vali Acc: 0.499 Test Loss: 2.669 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0160803
	speed: 0.3242s/iter; left time: 4561.2021s
Epoch: 9 cost time: 10.712454080581665
Epoch: 9, Steps: 154 | Train Loss: 0.886 Vali Loss: 3.143 Vali Acc: 0.509 Test Loss: 3.143 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9533490
	speed: 0.3065s/iter; left time: 4265.4532s
Epoch: 10 cost time: 10.843040943145752
Epoch: 10, Steps: 154 | Train Loss: 0.823 Vali Loss: 3.157 Vali Acc: 0.491 Test Loss: 3.157 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6667324
	speed: 0.3055s/iter; left time: 4203.4984s
Epoch: 11 cost time: 10.677150249481201
Epoch: 11, Steps: 154 | Train Loss: 0.755 Vali Loss: 2.873 Vali Acc: 0.513 Test Loss: 2.873 Test Acc: 0.513
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1990268
	speed: 0.3018s/iter; left time: 4107.0826s
Epoch: 12 cost time: 11.65173602104187
Epoch: 12, Steps: 154 | Train Loss: 0.689 Vali Loss: 3.146 Vali Acc: 0.475 Test Loss: 3.146 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.7398087
	speed: 0.2958s/iter; left time: 3979.4352s
Epoch: 13 cost time: 9.858788967132568
Epoch: 13, Steps: 154 | Train Loss: 0.598 Vali Loss: 3.465 Vali Acc: 0.472 Test Loss: 3.465 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5539851
	speed: 0.2785s/iter; left time: 3703.3814s
Epoch: 14 cost time: 10.825156688690186
Epoch: 14, Steps: 154 | Train Loss: 0.590 Vali Loss: 3.434 Vali Acc: 0.482 Test Loss: 3.434 Test Acc: 0.482
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2103815
	speed: 0.3010s/iter; left time: 3956.6717s
Epoch: 15 cost time: 8.310822486877441
Epoch: 15, Steps: 154 | Train Loss: 0.548 Vali Loss: 3.136 Vali Acc: 0.485 Test Loss: 3.136 Test Acc: 0.485
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.6957151
	speed: 0.2427s/iter; left time: 3152.4961s
Epoch: 16 cost time: 7.889072418212891
Epoch: 16, Steps: 154 | Train Loss: 0.499 Vali Loss: 3.557 Vali Acc: 0.540 Test Loss: 3.557 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.5602435
	speed: 0.2369s/iter; left time: 3041.0027s
Epoch: 17 cost time: 7.027052164077759
Epoch: 17, Steps: 154 | Train Loss: 0.488 Vali Loss: 3.384 Vali Acc: 0.508 Test Loss: 3.384 Test Acc: 0.508
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.551500405515004
model parameter : 277454
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.3949986
	speed: 0.0707s/iter; left time: 1081.2491s
Epoch: 1 cost time: 9.249109029769897
Epoch: 1, Steps: 154 | Train Loss: 1.991 Vali Loss: 1.981 Vali Acc: 0.414 Test Loss: 1.981 Test Acc: 0.414
Validation loss decreased (inf --> -0.414011).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9835169
	speed: 0.2240s/iter; left time: 3393.1938s
Epoch: 2 cost time: 6.745581865310669
Epoch: 2, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.055 Vali Acc: 0.459 Test Loss: 2.055 Test Acc: 0.459
Validation loss decreased (-0.414011 --> -0.459022).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9958435
	speed: 0.2216s/iter; left time: 3322.6670s
Epoch: 3 cost time: 6.645215272903442
Epoch: 3, Steps: 154 | Train Loss: 1.303 Vali Loss: 1.997 Vali Acc: 0.515 Test Loss: 1.997 Test Acc: 0.515
Validation loss decreased (-0.459022 --> -0.514579).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6742659
	speed: 0.2381s/iter; left time: 3532.7914s
Epoch: 4 cost time: 6.898617744445801
Epoch: 4, Steps: 154 | Train Loss: 1.218 Vali Loss: 2.077 Vali Acc: 0.526 Test Loss: 2.077 Test Acc: 0.526
Validation loss decreased (-0.514579 --> -0.525932).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5965706
	speed: 0.2278s/iter; left time: 3345.8044s
Epoch: 5 cost time: 7.478240966796875
Epoch: 5, Steps: 154 | Train Loss: 1.165 Vali Loss: 2.399 Vali Acc: 0.483 Test Loss: 2.399 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9564117
	speed: 0.2236s/iter; left time: 3249.7034s
Epoch: 6 cost time: 6.979604482650757
Epoch: 6, Steps: 154 | Train Loss: 1.132 Vali Loss: 2.331 Vali Acc: 0.479 Test Loss: 2.331 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0548382
	speed: 0.2208s/iter; left time: 3174.2073s
Epoch: 7 cost time: 8.225667238235474
Epoch: 7, Steps: 154 | Train Loss: 1.014 Vali Loss: 2.526 Vali Acc: 0.497 Test Loss: 2.526 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.5820258
	speed: 0.2483s/iter; left time: 3532.1774s
Epoch: 8 cost time: 8.712312936782837
Epoch: 8, Steps: 154 | Train Loss: 0.930 Vali Loss: 2.686 Vali Acc: 0.529 Test Loss: 2.686 Test Acc: 0.529
Validation loss decreased (-0.525932 --> -0.529170).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7324854
	speed: 0.2465s/iter; left time: 3468.0251s
Epoch: 9 cost time: 9.05471158027649
Epoch: 9, Steps: 154 | Train Loss: 0.858 Vali Loss: 2.975 Vali Acc: 0.484 Test Loss: 2.975 Test Acc: 0.484
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.8112011
	speed: 0.2564s/iter; left time: 3568.0934s
Epoch: 10 cost time: 8.26779317855835
Epoch: 10, Steps: 154 | Train Loss: 0.780 Vali Loss: 2.499 Vali Acc: 0.470 Test Loss: 2.499 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5209455
	speed: 0.2510s/iter; left time: 3454.6732s
Epoch: 11 cost time: 8.891525745391846
Epoch: 11, Steps: 154 | Train Loss: 0.739 Vali Loss: 2.917 Vali Acc: 0.493 Test Loss: 2.917 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.3782885
	speed: 0.2651s/iter; left time: 3606.9381s
Epoch: 12 cost time: 8.540514945983887
Epoch: 12, Steps: 154 | Train Loss: 0.656 Vali Loss: 2.767 Vali Acc: 0.479 Test Loss: 2.767 Test Acc: 0.479
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.3956761
	speed: 0.2629s/iter; left time: 3536.2223s
Epoch: 13 cost time: 9.169119596481323
Epoch: 13, Steps: 154 | Train Loss: 0.619 Vali Loss: 2.982 Vali Acc: 0.518 Test Loss: 2.982 Test Acc: 0.518
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.3063754
	speed: 0.2550s/iter; left time: 3390.9648s
Epoch: 14 cost time: 7.903237819671631
Epoch: 14, Steps: 154 | Train Loss: 0.571 Vali Loss: 2.812 Vali Acc: 0.484 Test Loss: 2.812 Test Acc: 0.484
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.9032226
	speed: 0.2475s/iter; left time: 3253.4716s
Epoch: 15 cost time: 8.388229846954346
Epoch: 15, Steps: 154 | Train Loss: 0.515 Vali Loss: 2.813 Vali Acc: 0.511 Test Loss: 2.813 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.2152673
	speed: 0.2373s/iter; left time: 3082.6615s
Epoch: 16 cost time: 8.002139329910278
Epoch: 16, Steps: 154 | Train Loss: 0.489 Vali Loss: 3.371 Vali Acc: 0.507 Test Loss: 3.371 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0454060
	speed: 0.2470s/iter; left time: 3170.4220s
Epoch: 17 cost time: 8.609708070755005
Epoch: 17, Steps: 154 | Train Loss: 0.468 Vali Loss: 3.071 Vali Acc: 0.524 Test Loss: 3.071 Test Acc: 0.524
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.3367773
	speed: 0.2457s/iter; left time: 3116.4894s
Epoch: 18 cost time: 7.990369558334351
Epoch: 18, Steps: 154 | Train Loss: 0.433 Vali Loss: 3.104 Vali Acc: 0.526 Test Loss: 3.104 Test Acc: 0.526
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5291970802919708
model parameter : 213198
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0746171
	speed: 0.0720s/iter; left time: 1101.7181s
Epoch: 1 cost time: 9.47665810585022
Epoch: 1, Steps: 154 | Train Loss: 2.101 Vali Loss: 1.919 Vali Acc: 0.384 Test Loss: 1.919 Test Acc: 0.384
Validation loss decreased (inf --> -0.384004).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8977445
	speed: 0.2337s/iter; left time: 3539.4593s
Epoch: 2 cost time: 6.547735929489136
Epoch: 2, Steps: 154 | Train Loss: 1.461 Vali Loss: 1.840 Vali Acc: 0.479 Test Loss: 1.840 Test Acc: 0.479
Validation loss decreased (-0.384004 --> -0.479300).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4327743
	speed: 0.2223s/iter; left time: 3333.1394s
Epoch: 3 cost time: 6.954027414321899
Epoch: 3, Steps: 154 | Train Loss: 1.287 Vali Loss: 1.927 Vali Acc: 0.521 Test Loss: 1.927 Test Acc: 0.521
Validation loss decreased (-0.479300 --> -0.521068).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7755767
	speed: 0.2357s/iter; left time: 3497.8867s
Epoch: 4 cost time: 6.442853212356567
Epoch: 4, Steps: 154 | Train Loss: 1.202 Vali Loss: 2.367 Vali Acc: 0.480 Test Loss: 2.367 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9345828
	speed: 0.2356s/iter; left time: 3460.2991s
Epoch: 5 cost time: 6.692163705825806
Epoch: 5, Steps: 154 | Train Loss: 1.146 Vali Loss: 2.058 Vali Acc: 0.509 Test Loss: 2.058 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0298114
	speed: 0.2383s/iter; left time: 3463.0629s
Epoch: 6 cost time: 7.517151117324829
Epoch: 6, Steps: 154 | Train Loss: 1.057 Vali Loss: 2.719 Vali Acc: 0.481 Test Loss: 2.719 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.0199351
	speed: 0.2294s/iter; left time: 3298.0286s
Epoch: 7 cost time: 6.927766561508179
Epoch: 7, Steps: 154 | Train Loss: 1.044 Vali Loss: 2.159 Vali Acc: 0.464 Test Loss: 2.159 Test Acc: 0.464
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.0848776
	speed: 0.2410s/iter; left time: 3427.5040s
Epoch: 8 cost time: 6.970590591430664
Epoch: 8, Steps: 154 | Train Loss: 0.929 Vali Loss: 2.251 Vali Acc: 0.483 Test Loss: 2.251 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.9533173
	speed: 0.2209s/iter; left time: 3108.1288s
Epoch: 9 cost time: 6.769556522369385
Epoch: 9, Steps: 154 | Train Loss: 0.878 Vali Loss: 2.308 Vali Acc: 0.534 Test Loss: 2.308 Test Acc: 0.534
Validation loss decreased (-0.521068 --> -0.534040).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9602420
	speed: 0.2262s/iter; left time: 3148.1893s
Epoch: 10 cost time: 6.582951545715332
Epoch: 10, Steps: 154 | Train Loss: 0.785 Vali Loss: 2.552 Vali Acc: 0.440 Test Loss: 2.552 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.6468320
	speed: 0.2149s/iter; left time: 2957.5304s
Epoch: 11 cost time: 5.902089595794678
Epoch: 11, Steps: 154 | Train Loss: 0.757 Vali Loss: 2.659 Vali Acc: 0.451 Test Loss: 2.659 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.6314679
	speed: 0.2272s/iter; left time: 3091.3371s
Epoch: 12 cost time: 6.620871305465698
Epoch: 12, Steps: 154 | Train Loss: 0.692 Vali Loss: 2.727 Vali Acc: 0.502 Test Loss: 2.727 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.3987711
	speed: 0.2140s/iter; left time: 2878.9583s
Epoch: 13 cost time: 6.773250341415405
Epoch: 13, Steps: 154 | Train Loss: 0.680 Vali Loss: 2.787 Vali Acc: 0.476 Test Loss: 2.787 Test Acc: 0.476
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.4349350
	speed: 0.2418s/iter; left time: 3216.2728s
Epoch: 14 cost time: 7.548055171966553
Epoch: 14, Steps: 154 | Train Loss: 0.626 Vali Loss: 2.802 Vali Acc: 0.451 Test Loss: 2.802 Test Acc: 0.451
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.5701721
	speed: 0.2338s/iter; left time: 3072.9870s
Epoch: 15 cost time: 5.782195806503296
Epoch: 15, Steps: 154 | Train Loss: 0.531 Vali Loss: 2.745 Vali Acc: 0.481 Test Loss: 2.745 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.7386075
	speed: 0.2159s/iter; left time: 2805.1980s
Epoch: 16 cost time: 5.907378911972046
Epoch: 16, Steps: 154 | Train Loss: 0.541 Vali Loss: 3.025 Vali Acc: 0.487 Test Loss: 3.025 Test Acc: 0.487
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.2738463
	speed: 0.2430s/iter; left time: 3119.4828s
Epoch: 17 cost time: 7.945638418197632
Epoch: 17, Steps: 154 | Train Loss: 0.513 Vali Loss: 3.113 Vali Acc: 0.515 Test Loss: 3.113 Test Acc: 0.515
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.4436325
	speed: 0.2456s/iter; left time: 3114.8779s
Epoch: 18 cost time: 7.007190704345703
Epoch: 18, Steps: 154 | Train Loss: 0.473 Vali Loss: 3.215 Vali Acc: 0.477 Test Loss: 3.215 Test Acc: 0.477
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.7567932
	speed: 0.2413s/iter; left time: 3023.3104s
Epoch: 19 cost time: 7.984402418136597
Epoch: 19, Steps: 154 | Train Loss: 0.467 Vali Loss: 3.371 Vali Acc: 0.495 Test Loss: 3.371 Test Acc: 0.495
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5340632603406326
model parameter : 181198
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9224054
	speed: 0.0755s/iter; left time: 1155.7565s
Epoch: 1 cost time: 9.9318368434906
Epoch: 1, Steps: 154 | Train Loss: 2.152 Vali Loss: 1.977 Vali Acc: 0.347 Test Loss: 1.977 Test Acc: 0.347
Validation loss decreased (inf --> -0.346696).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2928646
	speed: 0.2603s/iter; left time: 3942.2483s
Epoch: 2 cost time: 7.552771329879761
Epoch: 2, Steps: 154 | Train Loss: 1.491 Vali Loss: 1.823 Vali Acc: 0.478 Test Loss: 1.823 Test Acc: 0.478
Validation loss decreased (-0.346696 --> -0.477678).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3724446
	speed: 0.2480s/iter; left time: 3717.7153s
Epoch: 3 cost time: 7.341362237930298
Epoch: 3, Steps: 154 | Train Loss: 1.262 Vali Loss: 1.877 Vali Acc: 0.493 Test Loss: 1.877 Test Acc: 0.493
Validation loss decreased (-0.477678 --> -0.492682).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3622028
	speed: 0.2280s/iter; left time: 3383.5854s
Epoch: 4 cost time: 6.477036952972412
Epoch: 4, Steps: 154 | Train Loss: 1.194 Vali Loss: 2.315 Vali Acc: 0.459 Test Loss: 2.315 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3929147
	speed: 0.2374s/iter; left time: 3485.7696s
Epoch: 5 cost time: 6.6685473918914795
Epoch: 5, Steps: 154 | Train Loss: 1.127 Vali Loss: 1.969 Vali Acc: 0.516 Test Loss: 1.969 Test Acc: 0.516
Validation loss decreased (-0.492682 --> -0.516201).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3393084
	speed: 0.2431s/iter; left time: 3533.2077s
Epoch: 6 cost time: 6.686938047409058
Epoch: 6, Steps: 154 | Train Loss: 1.066 Vali Loss: 2.166 Vali Acc: 0.465 Test Loss: 2.166 Test Acc: 0.465
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5884984
	speed: 0.2334s/iter; left time: 3355.1651s
Epoch: 7 cost time: 6.911280632019043
Epoch: 7, Steps: 154 | Train Loss: 0.985 Vali Loss: 2.122 Vali Acc: 0.479 Test Loss: 2.122 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8115278
	speed: 0.2468s/iter; left time: 3509.9462s
Epoch: 8 cost time: 6.134880781173706
Epoch: 8, Steps: 154 | Train Loss: 0.935 Vali Loss: 2.336 Vali Acc: 0.532 Test Loss: 2.336 Test Acc: 0.532
Validation loss decreased (-0.516201 --> -0.532012).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5868592
	speed: 0.2093s/iter; left time: 2944.8486s
Epoch: 9 cost time: 5.810967445373535
Epoch: 9, Steps: 154 | Train Loss: 0.886 Vali Loss: 2.485 Vali Acc: 0.521 Test Loss: 2.485 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.7759818
	speed: 0.2322s/iter; left time: 3230.5623s
Epoch: 10 cost time: 6.71353554725647
Epoch: 10, Steps: 154 | Train Loss: 0.834 Vali Loss: 2.482 Vali Acc: 0.444 Test Loss: 2.482 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.5660492
	speed: 0.2220s/iter; left time: 3054.4773s
Epoch: 11 cost time: 6.404005527496338
Epoch: 11, Steps: 154 | Train Loss: 0.814 Vali Loss: 2.390 Vali Acc: 0.496 Test Loss: 2.390 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.0004126
	speed: 0.2397s/iter; left time: 3261.1657s
Epoch: 12 cost time: 6.739909887313843
Epoch: 12, Steps: 154 | Train Loss: 0.721 Vali Loss: 2.346 Vali Acc: 0.488 Test Loss: 2.346 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6176505
	speed: 0.2222s/iter; left time: 2989.4927s
Epoch: 13 cost time: 6.586124420166016
Epoch: 13, Steps: 154 | Train Loss: 0.672 Vali Loss: 2.836 Vali Acc: 0.480 Test Loss: 2.836 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.7643663
	speed: 0.2163s/iter; left time: 2876.9428s
Epoch: 14 cost time: 6.311539888381958
Epoch: 14, Steps: 154 | Train Loss: 0.638 Vali Loss: 2.540 Vali Acc: 0.492 Test Loss: 2.540 Test Acc: 0.492
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.3613924
	speed: 0.2026s/iter; left time: 2663.1277s
Epoch: 15 cost time: 7.1294050216674805
Epoch: 15, Steps: 154 | Train Loss: 0.584 Vali Loss: 2.583 Vali Acc: 0.440 Test Loss: 2.583 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.5187888
	speed: 0.2201s/iter; left time: 2859.0135s
Epoch: 16 cost time: 5.977360010147095
Epoch: 16, Steps: 154 | Train Loss: 0.564 Vali Loss: 2.763 Vali Acc: 0.480 Test Loss: 2.763 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.2287340
	speed: 0.2136s/iter; left time: 2741.8575s
Epoch: 17 cost time: 6.971469402313232
Epoch: 17, Steps: 154 | Train Loss: 0.535 Vali Loss: 2.836 Vali Acc: 0.498 Test Loss: 2.836 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.5921729
	speed: 0.2245s/iter; left time: 2847.9527s
Epoch: 18 cost time: 5.863998174667358
Epoch: 18, Steps: 154 | Train Loss: 0.491 Vali Loss: 2.865 Vali Acc: 0.501 Test Loss: 2.865 Test Acc: 0.501
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm128_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5320356853203568
model parameter : 159822
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1356900
	speed: 0.0712s/iter; left time: 1088.7969s
Epoch: 1 cost time: 8.914289236068726
Epoch: 1, Steps: 154 | Train Loss: 2.054 Vali Loss: 1.900 Vali Acc: 0.442 Test Loss: 1.900 Test Acc: 0.442
Validation loss decreased (inf --> -0.442398).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0704498
	speed: 0.2545s/iter; left time: 3855.4324s
Epoch: 2 cost time: 10.303312540054321
Epoch: 2, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.168 Vali Acc: 0.515 Test Loss: 2.168 Test Acc: 0.515
Validation loss decreased (-0.442398 --> -0.514577).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0303063
	speed: 0.2648s/iter; left time: 3969.7872s
Epoch: 3 cost time: 9.839383602142334
Epoch: 3, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.253 Vali Acc: 0.465 Test Loss: 2.253 Test Acc: 0.465
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.9512998
	speed: 0.2771s/iter; left time: 4112.1099s
Epoch: 4 cost time: 11.002689361572266
Epoch: 4, Steps: 154 | Train Loss: 1.257 Vali Loss: 2.392 Vali Acc: 0.496 Test Loss: 2.392 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9004863
	speed: 0.2518s/iter; left time: 3698.0864s
Epoch: 5 cost time: 8.833537578582764
Epoch: 5, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.813 Vali Acc: 0.483 Test Loss: 2.813 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.3941635
	speed: 0.2429s/iter; left time: 3529.5174s
Epoch: 6 cost time: 10.042779922485352
Epoch: 6, Steps: 154 | Train Loss: 1.101 Vali Loss: 3.457 Vali Acc: 0.453 Test Loss: 3.457 Test Acc: 0.453
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3465725
	speed: 0.2382s/iter; left time: 3424.1938s
Epoch: 7 cost time: 8.825561285018921
Epoch: 7, Steps: 154 | Train Loss: 0.951 Vali Loss: 3.146 Vali Acc: 0.500 Test Loss: 3.146 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.8055350
	speed: 0.2585s/iter; left time: 3676.6776s
Epoch: 8 cost time: 10.535621166229248
Epoch: 8, Steps: 154 | Train Loss: 0.905 Vali Loss: 3.394 Vali Acc: 0.427 Test Loss: 3.394 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.0686910
	speed: 0.2481s/iter; left time: 3489.9107s
Epoch: 9 cost time: 8.900800943374634
Epoch: 9, Steps: 154 | Train Loss: 0.789 Vali Loss: 3.382 Vali Acc: 0.432 Test Loss: 3.382 Test Acc: 0.432
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.2510782
	speed: 0.2538s/iter; left time: 3531.9838s
Epoch: 10 cost time: 10.475305557250977
Epoch: 10, Steps: 154 | Train Loss: 0.743 Vali Loss: 4.288 Vali Acc: 0.389 Test Loss: 4.288 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.5652005
	speed: 0.2637s/iter; left time: 3628.5280s
Epoch: 11 cost time: 9.945454359054565
Epoch: 11, Steps: 154 | Train Loss: 0.653 Vali Loss: 3.696 Vali Acc: 0.483 Test Loss: 3.696 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.4623054
	speed: 0.2702s/iter; left time: 3676.7863s
Epoch: 12 cost time: 10.085954427719116
Epoch: 12, Steps: 154 | Train Loss: 0.570 Vali Loss: 3.548 Vali Acc: 0.475 Test Loss: 3.548 Test Acc: 0.475
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5145985401459854
model parameter : 243790
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0075119
	speed: 0.0718s/iter; left time: 1098.6379s
Epoch: 1 cost time: 9.264618873596191
Epoch: 1, Steps: 154 | Train Loss: 2.067 Vali Loss: 2.034 Vali Acc: 0.416 Test Loss: 2.034 Test Acc: 0.416
Validation loss decreased (inf --> -0.415633).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1354451
	speed: 0.2276s/iter; left time: 3447.5641s
Epoch: 2 cost time: 6.444083213806152
Epoch: 2, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.028 Vali Acc: 0.429 Test Loss: 2.028 Test Acc: 0.429
Validation loss decreased (-0.415633 --> -0.429420).  Saving model ...
	iters: 100, epoch: 3 | loss: 3.5326674
	speed: 0.2596s/iter; left time: 3892.1147s
Epoch: 3 cost time: 8.160080671310425
Epoch: 3, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.084 Vali Acc: 0.459 Test Loss: 2.084 Test Acc: 0.459
Validation loss decreased (-0.429420 --> -0.458617).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7991784
	speed: 0.2461s/iter; left time: 3652.2400s
Epoch: 4 cost time: 7.2122642993927
Epoch: 4, Steps: 154 | Train Loss: 1.120 Vali Loss: 1.932 Vali Acc: 0.526 Test Loss: 1.932 Test Acc: 0.526
Validation loss decreased (-0.458617 --> -0.525934).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3499104
	speed: 0.2466s/iter; left time: 3622.0224s
Epoch: 5 cost time: 7.353025674819946
Epoch: 5, Steps: 154 | Train Loss: 1.036 Vali Loss: 2.344 Vali Acc: 0.416 Test Loss: 2.344 Test Acc: 0.416
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8291960
	speed: 0.2434s/iter; left time: 3537.1706s
Epoch: 6 cost time: 7.213904619216919
Epoch: 6, Steps: 154 | Train Loss: 0.999 Vali Loss: 2.087 Vali Acc: 0.538 Test Loss: 2.087 Test Acc: 0.538
Validation loss decreased (-0.525934 --> -0.537692).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9192693
	speed: 0.2465s/iter; left time: 3544.2467s
Epoch: 7 cost time: 7.33601713180542
Epoch: 7, Steps: 154 | Train Loss: 0.939 Vali Loss: 2.175 Vali Acc: 0.526 Test Loss: 2.175 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7524152
	speed: 0.2506s/iter; left time: 3564.3917s
Epoch: 8 cost time: 6.992291450500488
Epoch: 8, Steps: 154 | Train Loss: 0.849 Vali Loss: 2.243 Vali Acc: 0.499 Test Loss: 2.243 Test Acc: 0.499
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5052814
	speed: 0.2459s/iter; left time: 3459.8770s
Epoch: 9 cost time: 7.847704887390137
Epoch: 9, Steps: 154 | Train Loss: 0.777 Vali Loss: 2.398 Vali Acc: 0.501 Test Loss: 2.398 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.1440673
	speed: 0.2462s/iter; left time: 3425.7812s
Epoch: 10 cost time: 6.072347164154053
Epoch: 10, Steps: 154 | Train Loss: 0.726 Vali Loss: 2.423 Vali Acc: 0.496 Test Loss: 2.423 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.4584040
	speed: 0.2143s/iter; left time: 2949.4462s
Epoch: 11 cost time: 7.23681378364563
Epoch: 11, Steps: 154 | Train Loss: 0.641 Vali Loss: 2.793 Vali Acc: 0.512 Test Loss: 2.793 Test Acc: 0.512
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5250595
	speed: 0.2225s/iter; left time: 3028.0843s
Epoch: 12 cost time: 6.337232351303101
Epoch: 12, Steps: 154 | Train Loss: 0.600 Vali Loss: 2.693 Vali Acc: 0.467 Test Loss: 2.693 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6739724
	speed: 0.2384s/iter; left time: 3207.2799s
Epoch: 13 cost time: 8.014761686325073
Epoch: 13, Steps: 154 | Train Loss: 0.537 Vali Loss: 3.011 Vali Acc: 0.494 Test Loss: 3.011 Test Acc: 0.494
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.2456769
	speed: 0.2339s/iter; left time: 3111.2862s
Epoch: 14 cost time: 7.005656719207764
Epoch: 14, Steps: 154 | Train Loss: 0.494 Vali Loss: 2.764 Vali Acc: 0.487 Test Loss: 2.764 Test Acc: 0.487
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.3296550
	speed: 0.2477s/iter; left time: 3256.2825s
Epoch: 15 cost time: 7.043103933334351
Epoch: 15, Steps: 154 | Train Loss: 0.503 Vali Loss: 2.881 Vali Acc: 0.470 Test Loss: 2.881 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2593224
	speed: 0.2286s/iter; left time: 2969.6278s
Epoch: 16 cost time: 6.464177370071411
Epoch: 16, Steps: 154 | Train Loss: 0.394 Vali Loss: 3.051 Vali Acc: 0.495 Test Loss: 3.051 Test Acc: 0.495
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.537712895377129
model parameter : 147086
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9758275
	speed: 0.0602s/iter; left time: 921.3420s
Epoch: 1 cost time: 8.370368480682373
Epoch: 1, Steps: 154 | Train Loss: 2.076 Vali Loss: 1.984 Vali Acc: 0.410 Test Loss: 1.984 Test Acc: 0.410
Validation loss decreased (inf --> -0.410361).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.8146696
	speed: 0.2558s/iter; left time: 3875.1499s
Epoch: 2 cost time: 7.059070587158203
Epoch: 2, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.100 Vali Acc: 0.442 Test Loss: 2.100 Test Acc: 0.442
Validation loss decreased (-0.410361 --> -0.441585).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8157256
	speed: 0.2362s/iter; left time: 3542.0880s
Epoch: 3 cost time: 6.883978843688965
Epoch: 3, Steps: 154 | Train Loss: 1.250 Vali Loss: 1.841 Vali Acc: 0.534 Test Loss: 1.841 Test Acc: 0.534
Validation loss decreased (-0.441585 --> -0.534450).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5362188
	speed: 0.2241s/iter; left time: 3325.1058s
Epoch: 4 cost time: 7.119545221328735
Epoch: 4, Steps: 154 | Train Loss: 1.138 Vali Loss: 2.047 Vali Acc: 0.448 Test Loss: 2.047 Test Acc: 0.448
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4833739
	speed: 0.2337s/iter; left time: 3432.1384s
Epoch: 5 cost time: 6.42848014831543
Epoch: 5, Steps: 154 | Train Loss: 1.067 Vali Loss: 2.182 Vali Acc: 0.489 Test Loss: 2.182 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.9179925
	speed: 0.2652s/iter; left time: 3853.1569s
Epoch: 6 cost time: 8.310066938400269
Epoch: 6, Steps: 154 | Train Loss: 0.944 Vali Loss: 2.068 Vali Acc: 0.500 Test Loss: 2.068 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.8245828
	speed: 0.2573s/iter; left time: 3699.1601s
Epoch: 7 cost time: 7.764867782592773
Epoch: 7, Steps: 154 | Train Loss: 0.923 Vali Loss: 2.197 Vali Acc: 0.483 Test Loss: 2.197 Test Acc: 0.483
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6336075
	speed: 0.2623s/iter; left time: 3730.6452s
Epoch: 8 cost time: 8.075104713439941
Epoch: 8, Steps: 154 | Train Loss: 0.823 Vali Loss: 2.284 Vali Acc: 0.488 Test Loss: 2.284 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.5072374
	speed: 0.2686s/iter; left time: 3778.4380s
Epoch: 9 cost time: 7.225607872009277
Epoch: 9, Steps: 154 | Train Loss: 0.760 Vali Loss: 2.568 Vali Acc: 0.536 Test Loss: 2.568 Test Acc: 0.536
Validation loss decreased (-0.534450 --> -0.536471).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7036818
	speed: 0.2736s/iter; left time: 3807.1281s
Epoch: 10 cost time: 8.082764863967896
Epoch: 10, Steps: 154 | Train Loss: 0.720 Vali Loss: 2.513 Vali Acc: 0.466 Test Loss: 2.513 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.6105244
	speed: 0.2384s/iter; left time: 3280.0735s
Epoch: 11 cost time: 7.418107509613037
Epoch: 11, Steps: 154 | Train Loss: 0.670 Vali Loss: 2.667 Vali Acc: 0.487 Test Loss: 2.667 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1579517
	speed: 0.2317s/iter; left time: 3152.2150s
Epoch: 12 cost time: 6.472158432006836
Epoch: 12, Steps: 154 | Train Loss: 0.658 Vali Loss: 2.795 Vali Acc: 0.507 Test Loss: 2.795 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.4061319
	speed: 0.2217s/iter; left time: 2982.1282s
Epoch: 13 cost time: 6.807801246643066
Epoch: 13, Steps: 154 | Train Loss: 0.575 Vali Loss: 2.639 Vali Acc: 0.536 Test Loss: 2.639 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8103511
	speed: 0.2388s/iter; left time: 3175.1827s
Epoch: 14 cost time: 7.624520778656006
Epoch: 14, Steps: 154 | Train Loss: 0.518 Vali Loss: 2.632 Vali Acc: 0.518 Test Loss: 2.632 Test Acc: 0.518
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.6209608
	speed: 0.2201s/iter; left time: 2893.2070s
Epoch: 15 cost time: 6.100242614746094
Epoch: 15, Steps: 154 | Train Loss: 0.497 Vali Loss: 2.875 Vali Acc: 0.487 Test Loss: 2.875 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.3235632
	speed: 0.2252s/iter; left time: 2925.1660s
Epoch: 16 cost time: 5.729738712310791
Epoch: 16, Steps: 154 | Train Loss: 0.480 Vali Loss: 2.942 Vali Acc: 0.536 Test Loss: 2.942 Test Acc: 0.536
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.4719904
	speed: 0.2018s/iter; left time: 2590.9335s
Epoch: 17 cost time: 6.323647975921631
Epoch: 17, Steps: 154 | Train Loss: 0.405 Vali Loss: 3.018 Vali Acc: 0.505 Test Loss: 3.018 Test Acc: 0.505
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5119776
	speed: 0.2130s/iter; left time: 2701.5772s
Epoch: 18 cost time: 6.676442384719849
Epoch: 18, Steps: 154 | Train Loss: 0.394 Vali Loss: 3.183 Vali Acc: 0.510 Test Loss: 3.183 Test Acc: 0.510
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.5605783
	speed: 0.2171s/iter; left time: 2719.6747s
Epoch: 19 cost time: 5.793663740158081
Epoch: 19, Steps: 154 | Train Loss: 0.343 Vali Loss: 3.232 Vali Acc: 0.541 Test Loss: 3.232 Test Acc: 0.541
Validation loss decreased (-0.536471 --> -0.540925).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.4873720
	speed: 0.2183s/iter; left time: 2700.9215s
Epoch: 20 cost time: 6.709338903427124
Epoch: 20, Steps: 154 | Train Loss: 0.352 Vali Loss: 3.371 Vali Acc: 0.503 Test Loss: 3.371 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4385607
	speed: 0.2091s/iter; left time: 2554.8450s
Epoch: 21 cost time: 7.359419584274292
Epoch: 21, Steps: 154 | Train Loss: 0.292 Vali Loss: 3.358 Vali Acc: 0.498 Test Loss: 3.358 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1231320
	speed: 0.2351s/iter; left time: 2836.4084s
Epoch: 22 cost time: 5.9149768352508545
Epoch: 22, Steps: 154 | Train Loss: 0.307 Vali Loss: 3.352 Vali Acc: 0.504 Test Loss: 3.352 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1335510
	speed: 0.2074s/iter; left time: 2471.3285s
Epoch: 23 cost time: 6.301097393035889
Epoch: 23, Steps: 154 | Train Loss: 0.253 Vali Loss: 3.644 Vali Acc: 0.543 Test Loss: 3.644 Test Acc: 0.543
Validation loss decreased (-0.540925 --> -0.543354).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.4315926
	speed: 0.2119s/iter; left time: 2491.7528s
Epoch: 24 cost time: 5.944777965545654
Epoch: 24, Steps: 154 | Train Loss: 0.266 Vali Loss: 3.636 Vali Acc: 0.540 Test Loss: 3.636 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.3428020
	speed: 0.2120s/iter; left time: 2459.7418s
Epoch: 25 cost time: 6.418227910995483
Epoch: 25, Steps: 154 | Train Loss: 0.281 Vali Loss: 3.928 Vali Acc: 0.509 Test Loss: 3.928 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.3316205
	speed: 0.2148s/iter; left time: 2459.8988s
Epoch: 26 cost time: 6.640256881713867
Epoch: 26, Steps: 154 | Train Loss: 0.250 Vali Loss: 3.781 Vali Acc: 0.530 Test Loss: 3.781 Test Acc: 0.530
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0975166
	speed: 0.2005s/iter; left time: 2265.4133s
Epoch: 27 cost time: 5.002718687057495
Epoch: 27, Steps: 154 | Train Loss: 0.213 Vali Loss: 4.011 Vali Acc: 0.526 Test Loss: 4.011 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.2652932
	speed: 0.2248s/iter; left time: 2504.9088s
Epoch: 28 cost time: 6.891546249389648
Epoch: 28, Steps: 154 | Train Loss: 0.197 Vali Loss: 4.082 Vali Acc: 0.504 Test Loss: 4.082 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0073007
	speed: 0.2245s/iter; left time: 2466.5445s
Epoch: 29 cost time: 6.828120946884155
Epoch: 29, Steps: 154 | Train Loss: 0.176 Vali Loss: 3.835 Vali Acc: 0.522 Test Loss: 3.835 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.2451469
	speed: 0.2280s/iter; left time: 2469.8988s
Epoch: 30 cost time: 6.91998028755188
Epoch: 30, Steps: 154 | Train Loss: 0.178 Vali Loss: 4.289 Vali Acc: 0.512 Test Loss: 4.289 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.5050224
	speed: 0.2401s/iter; left time: 2564.0189s
Epoch: 31 cost time: 6.568121910095215
Epoch: 31, Steps: 154 | Train Loss: 0.165 Vali Loss: 4.065 Vali Acc: 0.514 Test Loss: 4.065 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.3212284
	speed: 0.2167s/iter; left time: 2281.6758s
Epoch: 32 cost time: 5.542240142822266
Epoch: 32, Steps: 154 | Train Loss: 0.181 Vali Loss: 4.274 Vali Acc: 0.482 Test Loss: 4.274 Test Acc: 0.482
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0103266
	speed: 0.2087s/iter; left time: 2164.4780s
Epoch: 33 cost time: 6.186889171600342
Epoch: 33, Steps: 154 | Train Loss: 0.160 Vali Loss: 4.324 Vali Acc: 0.529 Test Loss: 4.324 Test Acc: 0.529
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5433901054339011
model parameter : 147150
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7513454
	speed: 0.0682s/iter; left time: 1043.9808s
Epoch: 1 cost time: 9.048688888549805
Epoch: 1, Steps: 154 | Train Loss: 2.115 Vali Loss: 1.950 Vali Acc: 0.394 Test Loss: 1.950 Test Acc: 0.394
Validation loss decreased (inf --> -0.393736).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7638694
	speed: 0.2446s/iter; left time: 3705.6715s
Epoch: 2 cost time: 7.4347615242004395
Epoch: 2, Steps: 154 | Train Loss: 1.486 Vali Loss: 1.721 Vali Acc: 0.466 Test Loss: 1.721 Test Acc: 0.466
Validation loss decreased (-0.393736 --> -0.465514).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2669530
	speed: 0.2433s/iter; left time: 3647.4148s
Epoch: 3 cost time: 6.51581335067749
Epoch: 3, Steps: 154 | Train Loss: 1.252 Vali Loss: 2.129 Vali Acc: 0.450 Test Loss: 2.129 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3031203
	speed: 0.2330s/iter; left time: 3457.4271s
Epoch: 4 cost time: 7.10622763633728
Epoch: 4, Steps: 154 | Train Loss: 1.122 Vali Loss: 1.935 Vali Acc: 0.495 Test Loss: 1.935 Test Acc: 0.495
Validation loss decreased (-0.465514 --> -0.495114).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7614772
	speed: 0.2280s/iter; left time: 3348.6188s
Epoch: 5 cost time: 6.505969524383545
Epoch: 5, Steps: 154 | Train Loss: 1.075 Vali Loss: 2.011 Vali Acc: 0.489 Test Loss: 2.011 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6313667
	speed: 0.2106s/iter; left time: 3060.5401s
Epoch: 6 cost time: 5.653087377548218
Epoch: 6, Steps: 154 | Train Loss: 1.002 Vali Loss: 1.952 Vali Acc: 0.549 Test Loss: 1.952 Test Acc: 0.549
Validation loss decreased (-0.495114 --> -0.549048).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2024671
	speed: 0.1986s/iter; left time: 2855.2653s
Epoch: 7 cost time: 5.5482094287872314
Epoch: 7, Steps: 154 | Train Loss: 0.930 Vali Loss: 2.077 Vali Acc: 0.539 Test Loss: 2.077 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8639263
	speed: 0.1972s/iter; left time: 2804.8180s
Epoch: 8 cost time: 6.50920295715332
Epoch: 8, Steps: 154 | Train Loss: 0.874 Vali Loss: 2.165 Vali Acc: 0.489 Test Loss: 2.165 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6874020
	speed: 0.2282s/iter; left time: 3210.1769s
Epoch: 9 cost time: 6.253316879272461
Epoch: 9, Steps: 154 | Train Loss: 0.789 Vali Loss: 2.176 Vali Acc: 0.495 Test Loss: 2.176 Test Acc: 0.495
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.7434868
	speed: 0.2445s/iter; left time: 3402.1517s
Epoch: 10 cost time: 6.977755784988403
Epoch: 10, Steps: 154 | Train Loss: 0.720 Vali Loss: 2.546 Vali Acc: 0.517 Test Loss: 2.546 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5843201
	speed: 0.2153s/iter; left time: 2962.1247s
Epoch: 11 cost time: 6.075842380523682
Epoch: 11, Steps: 154 | Train Loss: 0.664 Vali Loss: 2.370 Vali Acc: 0.536 Test Loss: 2.370 Test Acc: 0.536
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.7474025
	speed: 0.2190s/iter; left time: 2979.7436s
Epoch: 12 cost time: 6.527811050415039
Epoch: 12, Steps: 154 | Train Loss: 0.624 Vali Loss: 2.456 Vali Acc: 0.521 Test Loss: 2.456 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.4059980
	speed: 0.2108s/iter; left time: 2835.9884s
Epoch: 13 cost time: 5.993802547454834
Epoch: 13, Steps: 154 | Train Loss: 0.581 Vali Loss: 2.501 Vali Acc: 0.498 Test Loss: 2.501 Test Acc: 0.498
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3908108
	speed: 0.2042s/iter; left time: 2715.8769s
Epoch: 14 cost time: 7.078597545623779
Epoch: 14, Steps: 154 | Train Loss: 0.546 Vali Loss: 2.626 Vali Acc: 0.516 Test Loss: 2.626 Test Acc: 0.516
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.1320821
	speed: 0.2253s/iter; left time: 2960.9879s
Epoch: 15 cost time: 7.109711408615112
Epoch: 15, Steps: 154 | Train Loss: 0.512 Vali Loss: 2.677 Vali Acc: 0.514 Test Loss: 2.677 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.2103840
	speed: 0.2355s/iter; left time: 3059.8939s
Epoch: 16 cost time: 6.980436325073242
Epoch: 16, Steps: 154 | Train Loss: 0.473 Vali Loss: 2.658 Vali Acc: 0.538 Test Loss: 2.658 Test Acc: 0.538
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5490673154906731
model parameter : 115022
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7490945
	speed: 0.0709s/iter; left time: 1085.1191s
Epoch: 1 cost time: 9.82420015335083
Epoch: 1, Steps: 154 | Train Loss: 2.221 Vali Loss: 2.015 Vali Acc: 0.365 Test Loss: 2.015 Test Acc: 0.365
Validation loss decreased (inf --> -0.364538).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4808537
	speed: 0.2425s/iter; left time: 3673.4333s
Epoch: 2 cost time: 6.619281053543091
Epoch: 2, Steps: 154 | Train Loss: 1.597 Vali Loss: 1.932 Vali Acc: 0.449 Test Loss: 1.932 Test Acc: 0.449
Validation loss decreased (-0.364538 --> -0.448886).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2434593
	speed: 0.2392s/iter; left time: 3586.5720s
Epoch: 3 cost time: 7.284787654876709
Epoch: 3, Steps: 154 | Train Loss: 1.268 Vali Loss: 2.013 Vali Acc: 0.465 Test Loss: 2.013 Test Acc: 0.465
Validation loss decreased (-0.448886 --> -0.464700).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2359328
	speed: 0.2419s/iter; left time: 3589.1730s
Epoch: 4 cost time: 6.980421304702759
Epoch: 4, Steps: 154 | Train Loss: 1.163 Vali Loss: 1.947 Vali Acc: 0.489 Test Loss: 1.947 Test Acc: 0.489
Validation loss decreased (-0.464700 --> -0.489032).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2210732
	speed: 0.2261s/iter; left time: 3319.5609s
Epoch: 5 cost time: 6.359065294265747
Epoch: 5, Steps: 154 | Train Loss: 1.092 Vali Loss: 2.188 Vali Acc: 0.475 Test Loss: 2.188 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.8697666
	speed: 0.2170s/iter; left time: 3153.6091s
Epoch: 6 cost time: 6.74230694770813
Epoch: 6, Steps: 154 | Train Loss: 1.021 Vali Loss: 2.213 Vali Acc: 0.479 Test Loss: 2.213 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5176516
	speed: 0.2182s/iter; left time: 3136.4913s
Epoch: 7 cost time: 5.834466218948364
Epoch: 7, Steps: 154 | Train Loss: 0.960 Vali Loss: 1.991 Vali Acc: 0.500 Test Loss: 1.991 Test Acc: 0.500
Validation loss decreased (-0.489032 --> -0.499980).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9674991
	speed: 0.2352s/iter; left time: 3345.4576s
Epoch: 8 cost time: 5.9843666553497314
Epoch: 8, Steps: 154 | Train Loss: 0.911 Vali Loss: 2.314 Vali Acc: 0.470 Test Loss: 2.314 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5486585
	speed: 0.2381s/iter; left time: 3349.4745s
Epoch: 9 cost time: 7.693609714508057
Epoch: 9, Steps: 154 | Train Loss: 0.840 Vali Loss: 2.009 Vali Acc: 0.528 Test Loss: 2.009 Test Acc: 0.528
Validation loss decreased (-0.499980 --> -0.527555).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3856891
	speed: 0.2323s/iter; left time: 3232.4538s
Epoch: 10 cost time: 6.742173910140991
Epoch: 10, Steps: 154 | Train Loss: 0.761 Vali Loss: 2.196 Vali Acc: 0.511 Test Loss: 2.196 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.7868548
	speed: 0.2440s/iter; left time: 3357.6230s
Epoch: 11 cost time: 6.7843499183654785
Epoch: 11, Steps: 154 | Train Loss: 0.718 Vali Loss: 2.345 Vali Acc: 0.520 Test Loss: 2.345 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4419557
	speed: 0.2302s/iter; left time: 3132.7484s
Epoch: 12 cost time: 6.819940567016602
Epoch: 12, Steps: 154 | Train Loss: 0.676 Vali Loss: 2.729 Vali Acc: 0.451 Test Loss: 2.729 Test Acc: 0.451
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.7223389
	speed: 0.2245s/iter; left time: 3020.1573s
Epoch: 13 cost time: 5.66327977180481
Epoch: 13, Steps: 154 | Train Loss: 0.633 Vali Loss: 2.696 Vali Acc: 0.459 Test Loss: 2.696 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3408375
	speed: 0.2148s/iter; left time: 2856.6101s
Epoch: 14 cost time: 6.772242069244385
Epoch: 14, Steps: 154 | Train Loss: 0.596 Vali Loss: 2.341 Vali Acc: 0.506 Test Loss: 2.341 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3403352
	speed: 0.2174s/iter; left time: 2858.1964s
Epoch: 15 cost time: 6.154198169708252
Epoch: 15, Steps: 154 | Train Loss: 0.547 Vali Loss: 2.315 Vali Acc: 0.497 Test Loss: 2.315 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0757542
	speed: 0.2337s/iter; left time: 3036.1427s
Epoch: 16 cost time: 7.646358251571655
Epoch: 16, Steps: 154 | Train Loss: 0.532 Vali Loss: 2.884 Vali Acc: 0.474 Test Loss: 2.884 Test Acc: 0.474
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.3500397
	speed: 0.2262s/iter; left time: 2904.1271s
Epoch: 17 cost time: 7.750540018081665
Epoch: 17, Steps: 154 | Train Loss: 0.491 Vali Loss: 2.632 Vali Acc: 0.488 Test Loss: 2.632 Test Acc: 0.488
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.3610930
	speed: 0.2350s/iter; left time: 2980.0766s
Epoch: 18 cost time: 5.6202168464660645
Epoch: 18, Steps: 154 | Train Loss: 0.452 Vali Loss: 2.877 Vali Acc: 0.497 Test Loss: 2.877 Test Acc: 0.497
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1410081
	speed: 0.2157s/iter; left time: 2702.0301s
Epoch: 19 cost time: 7.437086343765259
Epoch: 19, Steps: 154 | Train Loss: 0.415 Vali Loss: 2.934 Vali Acc: 0.487 Test Loss: 2.934 Test Acc: 0.487
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5275750202757502
model parameter : 99022
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8414562
	speed: 0.0606s/iter; left time: 927.2514s
Epoch: 1 cost time: 7.939700603485107
Epoch: 1, Steps: 154 | Train Loss: 2.253 Vali Loss: 1.993 Vali Acc: 0.365 Test Loss: 1.993 Test Acc: 0.365
Validation loss decreased (inf --> -0.364538).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6137731
	speed: 0.2284s/iter; left time: 3459.1966s
Epoch: 2 cost time: 6.347842216491699
Epoch: 2, Steps: 154 | Train Loss: 1.609 Vali Loss: 1.755 Vali Acc: 0.461 Test Loss: 1.755 Test Acc: 0.461
Validation loss decreased (-0.364538 --> -0.461459).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4473493
	speed: 0.2143s/iter; left time: 3212.9300s
Epoch: 3 cost time: 6.5472023487091064
Epoch: 3, Steps: 154 | Train Loss: 1.290 Vali Loss: 1.874 Vali Acc: 0.474 Test Loss: 1.874 Test Acc: 0.474
Validation loss decreased (-0.461459 --> -0.474434).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8710942
	speed: 0.2261s/iter; left time: 3355.1451s
Epoch: 4 cost time: 6.255940675735474
Epoch: 4, Steps: 154 | Train Loss: 1.169 Vali Loss: 1.781 Vali Acc: 0.472 Test Loss: 1.781 Test Acc: 0.472
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8404615
	speed: 0.2215s/iter; left time: 3253.2237s
Epoch: 5 cost time: 6.04352593421936
Epoch: 5, Steps: 154 | Train Loss: 1.113 Vali Loss: 1.795 Vali Acc: 0.498 Test Loss: 1.795 Test Acc: 0.498
Validation loss decreased (-0.474434 --> -0.497549).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0884575
	speed: 0.2394s/iter; left time: 3478.2717s
Epoch: 6 cost time: 6.8645713329315186
Epoch: 6, Steps: 154 | Train Loss: 1.062 Vali Loss: 2.013 Vali Acc: 0.479 Test Loss: 2.013 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5068234
	speed: 0.2263s/iter; left time: 3253.5383s
Epoch: 7 cost time: 7.1974945068359375
Epoch: 7, Steps: 154 | Train Loss: 0.997 Vali Loss: 1.892 Vali Acc: 0.489 Test Loss: 1.892 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.6477004
	speed: 0.2439s/iter; left time: 3468.9631s
Epoch: 8 cost time: 6.668318271636963
Epoch: 8, Steps: 154 | Train Loss: 0.934 Vali Loss: 1.880 Vali Acc: 0.515 Test Loss: 1.880 Test Acc: 0.515
Validation loss decreased (-0.497549 --> -0.514580).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7922706
	speed: 0.2257s/iter; left time: 3175.5891s
Epoch: 9 cost time: 7.045973300933838
Epoch: 9, Steps: 154 | Train Loss: 0.869 Vali Loss: 2.067 Vali Acc: 0.536 Test Loss: 2.067 Test Acc: 0.536
Validation loss decreased (-0.514580 --> -0.535665).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8986458
	speed: 0.2563s/iter; left time: 3566.7103s
Epoch: 10 cost time: 6.938796520233154
Epoch: 10, Steps: 154 | Train Loss: 0.821 Vali Loss: 2.005 Vali Acc: 0.508 Test Loss: 2.005 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8096464
	speed: 0.2429s/iter; left time: 3342.0151s
Epoch: 11 cost time: 6.537634372711182
Epoch: 11, Steps: 154 | Train Loss: 0.783 Vali Loss: 2.110 Vali Acc: 0.497 Test Loss: 2.110 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.5903195
	speed: 0.2294s/iter; left time: 3121.1768s
Epoch: 12 cost time: 6.186905384063721
Epoch: 12, Steps: 154 | Train Loss: 0.729 Vali Loss: 2.155 Vali Acc: 0.509 Test Loss: 2.155 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1297003
	speed: 0.2465s/iter; left time: 3316.8101s
Epoch: 13 cost time: 6.349308013916016
Epoch: 13, Steps: 154 | Train Loss: 0.692 Vali Loss: 2.361 Vali Acc: 0.447 Test Loss: 2.361 Test Acc: 0.447
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.6015215
	speed: 0.2299s/iter; left time: 3057.7178s
Epoch: 14 cost time: 7.430486440658569
Epoch: 14, Steps: 154 | Train Loss: 0.655 Vali Loss: 2.505 Vali Acc: 0.464 Test Loss: 2.505 Test Acc: 0.464
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.3485651
	speed: 0.2372s/iter; left time: 3117.7298s
Epoch: 15 cost time: 6.679060220718384
Epoch: 15, Steps: 154 | Train Loss: 0.613 Vali Loss: 2.176 Vali Acc: 0.503 Test Loss: 2.176 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.7037449
	speed: 0.2108s/iter; left time: 2737.8664s
Epoch: 16 cost time: 5.890639543533325
Epoch: 16, Steps: 154 | Train Loss: 0.568 Vali Loss: 2.459 Vali Acc: 0.445 Test Loss: 2.459 Test Acc: 0.445
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.5484703
	speed: 0.2201s/iter; left time: 2826.0638s
Epoch: 17 cost time: 6.898115873336792
Epoch: 17, Steps: 154 | Train Loss: 0.536 Vali Loss: 2.464 Vali Acc: 0.473 Test Loss: 2.464 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.7202781
	speed: 0.2357s/iter; left time: 2989.2638s
Epoch: 18 cost time: 6.336760520935059
Epoch: 18, Steps: 154 | Train Loss: 0.526 Vali Loss: 2.523 Vali Acc: 0.470 Test Loss: 2.523 Test Acc: 0.470
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.4348118
	speed: 0.2149s/iter; left time: 2692.1800s
Epoch: 19 cost time: 6.000248670578003
Epoch: 19, Steps: 154 | Train Loss: 0.483 Vali Loss: 2.677 Vali Acc: 0.496 Test Loss: 2.677 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5356853203568532
model parameter : 88334
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5060067
	speed: 0.0710s/iter; left time: 1085.9198s
Epoch: 1 cost time: 9.395097494125366
Epoch: 1, Steps: 154 | Train Loss: 2.048 Vali Loss: 1.969 Vali Acc: 0.404 Test Loss: 1.969 Test Acc: 0.404
Validation loss decreased (inf --> -0.403873).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2309518
	speed: 0.2097s/iter; left time: 3176.1677s
Epoch: 2 cost time: 6.075276851654053
Epoch: 2, Steps: 154 | Train Loss: 1.534 Vali Loss: 1.953 Vali Acc: 0.453 Test Loss: 1.953 Test Acc: 0.453
Validation loss decreased (-0.403873 --> -0.453346).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9632514
	speed: 0.2100s/iter; left time: 3149.1756s
Epoch: 3 cost time: 6.192140102386475
Epoch: 3, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.251 Vali Acc: 0.461 Test Loss: 2.251 Test Acc: 0.461
Validation loss decreased (-0.453346 --> -0.461048).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8425235
	speed: 0.2174s/iter; left time: 3225.6448s
Epoch: 4 cost time: 6.530949354171753
Epoch: 4, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.371 Vali Acc: 0.513 Test Loss: 2.371 Test Acc: 0.513
Validation loss decreased (-0.461048 --> -0.512547).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8729636
	speed: 0.2193s/iter; left time: 3220.2076s
Epoch: 5 cost time: 6.5389182567596436
Epoch: 5, Steps: 154 | Train Loss: 1.171 Vali Loss: 2.674 Vali Acc: 0.459 Test Loss: 2.674 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5783714
	speed: 0.2329s/iter; left time: 3384.5925s
Epoch: 6 cost time: 6.1454808712005615
Epoch: 6, Steps: 154 | Train Loss: 1.088 Vali Loss: 2.857 Vali Acc: 0.501 Test Loss: 2.857 Test Acc: 0.501
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.8393225
	speed: 0.2458s/iter; left time: 3533.5098s
Epoch: 7 cost time: 9.031712055206299
Epoch: 7, Steps: 154 | Train Loss: 1.043 Vali Loss: 2.801 Vali Acc: 0.475 Test Loss: 2.801 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8752779
	speed: 0.2698s/iter; left time: 3836.6949s
Epoch: 8 cost time: 8.335504293441772
Epoch: 8, Steps: 154 | Train Loss: 0.943 Vali Loss: 2.937 Vali Acc: 0.486 Test Loss: 2.937 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.7865493
	speed: 0.2661s/iter; left time: 3743.9608s
Epoch: 9 cost time: 8.437961339950562
Epoch: 9, Steps: 154 | Train Loss: 0.778 Vali Loss: 3.709 Vali Acc: 0.411 Test Loss: 3.709 Test Acc: 0.411
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.3842991
	speed: 0.2612s/iter; left time: 3634.0248s
Epoch: 10 cost time: 8.299551248550415
Epoch: 10, Steps: 154 | Train Loss: 0.751 Vali Loss: 3.608 Vali Acc: 0.441 Test Loss: 3.608 Test Acc: 0.441
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.7324024
	speed: 0.2535s/iter; left time: 3488.8432s
Epoch: 11 cost time: 8.344682455062866
Epoch: 11, Steps: 154 | Train Loss: 0.606 Vali Loss: 3.361 Vali Acc: 0.495 Test Loss: 3.361 Test Acc: 0.495
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6651583
	speed: 0.2474s/iter; left time: 3366.9957s
Epoch: 12 cost time: 8.229386329650879
Epoch: 12, Steps: 154 | Train Loss: 0.616 Vali Loss: 3.874 Vali Acc: 0.421 Test Loss: 3.874 Test Acc: 0.421
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.3044783
	speed: 0.2336s/iter; left time: 3143.0108s
Epoch: 13 cost time: 7.48469877243042
Epoch: 13, Steps: 154 | Train Loss: 0.495 Vali Loss: 3.454 Vali Acc: 0.491 Test Loss: 3.454 Test Acc: 0.491
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.4644290
	speed: 0.2498s/iter; left time: 3321.5125s
Epoch: 14 cost time: 8.870100498199463
Epoch: 14, Steps: 154 | Train Loss: 0.474 Vali Loss: 3.680 Vali Acc: 0.485 Test Loss: 3.680 Test Acc: 0.485
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5125709651257097
model parameter : 227278
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7780554
	speed: 0.0790s/iter; left time: 1208.3375s
Epoch: 1 cost time: 9.731361150741577
Epoch: 1, Steps: 154 | Train Loss: 2.079 Vali Loss: 1.871 Vali Acc: 0.389 Test Loss: 1.871 Test Acc: 0.389
Validation loss decreased (inf --> -0.388870).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2415040
	speed: 0.2104s/iter; left time: 3187.6114s
Epoch: 2 cost time: 6.3724448680877686
Epoch: 2, Steps: 154 | Train Loss: 1.466 Vali Loss: 1.842 Vali Acc: 0.469 Test Loss: 1.842 Test Acc: 0.469
Validation loss decreased (-0.388870 --> -0.468757).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1475574
	speed: 0.2014s/iter; left time: 3020.0163s
Epoch: 3 cost time: 5.312486171722412
Epoch: 3, Steps: 154 | Train Loss: 1.279 Vali Loss: 1.807 Vali Acc: 0.466 Test Loss: 1.807 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8875417
	speed: 0.2231s/iter; left time: 3310.8427s
Epoch: 4 cost time: 6.0972278118133545
Epoch: 4, Steps: 154 | Train Loss: 1.146 Vali Loss: 2.103 Vali Acc: 0.489 Test Loss: 2.103 Test Acc: 0.489
Validation loss decreased (-0.468757 --> -0.488625).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9088627
	speed: 0.2113s/iter; left time: 3102.2803s
Epoch: 5 cost time: 6.00593376159668
Epoch: 5, Steps: 154 | Train Loss: 1.077 Vali Loss: 2.163 Vali Acc: 0.476 Test Loss: 2.163 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5995332
	speed: 0.2079s/iter; left time: 3021.5976s
Epoch: 6 cost time: 5.34989333152771
Epoch: 6, Steps: 154 | Train Loss: 1.027 Vali Loss: 2.132 Vali Acc: 0.496 Test Loss: 2.132 Test Acc: 0.496
Validation loss decreased (-0.488625 --> -0.495518).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9146528
	speed: 0.1934s/iter; left time: 2781.2046s
Epoch: 7 cost time: 5.893726110458374
Epoch: 7, Steps: 154 | Train Loss: 0.962 Vali Loss: 2.178 Vali Acc: 0.520 Test Loss: 2.178 Test Acc: 0.520
Validation loss decreased (-0.495518 --> -0.520254).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7079490
	speed: 0.2422s/iter; left time: 3445.4678s
Epoch: 8 cost time: 6.5468974113464355
Epoch: 8, Steps: 154 | Train Loss: 0.839 Vali Loss: 2.396 Vali Acc: 0.517 Test Loss: 2.396 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7448141
	speed: 0.2350s/iter; left time: 3305.7141s
Epoch: 9 cost time: 6.757647275924683
Epoch: 9, Steps: 154 | Train Loss: 0.808 Vali Loss: 2.376 Vali Acc: 0.528 Test Loss: 2.376 Test Acc: 0.528
Validation loss decreased (-0.520254 --> -0.528362).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7440045
	speed: 0.2294s/iter; left time: 3192.6551s
Epoch: 10 cost time: 6.3460471630096436
Epoch: 10, Steps: 154 | Train Loss: 0.737 Vali Loss: 2.277 Vali Acc: 0.521 Test Loss: 2.277 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4249266
	speed: 0.2341s/iter; left time: 3221.3259s
Epoch: 11 cost time: 7.106136798858643
Epoch: 11, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.450 Vali Acc: 0.484 Test Loss: 2.450 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7626635
	speed: 0.2313s/iter; left time: 3146.8190s
Epoch: 12 cost time: 5.304611682891846
Epoch: 12, Steps: 154 | Train Loss: 0.610 Vali Loss: 2.641 Vali Acc: 0.457 Test Loss: 2.641 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2366148
	speed: 0.2331s/iter; left time: 3136.0351s
Epoch: 13 cost time: 7.84942889213562
Epoch: 13, Steps: 154 | Train Loss: 0.593 Vali Loss: 2.901 Vali Acc: 0.432 Test Loss: 2.901 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.5845951
	speed: 0.2493s/iter; left time: 3316.0190s
Epoch: 14 cost time: 6.951820611953735
Epoch: 14, Steps: 154 | Train Loss: 0.573 Vali Loss: 2.787 Vali Acc: 0.493 Test Loss: 2.787 Test Acc: 0.493
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.5782436
	speed: 0.2428s/iter; left time: 3191.2231s
Epoch: 15 cost time: 6.590818166732788
Epoch: 15, Steps: 154 | Train Loss: 0.490 Vali Loss: 2.886 Vali Acc: 0.513 Test Loss: 2.886 Test Acc: 0.513
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.3034468
	speed: 0.2245s/iter; left time: 2916.0153s
Epoch: 16 cost time: 6.950923681259155
Epoch: 16, Steps: 154 | Train Loss: 0.440 Vali Loss: 3.266 Vali Acc: 0.453 Test Loss: 3.266 Test Acc: 0.453
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.4006397
	speed: 0.2510s/iter; left time: 3222.4109s
Epoch: 17 cost time: 6.311357736587524
Epoch: 17, Steps: 154 | Train Loss: 0.464 Vali Loss: 3.244 Vali Acc: 0.500 Test Loss: 3.244 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.2858369
	speed: 0.2200s/iter; left time: 2789.7364s
Epoch: 18 cost time: 6.7211995124816895
Epoch: 18, Steps: 154 | Train Loss: 0.389 Vali Loss: 3.077 Vali Acc: 0.496 Test Loss: 3.077 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.1199699
	speed: 0.2479s/iter; left time: 3106.1425s
Epoch: 19 cost time: 6.97014856338501
Epoch: 19, Steps: 154 | Train Loss: 0.372 Vali Loss: 3.275 Vali Acc: 0.479 Test Loss: 3.275 Test Acc: 0.479
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5283860502838605
model parameter : 130574
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5333120
	speed: 0.0760s/iter; left time: 1162.9553s
Epoch: 1 cost time: 9.759602308273315
Epoch: 1, Steps: 154 | Train Loss: 2.044 Vali Loss: 1.768 Vali Acc: 0.397 Test Loss: 1.768 Test Acc: 0.397
Validation loss decreased (inf --> -0.396982).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4402378
	speed: 0.2440s/iter; left time: 3695.4343s
Epoch: 2 cost time: 7.8238983154296875
Epoch: 2, Steps: 154 | Train Loss: 1.423 Vali Loss: 1.738 Vali Acc: 0.494 Test Loss: 1.738 Test Acc: 0.494
Validation loss decreased (-0.396982 --> -0.493900).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2138934
	speed: 0.2716s/iter; left time: 4072.7610s
Epoch: 3 cost time: 7.96475887298584
Epoch: 3, Steps: 154 | Train Loss: 1.260 Vali Loss: 2.098 Vali Acc: 0.459 Test Loss: 2.098 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1154386
	speed: 0.2399s/iter; left time: 3559.2870s
Epoch: 4 cost time: 7.167380094528198
Epoch: 4, Steps: 154 | Train Loss: 1.168 Vali Loss: 1.933 Vali Acc: 0.477 Test Loss: 1.933 Test Acc: 0.477
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9911097
	speed: 0.2539s/iter; left time: 3728.4145s
Epoch: 5 cost time: 8.00977611541748
Epoch: 5, Steps: 154 | Train Loss: 1.104 Vali Loss: 1.888 Vali Acc: 0.506 Test Loss: 1.888 Test Acc: 0.506
Validation loss decreased (-0.493900 --> -0.505658).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1733840
	speed: 0.2338s/iter; left time: 3397.5422s
Epoch: 6 cost time: 5.908302068710327
Epoch: 6, Steps: 154 | Train Loss: 1.006 Vali Loss: 2.280 Vali Acc: 0.485 Test Loss: 2.280 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.7548512
	speed: 0.2361s/iter; left time: 3394.0424s
Epoch: 7 cost time: 6.75660514831543
Epoch: 7, Steps: 154 | Train Loss: 0.938 Vali Loss: 2.282 Vali Acc: 0.459 Test Loss: 2.282 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9106667
	speed: 0.2349s/iter; left time: 3341.2004s
Epoch: 8 cost time: 5.126789808273315
Epoch: 8, Steps: 154 | Train Loss: 0.870 Vali Loss: 2.926 Vali Acc: 0.433 Test Loss: 2.926 Test Acc: 0.433
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.4822270
	speed: 0.2180s/iter; left time: 3066.5077s
Epoch: 9 cost time: 7.0366294384002686
Epoch: 9, Steps: 154 | Train Loss: 0.790 Vali Loss: 2.430 Vali Acc: 0.493 Test Loss: 2.430 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5139050
	speed: 0.2299s/iter; left time: 3198.5393s
Epoch: 10 cost time: 7.094757318496704
Epoch: 10, Steps: 154 | Train Loss: 0.734 Vali Loss: 2.661 Vali Acc: 0.463 Test Loss: 2.661 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1899165
	speed: 0.2127s/iter; left time: 2926.9967s
Epoch: 11 cost time: 6.277397632598877
Epoch: 11, Steps: 154 | Train Loss: 0.631 Vali Loss: 2.928 Vali Acc: 0.472 Test Loss: 2.928 Test Acc: 0.472
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.3069769
	speed: 0.2114s/iter; left time: 2876.8173s
Epoch: 12 cost time: 6.580069065093994
Epoch: 12, Steps: 154 | Train Loss: 0.621 Vali Loss: 2.771 Vali Acc: 0.470 Test Loss: 2.771 Test Acc: 0.470
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6483728
	speed: 0.2247s/iter; left time: 3022.3111s
Epoch: 13 cost time: 5.980254888534546
Epoch: 13, Steps: 154 | Train Loss: 0.582 Vali Loss: 2.769 Vali Acc: 0.503 Test Loss: 2.769 Test Acc: 0.503
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6118070
	speed: 0.1945s/iter; left time: 2586.9773s
Epoch: 14 cost time: 5.899320602416992
Epoch: 14, Steps: 154 | Train Loss: 0.528 Vali Loss: 2.930 Vali Acc: 0.501 Test Loss: 2.930 Test Acc: 0.501
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.1328113
	speed: 0.1987s/iter; left time: 2612.4022s
Epoch: 15 cost time: 5.378162145614624
Epoch: 15, Steps: 154 | Train Loss: 0.473 Vali Loss: 2.936 Vali Acc: 0.512 Test Loss: 2.936 Test Acc: 0.512
Validation loss decreased (-0.505658 --> -0.511731).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1853909
	speed: 0.1945s/iter; left time: 2526.9536s
Epoch: 16 cost time: 5.748656272888184
Epoch: 16, Steps: 154 | Train Loss: 0.456 Vali Loss: 3.201 Vali Acc: 0.532 Test Loss: 3.201 Test Acc: 0.532
Validation loss decreased (-0.511731 --> -0.531598).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.9555748
	speed: 0.2127s/iter; left time: 2730.4021s
Epoch: 17 cost time: 6.430324554443359
Epoch: 17, Steps: 154 | Train Loss: 0.401 Vali Loss: 2.952 Vali Acc: 0.521 Test Loss: 2.952 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.3047163
	speed: 0.2209s/iter; left time: 2801.3602s
Epoch: 18 cost time: 5.971259832382202
Epoch: 18, Steps: 154 | Train Loss: 0.402 Vali Loss: 3.137 Vali Acc: 0.528 Test Loss: 3.137 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.3810723
	speed: 0.2283s/iter; left time: 2860.2114s
Epoch: 19 cost time: 6.74792742729187
Epoch: 19, Steps: 154 | Train Loss: 0.372 Vali Loss: 3.650 Vali Acc: 0.456 Test Loss: 3.650 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.3750386
	speed: 0.2212s/iter; left time: 2737.3199s
Epoch: 20 cost time: 6.085993528366089
Epoch: 20, Steps: 154 | Train Loss: 0.364 Vali Loss: 3.118 Vali Acc: 0.534 Test Loss: 3.118 Test Acc: 0.534
Validation loss decreased (-0.531598 --> -0.534032).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.5422345
	speed: 0.2285s/iter; left time: 2792.2600s
Epoch: 21 cost time: 7.01178503036499
Epoch: 21, Steps: 154 | Train Loss: 0.341 Vali Loss: 3.345 Vali Acc: 0.500 Test Loss: 3.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.2838804
	speed: 0.2698s/iter; left time: 3255.4477s
Epoch: 22 cost time: 7.355996370315552
Epoch: 22, Steps: 154 | Train Loss: 0.300 Vali Loss: 3.486 Vali Acc: 0.524 Test Loss: 3.486 Test Acc: 0.524
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.1021204
	speed: 0.2217s/iter; left time: 2640.9861s
Epoch: 23 cost time: 6.6553661823272705
Epoch: 23, Steps: 154 | Train Loss: 0.271 Vali Loss: 3.682 Vali Acc: 0.524 Test Loss: 3.682 Test Acc: 0.524
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0265253
	speed: 0.2525s/iter; left time: 2969.6865s
Epoch: 24 cost time: 6.713246822357178
Epoch: 24, Steps: 154 | Train Loss: 0.250 Vali Loss: 3.581 Vali Acc: 0.530 Test Loss: 3.581 Test Acc: 0.530
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1605301
	speed: 0.2370s/iter; left time: 2749.9955s
Epoch: 25 cost time: 6.954173803329468
Epoch: 25, Steps: 154 | Train Loss: 0.260 Vali Loss: 3.695 Vali Acc: 0.489 Test Loss: 3.695 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0553330
	speed: 0.2456s/iter; left time: 2812.0007s
Epoch: 26 cost time: 7.2966461181640625
Epoch: 26, Steps: 154 | Train Loss: 0.254 Vali Loss: 3.797 Vali Acc: 0.503 Test Loss: 3.797 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.3297964
	speed: 0.2742s/iter; left time: 3097.1032s
Epoch: 27 cost time: 7.70756196975708
Epoch: 27, Steps: 154 | Train Loss: 0.225 Vali Loss: 3.843 Vali Acc: 0.503 Test Loss: 3.843 Test Acc: 0.503
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0708207
	speed: 0.2589s/iter; left time: 2885.0053s
Epoch: 28 cost time: 7.4557318687438965
Epoch: 28, Steps: 154 | Train Loss: 0.199 Vali Loss: 4.150 Vali Acc: 0.498 Test Loss: 4.150 Test Acc: 0.498
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.7053896
	speed: 0.2668s/iter; left time: 2931.4290s
Epoch: 29 cost time: 7.690599679946899
Epoch: 29, Steps: 154 | Train Loss: 0.205 Vali Loss: 3.937 Vali Acc: 0.491 Test Loss: 3.937 Test Acc: 0.491
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.1345988
	speed: 0.2518s/iter; left time: 2728.7184s
Epoch: 30 cost time: 7.444061756134033
Epoch: 30, Steps: 154 | Train Loss: 0.192 Vali Loss: 3.879 Vali Acc: 0.499 Test Loss: 3.879 Test Acc: 0.499
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5340632603406326
model parameter : 130638
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0206323
	speed: 0.0624s/iter; left time: 955.4495s
Epoch: 1 cost time: 8.169991493225098
Epoch: 1, Steps: 154 | Train Loss: 2.174 Vali Loss: 1.838 Vali Acc: 0.385 Test Loss: 1.838 Test Acc: 0.385
Validation loss decreased (inf --> -0.384815).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2544402
	speed: 0.2143s/iter; left time: 3245.9737s
Epoch: 2 cost time: 6.320443153381348
Epoch: 2, Steps: 154 | Train Loss: 1.498 Vali Loss: 1.965 Vali Acc: 0.464 Test Loss: 1.965 Test Acc: 0.464
Validation loss decreased (-0.384815 --> -0.463484).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7541962
	speed: 0.2114s/iter; left time: 3170.1157s
Epoch: 3 cost time: 5.83423638343811
Epoch: 3, Steps: 154 | Train Loss: 1.259 Vali Loss: 1.782 Vali Acc: 0.487 Test Loss: 1.782 Test Acc: 0.487
Validation loss decreased (-0.463484 --> -0.486600).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4905295
	speed: 0.2182s/iter; left time: 3237.1992s
Epoch: 4 cost time: 6.794308185577393
Epoch: 4, Steps: 154 | Train Loss: 1.167 Vali Loss: 1.911 Vali Acc: 0.476 Test Loss: 1.911 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9509323
	speed: 0.2207s/iter; left time: 3240.8958s
Epoch: 5 cost time: 6.834102153778076
Epoch: 5, Steps: 154 | Train Loss: 1.081 Vali Loss: 1.996 Vali Acc: 0.509 Test Loss: 1.996 Test Acc: 0.509
Validation loss decreased (-0.486600 --> -0.508496).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1711588
	speed: 0.2234s/iter; left time: 3246.2610s
Epoch: 6 cost time: 5.829277992248535
Epoch: 6, Steps: 154 | Train Loss: 1.018 Vali Loss: 1.883 Vali Acc: 0.519 Test Loss: 1.883 Test Acc: 0.519
Validation loss decreased (-0.508496 --> -0.519446).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1291908
	speed: 0.2111s/iter; left time: 3034.6040s
Epoch: 7 cost time: 7.309875011444092
Epoch: 7, Steps: 154 | Train Loss: 0.944 Vali Loss: 1.980 Vali Acc: 0.498 Test Loss: 1.980 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5939127
	speed: 0.2478s/iter; left time: 3525.0345s
Epoch: 8 cost time: 6.451372146606445
Epoch: 8, Steps: 154 | Train Loss: 0.883 Vali Loss: 2.207 Vali Acc: 0.462 Test Loss: 2.207 Test Acc: 0.462
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1685650
	speed: 0.2322s/iter; left time: 3266.6814s
Epoch: 9 cost time: 6.9378509521484375
Epoch: 9, Steps: 154 | Train Loss: 0.831 Vali Loss: 2.250 Vali Acc: 0.507 Test Loss: 2.250 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0653691
	speed: 0.2280s/iter; left time: 3172.7960s
Epoch: 10 cost time: 6.76165246963501
Epoch: 10, Steps: 154 | Train Loss: 0.762 Vali Loss: 2.142 Vali Acc: 0.514 Test Loss: 2.142 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.0804275
	speed: 0.2138s/iter; left time: 2942.2066s
Epoch: 11 cost time: 6.7907633781433105
Epoch: 11, Steps: 154 | Train Loss: 0.731 Vali Loss: 2.332 Vali Acc: 0.526 Test Loss: 2.332 Test Acc: 0.526
Validation loss decreased (-0.519446 --> -0.526335).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8707280
	speed: 0.2375s/iter; left time: 3231.3204s
Epoch: 12 cost time: 6.90785551071167
Epoch: 12, Steps: 154 | Train Loss: 0.666 Vali Loss: 2.305 Vali Acc: 0.531 Test Loss: 2.305 Test Acc: 0.531
Validation loss decreased (-0.526335 --> -0.530796).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9357107
	speed: 0.2403s/iter; left time: 3232.7313s
Epoch: 13 cost time: 6.689125061035156
Epoch: 13, Steps: 154 | Train Loss: 0.608 Vali Loss: 2.311 Vali Acc: 0.530 Test Loss: 2.311 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.2733703
	speed: 0.2228s/iter; left time: 2963.6570s
Epoch: 14 cost time: 6.583617448806763
Epoch: 14, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.515 Vali Acc: 0.507 Test Loss: 2.515 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.5289549
	speed: 0.2608s/iter; left time: 3428.0294s
Epoch: 15 cost time: 7.584125518798828
Epoch: 15, Steps: 154 | Train Loss: 0.557 Vali Loss: 2.439 Vali Acc: 0.520 Test Loss: 2.439 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6331680
	speed: 0.2269s/iter; left time: 2947.9007s
Epoch: 16 cost time: 7.668857574462891
Epoch: 16, Steps: 154 | Train Loss: 0.501 Vali Loss: 2.519 Vali Acc: 0.526 Test Loss: 2.519 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5346966
	speed: 0.2529s/iter; left time: 3246.8445s
Epoch: 17 cost time: 6.965178966522217
Epoch: 17, Steps: 154 | Train Loss: 0.488 Vali Loss: 2.596 Vali Acc: 0.494 Test Loss: 2.596 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.5646785
	speed: 0.2289s/iter; left time: 2903.2217s
Epoch: 18 cost time: 7.108415603637695
Epoch: 18, Steps: 154 | Train Loss: 0.434 Vali Loss: 3.006 Vali Acc: 0.476 Test Loss: 3.006 Test Acc: 0.476
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.8093265
	speed: 0.2509s/iter; left time: 3143.9035s
Epoch: 19 cost time: 6.731337070465088
Epoch: 19, Steps: 154 | Train Loss: 0.381 Vali Loss: 2.870 Vali Acc: 0.523 Test Loss: 2.870 Test Acc: 0.523
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.2021425
	speed: 0.2326s/iter; left time: 2878.8462s
Epoch: 20 cost time: 6.791433095932007
Epoch: 20, Steps: 154 | Train Loss: 0.396 Vali Loss: 2.813 Vali Acc: 0.538 Test Loss: 2.813 Test Acc: 0.538
Validation loss decreased (-0.530796 --> -0.537685).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.1583302
	speed: 0.2354s/iter; left time: 2876.5411s
Epoch: 21 cost time: 6.623688697814941
Epoch: 21, Steps: 154 | Train Loss: 0.361 Vali Loss: 2.994 Vali Acc: 0.523 Test Loss: 2.994 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5454956
	speed: 0.2423s/iter; left time: 2923.4165s
Epoch: 22 cost time: 6.519638776779175
Epoch: 22, Steps: 154 | Train Loss: 0.341 Vali Loss: 2.989 Vali Acc: 0.528 Test Loss: 2.989 Test Acc: 0.528
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2141069
	speed: 0.2387s/iter; left time: 2843.4046s
Epoch: 23 cost time: 7.116790056228638
Epoch: 23, Steps: 154 | Train Loss: 0.346 Vali Loss: 3.144 Vali Acc: 0.507 Test Loss: 3.144 Test Acc: 0.507
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2293563
	speed: 0.2544s/iter; left time: 2991.1921s
Epoch: 24 cost time: 7.131789922714233
Epoch: 24, Steps: 154 | Train Loss: 0.331 Vali Loss: 3.037 Vali Acc: 0.545 Test Loss: 3.037 Test Acc: 0.545
Validation loss decreased (-0.537685 --> -0.545387).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.4179408
	speed: 0.2291s/iter; left time: 2658.4953s
Epoch: 25 cost time: 6.79333233833313
Epoch: 25, Steps: 154 | Train Loss: 0.292 Vali Loss: 3.235 Vali Acc: 0.474 Test Loss: 3.235 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.4828230
	speed: 0.2265s/iter; left time: 2593.7023s
Epoch: 26 cost time: 6.481847286224365
Epoch: 26, Steps: 154 | Train Loss: 0.279 Vali Loss: 3.220 Vali Acc: 0.527 Test Loss: 3.220 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3471096
	speed: 0.2435s/iter; left time: 2751.1148s
Epoch: 27 cost time: 6.784332036972046
Epoch: 27, Steps: 154 | Train Loss: 0.254 Vali Loss: 3.300 Vali Acc: 0.554 Test Loss: 3.300 Test Acc: 0.554
Validation loss decreased (-0.545387 --> -0.554306).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.5054211
	speed: 0.2147s/iter; left time: 2392.4820s
Epoch: 28 cost time: 6.241241455078125
Epoch: 28, Steps: 154 | Train Loss: 0.243 Vali Loss: 3.450 Vali Acc: 0.534 Test Loss: 3.450 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.6418310
	speed: 0.2363s/iter; left time: 2597.0386s
Epoch: 29 cost time: 6.64292573928833
Epoch: 29, Steps: 154 | Train Loss: 0.242 Vali Loss: 3.291 Vali Acc: 0.560 Test Loss: 3.291 Test Acc: 0.560
Validation loss decreased (-0.554306 --> -0.560389).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.1973851
	speed: 0.2278s/iter; left time: 2468.3215s
Epoch: 30 cost time: 6.20627236366272
Epoch: 30, Steps: 154 | Train Loss: 0.202 Vali Loss: 3.352 Vali Acc: 0.534 Test Loss: 3.352 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0370107
	speed: 0.2056s/iter; left time: 2196.4781s
Epoch: 31 cost time: 6.290498971939087
Epoch: 31, Steps: 154 | Train Loss: 0.220 Vali Loss: 3.392 Vali Acc: 0.530 Test Loss: 3.392 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0533716
	speed: 0.2388s/iter; left time: 2514.3088s
Epoch: 32 cost time: 7.654835224151611
Epoch: 32, Steps: 154 | Train Loss: 0.217 Vali Loss: 3.445 Vali Acc: 0.502 Test Loss: 3.445 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0571652
	speed: 0.2356s/iter; left time: 2443.6423s
Epoch: 33 cost time: 5.805810451507568
Epoch: 33, Steps: 154 | Train Loss: 0.215 Vali Loss: 3.483 Vali Acc: 0.552 Test Loss: 3.483 Test Acc: 0.552
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0545236
	speed: 0.2263s/iter; left time: 2312.9618s
Epoch: 34 cost time: 6.622688055038452
Epoch: 34, Steps: 154 | Train Loss: 0.181 Vali Loss: 3.935 Vali Acc: 0.503 Test Loss: 3.935 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0274614
	speed: 0.2256s/iter; left time: 2270.6955s
Epoch: 35 cost time: 6.941086292266846
Epoch: 35, Steps: 154 | Train Loss: 0.193 Vali Loss: 3.589 Vali Acc: 0.544 Test Loss: 3.589 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0271335
	speed: 0.2513s/iter; left time: 2490.8412s
Epoch: 36 cost time: 6.9819841384887695
Epoch: 36, Steps: 154 | Train Loss: 0.184 Vali Loss: 3.619 Vali Acc: 0.539 Test Loss: 3.619 Test Acc: 0.539
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0038953
	speed: 0.2414s/iter; left time: 2355.5910s
Epoch: 37 cost time: 6.73464298248291
Epoch: 37, Steps: 154 | Train Loss: 0.178 Vali Loss: 3.773 Vali Acc: 0.511 Test Loss: 3.773 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0475733
	speed: 0.2167s/iter; left time: 2080.6646s
Epoch: 38 cost time: 5.755393028259277
Epoch: 38, Steps: 154 | Train Loss: 0.186 Vali Loss: 3.812 Vali Acc: 0.536 Test Loss: 3.812 Test Acc: 0.536
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.1664859
	speed: 0.2526s/iter; left time: 2386.7162s
Epoch: 39 cost time: 6.80653715133667
Epoch: 39, Steps: 154 | Train Loss: 0.175 Vali Loss: 3.957 Vali Acc: 0.516 Test Loss: 3.957 Test Acc: 0.516
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5604217356042174
model parameter : 98510
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5229267
	speed: 0.0746s/iter; left time: 1141.8004s
Epoch: 1 cost time: 9.51447319984436
Epoch: 1, Steps: 154 | Train Loss: 2.200 Vali Loss: 1.950 Vali Acc: 0.395 Test Loss: 1.950 Test Acc: 0.395
Validation loss decreased (inf --> -0.394952).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8845634
	speed: 0.2421s/iter; left time: 3666.4366s
Epoch: 2 cost time: 6.81676983833313
Epoch: 2, Steps: 154 | Train Loss: 1.611 Vali Loss: 1.962 Vali Acc: 0.418 Test Loss: 1.962 Test Acc: 0.418
Validation loss decreased (-0.394952 --> -0.417661).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5102743
	speed: 0.2279s/iter; left time: 3416.7765s
Epoch: 3 cost time: 6.328028202056885
Epoch: 3, Steps: 154 | Train Loss: 1.298 Vali Loss: 1.851 Vali Acc: 0.488 Test Loss: 1.851 Test Acc: 0.488
Validation loss decreased (-0.417661 --> -0.488222).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3207817
	speed: 0.2345s/iter; left time: 3479.0051s
Epoch: 4 cost time: 6.532666206359863
Epoch: 4, Steps: 154 | Train Loss: 1.187 Vali Loss: 1.724 Vali Acc: 0.515 Test Loss: 1.724 Test Acc: 0.515
Validation loss decreased (-0.488222 --> -0.514987).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0114777
	speed: 0.2030s/iter; left time: 2980.5798s
Epoch: 5 cost time: 6.16268515586853
Epoch: 5, Steps: 154 | Train Loss: 1.096 Vali Loss: 2.015 Vali Acc: 0.489 Test Loss: 2.015 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7712308
	speed: 0.2153s/iter; left time: 3128.3967s
Epoch: 6 cost time: 6.261332273483276
Epoch: 6, Steps: 154 | Train Loss: 1.041 Vali Loss: 1.819 Vali Acc: 0.522 Test Loss: 1.819 Test Acc: 0.522
Validation loss decreased (-0.514987 --> -0.521880).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1655178
	speed: 0.2090s/iter; left time: 3004.2801s
Epoch: 7 cost time: 6.383182525634766
Epoch: 7, Steps: 154 | Train Loss: 0.955 Vali Loss: 1.908 Vali Acc: 0.513 Test Loss: 1.908 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0954801
	speed: 0.2184s/iter; left time: 3106.5141s
Epoch: 8 cost time: 6.396791458129883
Epoch: 8, Steps: 154 | Train Loss: 0.900 Vali Loss: 2.550 Vali Acc: 0.481 Test Loss: 2.550 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0788164
	speed: 0.2096s/iter; left time: 2949.2604s
Epoch: 9 cost time: 6.437718152999878
Epoch: 9, Steps: 154 | Train Loss: 0.843 Vali Loss: 2.342 Vali Acc: 0.474 Test Loss: 2.342 Test Acc: 0.474
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1018125
	speed: 0.2192s/iter; left time: 3050.3230s
Epoch: 10 cost time: 6.652559280395508
Epoch: 10, Steps: 154 | Train Loss: 0.809 Vali Loss: 2.138 Vali Acc: 0.500 Test Loss: 2.138 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6179753
	speed: 0.2082s/iter; left time: 2864.5761s
Epoch: 11 cost time: 5.68807053565979
Epoch: 11, Steps: 154 | Train Loss: 0.726 Vali Loss: 2.144 Vali Acc: 0.526 Test Loss: 2.144 Test Acc: 0.526
Validation loss decreased (-0.521880 --> -0.526337).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6708503
	speed: 0.2146s/iter; left time: 2919.7271s
Epoch: 12 cost time: 6.126904249191284
Epoch: 12, Steps: 154 | Train Loss: 0.709 Vali Loss: 2.457 Vali Acc: 0.478 Test Loss: 2.457 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.8892708
	speed: 0.1817s/iter; left time: 2444.2305s
Epoch: 13 cost time: 5.390681982040405
Epoch: 13, Steps: 154 | Train Loss: 0.643 Vali Loss: 2.226 Vali Acc: 0.535 Test Loss: 2.226 Test Acc: 0.535
Validation loss decreased (-0.526337 --> -0.534852).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5421607
	speed: 0.2044s/iter; left time: 2718.6839s
Epoch: 14 cost time: 6.005799770355225
Epoch: 14, Steps: 154 | Train Loss: 0.621 Vali Loss: 2.254 Vali Acc: 0.522 Test Loss: 2.254 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.6979688
	speed: 0.2231s/iter; left time: 2932.1149s
Epoch: 15 cost time: 6.330994129180908
Epoch: 15, Steps: 154 | Train Loss: 0.576 Vali Loss: 2.549 Vali Acc: 0.499 Test Loss: 2.549 Test Acc: 0.499
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.8313933
	speed: 0.2299s/iter; left time: 2986.7501s
Epoch: 16 cost time: 6.921060800552368
Epoch: 16, Steps: 154 | Train Loss: 0.545 Vali Loss: 2.393 Vali Acc: 0.510 Test Loss: 2.393 Test Acc: 0.510
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.5491157
	speed: 0.2378s/iter; left time: 3052.2625s
Epoch: 17 cost time: 6.364244222640991
Epoch: 17, Steps: 154 | Train Loss: 0.491 Vali Loss: 2.505 Vali Acc: 0.541 Test Loss: 2.505 Test Acc: 0.541
Validation loss decreased (-0.534852 --> -0.540526).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.4642147
	speed: 0.2033s/iter; left time: 2578.5544s
Epoch: 18 cost time: 5.76013708114624
Epoch: 18, Steps: 154 | Train Loss: 0.475 Vali Loss: 2.695 Vali Acc: 0.518 Test Loss: 2.695 Test Acc: 0.518
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.6075374
	speed: 0.2124s/iter; left time: 2661.7196s
Epoch: 19 cost time: 6.053637981414795
Epoch: 19, Steps: 154 | Train Loss: 0.479 Vali Loss: 2.947 Vali Acc: 0.479 Test Loss: 2.947 Test Acc: 0.479
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.3394143
	speed: 0.1999s/iter; left time: 2473.6635s
Epoch: 20 cost time: 5.777904272079468
Epoch: 20, Steps: 154 | Train Loss: 0.433 Vali Loss: 2.711 Vali Acc: 0.478 Test Loss: 2.711 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.2832127
	speed: 0.2183s/iter; left time: 2667.8672s
Epoch: 21 cost time: 7.003938436508179
Epoch: 21, Steps: 154 | Train Loss: 0.445 Vali Loss: 2.850 Vali Acc: 0.531 Test Loss: 2.850 Test Acc: 0.531
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.4081501
	speed: 0.2037s/iter; left time: 2457.8235s
Epoch: 22 cost time: 5.958520889282227
Epoch: 22, Steps: 154 | Train Loss: 0.384 Vali Loss: 3.138 Vali Acc: 0.488 Test Loss: 3.138 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3248241
	speed: 0.2128s/iter; left time: 2534.9416s
Epoch: 23 cost time: 6.165630102157593
Epoch: 23, Steps: 154 | Train Loss: 0.368 Vali Loss: 2.737 Vali Acc: 0.529 Test Loss: 2.737 Test Acc: 0.529
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.2623906
	speed: 0.1975s/iter; left time: 2322.7265s
Epoch: 24 cost time: 5.16955828666687
Epoch: 24, Steps: 154 | Train Loss: 0.338 Vali Loss: 3.005 Vali Acc: 0.500 Test Loss: 3.005 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.2036697
	speed: 0.2009s/iter; left time: 2331.2776s
Epoch: 25 cost time: 5.792564868927002
Epoch: 25, Steps: 154 | Train Loss: 0.347 Vali Loss: 2.820 Vali Acc: 0.553 Test Loss: 2.820 Test Acc: 0.553
Validation loss decreased (-0.540526 --> -0.553094).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.1913808
	speed: 0.2113s/iter; left time: 2419.5922s
Epoch: 26 cost time: 5.672908544540405
Epoch: 26, Steps: 154 | Train Loss: 0.329 Vali Loss: 2.848 Vali Acc: 0.555 Test Loss: 2.848 Test Acc: 0.555
Validation loss decreased (-0.553094 --> -0.555122).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.2137542
	speed: 0.2104s/iter; left time: 2376.7171s
Epoch: 27 cost time: 6.508785009384155
Epoch: 27, Steps: 154 | Train Loss: 0.326 Vali Loss: 3.088 Vali Acc: 0.528 Test Loss: 3.088 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.3410572
	speed: 0.2231s/iter; left time: 2486.2272s
Epoch: 28 cost time: 6.490715026855469
Epoch: 28, Steps: 154 | Train Loss: 0.308 Vali Loss: 3.233 Vali Acc: 0.511 Test Loss: 3.233 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.5326541
	speed: 0.2378s/iter; left time: 2613.7179s
Epoch: 29 cost time: 6.437864542007446
Epoch: 29, Steps: 154 | Train Loss: 0.273 Vali Loss: 3.302 Vali Acc: 0.495 Test Loss: 3.302 Test Acc: 0.495
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.2630144
	speed: 0.2159s/iter; left time: 2339.5198s
Epoch: 30 cost time: 6.0940773487091064
Epoch: 30, Steps: 154 | Train Loss: 0.285 Vali Loss: 3.221 Vali Acc: 0.543 Test Loss: 3.221 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.5283345
	speed: 0.2196s/iter; left time: 2345.4913s
Epoch: 31 cost time: 6.234304428100586
Epoch: 31, Steps: 154 | Train Loss: 0.273 Vali Loss: 3.292 Vali Acc: 0.506 Test Loss: 3.292 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.3603097
	speed: 0.2096s/iter; left time: 2206.1554s
Epoch: 32 cost time: 6.483314037322998
Epoch: 32, Steps: 154 | Train Loss: 0.259 Vali Loss: 3.364 Vali Acc: 0.491 Test Loss: 3.364 Test Acc: 0.491
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.1492305
	speed: 0.2126s/iter; left time: 2205.0964s
Epoch: 33 cost time: 5.973554611206055
Epoch: 33, Steps: 154 | Train Loss: 0.229 Vali Loss: 3.426 Vali Acc: 0.512 Test Loss: 3.426 Test Acc: 0.512
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.2345851
	speed: 0.2178s/iter; left time: 2225.4625s
Epoch: 34 cost time: 6.109551668167114
Epoch: 34, Steps: 154 | Train Loss: 0.223 Vali Loss: 3.641 Vali Acc: 0.512 Test Loss: 3.641 Test Acc: 0.512
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0528046
	speed: 0.2022s/iter; left time: 2034.7290s
Epoch: 35 cost time: 5.657642602920532
Epoch: 35, Steps: 154 | Train Loss: 0.234 Vali Loss: 3.340 Vali Acc: 0.509 Test Loss: 3.340 Test Acc: 0.509
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.2041095
	speed: 0.2210s/iter; left time: 2190.7663s
Epoch: 36 cost time: 5.833405494689941
Epoch: 36, Steps: 154 | Train Loss: 0.215 Vali Loss: 3.580 Vali Acc: 0.512 Test Loss: 3.580 Test Acc: 0.512
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5551500405515004
model parameter : 82510
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3307736
	speed: 0.0679s/iter; left time: 1038.6384s
Epoch: 1 cost time: 8.578091382980347
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.065 Vali Acc: 0.365 Test Loss: 2.065 Test Acc: 0.365
Validation loss decreased (inf --> -0.364943).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8784945
	speed: 0.1976s/iter; left time: 2992.9338s
Epoch: 2 cost time: 6.092504262924194
Epoch: 2, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.002 Vali Acc: 0.426 Test Loss: 2.002 Test Acc: 0.426
Validation loss decreased (-0.364943 --> -0.426176).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2455801
	speed: 0.2158s/iter; left time: 3235.9864s
Epoch: 3 cost time: 6.012133836746216
Epoch: 3, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.002 Vali Acc: 0.456 Test Loss: 2.002 Test Acc: 0.456
Validation loss decreased (-0.426176 --> -0.456184).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0382720
	speed: 0.1931s/iter; left time: 2865.1189s
Epoch: 4 cost time: 6.049072980880737
Epoch: 4, Steps: 154 | Train Loss: 1.194 Vali Loss: 1.945 Vali Acc: 0.473 Test Loss: 1.945 Test Acc: 0.473
Validation loss decreased (-0.456184 --> -0.473217).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9811776
	speed: 0.2314s/iter; left time: 3398.4668s
Epoch: 5 cost time: 7.282212018966675
Epoch: 5, Steps: 154 | Train Loss: 1.116 Vali Loss: 2.016 Vali Acc: 0.488 Test Loss: 2.016 Test Acc: 0.488
Validation loss decreased (-0.473217 --> -0.488220).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8967687
	speed: 0.2493s/iter; left time: 3622.6983s
Epoch: 6 cost time: 6.9877777099609375
Epoch: 6, Steps: 154 | Train Loss: 1.069 Vali Loss: 1.856 Vali Acc: 0.521 Test Loss: 1.856 Test Acc: 0.521
Validation loss decreased (-0.488220 --> -0.520663).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7129514
	speed: 0.2340s/iter; left time: 3364.4060s
Epoch: 7 cost time: 6.893974781036377
Epoch: 7, Steps: 154 | Train Loss: 0.986 Vali Loss: 2.012 Vali Acc: 0.515 Test Loss: 2.012 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6710904
	speed: 0.2450s/iter; left time: 3484.3112s
Epoch: 8 cost time: 6.755429267883301
Epoch: 8, Steps: 154 | Train Loss: 0.929 Vali Loss: 2.029 Vali Acc: 0.487 Test Loss: 2.029 Test Acc: 0.487
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6791593
	speed: 0.2243s/iter; left time: 3156.1022s
Epoch: 9 cost time: 6.8241236209869385
Epoch: 9, Steps: 154 | Train Loss: 0.887 Vali Loss: 2.009 Vali Acc: 0.530 Test Loss: 2.009 Test Acc: 0.530
Validation loss decreased (-0.520663 --> -0.529988).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4847797
	speed: 0.2322s/iter; left time: 3230.9588s
Epoch: 10 cost time: 6.305855751037598
Epoch: 10, Steps: 154 | Train Loss: 0.813 Vali Loss: 1.945 Vali Acc: 0.514 Test Loss: 1.945 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2711003
	speed: 0.2263s/iter; left time: 3113.9743s
Epoch: 11 cost time: 6.101456165313721
Epoch: 11, Steps: 154 | Train Loss: 0.785 Vali Loss: 1.885 Vali Acc: 0.518 Test Loss: 1.885 Test Acc: 0.518
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.6340287
	speed: 0.2455s/iter; left time: 3340.7703s
Epoch: 12 cost time: 7.108529329299927
Epoch: 12, Steps: 154 | Train Loss: 0.765 Vali Loss: 2.046 Vali Acc: 0.537 Test Loss: 2.046 Test Acc: 0.537
Validation loss decreased (-0.529988 --> -0.536881).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4910034
	speed: 0.2274s/iter; left time: 3059.1118s
Epoch: 13 cost time: 6.6848533153533936
Epoch: 13, Steps: 154 | Train Loss: 0.700 Vali Loss: 2.257 Vali Acc: 0.508 Test Loss: 2.257 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5956410
	speed: 0.2306s/iter; left time: 3066.4926s
Epoch: 14 cost time: 6.451890468597412
Epoch: 14, Steps: 154 | Train Loss: 0.659 Vali Loss: 2.271 Vali Acc: 0.513 Test Loss: 2.271 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6165073
	speed: 0.2181s/iter; left time: 2866.8450s
Epoch: 15 cost time: 6.326847791671753
Epoch: 15, Steps: 154 | Train Loss: 0.631 Vali Loss: 2.238 Vali Acc: 0.512 Test Loss: 2.238 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.4719726
	speed: 0.2180s/iter; left time: 2831.9385s
Epoch: 16 cost time: 6.309305667877197
Epoch: 16, Steps: 154 | Train Loss: 0.599 Vali Loss: 2.277 Vali Acc: 0.512 Test Loss: 2.277 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1747568
	speed: 0.2145s/iter; left time: 2753.9120s
Epoch: 17 cost time: 6.034571409225464
Epoch: 17, Steps: 154 | Train Loss: 0.552 Vali Loss: 2.331 Vali Acc: 0.534 Test Loss: 2.331 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2336539
	speed: 0.1982s/iter; left time: 2514.2618s
Epoch: 18 cost time: 5.651745319366455
Epoch: 18, Steps: 154 | Train Loss: 0.548 Vali Loss: 2.452 Vali Acc: 0.497 Test Loss: 2.452 Test Acc: 0.497
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.7291591
	speed: 0.2182s/iter; left time: 2734.2742s
Epoch: 19 cost time: 6.494317054748535
Epoch: 19, Steps: 154 | Train Loss: 0.520 Vali Loss: 2.715 Vali Acc: 0.511 Test Loss: 2.715 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.5041513
	speed: 0.2365s/iter; left time: 2926.7083s
Epoch: 20 cost time: 7.68476939201355
Epoch: 20, Steps: 154 | Train Loss: 0.459 Vali Loss: 2.684 Vali Acc: 0.525 Test Loss: 2.684 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.5921077
	speed: 0.2288s/iter; left time: 2796.3125s
Epoch: 21 cost time: 6.569068670272827
Epoch: 21, Steps: 154 | Train Loss: 0.458 Vali Loss: 2.748 Vali Acc: 0.511 Test Loss: 2.748 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.3602051
	speed: 0.2318s/iter; left time: 2797.0835s
Epoch: 22 cost time: 7.222930669784546
Epoch: 22, Steps: 154 | Train Loss: 0.407 Vali Loss: 2.500 Vali Acc: 0.541 Test Loss: 2.500 Test Acc: 0.541
Validation loss decreased (-0.536881 --> -0.540527).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.2465729
	speed: 0.2456s/iter; left time: 2925.4420s
Epoch: 23 cost time: 6.926019191741943
Epoch: 23, Steps: 154 | Train Loss: 0.386 Vali Loss: 2.672 Vali Acc: 0.498 Test Loss: 2.672 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.4549966
	speed: 0.2330s/iter; left time: 2740.1083s
Epoch: 24 cost time: 6.322732210159302
Epoch: 24, Steps: 154 | Train Loss: 0.411 Vali Loss: 2.494 Vali Acc: 0.531 Test Loss: 2.494 Test Acc: 0.531
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.1838376
	speed: 0.2355s/iter; left time: 2732.6702s
Epoch: 25 cost time: 6.426136493682861
Epoch: 25, Steps: 154 | Train Loss: 0.361 Vali Loss: 3.017 Vali Acc: 0.494 Test Loss: 3.017 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0762242
	speed: 0.2053s/iter; left time: 2351.1834s
Epoch: 26 cost time: 6.602257966995239
Epoch: 26, Steps: 154 | Train Loss: 0.344 Vali Loss: 2.859 Vali Acc: 0.493 Test Loss: 2.859 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0920667
	speed: 0.2049s/iter; left time: 2314.9859s
Epoch: 27 cost time: 5.578613758087158
Epoch: 27, Steps: 154 | Train Loss: 0.353 Vali Loss: 3.268 Vali Acc: 0.492 Test Loss: 3.268 Test Acc: 0.492
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.3194380
	speed: 0.2207s/iter; left time: 2459.6230s
Epoch: 28 cost time: 6.697466850280762
Epoch: 28, Steps: 154 | Train Loss: 0.323 Vali Loss: 2.920 Vali Acc: 0.498 Test Loss: 2.920 Test Acc: 0.498
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.2292328
	speed: 0.2323s/iter; left time: 2552.4295s
Epoch: 29 cost time: 6.495492696762085
Epoch: 29, Steps: 154 | Train Loss: 0.289 Vali Loss: 2.896 Vali Acc: 0.491 Test Loss: 2.896 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.0715164
	speed: 0.2127s/iter; left time: 2304.1472s
Epoch: 30 cost time: 6.727884769439697
Epoch: 30, Steps: 154 | Train Loss: 0.293 Vali Loss: 2.840 Vali Acc: 0.493 Test Loss: 2.840 Test Acc: 0.493
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.3716017
	speed: 0.2204s/iter; left time: 2354.5616s
Epoch: 31 cost time: 6.1836628913879395
Epoch: 31, Steps: 154 | Train Loss: 0.311 Vali Loss: 3.109 Vali Acc: 0.500 Test Loss: 3.109 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.5952340
	speed: 0.1887s/iter; left time: 1986.8410s
Epoch: 32 cost time: 6.4508445262908936
Epoch: 32, Steps: 154 | Train Loss: 0.260 Vali Loss: 3.111 Vali Acc: 0.513 Test Loss: 3.111 Test Acc: 0.513
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.540551500405515
model parameter : 71822
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1031249
	speed: 0.0713s/iter; left time: 1091.1923s
Epoch: 1 cost time: 8.69757080078125
Epoch: 1, Steps: 154 | Train Loss: 2.046 Vali Loss: 1.869 Vali Acc: 0.434 Test Loss: 1.869 Test Acc: 0.434
Validation loss decreased (inf --> -0.433882).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4236003
	speed: 0.1843s/iter; left time: 2791.0499s
Epoch: 2 cost time: 5.508168458938599
Epoch: 2, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.233 Vali Acc: 0.473 Test Loss: 2.233 Test Acc: 0.473
Validation loss decreased (-0.433882 --> -0.472808).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4421350
	speed: 0.1741s/iter; left time: 2610.1816s
Epoch: 3 cost time: 5.542863130569458
Epoch: 3, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.271 Vali Acc: 0.470 Test Loss: 2.271 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0452694
	speed: 0.1645s/iter; left time: 2441.4288s
Epoch: 4 cost time: 4.969839334487915
Epoch: 4, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.406 Vali Acc: 0.435 Test Loss: 2.406 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.0468905
	speed: 0.2271s/iter; left time: 3335.0019s
Epoch: 5 cost time: 9.89274787902832
Epoch: 5, Steps: 154 | Train Loss: 1.242 Vali Loss: 2.326 Vali Acc: 0.497 Test Loss: 2.326 Test Acc: 0.497
Validation loss decreased (-0.472808 --> -0.497138).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1357673
	speed: 0.2863s/iter; left time: 4159.5672s
Epoch: 6 cost time: 9.968748331069946
Epoch: 6, Steps: 154 | Train Loss: 1.075 Vali Loss: 2.634 Vali Acc: 0.494 Test Loss: 2.634 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9645303
	speed: 0.2610s/iter; left time: 3752.2546s
Epoch: 7 cost time: 10.396449327468872
Epoch: 7, Steps: 154 | Train Loss: 0.989 Vali Loss: 2.937 Vali Acc: 0.465 Test Loss: 2.937 Test Acc: 0.465
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1777576
	speed: 0.2944s/iter; left time: 4187.4401s
Epoch: 8 cost time: 10.419734001159668
Epoch: 8, Steps: 154 | Train Loss: 0.920 Vali Loss: 3.073 Vali Acc: 0.494 Test Loss: 3.073 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3611397
	speed: 0.2594s/iter; left time: 3648.8094s
Epoch: 9 cost time: 9.57226300239563
Epoch: 9, Steps: 154 | Train Loss: 0.769 Vali Loss: 3.366 Vali Acc: 0.467 Test Loss: 3.366 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6882885
	speed: 0.2649s/iter; left time: 3686.1319s
Epoch: 10 cost time: 8.603620529174805
Epoch: 10, Steps: 154 | Train Loss: 0.773 Vali Loss: 3.298 Vali Acc: 0.504 Test Loss: 3.298 Test Acc: 0.504
Validation loss decreased (-0.497138 --> -0.504428).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9181243
	speed: 0.2608s/iter; left time: 3589.1724s
Epoch: 11 cost time: 9.215993165969849
Epoch: 11, Steps: 154 | Train Loss: 0.673 Vali Loss: 3.643 Vali Acc: 0.410 Test Loss: 3.643 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2680521
	speed: 0.2461s/iter; left time: 3349.1172s
Epoch: 12 cost time: 8.807349443435669
Epoch: 12, Steps: 154 | Train Loss: 0.580 Vali Loss: 3.386 Vali Acc: 0.468 Test Loss: 3.386 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3088135
	speed: 0.2591s/iter; left time: 3486.1979s
Epoch: 13 cost time: 8.593438863754272
Epoch: 13, Steps: 154 | Train Loss: 0.495 Vali Loss: 4.488 Vali Acc: 0.416 Test Loss: 4.488 Test Acc: 0.416
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0336235
	speed: 0.2176s/iter; left time: 2894.4689s
Epoch: 14 cost time: 6.096494197845459
Epoch: 14, Steps: 154 | Train Loss: 0.451 Vali Loss: 4.935 Vali Acc: 0.408 Test Loss: 4.935 Test Acc: 0.408
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2391818
	speed: 0.2357s/iter; left time: 3098.4805s
Epoch: 15 cost time: 7.333435297012329
Epoch: 15, Steps: 154 | Train Loss: 0.464 Vali Loss: 4.661 Vali Acc: 0.468 Test Loss: 4.661 Test Acc: 0.468
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.2703244
	speed: 0.2314s/iter; left time: 3006.2031s
Epoch: 16 cost time: 6.609031677246094
Epoch: 16, Steps: 154 | Train Loss: 0.426 Vali Loss: 5.588 Vali Acc: 0.391 Test Loss: 5.588 Test Acc: 0.391
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.8750376
	speed: 0.2379s/iter; left time: 3053.4907s
Epoch: 17 cost time: 7.162545919418335
Epoch: 17, Steps: 154 | Train Loss: 0.388 Vali Loss: 5.610 Vali Acc: 0.377 Test Loss: 5.610 Test Acc: 0.377
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.1015816
	speed: 0.2388s/iter; left time: 3029.0683s
Epoch: 18 cost time: 8.31542181968689
Epoch: 18, Steps: 154 | Train Loss: 0.401 Vali Loss: 4.946 Vali Acc: 0.432 Test Loss: 4.946 Test Acc: 0.432
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2977726
	speed: 0.2496s/iter; left time: 3126.7036s
Epoch: 19 cost time: 6.872859954833984
Epoch: 19, Steps: 154 | Train Loss: 0.343 Vali Loss: 5.118 Vali Acc: 0.422 Test Loss: 5.118 Test Acc: 0.422
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.1347092
	speed: 0.2321s/iter; left time: 2871.6622s
Epoch: 20 cost time: 5.880391836166382
Epoch: 20, Steps: 154 | Train Loss: 0.284 Vali Loss: 4.911 Vali Acc: 0.443 Test Loss: 4.911 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5044606650446066
model parameter : 219022
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.3749558
	speed: 0.0768s/iter; left time: 1174.9778s
Epoch: 1 cost time: 9.994368076324463
Epoch: 1, Steps: 154 | Train Loss: 2.090 Vali Loss: 1.867 Vali Acc: 0.429 Test Loss: 1.867 Test Acc: 0.429
Validation loss decreased (inf --> -0.429016).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4446030
	speed: 0.2167s/iter; left time: 3281.9120s
Epoch: 2 cost time: 6.228632926940918
Epoch: 2, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.104 Vali Acc: 0.466 Test Loss: 2.104 Test Acc: 0.466
Validation loss decreased (-0.429016 --> -0.466321).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3160710
	speed: 0.2259s/iter; left time: 3387.6596s
Epoch: 3 cost time: 6.87916898727417
Epoch: 3, Steps: 154 | Train Loss: 1.279 Vali Loss: 1.886 Vali Acc: 0.510 Test Loss: 1.886 Test Acc: 0.510
Validation loss decreased (-0.466321 --> -0.510119).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4551883
	speed: 0.2182s/iter; left time: 3237.5985s
Epoch: 4 cost time: 6.230953693389893
Epoch: 4, Steps: 154 | Train Loss: 1.155 Vali Loss: 2.004 Vali Acc: 0.450 Test Loss: 2.004 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0583448
	speed: 0.2484s/iter; left time: 3647.3514s
Epoch: 5 cost time: 7.475546836853027
Epoch: 5, Steps: 154 | Train Loss: 1.131 Vali Loss: 1.953 Vali Acc: 0.513 Test Loss: 1.953 Test Acc: 0.513
Validation loss decreased (-0.510119 --> -0.512551).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3275915
	speed: 0.2242s/iter; left time: 3258.2290s
Epoch: 6 cost time: 6.23671293258667
Epoch: 6, Steps: 154 | Train Loss: 1.041 Vali Loss: 2.121 Vali Acc: 0.445 Test Loss: 2.121 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2127249
	speed: 0.2406s/iter; left time: 3458.5163s
Epoch: 7 cost time: 6.871169090270996
Epoch: 7, Steps: 154 | Train Loss: 0.970 Vali Loss: 2.201 Vali Acc: 0.506 Test Loss: 2.201 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4898279
	speed: 0.2453s/iter; left time: 3488.6254s
Epoch: 8 cost time: 7.15363073348999
Epoch: 8, Steps: 154 | Train Loss: 0.879 Vali Loss: 2.541 Vali Acc: 0.416 Test Loss: 2.541 Test Acc: 0.416
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.8607688
	speed: 0.2322s/iter; left time: 3266.5890s
Epoch: 9 cost time: 6.446331739425659
Epoch: 9, Steps: 154 | Train Loss: 0.847 Vali Loss: 2.301 Vali Acc: 0.525 Test Loss: 2.301 Test Acc: 0.525
Validation loss decreased (-0.512551 --> -0.525119).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6299644
	speed: 0.2234s/iter; left time: 3109.1687s
Epoch: 10 cost time: 6.011269569396973
Epoch: 10, Steps: 154 | Train Loss: 0.767 Vali Loss: 2.248 Vali Acc: 0.547 Test Loss: 2.248 Test Acc: 0.547
Validation loss decreased (-0.525119 --> -0.547423).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2437451
	speed: 0.1975s/iter; left time: 2717.1418s
Epoch: 11 cost time: 6.249048471450806
Epoch: 11, Steps: 154 | Train Loss: 0.699 Vali Loss: 2.643 Vali Acc: 0.533 Test Loss: 2.643 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2530612
	speed: 0.2187s/iter; left time: 2976.3622s
Epoch: 12 cost time: 6.788675546646118
Epoch: 12, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.590 Vali Acc: 0.513 Test Loss: 2.590 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0875925
	speed: 0.1862s/iter; left time: 2504.3485s
Epoch: 13 cost time: 5.92903733253479
Epoch: 13, Steps: 154 | Train Loss: 0.613 Vali Loss: 2.736 Vali Acc: 0.462 Test Loss: 2.736 Test Acc: 0.462
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.7097964
	speed: 0.2065s/iter; left time: 2746.8154s
Epoch: 14 cost time: 5.416678428649902
Epoch: 14, Steps: 154 | Train Loss: 0.569 Vali Loss: 2.728 Vali Acc: 0.494 Test Loss: 2.728 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.5505864
	speed: 0.1925s/iter; left time: 2530.0041s
Epoch: 15 cost time: 6.145396709442139
Epoch: 15, Steps: 154 | Train Loss: 0.498 Vali Loss: 2.767 Vali Acc: 0.457 Test Loss: 2.767 Test Acc: 0.457
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0448022
	speed: 0.2101s/iter; left time: 2729.9531s
Epoch: 16 cost time: 5.903849840164185
Epoch: 16, Steps: 154 | Train Loss: 0.500 Vali Loss: 2.869 Vali Acc: 0.522 Test Loss: 2.869 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2200956
	speed: 0.2429s/iter; left time: 3117.5998s
Epoch: 17 cost time: 6.682275056838989
Epoch: 17, Steps: 154 | Train Loss: 0.448 Vali Loss: 2.868 Vali Acc: 0.525 Test Loss: 2.868 Test Acc: 0.525
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.4086176
	speed: 0.2119s/iter; left time: 2687.9596s
Epoch: 18 cost time: 6.252243518829346
Epoch: 18, Steps: 154 | Train Loss: 0.448 Vali Loss: 3.121 Vali Acc: 0.515 Test Loss: 3.121 Test Acc: 0.515
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.4978328
	speed: 0.2347s/iter; left time: 2940.1211s
Epoch: 19 cost time: 6.184977769851685
Epoch: 19, Steps: 154 | Train Loss: 0.375 Vali Loss: 3.165 Vali Acc: 0.521 Test Loss: 3.165 Test Acc: 0.521
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.4635169
	speed: 0.2151s/iter; left time: 2662.2692s
Epoch: 20 cost time: 6.796729564666748
Epoch: 20, Steps: 154 | Train Loss: 0.344 Vali Loss: 3.124 Vali Acc: 0.480 Test Loss: 3.124 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5474452554744526
model parameter : 122318
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.2965293
	speed: 0.0634s/iter; left time: 969.5757s
Epoch: 1 cost time: 8.295599699020386
Epoch: 1, Steps: 154 | Train Loss: 2.066 Vali Loss: 1.809 Vali Acc: 0.404 Test Loss: 1.809 Test Acc: 0.404
Validation loss decreased (inf --> -0.403875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6504440
	speed: 0.2325s/iter; left time: 3522.2299s
Epoch: 2 cost time: 6.960931301116943
Epoch: 2, Steps: 154 | Train Loss: 1.427 Vali Loss: 1.707 Vali Acc: 0.495 Test Loss: 1.707 Test Acc: 0.495
Validation loss decreased (-0.403875 --> -0.495117).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5476816
	speed: 0.2586s/iter; left time: 3877.7577s
Epoch: 3 cost time: 7.457091808319092
Epoch: 3, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.444 Vali Acc: 0.442 Test Loss: 2.444 Test Acc: 0.442
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4711428
	speed: 0.2580s/iter; left time: 3828.6133s
Epoch: 4 cost time: 6.910288095474243
Epoch: 4, Steps: 154 | Train Loss: 1.184 Vali Loss: 1.861 Vali Acc: 0.520 Test Loss: 1.861 Test Acc: 0.520
Validation loss decreased (-0.495117 --> -0.519852).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5338496
	speed: 0.2452s/iter; left time: 3600.2243s
Epoch: 5 cost time: 7.207827091217041
Epoch: 5, Steps: 154 | Train Loss: 1.084 Vali Loss: 1.928 Vali Acc: 0.533 Test Loss: 1.928 Test Acc: 0.533
Validation loss decreased (-0.519852 --> -0.532827).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6600528
	speed: 0.2700s/iter; left time: 3923.9170s
Epoch: 6 cost time: 7.462588787078857
Epoch: 6, Steps: 154 | Train Loss: 0.994 Vali Loss: 2.083 Vali Acc: 0.487 Test Loss: 2.083 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.6971469
	speed: 0.2406s/iter; left time: 3458.7395s
Epoch: 7 cost time: 6.193906545639038
Epoch: 7, Steps: 154 | Train Loss: 0.944 Vali Loss: 2.016 Vali Acc: 0.500 Test Loss: 2.016 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.3734819
	speed: 0.2546s/iter; left time: 3621.6418s
Epoch: 8 cost time: 7.561884164810181
Epoch: 8, Steps: 154 | Train Loss: 0.912 Vali Loss: 2.176 Vali Acc: 0.506 Test Loss: 2.176 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1491778
	speed: 0.2432s/iter; left time: 3421.1011s
Epoch: 9 cost time: 7.363412618637085
Epoch: 9, Steps: 154 | Train Loss: 0.806 Vali Loss: 2.277 Vali Acc: 0.512 Test Loss: 2.277 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.8281187
	speed: 0.2456s/iter; left time: 3418.2096s
Epoch: 10 cost time: 6.875026702880859
Epoch: 10, Steps: 154 | Train Loss: 0.771 Vali Loss: 2.135 Vali Acc: 0.532 Test Loss: 2.135 Test Acc: 0.532
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4921494
	speed: 0.2298s/iter; left time: 3162.5094s
Epoch: 11 cost time: 6.590753555297852
Epoch: 11, Steps: 154 | Train Loss: 0.714 Vali Loss: 2.312 Vali Acc: 0.521 Test Loss: 2.312 Test Acc: 0.521
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.5249550
	speed: 0.2281s/iter; left time: 3103.1612s
Epoch: 12 cost time: 6.814901113510132
Epoch: 12, Steps: 154 | Train Loss: 0.647 Vali Loss: 2.601 Vali Acc: 0.517 Test Loss: 2.601 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.8421738
	speed: 0.2266s/iter; left time: 3048.9957s
Epoch: 13 cost time: 6.40644645690918
Epoch: 13, Steps: 154 | Train Loss: 0.588 Vali Loss: 2.287 Vali Acc: 0.547 Test Loss: 2.287 Test Acc: 0.547
Validation loss decreased (-0.532827 --> -0.547422).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9224651
	speed: 0.2069s/iter; left time: 2751.2568s
Epoch: 14 cost time: 6.587989807128906
Epoch: 14, Steps: 154 | Train Loss: 0.553 Vali Loss: 2.475 Vali Acc: 0.529 Test Loss: 2.475 Test Acc: 0.529
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1834000
	speed: 0.2153s/iter; left time: 2830.0298s
Epoch: 15 cost time: 6.195617437362671
Epoch: 15, Steps: 154 | Train Loss: 0.502 Vali Loss: 2.655 Vali Acc: 0.525 Test Loss: 2.655 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5001137
	speed: 0.1954s/iter; left time: 2538.4416s
Epoch: 16 cost time: 6.233201503753662
Epoch: 16, Steps: 154 | Train Loss: 0.468 Vali Loss: 2.616 Vali Acc: 0.535 Test Loss: 2.616 Test Acc: 0.535
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4063691
	speed: 0.2108s/iter; left time: 2706.0419s
Epoch: 17 cost time: 6.590291976928711
Epoch: 17, Steps: 154 | Train Loss: 0.426 Vali Loss: 2.853 Vali Acc: 0.533 Test Loss: 2.853 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.7586738
	speed: 0.2025s/iter; left time: 2567.9568s
Epoch: 18 cost time: 6.4943578243255615
Epoch: 18, Steps: 154 | Train Loss: 0.403 Vali Loss: 2.926 Vali Acc: 0.521 Test Loss: 2.926 Test Acc: 0.521
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4199759
	speed: 0.2215s/iter; left time: 2775.0008s
Epoch: 19 cost time: 5.524636268615723
Epoch: 19, Steps: 154 | Train Loss: 0.378 Vali Loss: 3.046 Vali Acc: 0.517 Test Loss: 3.046 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3096284
	speed: 0.2342s/iter; left time: 2898.4527s
Epoch: 20 cost time: 7.860260248184204
Epoch: 20, Steps: 154 | Train Loss: 0.342 Vali Loss: 2.966 Vali Acc: 0.528 Test Loss: 2.966 Test Acc: 0.528
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.3420503
	speed: 0.2539s/iter; left time: 3103.4690s
Epoch: 21 cost time: 6.944218635559082
Epoch: 21, Steps: 154 | Train Loss: 0.321 Vali Loss: 3.070 Vali Acc: 0.532 Test Loss: 3.070 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.2488239
	speed: 0.2403s/iter; left time: 2899.7219s
Epoch: 22 cost time: 7.521018981933594
Epoch: 22, Steps: 154 | Train Loss: 0.306 Vali Loss: 3.489 Vali Acc: 0.464 Test Loss: 3.489 Test Acc: 0.464
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2671753
	speed: 0.2366s/iter; left time: 2818.7071s
Epoch: 23 cost time: 6.855878829956055
Epoch: 23, Steps: 154 | Train Loss: 0.305 Vali Loss: 3.388 Vali Acc: 0.527 Test Loss: 3.388 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5474452554744526
model parameter : 122382
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4641833
	speed: 0.0740s/iter; left time: 1131.9734s
Epoch: 1 cost time: 9.456937789916992
Epoch: 1, Steps: 154 | Train Loss: 2.153 Vali Loss: 1.886 Vali Acc: 0.403 Test Loss: 1.886 Test Acc: 0.403
Validation loss decreased (inf --> -0.403469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4047683
	speed: 0.2463s/iter; left time: 3731.3433s
Epoch: 2 cost time: 6.947129249572754
Epoch: 2, Steps: 154 | Train Loss: 1.501 Vali Loss: 1.793 Vali Acc: 0.468 Test Loss: 1.793 Test Acc: 0.468
Validation loss decreased (-0.403469 --> -0.467541).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7512429
	speed: 0.2337s/iter; left time: 3503.3620s
Epoch: 3 cost time: 6.1846771240234375
Epoch: 3, Steps: 154 | Train Loss: 1.281 Vali Loss: 2.017 Vali Acc: 0.457 Test Loss: 2.017 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.4259326
	speed: 0.2356s/iter; left time: 3495.3797s
Epoch: 4 cost time: 6.523273229598999
Epoch: 4, Steps: 154 | Train Loss: 1.188 Vali Loss: 2.137 Vali Acc: 0.459 Test Loss: 2.137 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.3497893
	speed: 0.1985s/iter; left time: 2914.4570s
Epoch: 5 cost time: 5.914576768875122
Epoch: 5, Steps: 154 | Train Loss: 1.070 Vali Loss: 2.228 Vali Acc: 0.499 Test Loss: 2.228 Test Acc: 0.499
Validation loss decreased (-0.467541 --> -0.498761).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4618381
	speed: 0.2241s/iter; left time: 3256.9085s
Epoch: 6 cost time: 5.604083299636841
Epoch: 6, Steps: 154 | Train Loss: 1.032 Vali Loss: 2.261 Vali Acc: 0.477 Test Loss: 2.261 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2609388
	speed: 0.2061s/iter; left time: 2962.4426s
Epoch: 7 cost time: 6.3966851234436035
Epoch: 7, Steps: 154 | Train Loss: 0.939 Vali Loss: 2.152 Vali Acc: 0.485 Test Loss: 2.152 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3817681
	speed: 0.2258s/iter; left time: 3211.5567s
Epoch: 8 cost time: 6.858591794967651
Epoch: 8, Steps: 154 | Train Loss: 0.882 Vali Loss: 2.045 Vali Acc: 0.529 Test Loss: 2.045 Test Acc: 0.529
Validation loss decreased (-0.498761 --> -0.529177).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7428479
	speed: 0.2314s/iter; left time: 3256.0737s
Epoch: 9 cost time: 6.797262191772461
Epoch: 9, Steps: 154 | Train Loss: 0.851 Vali Loss: 2.049 Vali Acc: 0.512 Test Loss: 2.049 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.4936398
	speed: 0.2123s/iter; left time: 2954.1723s
Epoch: 10 cost time: 6.277959823608398
Epoch: 10, Steps: 154 | Train Loss: 0.803 Vali Loss: 2.253 Vali Acc: 0.477 Test Loss: 2.253 Test Acc: 0.477
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2663150
	speed: 0.2217s/iter; left time: 3051.2952s
Epoch: 11 cost time: 6.435469627380371
Epoch: 11, Steps: 154 | Train Loss: 0.764 Vali Loss: 2.266 Vali Acc: 0.511 Test Loss: 2.266 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.5284481
	speed: 0.2260s/iter; left time: 3075.3509s
Epoch: 12 cost time: 5.895342826843262
Epoch: 12, Steps: 154 | Train Loss: 0.718 Vali Loss: 2.742 Vali Acc: 0.491 Test Loss: 2.742 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9374572
	speed: 0.2012s/iter; left time: 2706.6022s
Epoch: 13 cost time: 5.367042303085327
Epoch: 13, Steps: 154 | Train Loss: 0.670 Vali Loss: 2.500 Vali Acc: 0.502 Test Loss: 2.500 Test Acc: 0.502
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.4841242
	speed: 0.1998s/iter; left time: 2656.4965s
Epoch: 14 cost time: 5.383461236953735
Epoch: 14, Steps: 154 | Train Loss: 0.606 Vali Loss: 2.466 Vali Acc: 0.510 Test Loss: 2.466 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.5930459
	speed: 0.2013s/iter; left time: 2646.1017s
Epoch: 15 cost time: 5.4459168910980225
Epoch: 15, Steps: 154 | Train Loss: 0.569 Vali Loss: 2.747 Vali Acc: 0.471 Test Loss: 2.747 Test Acc: 0.471
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.4903556
	speed: 0.2110s/iter; left time: 2740.7441s
Epoch: 16 cost time: 6.524686336517334
Epoch: 16, Steps: 154 | Train Loss: 0.545 Vali Loss: 2.623 Vali Acc: 0.525 Test Loss: 2.623 Test Acc: 0.525
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.5838873
	speed: 0.2313s/iter; left time: 2968.7237s
Epoch: 17 cost time: 6.81158971786499
Epoch: 17, Steps: 154 | Train Loss: 0.482 Vali Loss: 2.839 Vali Acc: 0.520 Test Loss: 2.839 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.4531054
	speed: 0.2187s/iter; left time: 2773.3839s
Epoch: 18 cost time: 6.286247730255127
Epoch: 18, Steps: 154 | Train Loss: 0.493 Vali Loss: 3.121 Vali Acc: 0.511 Test Loss: 3.121 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5291970802919708
model parameter : 90254
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4465545
	speed: 0.0722s/iter; left time: 1105.3794s
Epoch: 1 cost time: 9.299865245819092
Epoch: 1, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.022 Vali Acc: 0.393 Test Loss: 2.022 Test Acc: 0.393
Validation loss decreased (inf --> -0.392518).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3585366
	speed: 0.2742s/iter; left time: 4152.7265s
Epoch: 2 cost time: 8.108895063400269
Epoch: 2, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.107 Vali Acc: 0.438 Test Loss: 2.107 Test Acc: 0.438
Validation loss decreased (-0.392518 --> -0.438341).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6125821
	speed: 0.2448s/iter; left time: 3670.2937s
Epoch: 3 cost time: 7.047422885894775
Epoch: 3, Steps: 154 | Train Loss: 1.284 Vali Loss: 2.152 Vali Acc: 0.420 Test Loss: 2.152 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1596950
	speed: 0.2630s/iter; left time: 3903.0239s
Epoch: 4 cost time: 7.018765449523926
Epoch: 4, Steps: 154 | Train Loss: 1.186 Vali Loss: 1.957 Vali Acc: 0.487 Test Loss: 1.957 Test Acc: 0.487
Validation loss decreased (-0.438341 --> -0.486598).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7790349
	speed: 0.2498s/iter; left time: 3668.6563s
Epoch: 5 cost time: 6.704457521438599
Epoch: 5, Steps: 154 | Train Loss: 1.078 Vali Loss: 2.511 Vali Acc: 0.448 Test Loss: 2.511 Test Acc: 0.448
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0347235
	speed: 0.2311s/iter; left time: 3358.0115s
Epoch: 6 cost time: 6.604057312011719
Epoch: 6, Steps: 154 | Train Loss: 1.053 Vali Loss: 2.220 Vali Acc: 0.485 Test Loss: 2.220 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.6990020
	speed: 0.2543s/iter; left time: 3656.1835s
Epoch: 7 cost time: 8.043161630630493
Epoch: 7, Steps: 154 | Train Loss: 0.982 Vali Loss: 2.005 Vali Acc: 0.493 Test Loss: 2.005 Test Acc: 0.493
Validation loss decreased (-0.486598 --> -0.492681).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0455594
	speed: 0.2242s/iter; left time: 3188.9256s
Epoch: 8 cost time: 6.229122638702393
Epoch: 8, Steps: 154 | Train Loss: 0.937 Vali Loss: 2.193 Vali Acc: 0.464 Test Loss: 2.193 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7686184
	speed: 0.2582s/iter; left time: 3632.0999s
Epoch: 9 cost time: 7.38495945930481
Epoch: 9, Steps: 154 | Train Loss: 0.882 Vali Loss: 2.172 Vali Acc: 0.516 Test Loss: 2.172 Test Acc: 0.516
Validation loss decreased (-0.492681 --> -0.516199).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6579961
	speed: 0.2335s/iter; left time: 3248.7972s
Epoch: 10 cost time: 7.153779745101929
Epoch: 10, Steps: 154 | Train Loss: 0.845 Vali Loss: 2.055 Vali Acc: 0.519 Test Loss: 2.055 Test Acc: 0.519
Validation loss decreased (-0.516199 --> -0.519444).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.3836327
	speed: 0.2569s/iter; left time: 3534.6732s
Epoch: 11 cost time: 7.1779396533966064
Epoch: 11, Steps: 154 | Train Loss: 0.740 Vali Loss: 2.312 Vali Acc: 0.512 Test Loss: 2.312 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.3320175
	speed: 0.2413s/iter; left time: 3283.0864s
Epoch: 12 cost time: 6.801205396652222
Epoch: 12, Steps: 154 | Train Loss: 0.726 Vali Loss: 2.430 Vali Acc: 0.495 Test Loss: 2.430 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0631027
	speed: 0.2348s/iter; left time: 3158.5248s
Epoch: 13 cost time: 6.921107769012451
Epoch: 13, Steps: 154 | Train Loss: 0.716 Vali Loss: 2.295 Vali Acc: 0.517 Test Loss: 2.295 Test Acc: 0.517
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9171012
	speed: 0.2311s/iter; left time: 3073.6403s
Epoch: 14 cost time: 6.702592372894287
Epoch: 14, Steps: 154 | Train Loss: 0.636 Vali Loss: 2.369 Vali Acc: 0.509 Test Loss: 2.369 Test Acc: 0.509
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7123762
	speed: 0.2387s/iter; left time: 3138.1524s
Epoch: 15 cost time: 7.203120231628418
Epoch: 15, Steps: 154 | Train Loss: 0.616 Vali Loss: 2.390 Vali Acc: 0.513 Test Loss: 2.390 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.9178664
	speed: 0.2565s/iter; left time: 3332.8114s
Epoch: 16 cost time: 7.848935127258301
Epoch: 16, Steps: 154 | Train Loss: 0.569 Vali Loss: 2.810 Vali Acc: 0.488 Test Loss: 2.810 Test Acc: 0.488
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.7081557
	speed: 0.2386s/iter; left time: 3062.4648s
Epoch: 17 cost time: 6.656156301498413
Epoch: 17, Steps: 154 | Train Loss: 0.516 Vali Loss: 2.526 Vali Acc: 0.491 Test Loss: 2.526 Test Acc: 0.491
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.2758420
	speed: 0.2650s/iter; left time: 3360.9458s
Epoch: 18 cost time: 6.723679542541504
Epoch: 18, Steps: 154 | Train Loss: 0.497 Vali Loss: 2.749 Vali Acc: 0.497 Test Loss: 2.749 Test Acc: 0.497
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.5105003
	speed: 0.2502s/iter; left time: 3134.5229s
Epoch: 19 cost time: 7.087929725646973
Epoch: 19, Steps: 154 | Train Loss: 0.463 Vali Loss: 2.704 Vali Acc: 0.490 Test Loss: 2.704 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.2836659
	speed: 0.2347s/iter; left time: 2904.8478s
Epoch: 20 cost time: 6.8231799602508545
Epoch: 20, Steps: 154 | Train Loss: 0.446 Vali Loss: 2.788 Vali Acc: 0.489 Test Loss: 2.788 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5194647201946472
model parameter : 74254
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            16                  e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4500623
	speed: 0.0717s/iter; left time: 1096.3332s
Epoch: 1 cost time: 9.472824573516846
Epoch: 1, Steps: 154 | Train Loss: 2.270 Vali Loss: 1.992 Vali Acc: 0.359 Test Loss: 1.992 Test Acc: 0.359
Validation loss decreased (inf --> -0.359266).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1991532
	speed: 0.2304s/iter; left time: 3489.2361s
Epoch: 2 cost time: 6.609100818634033
Epoch: 2, Steps: 154 | Train Loss: 1.680 Vali Loss: 1.966 Vali Acc: 0.417 Test Loss: 1.966 Test Acc: 0.417
Validation loss decreased (-0.359266 --> -0.417255).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8883233
	speed: 0.2214s/iter; left time: 3319.9080s
Epoch: 3 cost time: 6.410086154937744
Epoch: 3, Steps: 154 | Train Loss: 1.310 Vali Loss: 1.853 Vali Acc: 0.479 Test Loss: 1.853 Test Acc: 0.479
Validation loss decreased (-0.417255 --> -0.479300).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2911332
	speed: 0.2158s/iter; left time: 3202.8622s
Epoch: 4 cost time: 5.836146354675293
Epoch: 4, Steps: 154 | Train Loss: 1.197 Vali Loss: 1.891 Vali Acc: 0.503 Test Loss: 1.891 Test Acc: 0.503
Validation loss decreased (-0.479300 --> -0.503225).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7589601
	speed: 0.2124s/iter; left time: 3118.5388s
Epoch: 5 cost time: 6.25302791595459
Epoch: 5, Steps: 154 | Train Loss: 1.132 Vali Loss: 2.068 Vali Acc: 0.478 Test Loss: 2.068 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0822797
	speed: 0.2245s/iter; left time: 3261.5293s
Epoch: 6 cost time: 6.9703264236450195
Epoch: 6, Steps: 154 | Train Loss: 1.054 Vali Loss: 1.970 Vali Acc: 0.514 Test Loss: 1.970 Test Acc: 0.514
Validation loss decreased (-0.503225 --> -0.513768).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3657007
	speed: 0.2281s/iter; left time: 3279.5695s
Epoch: 7 cost time: 6.955943822860718
Epoch: 7, Steps: 154 | Train Loss: 0.981 Vali Loss: 2.196 Vali Acc: 0.483 Test Loss: 2.196 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9944620
	speed: 0.2285s/iter; left time: 3249.7331s
Epoch: 8 cost time: 7.427065849304199
Epoch: 8, Steps: 154 | Train Loss: 0.942 Vali Loss: 1.986 Vali Acc: 0.489 Test Loss: 1.986 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0104063
	speed: 0.2464s/iter; left time: 3467.0854s
Epoch: 9 cost time: 7.495370388031006
Epoch: 9, Steps: 154 | Train Loss: 0.889 Vali Loss: 2.173 Vali Acc: 0.495 Test Loss: 2.173 Test Acc: 0.495
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3409280
	speed: 0.2456s/iter; left time: 3417.3062s
Epoch: 10 cost time: 7.8097288608551025
Epoch: 10, Steps: 154 | Train Loss: 0.848 Vali Loss: 1.797 Vali Acc: 0.532 Test Loss: 1.797 Test Acc: 0.532
Validation loss decreased (-0.513768 --> -0.532423).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0293565
	speed: 0.2420s/iter; left time: 3330.5837s
Epoch: 11 cost time: 6.960995197296143
Epoch: 11, Steps: 154 | Train Loss: 0.799 Vali Loss: 2.066 Vali Acc: 0.498 Test Loss: 2.066 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0460358
	speed: 0.2314s/iter; left time: 3149.0105s
Epoch: 12 cost time: 6.2833428382873535
Epoch: 12, Steps: 154 | Train Loss: 0.762 Vali Loss: 2.378 Vali Acc: 0.472 Test Loss: 2.378 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.3693837
	speed: 0.2339s/iter; left time: 3147.3152s
Epoch: 13 cost time: 7.162211894989014
Epoch: 13, Steps: 154 | Train Loss: 0.714 Vali Loss: 2.233 Vali Acc: 0.475 Test Loss: 2.233 Test Acc: 0.475
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4907845
	speed: 0.2426s/iter; left time: 3226.2788s
Epoch: 14 cost time: 6.933847665786743
Epoch: 14, Steps: 154 | Train Loss: 0.675 Vali Loss: 2.123 Vali Acc: 0.527 Test Loss: 2.123 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.8707087
	speed: 0.2537s/iter; left time: 3335.4263s
Epoch: 15 cost time: 7.175056219100952
Epoch: 15, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.347 Vali Acc: 0.510 Test Loss: 2.347 Test Acc: 0.510
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.5471455
	speed: 0.2467s/iter; left time: 3204.4403s
Epoch: 16 cost time: 7.971645832061768
Epoch: 16, Steps: 154 | Train Loss: 0.591 Vali Loss: 2.524 Vali Acc: 0.468 Test Loss: 2.524 Test Acc: 0.468
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.3245587
	speed: 0.2860s/iter; left time: 3671.7654s
Epoch: 17 cost time: 7.938317537307739
Epoch: 17, Steps: 154 | Train Loss: 0.574 Vali Loss: 2.529 Vali Acc: 0.489 Test Loss: 2.529 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8740335
	speed: 0.2613s/iter; left time: 3313.6891s
Epoch: 18 cost time: 6.942330837249756
Epoch: 18, Steps: 154 | Train Loss: 0.565 Vali Loss: 2.393 Vali Acc: 0.502 Test Loss: 2.393 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.6575618
	speed: 0.2604s/iter; left time: 3262.1398s
Epoch: 19 cost time: 6.801830291748047
Epoch: 19, Steps: 154 | Train Loss: 0.528 Vali Loss: 2.401 Vali Acc: 0.535 Test Loss: 2.401 Test Acc: 0.535
Validation loss decreased (-0.532423 --> -0.534850).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2881644
	speed: 0.2342s/iter; left time: 2898.4441s
Epoch: 20 cost time: 6.423077344894409
Epoch: 20, Steps: 154 | Train Loss: 0.480 Vali Loss: 2.705 Vali Acc: 0.479 Test Loss: 2.705 Test Acc: 0.479
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4399928
	speed: 0.2397s/iter; left time: 2929.8879s
Epoch: 21 cost time: 6.77910590171814
Epoch: 21, Steps: 154 | Train Loss: 0.483 Vali Loss: 2.650 Vali Acc: 0.507 Test Loss: 2.650 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.5063865
	speed: 0.2377s/iter; left time: 2867.8876s
Epoch: 22 cost time: 6.7026777267456055
Epoch: 22, Steps: 154 | Train Loss: 0.471 Vali Loss: 2.804 Vali Acc: 0.440 Test Loss: 2.804 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.7902309
	speed: 0.2251s/iter; left time: 2681.8609s
Epoch: 23 cost time: 6.8809192180633545
Epoch: 23, Steps: 154 | Train Loss: 0.444 Vali Loss: 3.157 Vali Acc: 0.463 Test Loss: 3.157 Test Acc: 0.463
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.3780705
	speed: 0.2520s/iter; left time: 2963.4316s
Epoch: 24 cost time: 7.891952276229858
Epoch: 24, Steps: 154 | Train Loss: 0.416 Vali Loss: 3.108 Vali Acc: 0.446 Test Loss: 3.108 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1013930
	speed: 0.2278s/iter; left time: 2643.6777s
Epoch: 25 cost time: 6.891634941101074
Epoch: 25, Steps: 154 | Train Loss: 0.410 Vali Loss: 2.791 Vali Acc: 0.486 Test Loss: 2.791 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.1857051
	speed: 0.2451s/iter; left time: 2806.7840s
Epoch: 26 cost time: 6.0112624168396
Epoch: 26, Steps: 154 | Train Loss: 0.361 Vali Loss: 2.819 Vali Acc: 0.464 Test Loss: 2.819 Test Acc: 0.464
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.3691918
	speed: 0.2377s/iter; left time: 2684.8676s
Epoch: 27 cost time: 8.064360857009888
Epoch: 27, Steps: 154 | Train Loss: 0.361 Vali Loss: 3.055 Vali Acc: 0.489 Test Loss: 3.055 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.2720009
	speed: 0.2710s/iter; left time: 3019.2241s
Epoch: 28 cost time: 6.935330867767334
Epoch: 28, Steps: 154 | Train Loss: 0.352 Vali Loss: 3.047 Vali Acc: 0.492 Test Loss: 3.047 Test Acc: 0.492
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.2945386
	speed: 0.2771s/iter; left time: 3044.9546s
Epoch: 29 cost time: 8.065232515335083
Epoch: 29, Steps: 154 | Train Loss: 0.339 Vali Loss: 3.148 Vali Acc: 0.488 Test Loss: 3.148 Test Acc: 0.488
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm64_nh16_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5348742903487429
model parameter : 63566
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7209197
	speed: 0.0647s/iter; left time: 989.8441s
Epoch: 1 cost time: 8.663693189620972
Epoch: 1, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.125 Vali Acc: 0.350 Test Loss: 2.125 Test Acc: 0.350
Validation loss decreased (inf --> -0.349533).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1555597
	speed: 0.2239s/iter; left time: 3391.7241s
Epoch: 2 cost time: 7.223229169845581
Epoch: 2, Steps: 154 | Train Loss: 1.465 Vali Loss: 1.805 Vali Acc: 0.491 Test Loss: 1.805 Test Acc: 0.491
Validation loss decreased (-0.349533 --> -0.491466).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4467361
	speed: 0.2207s/iter; left time: 3309.6337s
Epoch: 3 cost time: 6.55828332901001
Epoch: 3, Steps: 154 | Train Loss: 1.244 Vali Loss: 1.705 Vali Acc: 0.513 Test Loss: 1.705 Test Acc: 0.513
Validation loss decreased (-0.491466 --> -0.512554).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7364904
	speed: 0.2153s/iter; left time: 3195.4387s
Epoch: 4 cost time: 6.470638751983643
Epoch: 4, Steps: 154 | Train Loss: 1.101 Vali Loss: 1.848 Vali Acc: 0.514 Test Loss: 1.848 Test Acc: 0.514
Validation loss decreased (-0.512554 --> -0.513769).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7910249
	speed: 0.2313s/iter; left time: 3396.2252s
Epoch: 5 cost time: 6.255151033401489
Epoch: 5, Steps: 154 | Train Loss: 1.035 Vali Loss: 1.931 Vali Acc: 0.475 Test Loss: 1.931 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7018299
	speed: 0.2132s/iter; left time: 3098.6378s
Epoch: 6 cost time: 6.578306436538696
Epoch: 6, Steps: 154 | Train Loss: 1.002 Vali Loss: 2.173 Vali Acc: 0.484 Test Loss: 2.173 Test Acc: 0.484
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.7931801
	speed: 0.2221s/iter; left time: 3192.6630s
Epoch: 7 cost time: 7.192091703414917
Epoch: 7, Steps: 154 | Train Loss: 0.890 Vali Loss: 2.151 Vali Acc: 0.470 Test Loss: 2.151 Test Acc: 0.470
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.8638319
	speed: 0.2366s/iter; left time: 3364.4873s
Epoch: 8 cost time: 6.364508867263794
Epoch: 8, Steps: 154 | Train Loss: 0.864 Vali Loss: 2.517 Vali Acc: 0.462 Test Loss: 2.517 Test Acc: 0.462
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.5275643
	speed: 0.2291s/iter; left time: 3223.0997s
Epoch: 9 cost time: 7.408789157867432
Epoch: 9, Steps: 154 | Train Loss: 0.789 Vali Loss: 2.251 Vali Acc: 0.485 Test Loss: 2.251 Test Acc: 0.485
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2487906
	speed: 0.2186s/iter; left time: 3041.3693s
Epoch: 10 cost time: 6.225010633468628
Epoch: 10, Steps: 154 | Train Loss: 0.716 Vali Loss: 2.639 Vali Acc: 0.447 Test Loss: 2.639 Test Acc: 0.447
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.8347648
	speed: 0.2200s/iter; left time: 3027.1946s
Epoch: 11 cost time: 4.8222081661224365
Epoch: 11, Steps: 154 | Train Loss: 0.645 Vali Loss: 2.568 Vali Acc: 0.493 Test Loss: 2.568 Test Acc: 0.493
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.6328008
	speed: 0.2135s/iter; left time: 2905.3222s
Epoch: 12 cost time: 6.637746095657349
Epoch: 12, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.612 Vali Acc: 0.468 Test Loss: 2.612 Test Acc: 0.468
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.2768563
	speed: 0.2218s/iter; left time: 2983.2982s
Epoch: 13 cost time: 6.3189427852630615
Epoch: 13, Steps: 154 | Train Loss: 0.549 Vali Loss: 2.706 Vali Acc: 0.418 Test Loss: 2.706 Test Acc: 0.418
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7719755
	speed: 0.2100s/iter; left time: 2792.5242s
Epoch: 14 cost time: 6.349691152572632
Epoch: 14, Steps: 154 | Train Loss: 0.504 Vali Loss: 2.710 Vali Acc: 0.461 Test Loss: 2.710 Test Acc: 0.461
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.513787510137875
model parameter : 117934
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1181312
	speed: 0.0747s/iter; left time: 1142.4627s
Epoch: 1 cost time: 9.985333442687988
Epoch: 1, Steps: 154 | Train Loss: 2.156 Vali Loss: 1.886 Vali Acc: 0.350 Test Loss: 1.886 Test Acc: 0.350
Validation loss decreased (inf --> -0.350346).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3722444
	speed: 0.2366s/iter; left time: 3583.8272s
Epoch: 2 cost time: 5.991537809371948
Epoch: 2, Steps: 154 | Train Loss: 1.534 Vali Loss: 1.859 Vali Acc: 0.424 Test Loss: 1.859 Test Acc: 0.424
Validation loss decreased (-0.350346 --> -0.423745).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3044548
	speed: 0.2143s/iter; left time: 3213.1843s
Epoch: 3 cost time: 6.5507025718688965
Epoch: 3, Steps: 154 | Train Loss: 1.268 Vali Loss: 1.713 Vali Acc: 0.492 Test Loss: 1.713 Test Acc: 0.492
Validation loss decreased (-0.423745 --> -0.492278).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2556233
	speed: 0.2222s/iter; left time: 3296.6366s
Epoch: 4 cost time: 6.145454406738281
Epoch: 4, Steps: 154 | Train Loss: 1.107 Vali Loss: 1.833 Vali Acc: 0.482 Test Loss: 1.833 Test Acc: 0.482
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6497918
	speed: 0.2147s/iter; left time: 3152.8288s
Epoch: 5 cost time: 6.536020755767822
Epoch: 5, Steps: 154 | Train Loss: 1.011 Vali Loss: 1.714 Vali Acc: 0.517 Test Loss: 1.714 Test Acc: 0.517
Validation loss decreased (-0.492278 --> -0.517420).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2593967
	speed: 0.2191s/iter; left time: 3183.5088s
Epoch: 6 cost time: 6.3041675090789795
Epoch: 6, Steps: 154 | Train Loss: 0.980 Vali Loss: 1.791 Vali Acc: 0.532 Test Loss: 1.791 Test Acc: 0.532
Validation loss decreased (-0.517420 --> -0.532423).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7540992
	speed: 0.2099s/iter; left time: 3017.3344s
Epoch: 7 cost time: 6.237926721572876
Epoch: 7, Steps: 154 | Train Loss: 0.911 Vali Loss: 1.833 Vali Acc: 0.537 Test Loss: 1.833 Test Acc: 0.537
Validation loss decreased (-0.532423 --> -0.536884).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9490690
	speed: 0.2428s/iter; left time: 3453.4317s
Epoch: 8 cost time: 6.450976610183716
Epoch: 8, Steps: 154 | Train Loss: 0.850 Vali Loss: 1.782 Vali Acc: 0.506 Test Loss: 1.782 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.4586814
	speed: 0.2133s/iter; left time: 3000.5483s
Epoch: 9 cost time: 6.5087127685546875
Epoch: 9, Steps: 154 | Train Loss: 0.824 Vali Loss: 1.990 Vali Acc: 0.499 Test Loss: 1.990 Test Acc: 0.499
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7490065
	speed: 0.2503s/iter; left time: 3483.1662s
Epoch: 10 cost time: 7.225436687469482
Epoch: 10, Steps: 154 | Train Loss: 0.788 Vali Loss: 1.988 Vali Acc: 0.538 Test Loss: 1.988 Test Acc: 0.538
Validation loss decreased (-0.536884 --> -0.537693).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0460559
	speed: 0.2141s/iter; left time: 2946.6995s
Epoch: 11 cost time: 6.250535726547241
Epoch: 11, Steps: 154 | Train Loss: 0.734 Vali Loss: 2.155 Vali Acc: 0.530 Test Loss: 2.155 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2664113
	speed: 0.2129s/iter; left time: 2896.9216s
Epoch: 12 cost time: 6.143352270126343
Epoch: 12, Steps: 154 | Train Loss: 0.723 Vali Loss: 1.929 Vali Acc: 0.517 Test Loss: 1.929 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5441788
	speed: 0.2190s/iter; left time: 2945.6697s
Epoch: 13 cost time: 6.4069976806640625
Epoch: 13, Steps: 154 | Train Loss: 0.666 Vali Loss: 2.177 Vali Acc: 0.498 Test Loss: 2.177 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5637351
	speed: 0.2117s/iter; left time: 2815.6043s
Epoch: 14 cost time: 5.761406660079956
Epoch: 14, Steps: 154 | Train Loss: 0.639 Vali Loss: 2.217 Vali Acc: 0.482 Test Loss: 2.217 Test Acc: 0.482
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.5499990
	speed: 0.1983s/iter; left time: 2606.3785s
Epoch: 15 cost time: 6.19209623336792
Epoch: 15, Steps: 154 | Train Loss: 0.609 Vali Loss: 2.097 Vali Acc: 0.538 Test Loss: 2.097 Test Acc: 0.538
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.4491730
	speed: 0.2045s/iter; left time: 2656.2222s
Epoch: 16 cost time: 5.950941562652588
Epoch: 16, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.229 Vali Acc: 0.519 Test Loss: 2.229 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6214012
	speed: 0.2100s/iter; left time: 2696.1105s
Epoch: 17 cost time: 5.994158506393433
Epoch: 17, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.320 Vali Acc: 0.511 Test Loss: 2.320 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.3631100
	speed: 0.2114s/iter; left time: 2680.7288s
Epoch: 18 cost time: 6.437402009963989
Epoch: 18, Steps: 154 | Train Loss: 0.521 Vali Loss: 2.250 Vali Acc: 0.532 Test Loss: 2.250 Test Acc: 0.532
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.7289140
	speed: 0.2252s/iter; left time: 2821.5229s
Epoch: 19 cost time: 6.0146484375
Epoch: 19, Steps: 154 | Train Loss: 0.480 Vali Loss: 2.562 Vali Acc: 0.455 Test Loss: 2.562 Test Acc: 0.455
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.3330376
	speed: 0.2120s/iter; left time: 2623.4167s
Epoch: 20 cost time: 6.787956237792969
Epoch: 20, Steps: 154 | Train Loss: 0.483 Vali Loss: 2.429 Vali Acc: 0.482 Test Loss: 2.429 Test Acc: 0.482
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.537712895377129
model parameter : 69582
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1966066
	speed: 0.0795s/iter; left time: 1216.8138s
Epoch: 1 cost time: 10.008214712142944
Epoch: 1, Steps: 154 | Train Loss: 2.145 Vali Loss: 1.865 Vali Acc: 0.416 Test Loss: 1.865 Test Acc: 0.416
Validation loss decreased (inf --> -0.416445).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5682795
	speed: 0.2279s/iter; left time: 3451.7011s
Epoch: 2 cost time: 6.845410346984863
Epoch: 2, Steps: 154 | Train Loss: 1.562 Vali Loss: 1.914 Vali Acc: 0.434 Test Loss: 1.914 Test Acc: 0.434
Validation loss decreased (-0.416445 --> -0.433882).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0885607
	speed: 0.2213s/iter; left time: 3317.5360s
Epoch: 3 cost time: 6.571376085281372
Epoch: 3, Steps: 154 | Train Loss: 1.296 Vali Loss: 1.793 Vali Acc: 0.473 Test Loss: 1.793 Test Acc: 0.473
Validation loss decreased (-0.433882 --> -0.472813).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2022228
	speed: 0.2255s/iter; left time: 3346.8884s
Epoch: 4 cost time: 7.316063642501831
Epoch: 4, Steps: 154 | Train Loss: 1.143 Vali Loss: 1.783 Vali Acc: 0.487 Test Loss: 1.783 Test Acc: 0.487
Validation loss decreased (-0.472813 --> -0.487411).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6174952
	speed: 0.2198s/iter; left time: 3228.3257s
Epoch: 5 cost time: 6.540196657180786
Epoch: 5, Steps: 154 | Train Loss: 1.060 Vali Loss: 2.212 Vali Acc: 0.440 Test Loss: 2.212 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1063728
	speed: 0.2193s/iter; left time: 3187.3460s
Epoch: 6 cost time: 5.838750123977661
Epoch: 6, Steps: 154 | Train Loss: 1.000 Vali Loss: 2.051 Vali Acc: 0.472 Test Loss: 2.051 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.0957477
	speed: 0.2105s/iter; left time: 3026.3322s
Epoch: 7 cost time: 6.117604970932007
Epoch: 7, Steps: 154 | Train Loss: 0.916 Vali Loss: 1.946 Vali Acc: 0.501 Test Loss: 1.946 Test Acc: 0.501
Validation loss decreased (-0.487411 --> -0.500792).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4351274
	speed: 0.2021s/iter; left time: 2874.6526s
Epoch: 8 cost time: 5.149436950683594
Epoch: 8, Steps: 154 | Train Loss: 0.862 Vali Loss: 1.997 Vali Acc: 0.440 Test Loss: 1.997 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.5944897
	speed: 0.2122s/iter; left time: 2984.8110s
Epoch: 9 cost time: 6.399008274078369
Epoch: 9, Steps: 154 | Train Loss: 0.841 Vali Loss: 2.106 Vali Acc: 0.496 Test Loss: 2.106 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6693372
	speed: 0.2317s/iter; left time: 3224.3500s
Epoch: 10 cost time: 7.291244268417358
Epoch: 10, Steps: 154 | Train Loss: 0.790 Vali Loss: 2.208 Vali Acc: 0.461 Test Loss: 2.208 Test Acc: 0.461
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6118476
	speed: 0.2347s/iter; left time: 3230.3558s
Epoch: 11 cost time: 5.504421949386597
Epoch: 11, Steps: 154 | Train Loss: 0.747 Vali Loss: 2.129 Vali Acc: 0.497 Test Loss: 2.129 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3937778
	speed: 0.2059s/iter; left time: 2802.0710s
Epoch: 12 cost time: 7.128284215927124
Epoch: 12, Steps: 154 | Train Loss: 0.688 Vali Loss: 2.023 Vali Acc: 0.514 Test Loss: 2.023 Test Acc: 0.514
Validation loss decreased (-0.500792 --> -0.514173).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0183651
	speed: 0.2277s/iter; left time: 3063.0882s
Epoch: 13 cost time: 5.278985261917114
Epoch: 13, Steps: 154 | Train Loss: 0.654 Vali Loss: 2.481 Vali Acc: 0.470 Test Loss: 2.481 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5599450
	speed: 0.2022s/iter; left time: 2689.1335s
Epoch: 14 cost time: 7.019444465637207
Epoch: 14, Steps: 154 | Train Loss: 0.645 Vali Loss: 2.352 Vali Acc: 0.496 Test Loss: 2.352 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.9949967
	speed: 0.2224s/iter; left time: 2923.8600s
Epoch: 15 cost time: 6.49690318107605
Epoch: 15, Steps: 154 | Train Loss: 0.594 Vali Loss: 2.455 Vali Acc: 0.445 Test Loss: 2.455 Test Acc: 0.445
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5429943
	speed: 0.2159s/iter; left time: 2805.3084s
Epoch: 16 cost time: 6.9976325035095215
Epoch: 16, Steps: 154 | Train Loss: 0.556 Vali Loss: 2.511 Vali Acc: 0.445 Test Loss: 2.511 Test Acc: 0.445
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.5360018
	speed: 0.2216s/iter; left time: 2844.7672s
Epoch: 17 cost time: 6.5304343700408936
Epoch: 17, Steps: 154 | Train Loss: 0.519 Vali Loss: 2.583 Vali Acc: 0.440 Test Loss: 2.583 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.4834960
	speed: 0.2303s/iter; left time: 2920.8084s
Epoch: 18 cost time: 6.913735866546631
Epoch: 18, Steps: 154 | Train Loss: 0.503 Vali Loss: 2.754 Vali Acc: 0.429 Test Loss: 2.754 Test Acc: 0.429
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.4893730
	speed: 0.2369s/iter; left time: 2968.1725s
Epoch: 19 cost time: 7.322941780090332
Epoch: 19, Steps: 154 | Train Loss: 0.469 Vali Loss: 2.583 Vali Acc: 0.472 Test Loss: 2.583 Test Acc: 0.472
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.4915204
	speed: 0.2685s/iter; left time: 3322.4140s
Epoch: 20 cost time: 7.304867267608643
Epoch: 20, Steps: 154 | Train Loss: 0.438 Vali Loss: 2.753 Vali Acc: 0.442 Test Loss: 2.753 Test Acc: 0.442
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.5077750
	speed: 0.2401s/iter; left time: 2933.8741s
Epoch: 21 cost time: 7.336389064788818
Epoch: 21, Steps: 154 | Train Loss: 0.424 Vali Loss: 2.903 Vali Acc: 0.462 Test Loss: 2.903 Test Acc: 0.462
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.6227350
	speed: 0.2530s/iter; left time: 3053.4288s
Epoch: 22 cost time: 6.949255466461182
Epoch: 22, Steps: 154 | Train Loss: 0.405 Vali Loss: 2.876 Vali Acc: 0.466 Test Loss: 2.876 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5141930251419302
model parameter : 69614
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4786975
	speed: 0.0736s/iter; left time: 1125.6851s
Epoch: 1 cost time: 9.550154447555542
Epoch: 1, Steps: 154 | Train Loss: 2.260 Vali Loss: 2.017 Vali Acc: 0.354 Test Loss: 2.017 Test Acc: 0.354
Validation loss decreased (inf --> -0.354400).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3834388
	speed: 0.2253s/iter; left time: 3413.1755s
Epoch: 2 cost time: 6.483707904815674
Epoch: 2, Steps: 154 | Train Loss: 1.612 Vali Loss: 1.920 Vali Acc: 0.437 Test Loss: 1.920 Test Acc: 0.437
Validation loss decreased (-0.354400 --> -0.436720).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4588466
	speed: 0.2186s/iter; left time: 3277.7850s
Epoch: 3 cost time: 6.2222301959991455
Epoch: 3, Steps: 154 | Train Loss: 1.301 Vali Loss: 2.025 Vali Acc: 0.459 Test Loss: 2.025 Test Acc: 0.459
Validation loss decreased (-0.436720 --> -0.458617).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0222975
	speed: 0.2182s/iter; left time: 3238.1121s
Epoch: 4 cost time: 6.376315355300903
Epoch: 4, Steps: 154 | Train Loss: 1.192 Vali Loss: 1.843 Vali Acc: 0.492 Test Loss: 1.843 Test Acc: 0.492
Validation loss decreased (-0.458617 --> -0.492277).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8402902
	speed: 0.2199s/iter; left time: 3229.0131s
Epoch: 5 cost time: 6.671314001083374
Epoch: 5, Steps: 154 | Train Loss: 1.100 Vali Loss: 1.808 Vali Acc: 0.485 Test Loss: 1.808 Test Acc: 0.485
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.7664111
	speed: 0.2317s/iter; left time: 3366.8565s
Epoch: 6 cost time: 6.7320556640625
Epoch: 6, Steps: 154 | Train Loss: 1.047 Vali Loss: 1.915 Vali Acc: 0.498 Test Loss: 1.915 Test Acc: 0.498
Validation loss decreased (-0.492277 --> -0.497953).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4913512
	speed: 0.2228s/iter; left time: 3202.6606s
Epoch: 7 cost time: 6.685118913650513
Epoch: 7, Steps: 154 | Train Loss: 0.982 Vali Loss: 1.938 Vali Acc: 0.500 Test Loss: 1.938 Test Acc: 0.500
Validation loss decreased (-0.497953 --> -0.500386).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9517339
	speed: 0.2039s/iter; left time: 2900.4884s
Epoch: 8 cost time: 5.875244379043579
Epoch: 8, Steps: 154 | Train Loss: 0.940 Vali Loss: 1.875 Vali Acc: 0.514 Test Loss: 1.875 Test Acc: 0.514
Validation loss decreased (-0.500386 --> -0.513769).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1280253
	speed: 0.2053s/iter; left time: 2888.6268s
Epoch: 9 cost time: 6.3670690059661865
Epoch: 9, Steps: 154 | Train Loss: 0.866 Vali Loss: 1.944 Vali Acc: 0.515 Test Loss: 1.944 Test Acc: 0.515
Validation loss decreased (-0.513769 --> -0.514579).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9702231
	speed: 0.2299s/iter; left time: 3199.3167s
Epoch: 10 cost time: 6.432166337966919
Epoch: 10, Steps: 154 | Train Loss: 0.831 Vali Loss: 1.825 Vali Acc: 0.545 Test Loss: 1.825 Test Acc: 0.545
Validation loss decreased (-0.514579 --> -0.544588).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6575210
	speed: 0.2178s/iter; left time: 2997.7614s
Epoch: 11 cost time: 6.212778568267822
Epoch: 11, Steps: 154 | Train Loss: 0.806 Vali Loss: 1.968 Vali Acc: 0.526 Test Loss: 1.968 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6772126
	speed: 0.2147s/iter; left time: 2922.0960s
Epoch: 12 cost time: 6.360875844955444
Epoch: 12, Steps: 154 | Train Loss: 0.744 Vali Loss: 2.033 Vali Acc: 0.485 Test Loss: 2.033 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.5994641
	speed: 0.2324s/iter; left time: 3126.4878s
Epoch: 13 cost time: 6.282687187194824
Epoch: 13, Steps: 154 | Train Loss: 0.729 Vali Loss: 2.284 Vali Acc: 0.457 Test Loss: 2.284 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2699540
	speed: 0.2195s/iter; left time: 2918.8192s
Epoch: 14 cost time: 6.8265016078948975
Epoch: 14, Steps: 154 | Train Loss: 0.669 Vali Loss: 2.153 Vali Acc: 0.491 Test Loss: 2.153 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.6096463
	speed: 0.2206s/iter; left time: 2900.3401s
Epoch: 15 cost time: 6.099113702774048
Epoch: 15, Steps: 154 | Train Loss: 0.654 Vali Loss: 2.257 Vali Acc: 0.480 Test Loss: 2.257 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.6263283
	speed: 0.2193s/iter; left time: 2849.2349s
Epoch: 16 cost time: 6.448428630828857
Epoch: 16, Steps: 154 | Train Loss: 0.605 Vali Loss: 2.344 Vali Acc: 0.495 Test Loss: 2.344 Test Acc: 0.495
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6511746
	speed: 0.2197s/iter; left time: 2820.5596s
Epoch: 17 cost time: 6.8044164180755615
Epoch: 17, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.287 Vali Acc: 0.489 Test Loss: 2.287 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.5795172
	speed: 0.2248s/iter; left time: 2851.1523s
Epoch: 18 cost time: 6.732193946838379
Epoch: 18, Steps: 154 | Train Loss: 0.583 Vali Loss: 2.228 Vali Acc: 0.506 Test Loss: 2.228 Test Acc: 0.506
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.3567259
	speed: 0.2298s/iter; left time: 2879.1913s
Epoch: 19 cost time: 7.124711275100708
Epoch: 19, Steps: 154 | Train Loss: 0.545 Vali Loss: 2.471 Vali Acc: 0.479 Test Loss: 2.471 Test Acc: 0.479
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.7382719
	speed: 0.2171s/iter; left time: 2686.5823s
Epoch: 20 cost time: 6.113080024719238
Epoch: 20, Steps: 154 | Train Loss: 0.539 Vali Loss: 2.401 Vali Acc: 0.490 Test Loss: 2.401 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5446066504460665
model parameter : 53550
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4338453
	speed: 0.0734s/iter; left time: 1122.9783s
Epoch: 1 cost time: 10.105698108673096
Epoch: 1, Steps: 154 | Train Loss: 2.271 Vali Loss: 2.022 Vali Acc: 0.365 Test Loss: 2.022 Test Acc: 0.365
Validation loss decreased (inf --> -0.364538).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7637645
	speed: 0.2688s/iter; left time: 4071.0055s
Epoch: 2 cost time: 7.127527236938477
Epoch: 2, Steps: 154 | Train Loss: 1.727 Vali Loss: 1.777 Vali Acc: 0.427 Test Loss: 1.777 Test Acc: 0.427
Validation loss decreased (-0.364538 --> -0.427395).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5693158
	speed: 0.2546s/iter; left time: 3817.8001s
Epoch: 3 cost time: 7.639519691467285
Epoch: 3, Steps: 154 | Train Loss: 1.371 Vali Loss: 1.753 Vali Acc: 0.461 Test Loss: 1.753 Test Acc: 0.461
Validation loss decreased (-0.427395 --> -0.461053).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2886105
	speed: 0.2691s/iter; left time: 3992.5885s
Epoch: 4 cost time: 7.419490575790405
Epoch: 4, Steps: 154 | Train Loss: 1.250 Vali Loss: 1.895 Vali Acc: 0.471 Test Loss: 1.895 Test Acc: 0.471
Validation loss decreased (-0.461053 --> -0.471189).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0730170
	speed: 0.2194s/iter; left time: 3221.9391s
Epoch: 5 cost time: 6.579151630401611
Epoch: 5, Steps: 154 | Train Loss: 1.174 Vali Loss: 1.800 Vali Acc: 0.494 Test Loss: 1.800 Test Acc: 0.494
Validation loss decreased (-0.471189 --> -0.493899).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8126524
	speed: 0.2549s/iter; left time: 3703.3850s
Epoch: 6 cost time: 6.597620248794556
Epoch: 6, Steps: 154 | Train Loss: 1.108 Vali Loss: 1.761 Vali Acc: 0.499 Test Loss: 1.761 Test Acc: 0.499
Validation loss decreased (-0.493899 --> -0.498766).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3436484
	speed: 0.2347s/iter; left time: 3374.1386s
Epoch: 7 cost time: 6.62653923034668
Epoch: 7, Steps: 154 | Train Loss: 1.042 Vali Loss: 1.968 Vali Acc: 0.502 Test Loss: 1.968 Test Acc: 0.502
Validation loss decreased (-0.498766 --> -0.501602).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7380423
	speed: 0.2233s/iter; left time: 3175.9971s
Epoch: 8 cost time: 5.891873836517334
Epoch: 8, Steps: 154 | Train Loss: 1.018 Vali Loss: 1.943 Vali Acc: 0.492 Test Loss: 1.943 Test Acc: 0.492
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5286058
	speed: 0.2392s/iter; left time: 3365.8494s
Epoch: 9 cost time: 7.279661655426025
Epoch: 9, Steps: 154 | Train Loss: 0.974 Vali Loss: 1.828 Vali Acc: 0.513 Test Loss: 1.828 Test Acc: 0.513
Validation loss decreased (-0.501602 --> -0.512958).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8806368
	speed: 0.2250s/iter; left time: 3131.1181s
Epoch: 10 cost time: 6.33413290977478
Epoch: 10, Steps: 154 | Train Loss: 0.930 Vali Loss: 1.770 Vali Acc: 0.513 Test Loss: 1.770 Test Acc: 0.513
Validation loss decreased (-0.512958 --> -0.513364).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8715739
	speed: 0.2286s/iter; left time: 3146.0343s
Epoch: 11 cost time: 6.363304376602173
Epoch: 11, Steps: 154 | Train Loss: 0.860 Vali Loss: 1.931 Vali Acc: 0.510 Test Loss: 1.931 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9579570
	speed: 0.2513s/iter; left time: 3420.0385s
Epoch: 12 cost time: 6.961956024169922
Epoch: 12, Steps: 154 | Train Loss: 0.853 Vali Loss: 1.958 Vali Acc: 0.485 Test Loss: 1.958 Test Acc: 0.485
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.6750258
	speed: 0.2198s/iter; left time: 2957.0664s
Epoch: 13 cost time: 6.455982685089111
Epoch: 13, Steps: 154 | Train Loss: 0.808 Vali Loss: 2.214 Vali Acc: 0.500 Test Loss: 2.214 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5143205
	speed: 0.2294s/iter; left time: 3051.0060s
Epoch: 14 cost time: 6.918229341506958
Epoch: 14, Steps: 154 | Train Loss: 0.760 Vali Loss: 1.981 Vali Acc: 0.485 Test Loss: 1.981 Test Acc: 0.485
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7645985
	speed: 0.2417s/iter; left time: 3176.9902s
Epoch: 15 cost time: 6.058642148971558
Epoch: 15, Steps: 154 | Train Loss: 0.723 Vali Loss: 1.931 Vali Acc: 0.524 Test Loss: 1.931 Test Acc: 0.524
Validation loss decreased (-0.513364 --> -0.523906).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7674143
	speed: 0.2484s/iter; left time: 3226.6933s
Epoch: 16 cost time: 8.32375693321228
Epoch: 16, Steps: 154 | Train Loss: 0.688 Vali Loss: 1.956 Vali Acc: 0.536 Test Loss: 1.956 Test Acc: 0.536
Validation loss decreased (-0.523906 --> -0.535666).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7461708
	speed: 0.2452s/iter; left time: 3147.3549s
Epoch: 17 cost time: 6.305204629898071
Epoch: 17, Steps: 154 | Train Loss: 0.687 Vali Loss: 2.196 Vali Acc: 0.520 Test Loss: 2.196 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.7361587
	speed: 0.2554s/iter; left time: 3239.5051s
Epoch: 18 cost time: 6.990398406982422
Epoch: 18, Steps: 154 | Train Loss: 0.653 Vali Loss: 2.180 Vali Acc: 0.513 Test Loss: 2.180 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.5082144
	speed: 0.2451s/iter; left time: 3070.6207s
Epoch: 19 cost time: 6.388987302780151
Epoch: 19, Steps: 154 | Train Loss: 0.610 Vali Loss: 2.317 Vali Acc: 0.483 Test Loss: 2.317 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.4524359
	speed: 0.2476s/iter; left time: 3063.6550s
Epoch: 20 cost time: 7.171412706375122
Epoch: 20, Steps: 154 | Train Loss: 0.602 Vali Loss: 2.155 Vali Acc: 0.514 Test Loss: 2.155 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.5808412
	speed: 0.2553s/iter; left time: 3119.9256s
Epoch: 21 cost time: 7.169287204742432
Epoch: 21, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.173 Vali Acc: 0.521 Test Loss: 2.173 Test Acc: 0.521
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6977171
	speed: 0.2653s/iter; left time: 3201.8754s
Epoch: 22 cost time: 7.563354969024658
Epoch: 22, Steps: 154 | Train Loss: 0.540 Vali Loss: 2.387 Vali Acc: 0.517 Test Loss: 2.387 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.3966435
	speed: 0.2491s/iter; left time: 2967.9824s
Epoch: 23 cost time: 6.911514520645142
Epoch: 23, Steps: 154 | Train Loss: 0.558 Vali Loss: 2.340 Vali Acc: 0.507 Test Loss: 2.340 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.5525784
	speed: 0.2507s/iter; left time: 2947.8083s
Epoch: 24 cost time: 6.653558969497681
Epoch: 24, Steps: 154 | Train Loss: 0.505 Vali Loss: 2.239 Vali Acc: 0.540 Test Loss: 2.239 Test Acc: 0.540
Validation loss decreased (-0.535666 --> -0.540124).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.3356865
	speed: 0.2377s/iter; left time: 2758.9012s
Epoch: 25 cost time: 6.695188999176025
Epoch: 25, Steps: 154 | Train Loss: 0.516 Vali Loss: 2.396 Vali Acc: 0.521 Test Loss: 2.396 Test Acc: 0.521
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.2930952
	speed: 0.2310s/iter; left time: 2645.5187s
Epoch: 26 cost time: 7.112654685974121
Epoch: 26, Steps: 154 | Train Loss: 0.498 Vali Loss: 2.492 Vali Acc: 0.466 Test Loss: 2.492 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3274269
	speed: 0.2336s/iter; left time: 2639.5022s
Epoch: 27 cost time: 7.506654262542725
Epoch: 27, Steps: 154 | Train Loss: 0.472 Vali Loss: 2.545 Vali Acc: 0.509 Test Loss: 2.545 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.6265183
	speed: 0.2506s/iter; left time: 2792.3245s
Epoch: 28 cost time: 7.320160865783691
Epoch: 28, Steps: 154 | Train Loss: 0.467 Vali Loss: 2.820 Vali Acc: 0.504 Test Loss: 2.820 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.5529435
	speed: 0.2437s/iter; left time: 2677.6856s
Epoch: 29 cost time: 7.012334585189819
Epoch: 29, Steps: 154 | Train Loss: 0.445 Vali Loss: 2.573 Vali Acc: 0.503 Test Loss: 2.573 Test Acc: 0.503
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.3740058
	speed: 0.2576s/iter; left time: 2791.2768s
Epoch: 30 cost time: 8.358081579208374
Epoch: 30, Steps: 154 | Train Loss: 0.423 Vali Loss: 2.709 Vali Acc: 0.499 Test Loss: 2.709 Test Acc: 0.499
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 1.2115984
	speed: 0.2884s/iter; left time: 3080.9082s
Epoch: 31 cost time: 8.621898174285889
Epoch: 31, Steps: 154 | Train Loss: 0.404 Vali Loss: 2.799 Vali Acc: 0.455 Test Loss: 2.799 Test Acc: 0.455
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.2346497
	speed: 0.2763s/iter; left time: 2908.6365s
Epoch: 32 cost time: 7.777561187744141
Epoch: 32, Steps: 154 | Train Loss: 0.397 Vali Loss: 2.864 Vali Acc: 0.479 Test Loss: 2.864 Test Acc: 0.479
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.3469501
	speed: 0.2773s/iter; left time: 2876.7558s
Epoch: 33 cost time: 7.452077865600586
Epoch: 33, Steps: 154 | Train Loss: 0.394 Vali Loss: 2.796 Vali Acc: 0.497 Test Loss: 2.796 Test Acc: 0.497
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.4179884
	speed: 0.2647s/iter; left time: 2705.2798s
Epoch: 34 cost time: 7.873452425003052
Epoch: 34, Steps: 154 | Train Loss: 0.382 Vali Loss: 2.915 Vali Acc: 0.486 Test Loss: 2.915 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5401459854014599
model parameter : 45550
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4560437
	speed: 0.0801s/iter; left time: 1225.6873s
Epoch: 1 cost time: 10.249968767166138
Epoch: 1, Steps: 154 | Train Loss: 2.312 Vali Loss: 2.125 Vali Acc: 0.311 Test Loss: 2.125 Test Acc: 0.311
Validation loss decreased (inf --> -0.311414).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6202090
	speed: 0.2200s/iter; left time: 3331.8927s
Epoch: 2 cost time: 5.961267471313477
Epoch: 2, Steps: 154 | Train Loss: 1.928 Vali Loss: 1.804 Vali Acc: 0.421 Test Loss: 1.804 Test Acc: 0.421
Validation loss decreased (-0.311414 --> -0.420907).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0373150
	speed: 0.2244s/iter; left time: 3364.5148s
Epoch: 3 cost time: 6.6493377685546875
Epoch: 3, Steps: 154 | Train Loss: 1.492 Vali Loss: 1.722 Vali Acc: 0.476 Test Loss: 1.722 Test Acc: 0.476
Validation loss decreased (-0.420907 --> -0.476463).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2018476
	speed: 0.1957s/iter; left time: 2903.8622s
Epoch: 4 cost time: 5.4345197677612305
Epoch: 4, Steps: 154 | Train Loss: 1.308 Vali Loss: 1.735 Vali Acc: 0.474 Test Loss: 1.735 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4030623
	speed: 0.2136s/iter; left time: 3137.3014s
Epoch: 5 cost time: 6.375456809997559
Epoch: 5, Steps: 154 | Train Loss: 1.207 Vali Loss: 1.811 Vali Acc: 0.470 Test Loss: 1.811 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7608078
	speed: 0.2030s/iter; left time: 2949.6031s
Epoch: 6 cost time: 5.957293510437012
Epoch: 6, Steps: 154 | Train Loss: 1.125 Vali Loss: 1.793 Vali Acc: 0.468 Test Loss: 1.793 Test Acc: 0.468
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.7198256
	speed: 0.2230s/iter; left time: 3206.3394s
Epoch: 7 cost time: 6.3770856857299805
Epoch: 7, Steps: 154 | Train Loss: 1.070 Vali Loss: 1.762 Vali Acc: 0.485 Test Loss: 1.762 Test Acc: 0.485
Validation loss decreased (-0.476463 --> -0.485384).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1868733
	speed: 0.2251s/iter; left time: 3201.6463s
Epoch: 8 cost time: 5.977404832839966
Epoch: 8, Steps: 154 | Train Loss: 1.004 Vali Loss: 1.861 Vali Acc: 0.487 Test Loss: 1.861 Test Acc: 0.487
Validation loss decreased (-0.485384 --> -0.487410).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1525066
	speed: 0.2133s/iter; left time: 3001.3119s
Epoch: 9 cost time: 5.328148603439331
Epoch: 9, Steps: 154 | Train Loss: 0.962 Vali Loss: 1.748 Vali Acc: 0.487 Test Loss: 1.748 Test Acc: 0.487
Validation loss decreased (-0.487410 --> -0.487412).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8321115
	speed: 0.2163s/iter; left time: 3010.0915s
Epoch: 10 cost time: 5.7993552684783936
Epoch: 10, Steps: 154 | Train Loss: 0.935 Vali Loss: 1.797 Vali Acc: 0.499 Test Loss: 1.797 Test Acc: 0.499
Validation loss decreased (-0.487412 --> -0.498765).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7567589
	speed: 0.2122s/iter; left time: 2920.2492s
Epoch: 11 cost time: 5.509108543395996
Epoch: 11, Steps: 154 | Train Loss: 0.895 Vali Loss: 1.902 Vali Acc: 0.491 Test Loss: 1.902 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8851717
	speed: 0.2027s/iter; left time: 2758.5149s
Epoch: 12 cost time: 5.564884901046753
Epoch: 12, Steps: 154 | Train Loss: 0.866 Vali Loss: 1.931 Vali Acc: 0.511 Test Loss: 1.931 Test Acc: 0.511
Validation loss decreased (-0.498765 --> -0.510524).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4357850
	speed: 0.2083s/iter; left time: 2802.0042s
Epoch: 13 cost time: 5.84408712387085
Epoch: 13, Steps: 154 | Train Loss: 0.823 Vali Loss: 1.896 Vali Acc: 0.488 Test Loss: 1.896 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7493200
	speed: 0.2267s/iter; left time: 3015.4621s
Epoch: 14 cost time: 6.780989646911621
Epoch: 14, Steps: 154 | Train Loss: 0.792 Vali Loss: 1.895 Vali Acc: 0.496 Test Loss: 1.895 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2532315
	speed: 0.2488s/iter; left time: 3270.0291s
Epoch: 15 cost time: 6.900245666503906
Epoch: 15, Steps: 154 | Train Loss: 0.749 Vali Loss: 1.940 Vali Acc: 0.486 Test Loss: 1.940 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.5946868
	speed: 0.2377s/iter; left time: 3088.4333s
Epoch: 16 cost time: 6.8699257373809814
Epoch: 16, Steps: 154 | Train Loss: 0.732 Vali Loss: 2.010 Vali Acc: 0.515 Test Loss: 2.010 Test Acc: 0.515
Validation loss decreased (-0.510524 --> -0.514578).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6055139
	speed: 0.2557s/iter; left time: 3283.0561s
Epoch: 17 cost time: 6.908121109008789
Epoch: 17, Steps: 154 | Train Loss: 0.696 Vali Loss: 1.976 Vali Acc: 0.523 Test Loss: 1.976 Test Acc: 0.523
Validation loss decreased (-0.514578 --> -0.523095).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5018696
	speed: 0.2287s/iter; left time: 2901.0075s
Epoch: 18 cost time: 6.7546327114105225
Epoch: 18, Steps: 154 | Train Loss: 0.676 Vali Loss: 2.144 Vali Acc: 0.481 Test Loss: 2.144 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.7722856
	speed: 0.2587s/iter; left time: 3241.7698s
Epoch: 19 cost time: 7.202550411224365
Epoch: 19, Steps: 154 | Train Loss: 0.644 Vali Loss: 1.975 Vali Acc: 0.521 Test Loss: 1.975 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.5985186
	speed: 0.2521s/iter; left time: 3119.7157s
Epoch: 20 cost time: 7.7636399269104
Epoch: 20, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.066 Vali Acc: 0.532 Test Loss: 2.066 Test Acc: 0.532
Validation loss decreased (-0.523095 --> -0.531610).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8882531
	speed: 0.2532s/iter; left time: 3094.6092s
Epoch: 21 cost time: 7.213516712188721
Epoch: 21, Steps: 154 | Train Loss: 0.601 Vali Loss: 2.075 Vali Acc: 0.523 Test Loss: 2.075 Test Acc: 0.523
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.9509220
	speed: 0.2448s/iter; left time: 2954.5653s
Epoch: 22 cost time: 6.809776067733765
Epoch: 22, Steps: 154 | Train Loss: 0.599 Vali Loss: 2.134 Vali Acc: 0.506 Test Loss: 2.134 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5100847
	speed: 0.2342s/iter; left time: 2790.2417s
Epoch: 23 cost time: 6.212114572525024
Epoch: 23, Steps: 154 | Train Loss: 0.553 Vali Loss: 2.394 Vali Acc: 0.487 Test Loss: 2.394 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.5484006
	speed: 0.2381s/iter; left time: 2799.7802s
Epoch: 24 cost time: 6.638517141342163
Epoch: 24, Steps: 154 | Train Loss: 0.526 Vali Loss: 2.228 Vali Acc: 0.488 Test Loss: 2.228 Test Acc: 0.488
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.6494122
	speed: 0.2333s/iter; left time: 2707.6393s
Epoch: 25 cost time: 7.752849102020264
Epoch: 25, Steps: 154 | Train Loss: 0.539 Vali Loss: 2.370 Vali Acc: 0.488 Test Loss: 2.370 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.7830436
	speed: 0.2465s/iter; left time: 2822.7320s
Epoch: 26 cost time: 6.23785662651062
Epoch: 26, Steps: 154 | Train Loss: 0.494 Vali Loss: 2.374 Vali Acc: 0.517 Test Loss: 2.374 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.5882418
	speed: 0.2471s/iter; left time: 2791.8791s
Epoch: 27 cost time: 6.578731298446655
Epoch: 27, Steps: 154 | Train Loss: 0.502 Vali Loss: 2.520 Vali Acc: 0.496 Test Loss: 2.520 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.8075303
	speed: 0.2390s/iter; left time: 2662.7286s
Epoch: 28 cost time: 7.6739702224731445
Epoch: 28, Steps: 154 | Train Loss: 0.500 Vali Loss: 2.446 Vali Acc: 0.507 Test Loss: 2.446 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.4231415
	speed: 0.2337s/iter; left time: 2568.4733s
Epoch: 29 cost time: 7.30298638343811
Epoch: 29, Steps: 154 | Train Loss: 0.447 Vali Loss: 2.393 Vali Acc: 0.498 Test Loss: 2.393 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.4603945
	speed: 0.2711s/iter; left time: 2937.7401s
Epoch: 30 cost time: 7.1125969886779785
Epoch: 30, Steps: 154 | Train Loss: 0.448 Vali Loss: 2.548 Vali Acc: 0.473 Test Loss: 2.548 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5316301703163017
model parameter : 40206
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5795410
	speed: 0.0860s/iter; left time: 1315.5778s
Epoch: 1 cost time: 11.24485731124878
Epoch: 1, Steps: 154 | Train Loss: 2.044 Vali Loss: 2.100 Vali Acc: 0.381 Test Loss: 2.100 Test Acc: 0.381
Validation loss decreased (inf --> -0.380758).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3876091
	speed: 0.3231s/iter; left time: 4894.1302s
Epoch: 2 cost time: 9.548747539520264
Epoch: 2, Steps: 154 | Train Loss: 1.504 Vali Loss: 1.702 Vali Acc: 0.515 Test Loss: 1.702 Test Acc: 0.515
Validation loss decreased (-0.380758 --> -0.515393).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1615527
	speed: 0.2869s/iter; left time: 4301.4957s
Epoch: 3 cost time: 8.254004001617432
Epoch: 3, Steps: 154 | Train Loss: 1.226 Vali Loss: 1.959 Vali Acc: 0.528 Test Loss: 1.959 Test Acc: 0.528
Validation loss decreased (-0.515393 --> -0.527555).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2210399
	speed: 0.2846s/iter; left time: 4223.7317s
Epoch: 4 cost time: 7.963212490081787
Epoch: 4, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.824 Vali Acc: 0.478 Test Loss: 1.824 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.4339304
	speed: 0.2738s/iter; left time: 4020.1379s
Epoch: 5 cost time: 7.824935674667358
Epoch: 5, Steps: 154 | Train Loss: 1.036 Vali Loss: 1.972 Vali Acc: 0.525 Test Loss: 1.972 Test Acc: 0.525
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1547378
	speed: 0.2675s/iter; left time: 3887.4578s
Epoch: 6 cost time: 7.431925296783447
Epoch: 6, Steps: 154 | Train Loss: 0.971 Vali Loss: 1.994 Vali Acc: 0.506 Test Loss: 1.994 Test Acc: 0.506
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9033365
	speed: 0.2769s/iter; left time: 3980.5905s
Epoch: 7 cost time: 9.640391111373901
Epoch: 7, Steps: 154 | Train Loss: 0.920 Vali Loss: 2.359 Vali Acc: 0.409 Test Loss: 2.359 Test Acc: 0.409
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.6131701
	speed: 0.3209s/iter; left time: 4563.5756s
Epoch: 8 cost time: 8.538707971572876
Epoch: 8, Steps: 154 | Train Loss: 0.846 Vali Loss: 2.180 Vali Acc: 0.527 Test Loss: 2.180 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.8028753
	speed: 0.3204s/iter; left time: 4507.4353s
Epoch: 9 cost time: 9.874425172805786
Epoch: 9, Steps: 154 | Train Loss: 0.793 Vali Loss: 2.311 Vali Acc: 0.481 Test Loss: 2.311 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.1601512
	speed: 0.3124s/iter; left time: 4347.1358s
Epoch: 10 cost time: 8.565697193145752
Epoch: 10, Steps: 154 | Train Loss: 0.747 Vali Loss: 2.484 Vali Acc: 0.427 Test Loss: 2.484 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.7861682
	speed: 0.3026s/iter; left time: 4163.8773s
Epoch: 11 cost time: 8.644042491912842
Epoch: 11, Steps: 154 | Train Loss: 0.687 Vali Loss: 2.457 Vali Acc: 0.462 Test Loss: 2.457 Test Acc: 0.462
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6068761
	speed: 0.2867s/iter; left time: 3900.8896s
Epoch: 12 cost time: 7.592700242996216
Epoch: 12, Steps: 154 | Train Loss: 0.604 Vali Loss: 2.691 Vali Acc: 0.432 Test Loss: 2.691 Test Acc: 0.432
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6166830
	speed: 0.2858s/iter; left time: 3844.5163s
Epoch: 13 cost time: 8.918753147125244
Epoch: 13, Steps: 154 | Train Loss: 0.592 Vali Loss: 2.594 Vali Acc: 0.486 Test Loss: 2.594 Test Acc: 0.486
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5275750202757502
model parameter : 109614
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1774096
	speed: 0.0838s/iter; left time: 1282.9705s
Epoch: 1 cost time: 10.637397527694702
Epoch: 1, Steps: 154 | Train Loss: 2.166 Vali Loss: 1.965 Vali Acc: 0.305 Test Loss: 1.965 Test Acc: 0.305
Validation loss decreased (inf --> -0.304522).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8929384
	speed: 0.2747s/iter; left time: 4160.5214s
Epoch: 2 cost time: 8.13253378868103
Epoch: 2, Steps: 154 | Train Loss: 1.558 Vali Loss: 1.895 Vali Acc: 0.398 Test Loss: 1.895 Test Acc: 0.398
Validation loss decreased (-0.304522 --> -0.397791).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7161106
	speed: 0.3122s/iter; left time: 4681.1211s
Epoch: 3 cost time: 9.730626106262207
Epoch: 3, Steps: 154 | Train Loss: 1.267 Vali Loss: 1.850 Vali Acc: 0.505 Test Loss: 1.850 Test Acc: 0.505
Validation loss decreased (-0.397791 --> -0.504848).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2335426
	speed: 0.2938s/iter; left time: 4360.4065s
Epoch: 4 cost time: 7.734545946121216
Epoch: 4, Steps: 154 | Train Loss: 1.134 Vali Loss: 1.853 Vali Acc: 0.481 Test Loss: 1.853 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4315758
	speed: 0.3065s/iter; left time: 4500.3320s
Epoch: 5 cost time: 9.145854473114014
Epoch: 5, Steps: 154 | Train Loss: 1.068 Vali Loss: 2.020 Vali Acc: 0.470 Test Loss: 2.020 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.8504662
	speed: 0.2940s/iter; left time: 4272.4264s
Epoch: 6 cost time: 9.068832635879517
Epoch: 6, Steps: 154 | Train Loss: 0.975 Vali Loss: 1.703 Vali Acc: 0.528 Test Loss: 1.703 Test Acc: 0.528
Validation loss decreased (-0.504848 --> -0.527964).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7346669
	speed: 0.2778s/iter; left time: 3993.2885s
Epoch: 7 cost time: 7.017743349075317
Epoch: 7, Steps: 154 | Train Loss: 0.926 Vali Loss: 1.928 Vali Acc: 0.501 Test Loss: 1.928 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7497635
	speed: 0.3081s/iter; left time: 4382.7517s
Epoch: 8 cost time: 9.227321147918701
Epoch: 8, Steps: 154 | Train Loss: 0.884 Vali Loss: 1.855 Vali Acc: 0.511 Test Loss: 1.855 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.5799822
	speed: 0.3047s/iter; left time: 4286.1684s
Epoch: 9 cost time: 9.294060468673706
Epoch: 9, Steps: 154 | Train Loss: 0.836 Vali Loss: 1.879 Vali Acc: 0.543 Test Loss: 1.879 Test Acc: 0.543
Validation loss decreased (-0.527964 --> -0.543371).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0258913
	speed: 0.3000s/iter; left time: 4174.3144s
Epoch: 10 cost time: 7.980297565460205
Epoch: 10, Steps: 154 | Train Loss: 0.803 Vali Loss: 1.882 Vali Acc: 0.541 Test Loss: 1.882 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.4723206
	speed: 0.3050s/iter; left time: 4197.3429s
Epoch: 11 cost time: 8.343971252441406
Epoch: 11, Steps: 154 | Train Loss: 0.743 Vali Loss: 2.046 Vali Acc: 0.524 Test Loss: 2.046 Test Acc: 0.524
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0009885
	speed: 0.3017s/iter; left time: 4105.5691s
Epoch: 12 cost time: 8.55323338508606
Epoch: 12, Steps: 154 | Train Loss: 0.724 Vali Loss: 2.181 Vali Acc: 0.498 Test Loss: 2.181 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3301705
	speed: 0.3281s/iter; left time: 4414.2837s
Epoch: 13 cost time: 8.83382773399353
Epoch: 13, Steps: 154 | Train Loss: 0.687 Vali Loss: 2.156 Vali Acc: 0.535 Test Loss: 2.156 Test Acc: 0.535
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3370612
	speed: 0.3398s/iter; left time: 4519.6276s
Epoch: 14 cost time: 10.86910104751587
Epoch: 14, Steps: 154 | Train Loss: 0.658 Vali Loss: 2.304 Vali Acc: 0.446 Test Loss: 2.304 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.4786383
	speed: 0.3298s/iter; left time: 4335.6686s
Epoch: 15 cost time: 8.847729444503784
Epoch: 15, Steps: 154 | Train Loss: 0.605 Vali Loss: 2.168 Vali Acc: 0.518 Test Loss: 2.168 Test Acc: 0.518
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.7037015
	speed: 0.3245s/iter; left time: 4215.1363s
Epoch: 16 cost time: 9.016533374786377
Epoch: 16, Steps: 154 | Train Loss: 0.573 Vali Loss: 2.217 Vali Acc: 0.515 Test Loss: 2.217 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.7301826
	speed: 0.3204s/iter; left time: 4113.2055s
Epoch: 17 cost time: 9.32673692703247
Epoch: 17, Steps: 154 | Train Loss: 0.565 Vali Loss: 2.503 Vali Acc: 0.486 Test Loss: 2.503 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.5549184
	speed: 0.3005s/iter; left time: 3810.7354s
Epoch: 18 cost time: 9.196376323699951
Epoch: 18, Steps: 154 | Train Loss: 0.543 Vali Loss: 2.445 Vali Acc: 0.506 Test Loss: 2.445 Test Acc: 0.506
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.5203472
	speed: 0.3046s/iter; left time: 3816.3626s
Epoch: 19 cost time: 8.574737787246704
Epoch: 19, Steps: 154 | Train Loss: 0.530 Vali Loss: 2.370 Vali Acc: 0.500 Test Loss: 2.370 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5433901054339011
model parameter : 61262
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2500672
	speed: 0.0868s/iter; left time: 1327.5035s
Epoch: 1 cost time: 10.357642889022827
Epoch: 1, Steps: 154 | Train Loss: 2.146 Vali Loss: 1.910 Vali Acc: 0.365 Test Loss: 1.910 Test Acc: 0.365
Validation loss decreased (inf --> -0.365350).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1743039
	speed: 0.2712s/iter; left time: 4108.3340s
Epoch: 2 cost time: 8.600080966949463
Epoch: 2, Steps: 154 | Train Loss: 1.520 Vali Loss: 1.759 Vali Acc: 0.468 Test Loss: 1.759 Test Acc: 0.468
Validation loss decreased (-0.365350 --> -0.467541).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1770327
	speed: 0.2572s/iter; left time: 3856.4641s
Epoch: 3 cost time: 6.685272932052612
Epoch: 3, Steps: 154 | Train Loss: 1.253 Vali Loss: 2.236 Vali Acc: 0.450 Test Loss: 2.236 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0864893
	speed: 0.2623s/iter; left time: 3892.9363s
Epoch: 4 cost time: 8.119987726211548
Epoch: 4, Steps: 154 | Train Loss: 1.168 Vali Loss: 2.093 Vali Acc: 0.455 Test Loss: 2.093 Test Acc: 0.455
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.9775336
	speed: 0.2739s/iter; left time: 4021.5327s
Epoch: 5 cost time: 7.235937595367432
Epoch: 5, Steps: 154 | Train Loss: 1.078 Vali Loss: 1.878 Vali Acc: 0.497 Test Loss: 1.878 Test Acc: 0.497
Validation loss decreased (-0.467541 --> -0.497143).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1098619
	speed: 0.2780s/iter; left time: 4039.6037s
Epoch: 6 cost time: 7.5912559032440186
Epoch: 6, Steps: 154 | Train Loss: 1.014 Vali Loss: 2.250 Vali Acc: 0.488 Test Loss: 2.250 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9947318
	speed: 0.2602s/iter; left time: 3741.1627s
Epoch: 7 cost time: 7.49887752532959
Epoch: 7, Steps: 154 | Train Loss: 0.951 Vali Loss: 1.893 Vali Acc: 0.518 Test Loss: 1.893 Test Acc: 0.518
Validation loss decreased (-0.497143 --> -0.517824).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1482913
	speed: 0.2865s/iter; left time: 4074.2290s
Epoch: 8 cost time: 7.962025880813599
Epoch: 8, Steps: 154 | Train Loss: 0.909 Vali Loss: 1.987 Vali Acc: 0.510 Test Loss: 1.987 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2418878
	speed: 0.2897s/iter; left time: 4076.3762s
Epoch: 9 cost time: 8.214520692825317
Epoch: 9, Steps: 154 | Train Loss: 0.851 Vali Loss: 1.958 Vali Acc: 0.521 Test Loss: 1.958 Test Acc: 0.521
Validation loss decreased (-0.517824 --> -0.520662).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5286905
	speed: 0.2954s/iter; left time: 4111.1713s
Epoch: 10 cost time: 8.298137664794922
Epoch: 10, Steps: 154 | Train Loss: 0.794 Vali Loss: 1.994 Vali Acc: 0.506 Test Loss: 1.994 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3115045
	speed: 0.2850s/iter; left time: 3922.1444s
Epoch: 11 cost time: 8.525331735610962
Epoch: 11, Steps: 154 | Train Loss: 0.787 Vali Loss: 1.983 Vali Acc: 0.526 Test Loss: 1.983 Test Acc: 0.526
Validation loss decreased (-0.520662 --> -0.525933).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5536905
	speed: 0.3376s/iter; left time: 4593.4048s
Epoch: 12 cost time: 9.897064685821533
Epoch: 12, Steps: 154 | Train Loss: 0.695 Vali Loss: 2.049 Vali Acc: 0.524 Test Loss: 2.049 Test Acc: 0.524
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.3621557
	speed: 0.3077s/iter; left time: 4139.8839s
Epoch: 13 cost time: 9.108139514923096
Epoch: 13, Steps: 154 | Train Loss: 0.680 Vali Loss: 2.146 Vali Acc: 0.509 Test Loss: 2.146 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8253373
	speed: 0.3254s/iter; left time: 4327.9388s
Epoch: 14 cost time: 9.588022947311401
Epoch: 14, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.193 Vali Acc: 0.504 Test Loss: 2.193 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8082228
	speed: 0.3001s/iter; left time: 3944.8986s
Epoch: 15 cost time: 8.990636348724365
Epoch: 15, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.119 Vali Acc: 0.512 Test Loss: 2.119 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5145078
	speed: 0.3116s/iter; left time: 4047.8660s
Epoch: 16 cost time: 8.668530941009521
Epoch: 16, Steps: 154 | Train Loss: 0.556 Vali Loss: 2.278 Vali Acc: 0.486 Test Loss: 2.278 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1825681
	speed: 0.3093s/iter; left time: 3970.2925s
Epoch: 17 cost time: 9.640034198760986
Epoch: 17, Steps: 154 | Train Loss: 0.563 Vali Loss: 2.288 Vali Acc: 0.530 Test Loss: 2.288 Test Acc: 0.530
Validation loss decreased (-0.525933 --> -0.530391).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.7098379
	speed: 0.3051s/iter; left time: 3869.1743s
Epoch: 18 cost time: 8.313730716705322
Epoch: 18, Steps: 154 | Train Loss: 0.517 Vali Loss: 2.257 Vali Acc: 0.496 Test Loss: 2.257 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5560098
	speed: 0.2748s/iter; left time: 3443.1461s
Epoch: 19 cost time: 8.506975412368774
Epoch: 19, Steps: 154 | Train Loss: 0.483 Vali Loss: 2.476 Vali Acc: 0.495 Test Loss: 2.476 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0922173
	speed: 0.2943s/iter; left time: 3641.7536s
Epoch: 20 cost time: 8.602136850357056
Epoch: 20, Steps: 154 | Train Loss: 0.453 Vali Loss: 2.559 Vali Acc: 0.541 Test Loss: 2.559 Test Acc: 0.541
Validation loss decreased (-0.530391 --> -0.540931).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.4517013
	speed: 0.2819s/iter; left time: 3444.7147s
Epoch: 21 cost time: 7.759092569351196
Epoch: 21, Steps: 154 | Train Loss: 0.447 Vali Loss: 2.544 Vali Acc: 0.508 Test Loss: 2.544 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1504141
	speed: 0.2780s/iter; left time: 3354.8111s
Epoch: 22 cost time: 8.469277143478394
Epoch: 22, Steps: 154 | Train Loss: 0.410 Vali Loss: 2.645 Vali Acc: 0.526 Test Loss: 2.645 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0894426
	speed: 0.3040s/iter; left time: 3621.9268s
Epoch: 23 cost time: 8.17853832244873
Epoch: 23, Steps: 154 | Train Loss: 0.375 Vali Loss: 2.549 Vali Acc: 0.531 Test Loss: 2.549 Test Acc: 0.531
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.8683077
	speed: 0.2878s/iter; left time: 3383.8550s
Epoch: 24 cost time: 7.835372686386108
Epoch: 24, Steps: 154 | Train Loss: 0.409 Vali Loss: 2.770 Vali Acc: 0.502 Test Loss: 2.770 Test Acc: 0.502
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1184825
	speed: 0.2567s/iter; left time: 2978.7051s
Epoch: 25 cost time: 7.4231977462768555
Epoch: 25, Steps: 154 | Train Loss: 0.369 Vali Loss: 2.677 Vali Acc: 0.522 Test Loss: 2.677 Test Acc: 0.522
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.4668380
	speed: 0.2760s/iter; left time: 3160.6902s
Epoch: 26 cost time: 7.785717725753784
Epoch: 26, Steps: 154 | Train Loss: 0.365 Vali Loss: 2.751 Vali Acc: 0.517 Test Loss: 2.751 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6362163
	speed: 0.2602s/iter; left time: 2939.7243s
Epoch: 27 cost time: 8.056466579437256
Epoch: 27, Steps: 154 | Train Loss: 0.339 Vali Loss: 2.956 Vali Acc: 0.519 Test Loss: 2.956 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.9471179
	speed: 0.3155s/iter; left time: 3516.1286s
Epoch: 28 cost time: 8.496665239334106
Epoch: 28, Steps: 154 | Train Loss: 0.339 Vali Loss: 2.922 Vali Acc: 0.508 Test Loss: 2.922 Test Acc: 0.508
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.6233196
	speed: 0.3124s/iter; left time: 3432.5794s
Epoch: 29 cost time: 9.03699779510498
Epoch: 29, Steps: 154 | Train Loss: 0.314 Vali Loss: 2.929 Vali Acc: 0.521 Test Loss: 2.929 Test Acc: 0.521
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.2852045
	speed: 0.2967s/iter; left time: 3214.4230s
Epoch: 30 cost time: 8.399370670318604
Epoch: 30, Steps: 154 | Train Loss: 0.312 Vali Loss: 3.149 Vali Acc: 0.502 Test Loss: 3.149 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5409570154095702
model parameter : 61294
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8028421
	speed: 0.0920s/iter; left time: 1408.3450s
Epoch: 1 cost time: 12.366184711456299
Epoch: 1, Steps: 154 | Train Loss: 2.178 Vali Loss: 1.971 Vali Acc: 0.396 Test Loss: 1.971 Test Acc: 0.396
Validation loss decreased (inf --> -0.395763).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3699172
	speed: 0.3152s/iter; left time: 4774.8613s
Epoch: 2 cost time: 9.034082412719727
Epoch: 2, Steps: 154 | Train Loss: 1.635 Vali Loss: 1.839 Vali Acc: 0.431 Test Loss: 1.839 Test Acc: 0.431
Validation loss decreased (-0.395763 --> -0.431450).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8623559
	speed: 0.3058s/iter; left time: 4584.7336s
Epoch: 3 cost time: 8.577099323272705
Epoch: 3, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.054 Vali Acc: 0.456 Test Loss: 2.054 Test Acc: 0.456
Validation loss decreased (-0.431450 --> -0.455778).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3918034
	speed: 0.2990s/iter; left time: 4436.4238s
Epoch: 4 cost time: 8.357272386550903
Epoch: 4, Steps: 154 | Train Loss: 1.219 Vali Loss: 1.789 Vali Acc: 0.472 Test Loss: 1.789 Test Acc: 0.472
Validation loss decreased (-0.455778 --> -0.472002).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1253113
	speed: 0.2861s/iter; left time: 4201.2064s
Epoch: 5 cost time: 8.16620922088623
Epoch: 5, Steps: 154 | Train Loss: 1.140 Vali Loss: 1.721 Vali Acc: 0.498 Test Loss: 1.721 Test Acc: 0.498
Validation loss decreased (-0.472002 --> -0.498361).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6060795
	speed: 0.2834s/iter; left time: 4117.6430s
Epoch: 6 cost time: 8.200591802597046
Epoch: 6, Steps: 154 | Train Loss: 1.075 Vali Loss: 1.746 Vali Acc: 0.509 Test Loss: 1.746 Test Acc: 0.509
Validation loss decreased (-0.498361 --> -0.509309).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7304083
	speed: 0.2839s/iter; left time: 4081.3258s
Epoch: 7 cost time: 8.735573530197144
Epoch: 7, Steps: 154 | Train Loss: 1.024 Vali Loss: 1.825 Vali Acc: 0.508 Test Loss: 1.825 Test Acc: 0.508
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8451076
	speed: 0.2865s/iter; left time: 4074.4788s
Epoch: 8 cost time: 7.417895555496216
Epoch: 8, Steps: 154 | Train Loss: 0.961 Vali Loss: 1.851 Vali Acc: 0.505 Test Loss: 1.851 Test Acc: 0.505
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9654382
	speed: 0.2981s/iter; left time: 4194.0933s
Epoch: 9 cost time: 9.51057505607605
Epoch: 9, Steps: 154 | Train Loss: 0.912 Vali Loss: 1.872 Vali Acc: 0.508 Test Loss: 1.872 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4040054
	speed: 0.2946s/iter; left time: 4098.9423s
Epoch: 10 cost time: 8.160828590393066
Epoch: 10, Steps: 154 | Train Loss: 0.879 Vali Loss: 2.127 Vali Acc: 0.506 Test Loss: 2.127 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.7533039
	speed: 0.3029s/iter; left time: 4168.8254s
Epoch: 11 cost time: 8.821866512298584
Epoch: 11, Steps: 154 | Train Loss: 0.840 Vali Loss: 1.929 Vali Acc: 0.506 Test Loss: 1.929 Test Acc: 0.506
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.7811309
	speed: 0.3110s/iter; left time: 4231.6393s
Epoch: 12 cost time: 9.267980575561523
Epoch: 12, Steps: 154 | Train Loss: 0.794 Vali Loss: 2.283 Vali Acc: 0.480 Test Loss: 2.283 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.2148198
	speed: 0.2644s/iter; left time: 3556.6758s
Epoch: 13 cost time: 7.712170124053955
Epoch: 13, Steps: 154 | Train Loss: 0.767 Vali Loss: 2.198 Vali Acc: 0.495 Test Loss: 2.198 Test Acc: 0.495
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1731369
	speed: 0.2627s/iter; left time: 3493.0959s
Epoch: 14 cost time: 7.7828757762908936
Epoch: 14, Steps: 154 | Train Loss: 0.746 Vali Loss: 2.265 Vali Acc: 0.482 Test Loss: 2.265 Test Acc: 0.482
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.6147842
	speed: 0.2728s/iter; left time: 3585.3413s
Epoch: 15 cost time: 8.758193969726562
Epoch: 15, Steps: 154 | Train Loss: 0.707 Vali Loss: 2.344 Vali Acc: 0.484 Test Loss: 2.344 Test Acc: 0.484
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.9996676
	speed: 0.3104s/iter; left time: 4032.2177s
Epoch: 16 cost time: 8.695347309112549
Epoch: 16, Steps: 154 | Train Loss: 0.684 Vali Loss: 2.117 Vali Acc: 0.500 Test Loss: 2.117 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5093268450932684
model parameter : 45230
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9284533
	speed: 0.1038s/iter; left time: 1588.7435s
Epoch: 1 cost time: 12.918730974197388
Epoch: 1, Steps: 154 | Train Loss: 2.253 Vali Loss: 1.973 Vali Acc: 0.362 Test Loss: 1.973 Test Acc: 0.362
Validation loss decreased (inf --> -0.361700).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6638364
	speed: 0.3161s/iter; left time: 4787.6660s
Epoch: 2 cost time: 9.106557369232178
Epoch: 2, Steps: 154 | Train Loss: 1.724 Vali Loss: 1.808 Vali Acc: 0.397 Test Loss: 1.808 Test Acc: 0.397
Validation loss decreased (-0.361700 --> -0.396576).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1088517
	speed: 0.2940s/iter; left time: 4408.3882s
Epoch: 3 cost time: 7.609970331192017
Epoch: 3, Steps: 154 | Train Loss: 1.392 Vali Loss: 1.821 Vali Acc: 0.441 Test Loss: 1.821 Test Acc: 0.441
Validation loss decreased (-0.396576 --> -0.441182).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3281673
	speed: 0.2917s/iter; left time: 4328.9468s
Epoch: 4 cost time: 7.4002110958099365
Epoch: 4, Steps: 154 | Train Loss: 1.270 Vali Loss: 1.830 Vali Acc: 0.477 Test Loss: 1.830 Test Acc: 0.477
Validation loss decreased (-0.441182 --> -0.476867).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0921257
	speed: 0.3101s/iter; left time: 4554.3790s
Epoch: 5 cost time: 9.224990367889404
Epoch: 5, Steps: 154 | Train Loss: 1.176 Vali Loss: 1.758 Vali Acc: 0.486 Test Loss: 1.758 Test Acc: 0.486
Validation loss decreased (-0.476867 --> -0.485789).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3728888
	speed: 0.3066s/iter; left time: 4454.7631s
Epoch: 6 cost time: 9.052903890609741
Epoch: 6, Steps: 154 | Train Loss: 1.123 Vali Loss: 2.120 Vali Acc: 0.452 Test Loss: 2.120 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4967655
	speed: 0.2405s/iter; left time: 3457.9325s
Epoch: 7 cost time: 7.082275867462158
Epoch: 7, Steps: 154 | Train Loss: 1.069 Vali Loss: 1.856 Vali Acc: 0.488 Test Loss: 1.856 Test Acc: 0.488
Validation loss decreased (-0.485789 --> -0.487816).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3112817
	speed: 0.2644s/iter; left time: 3761.1714s
Epoch: 8 cost time: 8.891447305679321
Epoch: 8, Steps: 154 | Train Loss: 1.012 Vali Loss: 1.952 Vali Acc: 0.478 Test Loss: 1.952 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9450260
	speed: 0.2680s/iter; left time: 3771.1401s
Epoch: 9 cost time: 7.09497332572937
Epoch: 9, Steps: 154 | Train Loss: 0.992 Vali Loss: 1.996 Vali Acc: 0.496 Test Loss: 1.996 Test Acc: 0.496
Validation loss decreased (-0.487816 --> -0.495519).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8402185
	speed: 0.2631s/iter; left time: 3661.2914s
Epoch: 10 cost time: 7.167650938034058
Epoch: 10, Steps: 154 | Train Loss: 0.944 Vali Loss: 2.011 Vali Acc: 0.486 Test Loss: 2.011 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9256697
	speed: 0.2808s/iter; left time: 3864.6749s
Epoch: 11 cost time: 7.755363702774048
Epoch: 11, Steps: 154 | Train Loss: 0.891 Vali Loss: 1.917 Vali Acc: 0.509 Test Loss: 1.917 Test Acc: 0.509
Validation loss decreased (-0.495519 --> -0.509308).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4340608
	speed: 0.2449s/iter; left time: 3331.9289s
Epoch: 12 cost time: 7.188445806503296
Epoch: 12, Steps: 154 | Train Loss: 0.872 Vali Loss: 1.771 Vali Acc: 0.536 Test Loss: 1.771 Test Acc: 0.536
Validation loss decreased (-0.509308 --> -0.536479).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2352518
	speed: 0.2422s/iter; left time: 3258.3119s
Epoch: 13 cost time: 6.840651035308838
Epoch: 13, Steps: 154 | Train Loss: 0.843 Vali Loss: 1.967 Vali Acc: 0.483 Test Loss: 1.967 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.5884068
	speed: 0.2492s/iter; left time: 3314.7408s
Epoch: 14 cost time: 7.395156621932983
Epoch: 14, Steps: 154 | Train Loss: 0.805 Vali Loss: 1.962 Vali Acc: 0.504 Test Loss: 1.962 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2655672
	speed: 0.2520s/iter; left time: 3312.9614s
Epoch: 15 cost time: 7.685650110244751
Epoch: 15, Steps: 154 | Train Loss: 0.782 Vali Loss: 2.077 Vali Acc: 0.508 Test Loss: 2.077 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6176174
	speed: 0.2447s/iter; left time: 3178.7105s
Epoch: 16 cost time: 7.267956733703613
Epoch: 16, Steps: 154 | Train Loss: 0.759 Vali Loss: 2.050 Vali Acc: 0.519 Test Loss: 2.050 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9330592
	speed: 0.2744s/iter; left time: 3522.2745s
Epoch: 17 cost time: 8.716428279876709
Epoch: 17, Steps: 154 | Train Loss: 0.720 Vali Loss: 2.223 Vali Acc: 0.494 Test Loss: 2.223 Test Acc: 0.494
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.0117497
	speed: 0.3053s/iter; left time: 3872.5100s
Epoch: 18 cost time: 8.555377960205078
Epoch: 18, Steps: 154 | Train Loss: 0.691 Vali Loss: 2.163 Vali Acc: 0.504 Test Loss: 2.163 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.6207579
	speed: 0.3075s/iter; left time: 3853.1439s
Epoch: 19 cost time: 9.214289903640747
Epoch: 19, Steps: 154 | Train Loss: 0.651 Vali Loss: 2.288 Vali Acc: 0.519 Test Loss: 2.288 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.2141794
	speed: 0.2842s/iter; left time: 3517.0729s
Epoch: 20 cost time: 7.686474561691284
Epoch: 20, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.199 Vali Acc: 0.493 Test Loss: 2.199 Test Acc: 0.493
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.4557416
	speed: 0.2876s/iter; left time: 3514.4661s
Epoch: 21 cost time: 8.241298913955688
Epoch: 21, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.448 Vali Acc: 0.461 Test Loss: 2.448 Test Acc: 0.461
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.5971208
	speed: 0.2977s/iter; left time: 3591.8253s
Epoch: 22 cost time: 8.892079591751099
Epoch: 22, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.331 Vali Acc: 0.494 Test Loss: 2.331 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5364963503649635
model parameter : 37230
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1337709
	speed: 0.0836s/iter; left time: 1279.8352s
Epoch: 1 cost time: 10.787428855895996
Epoch: 1, Steps: 154 | Train Loss: 2.342 Vali Loss: 2.061 Vali Acc: 0.352 Test Loss: 2.061 Test Acc: 0.352
Validation loss decreased (inf --> -0.352372).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1419528
	speed: 0.2591s/iter; left time: 3925.2657s
Epoch: 2 cost time: 7.135873556137085
Epoch: 2, Steps: 154 | Train Loss: 1.873 Vali Loss: 1.796 Vali Acc: 0.411 Test Loss: 1.796 Test Acc: 0.411
Validation loss decreased (-0.352372 --> -0.411174).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7465676
	speed: 0.2588s/iter; left time: 3879.6782s
Epoch: 3 cost time: 7.9092698097229
Epoch: 3, Steps: 154 | Train Loss: 1.473 Vali Loss: 1.781 Vali Acc: 0.442 Test Loss: 1.781 Test Acc: 0.442
Validation loss decreased (-0.411174 --> -0.441588).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7289789
	speed: 0.2385s/iter; left time: 3539.1934s
Epoch: 4 cost time: 6.785487651824951
Epoch: 4, Steps: 154 | Train Loss: 1.275 Vali Loss: 1.811 Vali Acc: 0.467 Test Loss: 1.811 Test Acc: 0.467
Validation loss decreased (-0.441588 --> -0.467135).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5104486
	speed: 0.2391s/iter; left time: 3510.5398s
Epoch: 5 cost time: 7.109760522842407
Epoch: 5, Steps: 154 | Train Loss: 1.212 Vali Loss: 1.776 Vali Acc: 0.478 Test Loss: 1.776 Test Acc: 0.478
Validation loss decreased (-0.467135 --> -0.477679).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0965586
	speed: 0.2556s/iter; left time: 3713.4249s
Epoch: 6 cost time: 7.560486555099487
Epoch: 6, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.707 Vali Acc: 0.503 Test Loss: 1.707 Test Acc: 0.503
Validation loss decreased (-0.477679 --> -0.503227).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9392868
	speed: 0.2988s/iter; left time: 4296.4044s
Epoch: 7 cost time: 8.12841510772705
Epoch: 7, Steps: 154 | Train Loss: 1.067 Vali Loss: 1.875 Vali Acc: 0.491 Test Loss: 1.875 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1578726
	speed: 0.2796s/iter; left time: 3977.3719s
Epoch: 8 cost time: 8.276161432266235
Epoch: 8, Steps: 154 | Train Loss: 1.031 Vali Loss: 1.808 Vali Acc: 0.480 Test Loss: 1.808 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0312492
	speed: 0.2798s/iter; left time: 3936.9816s
Epoch: 9 cost time: 7.394960165023804
Epoch: 9, Steps: 154 | Train Loss: 0.978 Vali Loss: 1.871 Vali Acc: 0.494 Test Loss: 1.871 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8264773
	speed: 0.2899s/iter; left time: 4033.7512s
Epoch: 10 cost time: 8.462064266204834
Epoch: 10, Steps: 154 | Train Loss: 0.966 Vali Loss: 1.923 Vali Acc: 0.478 Test Loss: 1.923 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.6783837
	speed: 0.2962s/iter; left time: 4076.2503s
Epoch: 11 cost time: 9.220571279525757
Epoch: 11, Steps: 154 | Train Loss: 0.889 Vali Loss: 2.077 Vali Acc: 0.463 Test Loss: 2.077 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4040987
	speed: 0.3303s/iter; left time: 4494.5656s
Epoch: 12 cost time: 10.583024263381958
Epoch: 12, Steps: 154 | Train Loss: 0.881 Vali Loss: 2.129 Vali Acc: 0.487 Test Loss: 2.129 Test Acc: 0.487
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0748254
	speed: 0.3123s/iter; left time: 4201.0550s
Epoch: 13 cost time: 7.789081573486328
Epoch: 13, Steps: 154 | Train Loss: 0.837 Vali Loss: 2.081 Vali Acc: 0.480 Test Loss: 2.081 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.7526177
	speed: 0.2400s/iter; left time: 3191.5046s
Epoch: 14 cost time: 5.848977327346802
Epoch: 14, Steps: 154 | Train Loss: 0.808 Vali Loss: 2.137 Vali Acc: 0.482 Test Loss: 2.137 Test Acc: 0.482
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7847804
	speed: 0.2177s/iter; left time: 2861.1216s
Epoch: 15 cost time: 6.945398569107056
Epoch: 15, Steps: 154 | Train Loss: 0.788 Vali Loss: 2.137 Vali Acc: 0.504 Test Loss: 2.137 Test Acc: 0.504
Validation loss decreased (-0.503227 --> -0.503628).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6366847
	speed: 0.2965s/iter; left time: 3851.6041s
Epoch: 16 cost time: 8.80443263053894
Epoch: 16, Steps: 154 | Train Loss: 0.786 Vali Loss: 2.281 Vali Acc: 0.497 Test Loss: 2.281 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.8121443
	speed: 0.3232s/iter; left time: 4149.1983s
Epoch: 17 cost time: 10.531055450439453
Epoch: 17, Steps: 154 | Train Loss: 0.771 Vali Loss: 2.169 Vali Acc: 0.504 Test Loss: 2.169 Test Acc: 0.504
Validation loss decreased (-0.503628 --> -0.504033).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0583040
	speed: 0.3434s/iter; left time: 4354.7595s
Epoch: 18 cost time: 10.430792570114136
Epoch: 18, Steps: 154 | Train Loss: 0.721 Vali Loss: 2.220 Vali Acc: 0.506 Test Loss: 2.220 Test Acc: 0.506
Validation loss decreased (-0.504033 --> -0.506466).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3700533
	speed: 0.3287s/iter; left time: 4118.6457s
Epoch: 19 cost time: 8.39845609664917
Epoch: 19, Steps: 154 | Train Loss: 0.700 Vali Loss: 2.326 Vali Acc: 0.508 Test Loss: 2.326 Test Acc: 0.508
Validation loss decreased (-0.506466 --> -0.507682).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6477581
	speed: 0.2843s/iter; left time: 3518.6515s
Epoch: 20 cost time: 7.425974369049072
Epoch: 20, Steps: 154 | Train Loss: 0.692 Vali Loss: 2.129 Vali Acc: 0.515 Test Loss: 2.129 Test Acc: 0.515
Validation loss decreased (-0.507682 --> -0.515388).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.7683219
	speed: 0.2942s/iter; left time: 3594.9415s
Epoch: 21 cost time: 8.21906042098999
Epoch: 21, Steps: 154 | Train Loss: 0.660 Vali Loss: 2.309 Vali Acc: 0.497 Test Loss: 2.309 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.5768863
	speed: 0.2636s/iter; left time: 3180.4303s
Epoch: 22 cost time: 7.459785223007202
Epoch: 22, Steps: 154 | Train Loss: 0.632 Vali Loss: 2.378 Vali Acc: 0.513 Test Loss: 2.378 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.7323967
	speed: 0.2496s/iter; left time: 2972.9963s
Epoch: 23 cost time: 6.100299835205078
Epoch: 23, Steps: 154 | Train Loss: 0.624 Vali Loss: 2.530 Vali Acc: 0.456 Test Loss: 2.530 Test Acc: 0.456
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.3560164
	speed: 0.2321s/iter; left time: 2729.5973s
Epoch: 24 cost time: 7.269962549209595
Epoch: 24, Steps: 154 | Train Loss: 0.616 Vali Loss: 2.351 Vali Acc: 0.480 Test Loss: 2.351 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.2954921
	speed: 0.2430s/iter; left time: 2819.6403s
Epoch: 25 cost time: 7.170376300811768
Epoch: 25, Steps: 154 | Train Loss: 0.593 Vali Loss: 2.474 Vali Acc: 0.496 Test Loss: 2.474 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.6045533
	speed: 0.2590s/iter; left time: 2966.1060s
Epoch: 26 cost time: 7.186464309692383
Epoch: 26, Steps: 154 | Train Loss: 0.581 Vali Loss: 2.491 Vali Acc: 0.483 Test Loss: 2.491 Test Acc: 0.483
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6187556
	speed: 0.2612s/iter; left time: 2950.9897s
Epoch: 27 cost time: 8.21893835067749
Epoch: 27, Steps: 154 | Train Loss: 0.529 Vali Loss: 2.491 Vali Acc: 0.505 Test Loss: 2.491 Test Acc: 0.505
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.3970897
	speed: 0.2841s/iter; left time: 3165.3939s
Epoch: 28 cost time: 7.93356728553772
Epoch: 28, Steps: 154 | Train Loss: 0.520 Vali Loss: 2.546 Vali Acc: 0.472 Test Loss: 2.546 Test Acc: 0.472
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.7030291
	speed: 0.2776s/iter; left time: 3050.2690s
Epoch: 29 cost time: 8.285011768341064
Epoch: 29, Steps: 154 | Train Loss: 0.505 Vali Loss: 2.535 Vali Acc: 0.469 Test Loss: 2.535 Test Acc: 0.469
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.4838904
	speed: 0.2757s/iter; left time: 2986.7017s
Epoch: 30 cost time: 8.004664182662964
Epoch: 30, Steps: 154 | Train Loss: 0.521 Vali Loss: 2.695 Vali Acc: 0.452 Test Loss: 2.695 Test Acc: 0.452
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5154095701540957
model parameter : 31886
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3501449
	speed: 0.0880s/iter; left time: 1345.9488s
Epoch: 1 cost time: 11.969776153564453
Epoch: 1, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.071 Vali Acc: 0.378 Test Loss: 2.071 Test Acc: 0.378
Validation loss decreased (inf --> -0.378325).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3618835
	speed: 0.3039s/iter; left time: 4602.6745s
Epoch: 2 cost time: 8.27312183380127
Epoch: 2, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.002 Vali Acc: 0.480 Test Loss: 2.002 Test Acc: 0.480
Validation loss decreased (-0.378325 --> -0.480110).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8163226
	speed: 0.2884s/iter; left time: 4323.6554s
Epoch: 3 cost time: 8.863368272781372
Epoch: 3, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.235 Vali Acc: 0.491 Test Loss: 2.235 Test Acc: 0.491
Validation loss decreased (-0.480110 --> -0.491056).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3098739
	speed: 0.2924s/iter; left time: 4338.7990s
Epoch: 4 cost time: 9.15474009513855
Epoch: 4, Steps: 154 | Train Loss: 1.137 Vali Loss: 1.973 Vali Acc: 0.495 Test Loss: 1.973 Test Acc: 0.495
Validation loss decreased (-0.491056 --> -0.494709).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9683845
	speed: 0.3067s/iter; left time: 4504.0173s
Epoch: 5 cost time: 9.086130142211914
Epoch: 5, Steps: 154 | Train Loss: 1.082 Vali Loss: 1.896 Vali Acc: 0.515 Test Loss: 1.896 Test Acc: 0.515
Validation loss decreased (-0.494709 --> -0.514580).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5671157
	speed: 0.3086s/iter; left time: 4484.4367s
Epoch: 6 cost time: 9.173819541931152
Epoch: 6, Steps: 154 | Train Loss: 1.000 Vali Loss: 2.210 Vali Acc: 0.490 Test Loss: 2.210 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8087251
	speed: 0.3313s/iter; left time: 4763.5754s
Epoch: 7 cost time: 10.636401891708374
Epoch: 7, Steps: 154 | Train Loss: 0.948 Vali Loss: 2.073 Vali Acc: 0.506 Test Loss: 2.073 Test Acc: 0.506
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5432124
	speed: 0.3789s/iter; left time: 5389.1952s
Epoch: 8 cost time: 10.981231212615967
Epoch: 8, Steps: 154 | Train Loss: 0.865 Vali Loss: 2.382 Vali Acc: 0.513 Test Loss: 2.382 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2623235
	speed: 0.3635s/iter; left time: 5114.7509s
Epoch: 9 cost time: 10.088750839233398
Epoch: 9, Steps: 154 | Train Loss: 0.845 Vali Loss: 2.428 Vali Acc: 0.485 Test Loss: 2.428 Test Acc: 0.485
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6074406
	speed: 0.3550s/iter; left time: 4940.1428s
Epoch: 10 cost time: 10.216175317764282
Epoch: 10, Steps: 154 | Train Loss: 0.799 Vali Loss: 2.391 Vali Acc: 0.498 Test Loss: 2.391 Test Acc: 0.498
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.4047768
	speed: 0.3625s/iter; left time: 4988.4148s
Epoch: 11 cost time: 9.474590063095093
Epoch: 11, Steps: 154 | Train Loss: 0.719 Vali Loss: 2.462 Vali Acc: 0.464 Test Loss: 2.462 Test Acc: 0.464
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.7643426
	speed: 0.2752s/iter; left time: 3744.8399s
Epoch: 12 cost time: 6.763781785964966
Epoch: 12, Steps: 154 | Train Loss: 0.681 Vali Loss: 2.359 Vali Acc: 0.503 Test Loss: 2.359 Test Acc: 0.503
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.6591018
	speed: 0.2391s/iter; left time: 3216.3486s
Epoch: 13 cost time: 7.2116429805755615
Epoch: 13, Steps: 154 | Train Loss: 0.609 Vali Loss: 2.686 Vali Acc: 0.513 Test Loss: 2.686 Test Acc: 0.513
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.6668119
	speed: 0.2661s/iter; left time: 3538.8978s
Epoch: 14 cost time: 7.987815618515015
Epoch: 14, Steps: 154 | Train Loss: 0.570 Vali Loss: 2.673 Vali Acc: 0.449 Test Loss: 2.673 Test Acc: 0.449
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.8443989
	speed: 0.2749s/iter; left time: 3613.0613s
Epoch: 15 cost time: 7.869637966156006
Epoch: 15, Steps: 154 | Train Loss: 0.523 Vali Loss: 2.486 Vali Acc: 0.494 Test Loss: 2.486 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5145985401459854
model parameter : 105454
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7207192
	speed: 0.0800s/iter; left time: 1224.5105s
Epoch: 1 cost time: 10.704129934310913
Epoch: 1, Steps: 154 | Train Loss: 2.177 Vali Loss: 1.994 Vali Acc: 0.363 Test Loss: 1.994 Test Acc: 0.363
Validation loss decreased (inf --> -0.363321).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5038440
	speed: 0.2638s/iter; left time: 3995.5448s
Epoch: 2 cost time: 7.844083547592163
Epoch: 2, Steps: 154 | Train Loss: 1.604 Vali Loss: 1.819 Vali Acc: 0.428 Test Loss: 1.819 Test Acc: 0.428
Validation loss decreased (-0.363321 --> -0.428206).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7997003
	speed: 0.2867s/iter; left time: 4298.3131s
Epoch: 3 cost time: 7.579207897186279
Epoch: 3, Steps: 154 | Train Loss: 1.280 Vali Loss: 1.625 Vali Acc: 0.495 Test Loss: 1.625 Test Acc: 0.495
Validation loss decreased (-0.428206 --> -0.495118).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9703518
	speed: 0.2744s/iter; left time: 4072.4503s
Epoch: 4 cost time: 8.67635989189148
Epoch: 4, Steps: 154 | Train Loss: 1.135 Vali Loss: 1.552 Vali Acc: 0.524 Test Loss: 1.552 Test Acc: 0.524
Validation loss decreased (-0.495118 --> -0.523504).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2167430
	speed: 0.2681s/iter; left time: 3936.4881s
Epoch: 5 cost time: 7.368839502334595
Epoch: 5, Steps: 154 | Train Loss: 1.059 Vali Loss: 1.623 Vali Acc: 0.548 Test Loss: 1.623 Test Acc: 0.548
Validation loss decreased (-0.523504 --> -0.547835).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6276774
	speed: 0.3009s/iter; left time: 4371.8724s
Epoch: 6 cost time: 9.113869428634644
Epoch: 6, Steps: 154 | Train Loss: 0.983 Vali Loss: 1.782 Vali Acc: 0.495 Test Loss: 1.782 Test Acc: 0.495
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.8148242
	speed: 0.3221s/iter; left time: 4631.1758s
Epoch: 7 cost time: 9.96762752532959
Epoch: 7, Steps: 154 | Train Loss: 0.954 Vali Loss: 1.949 Vali Acc: 0.504 Test Loss: 1.949 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8682824
	speed: 0.3694s/iter; left time: 5253.7064s
Epoch: 8 cost time: 11.068931102752686
Epoch: 8, Steps: 154 | Train Loss: 0.923 Vali Loss: 1.811 Vali Acc: 0.522 Test Loss: 1.811 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.7932190
	speed: 0.3497s/iter; left time: 4920.1329s
Epoch: 9 cost time: 9.637763261795044
Epoch: 9, Steps: 154 | Train Loss: 0.837 Vali Loss: 1.886 Vali Acc: 0.504 Test Loss: 1.886 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6301914
	speed: 0.3503s/iter; left time: 4874.3649s
Epoch: 10 cost time: 10.172715663909912
Epoch: 10, Steps: 154 | Train Loss: 0.782 Vali Loss: 2.064 Vali Acc: 0.479 Test Loss: 2.064 Test Acc: 0.479
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.1315864
	speed: 0.3214s/iter; left time: 4423.2536s
Epoch: 11 cost time: 8.938136577606201
Epoch: 11, Steps: 154 | Train Loss: 0.746 Vali Loss: 1.964 Vali Acc: 0.540 Test Loss: 1.964 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.8290464
	speed: 0.2736s/iter; left time: 3723.2679s
Epoch: 12 cost time: 7.7076051235198975
Epoch: 12, Steps: 154 | Train Loss: 0.746 Vali Loss: 2.130 Vali Acc: 0.537 Test Loss: 2.130 Test Acc: 0.537
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.8142546
	speed: 0.2946s/iter; left time: 3963.1297s
Epoch: 13 cost time: 8.36897325515747
Epoch: 13, Steps: 154 | Train Loss: 0.691 Vali Loss: 2.116 Vali Acc: 0.542 Test Loss: 2.116 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0141670
	speed: 0.2747s/iter; left time: 3652.9798s
Epoch: 14 cost time: 7.172986745834351
Epoch: 14, Steps: 154 | Train Loss: 0.666 Vali Loss: 2.083 Vali Acc: 0.534 Test Loss: 2.083 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4964951
	speed: 0.2705s/iter; left time: 3555.4898s
Epoch: 15 cost time: 7.731443166732788
Epoch: 15, Steps: 154 | Train Loss: 0.608 Vali Loss: 2.200 Vali Acc: 0.542 Test Loss: 2.200 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5478507704785077
model parameter : 57102
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5620100
	speed: 0.0910s/iter; left time: 1391.6940s
Epoch: 1 cost time: 12.69417691230774
Epoch: 1, Steps: 154 | Train Loss: 2.155 Vali Loss: 1.866 Vali Acc: 0.411 Test Loss: 1.866 Test Acc: 0.411
Validation loss decreased (inf --> -0.410768).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3637443
	speed: 0.3116s/iter; left time: 4719.6600s
Epoch: 2 cost time: 7.9537153244018555
Epoch: 2, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.081 Vali Acc: 0.425 Test Loss: 2.081 Test Acc: 0.425
Validation loss decreased (-0.410768 --> -0.424553).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1829182
	speed: 0.3091s/iter; left time: 4634.9190s
Epoch: 3 cost time: 8.382889747619629
Epoch: 3, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.036 Vali Acc: 0.446 Test Loss: 2.036 Test Acc: 0.446
Validation loss decreased (-0.424553 --> -0.445641).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0311589
	speed: 0.2697s/iter; left time: 4001.3433s
Epoch: 4 cost time: 7.866570472717285
Epoch: 4, Steps: 154 | Train Loss: 1.186 Vali Loss: 2.060 Vali Acc: 0.467 Test Loss: 2.060 Test Acc: 0.467
Validation loss decreased (-0.445641 --> -0.466727).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9079071
	speed: 0.2893s/iter; left time: 4248.8170s
Epoch: 5 cost time: 8.776705265045166
Epoch: 5, Steps: 154 | Train Loss: 1.068 Vali Loss: 2.039 Vali Acc: 0.469 Test Loss: 2.039 Test Acc: 0.469
Validation loss decreased (-0.466727 --> -0.468755).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0085864
	speed: 0.3145s/iter; left time: 4569.8962s
Epoch: 6 cost time: 9.09248948097229
Epoch: 6, Steps: 154 | Train Loss: 1.013 Vali Loss: 2.116 Vali Acc: 0.428 Test Loss: 2.116 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9347214
	speed: 0.3178s/iter; left time: 4568.9905s
Epoch: 7 cost time: 9.417689561843872
Epoch: 7, Steps: 154 | Train Loss: 0.943 Vali Loss: 2.088 Vali Acc: 0.491 Test Loss: 2.088 Test Acc: 0.491
Validation loss decreased (-0.468755 --> -0.491058).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9149405
	speed: 0.3148s/iter; left time: 4477.8222s
Epoch: 8 cost time: 8.782358407974243
Epoch: 8, Steps: 154 | Train Loss: 0.927 Vali Loss: 2.023 Vali Acc: 0.509 Test Loss: 2.023 Test Acc: 0.509
Validation loss decreased (-0.491058 --> -0.508901).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9940125
	speed: 0.2971s/iter; left time: 4180.3354s
Epoch: 9 cost time: 9.239882707595825
Epoch: 9, Steps: 154 | Train Loss: 0.860 Vali Loss: 2.135 Vali Acc: 0.546 Test Loss: 2.135 Test Acc: 0.546
Validation loss decreased (-0.508901 --> -0.545802).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2081878
	speed: 0.3276s/iter; left time: 4558.0488s
Epoch: 10 cost time: 9.278382539749146
Epoch: 10, Steps: 154 | Train Loss: 0.819 Vali Loss: 2.148 Vali Acc: 0.481 Test Loss: 2.148 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9421542
	speed: 0.3385s/iter; left time: 4657.6769s
Epoch: 11 cost time: 9.981670618057251
Epoch: 11, Steps: 154 | Train Loss: 0.764 Vali Loss: 2.219 Vali Acc: 0.516 Test Loss: 2.219 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1894109
	speed: 0.3346s/iter; left time: 4553.2348s
Epoch: 12 cost time: 9.429821968078613
Epoch: 12, Steps: 154 | Train Loss: 0.760 Vali Loss: 2.242 Vali Acc: 0.457 Test Loss: 2.242 Test Acc: 0.457
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.5581584
	speed: 0.3155s/iter; left time: 4244.1944s
Epoch: 13 cost time: 9.70767617225647
Epoch: 13, Steps: 154 | Train Loss: 0.726 Vali Loss: 2.344 Vali Acc: 0.448 Test Loss: 2.344 Test Acc: 0.448
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.9662333
	speed: 0.3283s/iter; left time: 4366.4460s
Epoch: 14 cost time: 9.32200574874878
Epoch: 14, Steps: 154 | Train Loss: 0.683 Vali Loss: 2.360 Vali Acc: 0.492 Test Loss: 2.360 Test Acc: 0.492
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3973343
	speed: 0.3242s/iter; left time: 4261.3684s
Epoch: 15 cost time: 9.487227201461792
Epoch: 15, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.226 Vali Acc: 0.524 Test Loss: 2.226 Test Acc: 0.524
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.2757187
	speed: 0.2844s/iter; left time: 3694.8421s
Epoch: 16 cost time: 8.048378705978394
Epoch: 16, Steps: 154 | Train Loss: 0.606 Vali Loss: 2.425 Vali Acc: 0.506 Test Loss: 2.425 Test Acc: 0.506
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8982635
	speed: 0.2757s/iter; left time: 3539.5240s
Epoch: 17 cost time: 8.470068216323853
Epoch: 17, Steps: 154 | Train Loss: 0.577 Vali Loss: 2.463 Vali Acc: 0.524 Test Loss: 2.463 Test Acc: 0.524
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.8696319
	speed: 0.2744s/iter; left time: 3480.5104s
Epoch: 18 cost time: 7.451785326004028
Epoch: 18, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.473 Vali Acc: 0.472 Test Loss: 2.473 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.6264367
	speed: 0.2741s/iter; left time: 3434.5033s
Epoch: 19 cost time: 9.424963474273682
Epoch: 19, Steps: 154 | Train Loss: 0.509 Vali Loss: 2.504 Vali Acc: 0.496 Test Loss: 2.504 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.545823195458232
model parameter : 57134
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9677657
	speed: 0.0996s/iter; left time: 1524.7243s
Epoch: 1 cost time: 12.932710409164429
Epoch: 1, Steps: 154 | Train Loss: 2.237 Vali Loss: 1.969 Vali Acc: 0.377 Test Loss: 1.969 Test Acc: 0.377
Validation loss decreased (inf --> -0.376704).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7279841
	speed: 0.2879s/iter; left time: 4360.2017s
Epoch: 2 cost time: 7.96621036529541
Epoch: 2, Steps: 154 | Train Loss: 1.655 Vali Loss: 1.804 Vali Acc: 0.418 Test Loss: 1.804 Test Acc: 0.418
Validation loss decreased (-0.376704 --> -0.417662).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3119769
	speed: 0.2981s/iter; left time: 4469.5879s
Epoch: 3 cost time: 7.583602428436279
Epoch: 3, Steps: 154 | Train Loss: 1.320 Vali Loss: 1.834 Vali Acc: 0.470 Test Loss: 1.834 Test Acc: 0.470
Validation loss decreased (-0.417662 --> -0.470379).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9115677
	speed: 0.2789s/iter; left time: 4138.6256s
Epoch: 4 cost time: 8.633886814117432
Epoch: 4, Steps: 154 | Train Loss: 1.200 Vali Loss: 1.972 Vali Acc: 0.492 Test Loss: 1.972 Test Acc: 0.492
Validation loss decreased (-0.470379 --> -0.491870).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6566661
	speed: 0.3306s/iter; left time: 4855.0816s
Epoch: 5 cost time: 9.89922571182251
Epoch: 5, Steps: 154 | Train Loss: 1.130 Vali Loss: 2.070 Vali Acc: 0.459 Test Loss: 2.070 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.9601891
	speed: 0.3081s/iter; left time: 4477.6680s
Epoch: 6 cost time: 8.139805316925049
Epoch: 6, Steps: 154 | Train Loss: 1.043 Vali Loss: 1.907 Vali Acc: 0.493 Test Loss: 1.907 Test Acc: 0.493
Validation loss decreased (-0.491870 --> -0.492682).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0183140
	speed: 0.2925s/iter; left time: 4205.8724s
Epoch: 7 cost time: 8.067342281341553
Epoch: 7, Steps: 154 | Train Loss: 1.003 Vali Loss: 1.823 Vali Acc: 0.526 Test Loss: 1.823 Test Acc: 0.526
Validation loss decreased (-0.492682 --> -0.526340).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6520681
	speed: 0.3443s/iter; left time: 4897.5343s
Epoch: 8 cost time: 10.351550579071045
Epoch: 8, Steps: 154 | Train Loss: 0.938 Vali Loss: 1.907 Vali Acc: 0.494 Test Loss: 1.907 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7567146
	speed: 0.3438s/iter; left time: 4837.3086s
Epoch: 9 cost time: 10.410431623458862
Epoch: 9, Steps: 154 | Train Loss: 0.903 Vali Loss: 1.887 Vali Acc: 0.517 Test Loss: 1.887 Test Acc: 0.517
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.8071842
	speed: 0.3468s/iter; left time: 4825.7182s
Epoch: 10 cost time: 10.784751892089844
Epoch: 10, Steps: 154 | Train Loss: 0.869 Vali Loss: 1.973 Vali Acc: 0.497 Test Loss: 1.973 Test Acc: 0.497
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5255962
	speed: 0.3619s/iter; left time: 4979.7450s
Epoch: 11 cost time: 9.664305210113525
Epoch: 11, Steps: 154 | Train Loss: 0.862 Vali Loss: 1.895 Vali Acc: 0.529 Test Loss: 1.895 Test Acc: 0.529
Validation loss decreased (-0.526340 --> -0.528773).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9390159
	speed: 0.3311s/iter; left time: 4505.3890s
Epoch: 12 cost time: 10.153998136520386
Epoch: 12, Steps: 154 | Train Loss: 0.803 Vali Loss: 2.068 Vali Acc: 0.520 Test Loss: 2.068 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6304688
	speed: 0.3228s/iter; left time: 4342.4628s
Epoch: 13 cost time: 8.825395822525024
Epoch: 13, Steps: 154 | Train Loss: 0.762 Vali Loss: 2.165 Vali Acc: 0.514 Test Loss: 2.165 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.6974583
	speed: 0.3040s/iter; left time: 4042.2412s
Epoch: 14 cost time: 8.442209959030151
Epoch: 14, Steps: 154 | Train Loss: 0.743 Vali Loss: 2.279 Vali Acc: 0.518 Test Loss: 2.279 Test Acc: 0.518
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1320221
	speed: 0.2784s/iter; left time: 3659.3506s
Epoch: 15 cost time: 7.870912313461304
Epoch: 15, Steps: 154 | Train Loss: 0.698 Vali Loss: 2.260 Vali Acc: 0.474 Test Loss: 2.260 Test Acc: 0.474
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.3220143
	speed: 0.2531s/iter; left time: 3287.8082s
Epoch: 16 cost time: 6.628380298614502
Epoch: 16, Steps: 154 | Train Loss: 0.665 Vali Loss: 2.376 Vali Acc: 0.505 Test Loss: 2.376 Test Acc: 0.505
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5967035
	speed: 0.2591s/iter; left time: 3326.6433s
Epoch: 17 cost time: 7.425915956497192
Epoch: 17, Steps: 154 | Train Loss: 0.635 Vali Loss: 2.231 Vali Acc: 0.506 Test Loss: 2.231 Test Acc: 0.506
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.7977068
	speed: 0.3145s/iter; left time: 3988.5207s
Epoch: 18 cost time: 9.791102170944214
Epoch: 18, Steps: 154 | Train Loss: 0.606 Vali Loss: 2.315 Vali Acc: 0.510 Test Loss: 2.315 Test Acc: 0.510
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.9340625
	speed: 0.2740s/iter; left time: 3432.9407s
Epoch: 19 cost time: 7.502979040145874
Epoch: 19, Steps: 154 | Train Loss: 0.583 Vali Loss: 2.466 Vali Acc: 0.496 Test Loss: 2.466 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.3079568
	speed: 0.2865s/iter; left time: 3546.0241s
Epoch: 20 cost time: 8.139355897903442
Epoch: 20, Steps: 154 | Train Loss: 0.586 Vali Loss: 2.504 Vali Acc: 0.481 Test Loss: 2.504 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.6718000
	speed: 0.2601s/iter; left time: 3178.8660s
Epoch: 21 cost time: 8.185236692428589
Epoch: 21, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.343 Vali Acc: 0.524 Test Loss: 2.343 Test Acc: 0.524
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5287915652879156
model parameter : 41070
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4513111
	speed: 0.0880s/iter; left time: 1346.9005s
Epoch: 1 cost time: 11.9669349193573
Epoch: 1, Steps: 154 | Train Loss: 2.284 Vali Loss: 2.059 Vali Acc: 0.331 Test Loss: 2.059 Test Acc: 0.331
Validation loss decreased (inf --> -0.331285).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6058933
	speed: 0.2844s/iter; left time: 4307.4555s
Epoch: 2 cost time: 6.386395454406738
Epoch: 2, Steps: 154 | Train Loss: 1.772 Vali Loss: 1.976 Vali Acc: 0.367 Test Loss: 1.976 Test Acc: 0.367
Validation loss decreased (-0.331285 --> -0.366971).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5572565
	speed: 0.2894s/iter; left time: 4338.7598s
Epoch: 3 cost time: 9.43596363067627
Epoch: 3, Steps: 154 | Train Loss: 1.448 Vali Loss: 1.981 Vali Acc: 0.416 Test Loss: 1.981 Test Acc: 0.416
Validation loss decreased (-0.366971 --> -0.416039).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7101960
	speed: 0.3079s/iter; left time: 4569.2774s
Epoch: 4 cost time: 8.728929042816162
Epoch: 4, Steps: 154 | Train Loss: 1.299 Vali Loss: 1.887 Vali Acc: 0.447 Test Loss: 1.887 Test Acc: 0.447
Validation loss decreased (-0.416039 --> -0.446859).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0448439
	speed: 0.3444s/iter; left time: 5056.8418s
Epoch: 5 cost time: 10.426871299743652
Epoch: 5, Steps: 154 | Train Loss: 1.190 Vali Loss: 1.938 Vali Acc: 0.459 Test Loss: 1.938 Test Acc: 0.459
Validation loss decreased (-0.446859 --> -0.459024).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6855615
	speed: 0.3480s/iter; left time: 5056.1287s
Epoch: 6 cost time: 10.115732669830322
Epoch: 6, Steps: 154 | Train Loss: 1.116 Vali Loss: 1.950 Vali Acc: 0.480 Test Loss: 1.950 Test Acc: 0.480
Validation loss decreased (-0.459024 --> -0.479705).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8471768
	speed: 0.3631s/iter; left time: 5220.6853s
Epoch: 7 cost time: 10.12118649482727
Epoch: 7, Steps: 154 | Train Loss: 1.073 Vali Loss: 1.927 Vali Acc: 0.496 Test Loss: 1.927 Test Acc: 0.496
Validation loss decreased (-0.479705 --> -0.495520).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5290083
	speed: 0.3294s/iter; left time: 4685.6804s
Epoch: 8 cost time: 9.80339241027832
Epoch: 8, Steps: 154 | Train Loss: 1.025 Vali Loss: 2.107 Vali Acc: 0.471 Test Loss: 2.107 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3592699
	speed: 0.3498s/iter; left time: 4921.0333s
Epoch: 9 cost time: 9.08929443359375
Epoch: 9, Steps: 154 | Train Loss: 0.983 Vali Loss: 1.859 Vali Acc: 0.507 Test Loss: 1.859 Test Acc: 0.507
Validation loss decreased (-0.495520 --> -0.507281).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7929871
	speed: 0.2949s/iter; left time: 4104.0560s
Epoch: 10 cost time: 9.942840099334717
Epoch: 10, Steps: 154 | Train Loss: 0.948 Vali Loss: 1.809 Vali Acc: 0.515 Test Loss: 1.809 Test Acc: 0.515
Validation loss decreased (-0.507281 --> -0.515391).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.5572037
	speed: 0.3025s/iter; left time: 4162.9542s
Epoch: 11 cost time: 8.948082208633423
Epoch: 11, Steps: 154 | Train Loss: 0.898 Vali Loss: 1.965 Vali Acc: 0.502 Test Loss: 1.965 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.5210738
	speed: 0.2927s/iter; left time: 3982.6298s
Epoch: 12 cost time: 8.356491327285767
Epoch: 12, Steps: 154 | Train Loss: 0.887 Vali Loss: 1.998 Vali Acc: 0.511 Test Loss: 1.998 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5052807
	speed: 0.2708s/iter; left time: 3642.8336s
Epoch: 13 cost time: 7.765620708465576
Epoch: 13, Steps: 154 | Train Loss: 0.850 Vali Loss: 1.886 Vali Acc: 0.523 Test Loss: 1.886 Test Acc: 0.523
Validation loss decreased (-0.515391 --> -0.522690).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3498838
	speed: 0.3141s/iter; left time: 4177.0957s
Epoch: 14 cost time: 9.74050235748291
Epoch: 14, Steps: 154 | Train Loss: 0.798 Vali Loss: 1.975 Vali Acc: 0.529 Test Loss: 1.975 Test Acc: 0.529
Validation loss decreased (-0.522690 --> -0.528772).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2756481
	speed: 0.3257s/iter; left time: 4280.8658s
Epoch: 15 cost time: 9.668153524398804
Epoch: 15, Steps: 154 | Train Loss: 0.769 Vali Loss: 2.169 Vali Acc: 0.518 Test Loss: 2.169 Test Acc: 0.518
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0692475
	speed: 0.3226s/iter; left time: 4190.8764s
Epoch: 16 cost time: 9.46840524673462
Epoch: 16, Steps: 154 | Train Loss: 0.740 Vali Loss: 2.115 Vali Acc: 0.532 Test Loss: 2.115 Test Acc: 0.532
Validation loss decreased (-0.528772 --> -0.531609).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.6180682
	speed: 0.2944s/iter; left time: 3779.3087s
Epoch: 17 cost time: 9.68600845336914
Epoch: 17, Steps: 154 | Train Loss: 0.707 Vali Loss: 2.138 Vali Acc: 0.527 Test Loss: 2.138 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5503165
	speed: 0.3303s/iter; left time: 4189.8190s
Epoch: 18 cost time: 9.284243822097778
Epoch: 18, Steps: 154 | Train Loss: 0.670 Vali Loss: 2.083 Vali Acc: 0.516 Test Loss: 2.083 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.6013147
	speed: 0.2870s/iter; left time: 3595.9141s
Epoch: 19 cost time: 9.599024295806885
Epoch: 19, Steps: 154 | Train Loss: 0.698 Vali Loss: 2.300 Vali Acc: 0.508 Test Loss: 2.300 Test Acc: 0.508
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.9336301
	speed: 0.3414s/iter; left time: 4225.1732s
Epoch: 20 cost time: 9.360326766967773
Epoch: 20, Steps: 154 | Train Loss: 0.656 Vali Loss: 2.271 Vali Acc: 0.518 Test Loss: 2.271 Test Acc: 0.518
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.6088969
	speed: 0.3047s/iter; left time: 3724.0520s
Epoch: 21 cost time: 8.370093822479248
Epoch: 21, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.236 Vali Acc: 0.505 Test Loss: 2.236 Test Acc: 0.505
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.6204270
	speed: 0.3102s/iter; left time: 3743.4191s
Epoch: 22 cost time: 8.740159034729004
Epoch: 22, Steps: 154 | Train Loss: 0.637 Vali Loss: 2.327 Vali Acc: 0.510 Test Loss: 2.327 Test Acc: 0.510
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.6046933
	speed: 0.3250s/iter; left time: 3871.6472s
Epoch: 23 cost time: 10.322444438934326
Epoch: 23, Steps: 154 | Train Loss: 0.631 Vali Loss: 2.487 Vali Acc: 0.515 Test Loss: 2.487 Test Acc: 0.515
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.6973017
	speed: 0.3694s/iter; left time: 4343.6105s
Epoch: 24 cost time: 10.99346399307251
Epoch: 24, Steps: 154 | Train Loss: 0.597 Vali Loss: 2.377 Vali Acc: 0.504 Test Loss: 2.377 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.8045114
	speed: 0.3329s/iter; left time: 3863.1079s
Epoch: 25 cost time: 9.590946912765503
Epoch: 25, Steps: 154 | Train Loss: 0.556 Vali Loss: 2.732 Vali Acc: 0.472 Test Loss: 2.732 Test Acc: 0.472
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.4891725
	speed: 0.3203s/iter; left time: 3667.7396s
Epoch: 26 cost time: 9.890930652618408
Epoch: 26, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.911 Vali Acc: 0.492 Test Loss: 2.911 Test Acc: 0.492
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5316301703163017
model parameter : 33070
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2525511
	speed: 0.0955s/iter; left time: 1461.9687s
Epoch: 1 cost time: 11.529253005981445
Epoch: 1, Steps: 154 | Train Loss: 2.320 Vali Loss: 2.117 Vali Acc: 0.315 Test Loss: 2.117 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8666015
	speed: 0.2777s/iter; left time: 4205.5875s
Epoch: 2 cost time: 8.827564239501953
Epoch: 2, Steps: 154 | Train Loss: 1.915 Vali Loss: 1.820 Vali Acc: 0.399 Test Loss: 1.820 Test Acc: 0.399
Validation loss decreased (-0.315064 --> -0.398603).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0675954
	speed: 0.3026s/iter; left time: 4536.1627s
Epoch: 3 cost time: 7.6892805099487305
Epoch: 3, Steps: 154 | Train Loss: 1.499 Vali Loss: 1.704 Vali Acc: 0.450 Test Loss: 1.704 Test Acc: 0.450
Validation loss decreased (-0.398603 --> -0.449699).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7653668
	speed: 0.2903s/iter; left time: 4307.1234s
Epoch: 4 cost time: 9.438737392425537
Epoch: 4, Steps: 154 | Train Loss: 1.307 Vali Loss: 1.885 Vali Acc: 0.456 Test Loss: 1.885 Test Acc: 0.456
Validation loss decreased (-0.449699 --> -0.455780).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1817877
	speed: 0.2834s/iter; left time: 4162.0662s
Epoch: 5 cost time: 7.672484874725342
Epoch: 5, Steps: 154 | Train Loss: 1.229 Vali Loss: 1.855 Vali Acc: 0.455 Test Loss: 1.855 Test Acc: 0.455
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0506209
	speed: 0.2959s/iter; left time: 4299.4143s
Epoch: 6 cost time: 8.921523809432983
Epoch: 6, Steps: 154 | Train Loss: 1.145 Vali Loss: 1.777 Vali Acc: 0.479 Test Loss: 1.777 Test Acc: 0.479
Validation loss decreased (-0.455780 --> -0.478895).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4388908
	speed: 0.2954s/iter; left time: 4247.4264s
Epoch: 7 cost time: 8.413362979888916
Epoch: 7, Steps: 154 | Train Loss: 1.122 Vali Loss: 1.746 Vali Acc: 0.486 Test Loss: 1.746 Test Acc: 0.486
Validation loss decreased (-0.478895 --> -0.485790).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8959330
	speed: 0.2912s/iter; left time: 4142.2144s
Epoch: 8 cost time: 8.890695095062256
Epoch: 8, Steps: 154 | Train Loss: 1.088 Vali Loss: 1.930 Vali Acc: 0.474 Test Loss: 1.930 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1608800
	speed: 0.3084s/iter; left time: 4339.4242s
Epoch: 9 cost time: 8.410715818405151
Epoch: 9, Steps: 154 | Train Loss: 1.035 Vali Loss: 1.940 Vali Acc: 0.481 Test Loss: 1.940 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.7706898
	speed: 0.3153s/iter; left time: 4387.6306s
Epoch: 10 cost time: 8.640804767608643
Epoch: 10, Steps: 154 | Train Loss: 0.990 Vali Loss: 2.006 Vali Acc: 0.473 Test Loss: 2.006 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3796855
	speed: 0.3179s/iter; left time: 4374.4984s
Epoch: 11 cost time: 10.169742107391357
Epoch: 11, Steps: 154 | Train Loss: 0.957 Vali Loss: 1.806 Vali Acc: 0.497 Test Loss: 1.806 Test Acc: 0.497
Validation loss decreased (-0.485790 --> -0.497143).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6472147
	speed: 0.3342s/iter; left time: 4547.9785s
Epoch: 12 cost time: 9.535801649093628
Epoch: 12, Steps: 154 | Train Loss: 0.921 Vali Loss: 1.952 Vali Acc: 0.491 Test Loss: 1.952 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.7523440
	speed: 0.3216s/iter; left time: 4326.1892s
Epoch: 13 cost time: 8.72410249710083
Epoch: 13, Steps: 154 | Train Loss: 0.888 Vali Loss: 1.813 Vali Acc: 0.515 Test Loss: 1.813 Test Acc: 0.515
Validation loss decreased (-0.497143 --> -0.514580).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8505701
	speed: 0.3071s/iter; left time: 4084.4504s
Epoch: 14 cost time: 8.466900825500488
Epoch: 14, Steps: 154 | Train Loss: 0.860 Vali Loss: 1.908 Vali Acc: 0.483 Test Loss: 1.908 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.3120237
	speed: 0.3209s/iter; left time: 4217.8166s
Epoch: 15 cost time: 10.093541145324707
Epoch: 15, Steps: 154 | Train Loss: 0.828 Vali Loss: 1.886 Vali Acc: 0.490 Test Loss: 1.886 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5773082
	speed: 0.3032s/iter; left time: 3938.2305s
Epoch: 16 cost time: 8.711349248886108
Epoch: 16, Steps: 154 | Train Loss: 0.813 Vali Loss: 2.023 Vali Acc: 0.517 Test Loss: 2.023 Test Acc: 0.517
Validation loss decreased (-0.514580 --> -0.516606).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0260665
	speed: 0.3141s/iter; left time: 4032.2191s
Epoch: 17 cost time: 9.65622067451477
Epoch: 17, Steps: 154 | Train Loss: 0.782 Vali Loss: 2.009 Vali Acc: 0.509 Test Loss: 2.009 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.9920382
	speed: 0.3452s/iter; left time: 4378.5066s
Epoch: 18 cost time: 9.334696531295776
Epoch: 18, Steps: 154 | Train Loss: 0.775 Vali Loss: 1.975 Vali Acc: 0.525 Test Loss: 1.975 Test Acc: 0.525
Validation loss decreased (-0.516606 --> -0.524717).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9790892
	speed: 0.3278s/iter; left time: 4106.6506s
Epoch: 19 cost time: 8.227447986602783
Epoch: 19, Steps: 154 | Train Loss: 0.739 Vali Loss: 2.156 Vali Acc: 0.488 Test Loss: 2.156 Test Acc: 0.488
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.6855541
	speed: 0.3077s/iter; left time: 3807.3396s
Epoch: 20 cost time: 8.89182424545288
Epoch: 20, Steps: 154 | Train Loss: 0.725 Vali Loss: 2.039 Vali Acc: 0.497 Test Loss: 2.039 Test Acc: 0.497
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1009711
	speed: 0.3041s/iter; left time: 3716.0619s
Epoch: 21 cost time: 9.598114967346191
Epoch: 21, Steps: 154 | Train Loss: 0.698 Vali Loss: 2.139 Vali Acc: 0.464 Test Loss: 2.139 Test Acc: 0.464
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.8400485
	speed: 0.3133s/iter; left time: 3780.3656s
Epoch: 22 cost time: 8.586751937866211
Epoch: 22, Steps: 154 | Train Loss: 0.670 Vali Loss: 2.157 Vali Acc: 0.485 Test Loss: 2.157 Test Acc: 0.485
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.5574807
	speed: 0.2887s/iter; left time: 3439.7307s
Epoch: 23 cost time: 7.357346296310425
Epoch: 23, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.350 Vali Acc: 0.484 Test Loss: 2.350 Test Acc: 0.484
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.8739756
	speed: 0.2633s/iter; left time: 3095.7338s
Epoch: 24 cost time: 8.378830671310425
Epoch: 24, Steps: 154 | Train Loss: 0.650 Vali Loss: 2.273 Vali Acc: 0.543 Test Loss: 2.273 Test Acc: 0.543
Validation loss decreased (-0.524717 --> -0.543367).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.8401544
	speed: 0.2598s/iter; left time: 3015.0042s
Epoch: 25 cost time: 8.068740129470825
Epoch: 25, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.354 Vali Acc: 0.504 Test Loss: 2.354 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.0161499
	speed: 0.2819s/iter; left time: 3228.5214s
Epoch: 26 cost time: 8.218132972717285
Epoch: 26, Steps: 154 | Train Loss: 0.614 Vali Loss: 2.162 Vali Acc: 0.502 Test Loss: 2.162 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1693078
	speed: 0.2844s/iter; left time: 3213.2133s
Epoch: 27 cost time: 8.085970163345337
Epoch: 27, Steps: 154 | Train Loss: 0.611 Vali Loss: 2.270 Vali Acc: 0.514 Test Loss: 2.270 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.4631219
	speed: 0.3091s/iter; left time: 3444.6639s
Epoch: 28 cost time: 8.026082038879395
Epoch: 28, Steps: 154 | Train Loss: 0.572 Vali Loss: 2.298 Vali Acc: 0.532 Test Loss: 2.298 Test Acc: 0.532
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.7065355
	speed: 0.3235s/iter; left time: 3554.6172s
Epoch: 29 cost time: 10.11268424987793
Epoch: 29, Steps: 154 | Train Loss: 0.562 Vali Loss: 2.257 Vali Acc: 0.491 Test Loss: 2.257 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.8500081
	speed: 0.3439s/iter; left time: 3726.0480s
Epoch: 30 cost time: 9.517130851745605
Epoch: 30, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.478 Vali Acc: 0.511 Test Loss: 2.478 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.3873355
	speed: 0.3326s/iter; left time: 3552.7047s
Epoch: 31 cost time: 10.999642133712769
Epoch: 31, Steps: 154 | Train Loss: 0.547 Vali Loss: 2.279 Vali Acc: 0.522 Test Loss: 2.279 Test Acc: 0.522
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.7207986
	speed: 0.3622s/iter; left time: 3813.3859s
Epoch: 32 cost time: 10.133431434631348
Epoch: 32, Steps: 154 | Train Loss: 0.528 Vali Loss: 2.391 Vali Acc: 0.524 Test Loss: 2.391 Test Acc: 0.524
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 1.2158465
	speed: 0.3347s/iter; left time: 3471.6841s
Epoch: 33 cost time: 9.011028289794922
Epoch: 33, Steps: 154 | Train Loss: 0.506 Vali Loss: 2.397 Vali Acc: 0.515 Test Loss: 2.397 Test Acc: 0.515
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.4002952
	speed: 0.2923s/iter; left time: 2986.5801s
Epoch: 34 cost time: 7.684265613555908
Epoch: 34, Steps: 154 | Train Loss: 0.523 Vali Loss: 2.536 Vali Acc: 0.491 Test Loss: 2.536 Test Acc: 0.491
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm32_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5433901054339011
model parameter : 27726
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1259370
	speed: 0.1037s/iter; left time: 1587.1277s
Epoch: 1 cost time: 13.60501742362976
Epoch: 1, Steps: 154 | Train Loss: 2.193 Vali Loss: 1.986 Vali Acc: 0.341 Test Loss: 1.986 Test Acc: 0.341
Validation loss decreased (inf --> -0.341424).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4595191
	speed: 0.2816s/iter; left time: 4265.2205s
Epoch: 2 cost time: 7.8875343799591064
Epoch: 2, Steps: 154 | Train Loss: 1.652 Vali Loss: 1.887 Vali Acc: 0.423 Test Loss: 1.887 Test Acc: 0.423
Validation loss decreased (-0.341424 --> -0.422528).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7784362
	speed: 0.3215s/iter; left time: 4820.0959s
Epoch: 3 cost time: 9.956944942474365
Epoch: 3, Steps: 154 | Train Loss: 1.297 Vali Loss: 1.765 Vali Acc: 0.479 Test Loss: 1.765 Test Acc: 0.479
Validation loss decreased (-0.422528 --> -0.479301).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0832320
	speed: 0.3053s/iter; left time: 4530.9563s
Epoch: 4 cost time: 8.392881870269775
Epoch: 4, Steps: 154 | Train Loss: 1.135 Vali Loss: 1.673 Vali Acc: 0.520 Test Loss: 1.673 Test Acc: 0.520
Validation loss decreased (-0.479301 --> -0.520259).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0999333
	speed: 0.3276s/iter; left time: 4811.4860s
Epoch: 5 cost time: 8.340969562530518
Epoch: 5, Steps: 154 | Train Loss: 1.031 Vali Loss: 1.774 Vali Acc: 0.516 Test Loss: 1.774 Test Acc: 0.516
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0250481
	speed: 0.2900s/iter; left time: 4213.8284s
Epoch: 6 cost time: 8.178589105606079
Epoch: 6, Steps: 154 | Train Loss: 0.975 Vali Loss: 1.645 Vali Acc: 0.523 Test Loss: 1.645 Test Acc: 0.523
Validation loss decreased (-0.520259 --> -0.522692).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3655012
	speed: 0.2855s/iter; left time: 4104.8055s
Epoch: 7 cost time: 8.606019973754883
Epoch: 7, Steps: 154 | Train Loss: 0.881 Vali Loss: 1.910 Vali Acc: 0.505 Test Loss: 1.910 Test Acc: 0.505
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5789788
	speed: 0.2836s/iter; left time: 4033.1946s
Epoch: 8 cost time: 8.476834774017334
Epoch: 8, Steps: 154 | Train Loss: 0.863 Vali Loss: 1.965 Vali Acc: 0.492 Test Loss: 1.965 Test Acc: 0.492
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1271222
	speed: 0.2649s/iter; left time: 3727.0135s
Epoch: 9 cost time: 7.4577178955078125
Epoch: 9, Steps: 154 | Train Loss: 0.822 Vali Loss: 2.007 Vali Acc: 0.515 Test Loss: 2.007 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.6616035
	speed: 0.3055s/iter; left time: 4250.5070s
Epoch: 10 cost time: 9.327958822250366
Epoch: 10, Steps: 154 | Train Loss: 0.794 Vali Loss: 2.038 Vali Acc: 0.498 Test Loss: 2.038 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8629713
	speed: 0.3064s/iter; left time: 4216.3928s
Epoch: 11 cost time: 9.196675300598145
Epoch: 11, Steps: 154 | Train Loss: 0.742 Vali Loss: 2.038 Vali Acc: 0.513 Test Loss: 2.038 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5361153
	speed: 0.3251s/iter; left time: 4423.9165s
Epoch: 12 cost time: 9.479703426361084
Epoch: 12, Steps: 154 | Train Loss: 0.725 Vali Loss: 2.165 Vali Acc: 0.475 Test Loss: 2.165 Test Acc: 0.475
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9237406
	speed: 0.3255s/iter; left time: 4379.2213s
Epoch: 13 cost time: 10.203743934631348
Epoch: 13, Steps: 154 | Train Loss: 0.661 Vali Loss: 2.422 Vali Acc: 0.496 Test Loss: 2.422 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.3890628
	speed: 0.3340s/iter; left time: 4442.1182s
Epoch: 14 cost time: 8.490944385528564
Epoch: 14, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.221 Vali Acc: 0.473 Test Loss: 2.221 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.6097439
	speed: 0.2877s/iter; left time: 3781.5778s
Epoch: 15 cost time: 8.807895183563232
Epoch: 15, Steps: 154 | Train Loss: 0.594 Vali Loss: 2.382 Vali Acc: 0.486 Test Loss: 2.382 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.4316866
	speed: 0.3289s/iter; left time: 4272.1367s
Epoch: 16 cost time: 9.579478979110718
Epoch: 16, Steps: 154 | Train Loss: 0.565 Vali Loss: 2.392 Vali Acc: 0.470 Test Loss: 2.392 Test Acc: 0.470
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5227088402270884
model parameter : 58078
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4144592
	speed: 0.0816s/iter; left time: 1248.6950s
Epoch: 1 cost time: 10.897228240966797
Epoch: 1, Steps: 154 | Train Loss: 2.215 Vali Loss: 1.988 Vali Acc: 0.354 Test Loss: 1.988 Test Acc: 0.354
Validation loss decreased (inf --> -0.353995).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8708420
	speed: 0.3222s/iter; left time: 4880.1120s
Epoch: 2 cost time: 8.032819509506226
Epoch: 2, Steps: 154 | Train Loss: 1.722 Vali Loss: 1.720 Vali Acc: 0.434 Test Loss: 1.720 Test Acc: 0.434
Validation loss decreased (-0.353995 --> -0.434289).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3543639
	speed: 0.2523s/iter; left time: 3783.2050s
Epoch: 3 cost time: 6.943771839141846
Epoch: 3, Steps: 154 | Train Loss: 1.390 Vali Loss: 1.745 Vali Acc: 0.457 Test Loss: 1.745 Test Acc: 0.457
Validation loss decreased (-0.434289 --> -0.456998).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3555264
	speed: 0.2945s/iter; left time: 4370.0759s
Epoch: 4 cost time: 8.473276138305664
Epoch: 4, Steps: 154 | Train Loss: 1.196 Vali Loss: 1.740 Vali Acc: 0.473 Test Loss: 1.740 Test Acc: 0.473
Validation loss decreased (-0.456998 --> -0.473219).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5725315
	speed: 0.2958s/iter; left time: 4344.2055s
Epoch: 5 cost time: 8.86201786994934
Epoch: 5, Steps: 154 | Train Loss: 1.092 Vali Loss: 1.672 Vali Acc: 0.504 Test Loss: 1.672 Test Acc: 0.504
Validation loss decreased (-0.473219 --> -0.503633).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2798489
	speed: 0.2959s/iter; left time: 4300.3071s
Epoch: 6 cost time: 8.483675241470337
Epoch: 6, Steps: 154 | Train Loss: 1.035 Vali Loss: 1.765 Vali Acc: 0.496 Test Loss: 1.765 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9323748
	speed: 0.2793s/iter; left time: 4015.3573s
Epoch: 7 cost time: 8.045888900756836
Epoch: 7, Steps: 154 | Train Loss: 0.983 Vali Loss: 1.665 Vali Acc: 0.533 Test Loss: 1.665 Test Acc: 0.533
Validation loss decreased (-0.503633 --> -0.532830).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6806103
	speed: 0.2950s/iter; left time: 4195.4664s
Epoch: 8 cost time: 9.037318706512451
Epoch: 8, Steps: 154 | Train Loss: 0.937 Vali Loss: 1.648 Vali Acc: 0.520 Test Loss: 1.648 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0084138
	speed: 0.2724s/iter; left time: 3831.9940s
Epoch: 9 cost time: 7.87623143196106
Epoch: 9, Steps: 154 | Train Loss: 0.903 Vali Loss: 1.648 Vali Acc: 0.507 Test Loss: 1.648 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3207988
	speed: 0.2541s/iter; left time: 3535.6954s
Epoch: 10 cost time: 6.933595180511475
Epoch: 10, Steps: 154 | Train Loss: 0.872 Vali Loss: 1.733 Vali Acc: 0.479 Test Loss: 1.733 Test Acc: 0.479
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9675356
	speed: 0.2889s/iter; left time: 3976.0098s
Epoch: 11 cost time: 7.88745903968811
Epoch: 11, Steps: 154 | Train Loss: 0.831 Vali Loss: 1.754 Vali Acc: 0.549 Test Loss: 1.754 Test Acc: 0.549
Validation loss decreased (-0.532830 --> -0.549050).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6691115
	speed: 0.2886s/iter; left time: 3927.3014s
Epoch: 12 cost time: 8.942713499069214
Epoch: 12, Steps: 154 | Train Loss: 0.834 Vali Loss: 1.807 Vali Acc: 0.530 Test Loss: 1.807 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9050854
	speed: 0.3297s/iter; left time: 4435.6673s
Epoch: 13 cost time: 9.29369068145752
Epoch: 13, Steps: 154 | Train Loss: 0.776 Vali Loss: 1.757 Vali Acc: 0.513 Test Loss: 1.757 Test Acc: 0.513
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.9651201
	speed: 0.3359s/iter; left time: 4466.7798s
Epoch: 14 cost time: 9.76561713218689
Epoch: 14, Steps: 154 | Train Loss: 0.743 Vali Loss: 1.786 Vali Acc: 0.547 Test Loss: 1.786 Test Acc: 0.547
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.9783769
	speed: 0.3478s/iter; left time: 4571.4545s
Epoch: 15 cost time: 8.87339973449707
Epoch: 15, Steps: 154 | Train Loss: 0.712 Vali Loss: 1.861 Vali Acc: 0.543 Test Loss: 1.861 Test Acc: 0.543
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.5518025
	speed: 0.3111s/iter; left time: 4041.7828s
Epoch: 16 cost time: 9.939548015594482
Epoch: 16, Steps: 154 | Train Loss: 0.703 Vali Loss: 1.889 Vali Acc: 0.534 Test Loss: 1.889 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.5633176
	speed: 0.3038s/iter; left time: 3899.3301s
Epoch: 17 cost time: 8.4435715675354
Epoch: 17, Steps: 154 | Train Loss: 0.666 Vali Loss: 1.800 Vali Acc: 0.505 Test Loss: 1.800 Test Acc: 0.505
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.3881854
	speed: 0.3014s/iter; left time: 3823.2278s
Epoch: 18 cost time: 8.85649824142456
Epoch: 18, Steps: 154 | Train Loss: 0.664 Vali Loss: 2.018 Vali Acc: 0.518 Test Loss: 2.018 Test Acc: 0.518
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.4657876
	speed: 0.2997s/iter; left time: 3754.4589s
Epoch: 19 cost time: 8.893213987350464
Epoch: 19, Steps: 154 | Train Loss: 0.635 Vali Loss: 1.934 Vali Acc: 0.541 Test Loss: 1.934 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.6794320
	speed: 0.2852s/iter; left time: 3528.9751s
Epoch: 20 cost time: 8.519521474838257
Epoch: 20, Steps: 154 | Train Loss: 0.612 Vali Loss: 1.959 Vali Acc: 0.518 Test Loss: 1.959 Test Acc: 0.518
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.5181314
	speed: 0.2881s/iter; left time: 3520.6795s
Epoch: 21 cost time: 8.130329847335815
Epoch: 21, Steps: 154 | Train Loss: 0.612 Vali Loss: 2.038 Vali Acc: 0.527 Test Loss: 2.038 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5490673154906731
model parameter : 33902
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7943722
	speed: 0.0955s/iter; left time: 1461.7304s
Epoch: 1 cost time: 13.124424934387207
Epoch: 1, Steps: 154 | Train Loss: 2.252 Vali Loss: 1.974 Vali Acc: 0.386 Test Loss: 1.974 Test Acc: 0.386
Validation loss decreased (inf --> -0.386436).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7426794
	speed: 0.2949s/iter; left time: 4466.9335s
Epoch: 2 cost time: 7.327932834625244
Epoch: 2, Steps: 154 | Train Loss: 1.744 Vali Loss: 1.801 Vali Acc: 0.409 Test Loss: 1.801 Test Acc: 0.409
Validation loss decreased (-0.386436 --> -0.408741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4302154
	speed: 0.2688s/iter; left time: 4030.3035s
Epoch: 3 cost time: 7.902355432510376
Epoch: 3, Steps: 154 | Train Loss: 1.384 Vali Loss: 1.829 Vali Acc: 0.455 Test Loss: 1.829 Test Acc: 0.455
Validation loss decreased (-0.408741 --> -0.454970).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3740182
	speed: 0.2828s/iter; left time: 4196.5103s
Epoch: 4 cost time: 7.332956075668335
Epoch: 4, Steps: 154 | Train Loss: 1.240 Vali Loss: 1.933 Vali Acc: 0.466 Test Loss: 1.933 Test Acc: 0.466
Validation loss decreased (-0.454970 --> -0.466323).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6566874
	speed: 0.2524s/iter; left time: 3706.2398s
Epoch: 5 cost time: 8.186821937561035
Epoch: 5, Steps: 154 | Train Loss: 1.142 Vali Loss: 1.918 Vali Acc: 0.483 Test Loss: 1.918 Test Acc: 0.483
Validation loss decreased (-0.466323 --> -0.483355).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0124613
	speed: 0.2818s/iter; left time: 4094.3622s
Epoch: 6 cost time: 6.256805181503296
Epoch: 6, Steps: 154 | Train Loss: 1.068 Vali Loss: 1.898 Vali Acc: 0.478 Test Loss: 1.898 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9941126
	speed: 0.2529s/iter; left time: 3635.9029s
Epoch: 7 cost time: 9.487366437911987
Epoch: 7, Steps: 154 | Train Loss: 1.024 Vali Loss: 1.969 Vali Acc: 0.460 Test Loss: 1.969 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6017994
	speed: 0.3205s/iter; left time: 4558.3662s
Epoch: 8 cost time: 9.363430261611938
Epoch: 8, Steps: 154 | Train Loss: 0.965 Vali Loss: 1.723 Vali Acc: 0.490 Test Loss: 1.723 Test Acc: 0.490
Validation loss decreased (-0.483355 --> -0.489845).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1769760
	speed: 0.3292s/iter; left time: 4631.2067s
Epoch: 9 cost time: 11.267621278762817
Epoch: 9, Steps: 154 | Train Loss: 0.931 Vali Loss: 1.825 Vali Acc: 0.521 Test Loss: 1.825 Test Acc: 0.521
Validation loss decreased (-0.489845 --> -0.521069).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5484079
	speed: 0.3495s/iter; left time: 4862.9904s
Epoch: 10 cost time: 9.127257823944092
Epoch: 10, Steps: 154 | Train Loss: 0.874 Vali Loss: 1.860 Vali Acc: 0.489 Test Loss: 1.860 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0994974
	speed: 0.3411s/iter; left time: 4694.4191s
Epoch: 11 cost time: 10.07918381690979
Epoch: 11, Steps: 154 | Train Loss: 0.855 Vali Loss: 1.831 Vali Acc: 0.511 Test Loss: 1.831 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7447965
	speed: 0.2935s/iter; left time: 3994.2940s
Epoch: 12 cost time: 8.312628507614136
Epoch: 12, Steps: 154 | Train Loss: 0.802 Vali Loss: 2.171 Vali Acc: 0.482 Test Loss: 2.171 Test Acc: 0.482
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.2459481
	speed: 0.3384s/iter; left time: 4552.8561s
Epoch: 13 cost time: 10.46309232711792
Epoch: 13, Steps: 154 | Train Loss: 0.778 Vali Loss: 1.960 Vali Acc: 0.498 Test Loss: 1.960 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.4015538
	speed: 0.3064s/iter; left time: 4074.7077s
Epoch: 14 cost time: 9.256686449050903
Epoch: 14, Steps: 154 | Train Loss: 0.753 Vali Loss: 1.991 Vali Acc: 0.490 Test Loss: 1.991 Test Acc: 0.490
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.6790267
	speed: 0.3077s/iter; left time: 4045.1275s
Epoch: 15 cost time: 9.436555624008179
Epoch: 15, Steps: 154 | Train Loss: 0.739 Vali Loss: 1.852 Vali Acc: 0.492 Test Loss: 1.852 Test Acc: 0.492
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.5193183
	speed: 0.3281s/iter; left time: 4262.1159s
Epoch: 16 cost time: 9.808775424957275
Epoch: 16, Steps: 154 | Train Loss: 0.722 Vali Loss: 1.922 Vali Acc: 0.545 Test Loss: 1.922 Test Acc: 0.545
Validation loss decreased (-0.521069 --> -0.544993).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.7083271
	speed: 0.3062s/iter; left time: 3931.1551s
Epoch: 17 cost time: 9.17238974571228
Epoch: 17, Steps: 154 | Train Loss: 0.691 Vali Loss: 2.013 Vali Acc: 0.506 Test Loss: 2.013 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.7335587
	speed: 0.3686s/iter; left time: 4674.4998s
Epoch: 18 cost time: 9.729554414749146
Epoch: 18, Steps: 154 | Train Loss: 0.675 Vali Loss: 2.101 Vali Acc: 0.502 Test Loss: 2.101 Test Acc: 0.502
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4241769
	speed: 0.3098s/iter; left time: 3882.0238s
Epoch: 19 cost time: 10.807326078414917
Epoch: 19, Steps: 154 | Train Loss: 0.643 Vali Loss: 2.092 Vali Acc: 0.518 Test Loss: 2.092 Test Acc: 0.518
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.4920945
	speed: 0.3271s/iter; left time: 4048.4073s
Epoch: 20 cost time: 9.019659996032715
Epoch: 20, Steps: 154 | Train Loss: 0.605 Vali Loss: 2.124 Vali Acc: 0.504 Test Loss: 2.124 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.7164319
	speed: 0.3074s/iter; left time: 3757.1313s
Epoch: 21 cost time: 8.970569372177124
Epoch: 21, Steps: 154 | Train Loss: 0.606 Vali Loss: 2.111 Vali Acc: 0.488 Test Loss: 2.111 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.4002331
	speed: 0.2711s/iter; left time: 3271.4537s
Epoch: 22 cost time: 8.403481721878052
Epoch: 22, Steps: 154 | Train Loss: 0.589 Vali Loss: 2.133 Vali Acc: 0.522 Test Loss: 2.133 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.7105216
	speed: 0.2917s/iter; left time: 3474.8949s
Epoch: 23 cost time: 7.3214030265808105
Epoch: 23, Steps: 154 | Train Loss: 0.578 Vali Loss: 2.216 Vali Acc: 0.507 Test Loss: 2.216 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.2555940
	speed: 0.2674s/iter; left time: 3144.6160s
Epoch: 24 cost time: 7.788603067398071
Epoch: 24, Steps: 154 | Train Loss: 0.563 Vali Loss: 2.333 Vali Acc: 0.486 Test Loss: 2.333 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.8378127
	speed: 0.2982s/iter; left time: 3460.9529s
Epoch: 25 cost time: 9.150057792663574
Epoch: 25, Steps: 154 | Train Loss: 0.539 Vali Loss: 2.552 Vali Acc: 0.478 Test Loss: 2.552 Test Acc: 0.478
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.5447214
	speed: 0.3341s/iter; left time: 3825.8799s
Epoch: 26 cost time: 10.898125648498535
Epoch: 26, Steps: 154 | Train Loss: 0.528 Vali Loss: 2.538 Vali Acc: 0.490 Test Loss: 2.538 Test Acc: 0.490
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5450121654501217
model parameter : 33918
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1467972
	speed: 0.0920s/iter; left time: 1407.7972s
Epoch: 1 cost time: 12.62027382850647
Epoch: 1, Steps: 154 | Train Loss: 2.299 Vali Loss: 2.067 Vali Acc: 0.334 Test Loss: 2.067 Test Acc: 0.334
Validation loss decreased (inf --> -0.334124).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5952787
	speed: 0.3089s/iter; left time: 4678.4107s
Epoch: 2 cost time: 8.439806461334229
Epoch: 2, Steps: 154 | Train Loss: 1.844 Vali Loss: 1.811 Vali Acc: 0.410 Test Loss: 1.811 Test Acc: 0.410
Validation loss decreased (-0.334124 --> -0.409958).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9123073
	speed: 0.2852s/iter; left time: 4275.4829s
Epoch: 3 cost time: 8.212191581726074
Epoch: 3, Steps: 154 | Train Loss: 1.453 Vali Loss: 1.844 Vali Acc: 0.432 Test Loss: 1.844 Test Acc: 0.432
Validation loss decreased (-0.409958 --> -0.432261).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9283984
	speed: 0.2820s/iter; left time: 4184.3819s
Epoch: 4 cost time: 8.123187780380249
Epoch: 4, Steps: 154 | Train Loss: 1.283 Vali Loss: 1.796 Vali Acc: 0.452 Test Loss: 1.796 Test Acc: 0.452
Validation loss decreased (-0.432261 --> -0.452131).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2092071
	speed: 0.2977s/iter; left time: 4372.4347s
Epoch: 5 cost time: 8.31522798538208
Epoch: 5, Steps: 154 | Train Loss: 1.201 Vali Loss: 1.781 Vali Acc: 0.477 Test Loss: 1.781 Test Acc: 0.477
Validation loss decreased (-0.452131 --> -0.477273).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8671824
	speed: 0.2936s/iter; left time: 4265.7811s
Epoch: 6 cost time: 8.454885959625244
Epoch: 6, Steps: 154 | Train Loss: 1.138 Vali Loss: 1.746 Vali Acc: 0.496 Test Loss: 1.746 Test Acc: 0.496
Validation loss decreased (-0.477273 --> -0.495522).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.7765368
	speed: 0.2929s/iter; left time: 4211.2031s
Epoch: 7 cost time: 8.667517900466919
Epoch: 7, Steps: 154 | Train Loss: 1.083 Vali Loss: 1.847 Vali Acc: 0.468 Test Loss: 1.847 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.0344309
	speed: 0.2482s/iter; left time: 3529.8379s
Epoch: 8 cost time: 6.3656980991363525
Epoch: 8, Steps: 154 | Train Loss: 1.038 Vali Loss: 1.869 Vali Acc: 0.492 Test Loss: 1.869 Test Acc: 0.492
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9850609
	speed: 0.2863s/iter; left time: 4028.3679s
Epoch: 9 cost time: 7.958694934844971
Epoch: 9, Steps: 154 | Train Loss: 1.005 Vali Loss: 1.779 Vali Acc: 0.497 Test Loss: 1.779 Test Acc: 0.497
Validation loss decreased (-0.495522 --> -0.497144).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9346045
	speed: 0.2539s/iter; left time: 3533.2065s
Epoch: 10 cost time: 8.265373229980469
Epoch: 10, Steps: 154 | Train Loss: 0.964 Vali Loss: 1.813 Vali Acc: 0.498 Test Loss: 1.813 Test Acc: 0.498
Validation loss decreased (-0.497144 --> -0.498360).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2274871
	speed: 0.2681s/iter; left time: 3689.9059s
Epoch: 11 cost time: 7.025586366653442
Epoch: 11, Steps: 154 | Train Loss: 0.968 Vali Loss: 1.957 Vali Acc: 0.486 Test Loss: 1.957 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8158349
	speed: 0.2409s/iter; left time: 3277.6042s
Epoch: 12 cost time: 7.2227678298950195
Epoch: 12, Steps: 154 | Train Loss: 0.908 Vali Loss: 1.918 Vali Acc: 0.492 Test Loss: 1.918 Test Acc: 0.492
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0835725
	speed: 0.2251s/iter; left time: 3028.8906s
Epoch: 13 cost time: 6.707312107086182
Epoch: 13, Steps: 154 | Train Loss: 0.879 Vali Loss: 1.928 Vali Acc: 0.492 Test Loss: 1.928 Test Acc: 0.492
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0880109
	speed: 0.2471s/iter; left time: 3285.7648s
Epoch: 14 cost time: 8.007782459259033
Epoch: 14, Steps: 154 | Train Loss: 0.855 Vali Loss: 1.956 Vali Acc: 0.481 Test Loss: 1.956 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.8601164
	speed: 0.2581s/iter; left time: 3393.2329s
Epoch: 15 cost time: 6.242612361907959
Epoch: 15, Steps: 154 | Train Loss: 0.836 Vali Loss: 1.985 Vali Acc: 0.504 Test Loss: 1.985 Test Acc: 0.504
Validation loss decreased (-0.498360 --> -0.504035).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1010400
	speed: 0.2538s/iter; left time: 3296.9961s
Epoch: 16 cost time: 7.911362886428833
Epoch: 16, Steps: 154 | Train Loss: 0.800 Vali Loss: 1.888 Vali Acc: 0.502 Test Loss: 1.888 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1854104
	speed: 0.2539s/iter; left time: 3259.4216s
Epoch: 17 cost time: 6.648057460784912
Epoch: 17, Steps: 154 | Train Loss: 0.787 Vali Loss: 1.854 Vali Acc: 0.514 Test Loss: 1.854 Test Acc: 0.514
Validation loss decreased (-0.504035 --> -0.514174).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.3694431
	speed: 0.2867s/iter; left time: 3636.1448s
Epoch: 18 cost time: 8.389476537704468
Epoch: 18, Steps: 154 | Train Loss: 0.769 Vali Loss: 2.043 Vali Acc: 0.504 Test Loss: 2.043 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.5343299
	speed: 0.2828s/iter; left time: 3542.8284s
Epoch: 19 cost time: 8.515113592147827
Epoch: 19, Steps: 154 | Train Loss: 0.754 Vali Loss: 2.311 Vali Acc: 0.477 Test Loss: 2.311 Test Acc: 0.477
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.9557125
	speed: 0.2928s/iter; left time: 3623.6861s
Epoch: 20 cost time: 8.33716630935669
Epoch: 20, Steps: 154 | Train Loss: 0.725 Vali Loss: 2.159 Vali Acc: 0.469 Test Loss: 2.159 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.5747717
	speed: 0.2935s/iter; left time: 3586.3565s
Epoch: 21 cost time: 8.167878150939941
Epoch: 21, Steps: 154 | Train Loss: 0.706 Vali Loss: 2.082 Vali Acc: 0.511 Test Loss: 2.082 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.7687138
	speed: 0.2589s/iter; left time: 3124.2463s
Epoch: 22 cost time: 6.869435548782349
Epoch: 22, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.060 Vali Acc: 0.509 Test Loss: 2.060 Test Acc: 0.509
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.9855538
	speed: 0.2468s/iter; left time: 2940.5584s
Epoch: 23 cost time: 7.145522117614746
Epoch: 23, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.100 Vali Acc: 0.521 Test Loss: 2.100 Test Acc: 0.521
Validation loss decreased (-0.514174 --> -0.521066).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.3266063
	speed: 0.2674s/iter; left time: 3144.7625s
Epoch: 24 cost time: 8.76265025138855
Epoch: 24, Steps: 154 | Train Loss: 0.648 Vali Loss: 2.073 Vali Acc: 0.538 Test Loss: 2.073 Test Acc: 0.538
Validation loss decreased (-0.521066 --> -0.538098).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.5535896
	speed: 0.2705s/iter; left time: 3138.7132s
Epoch: 25 cost time: 7.8384387493133545
Epoch: 25, Steps: 154 | Train Loss: 0.641 Vali Loss: 2.176 Vali Acc: 0.499 Test Loss: 2.176 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.7574415
	speed: 0.2778s/iter; left time: 3180.8234s
Epoch: 26 cost time: 6.791383504867554
Epoch: 26, Steps: 154 | Train Loss: 0.615 Vali Loss: 2.252 Vali Acc: 0.470 Test Loss: 2.252 Test Acc: 0.470
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.7493154
	speed: 0.2437s/iter; left time: 2752.5453s
Epoch: 27 cost time: 7.838743448257446
Epoch: 27, Steps: 154 | Train Loss: 0.595 Vali Loss: 2.267 Vali Acc: 0.496 Test Loss: 2.267 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 1.0673136
	speed: 0.2469s/iter; left time: 2750.7688s
Epoch: 28 cost time: 6.727077484130859
Epoch: 28, Steps: 154 | Train Loss: 0.588 Vali Loss: 2.286 Vali Acc: 0.506 Test Loss: 2.286 Test Acc: 0.506
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.9230275
	speed: 0.2467s/iter; left time: 2710.5259s
Epoch: 29 cost time: 7.883368015289307
Epoch: 29, Steps: 154 | Train Loss: 0.576 Vali Loss: 2.304 Vali Acc: 0.504 Test Loss: 2.304 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.5825698
	speed: 0.2700s/iter; left time: 2925.9029s
Epoch: 30 cost time: 7.547890663146973
Epoch: 30, Steps: 154 | Train Loss: 0.581 Vali Loss: 2.270 Vali Acc: 0.500 Test Loss: 2.270 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.8684204
	speed: 0.2646s/iter; left time: 2826.5711s
Epoch: 31 cost time: 7.640185117721558
Epoch: 31, Steps: 154 | Train Loss: 0.559 Vali Loss: 2.330 Vali Acc: 0.502 Test Loss: 2.330 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.4197156
	speed: 0.2710s/iter; left time: 2852.2970s
Epoch: 32 cost time: 7.374729633331299
Epoch: 32, Steps: 154 | Train Loss: 0.554 Vali Loss: 2.397 Vali Acc: 0.509 Test Loss: 2.397 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.7448809
	speed: 0.2523s/iter; left time: 2617.6216s
Epoch: 33 cost time: 6.529801368713379
Epoch: 33, Steps: 154 | Train Loss: 0.552 Vali Loss: 2.256 Vali Acc: 0.514 Test Loss: 2.256 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.3168604
	speed: 0.2369s/iter; left time: 2420.9048s
Epoch: 34 cost time: 6.714568138122559
Epoch: 34, Steps: 154 | Train Loss: 0.551 Vali Loss: 2.468 Vali Acc: 0.474 Test Loss: 2.468 Test Acc: 0.474
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5381184103811841
model parameter : 25886
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7414923
	speed: 0.0992s/iter; left time: 1517.8000s
Epoch: 1 cost time: 12.822234392166138
Epoch: 1, Steps: 154 | Train Loss: 2.338 Vali Loss: 2.105 Vali Acc: 0.324 Test Loss: 2.105 Test Acc: 0.324
Validation loss decreased (inf --> -0.323985).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8571719
	speed: 0.3234s/iter; left time: 4898.3569s
Epoch: 2 cost time: 9.079632997512817
Epoch: 2, Steps: 154 | Train Loss: 1.945 Vali Loss: 1.858 Vali Acc: 0.413 Test Loss: 1.858 Test Acc: 0.413
Validation loss decreased (-0.323985 --> -0.413201).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5678065
	speed: 0.3451s/iter; left time: 5173.3994s
Epoch: 3 cost time: 9.373995304107666
Epoch: 3, Steps: 154 | Train Loss: 1.614 Vali Loss: 1.944 Vali Acc: 0.403 Test Loss: 1.944 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6182711
	speed: 0.3346s/iter; left time: 4965.0252s
Epoch: 4 cost time: 10.007037878036499
Epoch: 4, Steps: 154 | Train Loss: 1.387 Vali Loss: 1.862 Vali Acc: 0.449 Test Loss: 1.862 Test Acc: 0.449
Validation loss decreased (-0.413201 --> -0.449292).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5913279
	speed: 0.3119s/iter; left time: 4580.0808s
Epoch: 5 cost time: 7.778077125549316
Epoch: 5, Steps: 154 | Train Loss: 1.256 Vali Loss: 1.910 Vali Acc: 0.460 Test Loss: 1.910 Test Acc: 0.460
Validation loss decreased (-0.449292 --> -0.459835).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6261446
	speed: 0.3185s/iter; left time: 4627.9489s
Epoch: 6 cost time: 8.697029113769531
Epoch: 6, Steps: 154 | Train Loss: 1.194 Vali Loss: 1.900 Vali Acc: 0.473 Test Loss: 1.900 Test Acc: 0.473
Validation loss decreased (-0.459835 --> -0.472811).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3961632
	speed: 0.3117s/iter; left time: 4481.7973s
Epoch: 7 cost time: 8.981934785842896
Epoch: 7, Steps: 154 | Train Loss: 1.137 Vali Loss: 1.714 Vali Acc: 0.487 Test Loss: 1.714 Test Acc: 0.487
Validation loss decreased (-0.472811 --> -0.487412).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8054391
	speed: 0.3084s/iter; left time: 4385.9098s
Epoch: 8 cost time: 9.66878604888916
Epoch: 8, Steps: 154 | Train Loss: 1.077 Vali Loss: 1.908 Vali Acc: 0.490 Test Loss: 1.908 Test Acc: 0.490
Validation loss decreased (-0.487412 --> -0.490249).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3227872
	speed: 0.2885s/iter; left time: 4058.3703s
Epoch: 9 cost time: 8.461458683013916
Epoch: 9, Steps: 154 | Train Loss: 1.058 Vali Loss: 1.817 Vali Acc: 0.501 Test Loss: 1.817 Test Acc: 0.501
Validation loss decreased (-0.490249 --> -0.501198).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3242229
	speed: 0.2733s/iter; left time: 3802.7478s
Epoch: 10 cost time: 8.104403257369995
Epoch: 10, Steps: 154 | Train Loss: 1.007 Vali Loss: 2.097 Vali Acc: 0.483 Test Loss: 2.097 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0478275
	speed: 0.3076s/iter; left time: 4232.7378s
Epoch: 11 cost time: 8.725215435028076
Epoch: 11, Steps: 154 | Train Loss: 1.010 Vali Loss: 1.957 Vali Acc: 0.486 Test Loss: 1.957 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9546397
	speed: 0.2958s/iter; left time: 4025.4814s
Epoch: 12 cost time: 8.764435052871704
Epoch: 12, Steps: 154 | Train Loss: 0.948 Vali Loss: 2.116 Vali Acc: 0.483 Test Loss: 2.116 Test Acc: 0.483
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.2198285
	speed: 0.2643s/iter; left time: 3555.3284s
Epoch: 13 cost time: 8.075764179229736
Epoch: 13, Steps: 154 | Train Loss: 0.913 Vali Loss: 1.874 Vali Acc: 0.500 Test Loss: 1.874 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3439913
	speed: 0.2706s/iter; left time: 3598.2222s
Epoch: 14 cost time: 8.262961864471436
Epoch: 14, Steps: 154 | Train Loss: 0.906 Vali Loss: 1.838 Vali Acc: 0.491 Test Loss: 1.838 Test Acc: 0.491
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8997509
	speed: 0.2888s/iter; left time: 3795.8650s
Epoch: 15 cost time: 9.274336814880371
Epoch: 15, Steps: 154 | Train Loss: 0.878 Vali Loss: 1.892 Vali Acc: 0.503 Test Loss: 1.892 Test Acc: 0.503
Validation loss decreased (-0.501198 --> -0.502820).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.2078311
	speed: 0.2757s/iter; left time: 3581.6438s
Epoch: 16 cost time: 7.285965204238892
Epoch: 16, Steps: 154 | Train Loss: 0.855 Vali Loss: 1.931 Vali Acc: 0.505 Test Loss: 1.931 Test Acc: 0.505
Validation loss decreased (-0.502820 --> -0.505252).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.8400254
	speed: 0.2505s/iter; left time: 3215.4810s
Epoch: 17 cost time: 7.945659399032593
Epoch: 17, Steps: 154 | Train Loss: 0.834 Vali Loss: 1.953 Vali Acc: 0.487 Test Loss: 1.953 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.8911406
	speed: 0.2886s/iter; left time: 3660.1991s
Epoch: 18 cost time: 8.001746892929077
Epoch: 18, Steps: 154 | Train Loss: 0.814 Vali Loss: 1.978 Vali Acc: 0.488 Test Loss: 1.978 Test Acc: 0.488
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.0882049
	speed: 0.2835s/iter; left time: 3552.3028s
Epoch: 19 cost time: 10.079393148422241
Epoch: 19, Steps: 154 | Train Loss: 0.791 Vali Loss: 1.934 Vali Acc: 0.491 Test Loss: 1.934 Test Acc: 0.491
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.9177444
	speed: 0.3111s/iter; left time: 3849.7326s
Epoch: 20 cost time: 8.336269855499268
Epoch: 20, Steps: 154 | Train Loss: 0.804 Vali Loss: 2.296 Vali Acc: 0.486 Test Loss: 2.296 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.9378517
	speed: 0.3376s/iter; left time: 4125.2954s
Epoch: 21 cost time: 10.518266439437866
Epoch: 21, Steps: 154 | Train Loss: 0.765 Vali Loss: 1.957 Vali Acc: 0.512 Test Loss: 1.957 Test Acc: 0.512
Validation loss decreased (-0.505252 --> -0.511740).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.5539500
	speed: 0.3034s/iter; left time: 3661.0461s
Epoch: 22 cost time: 7.657817363739014
Epoch: 22, Steps: 154 | Train Loss: 0.734 Vali Loss: 2.091 Vali Acc: 0.501 Test Loss: 2.091 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.3657452
	speed: 0.3241s/iter; left time: 3860.4784s
Epoch: 23 cost time: 9.113251209259033
Epoch: 23, Steps: 154 | Train Loss: 0.720 Vali Loss: 2.104 Vali Acc: 0.500 Test Loss: 2.104 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.6990109
	speed: 0.3176s/iter; left time: 3734.7736s
Epoch: 24 cost time: 9.761932611465454
Epoch: 24, Steps: 154 | Train Loss: 0.710 Vali Loss: 2.175 Vali Acc: 0.489 Test Loss: 2.175 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.7923213
	speed: 0.3382s/iter; left time: 3924.3869s
Epoch: 25 cost time: 8.399431228637695
Epoch: 25, Steps: 154 | Train Loss: 0.725 Vali Loss: 2.043 Vali Acc: 0.507 Test Loss: 2.043 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.8667176
	speed: 0.2862s/iter; left time: 3277.4404s
Epoch: 26 cost time: 7.785723686218262
Epoch: 26, Steps: 154 | Train Loss: 0.716 Vali Loss: 2.078 Vali Acc: 0.475 Test Loss: 2.078 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.6448386
	speed: 0.2786s/iter; left time: 3147.0703s
Epoch: 27 cost time: 8.761375665664673
Epoch: 27, Steps: 154 | Train Loss: 0.674 Vali Loss: 2.225 Vali Acc: 0.468 Test Loss: 2.225 Test Acc: 0.468
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.9536769
	speed: 0.2728s/iter; left time: 3039.8213s
Epoch: 28 cost time: 6.892777681350708
Epoch: 28, Steps: 154 | Train Loss: 0.656 Vali Loss: 2.120 Vali Acc: 0.504 Test Loss: 2.120 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.3948970
	speed: 0.2650s/iter; left time: 2912.4201s
Epoch: 29 cost time: 7.896109580993652
Epoch: 29, Steps: 154 | Train Loss: 0.663 Vali Loss: 2.244 Vali Acc: 0.495 Test Loss: 2.244 Test Acc: 0.495
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 1.1147370
	speed: 0.2579s/iter; left time: 2794.4647s
Epoch: 30 cost time: 6.710371732711792
Epoch: 30, Steps: 154 | Train Loss: 0.652 Vali Loss: 2.328 Vali Acc: 0.498 Test Loss: 2.328 Test Acc: 0.498
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.6698076
	speed: 0.2546s/iter; left time: 2719.1060s
Epoch: 31 cost time: 7.175925970077515
Epoch: 31, Steps: 154 | Train Loss: 0.632 Vali Loss: 2.267 Vali Acc: 0.463 Test Loss: 2.267 Test Acc: 0.463
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5117599351175993
model parameter : 21886
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1283293
	speed: 0.0766s/iter; left time: 1171.6011s
Epoch: 1 cost time: 9.548982858657837
Epoch: 1, Steps: 154 | Train Loss: 2.363 Vali Loss: 2.145 Vali Acc: 0.320 Test Loss: 2.145 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1074033
	speed: 0.2464s/iter; left time: 3732.3090s
Epoch: 2 cost time: 7.347287178039551
Epoch: 2, Steps: 154 | Train Loss: 2.018 Vali Loss: 1.927 Vali Acc: 0.378 Test Loss: 1.927 Test Acc: 0.378
Validation loss decreased (-0.319524 --> -0.378326).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6800975
	speed: 0.2715s/iter; left time: 4070.4965s
Epoch: 3 cost time: 7.6700544357299805
Epoch: 3, Steps: 154 | Train Loss: 1.686 Vali Loss: 1.850 Vali Acc: 0.401 Test Loss: 1.850 Test Acc: 0.401
Validation loss decreased (-0.378326 --> -0.400630).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6982141
	speed: 0.2807s/iter; left time: 4164.6116s
Epoch: 4 cost time: 8.793392419815063
Epoch: 4, Steps: 154 | Train Loss: 1.473 Vali Loss: 1.761 Vali Acc: 0.436 Test Loss: 1.761 Test Acc: 0.436
Validation loss decreased (-0.400630 --> -0.436317).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3292136
	speed: 0.2968s/iter; left time: 4358.6883s
Epoch: 5 cost time: 8.743987560272217
Epoch: 5, Steps: 154 | Train Loss: 1.340 Vali Loss: 1.785 Vali Acc: 0.459 Test Loss: 1.785 Test Acc: 0.459
Validation loss decreased (-0.436317 --> -0.458620).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3770339
	speed: 0.3005s/iter; left time: 4366.4444s
Epoch: 6 cost time: 7.727708578109741
Epoch: 6, Steps: 154 | Train Loss: 1.267 Vali Loss: 1.875 Vali Acc: 0.465 Test Loss: 1.875 Test Acc: 0.465
Validation loss decreased (-0.458620 --> -0.465107).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9885132
	speed: 0.2799s/iter; left time: 4023.7461s
Epoch: 7 cost time: 9.356479406356812
Epoch: 7, Steps: 154 | Train Loss: 1.209 Vali Loss: 1.685 Vali Acc: 0.490 Test Loss: 1.685 Test Acc: 0.490
Validation loss decreased (-0.465107 --> -0.489845).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0537659
	speed: 0.2932s/iter; left time: 4170.5562s
Epoch: 8 cost time: 7.485424995422363
Epoch: 8, Steps: 154 | Train Loss: 1.151 Vali Loss: 1.667 Vali Acc: 0.494 Test Loss: 1.667 Test Acc: 0.494
Validation loss decreased (-0.489845 --> -0.494306).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9312838
	speed: 0.2786s/iter; left time: 3919.0777s
Epoch: 9 cost time: 8.636935710906982
Epoch: 9, Steps: 154 | Train Loss: 1.117 Vali Loss: 1.740 Vali Acc: 0.493 Test Loss: 1.740 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2246072
	speed: 0.2798s/iter; left time: 3892.9045s
Epoch: 10 cost time: 7.04186487197876
Epoch: 10, Steps: 154 | Train Loss: 1.096 Vali Loss: 1.877 Vali Acc: 0.489 Test Loss: 1.877 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1848224
	speed: 0.2688s/iter; left time: 3698.7310s
Epoch: 11 cost time: 8.727131128311157
Epoch: 11, Steps: 154 | Train Loss: 1.048 Vali Loss: 1.829 Vali Acc: 0.493 Test Loss: 1.829 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.9658583
	speed: 0.2748s/iter; left time: 3739.1602s
Epoch: 12 cost time: 7.13326358795166
Epoch: 12, Steps: 154 | Train Loss: 1.021 Vali Loss: 1.695 Vali Acc: 0.496 Test Loss: 1.695 Test Acc: 0.496
Validation loss decreased (-0.494306 --> -0.496333).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.1193731
	speed: 0.2694s/iter; left time: 3624.2523s
Epoch: 13 cost time: 8.304035902023315
Epoch: 13, Steps: 154 | Train Loss: 0.994 Vali Loss: 2.032 Vali Acc: 0.461 Test Loss: 2.032 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1521953
	speed: 0.2612s/iter; left time: 3473.2703s
Epoch: 14 cost time: 7.103511571884155
Epoch: 14, Steps: 154 | Train Loss: 0.981 Vali Loss: 1.784 Vali Acc: 0.495 Test Loss: 1.784 Test Acc: 0.495
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.6486714
	speed: 0.2610s/iter; left time: 3430.2552s
Epoch: 15 cost time: 8.347149133682251
Epoch: 15, Steps: 154 | Train Loss: 0.955 Vali Loss: 1.861 Vali Acc: 0.504 Test Loss: 1.861 Test Acc: 0.504
Validation loss decreased (-0.496333 --> -0.504442).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.8066768
	speed: 0.2669s/iter; left time: 3467.3542s
Epoch: 16 cost time: 6.367750406265259
Epoch: 16, Steps: 154 | Train Loss: 0.933 Vali Loss: 1.750 Vali Acc: 0.509 Test Loss: 1.750 Test Acc: 0.509
Validation loss decreased (-0.504442 --> -0.508498).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1778275
	speed: 0.2491s/iter; left time: 3197.1977s
Epoch: 17 cost time: 8.133148670196533
Epoch: 17, Steps: 154 | Train Loss: 0.912 Vali Loss: 1.795 Vali Acc: 0.507 Test Loss: 1.795 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.0249844
	speed: 0.2635s/iter; left time: 3342.1157s
Epoch: 18 cost time: 7.699190855026245
Epoch: 18, Steps: 154 | Train Loss: 0.899 Vali Loss: 1.751 Vali Acc: 0.524 Test Loss: 1.751 Test Acc: 0.524
Validation loss decreased (-0.508498 --> -0.524313).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.4389368
	speed: 0.2568s/iter; left time: 3217.1305s
Epoch: 19 cost time: 6.3326334953308105
Epoch: 19, Steps: 154 | Train Loss: 0.871 Vali Loss: 1.787 Vali Acc: 0.501 Test Loss: 1.787 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8246233
	speed: 0.2527s/iter; left time: 3127.5638s
Epoch: 20 cost time: 7.8367578983306885
Epoch: 20, Steps: 154 | Train Loss: 0.865 Vali Loss: 1.728 Vali Acc: 0.521 Test Loss: 1.728 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.4038033
	speed: 0.2969s/iter; left time: 3628.8802s
Epoch: 21 cost time: 8.47585415840149
Epoch: 21, Steps: 154 | Train Loss: 0.831 Vali Loss: 1.959 Vali Acc: 0.492 Test Loss: 1.959 Test Acc: 0.492
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.4819801
	speed: 0.3220s/iter; left time: 3885.2684s
Epoch: 22 cost time: 9.711141586303711
Epoch: 22, Steps: 154 | Train Loss: 0.834 Vali Loss: 1.897 Vali Acc: 0.479 Test Loss: 1.897 Test Acc: 0.479
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.6493135
	speed: 0.3137s/iter; left time: 3736.7788s
Epoch: 23 cost time: 8.530289888381958
Epoch: 23, Steps: 154 | Train Loss: 0.819 Vali Loss: 1.826 Vali Acc: 0.501 Test Loss: 1.826 Test Acc: 0.501
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.1256419
	speed: 0.3043s/iter; left time: 3578.3096s
Epoch: 24 cost time: 9.57020354270935
Epoch: 24, Steps: 154 | Train Loss: 0.810 Vali Loss: 1.816 Vali Acc: 0.518 Test Loss: 1.816 Test Acc: 0.518
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.7991632
	speed: 0.3176s/iter; left time: 3685.6299s
Epoch: 25 cost time: 8.490606784820557
Epoch: 25, Steps: 154 | Train Loss: 0.769 Vali Loss: 1.922 Vali Acc: 0.490 Test Loss: 1.922 Test Acc: 0.490
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.8727966
	speed: 0.3322s/iter; left time: 3804.2521s
Epoch: 26 cost time: 9.320936679840088
Epoch: 26, Steps: 154 | Train Loss: 0.746 Vali Loss: 1.959 Vali Acc: 0.499 Test Loss: 1.959 Test Acc: 0.499
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.9718356
	speed: 0.3301s/iter; left time: 3728.7880s
Epoch: 27 cost time: 9.790857076644897
Epoch: 27, Steps: 154 | Train Loss: 0.744 Vali Loss: 1.925 Vali Acc: 0.491 Test Loss: 1.925 Test Acc: 0.491
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.7376272
	speed: 0.2785s/iter; left time: 3103.8684s
Epoch: 28 cost time: 8.479825496673584
Epoch: 28, Steps: 154 | Train Loss: 0.718 Vali Loss: 1.930 Vali Acc: 0.498 Test Loss: 1.930 Test Acc: 0.498
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df256_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.524330900243309
model parameter : 19214
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8494376
	speed: 0.0813s/iter; left time: 1243.5475s
Epoch: 1 cost time: 10.457209587097168
Epoch: 1, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.052 Vali Acc: 0.251 Test Loss: 2.052 Test Acc: 0.251
Validation loss decreased (inf --> -0.250588).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2712169
	speed: 0.2387s/iter; left time: 3615.4836s
Epoch: 2 cost time: 6.546616315841675
Epoch: 2, Steps: 154 | Train Loss: 1.724 Vali Loss: 1.830 Vali Acc: 0.416 Test Loss: 1.830 Test Acc: 0.416
Validation loss decreased (-0.250588 --> -0.416040).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7865720
	speed: 0.2657s/iter; left time: 3983.3461s
Epoch: 3 cost time: 8.294838905334473
Epoch: 3, Steps: 154 | Train Loss: 1.353 Vali Loss: 1.909 Vali Acc: 0.432 Test Loss: 1.909 Test Acc: 0.432
Validation loss decreased (-0.416040 --> -0.431854).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4834892
	speed: 0.2380s/iter; left time: 3531.8725s
Epoch: 4 cost time: 8.370202779769897
Epoch: 4, Steps: 154 | Train Loss: 1.169 Vali Loss: 1.696 Vali Acc: 0.438 Test Loss: 1.696 Test Acc: 0.438
Validation loss decreased (-0.431854 --> -0.438345).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9971328
	speed: 0.2907s/iter; left time: 4269.3524s
Epoch: 5 cost time: 7.2730138301849365
Epoch: 5, Steps: 154 | Train Loss: 1.095 Vali Loss: 1.794 Vali Acc: 0.505 Test Loss: 1.794 Test Acc: 0.505
Validation loss decreased (-0.438345 --> -0.504848).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8250623
	speed: 0.2453s/iter; left time: 3564.7082s
Epoch: 6 cost time: 7.41506290435791
Epoch: 6, Steps: 154 | Train Loss: 0.984 Vali Loss: 1.783 Vali Acc: 0.519 Test Loss: 1.783 Test Acc: 0.519
Validation loss decreased (-0.504848 --> -0.519041).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0060227
	speed: 0.2535s/iter; left time: 3644.0524s
Epoch: 7 cost time: 7.441843271255493
Epoch: 7, Steps: 154 | Train Loss: 0.923 Vali Loss: 1.796 Vali Acc: 0.499 Test Loss: 1.796 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4825924
	speed: 0.2337s/iter; left time: 3324.1107s
Epoch: 8 cost time: 6.139358043670654
Epoch: 8, Steps: 154 | Train Loss: 0.879 Vali Loss: 1.925 Vali Acc: 0.512 Test Loss: 1.925 Test Acc: 0.512
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6885322
	speed: 0.2355s/iter; left time: 3313.0899s
Epoch: 9 cost time: 8.334013223648071
Epoch: 9, Steps: 154 | Train Loss: 0.803 Vali Loss: 1.996 Vali Acc: 0.493 Test Loss: 1.996 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0576442
	speed: 0.2851s/iter; left time: 3967.2741s
Epoch: 10 cost time: 8.385543823242188
Epoch: 10, Steps: 154 | Train Loss: 0.768 Vali Loss: 2.016 Vali Acc: 0.510 Test Loss: 2.016 Test Acc: 0.510
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.2729702
	speed: 0.2675s/iter; left time: 3681.3106s
Epoch: 11 cost time: 7.825254917144775
Epoch: 11, Steps: 154 | Train Loss: 0.718 Vali Loss: 2.224 Vali Acc: 0.453 Test Loss: 2.224 Test Acc: 0.453
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.3728851
	speed: 0.2593s/iter; left time: 3528.5967s
Epoch: 12 cost time: 7.02941107749939
Epoch: 12, Steps: 154 | Train Loss: 0.695 Vali Loss: 2.299 Vali Acc: 0.451 Test Loss: 2.299 Test Acc: 0.451
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6023195
	speed: 0.2211s/iter; left time: 2974.6984s
Epoch: 13 cost time: 6.009055852890015
Epoch: 13, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.192 Vali Acc: 0.457 Test Loss: 2.192 Test Acc: 0.457
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.5928880
	speed: 0.2068s/iter; left time: 2749.9243s
Epoch: 14 cost time: 6.2489013671875
Epoch: 14, Steps: 154 | Train Loss: 0.620 Vali Loss: 2.285 Vali Acc: 0.438 Test Loss: 2.285 Test Acc: 0.438
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1111287
	speed: 0.2187s/iter; left time: 2874.4977s
Epoch: 15 cost time: 7.133432388305664
Epoch: 15, Steps: 154 | Train Loss: 0.607 Vali Loss: 2.222 Vali Acc: 0.490 Test Loss: 2.222 Test Acc: 0.490
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.5195438
	speed: 0.2335s/iter; left time: 3033.0425s
Epoch: 16 cost time: 6.298548460006714
Epoch: 16, Steps: 154 | Train Loss: 0.585 Vali Loss: 2.463 Vali Acc: 0.468 Test Loss: 2.463 Test Acc: 0.468
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.519059205190592
model parameter : 53854
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9285461
	speed: 0.0813s/iter; left time: 1243.8981s
Epoch: 1 cost time: 10.69219708442688
Epoch: 1, Steps: 154 | Train Loss: 2.214 Vali Loss: 1.929 Vali Acc: 0.382 Test Loss: 1.929 Test Acc: 0.382
Validation loss decreased (inf --> -0.381570).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0746994
	speed: 0.3021s/iter; left time: 4575.5179s
Epoch: 2 cost time: 8.860345840454102
Epoch: 2, Steps: 154 | Train Loss: 1.727 Vali Loss: 1.738 Vali Acc: 0.435 Test Loss: 1.738 Test Acc: 0.435
Validation loss decreased (-0.381570 --> -0.435100).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2764161
	speed: 0.3040s/iter; left time: 4557.8783s
Epoch: 3 cost time: 7.8129448890686035
Epoch: 3, Steps: 154 | Train Loss: 1.387 Vali Loss: 1.690 Vali Acc: 0.474 Test Loss: 1.690 Test Acc: 0.474
Validation loss decreased (-0.435100 --> -0.474030).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2113476
	speed: 0.2760s/iter; left time: 4095.2185s
Epoch: 4 cost time: 8.680448770523071
Epoch: 4, Steps: 154 | Train Loss: 1.225 Vali Loss: 1.731 Vali Acc: 0.486 Test Loss: 1.731 Test Acc: 0.486
Validation loss decreased (-0.474030 --> -0.486195).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4697518
	speed: 0.2829s/iter; left time: 4153.9234s
Epoch: 5 cost time: 8.012685060501099
Epoch: 5, Steps: 154 | Train Loss: 1.134 Vali Loss: 1.825 Vali Acc: 0.457 Test Loss: 1.825 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0595753
	speed: 0.2688s/iter; left time: 3906.0818s
Epoch: 6 cost time: 7.36328387260437
Epoch: 6, Steps: 154 | Train Loss: 1.049 Vali Loss: 1.957 Vali Acc: 0.457 Test Loss: 1.957 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2373649
	speed: 0.2505s/iter; left time: 3601.3580s
Epoch: 7 cost time: 7.094163656234741
Epoch: 7, Steps: 154 | Train Loss: 1.018 Vali Loss: 1.863 Vali Acc: 0.501 Test Loss: 1.863 Test Acc: 0.501
Validation loss decreased (-0.486195 --> -0.501198).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3446114
	speed: 0.2614s/iter; left time: 3718.0522s
Epoch: 8 cost time: 7.0646772384643555
Epoch: 8, Steps: 154 | Train Loss: 0.959 Vali Loss: 1.748 Vali Acc: 0.521 Test Loss: 1.748 Test Acc: 0.521
Validation loss decreased (-0.501198 --> -0.520664).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9704973
	speed: 0.2477s/iter; left time: 3485.0667s
Epoch: 9 cost time: 8.160701990127563
Epoch: 9, Steps: 154 | Train Loss: 0.927 Vali Loss: 1.818 Vali Acc: 0.536 Test Loss: 1.818 Test Acc: 0.536
Validation loss decreased (-0.520664 --> -0.535667).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8960351
	speed: 0.2777s/iter; left time: 3864.2203s
Epoch: 10 cost time: 7.470621347427368
Epoch: 10, Steps: 154 | Train Loss: 0.895 Vali Loss: 1.746 Vali Acc: 0.509 Test Loss: 1.746 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.0280499
	speed: 0.2771s/iter; left time: 3812.8326s
Epoch: 11 cost time: 8.410033226013184
Epoch: 11, Steps: 154 | Train Loss: 0.887 Vali Loss: 1.809 Vali Acc: 0.509 Test Loss: 1.809 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7313213
	speed: 0.2587s/iter; left time: 3519.7095s
Epoch: 12 cost time: 7.847150802612305
Epoch: 12, Steps: 154 | Train Loss: 0.823 Vali Loss: 2.010 Vali Acc: 0.472 Test Loss: 2.010 Test Acc: 0.472
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.7797054
	speed: 0.2687s/iter; left time: 3614.8681s
Epoch: 13 cost time: 8.168301582336426
Epoch: 13, Steps: 154 | Train Loss: 0.796 Vali Loss: 1.800 Vali Acc: 0.504 Test Loss: 1.800 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.9326991
	speed: 0.2868s/iter; left time: 3814.3044s
Epoch: 14 cost time: 8.016175031661987
Epoch: 14, Steps: 154 | Train Loss: 0.781 Vali Loss: 1.874 Vali Acc: 0.513 Test Loss: 1.874 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.6218687
	speed: 0.2701s/iter; left time: 3550.1291s
Epoch: 15 cost time: 8.165060043334961
Epoch: 15, Steps: 154 | Train Loss: 0.768 Vali Loss: 2.013 Vali Acc: 0.493 Test Loss: 2.013 Test Acc: 0.493
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.6609332
	speed: 0.2903s/iter; left time: 3771.0634s
Epoch: 16 cost time: 7.857639789581299
Epoch: 16, Steps: 154 | Train Loss: 0.746 Vali Loss: 1.916 Vali Acc: 0.526 Test Loss: 1.916 Test Acc: 0.526
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.7915564
	speed: 0.3206s/iter; left time: 4115.1572s
Epoch: 17 cost time: 8.745698690414429
Epoch: 17, Steps: 154 | Train Loss: 0.697 Vali Loss: 1.855 Vali Acc: 0.531 Test Loss: 1.855 Test Acc: 0.531
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.7174517
	speed: 0.2981s/iter; left time: 3780.5037s
Epoch: 18 cost time: 7.878326654434204
Epoch: 18, Steps: 154 | Train Loss: 0.685 Vali Loss: 1.952 Vali Acc: 0.529 Test Loss: 1.952 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.6526954
	speed: 0.3032s/iter; left time: 3798.4424s
Epoch: 19 cost time: 7.958874464035034
Epoch: 19, Steps: 154 | Train Loss: 0.641 Vali Loss: 1.842 Vali Acc: 0.540 Test Loss: 1.842 Test Acc: 0.540
Validation loss decreased (-0.535667 --> -0.540128).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6208161
	speed: 0.2682s/iter; left time: 3318.3924s
Epoch: 20 cost time: 8.497455835342407
Epoch: 20, Steps: 154 | Train Loss: 0.636 Vali Loss: 1.903 Vali Acc: 0.532 Test Loss: 1.903 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3454598
	speed: 0.3119s/iter; left time: 3811.9050s
Epoch: 21 cost time: 8.63380765914917
Epoch: 21, Steps: 154 | Train Loss: 0.606 Vali Loss: 1.955 Vali Acc: 0.549 Test Loss: 1.955 Test Acc: 0.549
Validation loss decreased (-0.540128 --> -0.549048).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.3583252
	speed: 0.3018s/iter; left time: 3642.3504s
Epoch: 22 cost time: 9.092521905899048
Epoch: 22, Steps: 154 | Train Loss: 0.602 Vali Loss: 2.092 Vali Acc: 0.496 Test Loss: 2.092 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.5777742
	speed: 0.3140s/iter; left time: 3740.3798s
Epoch: 23 cost time: 8.790462493896484
Epoch: 23, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.014 Vali Acc: 0.515 Test Loss: 2.014 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2086452
	speed: 0.2827s/iter; left time: 3323.7416s
Epoch: 24 cost time: 8.45451307296753
Epoch: 24, Steps: 154 | Train Loss: 0.550 Vali Loss: 2.072 Vali Acc: 0.499 Test Loss: 2.072 Test Acc: 0.499
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.5973332
	speed: 0.2927s/iter; left time: 3397.2878s
Epoch: 25 cost time: 9.178768157958984
Epoch: 25, Steps: 154 | Train Loss: 0.543 Vali Loss: 2.143 Vali Acc: 0.517 Test Loss: 2.143 Test Acc: 0.517
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.5562062
	speed: 0.2902s/iter; left time: 3323.2311s
Epoch: 26 cost time: 8.77603793144226
Epoch: 26, Steps: 154 | Train Loss: 0.519 Vali Loss: 2.200 Vali Acc: 0.534 Test Loss: 2.200 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.2605379
	speed: 0.2772s/iter; left time: 3131.9036s
Epoch: 27 cost time: 8.007447004318237
Epoch: 27, Steps: 154 | Train Loss: 0.500 Vali Loss: 2.223 Vali Acc: 0.509 Test Loss: 2.223 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.2229660
	speed: 0.2670s/iter; left time: 2975.2851s
Epoch: 28 cost time: 7.900096654891968
Epoch: 28, Steps: 154 | Train Loss: 0.499 Vali Loss: 2.324 Vali Acc: 0.495 Test Loss: 2.324 Test Acc: 0.495
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.8020079
	speed: 0.2433s/iter; left time: 2673.9965s
Epoch: 29 cost time: 6.735411643981934
Epoch: 29, Steps: 154 | Train Loss: 0.487 Vali Loss: 2.383 Vali Acc: 0.508 Test Loss: 2.383 Test Acc: 0.508
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.5793483
	speed: 0.2731s/iter; left time: 2959.3530s
Epoch: 30 cost time: 7.957390785217285
Epoch: 30, Steps: 154 | Train Loss: 0.465 Vali Loss: 2.394 Vali Acc: 0.496 Test Loss: 2.394 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.4070154
	speed: 0.2500s/iter; left time: 2670.5955s
Epoch: 31 cost time: 7.900419473648071
Epoch: 31, Steps: 154 | Train Loss: 0.444 Vali Loss: 2.188 Vali Acc: 0.524 Test Loss: 2.188 Test Acc: 0.524
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5490673154906731
model parameter : 29678
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8745853
	speed: 0.0952s/iter; left time: 1456.2526s
Epoch: 1 cost time: 12.569713830947876
Epoch: 1, Steps: 154 | Train Loss: 2.239 Vali Loss: 2.055 Vali Acc: 0.362 Test Loss: 2.055 Test Acc: 0.362
Validation loss decreased (inf --> -0.362104).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7178469
	speed: 0.2850s/iter; left time: 4317.0516s
Epoch: 2 cost time: 7.575228214263916
Epoch: 2, Steps: 154 | Train Loss: 1.836 Vali Loss: 1.744 Vali Acc: 0.422 Test Loss: 1.744 Test Acc: 0.422
Validation loss decreased (-0.362104 --> -0.421718).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6219243
	speed: 0.2910s/iter; left time: 4363.6976s
Epoch: 3 cost time: 8.620145797729492
Epoch: 3, Steps: 154 | Train Loss: 1.462 Vali Loss: 1.933 Vali Acc: 0.418 Test Loss: 1.933 Test Acc: 0.418
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3102579
	speed: 0.2920s/iter; left time: 4333.0017s
Epoch: 4 cost time: 9.609856843948364
Epoch: 4, Steps: 154 | Train Loss: 1.259 Vali Loss: 2.031 Vali Acc: 0.446 Test Loss: 2.031 Test Acc: 0.446
Validation loss decreased (-0.421718 --> -0.446046).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3469522
	speed: 0.2958s/iter; left time: 4344.1009s
Epoch: 5 cost time: 8.252961158752441
Epoch: 5, Steps: 154 | Train Loss: 1.168 Vali Loss: 1.797 Vali Acc: 0.489 Test Loss: 1.797 Test Acc: 0.489
Validation loss decreased (-0.446046 --> -0.489439).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3706408
	speed: 0.3052s/iter; left time: 4434.3345s
Epoch: 6 cost time: 9.514864444732666
Epoch: 6, Steps: 154 | Train Loss: 1.100 Vali Loss: 1.735 Vali Acc: 0.497 Test Loss: 1.735 Test Acc: 0.497
Validation loss decreased (-0.489439 --> -0.496739).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2533278
	speed: 0.2828s/iter; left time: 4065.6813s
Epoch: 7 cost time: 7.5633697509765625
Epoch: 7, Steps: 154 | Train Loss: 1.063 Vali Loss: 1.711 Vali Acc: 0.505 Test Loss: 1.711 Test Acc: 0.505
Validation loss decreased (-0.496739 --> -0.504849).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9017859
	speed: 0.2913s/iter; left time: 4142.7917s
Epoch: 8 cost time: 8.537752866744995
Epoch: 8, Steps: 154 | Train Loss: 1.003 Vali Loss: 1.788 Vali Acc: 0.481 Test Loss: 1.788 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.8994995
	speed: 0.2720s/iter; left time: 3827.0153s
Epoch: 9 cost time: 8.07535982131958
Epoch: 9, Steps: 154 | Train Loss: 0.967 Vali Loss: 1.656 Vali Acc: 0.535 Test Loss: 1.656 Test Acc: 0.535
Validation loss decreased (-0.504849 --> -0.535263).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8302832
	speed: 0.2664s/iter; left time: 3706.5367s
Epoch: 10 cost time: 7.076688289642334
Epoch: 10, Steps: 154 | Train Loss: 0.907 Vali Loss: 1.918 Vali Acc: 0.475 Test Loss: 1.918 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9960386
	speed: 0.2791s/iter; left time: 3840.6346s
Epoch: 11 cost time: 7.42862606048584
Epoch: 11, Steps: 154 | Train Loss: 0.875 Vali Loss: 1.696 Vali Acc: 0.522 Test Loss: 1.696 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.7318547
	speed: 0.2694s/iter; left time: 3665.8625s
Epoch: 12 cost time: 8.524919271469116
Epoch: 12, Steps: 154 | Train Loss: 0.844 Vali Loss: 1.813 Vali Acc: 0.498 Test Loss: 1.813 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.6777132
	speed: 0.2790s/iter; left time: 3753.8654s
Epoch: 13 cost time: 7.785796642303467
Epoch: 13, Steps: 154 | Train Loss: 0.813 Vali Loss: 2.163 Vali Acc: 0.478 Test Loss: 2.163 Test Acc: 0.478
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.6180992
	speed: 0.2479s/iter; left time: 3296.7433s
Epoch: 14 cost time: 6.861262559890747
Epoch: 14, Steps: 154 | Train Loss: 0.781 Vali Loss: 1.876 Vali Acc: 0.513 Test Loss: 1.876 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8643144
	speed: 0.2668s/iter; left time: 3506.6657s
Epoch: 15 cost time: 8.9370756149292
Epoch: 15, Steps: 154 | Train Loss: 0.752 Vali Loss: 1.885 Vali Acc: 0.519 Test Loss: 1.885 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.4783778
	speed: 0.3115s/iter; left time: 4046.4523s
Epoch: 16 cost time: 8.37140154838562
Epoch: 16, Steps: 154 | Train Loss: 0.706 Vali Loss: 1.923 Vali Acc: 0.539 Test Loss: 1.923 Test Acc: 0.539
Validation loss decreased (-0.535263 --> -0.539316).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.1411523
	speed: 0.3196s/iter; left time: 4102.3199s
Epoch: 17 cost time: 7.82093620300293
Epoch: 17, Steps: 154 | Train Loss: 0.705 Vali Loss: 1.849 Vali Acc: 0.526 Test Loss: 1.849 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6095416
	speed: 0.2679s/iter; left time: 3397.5557s
Epoch: 18 cost time: 8.065945625305176
Epoch: 18, Steps: 154 | Train Loss: 0.692 Vali Loss: 2.070 Vali Acc: 0.510 Test Loss: 2.070 Test Acc: 0.510
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.4080003
	speed: 0.2844s/iter; left time: 3563.7753s
Epoch: 19 cost time: 7.789233684539795
Epoch: 19, Steps: 154 | Train Loss: 0.666 Vali Loss: 2.117 Vali Acc: 0.505 Test Loss: 2.117 Test Acc: 0.505
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.4743800
	speed: 0.2704s/iter; left time: 3346.0214s
Epoch: 20 cost time: 9.122688293457031
Epoch: 20, Steps: 154 | Train Loss: 0.660 Vali Loss: 2.057 Vali Acc: 0.498 Test Loss: 2.057 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.4536245
	speed: 0.2860s/iter; left time: 3495.7167s
Epoch: 21 cost time: 7.879702091217041
Epoch: 21, Steps: 154 | Train Loss: 0.615 Vali Loss: 1.951 Vali Acc: 0.530 Test Loss: 1.951 Test Acc: 0.530
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.5116156
	speed: 0.2720s/iter; left time: 3282.7110s
Epoch: 22 cost time: 6.252202987670898
Epoch: 22, Steps: 154 | Train Loss: 0.596 Vali Loss: 2.084 Vali Acc: 0.547 Test Loss: 2.084 Test Acc: 0.547
Validation loss decreased (-0.539316 --> -0.547019).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.6389402
	speed: 0.2507s/iter; left time: 2986.9645s
Epoch: 23 cost time: 7.192721605300903
Epoch: 23, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.240 Vali Acc: 0.518 Test Loss: 2.240 Test Acc: 0.518
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.8449839
	speed: 0.2626s/iter; left time: 3087.5923s
Epoch: 24 cost time: 7.703598260879517
Epoch: 24, Steps: 154 | Train Loss: 0.590 Vali Loss: 2.156 Vali Acc: 0.542 Test Loss: 2.156 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.4590427
	speed: 0.2773s/iter; left time: 3218.5495s
Epoch: 25 cost time: 8.17402696609497
Epoch: 25, Steps: 154 | Train Loss: 0.571 Vali Loss: 2.148 Vali Acc: 0.502 Test Loss: 2.148 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.2306528
	speed: 0.2812s/iter; left time: 3220.5403s
Epoch: 26 cost time: 8.814375877380371
Epoch: 26, Steps: 154 | Train Loss: 0.553 Vali Loss: 2.287 Vali Acc: 0.474 Test Loss: 2.287 Test Acc: 0.474
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.1171875
	speed: 0.2723s/iter; left time: 3076.3593s
Epoch: 27 cost time: 7.542971134185791
Epoch: 27, Steps: 154 | Train Loss: 0.531 Vali Loss: 2.178 Vali Acc: 0.535 Test Loss: 2.178 Test Acc: 0.535
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.5138664
	speed: 0.2358s/iter; left time: 2627.1969s
Epoch: 28 cost time: 7.15471887588501
Epoch: 28, Steps: 154 | Train Loss: 0.516 Vali Loss: 2.273 Vali Acc: 0.526 Test Loss: 2.273 Test Acc: 0.526
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.5773284
	speed: 0.2717s/iter; left time: 2985.9381s
Epoch: 29 cost time: 8.10560131072998
Epoch: 29, Steps: 154 | Train Loss: 0.506 Vali Loss: 2.294 Vali Acc: 0.521 Test Loss: 2.294 Test Acc: 0.521
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.5809833
	speed: 0.2784s/iter; left time: 3016.9242s
Epoch: 30 cost time: 7.414409637451172
Epoch: 30, Steps: 154 | Train Loss: 0.478 Vali Loss: 2.365 Vali Acc: 0.516 Test Loss: 2.365 Test Acc: 0.516
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.5416012
	speed: 0.2754s/iter; left time: 2941.7580s
Epoch: 31 cost time: 8.513911485671997
Epoch: 31, Steps: 154 | Train Loss: 0.488 Vali Loss: 2.385 Vali Acc: 0.484 Test Loss: 2.385 Test Acc: 0.484
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.4634445
	speed: 0.3115s/iter; left time: 3279.6236s
Epoch: 32 cost time: 9.269018173217773
Epoch: 32, Steps: 154 | Train Loss: 0.480 Vali Loss: 2.342 Vali Acc: 0.495 Test Loss: 2.342 Test Acc: 0.495
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5470397404703974
model parameter : 29694
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0934131
	speed: 0.0792s/iter; left time: 1212.5826s
Epoch: 1 cost time: 10.413980960845947
Epoch: 1, Steps: 154 | Train Loss: 2.283 Vali Loss: 2.063 Vali Acc: 0.330 Test Loss: 2.063 Test Acc: 0.330
Validation loss decreased (inf --> -0.330474).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7437712
	speed: 0.2834s/iter; left time: 4293.0361s
Epoch: 2 cost time: 8.038806915283203
Epoch: 2, Steps: 154 | Train Loss: 1.878 Vali Loss: 1.860 Vali Acc: 0.384 Test Loss: 1.860 Test Acc: 0.384
Validation loss decreased (-0.330474 --> -0.384410).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2235378
	speed: 0.2763s/iter; left time: 4142.8610s
Epoch: 3 cost time: 8.28960633277893
Epoch: 3, Steps: 154 | Train Loss: 1.478 Vali Loss: 1.825 Vali Acc: 0.427 Test Loss: 1.825 Test Acc: 0.427
Validation loss decreased (-0.384410 --> -0.426584).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8798152
	speed: 0.2757s/iter; left time: 4091.7896s
Epoch: 4 cost time: 7.356694221496582
Epoch: 4, Steps: 154 | Train Loss: 1.310 Vali Loss: 1.766 Vali Acc: 0.450 Test Loss: 1.766 Test Acc: 0.450
Validation loss decreased (-0.426584 --> -0.449698).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1204984
	speed: 0.2580s/iter; left time: 3788.7470s
Epoch: 5 cost time: 7.231574535369873
Epoch: 5, Steps: 154 | Train Loss: 1.216 Vali Loss: 1.884 Vali Acc: 0.461 Test Loss: 1.884 Test Acc: 0.461
Validation loss decreased (-0.449698 --> -0.461457).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0035295
	speed: 0.2541s/iter; left time: 3692.5009s
Epoch: 6 cost time: 8.125684022903442
Epoch: 6, Steps: 154 | Train Loss: 1.153 Vali Loss: 1.939 Vali Acc: 0.470 Test Loss: 1.939 Test Acc: 0.470
Validation loss decreased (-0.461457 --> -0.470378).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3519584
	speed: 0.2508s/iter; left time: 3605.8951s
Epoch: 7 cost time: 6.934163570404053
Epoch: 7, Steps: 154 | Train Loss: 1.093 Vali Loss: 1.856 Vali Acc: 0.470 Test Loss: 1.856 Test Acc: 0.470
Validation loss decreased (-0.470378 --> -0.470379).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3809950
	speed: 0.2527s/iter; left time: 3594.4085s
Epoch: 8 cost time: 9.014178037643433
Epoch: 8, Steps: 154 | Train Loss: 1.057 Vali Loss: 2.144 Vali Acc: 0.461 Test Loss: 2.144 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2380700
	speed: 0.2721s/iter; left time: 3828.5424s
Epoch: 9 cost time: 6.970350503921509
Epoch: 9, Steps: 154 | Train Loss: 1.010 Vali Loss: 1.949 Vali Acc: 0.451 Test Loss: 1.949 Test Acc: 0.451
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6172043
	speed: 0.2707s/iter; left time: 3767.1262s
Epoch: 10 cost time: 8.73147988319397
Epoch: 10, Steps: 154 | Train Loss: 0.989 Vali Loss: 2.076 Vali Acc: 0.469 Test Loss: 2.076 Test Acc: 0.469
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0005751
	speed: 0.2497s/iter; left time: 3436.0897s
Epoch: 11 cost time: 6.05116081237793
Epoch: 11, Steps: 154 | Train Loss: 0.918 Vali Loss: 1.938 Vali Acc: 0.488 Test Loss: 1.938 Test Acc: 0.488
Validation loss decreased (-0.470379 --> -0.487815).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8393950
	speed: 0.2458s/iter; left time: 3344.3035s
Epoch: 12 cost time: 7.898821592330933
Epoch: 12, Steps: 154 | Train Loss: 0.923 Vali Loss: 1.945 Vali Acc: 0.470 Test Loss: 1.945 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2877598
	speed: 0.2538s/iter; left time: 3414.1050s
Epoch: 13 cost time: 7.2473649978637695
Epoch: 13, Steps: 154 | Train Loss: 0.901 Vali Loss: 1.941 Vali Acc: 0.492 Test Loss: 1.941 Test Acc: 0.492
Validation loss decreased (-0.487815 --> -0.491870).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4960583
	speed: 0.2826s/iter; left time: 3758.1787s
Epoch: 14 cost time: 7.687114000320435
Epoch: 14, Steps: 154 | Train Loss: 0.868 Vali Loss: 1.967 Vali Acc: 0.490 Test Loss: 1.967 Test Acc: 0.490
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7465506
	speed: 0.2618s/iter; left time: 3441.9514s
Epoch: 15 cost time: 7.23906135559082
Epoch: 15, Steps: 154 | Train Loss: 0.845 Vali Loss: 2.030 Vali Acc: 0.499 Test Loss: 2.030 Test Acc: 0.499
Validation loss decreased (-0.491870 --> -0.498763).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4177992
	speed: 0.2754s/iter; left time: 3578.1476s
Epoch: 16 cost time: 7.233628511428833
Epoch: 16, Steps: 154 | Train Loss: 0.828 Vali Loss: 2.035 Vali Acc: 0.508 Test Loss: 2.035 Test Acc: 0.508
Validation loss decreased (-0.498763 --> -0.508090).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.9936770
	speed: 0.2751s/iter; left time: 3531.0285s
Epoch: 17 cost time: 8.195605278015137
Epoch: 17, Steps: 154 | Train Loss: 0.800 Vali Loss: 2.021 Vali Acc: 0.498 Test Loss: 2.021 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.5279389
	speed: 0.3033s/iter; left time: 3846.8010s
Epoch: 18 cost time: 8.648345947265625
Epoch: 18, Steps: 154 | Train Loss: 0.767 Vali Loss: 2.174 Vali Acc: 0.474 Test Loss: 2.174 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.8545271
	speed: 0.2616s/iter; left time: 3278.0832s
Epoch: 19 cost time: 7.592451810836792
Epoch: 19, Steps: 154 | Train Loss: 0.762 Vali Loss: 2.061 Vali Acc: 0.510 Test Loss: 2.061 Test Acc: 0.510
Validation loss decreased (-0.508090 --> -0.510117).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.0397156
	speed: 0.2911s/iter; left time: 3602.9283s
Epoch: 20 cost time: 8.560199499130249
Epoch: 20, Steps: 154 | Train Loss: 0.741 Vali Loss: 2.021 Vali Acc: 0.517 Test Loss: 2.021 Test Acc: 0.517
Validation loss decreased (-0.510117 --> -0.517011).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.5859333
	speed: 0.2628s/iter; left time: 3211.2519s
Epoch: 21 cost time: 6.400420427322388
Epoch: 21, Steps: 154 | Train Loss: 0.712 Vali Loss: 2.202 Vali Acc: 0.500 Test Loss: 2.202 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.4460252
	speed: 0.2311s/iter; left time: 2788.1527s
Epoch: 22 cost time: 6.173585414886475
Epoch: 22, Steps: 154 | Train Loss: 0.728 Vali Loss: 2.105 Vali Acc: 0.516 Test Loss: 2.105 Test Acc: 0.516
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5932617
	speed: 0.2164s/iter; left time: 2577.9391s
Epoch: 23 cost time: 5.614469289779663
Epoch: 23, Steps: 154 | Train Loss: 0.708 Vali Loss: 2.146 Vali Acc: 0.519 Test Loss: 2.146 Test Acc: 0.519
Validation loss decreased (-0.517011 --> -0.519443).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.6093515
	speed: 0.1939s/iter; left time: 2280.0216s
Epoch: 24 cost time: 5.880947589874268
Epoch: 24, Steps: 154 | Train Loss: 0.678 Vali Loss: 2.269 Vali Acc: 0.502 Test Loss: 2.269 Test Acc: 0.502
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.4191581
	speed: 0.2226s/iter; left time: 2582.9968s
Epoch: 25 cost time: 6.6645119190216064
Epoch: 25, Steps: 154 | Train Loss: 0.662 Vali Loss: 2.436 Vali Acc: 0.482 Test Loss: 2.436 Test Acc: 0.482
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.5685641
	speed: 0.2075s/iter; left time: 2375.8012s
Epoch: 26 cost time: 5.930476188659668
Epoch: 26, Steps: 154 | Train Loss: 0.680 Vali Loss: 2.311 Vali Acc: 0.487 Test Loss: 2.311 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.6434252
	speed: 0.2386s/iter; left time: 2695.3652s
Epoch: 27 cost time: 7.815317153930664
Epoch: 27, Steps: 154 | Train Loss: 0.642 Vali Loss: 2.335 Vali Acc: 0.491 Test Loss: 2.335 Test Acc: 0.491
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.5028055
	speed: 0.2611s/iter; left time: 2909.5745s
Epoch: 28 cost time: 7.342628002166748
Epoch: 28, Steps: 154 | Train Loss: 0.640 Vali Loss: 2.376 Vali Acc: 0.488 Test Loss: 2.376 Test Acc: 0.488
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.5505522
	speed: 0.2734s/iter; left time: 3004.5264s
Epoch: 29 cost time: 7.998246431350708
Epoch: 29, Steps: 154 | Train Loss: 0.611 Vali Loss: 2.408 Vali Acc: 0.503 Test Loss: 2.408 Test Acc: 0.503
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.7576944
	speed: 0.2508s/iter; left time: 2717.7131s
Epoch: 30 cost time: 6.8002769947052
Epoch: 30, Steps: 154 | Train Loss: 0.628 Vali Loss: 2.238 Vali Acc: 0.500 Test Loss: 2.238 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 1.3466004
	speed: 0.2403s/iter; left time: 2566.1156s
Epoch: 31 cost time: 8.089616775512695
Epoch: 31, Steps: 154 | Train Loss: 0.598 Vali Loss: 2.316 Vali Acc: 0.507 Test Loss: 2.316 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.8237158
	speed: 0.2647s/iter; left time: 2786.6907s
Epoch: 32 cost time: 7.4959681034088135
Epoch: 32, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.396 Vali Acc: 0.489 Test Loss: 2.396 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.2836827
	speed: 0.2830s/iter; left time: 2935.3663s
Epoch: 33 cost time: 7.648043155670166
Epoch: 33, Steps: 154 | Train Loss: 0.587 Vali Loss: 2.436 Vali Acc: 0.482 Test Loss: 2.436 Test Acc: 0.482
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5194647201946472
model parameter : 21662
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3623662
	speed: 0.1041s/iter; left time: 1592.2408s
Epoch: 1 cost time: 13.556644678115845
Epoch: 1, Steps: 154 | Train Loss: 2.422 Vali Loss: 2.096 Vali Acc: 0.317 Test Loss: 2.096 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1526482
	speed: 0.3149s/iter; left time: 4770.0381s
Epoch: 2 cost time: 9.489010095596313
Epoch: 2, Steps: 154 | Train Loss: 1.976 Vali Loss: 1.879 Vali Acc: 0.380 Test Loss: 1.879 Test Acc: 0.380
Validation loss decreased (-0.316686 --> -0.379949).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6168313
	speed: 0.3041s/iter; left time: 4559.3820s
Epoch: 3 cost time: 8.371722936630249
Epoch: 3, Steps: 154 | Train Loss: 1.635 Vali Loss: 1.799 Vali Acc: 0.406 Test Loss: 1.799 Test Acc: 0.406
Validation loss decreased (-0.379949 --> -0.405903).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2539198
	speed: 0.3037s/iter; left time: 4506.8052s
Epoch: 4 cost time: 9.386356115341187
Epoch: 4, Steps: 154 | Train Loss: 1.399 Vali Loss: 1.827 Vali Acc: 0.446 Test Loss: 1.827 Test Acc: 0.446
Validation loss decreased (-0.405903 --> -0.445643).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2460819
	speed: 0.2566s/iter; left time: 3768.4262s
Epoch: 5 cost time: 6.668498754501343
Epoch: 5, Steps: 154 | Train Loss: 1.263 Vali Loss: 1.814 Vali Acc: 0.465 Test Loss: 1.814 Test Acc: 0.465
Validation loss decreased (-0.445643 --> -0.465108).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.8471931
	speed: 0.2763s/iter; left time: 4014.7099s
Epoch: 6 cost time: 7.924592018127441
Epoch: 6, Steps: 154 | Train Loss: 1.191 Vali Loss: 1.797 Vali Acc: 0.468 Test Loss: 1.797 Test Acc: 0.468
Validation loss decreased (-0.465108 --> -0.467946).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3855928
	speed: 0.2701s/iter; left time: 3882.8529s
Epoch: 7 cost time: 7.251405477523804
Epoch: 7, Steps: 154 | Train Loss: 1.133 Vali Loss: 1.782 Vali Acc: 0.487 Test Loss: 1.782 Test Acc: 0.487
Validation loss decreased (-0.467946 --> -0.487411).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7728500
	speed: 0.2603s/iter; left time: 3701.9284s
Epoch: 8 cost time: 7.940332651138306
Epoch: 8, Steps: 154 | Train Loss: 1.100 Vali Loss: 1.747 Vali Acc: 0.494 Test Loss: 1.747 Test Acc: 0.494
Validation loss decreased (-0.487411 --> -0.493494).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1213317
	speed: 0.2587s/iter; left time: 3639.5468s
Epoch: 9 cost time: 7.985882997512817
Epoch: 9, Steps: 154 | Train Loss: 1.050 Vali Loss: 1.922 Vali Acc: 0.473 Test Loss: 1.922 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.9007987
	speed: 0.2653s/iter; left time: 3692.3167s
Epoch: 10 cost time: 8.440038919448853
Epoch: 10, Steps: 154 | Train Loss: 1.000 Vali Loss: 1.916 Vali Acc: 0.504 Test Loss: 1.916 Test Acc: 0.504
Validation loss decreased (-0.493494 --> -0.503630).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8732407
	speed: 0.2968s/iter; left time: 4084.2995s
Epoch: 11 cost time: 8.281306982040405
Epoch: 11, Steps: 154 | Train Loss: 0.979 Vali Loss: 1.840 Vali Acc: 0.517 Test Loss: 1.840 Test Acc: 0.517
Validation loss decreased (-0.503630 --> -0.517013).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.5810274
	speed: 0.2803s/iter; left time: 3814.3039s
Epoch: 12 cost time: 7.7963337898254395
Epoch: 12, Steps: 154 | Train Loss: 0.969 Vali Loss: 1.833 Vali Acc: 0.501 Test Loss: 1.833 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.6000059
	speed: 0.3018s/iter; left time: 4060.6226s
Epoch: 13 cost time: 8.350656270980835
Epoch: 13, Steps: 154 | Train Loss: 0.927 Vali Loss: 1.780 Vali Acc: 0.518 Test Loss: 1.780 Test Acc: 0.518
Validation loss decreased (-0.517013 --> -0.517825).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7674522
	speed: 0.3160s/iter; left time: 4202.6922s
Epoch: 14 cost time: 10.607080459594727
Epoch: 14, Steps: 154 | Train Loss: 0.898 Vali Loss: 1.867 Vali Acc: 0.510 Test Loss: 1.867 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7772407
	speed: 0.2851s/iter; left time: 3747.4144s
Epoch: 15 cost time: 8.279374122619629
Epoch: 15, Steps: 154 | Train Loss: 0.880 Vali Loss: 1.932 Vali Acc: 0.500 Test Loss: 1.932 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.6167344
	speed: 0.3168s/iter; left time: 4115.5171s
Epoch: 16 cost time: 8.538611650466919
Epoch: 16, Steps: 154 | Train Loss: 0.866 Vali Loss: 1.841 Vali Acc: 0.513 Test Loss: 1.841 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.5499880
	speed: 0.2765s/iter; left time: 3549.8423s
Epoch: 17 cost time: 8.311853170394897
Epoch: 17, Steps: 154 | Train Loss: 0.848 Vali Loss: 1.994 Vali Acc: 0.497 Test Loss: 1.994 Test Acc: 0.497
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.9541351
	speed: 0.3082s/iter; left time: 3908.6727s
Epoch: 18 cost time: 8.514116048812866
Epoch: 18, Steps: 154 | Train Loss: 0.814 Vali Loss: 1.983 Vali Acc: 0.501 Test Loss: 1.983 Test Acc: 0.501
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.4071532
	speed: 0.2937s/iter; left time: 3680.1688s
Epoch: 19 cost time: 9.300075054168701
Epoch: 19, Steps: 154 | Train Loss: 0.804 Vali Loss: 1.959 Vali Acc: 0.508 Test Loss: 1.959 Test Acc: 0.508
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8244029
	speed: 0.2828s/iter; left time: 3499.5425s
Epoch: 20 cost time: 7.9722740650177
Epoch: 20, Steps: 154 | Train Loss: 0.771 Vali Loss: 1.924 Vali Acc: 0.511 Test Loss: 1.924 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.5679379
	speed: 0.2744s/iter; left time: 3353.3793s
Epoch: 21 cost time: 8.01946759223938
Epoch: 21, Steps: 154 | Train Loss: 0.764 Vali Loss: 1.904 Vali Acc: 0.515 Test Loss: 1.904 Test Acc: 0.515
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.0922050
	speed: 0.2517s/iter; left time: 3037.2226s
Epoch: 22 cost time: 6.840489387512207
Epoch: 22, Steps: 154 | Train Loss: 0.738 Vali Loss: 1.998 Vali Acc: 0.515 Test Loss: 1.998 Test Acc: 0.515
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4779702
	speed: 0.2742s/iter; left time: 3266.6988s
Epoch: 23 cost time: 7.948346138000488
Epoch: 23, Steps: 154 | Train Loss: 0.735 Vali Loss: 2.122 Vali Acc: 0.513 Test Loss: 2.122 Test Acc: 0.513
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5178426601784266
model parameter : 17662
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3735006
	speed: 0.0806s/iter; left time: 1232.9107s
Epoch: 1 cost time: 9.763641834259033
Epoch: 1, Steps: 154 | Train Loss: 2.352 Vali Loss: 2.140 Vali Acc: 0.311 Test Loss: 2.140 Test Acc: 0.311
Validation loss decreased (inf --> -0.311414).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4983954
	speed: 0.2462s/iter; left time: 3729.8935s
Epoch: 2 cost time: 7.666537284851074
Epoch: 2, Steps: 154 | Train Loss: 2.065 Vali Loss: 1.965 Vali Acc: 0.372 Test Loss: 1.965 Test Acc: 0.372
Validation loss decreased (-0.311414 --> -0.372243).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9588727
	speed: 0.2963s/iter; left time: 4441.9229s
Epoch: 3 cost time: 8.251326560974121
Epoch: 3, Steps: 154 | Train Loss: 1.746 Vali Loss: 1.932 Vali Acc: 0.388 Test Loss: 1.932 Test Acc: 0.388
Validation loss decreased (-0.372243 --> -0.388464).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9946876
	speed: 0.2690s/iter; left time: 3992.0364s
Epoch: 4 cost time: 7.6682586669921875
Epoch: 4, Steps: 154 | Train Loss: 1.487 Vali Loss: 1.879 Vali Acc: 0.420 Test Loss: 1.879 Test Acc: 0.420
Validation loss decreased (-0.388464 --> -0.420095).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7202200
	speed: 0.2847s/iter; left time: 4180.3931s
Epoch: 5 cost time: 8.200807332992554
Epoch: 5, Steps: 154 | Train Loss: 1.361 Vali Loss: 1.924 Vali Acc: 0.442 Test Loss: 1.924 Test Acc: 0.442
Validation loss decreased (-0.420095 --> -0.441992).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3894684
	speed: 0.2739s/iter; left time: 3979.6303s
Epoch: 6 cost time: 7.6106321811676025
Epoch: 6, Steps: 154 | Train Loss: 1.266 Vali Loss: 1.933 Vali Acc: 0.476 Test Loss: 1.933 Test Acc: 0.476
Validation loss decreased (-0.441992 --> -0.476055).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2264320
	speed: 0.2683s/iter; left time: 3857.5226s
Epoch: 7 cost time: 7.679885149002075
Epoch: 7, Steps: 154 | Train Loss: 1.197 Vali Loss: 1.825 Vali Acc: 0.479 Test Loss: 1.825 Test Acc: 0.479
Validation loss decreased (-0.476055 --> -0.478895).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1240373
	speed: 0.2924s/iter; left time: 4159.1119s
Epoch: 8 cost time: 8.162791967391968
Epoch: 8, Steps: 154 | Train Loss: 1.147 Vali Loss: 1.914 Vali Acc: 0.464 Test Loss: 1.914 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2760980
	speed: 0.2762s/iter; left time: 3886.2889s
Epoch: 9 cost time: 8.048687219619751
Epoch: 9, Steps: 154 | Train Loss: 1.125 Vali Loss: 1.886 Vali Acc: 0.486 Test Loss: 1.886 Test Acc: 0.486
Validation loss decreased (-0.478895 --> -0.485788).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2292299
	speed: 0.2936s/iter; left time: 4084.9531s
Epoch: 10 cost time: 8.817909479141235
Epoch: 10, Steps: 154 | Train Loss: 1.069 Vali Loss: 1.824 Vali Acc: 0.491 Test Loss: 1.824 Test Acc: 0.491
Validation loss decreased (-0.485788 --> -0.490655).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6720716
	speed: 0.2754s/iter; left time: 3789.3198s
Epoch: 11 cost time: 8.648905277252197
Epoch: 11, Steps: 154 | Train Loss: 1.040 Vali Loss: 1.938 Vali Acc: 0.496 Test Loss: 1.938 Test Acc: 0.496
Validation loss decreased (-0.490655 --> -0.495925).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8543748
	speed: 0.2813s/iter; left time: 3827.2020s
Epoch: 12 cost time: 8.108632564544678
Epoch: 12, Steps: 154 | Train Loss: 1.017 Vali Loss: 1.832 Vali Acc: 0.486 Test Loss: 1.832 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.3565346
	speed: 0.2644s/iter; left time: 3557.0454s
Epoch: 13 cost time: 6.799077033996582
Epoch: 13, Steps: 154 | Train Loss: 0.989 Vali Loss: 1.947 Vali Acc: 0.493 Test Loss: 1.947 Test Acc: 0.493
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0957330
	speed: 0.2467s/iter; left time: 3280.8103s
Epoch: 14 cost time: 7.759909152984619
Epoch: 14, Steps: 154 | Train Loss: 0.966 Vali Loss: 1.953 Vali Acc: 0.486 Test Loss: 1.953 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.3387225
	speed: 0.2693s/iter; left time: 3539.3193s
Epoch: 15 cost time: 8.014384746551514
Epoch: 15, Steps: 154 | Train Loss: 0.927 Vali Loss: 2.010 Vali Acc: 0.479 Test Loss: 2.010 Test Acc: 0.479
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3906109
	speed: 0.2706s/iter; left time: 3514.9228s
Epoch: 16 cost time: 7.330045223236084
Epoch: 16, Steps: 154 | Train Loss: 0.906 Vali Loss: 1.990 Vali Acc: 0.502 Test Loss: 1.990 Test Acc: 0.502
Validation loss decreased (-0.495925 --> -0.502008).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5692499
	speed: 0.2422s/iter; left time: 3109.6222s
Epoch: 17 cost time: 7.013780355453491
Epoch: 17, Steps: 154 | Train Loss: 0.889 Vali Loss: 1.901 Vali Acc: 0.500 Test Loss: 1.901 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.1093961
	speed: 0.2432s/iter; left time: 3084.0264s
Epoch: 18 cost time: 7.060245037078857
Epoch: 18, Steps: 154 | Train Loss: 0.890 Vali Loss: 1.978 Vali Acc: 0.508 Test Loss: 1.978 Test Acc: 0.508
Validation loss decreased (-0.502008 --> -0.507685).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0082779
	speed: 0.2868s/iter; left time: 3593.1859s
Epoch: 19 cost time: 9.267815828323364
Epoch: 19, Steps: 154 | Train Loss: 0.865 Vali Loss: 2.023 Vali Acc: 0.476 Test Loss: 2.023 Test Acc: 0.476
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8151042
	speed: 0.2709s/iter; left time: 3352.3136s
Epoch: 20 cost time: 7.700687646865845
Epoch: 20, Steps: 154 | Train Loss: 0.855 Vali Loss: 1.886 Vali Acc: 0.491 Test Loss: 1.886 Test Acc: 0.491
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.5663565
	speed: 0.2893s/iter; left time: 3535.1279s
Epoch: 21 cost time: 8.69143557548523
Epoch: 21, Steps: 154 | Train Loss: 0.851 Vali Loss: 2.000 Vali Acc: 0.489 Test Loss: 2.000 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.3464155
	speed: 0.2856s/iter; left time: 3446.7571s
Epoch: 22 cost time: 8.449733018875122
Epoch: 22, Steps: 154 | Train Loss: 0.836 Vali Loss: 1.824 Vali Acc: 0.508 Test Loss: 1.824 Test Acc: 0.508
Validation loss decreased (-0.507685 --> -0.508092).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.9038839
	speed: 0.2789s/iter; left time: 3321.9934s
Epoch: 23 cost time: 7.827465057373047
Epoch: 23, Steps: 154 | Train Loss: 0.804 Vali Loss: 1.953 Vali Acc: 0.491 Test Loss: 1.953 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.6524946
	speed: 0.2728s/iter; left time: 3207.9060s
Epoch: 24 cost time: 8.154839038848877
Epoch: 24, Steps: 154 | Train Loss: 0.814 Vali Loss: 1.947 Vali Acc: 0.490 Test Loss: 1.947 Test Acc: 0.490
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.6458560
	speed: 0.2621s/iter; left time: 3042.1417s
Epoch: 25 cost time: 7.446857690811157
Epoch: 25, Steps: 154 | Train Loss: 0.791 Vali Loss: 2.007 Vali Acc: 0.502 Test Loss: 2.007 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.3909914
	speed: 0.2596s/iter; left time: 2972.7301s
Epoch: 26 cost time: 6.508952617645264
Epoch: 26, Steps: 154 | Train Loss: 0.774 Vali Loss: 1.893 Vali Acc: 0.507 Test Loss: 1.893 Test Acc: 0.507
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.0381894
	speed: 0.2352s/iter; left time: 2657.1678s
Epoch: 27 cost time: 7.488568067550659
Epoch: 27, Steps: 154 | Train Loss: 0.749 Vali Loss: 2.033 Vali Acc: 0.484 Test Loss: 2.033 Test Acc: 0.484
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.9028063
	speed: 0.2756s/iter; left time: 3071.1710s
Epoch: 28 cost time: 7.135648727416992
Epoch: 28, Steps: 154 | Train Loss: 0.743 Vali Loss: 1.909 Vali Acc: 0.502 Test Loss: 1.909 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.9576911
	speed: 0.2313s/iter; left time: 2541.9945s
Epoch: 29 cost time: 8.040312051773071
Epoch: 29, Steps: 154 | Train Loss: 0.737 Vali Loss: 2.133 Vali Acc: 0.489 Test Loss: 2.133 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.7868645
	speed: 0.2540s/iter; left time: 2751.6697s
Epoch: 30 cost time: 7.144753456115723
Epoch: 30, Steps: 154 | Train Loss: 0.728 Vali Loss: 1.972 Vali Acc: 0.499 Test Loss: 1.972 Test Acc: 0.499
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 1.0834122
	speed: 0.2526s/iter; left time: 2698.3837s
Epoch: 31 cost time: 7.435738801956177
Epoch: 31, Steps: 154 | Train Loss: 0.702 Vali Loss: 1.997 Vali Acc: 0.519 Test Loss: 1.997 Test Acc: 0.519
Validation loss decreased (-0.508092 --> -0.519445).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.5382124
	speed: 0.2388s/iter; left time: 2513.4311s
Epoch: 32 cost time: 6.042528390884399
Epoch: 32, Steps: 154 | Train Loss: 0.706 Vali Loss: 1.941 Vali Acc: 0.526 Test Loss: 1.941 Test Acc: 0.526
Validation loss decreased (-0.519445 --> -0.526339).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.5822260
	speed: 0.2291s/iter; left time: 2376.3677s
Epoch: 33 cost time: 6.610944986343384
Epoch: 33, Steps: 154 | Train Loss: 0.691 Vali Loss: 2.016 Vali Acc: 0.509 Test Loss: 2.016 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.6910233
	speed: 0.2333s/iter; left time: 2384.3923s
Epoch: 34 cost time: 7.234501600265503
Epoch: 34, Steps: 154 | Train Loss: 0.684 Vali Loss: 1.932 Vali Acc: 0.496 Test Loss: 1.932 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.7028188
	speed: 0.2398s/iter; left time: 2413.9188s
Epoch: 35 cost time: 7.304309129714966
Epoch: 35, Steps: 154 | Train Loss: 0.664 Vali Loss: 2.075 Vali Acc: 0.498 Test Loss: 2.075 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 1.0419948
	speed: 0.2711s/iter; left time: 2687.2803s
Epoch: 36 cost time: 8.703466176986694
Epoch: 36, Steps: 154 | Train Loss: 0.691 Vali Loss: 2.042 Vali Acc: 0.512 Test Loss: 2.042 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.7652428
	speed: 0.2946s/iter; left time: 2874.2810s
Epoch: 37 cost time: 7.999813079833984
Epoch: 37, Steps: 154 | Train Loss: 0.659 Vali Loss: 2.057 Vali Acc: 0.516 Test Loss: 2.057 Test Acc: 0.516
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.4206132
	speed: 0.2859s/iter; left time: 2745.1554s
Epoch: 38 cost time: 8.977538585662842
Epoch: 38, Steps: 154 | Train Loss: 0.655 Vali Loss: 2.056 Vali Acc: 0.509 Test Loss: 2.056 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.2520915
	speed: 0.3133s/iter; left time: 2960.0948s
Epoch: 39 cost time: 8.70451283454895
Epoch: 39, Steps: 154 | Train Loss: 0.630 Vali Loss: 2.086 Vali Acc: 0.502 Test Loss: 2.086 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.5268729
	speed: 0.2831s/iter; left time: 2631.7451s
Epoch: 40 cost time: 8.43717074394226
Epoch: 40, Steps: 154 | Train Loss: 0.638 Vali Loss: 2.264 Vali Acc: 0.484 Test Loss: 2.264 Test Acc: 0.484
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.4814451
	speed: 0.2845s/iter; left time: 2600.8721s
Epoch: 41 cost time: 7.713360071182251
Epoch: 41, Steps: 154 | Train Loss: 0.644 Vali Loss: 2.135 Vali Acc: 0.504 Test Loss: 2.135 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.4789876
	speed: 0.2458s/iter; left time: 2208.8939s
Epoch: 42 cost time: 6.4756457805633545
Epoch: 42, Steps: 154 | Train Loss: 0.629 Vali Loss: 2.070 Vali Acc: 0.524 Test Loss: 2.070 Test Acc: 0.524
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df128_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5263584752635847
model parameter : 14990
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9106053
	speed: 0.0807s/iter; left time: 1235.0857s
Epoch: 1 cost time: 10.318760395050049
Epoch: 1, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.014 Vali Acc: 0.371 Test Loss: 2.014 Test Acc: 0.371
Validation loss decreased (inf --> -0.371432).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5436797
	speed: 0.2501s/iter; left time: 3788.7051s
Epoch: 2 cost time: 7.478673696517944
Epoch: 2, Steps: 154 | Train Loss: 1.749 Vali Loss: 1.900 Vali Acc: 0.402 Test Loss: 1.900 Test Acc: 0.402
Validation loss decreased (-0.371432 --> -0.401846).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0428157
	speed: 0.2475s/iter; left time: 3711.5171s
Epoch: 3 cost time: 6.222010374069214
Epoch: 3, Steps: 154 | Train Loss: 1.367 Vali Loss: 1.751 Vali Acc: 0.447 Test Loss: 1.751 Test Acc: 0.447
Validation loss decreased (-0.401846 --> -0.446860).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8215003
	speed: 0.2423s/iter; left time: 3594.9716s
Epoch: 4 cost time: 8.307334899902344
Epoch: 4, Steps: 154 | Train Loss: 1.171 Vali Loss: 1.630 Vali Acc: 0.512 Test Loss: 1.630 Test Acc: 0.512
Validation loss decreased (-0.446860 --> -0.511744).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9310896
	speed: 0.2464s/iter; left time: 3617.6734s
Epoch: 5 cost time: 5.76530385017395
Epoch: 5, Steps: 154 | Train Loss: 1.057 Vali Loss: 1.783 Vali Acc: 0.511 Test Loss: 1.783 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3399301
	speed: 0.2231s/iter; left time: 3241.7240s
Epoch: 6 cost time: 7.400113821029663
Epoch: 6, Steps: 154 | Train Loss: 1.001 Vali Loss: 1.731 Vali Acc: 0.518 Test Loss: 1.731 Test Acc: 0.518
Validation loss decreased (-0.511744 --> -0.518231).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4968384
	speed: 0.2937s/iter; left time: 4222.2456s
Epoch: 7 cost time: 8.25025200843811
Epoch: 7, Steps: 154 | Train Loss: 0.941 Vali Loss: 1.885 Vali Acc: 0.498 Test Loss: 1.885 Test Acc: 0.498
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.5956435
	speed: 0.2735s/iter; left time: 3889.9323s
Epoch: 8 cost time: 7.694387197494507
Epoch: 8, Steps: 154 | Train Loss: 0.894 Vali Loss: 1.820 Vali Acc: 0.515 Test Loss: 1.820 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.8171026
	speed: 0.2787s/iter; left time: 3921.4806s
Epoch: 9 cost time: 8.307297945022583
Epoch: 9, Steps: 154 | Train Loss: 0.815 Vali Loss: 1.841 Vali Acc: 0.489 Test Loss: 1.841 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.4948949
	speed: 0.2622s/iter; left time: 3648.4776s
Epoch: 10 cost time: 7.989106178283691
Epoch: 10, Steps: 154 | Train Loss: 0.819 Vali Loss: 1.943 Vali Acc: 0.473 Test Loss: 1.943 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.3174654
	speed: 0.2663s/iter; left time: 3664.9564s
Epoch: 11 cost time: 8.474008083343506
Epoch: 11, Steps: 154 | Train Loss: 0.757 Vali Loss: 2.025 Vali Acc: 0.521 Test Loss: 2.025 Test Acc: 0.521
Validation loss decreased (-0.518231 --> -0.520661).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4736434
	speed: 0.2742s/iter; left time: 3731.1604s
Epoch: 12 cost time: 7.223000764846802
Epoch: 12, Steps: 154 | Train Loss: 0.738 Vali Loss: 2.003 Vali Acc: 0.477 Test Loss: 2.003 Test Acc: 0.477
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9868102
	speed: 0.2565s/iter; left time: 3451.0609s
Epoch: 13 cost time: 7.076167583465576
Epoch: 13, Steps: 154 | Train Loss: 0.687 Vali Loss: 2.002 Vali Acc: 0.509 Test Loss: 2.002 Test Acc: 0.509
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.0786302
	speed: 0.2458s/iter; left time: 3269.4741s
Epoch: 14 cost time: 7.202026844024658
Epoch: 14, Steps: 154 | Train Loss: 0.693 Vali Loss: 2.172 Vali Acc: 0.476 Test Loss: 2.172 Test Acc: 0.476
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6264300
	speed: 0.2433s/iter; left time: 3198.2762s
Epoch: 15 cost time: 7.898481130599976
Epoch: 15, Steps: 154 | Train Loss: 0.657 Vali Loss: 2.106 Vali Acc: 0.494 Test Loss: 2.106 Test Acc: 0.494
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.6923451
	speed: 0.2582s/iter; left time: 3354.0115s
Epoch: 16 cost time: 7.804372787475586
Epoch: 16, Steps: 154 | Train Loss: 0.622 Vali Loss: 2.293 Vali Acc: 0.499 Test Loss: 2.293 Test Acc: 0.499
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.8336686
	speed: 0.2583s/iter; left time: 3315.5153s
Epoch: 17 cost time: 7.238701820373535
Epoch: 17, Steps: 154 | Train Loss: 0.596 Vali Loss: 2.287 Vali Acc: 0.508 Test Loss: 2.287 Test Acc: 0.508
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.2139422
	speed: 0.2388s/iter; left time: 3028.4444s
Epoch: 18 cost time: 7.075270652770996
Epoch: 18, Steps: 154 | Train Loss: 0.595 Vali Loss: 2.276 Vali Acc: 0.502 Test Loss: 2.276 Test Acc: 0.502
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.8630367
	speed: 0.2522s/iter; left time: 3160.0492s
Epoch: 19 cost time: 6.241304159164429
Epoch: 19, Steps: 154 | Train Loss: 0.555 Vali Loss: 2.348 Vali Acc: 0.505 Test Loss: 2.348 Test Acc: 0.505
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.6033933
	speed: 0.2481s/iter; left time: 3070.0907s
Epoch: 20 cost time: 8.51975965499878
Epoch: 20, Steps: 154 | Train Loss: 0.554 Vali Loss: 2.530 Vali Acc: 0.483 Test Loss: 2.530 Test Acc: 0.483
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.6899337
	speed: 0.2534s/iter; left time: 3097.0110s
Epoch: 21 cost time: 6.816350936889648
Epoch: 21, Steps: 154 | Train Loss: 0.510 Vali Loss: 2.445 Vali Acc: 0.494 Test Loss: 2.445 Test Acc: 0.494
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5206812652068127
model parameter : 51742
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1548281
	speed: 0.0834s/iter; left time: 1276.8353s
Epoch: 1 cost time: 10.621726751327515
Epoch: 1, Steps: 154 | Train Loss: 2.224 Vali Loss: 1.954 Vali Acc: 0.383 Test Loss: 1.954 Test Acc: 0.383
Validation loss decreased (inf --> -0.382787).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6467286
	speed: 0.2883s/iter; left time: 4366.5328s
Epoch: 2 cost time: 8.292497634887695
Epoch: 2, Steps: 154 | Train Loss: 1.754 Vali Loss: 1.778 Vali Acc: 0.426 Test Loss: 1.778 Test Acc: 0.426
Validation loss decreased (-0.382787 --> -0.426178).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1106310
	speed: 0.2755s/iter; left time: 4130.4761s
Epoch: 3 cost time: 8.257431268692017
Epoch: 3, Steps: 154 | Train Loss: 1.417 Vali Loss: 1.720 Vali Acc: 0.457 Test Loss: 1.720 Test Acc: 0.457
Validation loss decreased (-0.426178 --> -0.456998).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9891130
	speed: 0.2666s/iter; left time: 3955.5675s
Epoch: 4 cost time: 7.538334846496582
Epoch: 4, Steps: 154 | Train Loss: 1.223 Vali Loss: 1.776 Vali Acc: 0.463 Test Loss: 1.776 Test Acc: 0.463
Validation loss decreased (-0.456998 --> -0.462675).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1845102
	speed: 0.2756s/iter; left time: 4046.5610s
Epoch: 5 cost time: 7.873332738876343
Epoch: 5, Steps: 154 | Train Loss: 1.130 Vali Loss: 1.727 Vali Acc: 0.492 Test Loss: 1.727 Test Acc: 0.492
Validation loss decreased (-0.462675 --> -0.492278).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6258191
	speed: 0.2528s/iter; left time: 3673.8563s
Epoch: 6 cost time: 7.692782163619995
Epoch: 6, Steps: 154 | Train Loss: 1.066 Vali Loss: 1.882 Vali Acc: 0.464 Test Loss: 1.882 Test Acc: 0.464
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1812360
	speed: 0.2542s/iter; left time: 3654.6924s
Epoch: 7 cost time: 6.538342714309692
Epoch: 7, Steps: 154 | Train Loss: 1.009 Vali Loss: 1.729 Vali Acc: 0.515 Test Loss: 1.729 Test Acc: 0.515
Validation loss decreased (-0.492278 --> -0.514987).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7326305
	speed: 0.2430s/iter; left time: 3456.8733s
Epoch: 8 cost time: 6.888687372207642
Epoch: 8, Steps: 154 | Train Loss: 0.976 Vali Loss: 1.778 Vali Acc: 0.501 Test Loss: 1.778 Test Acc: 0.501
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.8705663
	speed: 0.2434s/iter; left time: 3424.0319s
Epoch: 9 cost time: 7.605098009109497
Epoch: 9, Steps: 154 | Train Loss: 0.941 Vali Loss: 1.863 Vali Acc: 0.481 Test Loss: 1.863 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.6056772
	speed: 0.2528s/iter; left time: 3518.3145s
Epoch: 10 cost time: 7.75375509262085
Epoch: 10, Steps: 154 | Train Loss: 0.892 Vali Loss: 1.781 Vali Acc: 0.525 Test Loss: 1.781 Test Acc: 0.525
Validation loss decreased (-0.514987 --> -0.525124).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8461273
	speed: 0.2739s/iter; left time: 3768.7434s
Epoch: 11 cost time: 8.646164894104004
Epoch: 11, Steps: 154 | Train Loss: 0.875 Vali Loss: 1.793 Vali Acc: 0.494 Test Loss: 1.793 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0252761
	speed: 0.2608s/iter; left time: 3548.7514s
Epoch: 12 cost time: 8.110550165176392
Epoch: 12, Steps: 154 | Train Loss: 0.856 Vali Loss: 1.892 Vali Acc: 0.521 Test Loss: 1.892 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7212037
	speed: 0.2554s/iter; left time: 3435.8797s
Epoch: 13 cost time: 7.664062023162842
Epoch: 13, Steps: 154 | Train Loss: 0.826 Vali Loss: 1.837 Vali Acc: 0.534 Test Loss: 1.837 Test Acc: 0.534
Validation loss decreased (-0.525124 --> -0.533639).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8703257
	speed: 0.2654s/iter; left time: 3529.0975s
Epoch: 14 cost time: 7.702008962631226
Epoch: 14, Steps: 154 | Train Loss: 0.788 Vali Loss: 1.894 Vali Acc: 0.510 Test Loss: 1.894 Test Acc: 0.510
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2892061
	speed: 0.2498s/iter; left time: 3283.2237s
Epoch: 15 cost time: 7.074416875839233
Epoch: 15, Steps: 154 | Train Loss: 0.763 Vali Loss: 1.865 Vali Acc: 0.527 Test Loss: 1.865 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5859177
	speed: 0.2809s/iter; left time: 3648.8721s
Epoch: 16 cost time: 8.673627853393555
Epoch: 16, Steps: 154 | Train Loss: 0.783 Vali Loss: 1.936 Vali Acc: 0.531 Test Loss: 1.936 Test Acc: 0.531
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.4602992
	speed: 0.3072s/iter; left time: 3943.0671s
Epoch: 17 cost time: 8.146880149841309
Epoch: 17, Steps: 154 | Train Loss: 0.749 Vali Loss: 2.002 Vali Acc: 0.526 Test Loss: 2.002 Test Acc: 0.526
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5800031
	speed: 0.2857s/iter; left time: 3623.5349s
Epoch: 18 cost time: 8.104480504989624
Epoch: 18, Steps: 154 | Train Loss: 0.728 Vali Loss: 1.951 Vali Acc: 0.515 Test Loss: 1.951 Test Acc: 0.515
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7095010
	speed: 0.2984s/iter; left time: 3738.6989s
Epoch: 19 cost time: 8.727779150009155
Epoch: 19, Steps: 154 | Train Loss: 0.716 Vali Loss: 1.992 Vali Acc: 0.513 Test Loss: 1.992 Test Acc: 0.513
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3884936
	speed: 0.2862s/iter; left time: 3541.9813s
Epoch: 20 cost time: 9.214367866516113
Epoch: 20, Steps: 154 | Train Loss: 0.678 Vali Loss: 1.971 Vali Acc: 0.545 Test Loss: 1.971 Test Acc: 0.545
Validation loss decreased (-0.533639 --> -0.544587).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.5529125
	speed: 0.2588s/iter; left time: 3163.2933s
Epoch: 21 cost time: 6.604099750518799
Epoch: 21, Steps: 154 | Train Loss: 0.664 Vali Loss: 1.931 Vali Acc: 0.528 Test Loss: 1.931 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.7278923
	speed: 0.2581s/iter; left time: 3114.2958s
Epoch: 22 cost time: 9.35192084312439
Epoch: 22, Steps: 154 | Train Loss: 0.628 Vali Loss: 2.050 Vali Acc: 0.500 Test Loss: 2.050 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.5103881
	speed: 0.2376s/iter; left time: 2830.1604s
Epoch: 23 cost time: 7.154527425765991
Epoch: 23, Steps: 154 | Train Loss: 0.620 Vali Loss: 2.139 Vali Acc: 0.494 Test Loss: 2.139 Test Acc: 0.494
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.6716090
	speed: 0.2580s/iter; left time: 3033.9132s
Epoch: 24 cost time: 7.228264570236206
Epoch: 24, Steps: 154 | Train Loss: 0.603 Vali Loss: 2.154 Vali Acc: 0.546 Test Loss: 2.154 Test Acc: 0.546
Validation loss decreased (-0.544587 --> -0.545802).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.8560977
	speed: 0.2460s/iter; left time: 2854.8875s
Epoch: 25 cost time: 7.430436372756958
Epoch: 25, Steps: 154 | Train Loss: 0.567 Vali Loss: 2.189 Vali Acc: 0.530 Test Loss: 2.189 Test Acc: 0.530
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.3714134
	speed: 0.2863s/iter; left time: 3278.9275s
Epoch: 26 cost time: 9.060426473617554
Epoch: 26, Steps: 154 | Train Loss: 0.554 Vali Loss: 2.248 Vali Acc: 0.529 Test Loss: 2.248 Test Acc: 0.529
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.8642828
	speed: 0.2722s/iter; left time: 3074.8410s
Epoch: 27 cost time: 7.576685905456543
Epoch: 27, Steps: 154 | Train Loss: 0.574 Vali Loss: 2.180 Vali Acc: 0.513 Test Loss: 2.180 Test Acc: 0.513
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.7086638
	speed: 0.2798s/iter; left time: 3117.4581s
Epoch: 28 cost time: 8.100491285324097
Epoch: 28, Steps: 154 | Train Loss: 0.545 Vali Loss: 2.226 Vali Acc: 0.495 Test Loss: 2.226 Test Acc: 0.495
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.7689585
	speed: 0.2408s/iter; left time: 2646.6595s
Epoch: 29 cost time: 8.25109076499939
Epoch: 29, Steps: 154 | Train Loss: 0.544 Vali Loss: 2.195 Vali Acc: 0.526 Test Loss: 2.195 Test Acc: 0.526
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.5056199
	speed: 0.2736s/iter; left time: 2964.5931s
Epoch: 30 cost time: 7.958833932876587
Epoch: 30, Steps: 154 | Train Loss: 0.534 Vali Loss: 2.219 Vali Acc: 0.544 Test Loss: 2.219 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.2125958
	speed: 0.2422s/iter; left time: 2586.7992s
Epoch: 31 cost time: 7.822849988937378
Epoch: 31, Steps: 154 | Train Loss: 0.494 Vali Loss: 2.383 Vali Acc: 0.540 Test Loss: 2.383 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.5950382
	speed: 0.2906s/iter; left time: 3059.0958s
Epoch: 32 cost time: 8.857084274291992
Epoch: 32, Steps: 154 | Train Loss: 0.497 Vali Loss: 2.375 Vali Acc: 0.545 Test Loss: 2.375 Test Acc: 0.545
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.9584827
	speed: 0.2937s/iter; left time: 3046.3550s
Epoch: 33 cost time: 8.409821271896362
Epoch: 33, Steps: 154 | Train Loss: 0.496 Vali Loss: 2.373 Vali Acc: 0.529 Test Loss: 2.373 Test Acc: 0.529
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.8164104
	speed: 0.2769s/iter; left time: 2829.8446s
Epoch: 34 cost time: 8.34828782081604
Epoch: 34, Steps: 154 | Train Loss: 0.468 Vali Loss: 2.496 Vali Acc: 0.503 Test Loss: 2.496 Test Acc: 0.503
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.545823195458232
model parameter : 27566
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4607925
	speed: 0.0783s/iter; left time: 1198.1167s
Epoch: 1 cost time: 9.800523281097412
Epoch: 1, Steps: 154 | Train Loss: 2.259 Vali Loss: 2.037 Vali Acc: 0.340 Test Loss: 2.037 Test Acc: 0.340
Validation loss decreased (inf --> -0.340207).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2533495
	speed: 0.2581s/iter; left time: 3909.7184s
Epoch: 2 cost time: 7.801663637161255
Epoch: 2, Steps: 154 | Train Loss: 1.819 Vali Loss: 1.759 Vali Acc: 0.409 Test Loss: 1.759 Test Acc: 0.409
Validation loss decreased (-0.340207 --> -0.408742).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4272816
	speed: 0.2523s/iter; left time: 3782.8550s
Epoch: 3 cost time: 7.753708124160767
Epoch: 3, Steps: 154 | Train Loss: 1.463 Vali Loss: 1.889 Vali Acc: 0.432 Test Loss: 1.889 Test Acc: 0.432
Validation loss decreased (-0.408742 --> -0.432260).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7812533
	speed: 0.2700s/iter; left time: 4007.2611s
Epoch: 4 cost time: 7.12246561050415
Epoch: 4, Steps: 154 | Train Loss: 1.265 Vali Loss: 1.942 Vali Acc: 0.443 Test Loss: 1.942 Test Acc: 0.443
Validation loss decreased (-0.432260 --> -0.443208).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2874007
	speed: 0.2408s/iter; left time: 3536.5623s
Epoch: 5 cost time: 7.120887994766235
Epoch: 5, Steps: 154 | Train Loss: 1.196 Vali Loss: 1.781 Vali Acc: 0.488 Test Loss: 1.781 Test Acc: 0.488
Validation loss decreased (-0.443208 --> -0.487817).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1828320
	speed: 0.2421s/iter; left time: 3517.7257s
Epoch: 6 cost time: 6.837004661560059
Epoch: 6, Steps: 154 | Train Loss: 1.122 Vali Loss: 1.881 Vali Acc: 0.471 Test Loss: 1.881 Test Acc: 0.471
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0361575
	speed: 0.2475s/iter; left time: 3558.1567s
Epoch: 7 cost time: 7.696178674697876
Epoch: 7, Steps: 154 | Train Loss: 1.053 Vali Loss: 2.030 Vali Acc: 0.478 Test Loss: 2.030 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8837236
	speed: 0.2640s/iter; left time: 3754.4475s
Epoch: 8 cost time: 8.51423716545105
Epoch: 8, Steps: 154 | Train Loss: 1.011 Vali Loss: 1.969 Vali Acc: 0.487 Test Loss: 1.969 Test Acc: 0.487
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.6716971
	speed: 0.2728s/iter; left time: 3837.4151s
Epoch: 9 cost time: 8.682563781738281
Epoch: 9, Steps: 154 | Train Loss: 0.959 Vali Loss: 1.962 Vali Acc: 0.475 Test Loss: 1.962 Test Acc: 0.475
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.9433662
	speed: 0.2599s/iter; left time: 3616.0875s
Epoch: 10 cost time: 8.04717755317688
Epoch: 10, Steps: 154 | Train Loss: 0.919 Vali Loss: 2.127 Vali Acc: 0.490 Test Loss: 2.127 Test Acc: 0.490
Validation loss decreased (-0.487817 --> -0.489841).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7334587
	speed: 0.2645s/iter; left time: 3639.9929s
Epoch: 11 cost time: 6.975728988647461
Epoch: 11, Steps: 154 | Train Loss: 0.890 Vali Loss: 1.879 Vali Acc: 0.509 Test Loss: 1.879 Test Acc: 0.509
Validation loss decreased (-0.489841 --> -0.509308).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1131150
	speed: 0.2460s/iter; left time: 3347.6920s
Epoch: 12 cost time: 8.559818029403687
Epoch: 12, Steps: 154 | Train Loss: 0.855 Vali Loss: 1.946 Vali Acc: 0.514 Test Loss: 1.946 Test Acc: 0.514
Validation loss decreased (-0.509308 --> -0.513768).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0027945
	speed: 0.2889s/iter; left time: 3886.8581s
Epoch: 13 cost time: 8.30162262916565
Epoch: 13, Steps: 154 | Train Loss: 0.820 Vali Loss: 1.882 Vali Acc: 0.519 Test Loss: 1.882 Test Acc: 0.519
Validation loss decreased (-0.513768 --> -0.519040).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7526572
	speed: 0.2940s/iter; left time: 3909.2724s
Epoch: 14 cost time: 8.437879800796509
Epoch: 14, Steps: 154 | Train Loss: 0.824 Vali Loss: 2.017 Vali Acc: 0.491 Test Loss: 2.017 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.7648250
	speed: 0.2957s/iter; left time: 3887.5883s
Epoch: 15 cost time: 8.832428932189941
Epoch: 15, Steps: 154 | Train Loss: 0.768 Vali Loss: 2.035 Vali Acc: 0.500 Test Loss: 2.035 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.5352710
	speed: 0.2796s/iter; left time: 3631.7089s
Epoch: 16 cost time: 8.205891847610474
Epoch: 16, Steps: 154 | Train Loss: 0.773 Vali Loss: 1.911 Vali Acc: 0.498 Test Loss: 1.911 Test Acc: 0.498
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8502303
	speed: 0.3035s/iter; left time: 3896.2432s
Epoch: 17 cost time: 9.414914846420288
Epoch: 17, Steps: 154 | Train Loss: 0.741 Vali Loss: 1.958 Vali Acc: 0.500 Test Loss: 1.958 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.3044715
	speed: 0.2728s/iter; left time: 3460.0244s
Epoch: 18 cost time: 8.06137490272522
Epoch: 18, Steps: 154 | Train Loss: 0.699 Vali Loss: 1.951 Vali Acc: 0.519 Test Loss: 1.951 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.5155234
	speed: 0.3067s/iter; left time: 3842.0946s
Epoch: 19 cost time: 9.116150617599487
Epoch: 19, Steps: 154 | Train Loss: 0.685 Vali Loss: 1.938 Vali Acc: 0.525 Test Loss: 1.938 Test Acc: 0.525
Validation loss decreased (-0.519040 --> -0.525123).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.6608829
	speed: 0.2240s/iter; left time: 2772.0457s
Epoch: 20 cost time: 6.733778476715088
Epoch: 20, Steps: 154 | Train Loss: 0.655 Vali Loss: 2.002 Vali Acc: 0.497 Test Loss: 2.002 Test Acc: 0.497
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.2995485
	speed: 0.2684s/iter; left time: 3280.4328s
Epoch: 21 cost time: 7.824440002441406
Epoch: 21, Steps: 154 | Train Loss: 0.641 Vali Loss: 1.949 Vali Acc: 0.521 Test Loss: 1.949 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.5386782
	speed: 0.2422s/iter; left time: 2923.1891s
Epoch: 22 cost time: 7.914724826812744
Epoch: 22, Steps: 154 | Train Loss: 0.629 Vali Loss: 2.245 Vali Acc: 0.515 Test Loss: 2.245 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.8377450
	speed: 0.2613s/iter; left time: 3112.6939s
Epoch: 23 cost time: 7.158188581466675
Epoch: 23, Steps: 154 | Train Loss: 0.604 Vali Loss: 2.204 Vali Acc: 0.511 Test Loss: 2.204 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.4908463
	speed: 0.2483s/iter; left time: 2920.3083s
Epoch: 24 cost time: 6.870771169662476
Epoch: 24, Steps: 154 | Train Loss: 0.576 Vali Loss: 2.096 Vali Acc: 0.543 Test Loss: 2.096 Test Acc: 0.543
Validation loss decreased (-0.525123 --> -0.542964).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.5575047
	speed: 0.2667s/iter; left time: 3095.5129s
Epoch: 25 cost time: 7.611262083053589
Epoch: 25, Steps: 154 | Train Loss: 0.605 Vali Loss: 2.158 Vali Acc: 0.520 Test Loss: 2.158 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.5157107
	speed: 0.2589s/iter; left time: 2965.1384s
Epoch: 26 cost time: 6.924479007720947
Epoch: 26, Steps: 154 | Train Loss: 0.538 Vali Loss: 2.095 Vali Acc: 0.530 Test Loss: 2.095 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.8881071
	speed: 0.2407s/iter; left time: 2719.0621s
Epoch: 27 cost time: 8.033722877502441
Epoch: 27, Steps: 154 | Train Loss: 0.534 Vali Loss: 2.251 Vali Acc: 0.502 Test Loss: 2.251 Test Acc: 0.502
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.2447374
	speed: 0.2555s/iter; left time: 2847.0284s
Epoch: 28 cost time: 6.77503776550293
Epoch: 28, Steps: 154 | Train Loss: 0.533 Vali Loss: 2.242 Vali Acc: 0.536 Test Loss: 2.242 Test Acc: 0.536
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.5637887
	speed: 0.2702s/iter; left time: 2969.5973s
Epoch: 29 cost time: 8.839591979980469
Epoch: 29, Steps: 154 | Train Loss: 0.518 Vali Loss: 2.345 Vali Acc: 0.518 Test Loss: 2.345 Test Acc: 0.518
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.9848256
	speed: 0.2813s/iter; left time: 3047.4614s
Epoch: 30 cost time: 8.145190238952637
Epoch: 30, Steps: 154 | Train Loss: 0.513 Vali Loss: 2.241 Vali Acc: 0.553 Test Loss: 2.241 Test Acc: 0.553
Validation loss decreased (-0.542964 --> -0.553100).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.9795491
	speed: 0.2791s/iter; left time: 2981.2511s
Epoch: 31 cost time: 8.144170045852661
Epoch: 31, Steps: 154 | Train Loss: 0.510 Vali Loss: 2.402 Vali Acc: 0.518 Test Loss: 2.402 Test Acc: 0.518
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.9374383
	speed: 0.2730s/iter; left time: 2874.0662s
Epoch: 32 cost time: 8.263498544692993
Epoch: 32, Steps: 154 | Train Loss: 0.487 Vali Loss: 2.324 Vali Acc: 0.521 Test Loss: 2.324 Test Acc: 0.521
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.4448690
	speed: 0.2940s/iter; left time: 3049.3425s
Epoch: 33 cost time: 8.33613395690918
Epoch: 33, Steps: 154 | Train Loss: 0.496 Vali Loss: 2.424 Vali Acc: 0.509 Test Loss: 2.424 Test Acc: 0.509
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.2108187
	speed: 0.2895s/iter; left time: 2958.8314s
Epoch: 34 cost time: 8.29347562789917
Epoch: 34, Steps: 154 | Train Loss: 0.469 Vali Loss: 2.407 Vali Acc: 0.521 Test Loss: 2.407 Test Acc: 0.521
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.7002451
	speed: 0.2930s/iter; left time: 2949.1815s
Epoch: 35 cost time: 8.329344511032104
Epoch: 35, Steps: 154 | Train Loss: 0.463 Vali Loss: 2.427 Vali Acc: 0.511 Test Loss: 2.427 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.8453101
	speed: 0.2395s/iter; left time: 2373.2881s
Epoch: 36 cost time: 6.597365856170654
Epoch: 36, Steps: 154 | Train Loss: 0.464 Vali Loss: 2.602 Vali Acc: 0.502 Test Loss: 2.602 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.2954191
	speed: 0.2548s/iter; left time: 2485.7828s
Epoch: 37 cost time: 8.3138906955719
Epoch: 37, Steps: 154 | Train Loss: 0.425 Vali Loss: 2.481 Vali Acc: 0.530 Test Loss: 2.481 Test Acc: 0.530
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.5076044
	speed: 0.2319s/iter; left time: 2226.9474s
Epoch: 38 cost time: 6.027749538421631
Epoch: 38, Steps: 154 | Train Loss: 0.433 Vali Loss: 2.506 Vali Acc: 0.535 Test Loss: 2.506 Test Acc: 0.535
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.9952960
	speed: 0.2261s/iter; left time: 2136.6465s
Epoch: 39 cost time: 6.745086669921875
Epoch: 39, Steps: 154 | Train Loss: 0.414 Vali Loss: 2.583 Vali Acc: 0.492 Test Loss: 2.583 Test Acc: 0.492
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.2763068
	speed: 0.2514s/iter; left time: 2336.8145s
Epoch: 40 cost time: 7.362544536590576
Epoch: 40, Steps: 154 | Train Loss: 0.419 Vali Loss: 2.505 Vali Acc: 0.502 Test Loss: 2.505 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5531224655312247
model parameter : 27582
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0873780
	speed: 0.0764s/iter; left time: 1169.0859s
Epoch: 1 cost time: 9.624130487442017
Epoch: 1, Steps: 154 | Train Loss: 2.292 Vali Loss: 2.062 Vali Acc: 0.334 Test Loss: 2.062 Test Acc: 0.334
Validation loss decreased (inf --> -0.333718).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3970814
	speed: 0.2196s/iter; left time: 3325.5757s
Epoch: 2 cost time: 6.023990869522095
Epoch: 2, Steps: 154 | Train Loss: 1.910 Vali Loss: 1.809 Vali Acc: 0.426 Test Loss: 1.809 Test Acc: 0.426
Validation loss decreased (-0.333718 --> -0.425773).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5707188
	speed: 0.2347s/iter; left time: 3518.5256s
Epoch: 3 cost time: 7.111011028289795
Epoch: 3, Steps: 154 | Train Loss: 1.552 Vali Loss: 1.734 Vali Acc: 0.438 Test Loss: 1.734 Test Acc: 0.438
Validation loss decreased (-0.425773 --> -0.437939).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5817769
	speed: 0.2453s/iter; left time: 3640.1688s
Epoch: 4 cost time: 7.309475898742676
Epoch: 4, Steps: 154 | Train Loss: 1.327 Vali Loss: 1.799 Vali Acc: 0.464 Test Loss: 1.799 Test Acc: 0.464
Validation loss decreased (-0.437939 --> -0.463486).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9738191
	speed: 0.2586s/iter; left time: 3797.8282s
Epoch: 5 cost time: 7.791031360626221
Epoch: 5, Steps: 154 | Train Loss: 1.224 Vali Loss: 1.816 Vali Acc: 0.468 Test Loss: 1.816 Test Acc: 0.468
Validation loss decreased (-0.463486 --> -0.468352).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2941414
	speed: 0.2671s/iter; left time: 3881.7163s
Epoch: 6 cost time: 7.8281683921813965
Epoch: 6, Steps: 154 | Train Loss: 1.167 Vali Loss: 1.943 Vali Acc: 0.466 Test Loss: 1.943 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5069735
	speed: 0.2622s/iter; left time: 3769.9475s
Epoch: 7 cost time: 8.006736040115356
Epoch: 7, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.785 Vali Acc: 0.481 Test Loss: 1.785 Test Acc: 0.481
Validation loss decreased (-0.468352 --> -0.480517).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4699906
	speed: 0.2566s/iter; left time: 3649.1546s
Epoch: 8 cost time: 6.9573047161102295
Epoch: 8, Steps: 154 | Train Loss: 1.070 Vali Loss: 1.884 Vali Acc: 0.488 Test Loss: 1.884 Test Acc: 0.488
Validation loss decreased (-0.480517 --> -0.488221).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9909627
	speed: 0.2844s/iter; left time: 4000.9998s
Epoch: 9 cost time: 8.016457319259644
Epoch: 9, Steps: 154 | Train Loss: 1.007 Vali Loss: 1.911 Vali Acc: 0.490 Test Loss: 1.911 Test Acc: 0.490
Validation loss decreased (-0.488221 --> -0.489843).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9328522
	speed: 0.2636s/iter; left time: 3668.2958s
Epoch: 10 cost time: 7.827836275100708
Epoch: 10, Steps: 154 | Train Loss: 0.981 Vali Loss: 1.856 Vali Acc: 0.500 Test Loss: 1.856 Test Acc: 0.500
Validation loss decreased (-0.489843 --> -0.500387).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0485877
	speed: 0.2778s/iter; left time: 3822.8078s
Epoch: 11 cost time: 7.824005126953125
Epoch: 11, Steps: 154 | Train Loss: 0.946 Vali Loss: 1.963 Vali Acc: 0.493 Test Loss: 1.963 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8299718
	speed: 0.2787s/iter; left time: 3792.4522s
Epoch: 12 cost time: 8.250364780426025
Epoch: 12, Steps: 154 | Train Loss: 0.937 Vali Loss: 2.164 Vali Acc: 0.472 Test Loss: 2.164 Test Acc: 0.472
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.4656444
	speed: 0.2761s/iter; left time: 3714.3946s
Epoch: 13 cost time: 8.206857442855835
Epoch: 13, Steps: 154 | Train Loss: 0.914 Vali Loss: 1.900 Vali Acc: 0.488 Test Loss: 1.900 Test Acc: 0.488
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5111081
	speed: 0.2536s/iter; left time: 3371.9662s
Epoch: 14 cost time: 7.4546661376953125
Epoch: 14, Steps: 154 | Train Loss: 0.903 Vali Loss: 1.949 Vali Acc: 0.493 Test Loss: 1.949 Test Acc: 0.493
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.8212726
	speed: 0.2556s/iter; left time: 3360.3228s
Epoch: 15 cost time: 7.18020486831665
Epoch: 15, Steps: 154 | Train Loss: 0.866 Vali Loss: 2.025 Vali Acc: 0.475 Test Loss: 2.025 Test Acc: 0.475
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.7077442
	speed: 0.2549s/iter; left time: 3311.5299s
Epoch: 16 cost time: 6.91469931602478
Epoch: 16, Steps: 154 | Train Loss: 0.859 Vali Loss: 1.940 Vali Acc: 0.527 Test Loss: 1.940 Test Acc: 0.527
Validation loss decreased (-0.500387 --> -0.526745).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.3639416
	speed: 0.2435s/iter; left time: 3125.5060s
Epoch: 17 cost time: 7.933603048324585
Epoch: 17, Steps: 154 | Train Loss: 0.831 Vali Loss: 1.968 Vali Acc: 0.504 Test Loss: 1.968 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.7542837
	speed: 0.2815s/iter; left time: 3570.2371s
Epoch: 18 cost time: 7.722787618637085
Epoch: 18, Steps: 154 | Train Loss: 0.811 Vali Loss: 1.952 Vali Acc: 0.523 Test Loss: 1.952 Test Acc: 0.523
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.7724242
	speed: 0.2963s/iter; left time: 3712.1047s
Epoch: 19 cost time: 7.951994180679321
Epoch: 19, Steps: 154 | Train Loss: 0.778 Vali Loss: 2.011 Vali Acc: 0.520 Test Loss: 2.011 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.6253688
	speed: 0.2706s/iter; left time: 3349.0519s
Epoch: 20 cost time: 8.394660234451294
Epoch: 20, Steps: 154 | Train Loss: 0.758 Vali Loss: 1.891 Vali Acc: 0.512 Test Loss: 1.891 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.6806746
	speed: 0.2910s/iter; left time: 3556.2952s
Epoch: 21 cost time: 8.301545858383179
Epoch: 21, Steps: 154 | Train Loss: 0.751 Vali Loss: 2.004 Vali Acc: 0.501 Test Loss: 2.004 Test Acc: 0.501
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.5304697
	speed: 0.2861s/iter; left time: 3452.1069s
Epoch: 22 cost time: 8.920525312423706
Epoch: 22, Steps: 154 | Train Loss: 0.738 Vali Loss: 1.990 Vali Acc: 0.509 Test Loss: 1.990 Test Acc: 0.509
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.0014786
	speed: 0.2644s/iter; left time: 3150.0103s
Epoch: 23 cost time: 7.777644872665405
Epoch: 23, Steps: 154 | Train Loss: 0.715 Vali Loss: 2.090 Vali Acc: 0.488 Test Loss: 2.090 Test Acc: 0.488
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.1481190
	speed: 0.2760s/iter; left time: 3245.6400s
Epoch: 24 cost time: 6.592064619064331
Epoch: 24, Steps: 154 | Train Loss: 0.713 Vali Loss: 2.212 Vali Acc: 0.502 Test Loss: 2.212 Test Acc: 0.502
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.6307745
	speed: 0.2657s/iter; left time: 3082.9774s
Epoch: 25 cost time: 9.067670822143555
Epoch: 25, Steps: 154 | Train Loss: 0.696 Vali Loss: 2.103 Vali Acc: 0.514 Test Loss: 2.103 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.4759047
	speed: 0.2652s/iter; left time: 3036.6578s
Epoch: 26 cost time: 8.317841291427612
Epoch: 26, Steps: 154 | Train Loss: 0.666 Vali Loss: 2.156 Vali Acc: 0.517 Test Loss: 2.156 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5267639902676399
model parameter : 19550
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0896080
	speed: 0.0802s/iter; left time: 1227.6039s
Epoch: 1 cost time: 10.030168056488037
Epoch: 1, Steps: 154 | Train Loss: 2.384 Vali Loss: 2.127 Vali Acc: 0.318 Test Loss: 2.127 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5015593
	speed: 0.2389s/iter; left time: 3618.4350s
Epoch: 2 cost time: 6.771488904953003
Epoch: 2, Steps: 154 | Train Loss: 1.974 Vali Loss: 1.881 Vali Acc: 0.389 Test Loss: 1.881 Test Acc: 0.389
Validation loss decreased (-0.318308 --> -0.388870).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3466356
	speed: 0.2717s/iter; left time: 4073.2386s
Epoch: 3 cost time: 9.03732442855835
Epoch: 3, Steps: 154 | Train Loss: 1.652 Vali Loss: 1.785 Vali Acc: 0.416 Test Loss: 1.785 Test Acc: 0.416
Validation loss decreased (-0.388870 --> -0.416041).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2253610
	speed: 0.2664s/iter; left time: 3953.2803s
Epoch: 4 cost time: 7.6367552280426025
Epoch: 4, Steps: 154 | Train Loss: 1.396 Vali Loss: 1.825 Vali Acc: 0.436 Test Loss: 1.825 Test Acc: 0.436
Validation loss decreased (-0.416041 --> -0.436316).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4164739
	speed: 0.2871s/iter; left time: 4216.2871s
Epoch: 5 cost time: 8.37515926361084
Epoch: 5, Steps: 154 | Train Loss: 1.278 Vali Loss: 1.802 Vali Acc: 0.468 Test Loss: 1.802 Test Acc: 0.468
Validation loss decreased (-0.436316 --> -0.467541).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3940835
	speed: 0.2722s/iter; left time: 3955.1837s
Epoch: 6 cost time: 8.711677551269531
Epoch: 6, Steps: 154 | Train Loss: 1.209 Vali Loss: 1.759 Vali Acc: 0.487 Test Loss: 1.759 Test Acc: 0.487
Validation loss decreased (-0.467541 --> -0.487006).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4098238
	speed: 0.2887s/iter; left time: 4151.0319s
Epoch: 7 cost time: 8.291597604751587
Epoch: 7, Steps: 154 | Train Loss: 1.141 Vali Loss: 1.753 Vali Acc: 0.489 Test Loss: 1.753 Test Acc: 0.489
Validation loss decreased (-0.487006 --> -0.489439).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3361930
	speed: 0.2879s/iter; left time: 4095.3139s
Epoch: 8 cost time: 8.408456563949585
Epoch: 8, Steps: 154 | Train Loss: 1.101 Vali Loss: 1.760 Vali Acc: 0.496 Test Loss: 1.760 Test Acc: 0.496
Validation loss decreased (-0.489439 --> -0.495927).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7714846
	speed: 0.2981s/iter; left time: 4193.6475s
Epoch: 9 cost time: 8.3931143283844
Epoch: 9, Steps: 154 | Train Loss: 1.056 Vali Loss: 1.838 Vali Acc: 0.487 Test Loss: 1.838 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2276924
	speed: 0.2835s/iter; left time: 3944.3238s
Epoch: 10 cost time: 8.034825325012207
Epoch: 10, Steps: 154 | Train Loss: 1.012 Vali Loss: 1.923 Vali Acc: 0.474 Test Loss: 1.923 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3316036
	speed: 0.2975s/iter; left time: 4094.3640s
Epoch: 11 cost time: 8.739707708358765
Epoch: 11, Steps: 154 | Train Loss: 0.991 Vali Loss: 1.790 Vali Acc: 0.499 Test Loss: 1.790 Test Acc: 0.499
Validation loss decreased (-0.495927 --> -0.498766).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1793141
	speed: 0.2697s/iter; left time: 3669.9513s
Epoch: 12 cost time: 7.650035619735718
Epoch: 12, Steps: 154 | Train Loss: 0.981 Vali Loss: 2.033 Vali Acc: 0.493 Test Loss: 2.033 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9491185
	speed: 0.2427s/iter; left time: 3265.4953s
Epoch: 13 cost time: 7.579556941986084
Epoch: 13, Steps: 154 | Train Loss: 0.958 Vali Loss: 1.789 Vali Acc: 0.501 Test Loss: 1.789 Test Acc: 0.501
Validation loss decreased (-0.498766 --> -0.501199).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.9274280
	speed: 0.2439s/iter; left time: 3243.4239s
Epoch: 14 cost time: 6.61767315864563
Epoch: 14, Steps: 154 | Train Loss: 0.901 Vali Loss: 1.909 Vali Acc: 0.508 Test Loss: 1.909 Test Acc: 0.508
Validation loss decreased (-0.501199 --> -0.507686).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.4869019
	speed: 0.2120s/iter; left time: 2786.1492s
Epoch: 15 cost time: 6.636043548583984
Epoch: 15, Steps: 154 | Train Loss: 0.904 Vali Loss: 1.864 Vali Acc: 0.516 Test Loss: 1.864 Test Acc: 0.516
Validation loss decreased (-0.507686 --> -0.516202).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9280063
	speed: 0.2192s/iter; left time: 2847.5003s
Epoch: 16 cost time: 6.051495313644409
Epoch: 16, Steps: 154 | Train Loss: 0.888 Vali Loss: 1.860 Vali Acc: 0.511 Test Loss: 1.860 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6853244
	speed: 0.2140s/iter; left time: 2746.6754s
Epoch: 17 cost time: 6.779088735580444
Epoch: 17, Steps: 154 | Train Loss: 0.893 Vali Loss: 1.899 Vali Acc: 0.519 Test Loss: 1.899 Test Acc: 0.519
Validation loss decreased (-0.516202 --> -0.519040).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.8103243
	speed: 0.2487s/iter; left time: 3154.1503s
Epoch: 18 cost time: 7.6505138874053955
Epoch: 18, Steps: 154 | Train Loss: 0.867 Vali Loss: 2.060 Vali Acc: 0.500 Test Loss: 2.060 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.0948640
	speed: 0.2515s/iter; left time: 3150.8328s
Epoch: 19 cost time: 7.2118611335754395
Epoch: 19, Steps: 154 | Train Loss: 0.837 Vali Loss: 1.955 Vali Acc: 0.524 Test Loss: 1.955 Test Acc: 0.524
Validation loss decreased (-0.519040 --> -0.524311).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.7740300
	speed: 0.2557s/iter; left time: 3163.9475s
Epoch: 20 cost time: 8.292897701263428
Epoch: 20, Steps: 154 | Train Loss: 0.840 Vali Loss: 1.968 Vali Acc: 0.517 Test Loss: 1.968 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.3713653
	speed: 0.2733s/iter; left time: 3340.4918s
Epoch: 21 cost time: 8.136675834655762
Epoch: 21, Steps: 154 | Train Loss: 0.837 Vali Loss: 1.935 Vali Acc: 0.515 Test Loss: 1.935 Test Acc: 0.515
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.0561720
	speed: 0.2784s/iter; left time: 3359.3865s
Epoch: 22 cost time: 8.685035943984985
Epoch: 22, Steps: 154 | Train Loss: 0.803 Vali Loss: 2.090 Vali Acc: 0.515 Test Loss: 2.090 Test Acc: 0.515
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.5973206
	speed: 0.2831s/iter; left time: 3372.0710s
Epoch: 23 cost time: 8.09917688369751
Epoch: 23, Steps: 154 | Train Loss: 0.774 Vali Loss: 1.967 Vali Acc: 0.528 Test Loss: 1.967 Test Acc: 0.528
Validation loss decreased (-0.524311 --> -0.528366).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.5382987
	speed: 0.2693s/iter; left time: 3167.2326s
Epoch: 24 cost time: 8.396586656570435
Epoch: 24, Steps: 154 | Train Loss: 0.783 Vali Loss: 1.941 Vali Acc: 0.517 Test Loss: 1.941 Test Acc: 0.517
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.7775357
	speed: 0.2834s/iter; left time: 3288.5826s
Epoch: 25 cost time: 8.366260528564453
Epoch: 25, Steps: 154 | Train Loss: 0.735 Vali Loss: 2.053 Vali Acc: 0.511 Test Loss: 2.053 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.5399979
	speed: 0.2855s/iter; left time: 3268.7955s
Epoch: 26 cost time: 8.25391960144043
Epoch: 26, Steps: 154 | Train Loss: 0.743 Vali Loss: 2.140 Vali Acc: 0.501 Test Loss: 2.140 Test Acc: 0.501
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.2904986
	speed: 0.2766s/iter; left time: 3125.0109s
Epoch: 27 cost time: 7.431350946426392
Epoch: 27, Steps: 154 | Train Loss: 0.713 Vali Loss: 2.089 Vali Acc: 0.515 Test Loss: 2.089 Test Acc: 0.515
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.3488549
	speed: 0.2622s/iter; left time: 2921.3715s
Epoch: 28 cost time: 8.248149394989014
Epoch: 28, Steps: 154 | Train Loss: 0.722 Vali Loss: 2.030 Vali Acc: 0.513 Test Loss: 2.030 Test Acc: 0.513
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.8499997
	speed: 0.2545s/iter; left time: 2796.3285s
Epoch: 29 cost time: 8.355433940887451
Epoch: 29, Steps: 154 | Train Loss: 0.682 Vali Loss: 2.142 Vali Acc: 0.520 Test Loss: 2.142 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.7152724
	speed: 0.2462s/iter; left time: 2667.8205s
Epoch: 30 cost time: 6.552777051925659
Epoch: 30, Steps: 154 | Train Loss: 0.687 Vali Loss: 2.121 Vali Acc: 0.504 Test Loss: 2.121 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.5461680
	speed: 0.2429s/iter; left time: 2594.1851s
Epoch: 31 cost time: 7.60242486000061
Epoch: 31, Steps: 154 | Train Loss: 0.702 Vali Loss: 2.142 Vali Acc: 0.507 Test Loss: 2.142 Test Acc: 0.507
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.8102499
	speed: 0.2544s/iter; left time: 2677.6545s
Epoch: 32 cost time: 7.351460933685303
Epoch: 32, Steps: 154 | Train Loss: 0.668 Vali Loss: 2.122 Vali Acc: 0.509 Test Loss: 2.122 Test Acc: 0.509
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.6244706
	speed: 0.2539s/iter; left time: 2633.9651s
Epoch: 33 cost time: 7.402389049530029
Epoch: 33, Steps: 154 | Train Loss: 0.667 Vali Loss: 2.073 Vali Acc: 0.523 Test Loss: 2.073 Test Acc: 0.523
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5283860502838605
model parameter : 15550
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              PatchTST            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            4                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6861775
	speed: 0.0859s/iter; left time: 1314.6220s
Epoch: 1 cost time: 11.232590198516846
Epoch: 1, Steps: 154 | Train Loss: 2.358 Vali Loss: 2.145 Vali Acc: 0.310 Test Loss: 2.145 Test Acc: 0.310
Validation loss decreased (inf --> -0.309792).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5134444
	speed: 0.2735s/iter; left time: 4143.0901s
Epoch: 2 cost time: 6.978370904922485
Epoch: 2, Steps: 154 | Train Loss: 2.074 Vali Loss: 1.985 Vali Acc: 0.366 Test Loss: 1.985 Test Acc: 0.366
Validation loss decreased (-0.309792 --> -0.366160).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5421968
	speed: 0.2693s/iter; left time: 4037.6778s
Epoch: 3 cost time: 9.250705003738403
Epoch: 3, Steps: 154 | Train Loss: 1.769 Vali Loss: 1.860 Vali Acc: 0.370 Test Loss: 1.860 Test Acc: 0.370
Validation loss decreased (-0.366160 --> -0.369811).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3041869
	speed: 0.2858s/iter; left time: 4241.6465s
Epoch: 4 cost time: 8.45474886894226
Epoch: 4, Steps: 154 | Train Loss: 1.512 Vali Loss: 1.892 Vali Acc: 0.404 Test Loss: 1.892 Test Acc: 0.404
Validation loss decreased (-0.369811 --> -0.404280).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1570563
	speed: 0.3030s/iter; left time: 4448.9262s
Epoch: 5 cost time: 7.948574781417847
Epoch: 5, Steps: 154 | Train Loss: 1.364 Vali Loss: 1.851 Vali Acc: 0.459 Test Loss: 1.851 Test Acc: 0.459
Validation loss decreased (-0.404280 --> -0.459024).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4573754
	speed: 0.2628s/iter; left time: 3818.8731s
Epoch: 6 cost time: 8.33163595199585
Epoch: 6, Steps: 154 | Train Loss: 1.271 Vali Loss: 1.812 Vali Acc: 0.464 Test Loss: 1.812 Test Acc: 0.464
Validation loss decreased (-0.459024 --> -0.464297).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1529849
	speed: 0.2849s/iter; left time: 4096.3537s
Epoch: 7 cost time: 8.205944776535034
Epoch: 7, Steps: 154 | Train Loss: 1.206 Vali Loss: 1.835 Vali Acc: 0.471 Test Loss: 1.835 Test Acc: 0.471
Validation loss decreased (-0.464297 --> -0.470785).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8810169
	speed: 0.2565s/iter; left time: 3648.0175s
Epoch: 8 cost time: 7.772164583206177
Epoch: 8, Steps: 154 | Train Loss: 1.175 Vali Loss: 1.813 Vali Acc: 0.475 Test Loss: 1.813 Test Acc: 0.475
Validation loss decreased (-0.470785 --> -0.474840).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0025408
	speed: 0.2613s/iter; left time: 3675.9241s
Epoch: 9 cost time: 7.590555906295776
Epoch: 9, Steps: 154 | Train Loss: 1.123 Vali Loss: 1.823 Vali Acc: 0.491 Test Loss: 1.823 Test Acc: 0.491
Validation loss decreased (-0.474840 --> -0.490655).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0485899
	speed: 0.2368s/iter; left time: 3294.6242s
Epoch: 10 cost time: 6.002630233764648
Epoch: 10, Steps: 154 | Train Loss: 1.093 Vali Loss: 1.927 Vali Acc: 0.462 Test Loss: 1.927 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9364861
	speed: 0.2601s/iter; left time: 3578.9435s
Epoch: 11 cost time: 7.396471261978149
Epoch: 11, Steps: 154 | Train Loss: 1.072 Vali Loss: 1.750 Vali Acc: 0.507 Test Loss: 1.750 Test Acc: 0.507
Validation loss decreased (-0.490655 --> -0.506876).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0164313
	speed: 0.2427s/iter; left time: 3301.8093s
Epoch: 12 cost time: 7.598692893981934
Epoch: 12, Steps: 154 | Train Loss: 1.036 Vali Loss: 1.874 Vali Acc: 0.487 Test Loss: 1.874 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.9756848
	speed: 0.2320s/iter; left time: 3120.5946s
Epoch: 13 cost time: 6.542433500289917
Epoch: 13, Steps: 154 | Train Loss: 1.007 Vali Loss: 1.691 Vali Acc: 0.530 Test Loss: 1.691 Test Acc: 0.530
Validation loss decreased (-0.506876 --> -0.529586).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8284769
	speed: 0.2298s/iter; left time: 3056.3195s
Epoch: 14 cost time: 5.987289190292358
Epoch: 14, Steps: 154 | Train Loss: 1.000 Vali Loss: 1.776 Vali Acc: 0.499 Test Loss: 1.776 Test Acc: 0.499
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2657712
	speed: 0.2248s/iter; left time: 2955.3307s
Epoch: 15 cost time: 7.248713970184326
Epoch: 15, Steps: 154 | Train Loss: 0.975 Vali Loss: 1.790 Vali Acc: 0.498 Test Loss: 1.790 Test Acc: 0.498
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.7744725
	speed: 0.2446s/iter; left time: 3178.1736s
Epoch: 16 cost time: 7.225270748138428
Epoch: 16, Steps: 154 | Train Loss: 0.932 Vali Loss: 1.722 Vali Acc: 0.514 Test Loss: 1.722 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8271059
	speed: 0.2732s/iter; left time: 3506.4910s
Epoch: 17 cost time: 8.524792194366455
Epoch: 17, Steps: 154 | Train Loss: 0.909 Vali Loss: 1.893 Vali Acc: 0.498 Test Loss: 1.893 Test Acc: 0.498
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6712240
	speed: 0.2648s/iter; left time: 3358.4576s
Epoch: 18 cost time: 7.800581216812134
Epoch: 18, Steps: 154 | Train Loss: 0.882 Vali Loss: 1.832 Vali Acc: 0.511 Test Loss: 1.832 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.9452829
	speed: 0.2875s/iter; left time: 3601.7724s
Epoch: 19 cost time: 8.4020836353302
Epoch: 19, Steps: 154 | Train Loss: 0.897 Vali Loss: 1.775 Vali Acc: 0.516 Test Loss: 1.775 Test Acc: 0.516
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.9046249
	speed: 0.2766s/iter; left time: 3422.9821s
Epoch: 20 cost time: 8.112745761871338
Epoch: 20, Steps: 154 | Train Loss: 0.867 Vali Loss: 1.797 Vali Acc: 0.527 Test Loss: 1.797 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.4137304
	speed: 0.2748s/iter; left time: 3357.7499s
Epoch: 21 cost time: 7.649811267852783
Epoch: 21, Steps: 154 | Train Loss: 0.848 Vali Loss: 1.777 Vali Acc: 0.509 Test Loss: 1.777 Test Acc: 0.509
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.7078481
	speed: 0.2729s/iter; left time: 3293.2446s
Epoch: 22 cost time: 7.889508247375488
Epoch: 22, Steps: 154 | Train Loss: 0.856 Vali Loss: 1.793 Vali Acc: 0.504 Test Loss: 1.793 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.7104416
	speed: 0.2684s/iter; left time: 3197.0537s
Epoch: 23 cost time: 7.751021862030029
Epoch: 23, Steps: 154 | Train Loss: 0.828 Vali Loss: 1.830 Vali Acc: 0.502 Test Loss: 1.830 Test Acc: 0.502
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_PatchTST_UEA_ftM_sl36_ll0_pl0_el1_dm16_nh4_df64_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.5296025952960259
model parameter : 12878
model size : 0.36MB
