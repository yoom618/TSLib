Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7330949
	speed: 2.5177s/iter; left time: 11382.5561s
Epoch: 1 cost time: 393.78772592544556
Epoch: 1, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.371 Vali Acc: 0.343 Test Loss: 2.371 Test Acc: 0.343
Validation loss decreased (inf --> -0.343042).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2847048
	speed: 6.8580s/iter; left time: 29948.8576s
Epoch: 2 cost time: 371.78745913505554
Epoch: 2, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.208 Vali Acc: 0.183 Test Loss: 2.208 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6536041
	speed: 5.0402s/iter; left time: 21234.4651s
Epoch: 3 cost time: 274.5364067554474
Epoch: 3, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.030 Vali Acc: 0.379 Test Loss: 2.030 Test Acc: 0.379
Validation loss decreased (-0.343042 --> -0.378731).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5769109
	speed: 4.8070s/iter; left time: 19511.5642s
Epoch: 4 cost time: 276.47711300849915
Epoch: 4, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.111 Vali Acc: 0.361 Test Loss: 2.111 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1867219
	speed: 4.7067s/iter; left time: 18379.7937s
Epoch: 5 cost time: 265.00852823257446
Epoch: 5, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.209 Vali Acc: 0.364 Test Loss: 2.209 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4202563
	speed: 4.4461s/iter; left time: 16677.4319s
Epoch: 6 cost time: 250.37007451057434
Epoch: 6, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.232 Vali Acc: 0.215 Test Loss: 2.232 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.1768258
	speed: 4.2653s/iter; left time: 15342.2954s
Epoch: 7 cost time: 225.92039036750793
Epoch: 7, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.222 Vali Acc: 0.371 Test Loss: 2.222 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.7834477
	speed: 4.0542s/iter; left time: 13958.5650s
Epoch: 8 cost time: 227.8891806602478
Epoch: 8, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.069 Vali Acc: 0.391 Test Loss: 2.069 Test Acc: 0.391
Validation loss decreased (-0.378731 --> -0.390896).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5320269
	speed: 4.2385s/iter; left time: 13940.4265s
Epoch: 9 cost time: 248.87419390678406
Epoch: 9, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.380 Vali Acc: 0.215 Test Loss: 2.380 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0744829
	speed: 4.3601s/iter; left time: 13668.9240s
Epoch: 10 cost time: 249.21333527565002
Epoch: 10, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.268 Vali Acc: 0.315 Test Loss: 2.268 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2391738
	speed: 4.6720s/iter; left time: 13927.3026s
Epoch: 11 cost time: 275.8028452396393
Epoch: 11, Steps: 154 | Train Loss: 1.229 Vali Loss: 4.973 Vali Acc: 0.130 Test Loss: 4.973 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2407441
	speed: 7.5541s/iter; left time: 21355.3422s
Epoch: 12 cost time: 466.4689667224884
Epoch: 12, Steps: 154 | Train Loss: 1.213 Vali Loss: 3.928 Vali Acc: 0.132 Test Loss: 3.928 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.6275519
	speed: 8.1755s/iter; left time: 21852.9799s
Epoch: 13 cost time: 445.51755023002625
Epoch: 13, Steps: 154 | Train Loss: 1.144 Vali Loss: 3.117 Vali Acc: 0.097 Test Loss: 3.117 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3915641
	speed: 8.0079s/iter; left time: 20172.0007s
Epoch: 14 cost time: 455.6781144142151
Epoch: 14, Steps: 154 | Train Loss: 1.108 Vali Loss: 2.505 Vali Acc: 0.208 Test Loss: 2.505 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6910177
	speed: 8.3004s/iter; left time: 19630.4863s
Epoch: 15 cost time: 465.04318714141846
Epoch: 15, Steps: 154 | Train Loss: 1.089 Vali Loss: 3.948 Vali Acc: 0.164 Test Loss: 3.948 Test Acc: 0.164
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.4505286
	speed: 8.2500s/iter; left time: 18240.7583s
Epoch: 16 cost time: 463.97394251823425
Epoch: 16, Steps: 154 | Train Loss: 1.062 Vali Loss: 3.970 Vali Acc: 0.129 Test Loss: 3.970 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.8740496
	speed: 8.1312s/iter; left time: 16725.9149s
Epoch: 17 cost time: 461.2697079181671
Epoch: 17, Steps: 154 | Train Loss: 1.031 Vali Loss: 3.771 Vali Acc: 0.130 Test Loss: 3.771 Test Acc: 0.130
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.5910588
	speed: 7.8110s/iter; left time: 14864.3456s
Epoch: 18 cost time: 439.61525321006775
Epoch: 18, Steps: 154 | Train Loss: 0.975 Vali Loss: 6.619 Vali Acc: 0.083 Test Loss: 6.619 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3909164639091646
model parameter : 75049998
model size : 288.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8828044
	speed: 0.8560s/iter; left time: 3869.9115s
Epoch: 1 cost time: 134.4284791946411
Epoch: 1, Steps: 154 | Train Loss: 2.076 Vali Loss: 2.400 Vali Acc: 0.344 Test Loss: 2.400 Test Acc: 0.344
Validation loss decreased (inf --> -0.343853).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0882721
	speed: 2.6524s/iter; left time: 11582.8377s
Epoch: 2 cost time: 149.0575988292694
Epoch: 2, Steps: 154 | Train Loss: 1.875 Vali Loss: 2.309 Vali Acc: 0.345 Test Loss: 2.309 Test Acc: 0.345
Validation loss decreased (-0.343853 --> -0.344665).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9940531
	speed: 2.7751s/iter; left time: 11691.5656s
Epoch: 3 cost time: 141.710551738739
Epoch: 3, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.403 Vali Acc: 0.333 Test Loss: 2.403 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5690551
	speed: 2.7537s/iter; left time: 11177.4008s
Epoch: 4 cost time: 145.5589120388031
Epoch: 4, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.296 Vali Acc: 0.378 Test Loss: 2.296 Test Acc: 0.378
Validation loss decreased (-0.344665 --> -0.377512).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4030533
	speed: 2.8129s/iter; left time: 10984.5378s
Epoch: 5 cost time: 143.77590370178223
Epoch: 5, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.692 Vali Acc: 0.190 Test Loss: 2.692 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8601413
	speed: 2.5176s/iter; left time: 9443.3985s
Epoch: 6 cost time: 134.07370281219482
Epoch: 6, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.302 Vali Acc: 0.233 Test Loss: 2.302 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4553446
	speed: 2.4925s/iter; left time: 8965.5329s
Epoch: 7 cost time: 131.37889003753662
Epoch: 7, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.342 Vali Acc: 0.391 Test Loss: 2.342 Test Acc: 0.391
Validation loss decreased (-0.377512 --> -0.390893).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3682162
	speed: 2.3486s/iter; left time: 8086.2744s
Epoch: 8 cost time: 127.03314471244812
Epoch: 8, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.355 Vali Acc: 0.096 Test Loss: 3.355 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9559088
	speed: 2.4246s/iter; left time: 7974.3613s
Epoch: 9 cost time: 125.3740496635437
Epoch: 9, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.051 Vali Acc: 0.120 Test Loss: 3.051 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.8487782
	speed: 2.2408s/iter; left time: 7024.7588s
Epoch: 10 cost time: 114.22325491905212
Epoch: 10, Steps: 154 | Train Loss: 1.148 Vali Loss: 3.578 Vali Acc: 0.200 Test Loss: 3.578 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.7011147
	speed: 2.2681s/iter; left time: 6761.1886s
Epoch: 11 cost time: 119.06090331077576
Epoch: 11, Steps: 154 | Train Loss: 1.065 Vali Loss: 5.730 Vali Acc: 0.134 Test Loss: 5.730 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2490070
	speed: 2.1718s/iter; left time: 6139.7297s
Epoch: 12 cost time: 116.37731122970581
Epoch: 12, Steps: 154 | Train Loss: 1.073 Vali Loss: 4.457 Vali Acc: 0.208 Test Loss: 4.457 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0921303
	speed: 2.1995s/iter; left time: 5879.1884s
Epoch: 13 cost time: 116.09026098251343
Epoch: 13, Steps: 154 | Train Loss: 1.000 Vali Loss: 7.412 Vali Acc: 0.099 Test Loss: 7.412 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7153684
	speed: 2.2766s/iter; left time: 5734.8558s
Epoch: 14 cost time: 122.27166152000427
Epoch: 14, Steps: 154 | Train Loss: 0.950 Vali Loss: 9.247 Vali Acc: 0.072 Test Loss: 9.247 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.8942783
	speed: 2.1951s/iter; left time: 5191.4159s
Epoch: 15 cost time: 116.63777923583984
Epoch: 15, Steps: 154 | Train Loss: 0.876 Vali Loss: 4.089 Vali Acc: 0.179 Test Loss: 4.089 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.5801227
	speed: 2.3002s/iter; left time: 5085.7064s
Epoch: 16 cost time: 119.8276915550232
Epoch: 16, Steps: 154 | Train Loss: 0.872 Vali Loss: 5.792 Vali Acc: 0.109 Test Loss: 5.792 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.3138545
	speed: 2.2847s/iter; left time: 4699.6775s
Epoch: 17 cost time: 122.87167978286743
Epoch: 17, Steps: 154 | Train Loss: 0.787 Vali Loss: 5.333 Vali Acc: 0.198 Test Loss: 5.333 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3909164639091646
model parameter : 22093838
model size : 86.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7087630
	speed: 1.7087s/iter; left time: 7725.2209s
Epoch: 1 cost time: 260.95409059524536
Epoch: 1, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.498 Vali Acc: 0.074 Test Loss: 2.498 Test Acc: 0.074
Validation loss decreased (inf --> -0.073779).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2283881
	speed: 4.5643s/iter; left time: 19932.3674s
Epoch: 2 cost time: 263.49163603782654
Epoch: 2, Steps: 154 | Train Loss: 1.931 Vali Loss: 2.161 Vali Acc: 0.204 Test Loss: 2.161 Test Acc: 0.204
Validation loss decreased (-0.073779 --> -0.203952).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5052586
	speed: 4.5899s/iter; left time: 19337.4342s
Epoch: 3 cost time: 267.12585639953613
Epoch: 3, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.219 Vali Acc: 0.369 Test Loss: 2.219 Test Acc: 0.369
Validation loss decreased (-0.203952 --> -0.368996).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5340059
	speed: 4.6121s/iter; left time: 18720.5438s
Epoch: 4 cost time: 255.39766883850098
Epoch: 4, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.290 Vali Acc: 0.144 Test Loss: 2.290 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3281031
	speed: 4.3624s/iter; left time: 17035.0698s
Epoch: 5 cost time: 244.339049577713
Epoch: 5, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.139 Vali Acc: 0.363 Test Loss: 2.139 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3203778
	speed: 4.3133s/iter; left time: 16179.1087s
Epoch: 6 cost time: 242.58106184005737
Epoch: 6, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.331 Vali Acc: 0.370 Test Loss: 2.331 Test Acc: 0.370
Validation loss decreased (-0.368996 --> -0.369806).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9454145
	speed: 4.2042s/iter; left time: 15122.4326s
Epoch: 7 cost time: 237.13561582565308
Epoch: 7, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.825 Vali Acc: 0.326 Test Loss: 2.825 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1594687
	speed: 4.2440s/iter; left time: 14612.1342s
Epoch: 8 cost time: 244.26097893714905
Epoch: 8, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.385 Vali Acc: 0.381 Test Loss: 2.385 Test Acc: 0.381
Validation loss decreased (-0.369806 --> -0.380755).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3609993
	speed: 4.2450s/iter; left time: 13961.8158s
Epoch: 9 cost time: 241.06282424926758
Epoch: 9, Steps: 154 | Train Loss: 1.400 Vali Loss: 5.325 Vali Acc: 0.195 Test Loss: 5.325 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0212152
	speed: 4.1635s/iter; left time: 13052.6816s
Epoch: 10 cost time: 230.7173674106598
Epoch: 10, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.780 Vali Acc: 0.378 Test Loss: 2.780 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2332160
	speed: 4.1587s/iter; left time: 12397.0329s
Epoch: 11 cost time: 231.85846304893494
Epoch: 11, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.442 Vali Acc: 0.215 Test Loss: 2.442 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2954297
	speed: 4.1238s/iter; left time: 11658.0513s
Epoch: 12 cost time: 224.23257088661194
Epoch: 12, Steps: 154 | Train Loss: 1.204 Vali Loss: 2.714 Vali Acc: 0.155 Test Loss: 2.714 Test Acc: 0.155
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.8755717
	speed: 3.9675s/iter; left time: 10605.1561s
Epoch: 13 cost time: 227.41885256767273
Epoch: 13, Steps: 154 | Train Loss: 1.184 Vali Loss: 2.577 Vali Acc: 0.394 Test Loss: 2.577 Test Acc: 0.394
Validation loss decreased (-0.380755 --> -0.393729).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2523316
	speed: 3.9847s/iter; left time: 10037.4848s
Epoch: 14 cost time: 227.92630696296692
Epoch: 14, Steps: 154 | Train Loss: 1.170 Vali Loss: 4.489 Vali Acc: 0.172 Test Loss: 4.489 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.8599658
	speed: 4.0380s/iter; left time: 9549.8789s
Epoch: 15 cost time: 234.64959359169006
Epoch: 15, Steps: 154 | Train Loss: 1.125 Vali Loss: 3.646 Vali Acc: 0.124 Test Loss: 3.646 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3802632
	speed: 4.5288s/iter; left time: 10013.2222s
Epoch: 16 cost time: 257.10350275039673
Epoch: 16, Steps: 154 | Train Loss: 1.047 Vali Loss: 3.983 Vali Acc: 0.094 Test Loss: 3.983 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.1707795
	speed: 4.6674s/iter; left time: 9600.8763s
Epoch: 17 cost time: 257.86231541633606
Epoch: 17, Steps: 154 | Train Loss: 1.078 Vali Loss: 2.885 Vali Acc: 0.279 Test Loss: 2.885 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.6598485
	speed: 4.4059s/iter; left time: 8384.3330s
Epoch: 18 cost time: 246.29814791679382
Epoch: 18, Steps: 154 | Train Loss: 1.001 Vali Loss: 4.147 Vali Acc: 0.098 Test Loss: 4.147 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.8400868
	speed: 4.3905s/iter; left time: 7679.0054s
Epoch: 19 cost time: 245.30232644081116
Epoch: 19, Steps: 154 | Train Loss: 1.012 Vali Loss: 2.954 Vali Acc: 0.342 Test Loss: 2.954 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.9670181
	speed: 4.2161s/iter; left time: 6724.7378s
Epoch: 20 cost time: 234.87058401107788
Epoch: 20, Steps: 154 | Train Loss: 0.929 Vali Loss: 3.331 Vali Acc: 0.295 Test Loss: 3.331 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.0735860
	speed: 4.1609s/iter; left time: 5995.8717s
Epoch: 21 cost time: 233.6480622291565
Epoch: 21, Steps: 154 | Train Loss: 0.937 Vali Loss: 2.382 Vali Acc: 0.383 Test Loss: 2.382 Test Acc: 0.383
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6003870
	speed: 4.1638s/iter; left time: 5358.8490s
Epoch: 22 cost time: 235.08901929855347
Epoch: 22, Steps: 154 | Train Loss: 0.901 Vali Loss: 3.359 Vali Acc: 0.151 Test Loss: 3.359 Test Acc: 0.151
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.6763152
	speed: 4.3713s/iter; left time: 4952.7281s
Epoch: 23 cost time: 244.25963926315308
Epoch: 23, Steps: 154 | Train Loss: 0.880 Vali Loss: 6.432 Vali Acc: 0.178 Test Loss: 6.432 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3937550689375507
model parameter : 75049998
model size : 288.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8636743
	speed: 0.5924s/iter; left time: 2678.1165s
Epoch: 1 cost time: 91.91658186912537
Epoch: 1, Steps: 154 | Train Loss: 2.079 Vali Loss: 2.314 Vali Acc: 0.342 Test Loss: 2.314 Test Acc: 0.342
Validation loss decreased (inf --> -0.342232).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0570450
	speed: 1.8044s/iter; left time: 7879.7576s
Epoch: 2 cost time: 90.75078678131104
Epoch: 2, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.350 Vali Acc: 0.109 Test Loss: 2.350 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0524564
	speed: 1.7400s/iter; left time: 7330.5285s
Epoch: 3 cost time: 85.40652179718018
Epoch: 3, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.155 Vali Acc: 0.360 Test Loss: 2.155 Test Acc: 0.360
Validation loss decreased (-0.342232 --> -0.359670).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6334114
	speed: 1.7345s/iter; left time: 7040.4540s
Epoch: 4 cost time: 89.50480699539185
Epoch: 4, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.125 Vali Acc: 0.383 Test Loss: 2.125 Test Acc: 0.383
Validation loss decreased (-0.359670 --> -0.382785).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2463869
	speed: 1.6961s/iter; left time: 6623.4097s
Epoch: 5 cost time: 86.711749792099
Epoch: 5, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.139 Vali Acc: 0.367 Test Loss: 2.139 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5772841
	speed: 1.6752s/iter; left time: 6283.7945s
Epoch: 6 cost time: 89.23012113571167
Epoch: 6, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.540 Vali Acc: 0.244 Test Loss: 2.540 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2396883
	speed: 1.7321s/iter; left time: 6230.4636s
Epoch: 7 cost time: 84.85940456390381
Epoch: 7, Steps: 154 | Train Loss: 1.378 Vali Loss: 4.228 Vali Acc: 0.341 Test Loss: 4.228 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5176046
	speed: 1.6095s/iter; left time: 5541.4566s
Epoch: 8 cost time: 89.41814589500427
Epoch: 8, Steps: 154 | Train Loss: 1.293 Vali Loss: 4.079 Vali Acc: 0.136 Test Loss: 4.079 Test Acc: 0.136
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.1417863
	speed: 1.7538s/iter; left time: 5768.2719s
Epoch: 9 cost time: 88.18555068969727
Epoch: 9, Steps: 154 | Train Loss: 1.238 Vali Loss: 6.260 Vali Acc: 0.100 Test Loss: 6.260 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.8351362
	speed: 1.6273s/iter; left time: 5101.6388s
Epoch: 10 cost time: 85.26149559020996
Epoch: 10, Steps: 154 | Train Loss: 1.163 Vali Loss: 3.482 Vali Acc: 0.408 Test Loss: 3.482 Test Acc: 0.408
Validation loss decreased (-0.382785 --> -0.407913).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7581009
	speed: 1.7367s/iter; left time: 5177.2350s
Epoch: 11 cost time: 88.20058917999268
Epoch: 11, Steps: 154 | Train Loss: 1.135 Vali Loss: 5.610 Vali Acc: 0.097 Test Loss: 5.610 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0130600
	speed: 1.6541s/iter; left time: 4676.2052s
Epoch: 12 cost time: 81.42090582847595
Epoch: 12, Steps: 154 | Train Loss: 1.051 Vali Loss: 5.336 Vali Acc: 0.230 Test Loss: 5.336 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2033813
	speed: 1.7010s/iter; left time: 4546.8797s
Epoch: 13 cost time: 89.08530569076538
Epoch: 13, Steps: 154 | Train Loss: 0.970 Vali Loss: 6.995 Vali Acc: 0.104 Test Loss: 6.995 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.5350679
	speed: 1.6917s/iter; left time: 4261.3318s
Epoch: 14 cost time: 83.79797053337097
Epoch: 14, Steps: 154 | Train Loss: 0.966 Vali Loss: 11.261 Vali Acc: 0.095 Test Loss: 11.261 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7955469
	speed: 1.7346s/iter; left time: 4102.3588s
Epoch: 15 cost time: 92.29439759254456
Epoch: 15, Steps: 154 | Train Loss: 0.907 Vali Loss: 4.954 Vali Acc: 0.206 Test Loss: 4.954 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.5324188
	speed: 1.8086s/iter; left time: 3998.7581s
Epoch: 16 cost time: 91.51116824150085
Epoch: 16, Steps: 154 | Train Loss: 0.872 Vali Loss: 6.678 Vali Acc: 0.103 Test Loss: 6.678 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.3085169
	speed: 1.7674s/iter; left time: 3635.4586s
Epoch: 17 cost time: 91.34105443954468
Epoch: 17, Steps: 154 | Train Loss: 0.784 Vali Loss: 9.076 Vali Acc: 0.124 Test Loss: 9.076 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.4474869
	speed: 1.7828s/iter; left time: 3392.5780s
Epoch: 18 cost time: 90.18139433860779
Epoch: 18, Steps: 154 | Train Loss: 0.750 Vali Loss: 12.235 Vali Acc: 0.084 Test Loss: 12.235 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.4239283
	speed: 1.7722s/iter; left time: 3099.4928s
Epoch: 19 cost time: 89.70679330825806
Epoch: 19, Steps: 154 | Train Loss: 0.713 Vali Loss: 13.877 Vali Acc: 0.088 Test Loss: 13.877 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.7521402
	speed: 1.7456s/iter; left time: 2784.2864s
Epoch: 20 cost time: 86.4693660736084
Epoch: 20, Steps: 154 | Train Loss: 0.709 Vali Loss: 2.611 Vali Acc: 0.413 Test Loss: 2.611 Test Acc: 0.413
Validation loss decreased (-0.407913 --> -0.413194).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8424326
	speed: 1.6995s/iter; left time: 2449.0211s
Epoch: 21 cost time: 88.84962821006775
Epoch: 21, Steps: 154 | Train Loss: 0.674 Vali Loss: 9.625 Vali Acc: 0.097 Test Loss: 9.625 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.6625583
	speed: 1.7224s/iter; left time: 2216.7413s
Epoch: 22 cost time: 90.83206605911255
Epoch: 22, Steps: 154 | Train Loss: 0.609 Vali Loss: 6.963 Vali Acc: 0.127 Test Loss: 6.963 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.9434430
	speed: 1.6663s/iter; left time: 1887.9099s
Epoch: 23 cost time: 84.90615916252136
Epoch: 23, Steps: 154 | Train Loss: 0.571 Vali Loss: 8.482 Vali Acc: 0.140 Test Loss: 8.482 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.4528455
	speed: 1.7763s/iter; left time: 1738.9865s
Epoch: 24 cost time: 86.3509430885315
Epoch: 24, Steps: 154 | Train Loss: 0.586 Vali Loss: 12.327 Vali Acc: 0.096 Test Loss: 12.327 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.5641234
	speed: 1.6989s/iter; left time: 1401.5916s
Epoch: 25 cost time: 87.77504348754883
Epoch: 25, Steps: 154 | Train Loss: 0.534 Vali Loss: 20.306 Vali Acc: 0.085 Test Loss: 20.306 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.4269563
	speed: 1.6561s/iter; left time: 1111.2200s
Epoch: 26 cost time: 85.75225687026978
Epoch: 26, Steps: 154 | Train Loss: 0.585 Vali Loss: 10.804 Vali Acc: 0.120 Test Loss: 10.804 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.6070337
	speed: 1.3202s/iter; left time: 682.5646s
Epoch: 27 cost time: 58.843419313430786
Epoch: 27, Steps: 154 | Train Loss: 0.479 Vali Loss: 11.564 Vali Acc: 0.092 Test Loss: 11.564 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.3648904
	speed: 1.3150s/iter; left time: 477.3413s
Epoch: 28 cost time: 65.99248242378235
Epoch: 28, Steps: 154 | Train Loss: 0.446 Vali Loss: 14.981 Vali Acc: 0.086 Test Loss: 14.981 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.5206648
	speed: 1.2613s/iter; left time: 263.6033s
Epoch: 29 cost time: 65.74296140670776
Epoch: 29, Steps: 154 | Train Loss: 0.431 Vali Loss: 22.948 Vali Acc: 0.088 Test Loss: 22.948 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.3441845
	speed: 1.2594s/iter; left time: 69.2662s
Epoch: 30 cost time: 68.5579731464386
Epoch: 30, Steps: 154 | Train Loss: 0.425 Vali Loss: 15.938 Vali Acc: 0.101 Test Loss: 15.938 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41321978913219787
model parameter : 22093838
model size : 86.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7553010
	speed: 0.6857s/iter; left time: 3100.0716s
Epoch: 1 cost time: 107.78871583938599
Epoch: 1, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.290 Vali Acc: 0.340 Test Loss: 2.290 Test Acc: 0.340
Validation loss decreased (inf --> -0.339799).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2352700
	speed: 1.8629s/iter; left time: 8135.1299s
Epoch: 2 cost time: 107.02432680130005
Epoch: 2, Steps: 154 | Train Loss: 1.974 Vali Loss: 2.319 Vali Acc: 0.204 Test Loss: 2.319 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.6028949
	speed: 1.8350s/iter; left time: 7730.9534s
Epoch: 3 cost time: 110.56490302085876
Epoch: 3, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.064 Vali Acc: 0.372 Test Loss: 2.064 Test Acc: 0.372
Validation loss decreased (-0.339799 --> -0.371837).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6673642
	speed: 1.7916s/iter; left time: 7271.9040s
Epoch: 4 cost time: 98.9593358039856
Epoch: 4, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.299 Vali Acc: 0.206 Test Loss: 2.299 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1941744
	speed: 1.8850s/iter; left time: 7360.7923s
Epoch: 5 cost time: 108.31227111816406
Epoch: 5, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.074 Vali Acc: 0.378 Test Loss: 2.074 Test Acc: 0.378
Validation loss decreased (-0.371837 --> -0.377514).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4852569
	speed: 1.8607s/iter; left time: 6979.6604s
Epoch: 6 cost time: 110.58589363098145
Epoch: 6, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.301 Vali Acc: 0.357 Test Loss: 2.301 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0508480
	speed: 1.7670s/iter; left time: 6355.8553s
Epoch: 7 cost time: 93.61621236801147
Epoch: 7, Steps: 154 | Train Loss: 1.578 Vali Loss: 4.735 Vali Acc: 0.069 Test Loss: 4.735 Test Acc: 0.069
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8697666
	speed: 1.6076s/iter; left time: 5534.8214s
Epoch: 8 cost time: 87.37323546409607
Epoch: 8, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.899 Vali Acc: 0.375 Test Loss: 2.899 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4973100
	speed: 1.6319s/iter; left time: 5367.2506s
Epoch: 9 cost time: 94.82975554466248
Epoch: 9, Steps: 154 | Train Loss: 1.450 Vali Loss: 4.217 Vali Acc: 0.199 Test Loss: 4.217 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 2.1430509
	speed: 1.8198s/iter; left time: 5705.1885s
Epoch: 10 cost time: 103.91579151153564
Epoch: 10, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.766 Vali Acc: 0.217 Test Loss: 3.766 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.2577949
	speed: 1.9101s/iter; left time: 5693.8624s
Epoch: 11 cost time: 113.69329977035522
Epoch: 11, Steps: 154 | Train Loss: 1.271 Vali Loss: 4.007 Vali Acc: 0.182 Test Loss: 4.007 Test Acc: 0.182
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.9971218
	speed: 1.8362s/iter; left time: 5190.9481s
Epoch: 12 cost time: 102.74869179725647
Epoch: 12, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.060 Vali Acc: 0.221 Test Loss: 3.060 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3955026
	speed: 1.5535s/iter; left time: 4152.6015s
Epoch: 13 cost time: 85.59217262268066
Epoch: 13, Steps: 154 | Train Loss: 1.199 Vali Loss: 4.892 Vali Acc: 0.209 Test Loss: 4.892 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.2790511
	speed: 1.5559s/iter; left time: 3919.3227s
Epoch: 14 cost time: 83.57934713363647
Epoch: 14, Steps: 154 | Train Loss: 1.131 Vali Loss: 4.961 Vali Acc: 0.137 Test Loss: 4.961 Test Acc: 0.137
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.7692891
	speed: 1.5252s/iter; left time: 3607.1655s
Epoch: 15 cost time: 89.0099995136261
Epoch: 15, Steps: 154 | Train Loss: 1.168 Vali Loss: 8.443 Vali Acc: 0.057 Test Loss: 8.443 Test Acc: 0.057
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 75049998
model size : 288.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8576987
	speed: 0.2959s/iter; left time: 1337.7793s
Epoch: 1 cost time: 44.736040115356445
Epoch: 1, Steps: 154 | Train Loss: 2.088 Vali Loss: 2.358 Vali Acc: 0.346 Test Loss: 2.358 Test Acc: 0.346
Validation loss decreased (inf --> -0.345881).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1313286
	speed: 0.7954s/iter; left time: 3473.7198s
Epoch: 2 cost time: 38.53550624847412
Epoch: 2, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.165 Vali Acc: 0.344 Test Loss: 2.165 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1301045
	speed: 0.8508s/iter; left time: 3584.6227s
Epoch: 3 cost time: 40.26805400848389
Epoch: 3, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.173 Vali Acc: 0.374 Test Loss: 2.173 Test Acc: 0.374
Validation loss decreased (-0.345881 --> -0.373863).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7766452
	speed: 0.8497s/iter; left time: 3448.8587s
Epoch: 4 cost time: 40.14364957809448
Epoch: 4, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.406 Vali Acc: 0.302 Test Loss: 2.406 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2272373
	speed: 0.7384s/iter; left time: 2883.4304s
Epoch: 5 cost time: 37.36021423339844
Epoch: 5, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.821 Vali Acc: 0.206 Test Loss: 2.821 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6836218
	speed: 0.7576s/iter; left time: 2841.6303s
Epoch: 6 cost time: 33.848634243011475
Epoch: 6, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.847 Vali Acc: 0.227 Test Loss: 2.847 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3103936
	speed: 0.6991s/iter; left time: 2514.7094s
Epoch: 7 cost time: 34.51671886444092
Epoch: 7, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.582 Vali Acc: 0.390 Test Loss: 2.582 Test Acc: 0.390
Validation loss decreased (-0.373863 --> -0.390080).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2672362
	speed: 0.7325s/iter; left time: 2522.1391s
Epoch: 8 cost time: 38.190950870513916
Epoch: 8, Steps: 154 | Train Loss: 1.369 Vali Loss: 5.031 Vali Acc: 0.117 Test Loss: 5.031 Test Acc: 0.117
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0538915
	speed: 0.7115s/iter; left time: 2340.2183s
Epoch: 9 cost time: 31.352904081344604
Epoch: 9, Steps: 154 | Train Loss: 1.288 Vali Loss: 6.577 Vali Acc: 0.091 Test Loss: 6.577 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.9319665
	speed: 0.7480s/iter; left time: 2344.8940s
Epoch: 10 cost time: 41.48885178565979
Epoch: 10, Steps: 154 | Train Loss: 1.202 Vali Loss: 5.188 Vali Acc: 0.125 Test Loss: 5.188 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.5419906
	speed: 0.8532s/iter; left time: 2543.3012s
Epoch: 11 cost time: 42.48899221420288
Epoch: 11, Steps: 154 | Train Loss: 1.110 Vali Loss: 6.651 Vali Acc: 0.100 Test Loss: 6.651 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.9785699
	speed: 0.7883s/iter; left time: 2228.6614s
Epoch: 12 cost time: 37.83580684661865
Epoch: 12, Steps: 154 | Train Loss: 1.062 Vali Loss: 6.815 Vali Acc: 0.100 Test Loss: 6.815 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5994248
	speed: 0.8682s/iter; left time: 2320.5814s
Epoch: 13 cost time: 41.32197046279907
Epoch: 13, Steps: 154 | Train Loss: 1.015 Vali Loss: 3.767 Vali Acc: 0.265 Test Loss: 3.767 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.8890138
	speed: 0.8276s/iter; left time: 2084.7998s
Epoch: 14 cost time: 40.1121461391449
Epoch: 14, Steps: 154 | Train Loss: 0.954 Vali Loss: 11.084 Vali Acc: 0.109 Test Loss: 11.084 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.5900794
	speed: 0.8058s/iter; left time: 1905.6300s
Epoch: 15 cost time: 41.73231816291809
Epoch: 15, Steps: 154 | Train Loss: 0.903 Vali Loss: 10.320 Vali Acc: 0.077 Test Loss: 10.320 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.5970043
	speed: 0.7987s/iter; left time: 1765.8931s
Epoch: 16 cost time: 34.053513526916504
Epoch: 16, Steps: 154 | Train Loss: 0.854 Vali Loss: 9.624 Vali Acc: 0.083 Test Loss: 9.624 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.2333348
	speed: 0.6928s/iter; left time: 1425.1196s
Epoch: 17 cost time: 35.56729197502136
Epoch: 17, Steps: 154 | Train Loss: 0.821 Vali Loss: 10.857 Vali Acc: 0.094 Test Loss: 10.857 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39010543390105434
model parameter : 22093838
model size : 86.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0256841
	speed: 0.8246s/iter; left time: 3728.2371s
Epoch: 1 cost time: 128.53898549079895
Epoch: 1, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.422 Vali Acc: 0.332 Test Loss: 2.422 Test Acc: 0.332
Validation loss decreased (inf --> -0.331687).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6808302
	speed: 2.6244s/iter; left time: 11460.8895s
Epoch: 2 cost time: 153.53782439231873
Epoch: 2, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.229 Vali Acc: 0.334 Test Loss: 2.229 Test Acc: 0.334
Validation loss decreased (-0.331687 --> -0.333717).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8458951
	speed: 2.8409s/iter; left time: 11968.7350s
Epoch: 3 cost time: 152.9424126148224
Epoch: 3, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.203 Vali Acc: 0.202 Test Loss: 2.203 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7457291
	speed: 2.5280s/iter; left time: 10261.0871s
Epoch: 4 cost time: 124.12921452522278
Epoch: 4, Steps: 154 | Train Loss: 1.630 Vali Loss: 5.130 Vali Acc: 0.065 Test Loss: 5.130 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2919080
	speed: 2.2339s/iter; left time: 8723.2613s
Epoch: 5 cost time: 121.64916133880615
Epoch: 5, Steps: 154 | Train Loss: 1.582 Vali Loss: 3.043 Vali Acc: 0.145 Test Loss: 3.043 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.9131784
	speed: 2.6007s/iter; left time: 9755.0892s
Epoch: 6 cost time: 142.5325300693512
Epoch: 6, Steps: 154 | Train Loss: 1.475 Vali Loss: 4.119 Vali Acc: 0.103 Test Loss: 4.119 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.3040055
	speed: 2.6196s/iter; left time: 9422.8091s
Epoch: 7 cost time: 137.77788162231445
Epoch: 7, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.783 Vali Acc: 0.128 Test Loss: 2.783 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 2.1736112
	speed: 2.3661s/iter; left time: 8146.6060s
Epoch: 8 cost time: 122.46230745315552
Epoch: 8, Steps: 154 | Train Loss: 1.358 Vali Loss: 9.481 Vali Acc: 0.090 Test Loss: 9.481 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.8010997
	speed: 2.2646s/iter; left time: 7448.4252s
Epoch: 9 cost time: 129.5289022922516
Epoch: 9, Steps: 154 | Train Loss: 1.327 Vali Loss: 3.237 Vali Acc: 0.192 Test Loss: 3.237 Test Acc: 0.192
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.0445459
	speed: 2.6377s/iter; left time: 8269.1386s
Epoch: 10 cost time: 139.8905053138733
Epoch: 10, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.384 Vali Acc: 0.162 Test Loss: 3.384 Test Acc: 0.162
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.3692673
	speed: 2.5360s/iter; left time: 7559.6702s
Epoch: 11 cost time: 128.59474563598633
Epoch: 11, Steps: 154 | Train Loss: 1.212 Vali Loss: 6.300 Vali Acc: 0.132 Test Loss: 6.300 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.2801789
	speed: 2.2070s/iter; left time: 6239.2350s
Epoch: 12 cost time: 118.97221803665161
Epoch: 12, Steps: 154 | Train Loss: 1.161 Vali Loss: 2.789 Vali Acc: 0.260 Test Loss: 2.789 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3337388483373885
model parameter : 37560334
model size : 145.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8564650
	speed: 0.3667s/iter; left time: 1657.7112s
Epoch: 1 cost time: 55.9745454788208
Epoch: 1, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.196 Vali Acc: 0.336 Test Loss: 2.196 Test Acc: 0.336
Validation loss decreased (inf --> -0.336150).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5581059
	speed: 0.9849s/iter; left time: 4301.2616s
Epoch: 2 cost time: 49.2234365940094
Epoch: 2, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.268 Vali Acc: 0.349 Test Loss: 2.268 Test Acc: 0.349
Validation loss decreased (-0.336150 --> -0.349126).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3499955
	speed: 1.0773s/iter; left time: 4538.6522s
Epoch: 3 cost time: 49.48568677902222
Epoch: 3, Steps: 154 | Train Loss: 1.704 Vali Loss: 4.541 Vali Acc: 0.078 Test Loss: 4.541 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9872906
	speed: 0.9653s/iter; left time: 3918.2029s
Epoch: 4 cost time: 46.62986445426941
Epoch: 4, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.760 Vali Acc: 0.187 Test Loss: 2.760 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.8700149
	speed: 0.8957s/iter; left time: 3497.7927s
Epoch: 5 cost time: 44.046836614608765
Epoch: 5, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.578 Vali Acc: 0.361 Test Loss: 2.578 Test Acc: 0.361
Validation loss decreased (-0.349126 --> -0.360477).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7927529
	speed: 0.7900s/iter; left time: 2963.3495s
Epoch: 6 cost time: 42.92505359649658
Epoch: 6, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.586 Vali Acc: 0.219 Test Loss: 2.586 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5189629
	speed: 0.7898s/iter; left time: 2840.8430s
Epoch: 7 cost time: 40.168503522872925
Epoch: 7, Steps: 154 | Train Loss: 1.361 Vali Loss: 2.675 Vali Acc: 0.188 Test Loss: 2.675 Test Acc: 0.188
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.7628300
	speed: 0.8094s/iter; left time: 2786.8378s
Epoch: 8 cost time: 39.100332498550415
Epoch: 8, Steps: 154 | Train Loss: 1.341 Vali Loss: 5.106 Vali Acc: 0.089 Test Loss: 5.106 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3348459
	speed: 0.8089s/iter; left time: 2660.5852s
Epoch: 9 cost time: 40.90955400466919
Epoch: 9, Steps: 154 | Train Loss: 1.250 Vali Loss: 4.455 Vali Acc: 0.217 Test Loss: 4.455 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5872592
	speed: 0.9038s/iter; left time: 2833.4878s
Epoch: 10 cost time: 48.056599378585815
Epoch: 10, Steps: 154 | Train Loss: 1.139 Vali Loss: 5.316 Vali Acc: 0.098 Test Loss: 5.316 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4140793
	speed: 0.9130s/iter; left time: 2721.7766s
Epoch: 11 cost time: 47.89506554603577
Epoch: 11, Steps: 154 | Train Loss: 1.112 Vali Loss: 6.144 Vali Acc: 0.088 Test Loss: 6.144 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3224655
	speed: 0.9110s/iter; left time: 2575.3458s
Epoch: 12 cost time: 45.00439476966858
Epoch: 12, Steps: 154 | Train Loss: 1.002 Vali Loss: 7.800 Vali Acc: 0.097 Test Loss: 7.800 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3106644
	speed: 0.9203s/iter; left time: 2459.8922s
Epoch: 13 cost time: 42.732755184173584
Epoch: 13, Steps: 154 | Train Loss: 0.954 Vali Loss: 5.651 Vali Acc: 0.108 Test Loss: 5.651 Test Acc: 0.108
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.8773820
	speed: 0.8830s/iter; left time: 2224.2353s
Epoch: 14 cost time: 36.96536064147949
Epoch: 14, Steps: 154 | Train Loss: 0.903 Vali Loss: 6.353 Vali Acc: 0.103 Test Loss: 6.353 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.4886529
	speed: 0.7900s/iter; left time: 1868.2515s
Epoch: 15 cost time: 39.83540892601013
Epoch: 15, Steps: 154 | Train Loss: 0.882 Vali Loss: 7.940 Vali Acc: 0.099 Test Loss: 7.940 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3605028386050284
model parameter : 11081742
model size : 44.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9989433
	speed: 0.4908s/iter; left time: 2218.7567s
Epoch: 1 cost time: 78.6458489894867
Epoch: 1, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.440 Vali Acc: 0.335 Test Loss: 2.440 Test Acc: 0.335
Validation loss decreased (inf --> -0.335337).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6873783
	speed: 1.4416s/iter; left time: 6295.3430s
Epoch: 2 cost time: 79.99384307861328
Epoch: 2, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.232 Vali Acc: 0.305 Test Loss: 2.232 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8343295
	speed: 1.5388s/iter; left time: 6483.1577s
Epoch: 3 cost time: 88.39910912513733
Epoch: 3, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.103 Vali Acc: 0.361 Test Loss: 2.103 Test Acc: 0.361
Validation loss decreased (-0.335337 --> -0.360887).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9999471
	speed: 1.7189s/iter; left time: 6977.1446s
Epoch: 4 cost time: 92.42605113983154
Epoch: 4, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.084 Vali Acc: 0.385 Test Loss: 2.084 Test Acc: 0.385
Validation loss decreased (-0.360887 --> -0.384813).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6759841
	speed: 1.5843s/iter; left time: 6186.7947s
Epoch: 5 cost time: 78.04454064369202
Epoch: 5, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.284 Vali Acc: 0.333 Test Loss: 2.284 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9687455
	speed: 1.4151s/iter; left time: 5308.0871s
Epoch: 6 cost time: 76.34594106674194
Epoch: 6, Steps: 154 | Train Loss: 1.497 Vali Loss: 3.066 Vali Acc: 0.217 Test Loss: 3.066 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3840871
	speed: 1.4253s/iter; left time: 5126.8910s
Epoch: 7 cost time: 75.52673554420471
Epoch: 7, Steps: 154 | Train Loss: 1.435 Vali Loss: 4.791 Vali Acc: 0.103 Test Loss: 4.791 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.7516026
	speed: 1.5887s/iter; left time: 5469.8395s
Epoch: 8 cost time: 87.85312390327454
Epoch: 8, Steps: 154 | Train Loss: 1.378 Vali Loss: 7.648 Vali Acc: 0.081 Test Loss: 7.648 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.4473792
	speed: 1.6294s/iter; left time: 5358.9452s
Epoch: 9 cost time: 88.16900515556335
Epoch: 9, Steps: 154 | Train Loss: 1.342 Vali Loss: 4.171 Vali Acc: 0.206 Test Loss: 4.171 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0692070
	speed: 1.6034s/iter; left time: 5026.5999s
Epoch: 10 cost time: 80.48585557937622
Epoch: 10, Steps: 154 | Train Loss: 1.299 Vali Loss: 4.228 Vali Acc: 0.085 Test Loss: 4.228 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3252269
	speed: 1.3812s/iter; left time: 4117.4953s
Epoch: 11 cost time: 75.8565092086792
Epoch: 11, Steps: 154 | Train Loss: 1.229 Vali Loss: 3.744 Vali Acc: 0.094 Test Loss: 3.744 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.0329876
	speed: 1.3591s/iter; left time: 3842.1756s
Epoch: 12 cost time: 73.94678616523743
Epoch: 12, Steps: 154 | Train Loss: 1.174 Vali Loss: 4.582 Vali Acc: 0.101 Test Loss: 4.582 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.9239039
	speed: 1.5906s/iter; left time: 4251.7881s
Epoch: 13 cost time: 95.93606233596802
Epoch: 13, Steps: 154 | Train Loss: 1.147 Vali Loss: 4.391 Vali Acc: 0.207 Test Loss: 4.391 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.0695479
	speed: 1.8051s/iter; left time: 4547.0728s
Epoch: 14 cost time: 98.02259707450867
Epoch: 14, Steps: 154 | Train Loss: 1.110 Vali Loss: 3.310 Vali Acc: 0.116 Test Loss: 3.310 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3848337388483374
model parameter : 37560334
model size : 145.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8780243
	speed: 0.2613s/iter; left time: 1181.4176s
Epoch: 1 cost time: 39.100937604904175
Epoch: 1, Steps: 154 | Train Loss: 2.096 Vali Loss: 2.196 Vali Acc: 0.338 Test Loss: 2.196 Test Acc: 0.338
Validation loss decreased (inf --> -0.338178).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6145974
	speed: 0.7145s/iter; left time: 3120.2137s
Epoch: 2 cost time: 34.431209325790405
Epoch: 2, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.297 Vali Acc: 0.355 Test Loss: 2.297 Test Acc: 0.355
Validation loss decreased (-0.338178 --> -0.355208).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4125047
	speed: 0.7371s/iter; left time: 3105.3199s
Epoch: 3 cost time: 34.082252502441406
Epoch: 3, Steps: 154 | Train Loss: 1.697 Vali Loss: 4.171 Vali Acc: 0.077 Test Loss: 4.171 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7470589
	speed: 0.6585s/iter; left time: 2672.8517s
Epoch: 4 cost time: 32.80851697921753
Epoch: 4, Steps: 154 | Train Loss: 1.590 Vali Loss: 3.452 Vali Acc: 0.180 Test Loss: 3.452 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.1169159
	speed: 0.7327s/iter; left time: 2861.3673s
Epoch: 5 cost time: 35.548203229904175
Epoch: 5, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.232 Vali Acc: 0.329 Test Loss: 2.232 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.6166867
	speed: 0.6603s/iter; left time: 2476.6965s
Epoch: 6 cost time: 31.57630729675293
Epoch: 6, Steps: 154 | Train Loss: 1.444 Vali Loss: 4.567 Vali Acc: 0.088 Test Loss: 4.567 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.3821452
	speed: 0.7471s/iter; left time: 2687.3317s
Epoch: 7 cost time: 40.48506999015808
Epoch: 7, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.760 Vali Acc: 0.200 Test Loss: 2.760 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.5273643
	speed: 0.8003s/iter; left time: 2755.3792s
Epoch: 8 cost time: 37.36445927619934
Epoch: 8, Steps: 154 | Train Loss: 1.308 Vali Loss: 6.704 Vali Acc: 0.112 Test Loss: 6.704 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.2308373
	speed: 0.8220s/iter; left time: 2703.6788s
Epoch: 9 cost time: 41.242172718048096
Epoch: 9, Steps: 154 | Train Loss: 1.286 Vali Loss: 4.182 Vali Acc: 0.125 Test Loss: 4.182 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.6604975
	speed: 0.8251s/iter; left time: 2586.6025s
Epoch: 10 cost time: 37.67794489860535
Epoch: 10, Steps: 154 | Train Loss: 1.177 Vali Loss: 5.512 Vali Acc: 0.095 Test Loss: 5.512 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.0272065
	speed: 0.8045s/iter; left time: 2398.0756s
Epoch: 11 cost time: 41.470616817474365
Epoch: 11, Steps: 154 | Train Loss: 1.108 Vali Loss: 5.104 Vali Acc: 0.110 Test Loss: 5.104 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.6269007
	speed: 0.8455s/iter; left time: 2390.3617s
Epoch: 12 cost time: 38.36385250091553
Epoch: 12, Steps: 154 | Train Loss: 1.065 Vali Loss: 9.911 Vali Acc: 0.087 Test Loss: 9.911 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35523114355231145
model parameter : 11081742
model size : 44.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0170310
	speed: 0.3669s/iter; left time: 1658.7596s
Epoch: 1 cost time: 55.75797986984253
Epoch: 1, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.295 Vali Acc: 0.330 Test Loss: 2.295 Test Acc: 0.330
Validation loss decreased (inf --> -0.330472).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6985643
	speed: 0.9348s/iter; left time: 4082.2511s
Epoch: 2 cost time: 48.08290433883667
Epoch: 2, Steps: 154 | Train Loss: 1.916 Vali Loss: 2.325 Vali Acc: 0.109 Test Loss: 2.325 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9508742
	speed: 0.9793s/iter; left time: 4125.8149s
Epoch: 3 cost time: 53.47798252105713
Epoch: 3, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.135 Vali Acc: 0.363 Test Loss: 2.135 Test Acc: 0.363
Validation loss decreased (-0.330472 --> -0.363320).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8341726
	speed: 0.9334s/iter; left time: 3788.6257s
Epoch: 4 cost time: 51.62276363372803
Epoch: 4, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.069 Vali Acc: 0.370 Test Loss: 2.069 Test Acc: 0.370
Validation loss decreased (-0.363320 --> -0.369809).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3427732
	speed: 1.1228s/iter; left time: 4384.7241s
Epoch: 5 cost time: 57.732260942459106
Epoch: 5, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.145 Vali Acc: 0.376 Test Loss: 2.145 Test Acc: 0.376
Validation loss decreased (-0.369809 --> -0.375891).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8345138
	speed: 1.0962s/iter; left time: 4111.8087s
Epoch: 6 cost time: 61.54927182197571
Epoch: 6, Steps: 154 | Train Loss: 1.578 Vali Loss: 4.451 Vali Acc: 0.118 Test Loss: 4.451 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7646269
	speed: 1.1008s/iter; left time: 3959.5004s
Epoch: 7 cost time: 56.39633893966675
Epoch: 7, Steps: 154 | Train Loss: 1.551 Vali Loss: 3.042 Vali Acc: 0.144 Test Loss: 3.042 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8613484
	speed: 1.0691s/iter; left time: 3680.8871s
Epoch: 8 cost time: 55.139501094818115
Epoch: 8, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.822 Vali Acc: 0.354 Test Loss: 2.822 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7964902
	speed: 0.8929s/iter; left time: 2936.5964s
Epoch: 9 cost time: 43.06309676170349
Epoch: 9, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.551 Vali Acc: 0.229 Test Loss: 3.551 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2741662
	speed: 0.8830s/iter; left time: 2768.2931s
Epoch: 10 cost time: 47.5441255569458
Epoch: 10, Steps: 154 | Train Loss: 1.318 Vali Loss: 5.252 Vali Acc: 0.190 Test Loss: 5.252 Test Acc: 0.190
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4104081
	speed: 0.8065s/iter; left time: 2404.3045s
Epoch: 11 cost time: 46.211158752441406
Epoch: 11, Steps: 154 | Train Loss: 1.324 Vali Loss: 5.008 Vali Acc: 0.090 Test Loss: 5.008 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.0650772
	speed: 0.8873s/iter; left time: 2508.4978s
Epoch: 12 cost time: 44.9320502281189
Epoch: 12, Steps: 154 | Train Loss: 1.232 Vali Loss: 6.815 Vali Acc: 0.092 Test Loss: 6.815 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.8580674
	speed: 0.8793s/iter; left time: 2350.2966s
Epoch: 13 cost time: 56.12751245498657
Epoch: 13, Steps: 154 | Train Loss: 1.150 Vali Loss: 6.512 Vali Acc: 0.209 Test Loss: 6.512 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 2.0165129
	speed: 1.0065s/iter; left time: 2535.4545s
Epoch: 14 cost time: 51.130897998809814
Epoch: 14, Steps: 154 | Train Loss: 1.092 Vali Loss: 6.450 Vali Acc: 0.088 Test Loss: 6.450 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.6398576
	speed: 1.0046s/iter; left time: 2375.9695s
Epoch: 15 cost time: 56.34114170074463
Epoch: 15, Steps: 154 | Train Loss: 1.072 Vali Loss: 6.135 Vali Acc: 0.372 Test Loss: 6.135 Test Acc: 0.372
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3759124087591241
model parameter : 37560334
model size : 145.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8798563
	speed: 0.1764s/iter; left time: 797.3735s
Epoch: 1 cost time: 26.99497103691101
Epoch: 1, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.153 Vali Acc: 0.338 Test Loss: 2.153 Test Acc: 0.338
Validation loss decreased (inf --> -0.337772).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5471447
	speed: 0.5919s/iter; left time: 2584.8500s
Epoch: 2 cost time: 26.88958239555359
Epoch: 2, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.229 Vali Acc: 0.354 Test Loss: 2.229 Test Acc: 0.354
Validation loss decreased (-0.337772 --> -0.353587).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2954677
	speed: 0.4838s/iter; left time: 2038.2779s
Epoch: 3 cost time: 19.946300506591797
Epoch: 3, Steps: 154 | Train Loss: 1.759 Vali Loss: 3.061 Vali Acc: 0.089 Test Loss: 3.061 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9796963
	speed: 0.4486s/iter; left time: 1820.7212s
Epoch: 4 cost time: 22.956082344055176
Epoch: 4, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.747 Vali Acc: 0.138 Test Loss: 2.747 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.8326312
	speed: 0.5058s/iter; left time: 1975.1132s
Epoch: 5 cost time: 23.060152292251587
Epoch: 5, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.373 Vali Acc: 0.358 Test Loss: 2.373 Test Acc: 0.358
Validation loss decreased (-0.353587 --> -0.358046).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6541786
	speed: 0.4477s/iter; left time: 1679.4353s
Epoch: 6 cost time: 19.984548568725586
Epoch: 6, Steps: 154 | Train Loss: 1.523 Vali Loss: 3.097 Vali Acc: 0.223 Test Loss: 3.097 Test Acc: 0.223
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4539587
	speed: 0.4623s/iter; left time: 1662.8066s
Epoch: 7 cost time: 23.15065360069275
Epoch: 7, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.265 Vali Acc: 0.237 Test Loss: 2.265 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8763695
	speed: 0.5028s/iter; left time: 1731.2310s
Epoch: 8 cost time: 21.913666486740112
Epoch: 8, Steps: 154 | Train Loss: 1.411 Vali Loss: 9.250 Vali Acc: 0.099 Test Loss: 9.250 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1262176
	speed: 0.4273s/iter; left time: 1405.2379s
Epoch: 9 cost time: 20.10962224006653
Epoch: 9, Steps: 154 | Train Loss: 1.364 Vali Loss: 4.410 Vali Acc: 0.135 Test Loss: 4.410 Test Acc: 0.135
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5314875
	speed: 0.4550s/iter; left time: 1426.4982s
Epoch: 10 cost time: 19.71170687675476
Epoch: 10, Steps: 154 | Train Loss: 1.236 Vali Loss: 2.934 Vali Acc: 0.373 Test Loss: 2.934 Test Acc: 0.373
Validation loss decreased (-0.358046 --> -0.372639).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9377673
	speed: 0.4044s/iter; left time: 1205.4524s
Epoch: 11 cost time: 21.653953790664673
Epoch: 11, Steps: 154 | Train Loss: 1.146 Vali Loss: 4.357 Vali Acc: 0.182 Test Loss: 4.357 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4067882
	speed: 0.3812s/iter; left time: 1077.6700s
Epoch: 12 cost time: 13.374541759490967
Epoch: 12, Steps: 154 | Train Loss: 1.085 Vali Loss: 7.568 Vali Acc: 0.087 Test Loss: 7.568 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6973361
	speed: 0.4838s/iter; left time: 1293.1532s
Epoch: 13 cost time: 26.153842449188232
Epoch: 13, Steps: 154 | Train Loss: 1.074 Vali Loss: 8.961 Vali Acc: 0.099 Test Loss: 8.961 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9272671
	speed: 0.5212s/iter; left time: 1312.8839s
Epoch: 14 cost time: 24.571436166763306
Epoch: 14, Steps: 154 | Train Loss: 1.060 Vali Loss: 8.291 Vali Acc: 0.089 Test Loss: 8.291 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.8209893
	speed: 0.5697s/iter; left time: 1347.2673s
Epoch: 15 cost time: 23.753918170928955
Epoch: 15, Steps: 154 | Train Loss: 0.920 Vali Loss: 10.323 Vali Acc: 0.094 Test Loss: 10.323 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.6678336
	speed: 0.5283s/iter; left time: 1168.0082s
Epoch: 16 cost time: 26.55248475074768
Epoch: 16, Steps: 154 | Train Loss: 0.948 Vali Loss: 13.022 Vali Acc: 0.075 Test Loss: 13.022 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.1557750
	speed: 0.5474s/iter; left time: 1125.9664s
Epoch: 17 cost time: 23.18035864830017
Epoch: 17, Steps: 154 | Train Loss: 0.866 Vali Loss: 14.868 Vali Acc: 0.085 Test Loss: 14.868 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.5957118
	speed: 0.5573s/iter; left time: 1060.5204s
Epoch: 18 cost time: 26.617356538772583
Epoch: 18, Steps: 154 | Train Loss: 0.847 Vali Loss: 8.965 Vali Acc: 0.094 Test Loss: 8.965 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.2521815
	speed: 0.5290s/iter; left time: 925.1401s
Epoch: 19 cost time: 23.769970893859863
Epoch: 19, Steps: 154 | Train Loss: 0.775 Vali Loss: 12.814 Vali Acc: 0.086 Test Loss: 12.814 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0608366
	speed: 0.5728s/iter; left time: 913.5907s
Epoch: 20 cost time: 24.558768272399902
Epoch: 20, Steps: 154 | Train Loss: 0.753 Vali Loss: 12.103 Vali Acc: 0.100 Test Loss: 12.103 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 11081742
model size : 44.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3671393
	speed: 0.9231s/iter; left time: 4173.1527s
Epoch: 1 cost time: 143.23075318336487
Epoch: 1, Steps: 154 | Train Loss: 2.102 Vali Loss: 2.110 Vali Acc: 0.333 Test Loss: 2.110 Test Acc: 0.333
Validation loss decreased (inf --> -0.332501).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2074296
	speed: 2.3654s/iter; left time: 10329.5424s
Epoch: 2 cost time: 116.83908915519714
Epoch: 2, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.076 Vali Acc: 0.343 Test Loss: 2.076 Test Acc: 0.343
Validation loss decreased (-0.332501 --> -0.343450).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3791263
	speed: 2.2381s/iter; left time: 9429.1705s
Epoch: 3 cost time: 124.47285437583923
Epoch: 3, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.298 Vali Acc: 0.345 Test Loss: 2.298 Test Acc: 0.345
Validation loss decreased (-0.343450 --> -0.345070).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7957386
	speed: 2.5796s/iter; left time: 10470.4905s
Epoch: 4 cost time: 134.7940604686737
Epoch: 4, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.253 Vali Acc: 0.348 Test Loss: 2.253 Test Acc: 0.348
Validation loss decreased (-0.345070 --> -0.348315).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2447323
	speed: 2.5415s/iter; left time: 9924.6436s
Epoch: 5 cost time: 134.26016235351562
Epoch: 5, Steps: 154 | Train Loss: 1.660 Vali Loss: 3.482 Vali Acc: 0.088 Test Loss: 3.482 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8751410
	speed: 2.5718s/iter; left time: 9646.8773s
Epoch: 6 cost time: 125.52686405181885
Epoch: 6, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.404 Vali Acc: 0.343 Test Loss: 2.404 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7902393
	speed: 2.3607s/iter; left time: 8491.3274s
Epoch: 7 cost time: 122.69252634048462
Epoch: 7, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.707 Vali Acc: 0.202 Test Loss: 2.707 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.7547632
	speed: 2.4634s/iter; left time: 8481.3912s
Epoch: 8 cost time: 139.82505774497986
Epoch: 8, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.628 Vali Acc: 0.325 Test Loss: 2.628 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.3151090
	speed: 2.7016s/iter; left time: 8885.6325s
Epoch: 9 cost time: 141.93477749824524
Epoch: 9, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.898 Vali Acc: 0.206 Test Loss: 2.898 Test Acc: 0.206
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.1972337
	speed: 2.7021s/iter; left time: 8471.0116s
Epoch: 10 cost time: 142.31351041793823
Epoch: 10, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.960 Vali Acc: 0.131 Test Loss: 2.960 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.1483963
	speed: 2.6397s/iter; left time: 7868.9249s
Epoch: 11 cost time: 135.22742414474487
Epoch: 11, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.618 Vali Acc: 0.384 Test Loss: 2.618 Test Acc: 0.384
Validation loss decreased (-0.348315 --> -0.383997).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3225471
	speed: 2.5930s/iter; left time: 7330.5420s
Epoch: 12 cost time: 136.24161314964294
Epoch: 12, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.287 Vali Acc: 0.163 Test Loss: 3.287 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4671854
	speed: 2.8036s/iter; left time: 7493.9573s
Epoch: 13 cost time: 152.58014607429504
Epoch: 13, Steps: 154 | Train Loss: 1.209 Vali Loss: 7.048 Vali Acc: 0.122 Test Loss: 7.048 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4923418
	speed: 2.9458s/iter; left time: 7420.4575s
Epoch: 14 cost time: 152.8770134449005
Epoch: 14, Steps: 154 | Train Loss: 1.155 Vali Loss: 4.841 Vali Acc: 0.094 Test Loss: 4.841 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.0360138
	speed: 2.9458s/iter; left time: 6966.8531s
Epoch: 15 cost time: 149.04370188713074
Epoch: 15, Steps: 154 | Train Loss: 1.090 Vali Loss: 3.247 Vali Acc: 0.307 Test Loss: 3.247 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2231507
	speed: 2.5897s/iter; left time: 5725.7304s
Epoch: 16 cost time: 135.17016100883484
Epoch: 16, Steps: 154 | Train Loss: 1.085 Vali Loss: 4.437 Vali Acc: 0.174 Test Loss: 4.437 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0975507
	speed: 2.5800s/iter; left time: 5307.0376s
Epoch: 17 cost time: 143.25830817222595
Epoch: 17, Steps: 154 | Train Loss: 1.073 Vali Loss: 4.879 Vali Acc: 0.202 Test Loss: 4.879 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8467999
	speed: 2.7670s/iter; left time: 5265.6229s
Epoch: 18 cost time: 142.15378379821777
Epoch: 18, Steps: 154 | Train Loss: 0.974 Vali Loss: 4.500 Vali Acc: 0.109 Test Loss: 4.500 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0834967
	speed: 2.7273s/iter; left time: 4770.0309s
Epoch: 19 cost time: 145.9061782360077
Epoch: 19, Steps: 154 | Train Loss: 0.952 Vali Loss: 5.782 Vali Acc: 0.099 Test Loss: 5.782 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.1380082
	speed: 2.6706s/iter; left time: 4259.6438s
Epoch: 20 cost time: 128.9285101890564
Epoch: 20, Steps: 154 | Train Loss: 0.938 Vali Loss: 3.943 Vali Acc: 0.189 Test Loss: 3.943 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1539738
	speed: 2.3837s/iter; left time: 3434.8837s
Epoch: 21 cost time: 124.87539553642273
Epoch: 21, Steps: 154 | Train Loss: 0.875 Vali Loss: 4.801 Vali Acc: 0.129 Test Loss: 4.801 Test Acc: 0.129
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3840227088402271
model parameter : 37528078
model size : 144.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0109324
	speed: 0.3425s/iter; left time: 1548.3245s
Epoch: 1 cost time: 52.03273153305054
Epoch: 1, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.118 Vali Acc: 0.337 Test Loss: 2.118 Test Acc: 0.337
Validation loss decreased (inf --> -0.336962).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8557094
	speed: 1.0320s/iter; left time: 4506.6913s
Epoch: 2 cost time: 53.04238247871399
Epoch: 2, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.304 Vali Acc: 0.330 Test Loss: 2.304 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4022413
	speed: 1.0726s/iter; left time: 4518.6730s
Epoch: 3 cost time: 53.78815770149231
Epoch: 3, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.241 Vali Acc: 0.347 Test Loss: 2.241 Test Acc: 0.347
Validation loss decreased (-0.336962 --> -0.346693).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2587095
	speed: 1.0667s/iter; left time: 4329.7311s
Epoch: 4 cost time: 55.61095595359802
Epoch: 4, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.459 Vali Acc: 0.296 Test Loss: 2.459 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6569672
	speed: 1.0087s/iter; left time: 3938.8368s
Epoch: 5 cost time: 51.9782919883728
Epoch: 5, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.523 Vali Acc: 0.202 Test Loss: 2.523 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.9541510
	speed: 1.1147s/iter; left time: 4181.1377s
Epoch: 6 cost time: 57.40044689178467
Epoch: 6, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.121 Vali Acc: 0.373 Test Loss: 2.121 Test Acc: 0.373
Validation loss decreased (-0.346693 --> -0.372647).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8039894
	speed: 1.0139s/iter; left time: 3646.8850s
Epoch: 7 cost time: 49.93027639389038
Epoch: 7, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.926 Vali Acc: 0.200 Test Loss: 2.926 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5618266
	speed: 0.9508s/iter; left time: 3273.6038s
Epoch: 8 cost time: 47.3541624546051
Epoch: 8, Steps: 154 | Train Loss: 1.398 Vali Loss: 7.075 Vali Acc: 0.128 Test Loss: 7.075 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9781086
	speed: 0.9162s/iter; left time: 3013.2637s
Epoch: 9 cost time: 46.319738149642944
Epoch: 9, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.555 Vali Acc: 0.221 Test Loss: 3.555 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2289106
	speed: 0.9276s/iter; left time: 2908.0820s
Epoch: 10 cost time: 43.73225426673889
Epoch: 10, Steps: 154 | Train Loss: 1.312 Vali Loss: 5.207 Vali Acc: 0.145 Test Loss: 5.207 Test Acc: 0.145
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6270744
	speed: 0.9396s/iter; left time: 2801.0117s
Epoch: 11 cost time: 47.90378785133362
Epoch: 11, Steps: 154 | Train Loss: 1.255 Vali Loss: 4.770 Vali Acc: 0.092 Test Loss: 4.770 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.9629502
	speed: 1.0558s/iter; left time: 2984.7895s
Epoch: 12 cost time: 53.94794797897339
Epoch: 12, Steps: 154 | Train Loss: 1.171 Vali Loss: 9.481 Vali Acc: 0.125 Test Loss: 9.481 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1333059
	speed: 1.1120s/iter; left time: 2972.2814s
Epoch: 13 cost time: 56.64515948295593
Epoch: 13, Steps: 154 | Train Loss: 1.145 Vali Loss: 6.409 Vali Acc: 0.140 Test Loss: 6.409 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.0757086
	speed: 1.0828s/iter; left time: 2727.6761s
Epoch: 14 cost time: 56.09067702293396
Epoch: 14, Steps: 154 | Train Loss: 1.082 Vali Loss: 7.829 Vali Acc: 0.123 Test Loss: 7.829 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7956067
	speed: 1.0753s/iter; left time: 2543.0753s
Epoch: 15 cost time: 52.63285708427429
Epoch: 15, Steps: 154 | Train Loss: 1.014 Vali Loss: 6.809 Vali Acc: 0.104 Test Loss: 6.809 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.4595922
	speed: 1.0608s/iter; left time: 2345.5301s
Epoch: 16 cost time: 52.31108474731445
Epoch: 16, Steps: 154 | Train Loss: 0.985 Vali Loss: 4.715 Vali Acc: 0.120 Test Loss: 4.715 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 11048974
model size : 43.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4420218
	speed: 0.6606s/iter; left time: 2986.4705s
Epoch: 1 cost time: 97.43919658660889
Epoch: 1, Steps: 154 | Train Loss: 2.111 Vali Loss: 2.117 Vali Acc: 0.328 Test Loss: 2.117 Test Acc: 0.328
Validation loss decreased (inf --> -0.328040).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9133756
	speed: 1.6537s/iter; left time: 7221.8941s
Epoch: 2 cost time: 88.66681861877441
Epoch: 2, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.143 Vali Acc: 0.344 Test Loss: 2.143 Test Acc: 0.344
Validation loss decreased (-0.328040 --> -0.344261).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3152376
	speed: 1.6354s/iter; left time: 6890.0037s
Epoch: 3 cost time: 87.32426404953003
Epoch: 3, Steps: 154 | Train Loss: 1.845 Vali Loss: 2.421 Vali Acc: 0.345 Test Loss: 2.421 Test Acc: 0.345
Validation loss decreased (-0.344261 --> -0.345069).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6927879
	speed: 1.6469s/iter; left time: 6684.7713s
Epoch: 4 cost time: 91.08471012115479
Epoch: 4, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.345 Vali Acc: 0.364 Test Loss: 2.345 Test Acc: 0.364
Validation loss decreased (-0.345069 --> -0.363724).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2476401
	speed: 1.7117s/iter; left time: 6684.1914s
Epoch: 5 cost time: 86.9269630908966
Epoch: 5, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.381 Vali Acc: 0.351 Test Loss: 2.381 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7925153
	speed: 1.5662s/iter; left time: 5874.7447s
Epoch: 6 cost time: 84.62683939933777
Epoch: 6, Steps: 154 | Train Loss: 1.580 Vali Loss: 2.125 Vali Acc: 0.380 Test Loss: 2.125 Test Acc: 0.380
Validation loss decreased (-0.363724 --> -0.379946).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8450499
	speed: 1.5890s/iter; left time: 5715.5899s
Epoch: 7 cost time: 82.58070421218872
Epoch: 7, Steps: 154 | Train Loss: 1.579 Vali Loss: 3.660 Vali Acc: 0.197 Test Loss: 3.660 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6119589
	speed: 1.4527s/iter; left time: 5001.6114s
Epoch: 8 cost time: 71.49225735664368
Epoch: 8, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.701 Vali Acc: 0.360 Test Loss: 2.701 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6324697
	speed: 1.3158s/iter; left time: 4327.6354s
Epoch: 9 cost time: 70.41143822669983
Epoch: 9, Steps: 154 | Train Loss: 1.430 Vali Loss: 4.209 Vali Acc: 0.202 Test Loss: 4.209 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2022121
	speed: 1.3382s/iter; left time: 4195.3869s
Epoch: 10 cost time: 69.02747082710266
Epoch: 10, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.564 Vali Acc: 0.368 Test Loss: 2.564 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.0941056
	speed: 1.4272s/iter; left time: 4254.4193s
Epoch: 11 cost time: 79.722491979599
Epoch: 11, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.116 Vali Acc: 0.401 Test Loss: 2.116 Test Acc: 0.401
Validation loss decreased (-0.379946 --> -0.401033).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4970874
	speed: 1.6925s/iter; left time: 4784.6298s
Epoch: 12 cost time: 93.45896172523499
Epoch: 12, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.204 Vali Acc: 0.370 Test Loss: 2.204 Test Acc: 0.370
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6101491
	speed: 1.7244s/iter; left time: 4609.3536s
Epoch: 13 cost time: 91.41256260871887
Epoch: 13, Steps: 154 | Train Loss: 1.286 Vali Loss: 4.559 Vali Acc: 0.234 Test Loss: 4.559 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2793967
	speed: 1.7025s/iter; left time: 4288.5496s
Epoch: 14 cost time: 90.7841727733612
Epoch: 14, Steps: 154 | Train Loss: 1.187 Vali Loss: 5.985 Vali Acc: 0.084 Test Loss: 5.985 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.0320523
	speed: 1.6026s/iter; left time: 3790.1934s
Epoch: 15 cost time: 81.33277559280396
Epoch: 15, Steps: 154 | Train Loss: 1.152 Vali Loss: 4.826 Vali Acc: 0.122 Test Loss: 4.826 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0721711
	speed: 1.4864s/iter; left time: 3286.4184s
Epoch: 16 cost time: 78.07923412322998
Epoch: 16, Steps: 154 | Train Loss: 1.131 Vali Loss: 3.261 Vali Acc: 0.283 Test Loss: 3.261 Test Acc: 0.283
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1068730
	speed: 1.4993s/iter; left time: 3083.9735s
Epoch: 17 cost time: 81.59142470359802
Epoch: 17, Steps: 154 | Train Loss: 1.066 Vali Loss: 6.801 Vali Acc: 0.103 Test Loss: 6.801 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9265139
	speed: 1.7071s/iter; left time: 3248.6523s
Epoch: 18 cost time: 92.55396270751953
Epoch: 18, Steps: 154 | Train Loss: 1.073 Vali Loss: 6.014 Vali Acc: 0.146 Test Loss: 6.014 Test Acc: 0.146
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.9532964
	speed: 1.7109s/iter; left time: 2992.4413s
Epoch: 19 cost time: 90.3726863861084
Epoch: 19, Steps: 154 | Train Loss: 1.005 Vali Loss: 6.410 Vali Acc: 0.101 Test Loss: 6.410 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.9861599
	speed: 1.7483s/iter; left time: 2788.5961s
Epoch: 20 cost time: 93.37427878379822
Epoch: 20, Steps: 154 | Train Loss: 0.989 Vali Loss: 4.524 Vali Acc: 0.143 Test Loss: 4.524 Test Acc: 0.143
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.0477797
	speed: 1.7347s/iter; left time: 2499.7141s
Epoch: 21 cost time: 89.12723970413208
Epoch: 21, Steps: 154 | Train Loss: 0.954 Vali Loss: 5.000 Vali Acc: 0.167 Test Loss: 5.000 Test Acc: 0.167
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4010543390105434
model parameter : 37528078
model size : 144.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9855057
	speed: 0.2296s/iter; left time: 1038.2217s
Epoch: 1 cost time: 34.81597852706909
Epoch: 1, Steps: 154 | Train Loss: 2.079 Vali Loss: 2.085 Vali Acc: 0.339 Test Loss: 2.085 Test Acc: 0.339
Validation loss decreased (inf --> -0.339395).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9106749
	speed: 0.6165s/iter; left time: 2692.4190s
Epoch: 2 cost time: 29.474156141281128
Epoch: 2, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.271 Vali Acc: 0.332 Test Loss: 2.271 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4448347
	speed: 0.6508s/iter; left time: 2741.6896s
Epoch: 3 cost time: 31.548746585845947
Epoch: 3, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.169 Vali Acc: 0.345 Test Loss: 2.169 Test Acc: 0.345
Validation loss decreased (-0.339395 --> -0.345477).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5721778
	speed: 0.6159s/iter; left time: 2499.8781s
Epoch: 4 cost time: 32.835702896118164
Epoch: 4, Steps: 154 | Train Loss: 1.712 Vali Loss: 3.149 Vali Acc: 0.124 Test Loss: 3.149 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6882700
	speed: 0.6534s/iter; left time: 2551.3352s
Epoch: 5 cost time: 32.618743658065796
Epoch: 5, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.579 Vali Acc: 0.204 Test Loss: 2.579 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.1773324
	speed: 0.7891s/iter; left time: 2960.1004s
Epoch: 6 cost time: 40.73611092567444
Epoch: 6, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.706 Vali Acc: 0.366 Test Loss: 2.706 Test Acc: 0.366
Validation loss decreased (-0.345477 --> -0.366153).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7351664
	speed: 0.7566s/iter; left time: 2721.5030s
Epoch: 7 cost time: 39.367172956466675
Epoch: 7, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.713 Vali Acc: 0.204 Test Loss: 2.713 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1733378
	speed: 0.7997s/iter; left time: 2753.3494s
Epoch: 8 cost time: 36.21844148635864
Epoch: 8, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.836 Vali Acc: 0.205 Test Loss: 2.836 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7163714
	speed: 0.7942s/iter; left time: 2612.0501s
Epoch: 9 cost time: 40.8039915561676
Epoch: 9, Steps: 154 | Train Loss: 1.365 Vali Loss: 6.575 Vali Acc: 0.077 Test Loss: 6.575 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5713737
	speed: 0.7702s/iter; left time: 2414.4266s
Epoch: 10 cost time: 38.0875289440155
Epoch: 10, Steps: 154 | Train Loss: 1.327 Vali Loss: 4.610 Vali Acc: 0.146 Test Loss: 4.610 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7171140
	speed: 0.8002s/iter; left time: 2385.5191s
Epoch: 11 cost time: 38.422319173812866
Epoch: 11, Steps: 154 | Train Loss: 1.245 Vali Loss: 8.370 Vali Acc: 0.082 Test Loss: 8.370 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1503549
	speed: 0.7692s/iter; left time: 2174.4611s
Epoch: 12 cost time: 36.82129669189453
Epoch: 12, Steps: 154 | Train Loss: 1.219 Vali Loss: 3.635 Vali Acc: 0.228 Test Loss: 3.635 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0799754
	speed: 0.7182s/iter; left time: 1919.8469s
Epoch: 13 cost time: 36.32573223114014
Epoch: 13, Steps: 154 | Train Loss: 1.186 Vali Loss: 6.966 Vali Acc: 0.100 Test Loss: 6.966 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.3899468
	speed: 0.6398s/iter; left time: 1611.7471s
Epoch: 14 cost time: 31.086653232574463
Epoch: 14, Steps: 154 | Train Loss: 1.120 Vali Loss: 5.856 Vali Acc: 0.098 Test Loss: 5.856 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0079864
	speed: 0.6369s/iter; left time: 1506.2957s
Epoch: 15 cost time: 30.118659734725952
Epoch: 15, Steps: 154 | Train Loss: 1.055 Vali Loss: 9.443 Vali Acc: 0.097 Test Loss: 9.443 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.4686822
	speed: 0.6250s/iter; left time: 1381.8899s
Epoch: 16 cost time: 32.85340332984924
Epoch: 16, Steps: 154 | Train Loss: 1.038 Vali Loss: 5.734 Vali Acc: 0.086 Test Loss: 5.734 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3661800486618005
model parameter : 11048974
model size : 43.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4429080
	speed: 0.3065s/iter; left time: 1385.5795s
Epoch: 1 cost time: 47.37340688705444
Epoch: 1, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.120 Vali Acc: 0.328 Test Loss: 2.120 Test Acc: 0.328
Validation loss decreased (inf --> -0.327635).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7596580
	speed: 0.8467s/iter; left time: 3697.6479s
Epoch: 2 cost time: 48.40366506576538
Epoch: 2, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.241 Vali Acc: 0.339 Test Loss: 2.241 Test Acc: 0.339
Validation loss decreased (-0.327635 --> -0.338583).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7374489
	speed: 0.9478s/iter; left time: 3992.9851s
Epoch: 3 cost time: 54.82356262207031
Epoch: 3, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.184 Vali Acc: 0.359 Test Loss: 2.184 Test Acc: 0.359
Validation loss decreased (-0.338583 --> -0.358859).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8020761
	speed: 0.9705s/iter; left time: 3939.4041s
Epoch: 4 cost time: 52.4913375377655
Epoch: 4, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.133 Vali Acc: 0.362 Test Loss: 2.133 Test Acc: 0.362
Validation loss decreased (-0.358859 --> -0.362104).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2931010
	speed: 0.9770s/iter; left time: 3815.3773s
Epoch: 5 cost time: 53.11795783042908
Epoch: 5, Steps: 154 | Train Loss: 1.641 Vali Loss: 3.500 Vali Acc: 0.114 Test Loss: 3.500 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7742885
	speed: 0.9775s/iter; left time: 3666.7219s
Epoch: 6 cost time: 53.5465087890625
Epoch: 6, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.286 Vali Acc: 0.227 Test Loss: 2.286 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8530682
	speed: 0.9750s/iter; left time: 3507.0234s
Epoch: 7 cost time: 51.32155442237854
Epoch: 7, Steps: 154 | Train Loss: 1.524 Vali Loss: 3.549 Vali Acc: 0.192 Test Loss: 3.549 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4907091
	speed: 0.9583s/iter; left time: 3299.5005s
Epoch: 8 cost time: 49.42822742462158
Epoch: 8, Steps: 154 | Train Loss: 1.556 Vali Loss: 4.466 Vali Acc: 0.106 Test Loss: 4.466 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.4824042
	speed: 0.9419s/iter; left time: 3097.9995s
Epoch: 9 cost time: 47.442163705825806
Epoch: 9, Steps: 154 | Train Loss: 1.475 Vali Loss: 6.027 Vali Acc: 0.090 Test Loss: 6.027 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.1701038
	speed: 0.8253s/iter; left time: 2587.3127s
Epoch: 10 cost time: 42.430516958236694
Epoch: 10, Steps: 154 | Train Loss: 1.380 Vali Loss: 6.702 Vali Acc: 0.094 Test Loss: 6.702 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.0478979
	speed: 0.8474s/iter; left time: 2526.0670s
Epoch: 11 cost time: 47.27293014526367
Epoch: 11, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.287 Vali Acc: 0.378 Test Loss: 2.287 Test Acc: 0.378
Validation loss decreased (-0.362104 --> -0.377917).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1868262
	speed: 0.8907s/iter; left time: 2517.9846s
Epoch: 12 cost time: 48.12082505226135
Epoch: 12, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.582 Vali Acc: 0.388 Test Loss: 2.582 Test Acc: 0.388
Validation loss decreased (-0.377917 --> -0.388458).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6061442
	speed: 0.9008s/iter; left time: 2407.9668s
Epoch: 13 cost time: 48.09403705596924
Epoch: 13, Steps: 154 | Train Loss: 1.257 Vali Loss: 3.201 Vali Acc: 0.233 Test Loss: 3.201 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3458593
	speed: 0.9541s/iter; left time: 2403.4905s
Epoch: 14 cost time: 54.38600826263428
Epoch: 14, Steps: 154 | Train Loss: 1.185 Vali Loss: 6.544 Vali Acc: 0.102 Test Loss: 6.544 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.9737332
	speed: 1.0142s/iter; left time: 2398.6451s
Epoch: 15 cost time: 53.72040557861328
Epoch: 15, Steps: 154 | Train Loss: 1.121 Vali Loss: 3.042 Vali Acc: 0.256 Test Loss: 3.042 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.9876580
	speed: 1.0205s/iter; left time: 2256.3925s
Epoch: 16 cost time: 52.98253917694092
Epoch: 16, Steps: 154 | Train Loss: 1.123 Vali Loss: 7.661 Vali Acc: 0.098 Test Loss: 7.661 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.6706146
	speed: 1.0224s/iter; left time: 2103.1237s
Epoch: 17 cost time: 53.88046717643738
Epoch: 17, Steps: 154 | Train Loss: 1.032 Vali Loss: 7.369 Vali Acc: 0.094 Test Loss: 7.369 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6885836
	speed: 1.0238s/iter; left time: 1948.2720s
Epoch: 18 cost time: 55.01941657066345
Epoch: 18, Steps: 154 | Train Loss: 0.977 Vali Loss: 10.953 Vali Acc: 0.082 Test Loss: 10.953 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.8001584
	speed: 1.0230s/iter; left time: 1789.1964s
Epoch: 19 cost time: 56.15222120285034
Epoch: 19, Steps: 154 | Train Loss: 0.959 Vali Loss: 10.669 Vali Acc: 0.090 Test Loss: 10.669 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.2174131
	speed: 1.0223s/iter; left time: 1630.6381s
Epoch: 20 cost time: 55.28599429130554
Epoch: 20, Steps: 154 | Train Loss: 0.944 Vali Loss: 10.698 Vali Acc: 0.065 Test Loss: 10.698 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.0084587
	speed: 0.9103s/iter; left time: 1311.7746s
Epoch: 21 cost time: 49.82541632652283
Epoch: 21, Steps: 154 | Train Loss: 0.885 Vali Loss: 7.153 Vali Acc: 0.093 Test Loss: 7.153 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.8219873
	speed: 0.8916s/iter; left time: 1147.5258s
Epoch: 22 cost time: 48.8396680355072
Epoch: 22, Steps: 154 | Train Loss: 0.839 Vali Loss: 11.170 Vali Acc: 0.095 Test Loss: 11.170 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3884833738848337
model parameter : 37528078
model size : 144.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9575806
	speed: 0.1788s/iter; left time: 808.5403s
Epoch: 1 cost time: 26.798410892486572
Epoch: 1, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.153 Vali Acc: 0.326 Test Loss: 2.153 Test Acc: 0.326
Validation loss decreased (inf --> -0.326013).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9149132
	speed: 0.4887s/iter; left time: 2133.9542s
Epoch: 2 cost time: 20.689419507980347
Epoch: 2, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.169 Vali Acc: 0.335 Test Loss: 2.169 Test Acc: 0.335
Validation loss decreased (-0.326013 --> -0.335339).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3668364
	speed: 0.5070s/iter; left time: 2136.0434s
Epoch: 3 cost time: 24.453215837478638
Epoch: 3, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.069 Vali Acc: 0.351 Test Loss: 2.069 Test Acc: 0.351
Validation loss decreased (-0.335339 --> -0.351155).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3916111
	speed: 0.4550s/iter; left time: 1846.7588s
Epoch: 4 cost time: 20.903022289276123
Epoch: 4, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.530 Vali Acc: 0.351 Test Loss: 2.530 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7258493
	speed: 0.3835s/iter; left time: 1497.5042s
Epoch: 5 cost time: 19.98388981819153
Epoch: 5, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.373 Vali Acc: 0.194 Test Loss: 2.373 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0110245
	speed: 0.3973s/iter; left time: 1490.2992s
Epoch: 6 cost time: 19.101190090179443
Epoch: 6, Steps: 154 | Train Loss: 1.546 Vali Loss: 3.015 Vali Acc: 0.104 Test Loss: 3.015 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.7749976
	speed: 0.3760s/iter; left time: 1352.6087s
Epoch: 7 cost time: 14.570007562637329
Epoch: 7, Steps: 154 | Train Loss: 1.500 Vali Loss: 4.108 Vali Acc: 0.185 Test Loss: 4.108 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3548741
	speed: 0.2792s/iter; left time: 961.1197s
Epoch: 8 cost time: 18.36779546737671
Epoch: 8, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.799 Vali Acc: 0.202 Test Loss: 3.799 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.8450689
	speed: 0.4122s/iter; left time: 1355.7648s
Epoch: 9 cost time: 18.103655099868774
Epoch: 9, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.092 Vali Acc: 0.123 Test Loss: 3.092 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.5649484
	speed: 0.4118s/iter; left time: 1290.8982s
Epoch: 10 cost time: 19.383732318878174
Epoch: 10, Steps: 154 | Train Loss: 1.332 Vali Loss: 7.251 Vali Acc: 0.183 Test Loss: 7.251 Test Acc: 0.183
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.5975791
	speed: 0.4093s/iter; left time: 1220.0101s
Epoch: 11 cost time: 20.044458150863647
Epoch: 11, Steps: 154 | Train Loss: 1.240 Vali Loss: 11.522 Vali Acc: 0.085 Test Loss: 11.522 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.9013057
	speed: 0.4125s/iter; left time: 1166.0355s
Epoch: 12 cost time: 19.64667773246765
Epoch: 12, Steps: 154 | Train Loss: 1.219 Vali Loss: 9.159 Vali Acc: 0.096 Test Loss: 9.159 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.0421958
	speed: 0.3491s/iter; left time: 933.0174s
Epoch: 13 cost time: 16.896865367889404
Epoch: 13, Steps: 154 | Train Loss: 1.222 Vali Loss: 5.107 Vali Acc: 0.087 Test Loss: 5.107 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35117599351175993
model parameter : 11048974
model size : 43.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0260494
	speed: 0.3243s/iter; left time: 1466.0658s
Epoch: 1 cost time: 50.23260688781738
Epoch: 1, Steps: 154 | Train Loss: 2.096 Vali Loss: 2.205 Vali Acc: 0.285 Test Loss: 2.205 Test Acc: 0.285
Validation loss decreased (inf --> -0.284649).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8403630
	speed: 0.9903s/iter; left time: 4324.6709s
Epoch: 2 cost time: 52.748059034347534
Epoch: 2, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.152 Vali Acc: 0.350 Test Loss: 2.152 Test Acc: 0.350
Validation loss decreased (-0.284649 --> -0.350343).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4151064
	speed: 1.2069s/iter; left time: 5084.6277s
Epoch: 3 cost time: 60.02556896209717
Epoch: 3, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.160 Vali Acc: 0.358 Test Loss: 2.160 Test Acc: 0.358
Validation loss decreased (-0.350343 --> -0.357643).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1648934
	speed: 1.1623s/iter; left time: 4717.8309s
Epoch: 4 cost time: 53.48585796356201
Epoch: 4, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.080 Vali Acc: 0.362 Test Loss: 2.080 Test Acc: 0.362
Validation loss decreased (-0.357643 --> -0.361699).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9534156
	speed: 1.0066s/iter; left time: 3930.9392s
Epoch: 5 cost time: 49.734753370285034
Epoch: 5, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.631 Vali Acc: 0.361 Test Loss: 2.631 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5570626
	speed: 0.9938s/iter; left time: 3727.6512s
Epoch: 6 cost time: 53.76712965965271
Epoch: 6, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.381 Vali Acc: 0.374 Test Loss: 2.381 Test Acc: 0.374
Validation loss decreased (-0.361699 --> -0.373861).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4430807
	speed: 1.2357s/iter; left time: 4444.9410s
Epoch: 7 cost time: 61.02191948890686
Epoch: 7, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.900 Vali Acc: 0.110 Test Loss: 2.900 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5694635
	speed: 1.1964s/iter; left time: 4119.2420s
Epoch: 8 cost time: 53.972275733947754
Epoch: 8, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.570 Vali Acc: 0.161 Test Loss: 2.570 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2365294
	speed: 0.9891s/iter; left time: 3253.2780s
Epoch: 9 cost time: 49.675206661224365
Epoch: 9, Steps: 154 | Train Loss: 1.284 Vali Loss: 2.773 Vali Acc: 0.158 Test Loss: 2.773 Test Acc: 0.158
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8859487
	speed: 0.9825s/iter; left time: 3079.9837s
Epoch: 10 cost time: 52.371700286865234
Epoch: 10, Steps: 154 | Train Loss: 1.234 Vali Loss: 4.584 Vali Acc: 0.103 Test Loss: 4.584 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1394395
	speed: 1.2142s/iter; left time: 3619.4541s
Epoch: 11 cost time: 60.74799418449402
Epoch: 11, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.527 Vali Acc: 0.152 Test Loss: 3.527 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6747155
	speed: 1.2210s/iter; left time: 3451.8735s
Epoch: 12 cost time: 55.79571032524109
Epoch: 12, Steps: 154 | Train Loss: 1.135 Vali Loss: 2.999 Vali Acc: 0.212 Test Loss: 2.999 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9338868
	speed: 0.9870s/iter; left time: 2638.2531s
Epoch: 13 cost time: 49.42485499382019
Epoch: 13, Steps: 154 | Train Loss: 1.087 Vali Loss: 2.734 Vali Acc: 0.377 Test Loss: 2.734 Test Acc: 0.377
Validation loss decreased (-0.373861 --> -0.376696).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0789849
	speed: 1.0757s/iter; left time: 2709.8032s
Epoch: 14 cost time: 64.18436908721924
Epoch: 14, Steps: 154 | Train Loss: 1.008 Vali Loss: 3.415 Vali Acc: 0.201 Test Loss: 3.415 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9614429
	speed: 1.4163s/iter; left time: 3349.5241s
Epoch: 15 cost time: 70.99132966995239
Epoch: 15, Steps: 154 | Train Loss: 1.020 Vali Loss: 3.405 Vali Acc: 0.165 Test Loss: 3.405 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0380123
	speed: 1.4046s/iter; left time: 3105.6411s
Epoch: 16 cost time: 67.16794538497925
Epoch: 16, Steps: 154 | Train Loss: 0.933 Vali Loss: 5.513 Vali Acc: 0.101 Test Loss: 5.513 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.2073642
	speed: 1.1635s/iter; left time: 2393.2782s
Epoch: 17 cost time: 57.09318017959595
Epoch: 17, Steps: 154 | Train Loss: 0.932 Vali Loss: 5.021 Vali Acc: 0.167 Test Loss: 5.021 Test Acc: 0.167
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.8271142
	speed: 1.1399s/iter; left time: 2169.1571s
Epoch: 18 cost time: 56.521382093429565
Epoch: 18, Steps: 154 | Train Loss: 0.889 Vali Loss: 5.241 Vali Acc: 0.107 Test Loss: 5.241 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.3461677
	speed: 1.3318s/iter; left time: 2329.2502s
Epoch: 19 cost time: 68.05231666564941
Epoch: 19, Steps: 154 | Train Loss: 0.818 Vali Loss: 4.945 Vali Acc: 0.114 Test Loss: 4.945 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7907219
	speed: 1.3866s/iter; left time: 2211.5539s
Epoch: 20 cost time: 65.15222406387329
Epoch: 20, Steps: 154 | Train Loss: 0.808 Vali Loss: 5.508 Vali Acc: 0.112 Test Loss: 5.508 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.9763498
	speed: 1.1647s/iter; left time: 1678.3724s
Epoch: 21 cost time: 54.13092064857483
Epoch: 21, Steps: 154 | Train Loss: 0.774 Vali Loss: 4.300 Vali Acc: 0.218 Test Loss: 4.300 Test Acc: 0.218
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.5592505
	speed: 1.1333s/iter; left time: 1458.5320s
Epoch: 22 cost time: 54.65005302429199
Epoch: 22, Steps: 154 | Train Loss: 0.716 Vali Loss: 5.095 Vali Acc: 0.104 Test Loss: 5.095 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.7154295
	speed: 1.3199s/iter; left time: 1495.4906s
Epoch: 23 cost time: 67.91258573532104
Epoch: 23, Steps: 154 | Train Loss: 0.663 Vali Loss: 4.276 Vali Acc: 0.199 Test Loss: 4.276 Test Acc: 0.199
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 18781710
model size : 72.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8661799
	speed: 0.1849s/iter; left time: 836.0393s
Epoch: 1 cost time: 25.947484493255615
Epoch: 1, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.137 Vali Acc: 0.172 Test Loss: 2.137 Test Acc: 0.172
Validation loss decreased (inf --> -0.171917).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7544864
	speed: 0.5746s/iter; left time: 2509.3812s
Epoch: 2 cost time: 28.38822627067566
Epoch: 2, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.260 Vali Acc: 0.337 Test Loss: 2.260 Test Acc: 0.337
Validation loss decreased (-0.171917 --> -0.336555).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7368876
	speed: 0.5792s/iter; left time: 2440.2412s
Epoch: 3 cost time: 28.664589166641235
Epoch: 3, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.255 Vali Acc: 0.362 Test Loss: 2.255 Test Acc: 0.362
Validation loss decreased (-0.336555 --> -0.361697).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7490768
	speed: 0.6194s/iter; left time: 2514.1941s
Epoch: 4 cost time: 26.29673957824707
Epoch: 4, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.578 Vali Acc: 0.204 Test Loss: 2.578 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5647349
	speed: 0.5920s/iter; left time: 2311.8910s
Epoch: 5 cost time: 30.991589069366455
Epoch: 5, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.714 Vali Acc: 0.272 Test Loss: 2.714 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3656427
	speed: 0.6804s/iter; left time: 2552.2679s
Epoch: 6 cost time: 30.496532678604126
Epoch: 6, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.704 Vali Acc: 0.373 Test Loss: 2.704 Test Acc: 0.373
Validation loss decreased (-0.361697 --> -0.373452).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7976989
	speed: 0.7348s/iter; left time: 2643.0454s
Epoch: 7 cost time: 36.3158917427063
Epoch: 7, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.351 Vali Acc: 0.392 Test Loss: 2.351 Test Acc: 0.392
Validation loss decreased (-0.373452 --> -0.391704).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1500137
	speed: 0.6846s/iter; left time: 2357.2359s
Epoch: 8 cost time: 30.751651763916016
Epoch: 8, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.518 Vali Acc: 0.184 Test Loss: 2.518 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.7826840
	speed: 0.7577s/iter; left time: 2491.9266s
Epoch: 9 cost time: 35.871583223342896
Epoch: 9, Steps: 154 | Train Loss: 1.281 Vali Loss: 2.658 Vali Acc: 0.382 Test Loss: 2.658 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2494487
	speed: 0.5635s/iter; left time: 1766.4912s
Epoch: 10 cost time: 27.57497549057007
Epoch: 10, Steps: 154 | Train Loss: 1.201 Vali Loss: 5.729 Vali Acc: 0.116 Test Loss: 5.729 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0886486
	speed: 0.6577s/iter; left time: 1960.6410s
Epoch: 11 cost time: 28.59501028060913
Epoch: 11, Steps: 154 | Train Loss: 1.172 Vali Loss: 3.421 Vali Acc: 0.081 Test Loss: 3.421 Test Acc: 0.081
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6454717
	speed: 0.5594s/iter; left time: 1581.4239s
Epoch: 12 cost time: 30.514726877212524
Epoch: 12, Steps: 154 | Train Loss: 1.112 Vali Loss: 3.491 Vali Acc: 0.139 Test Loss: 3.491 Test Acc: 0.139
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0451670
	speed: 0.6375s/iter; left time: 1704.0109s
Epoch: 13 cost time: 26.626728296279907
Epoch: 13, Steps: 154 | Train Loss: 1.061 Vali Loss: 3.216 Vali Acc: 0.362 Test Loss: 3.216 Test Acc: 0.362
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4231195
	speed: 0.6259s/iter; left time: 1576.7236s
Epoch: 14 cost time: 36.449883222579956
Epoch: 14, Steps: 154 | Train Loss: 1.009 Vali Loss: 3.548 Vali Acc: 0.351 Test Loss: 3.548 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.6337170
	speed: 0.7268s/iter; left time: 1718.8710s
Epoch: 15 cost time: 31.33232545852661
Epoch: 15, Steps: 154 | Train Loss: 0.954 Vali Loss: 5.916 Vali Acc: 0.107 Test Loss: 5.916 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.2397997
	speed: 0.7265s/iter; left time: 1606.2753s
Epoch: 16 cost time: 36.40423798561096
Epoch: 16, Steps: 154 | Train Loss: 0.924 Vali Loss: 3.565 Vali Acc: 0.108 Test Loss: 3.565 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.3793849
	speed: 0.7014s/iter; left time: 1442.8530s
Epoch: 17 cost time: 31.82551646232605
Epoch: 17, Steps: 154 | Train Loss: 0.863 Vali Loss: 2.758 Vali Acc: 0.362 Test Loss: 2.758 Test Acc: 0.362
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 5541902
model size : 22.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0370858
	speed: 0.3211s/iter; left time: 1451.6013s
Epoch: 1 cost time: 48.35114359855652
Epoch: 1, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.177 Vali Acc: 0.341 Test Loss: 2.177 Test Acc: 0.341
Validation loss decreased (inf --> -0.341422).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8241757
	speed: 0.9550s/iter; left time: 4170.4298s
Epoch: 2 cost time: 47.252196073532104
Epoch: 2, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.181 Vali Acc: 0.339 Test Loss: 2.181 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.4053220
	speed: 0.9576s/iter; left time: 4034.2761s
Epoch: 3 cost time: 48.70719575881958
Epoch: 3, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.111 Vali Acc: 0.351 Test Loss: 2.111 Test Acc: 0.351
Validation loss decreased (-0.341422 --> -0.351155).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2574689
	speed: 1.0836s/iter; left time: 4398.2015s
Epoch: 4 cost time: 56.43661165237427
Epoch: 4, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.945 Vali Acc: 0.122 Test Loss: 2.945 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5440331
	speed: 1.1286s/iter; left time: 4407.0568s
Epoch: 5 cost time: 58.29160284996033
Epoch: 5, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.567 Vali Acc: 0.356 Test Loss: 2.567 Test Acc: 0.356
Validation loss decreased (-0.351155 --> -0.356017).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4787334
	speed: 1.1049s/iter; left time: 4144.5558s
Epoch: 6 cost time: 54.45232129096985
Epoch: 6, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.348 Vali Acc: 0.362 Test Loss: 2.348 Test Acc: 0.362
Validation loss decreased (-0.356017 --> -0.361696).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2329334
	speed: 0.9512s/iter; left time: 3421.3345s
Epoch: 7 cost time: 41.00430345535278
Epoch: 7, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.846 Vali Acc: 0.369 Test Loss: 2.846 Test Acc: 0.369
Validation loss decreased (-0.361696 --> -0.368990).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5069785
	speed: 0.7357s/iter; left time: 2532.8446s
Epoch: 8 cost time: 39.21876764297485
Epoch: 8, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.070 Vali Acc: 0.208 Test Loss: 3.070 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1068707
	speed: 0.7427s/iter; left time: 2442.6635s
Epoch: 9 cost time: 41.145220041275024
Epoch: 9, Steps: 154 | Train Loss: 1.310 Vali Loss: 4.093 Vali Acc: 0.207 Test Loss: 4.093 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.9956693
	speed: 0.9116s/iter; left time: 2857.7908s
Epoch: 10 cost time: 45.32003140449524
Epoch: 10, Steps: 154 | Train Loss: 1.273 Vali Loss: 4.638 Vali Acc: 0.104 Test Loss: 4.638 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0848544
	speed: 0.9081s/iter; left time: 2707.0288s
Epoch: 11 cost time: 44.174421548843384
Epoch: 11, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.338 Vali Acc: 0.139 Test Loss: 3.338 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.7901521
	speed: 0.8619s/iter; left time: 2436.6117s
Epoch: 12 cost time: 36.33772134780884
Epoch: 12, Steps: 154 | Train Loss: 1.149 Vali Loss: 2.971 Vali Acc: 0.373 Test Loss: 2.971 Test Acc: 0.373
Validation loss decreased (-0.368990 --> -0.373450).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8253069
	speed: 0.7538s/iter; left time: 2014.9342s
Epoch: 13 cost time: 38.297093629837036
Epoch: 13, Steps: 154 | Train Loss: 1.106 Vali Loss: 3.327 Vali Acc: 0.382 Test Loss: 3.327 Test Acc: 0.382
Validation loss decreased (-0.373450 --> -0.381962).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.8681732
	speed: 0.7896s/iter; left time: 1988.9750s
Epoch: 14 cost time: 40.910104274749756
Epoch: 14, Steps: 154 | Train Loss: 1.054 Vali Loss: 5.716 Vali Acc: 0.084 Test Loss: 5.716 Test Acc: 0.084
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1827645
	speed: 0.8041s/iter; left time: 1901.6435s
Epoch: 15 cost time: 50.41012907028198
Epoch: 15, Steps: 154 | Train Loss: 0.993 Vali Loss: 3.641 Vali Acc: 0.233 Test Loss: 3.641 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9774613
	speed: 0.9459s/iter; left time: 2091.3190s
Epoch: 16 cost time: 50.46209216117859
Epoch: 16, Steps: 154 | Train Loss: 0.971 Vali Loss: 3.394 Vali Acc: 0.283 Test Loss: 3.394 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3049712
	speed: 0.9755s/iter; left time: 2006.6390s
Epoch: 17 cost time: 49.69571542739868
Epoch: 17, Steps: 154 | Train Loss: 0.971 Vali Loss: 7.879 Vali Acc: 0.110 Test Loss: 7.879 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.8579934
	speed: 0.8501s/iter; left time: 1617.7189s
Epoch: 18 cost time: 38.273447036743164
Epoch: 18, Steps: 154 | Train Loss: 0.878 Vali Loss: 8.402 Vali Acc: 0.087 Test Loss: 8.402 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.4386953
	speed: 0.8123s/iter; left time: 1420.7303s
Epoch: 19 cost time: 38.895161151885986
Epoch: 19, Steps: 154 | Train Loss: 0.840 Vali Loss: 3.906 Vali Acc: 0.151 Test Loss: 3.906 Test Acc: 0.151
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6269014
	speed: 0.8291s/iter; left time: 1322.3533s
Epoch: 20 cost time: 41.41676926612854
Epoch: 20, Steps: 154 | Train Loss: 0.782 Vali Loss: 7.671 Vali Acc: 0.097 Test Loss: 7.671 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6889565
	speed: 0.8509s/iter; left time: 1226.1261s
Epoch: 21 cost time: 45.2605197429657
Epoch: 21, Steps: 154 | Train Loss: 0.792 Vali Loss: 5.372 Vali Acc: 0.161 Test Loss: 5.372 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.6059889
	speed: 0.8687s/iter; left time: 1118.0667s
Epoch: 22 cost time: 52.89165282249451
Epoch: 22, Steps: 154 | Train Loss: 0.715 Vali Loss: 6.975 Vali Acc: 0.110 Test Loss: 6.975 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.9435800
	speed: 1.1716s/iter; left time: 1327.4720s
Epoch: 23 cost time: 58.70639777183533
Epoch: 23, Steps: 154 | Train Loss: 0.690 Vali Loss: 7.068 Vali Acc: 0.144 Test Loss: 7.068 Test Acc: 0.144
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3819951338199513
model parameter : 18781710
model size : 72.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8613389
	speed: 0.1890s/iter; left time: 854.3374s
Epoch: 1 cost time: 28.07034206390381
Epoch: 1, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.127 Vali Acc: 0.171 Test Loss: 2.127 Test Acc: 0.171
Validation loss decreased (inf --> -0.171106).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8011568
	speed: 0.5608s/iter; left time: 2448.9177s
Epoch: 2 cost time: 24.792116165161133
Epoch: 2, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.196 Vali Acc: 0.339 Test Loss: 2.196 Test Acc: 0.339
Validation loss decreased (-0.171106 --> -0.338583).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7622892
	speed: 0.4876s/iter; left time: 2054.3859s
Epoch: 3 cost time: 22.345544576644897
Epoch: 3, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.117 Vali Acc: 0.362 Test Loss: 2.117 Test Acc: 0.362
Validation loss decreased (-0.338583 --> -0.361698).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8677940
	speed: 0.6308s/iter; left time: 2560.3567s
Epoch: 4 cost time: 26.51238465309143
Epoch: 4, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.586 Vali Acc: 0.362 Test Loss: 2.586 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7656344
	speed: 0.5712s/iter; left time: 2230.4530s
Epoch: 5 cost time: 29.3683979511261
Epoch: 5, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.841 Vali Acc: 0.376 Test Loss: 2.841 Test Acc: 0.376
Validation loss decreased (-0.361698 --> -0.375884).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3567588
	speed: 0.5978s/iter; left time: 2242.1953s
Epoch: 6 cost time: 24.315654754638672
Epoch: 6, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.682 Vali Acc: 0.392 Test Loss: 2.682 Test Acc: 0.392
Validation loss decreased (-0.375884 --> -0.391701).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6741968
	speed: 0.6097s/iter; left time: 2193.0878s
Epoch: 7 cost time: 29.096904277801514
Epoch: 7, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.286 Vali Acc: 0.376 Test Loss: 2.286 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8792222
	speed: 0.5596s/iter; left time: 1926.6490s
Epoch: 8 cost time: 26.18528175354004
Epoch: 8, Steps: 154 | Train Loss: 1.358 Vali Loss: 3.160 Vali Acc: 0.143 Test Loss: 3.160 Test Acc: 0.143
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.8578493
	speed: 0.6290s/iter; left time: 2068.8249s
Epoch: 9 cost time: 26.068060159683228
Epoch: 9, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.220 Vali Acc: 0.221 Test Loss: 3.220 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1554564
	speed: 0.5566s/iter; left time: 1744.9112s
Epoch: 10 cost time: 26.45306706428528
Epoch: 10, Steps: 154 | Train Loss: 1.253 Vali Loss: 5.799 Vali Acc: 0.090 Test Loss: 5.799 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1705154
	speed: 0.6339s/iter; left time: 1889.7072s
Epoch: 11 cost time: 27.79479169845581
Epoch: 11, Steps: 154 | Train Loss: 1.212 Vali Loss: 5.866 Vali Acc: 0.090 Test Loss: 5.866 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7442815
	speed: 0.5829s/iter; left time: 1647.9347s
Epoch: 12 cost time: 26.724217653274536
Epoch: 12, Steps: 154 | Train Loss: 1.141 Vali Loss: 2.571 Vali Acc: 0.387 Test Loss: 2.571 Test Acc: 0.387
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3963895
	speed: 0.5769s/iter; left time: 1541.9779s
Epoch: 13 cost time: 27.211638927459717
Epoch: 13, Steps: 154 | Train Loss: 1.100 Vali Loss: 6.964 Vali Acc: 0.087 Test Loss: 6.964 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.2404236
	speed: 0.5844s/iter; left time: 1472.1801s
Epoch: 14 cost time: 24.49682331085205
Epoch: 14, Steps: 154 | Train Loss: 1.046 Vali Loss: 4.488 Vali Acc: 0.173 Test Loss: 4.488 Test Acc: 0.173
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7205298
	speed: 0.6021s/iter; left time: 1423.9767s
Epoch: 15 cost time: 29.18518376350403
Epoch: 15, Steps: 154 | Train Loss: 1.004 Vali Loss: 3.955 Vali Acc: 0.127 Test Loss: 3.955 Test Acc: 0.127
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.9510673
	speed: 0.5502s/iter; left time: 1216.4416s
Epoch: 16 cost time: 24.62498664855957
Epoch: 16, Steps: 154 | Train Loss: 0.956 Vali Loss: 4.616 Vali Acc: 0.217 Test Loss: 4.616 Test Acc: 0.217
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 5541902
model size : 22.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0417058
	speed: 0.2252s/iter; left time: 1018.2844s
Epoch: 1 cost time: 34.05532193183899
Epoch: 1, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.124 Vali Acc: 0.331 Test Loss: 2.124 Test Acc: 0.331
Validation loss decreased (inf --> -0.331285).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7747728
	speed: 0.7678s/iter; left time: 3353.0888s
Epoch: 2 cost time: 37.523778200149536
Epoch: 2, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.056 Vali Acc: 0.348 Test Loss: 2.056 Test Acc: 0.348
Validation loss decreased (-0.331285 --> -0.347506).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8675138
	speed: 0.7233s/iter; left time: 3047.0764s
Epoch: 3 cost time: 39.17769503593445
Epoch: 3, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.106 Vali Acc: 0.363 Test Loss: 2.106 Test Acc: 0.363
Validation loss decreased (-0.347506 --> -0.362509).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3460032
	speed: 0.7444s/iter; left time: 3021.4687s
Epoch: 4 cost time: 34.855372190475464
Epoch: 4, Steps: 154 | Train Loss: 1.660 Vali Loss: 3.035 Vali Acc: 0.100 Test Loss: 3.035 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4642932
	speed: 0.7545s/iter; left time: 2946.2688s
Epoch: 5 cost time: 35.79825186729431
Epoch: 5, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.535 Vali Acc: 0.364 Test Loss: 2.535 Test Acc: 0.364
Validation loss decreased (-0.362509 --> -0.364127).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5583317
	speed: 0.8023s/iter; left time: 3009.5401s
Epoch: 6 cost time: 39.29078769683838
Epoch: 6, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.795 Vali Acc: 0.373 Test Loss: 2.795 Test Acc: 0.373
Validation loss decreased (-0.364127 --> -0.373046).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2783064
	speed: 0.8251s/iter; left time: 2968.0590s
Epoch: 7 cost time: 40.720820903778076
Epoch: 7, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.748 Vali Acc: 0.232 Test Loss: 2.748 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5745684
	speed: 0.7899s/iter; left time: 2719.5679s
Epoch: 8 cost time: 40.3813955783844
Epoch: 8, Steps: 154 | Train Loss: 1.395 Vali Loss: 4.373 Vali Acc: 0.077 Test Loss: 4.373 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1969959
	speed: 0.8156s/iter; left time: 2682.5899s
Epoch: 9 cost time: 37.08004879951477
Epoch: 9, Steps: 154 | Train Loss: 1.358 Vali Loss: 4.354 Vali Acc: 0.217 Test Loss: 4.354 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.8591387
	speed: 0.8440s/iter; left time: 2645.8256s
Epoch: 10 cost time: 39.82024669647217
Epoch: 10, Steps: 154 | Train Loss: 1.259 Vali Loss: 5.211 Vali Acc: 0.099 Test Loss: 5.211 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3296880
	speed: 0.7819s/iter; left time: 2330.9594s
Epoch: 11 cost time: 42.581340074539185
Epoch: 11, Steps: 154 | Train Loss: 1.239 Vali Loss: 7.377 Vali Acc: 0.097 Test Loss: 7.377 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.7038158
	speed: 0.7976s/iter; left time: 2254.7819s
Epoch: 12 cost time: 36.825422286987305
Epoch: 12, Steps: 154 | Train Loss: 1.131 Vali Loss: 4.232 Vali Acc: 0.217 Test Loss: 4.232 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.6621960
	speed: 0.8420s/iter; left time: 2250.5480s
Epoch: 13 cost time: 38.798794746398926
Epoch: 13, Steps: 154 | Train Loss: 1.132 Vali Loss: 6.634 Vali Acc: 0.193 Test Loss: 6.634 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.7607141
	speed: 0.8072s/iter; left time: 2033.2747s
Epoch: 14 cost time: 41.52861738204956
Epoch: 14, Steps: 154 | Train Loss: 1.068 Vali Loss: 5.836 Vali Acc: 0.196 Test Loss: 5.836 Test Acc: 0.196
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.9698864
	speed: 0.8066s/iter; left time: 1907.5704s
Epoch: 15 cost time: 39.23958134651184
Epoch: 15, Steps: 154 | Train Loss: 1.018 Vali Loss: 5.548 Vali Acc: 0.163 Test Loss: 5.548 Test Acc: 0.163
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.8403668
	speed: 0.8191s/iter; left time: 1811.0593s
Epoch: 16 cost time: 39.285451889038086
Epoch: 16, Steps: 154 | Train Loss: 0.990 Vali Loss: 5.699 Vali Acc: 0.097 Test Loss: 5.699 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 18781710
model size : 72.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9166012
	speed: 0.1389s/iter; left time: 627.9340s
Epoch: 1 cost time: 20.569149255752563
Epoch: 1, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.107 Vali Acc: 0.174 Test Loss: 2.107 Test Acc: 0.174
Validation loss decreased (inf --> -0.174350).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7536880
	speed: 0.4001s/iter; left time: 1747.2337s
Epoch: 2 cost time: 13.362171173095703
Epoch: 2, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.240 Vali Acc: 0.332 Test Loss: 2.240 Test Acc: 0.332
Validation loss decreased (-0.174350 --> -0.331689).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8832754
	speed: 0.3833s/iter; left time: 1615.0481s
Epoch: 3 cost time: 18.44641637802124
Epoch: 3, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.186 Vali Acc: 0.371 Test Loss: 2.186 Test Acc: 0.371
Validation loss decreased (-0.331689 --> -0.371024).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0391488
	speed: 0.4030s/iter; left time: 1635.7603s
Epoch: 4 cost time: 18.824992418289185
Epoch: 4, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.007 Vali Acc: 0.346 Test Loss: 2.007 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5579467
	speed: 0.3855s/iter; left time: 1505.3727s
Epoch: 5 cost time: 15.359038591384888
Epoch: 5, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.242 Vali Acc: 0.384 Test Loss: 2.242 Test Acc: 0.384
Validation loss decreased (-0.371024 --> -0.383595).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4284384
	speed: 0.4160s/iter; left time: 1560.5031s
Epoch: 6 cost time: 19.455421447753906
Epoch: 6, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.520 Vali Acc: 0.392 Test Loss: 2.520 Test Acc: 0.392
Validation loss decreased (-0.383595 --> -0.391702).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9556199
	speed: 0.3886s/iter; left time: 1397.9446s
Epoch: 7 cost time: 15.876784801483154
Epoch: 7, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.893 Vali Acc: 0.210 Test Loss: 2.893 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 4.1767831
	speed: 0.4021s/iter; left time: 1384.5982s
Epoch: 8 cost time: 17.348517417907715
Epoch: 8, Steps: 154 | Train Loss: 1.447 Vali Loss: 4.159 Vali Acc: 0.072 Test Loss: 4.159 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.7212935
	speed: 0.4095s/iter; left time: 1346.8353s
Epoch: 9 cost time: 18.718343257904053
Epoch: 9, Steps: 154 | Train Loss: 1.367 Vali Loss: 5.934 Vali Acc: 0.070 Test Loss: 5.934 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0037700
	speed: 0.3657s/iter; left time: 1146.4854s
Epoch: 10 cost time: 16.00800347328186
Epoch: 10, Steps: 154 | Train Loss: 1.341 Vali Loss: 7.546 Vali Acc: 0.074 Test Loss: 7.546 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.2253394
	speed: 0.4295s/iter; left time: 1280.2468s
Epoch: 11 cost time: 18.739458799362183
Epoch: 11, Steps: 154 | Train Loss: 1.324 Vali Loss: 7.532 Vali Acc: 0.081 Test Loss: 7.532 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.5756804
	speed: 0.3748s/iter; left time: 1059.5369s
Epoch: 12 cost time: 16.7256076335907
Epoch: 12, Steps: 154 | Train Loss: 1.208 Vali Loss: 7.684 Vali Acc: 0.086 Test Loss: 7.684 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.4029167
	speed: 0.4104s/iter; left time: 1096.9569s
Epoch: 13 cost time: 17.302842378616333
Epoch: 13, Steps: 154 | Train Loss: 1.169 Vali Loss: 6.682 Vali Acc: 0.085 Test Loss: 6.682 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4477468
	speed: 0.4136s/iter; left time: 1041.9379s
Epoch: 14 cost time: 18.314924240112305
Epoch: 14, Steps: 154 | Train Loss: 1.107 Vali Loss: 7.986 Vali Acc: 0.082 Test Loss: 7.986 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7329502
	speed: 0.3654s/iter; left time: 864.1670s
Epoch: 15 cost time: 16.868377447128296
Epoch: 15, Steps: 154 | Train Loss: 1.058 Vali Loss: 8.831 Vali Acc: 0.085 Test Loss: 8.831 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.0340475
	speed: 0.4729s/iter; left time: 1045.5045s
Epoch: 16 cost time: 19.52268958091736
Epoch: 16, Steps: 154 | Train Loss: 0.991 Vali Loss: 8.985 Vali Acc: 0.092 Test Loss: 8.985 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 5541902
model size : 22.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5993352
	speed: 0.3998s/iter; left time: 1807.6830s
Epoch: 1 cost time: 61.09076189994812
Epoch: 1, Steps: 154 | Train Loss: 2.102 Vali Loss: 2.153 Vali Acc: 0.329 Test Loss: 2.153 Test Acc: 0.329
Validation loss decreased (inf --> -0.328851).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3578840
	speed: 1.2635s/iter; left time: 5517.5706s
Epoch: 2 cost time: 61.76378798484802
Epoch: 2, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.260 Vali Acc: 0.336 Test Loss: 2.260 Test Acc: 0.336
Validation loss decreased (-0.328851 --> -0.336149).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8936144
	speed: 1.2066s/iter; left time: 5083.5640s
Epoch: 3 cost time: 56.50080990791321
Epoch: 3, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.597 Vali Acc: 0.350 Test Loss: 2.597 Test Acc: 0.350
Validation loss decreased (-0.336149 --> -0.349528).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1741246
	speed: 1.2253s/iter; left time: 4973.5087s
Epoch: 4 cost time: 59.93655514717102
Epoch: 4, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.112 Vali Acc: 0.364 Test Loss: 2.112 Test Acc: 0.364
Validation loss decreased (-0.349528 --> -0.363726).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0642440
	speed: 1.2034s/iter; left time: 4699.4178s
Epoch: 5 cost time: 56.48991799354553
Epoch: 5, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.382 Vali Acc: 0.146 Test Loss: 2.382 Test Acc: 0.146
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5400896
	speed: 1.2188s/iter; left time: 4571.7568s
Epoch: 6 cost time: 59.03911018371582
Epoch: 6, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.008 Vali Acc: 0.380 Test Loss: 2.008 Test Acc: 0.380
Validation loss decreased (-0.363726 --> -0.379542).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0851995
	speed: 1.2177s/iter; left time: 4380.2139s
Epoch: 7 cost time: 56.26655054092407
Epoch: 7, Steps: 154 | Train Loss: 1.403 Vali Loss: 4.033 Vali Acc: 0.076 Test Loss: 4.033 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2291924
	speed: 1.1009s/iter; left time: 3790.5023s
Epoch: 8 cost time: 47.042014598846436
Epoch: 8, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.815 Vali Acc: 0.197 Test Loss: 2.815 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0236473
	speed: 1.1375s/iter; left time: 3741.1841s
Epoch: 9 cost time: 55.04306173324585
Epoch: 9, Steps: 154 | Train Loss: 1.306 Vali Loss: 2.856 Vali Acc: 0.101 Test Loss: 2.856 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4093946
	speed: 1.1217s/iter; left time: 3516.5958s
Epoch: 10 cost time: 49.672855615615845
Epoch: 10, Steps: 154 | Train Loss: 1.257 Vali Loss: 2.515 Vali Acc: 0.208 Test Loss: 2.515 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8868885
	speed: 1.0173s/iter; left time: 3032.5493s
Epoch: 11 cost time: 48.52125072479248
Epoch: 11, Steps: 154 | Train Loss: 1.177 Vali Loss: 3.516 Vali Acc: 0.096 Test Loss: 3.516 Test Acc: 0.096
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3236556
	speed: 1.0682s/iter; left time: 3019.8276s
Epoch: 12 cost time: 51.45810103416443
Epoch: 12, Steps: 154 | Train Loss: 1.123 Vali Loss: 2.530 Vali Acc: 0.349 Test Loss: 2.530 Test Acc: 0.349
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.8570954
	speed: 1.0228s/iter; left time: 2734.0356s
Epoch: 13 cost time: 47.22501564025879
Epoch: 13, Steps: 154 | Train Loss: 1.071 Vali Loss: 6.834 Vali Acc: 0.124 Test Loss: 6.834 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1297747
	speed: 1.0577s/iter; left time: 2664.4603s
Epoch: 14 cost time: 52.2866108417511
Epoch: 14, Steps: 154 | Train Loss: 1.035 Vali Loss: 3.739 Vali Acc: 0.107 Test Loss: 3.739 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.4902213
	speed: 1.1093s/iter; left time: 2623.3941s
Epoch: 15 cost time: 52.43531274795532
Epoch: 15, Steps: 154 | Train Loss: 1.009 Vali Loss: 6.106 Vali Acc: 0.104 Test Loss: 6.106 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.5920475
	speed: 1.1476s/iter; left time: 2537.3432s
Epoch: 16 cost time: 54.21817421913147
Epoch: 16, Steps: 154 | Train Loss: 0.943 Vali Loss: 4.017 Vali Acc: 0.200 Test Loss: 4.017 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 9408526
model size : 37.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8904788
	speed: 0.1882s/iter; left time: 850.7600s
Epoch: 1 cost time: 27.350029230117798
Epoch: 1, Steps: 154 | Train Loss: 2.100 Vali Loss: 2.108 Vali Acc: 0.330 Test Loss: 2.108 Test Acc: 0.330
Validation loss decreased (inf --> -0.330068).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7542530
	speed: 0.5302s/iter; left time: 2315.3957s
Epoch: 2 cost time: 26.24073624610901
Epoch: 2, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.309 Vali Acc: 0.337 Test Loss: 2.309 Test Acc: 0.337
Validation loss decreased (-0.330068 --> -0.336554).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3927025
	speed: 0.5368s/iter; left time: 2261.6784s
Epoch: 3 cost time: 23.698020219802856
Epoch: 3, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.145 Vali Acc: 0.347 Test Loss: 2.145 Test Acc: 0.347
Validation loss decreased (-0.336554 --> -0.347099).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7832947
	speed: 0.5123s/iter; left time: 2079.4508s
Epoch: 4 cost time: 23.57833242416382
Epoch: 4, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.707 Vali Acc: 0.357 Test Loss: 2.707 Test Acc: 0.357
Validation loss decreased (-0.347099 --> -0.357232).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4552366
	speed: 0.5231s/iter; left time: 2042.8370s
Epoch: 5 cost time: 25.117915868759155
Epoch: 5, Steps: 154 | Train Loss: 1.492 Vali Loss: 3.083 Vali Acc: 0.371 Test Loss: 3.083 Test Acc: 0.371
Validation loss decreased (-0.357232 --> -0.370610).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9932812
	speed: 0.5147s/iter; left time: 1930.8193s
Epoch: 6 cost time: 25.383280754089355
Epoch: 6, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.214 Vali Acc: 0.130 Test Loss: 3.214 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4433012
	speed: 0.5138s/iter; left time: 1847.9968s
Epoch: 7 cost time: 24.466397047042847
Epoch: 7, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.756 Vali Acc: 0.388 Test Loss: 2.756 Test Acc: 0.388
Validation loss decreased (-0.370610 --> -0.388050).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0946467
	speed: 0.5260s/iter; left time: 1810.9437s
Epoch: 8 cost time: 23.817784547805786
Epoch: 8, Steps: 154 | Train Loss: 1.307 Vali Loss: 3.517 Vali Acc: 0.164 Test Loss: 3.517 Test Acc: 0.164
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7959514
	speed: 0.4995s/iter; left time: 1642.8161s
Epoch: 9 cost time: 22.96570873260498
Epoch: 9, Steps: 154 | Train Loss: 1.259 Vali Loss: 3.420 Vali Acc: 0.358 Test Loss: 3.420 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0133742
	speed: 0.4543s/iter; left time: 1424.0914s
Epoch: 10 cost time: 22.6527259349823
Epoch: 10, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.591 Vali Acc: 0.086 Test Loss: 4.591 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9102073
	speed: 0.4524s/iter; left time: 1348.7023s
Epoch: 11 cost time: 21.132192611694336
Epoch: 11, Steps: 154 | Train Loss: 1.150 Vali Loss: 5.216 Vali Acc: 0.205 Test Loss: 5.216 Test Acc: 0.205
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.8047259
	speed: 0.4631s/iter; left time: 1309.1891s
Epoch: 12 cost time: 21.5185329914093
Epoch: 12, Steps: 154 | Train Loss: 1.099 Vali Loss: 5.952 Vali Acc: 0.092 Test Loss: 5.952 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0695055
	speed: 0.4491s/iter; left time: 1200.3353s
Epoch: 13 cost time: 21.993825912475586
Epoch: 13, Steps: 154 | Train Loss: 1.043 Vali Loss: 6.545 Vali Acc: 0.098 Test Loss: 6.545 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.9672802
	speed: 0.4359s/iter; left time: 1098.0334s
Epoch: 14 cost time: 21.295889616012573
Epoch: 14, Steps: 154 | Train Loss: 1.016 Vali Loss: 4.909 Vali Acc: 0.176 Test Loss: 4.909 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.5670767
	speed: 0.4412s/iter; left time: 1043.3477s
Epoch: 15 cost time: 20.2487895488739
Epoch: 15, Steps: 154 | Train Loss: 0.969 Vali Loss: 5.111 Vali Acc: 0.174 Test Loss: 5.111 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1182184
	speed: 0.4495s/iter; left time: 993.8500s
Epoch: 16 cost time: 21.35916781425476
Epoch: 16, Steps: 154 | Train Loss: 0.913 Vali Loss: 5.958 Vali Acc: 0.152 Test Loss: 5.958 Test Acc: 0.152
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.0630555
	speed: 0.4356s/iter; left time: 896.0651s
Epoch: 17 cost time: 21.566576719284058
Epoch: 17, Steps: 154 | Train Loss: 0.928 Vali Loss: 4.344 Vali Acc: 0.297 Test Loss: 4.344 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 2788366
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6305896
	speed: 0.2128s/iter; left time: 961.9077s
Epoch: 1 cost time: 33.37095403671265
Epoch: 1, Steps: 154 | Train Loss: 2.113 Vali Loss: 2.136 Vali Acc: 0.328 Test Loss: 2.136 Test Acc: 0.328
Validation loss decreased (inf --> -0.327635).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3634977
	speed: 0.6630s/iter; left time: 2895.1348s
Epoch: 2 cost time: 31.444880723953247
Epoch: 2, Steps: 154 | Train Loss: 1.915 Vali Loss: 2.216 Vali Acc: 0.329 Test Loss: 2.216 Test Acc: 0.329
Validation loss decreased (-0.327635 --> -0.328851).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0197008
	speed: 0.7774s/iter; left time: 3275.2940s
Epoch: 3 cost time: 41.39422941207886
Epoch: 3, Steps: 154 | Train Loss: 1.756 Vali Loss: 2.506 Vali Acc: 0.351 Test Loss: 2.506 Test Acc: 0.351
Validation loss decreased (-0.328851 --> -0.351151).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1572975
	speed: 0.8616s/iter; left time: 3497.2527s
Epoch: 4 cost time: 40.156445264816284
Epoch: 4, Steps: 154 | Train Loss: 1.669 Vali Loss: 2.045 Vali Acc: 0.376 Test Loss: 2.045 Test Acc: 0.376
Validation loss decreased (-0.351151 --> -0.375892).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9991958
	speed: 0.8644s/iter; left time: 3375.6245s
Epoch: 5 cost time: 38.72596025466919
Epoch: 5, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.117 Vali Acc: 0.266 Test Loss: 2.117 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5140307
	speed: 0.8811s/iter; left time: 3304.8804s
Epoch: 6 cost time: 38.25648808479309
Epoch: 6, Steps: 154 | Train Loss: 1.482 Vali Loss: 1.976 Vali Acc: 0.393 Test Loss: 1.976 Test Acc: 0.393
Validation loss decreased (-0.375892 --> -0.392924).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0007640
	speed: 0.8826s/iter; left time: 3174.6999s
Epoch: 7 cost time: 38.985424757003784
Epoch: 7, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.289 Vali Acc: 0.089 Test Loss: 3.289 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3243471
	speed: 0.8729s/iter; left time: 3005.4723s
Epoch: 8 cost time: 41.23617744445801
Epoch: 8, Steps: 154 | Train Loss: 1.370 Vali Loss: 7.674 Vali Acc: 0.091 Test Loss: 7.674 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0161009
	speed: 0.8752s/iter; left time: 2878.6661s
Epoch: 9 cost time: 43.06033515930176
Epoch: 9, Steps: 154 | Train Loss: 1.313 Vali Loss: 2.768 Vali Acc: 0.221 Test Loss: 2.768 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4955444
	speed: 0.8634s/iter; left time: 2706.6637s
Epoch: 10 cost time: 44.41950464248657
Epoch: 10, Steps: 154 | Train Loss: 1.277 Vali Loss: 2.799 Vali Acc: 0.303 Test Loss: 2.799 Test Acc: 0.303
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8734663
	speed: 0.8633s/iter; left time: 2573.3766s
Epoch: 11 cost time: 42.36991596221924
Epoch: 11, Steps: 154 | Train Loss: 1.203 Vali Loss: 4.198 Vali Acc: 0.089 Test Loss: 4.198 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4008479
	speed: 0.8679s/iter; left time: 2453.6188s
Epoch: 12 cost time: 39.707762002944946
Epoch: 12, Steps: 154 | Train Loss: 1.177 Vali Loss: 2.089 Vali Acc: 0.404 Test Loss: 2.089 Test Acc: 0.404
Validation loss decreased (-0.392924 --> -0.403872).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9954545
	speed: 0.8138s/iter; left time: 2175.3495s
Epoch: 13 cost time: 34.34641981124878
Epoch: 13, Steps: 154 | Train Loss: 1.131 Vali Loss: 3.851 Vali Acc: 0.107 Test Loss: 3.851 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.9402925
	speed: 0.7941s/iter; left time: 2000.4483s
Epoch: 14 cost time: 32.843626260757446
Epoch: 14, Steps: 154 | Train Loss: 1.093 Vali Loss: 2.719 Vali Acc: 0.333 Test Loss: 2.719 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5042065
	speed: 0.7518s/iter; left time: 1777.9485s
Epoch: 15 cost time: 33.15873098373413
Epoch: 15, Steps: 154 | Train Loss: 1.027 Vali Loss: 5.391 Vali Acc: 0.098 Test Loss: 5.391 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6940907
	speed: 0.7379s/iter; left time: 1631.5446s
Epoch: 16 cost time: 36.10596060752869
Epoch: 16, Steps: 154 | Train Loss: 0.973 Vali Loss: 3.721 Vali Acc: 0.099 Test Loss: 3.721 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.1253155
	speed: 0.7372s/iter; left time: 1516.4064s
Epoch: 17 cost time: 36.74649977684021
Epoch: 17, Steps: 154 | Train Loss: 0.939 Vali Loss: 6.343 Vali Acc: 0.094 Test Loss: 6.343 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.5990797
	speed: 0.7399s/iter; left time: 1408.1138s
Epoch: 18 cost time: 36.07420873641968
Epoch: 18, Steps: 154 | Train Loss: 0.902 Vali Loss: 4.949 Vali Acc: 0.111 Test Loss: 4.949 Test Acc: 0.111
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.1092768
	speed: 0.7518s/iter; left time: 1314.9847s
Epoch: 19 cost time: 34.14034700393677
Epoch: 19, Steps: 154 | Train Loss: 0.879 Vali Loss: 3.466 Vali Acc: 0.246 Test Loss: 3.466 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.7200608
	speed: 0.7392s/iter; left time: 1179.0672s
Epoch: 20 cost time: 32.695181369781494
Epoch: 20, Steps: 154 | Train Loss: 0.852 Vali Loss: 5.455 Vali Acc: 0.093 Test Loss: 5.455 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.8534291
	speed: 0.6762s/iter; left time: 974.3558s
Epoch: 21 cost time: 34.055055379867554
Epoch: 21, Steps: 154 | Train Loss: 0.792 Vali Loss: 5.072 Vali Acc: 0.090 Test Loss: 5.072 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.7011302
	speed: 0.7601s/iter; left time: 978.2189s
Epoch: 22 cost time: 37.17486834526062
Epoch: 22, Steps: 154 | Train Loss: 0.773 Vali Loss: 11.028 Vali Acc: 0.089 Test Loss: 11.028 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40389294403892945
model parameter : 9408526
model size : 37.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8971175
	speed: 0.1414s/iter; left time: 639.2919s
Epoch: 1 cost time: 21.028964519500732
Epoch: 1, Steps: 154 | Train Loss: 2.106 Vali Loss: 2.105 Vali Acc: 0.330 Test Loss: 2.105 Test Acc: 0.330
Validation loss decreased (inf --> -0.330474).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7995597
	speed: 0.4675s/iter; left time: 2041.3906s
Epoch: 2 cost time: 18.727345943450928
Epoch: 2, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.320 Vali Acc: 0.337 Test Loss: 2.320 Test Acc: 0.337
Validation loss decreased (-0.330474 --> -0.336554).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5065514
	speed: 0.4768s/iter; left time: 2008.6279s
Epoch: 3 cost time: 21.86069107055664
Epoch: 3, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.102 Vali Acc: 0.355 Test Loss: 2.102 Test Acc: 0.355
Validation loss decreased (-0.336554 --> -0.355210).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7675422
	speed: 0.4474s/iter; left time: 1816.1521s
Epoch: 4 cost time: 20.602123022079468
Epoch: 4, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.753 Vali Acc: 0.364 Test Loss: 2.753 Test Acc: 0.364
Validation loss decreased (-0.355210 --> -0.363719).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3218211
	speed: 0.4778s/iter; left time: 1865.6936s
Epoch: 5 cost time: 18.187427759170532
Epoch: 5, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.547 Vali Acc: 0.376 Test Loss: 2.547 Test Acc: 0.376
Validation loss decreased (-0.363719 --> -0.376292).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0205603
	speed: 0.4780s/iter; left time: 1792.8454s
Epoch: 6 cost time: 20.91505193710327
Epoch: 6, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.500 Vali Acc: 0.165 Test Loss: 2.500 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7250707
	speed: 0.4511s/iter; left time: 1622.4803s
Epoch: 7 cost time: 21.001603603363037
Epoch: 7, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.882 Vali Acc: 0.366 Test Loss: 2.882 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.0408144
	speed: 0.4789s/iter; left time: 1649.0187s
Epoch: 8 cost time: 19.83795142173767
Epoch: 8, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.536 Vali Acc: 0.365 Test Loss: 3.536 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7083468
	speed: 0.4725s/iter; left time: 1554.2042s
Epoch: 9 cost time: 19.96522331237793
Epoch: 9, Steps: 154 | Train Loss: 1.284 Vali Loss: 4.122 Vali Acc: 0.099 Test Loss: 4.122 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.9970163
	speed: 0.4836s/iter; left time: 1516.1030s
Epoch: 10 cost time: 19.619641065597534
Epoch: 10, Steps: 154 | Train Loss: 1.246 Vali Loss: 4.113 Vali Acc: 0.098 Test Loss: 4.113 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.9291022
	speed: 0.4778s/iter; left time: 1424.3970s
Epoch: 11 cost time: 22.643965005874634
Epoch: 11, Steps: 154 | Train Loss: 1.168 Vali Loss: 4.280 Vali Acc: 0.224 Test Loss: 4.280 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.5936365
	speed: 0.4536s/iter; left time: 1282.4662s
Epoch: 12 cost time: 19.842421531677246
Epoch: 12, Steps: 154 | Train Loss: 1.103 Vali Loss: 5.905 Vali Acc: 0.098 Test Loss: 5.905 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.1518015
	speed: 0.4433s/iter; left time: 1185.0363s
Epoch: 13 cost time: 16.605132818222046
Epoch: 13, Steps: 154 | Train Loss: 1.070 Vali Loss: 7.538 Vali Acc: 0.077 Test Loss: 7.538 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0945326
	speed: 0.4192s/iter; left time: 1055.8945s
Epoch: 14 cost time: 18.971949338912964
Epoch: 14, Steps: 154 | Train Loss: 1.037 Vali Loss: 5.468 Vali Acc: 0.112 Test Loss: 5.468 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.6540455
	speed: 0.3895s/iter; left time: 921.2210s
Epoch: 15 cost time: 16.32224726676941
Epoch: 15, Steps: 154 | Train Loss: 0.991 Vali Loss: 7.839 Vali Acc: 0.107 Test Loss: 7.839 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37631792376317924
model parameter : 2788366
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6272724
	speed: 0.1450s/iter; left time: 655.4687s
Epoch: 1 cost time: 21.39177131652832
Epoch: 1, Steps: 154 | Train Loss: 2.123 Vali Loss: 2.126 Vali Acc: 0.324 Test Loss: 2.126 Test Acc: 0.324
Validation loss decreased (inf --> -0.323580).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.3511301
	speed: 0.4585s/iter; left time: 2002.0811s
Epoch: 2 cost time: 20.8257577419281
Epoch: 2, Steps: 154 | Train Loss: 1.922 Vali Loss: 2.192 Vali Acc: 0.340 Test Loss: 2.192 Test Acc: 0.340
Validation loss decreased (-0.323580 --> -0.339800).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0473552
	speed: 0.4225s/iter; left time: 1780.0904s
Epoch: 3 cost time: 21.409258127212524
Epoch: 3, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.431 Vali Acc: 0.349 Test Loss: 2.431 Test Acc: 0.349
Validation loss decreased (-0.339800 --> -0.348719).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3577091
	speed: 0.4373s/iter; left time: 1774.9358s
Epoch: 4 cost time: 18.17490315437317
Epoch: 4, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.114 Vali Acc: 0.389 Test Loss: 2.114 Test Acc: 0.389
Validation loss decreased (-0.348719 --> -0.388868).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0619237
	speed: 0.4518s/iter; left time: 1764.3826s
Epoch: 5 cost time: 19.228734493255615
Epoch: 5, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.146 Vali Acc: 0.388 Test Loss: 2.146 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5027164
	speed: 0.4401s/iter; left time: 1650.6897s
Epoch: 6 cost time: 22.03831171989441
Epoch: 6, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.307 Vali Acc: 0.372 Test Loss: 2.307 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2130995
	speed: 0.4190s/iter; left time: 1507.1818s
Epoch: 7 cost time: 19.471044540405273
Epoch: 7, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.480 Vali Acc: 0.393 Test Loss: 2.480 Test Acc: 0.393
Validation loss decreased (-0.388868 --> -0.392919).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1867481
	speed: 0.4572s/iter; left time: 1574.2884s
Epoch: 8 cost time: 18.52560329437256
Epoch: 8, Steps: 154 | Train Loss: 1.392 Vali Loss: 7.284 Vali Acc: 0.085 Test Loss: 7.284 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0257487
	speed: 0.4507s/iter; left time: 1482.4370s
Epoch: 9 cost time: 23.477054357528687
Epoch: 9, Steps: 154 | Train Loss: 1.368 Vali Loss: 3.061 Vali Acc: 0.225 Test Loss: 3.061 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3746613
	speed: 0.4809s/iter; left time: 1507.7189s
Epoch: 10 cost time: 23.690717458724976
Epoch: 10, Steps: 154 | Train Loss: 1.318 Vali Loss: 3.436 Vali Acc: 0.218 Test Loss: 3.436 Test Acc: 0.218
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2508875
	speed: 0.4960s/iter; left time: 1478.4708s
Epoch: 11 cost time: 20.775627851486206
Epoch: 11, Steps: 154 | Train Loss: 1.258 Vali Loss: 4.530 Vali Acc: 0.176 Test Loss: 4.530 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.8461387
	speed: 0.5115s/iter; left time: 1446.0617s
Epoch: 12 cost time: 21.463342428207397
Epoch: 12, Steps: 154 | Train Loss: 1.237 Vali Loss: 3.659 Vali Acc: 0.380 Test Loss: 3.659 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.8344769
	speed: 0.4960s/iter; left time: 1325.7351s
Epoch: 13 cost time: 24.310770511627197
Epoch: 13, Steps: 154 | Train Loss: 1.160 Vali Loss: 6.437 Vali Acc: 0.108 Test Loss: 6.437 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.8803268
	speed: 0.4800s/iter; left time: 1209.0507s
Epoch: 14 cost time: 22.698813915252686
Epoch: 14, Steps: 154 | Train Loss: 1.122 Vali Loss: 2.906 Vali Acc: 0.399 Test Loss: 2.906 Test Acc: 0.399
Validation loss decreased (-0.392919 --> -0.399403).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4943475
	speed: 0.5093s/iter; left time: 1204.5593s
Epoch: 15 cost time: 20.80359673500061
Epoch: 15, Steps: 154 | Train Loss: 1.097 Vali Loss: 5.930 Vali Acc: 0.098 Test Loss: 5.930 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5752666
	speed: 0.5111s/iter; left time: 1130.0961s
Epoch: 16 cost time: 22.572346448898315
Epoch: 16, Steps: 154 | Train Loss: 1.031 Vali Loss: 4.773 Vali Acc: 0.131 Test Loss: 4.773 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1559900
	speed: 0.4902s/iter; left time: 1008.3803s
Epoch: 17 cost time: 24.390373706817627
Epoch: 17, Steps: 154 | Train Loss: 1.011 Vali Loss: 11.510 Vali Acc: 0.104 Test Loss: 11.510 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 2.0218818
	speed: 0.4878s/iter; left time: 928.2548s
Epoch: 18 cost time: 21.96657967567444
Epoch: 18, Steps: 154 | Train Loss: 0.949 Vali Loss: 9.055 Vali Acc: 0.116 Test Loss: 9.055 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.9866151
	speed: 0.5152s/iter; left time: 901.0921s
Epoch: 19 cost time: 20.907285928726196
Epoch: 19, Steps: 154 | Train Loss: 0.907 Vali Loss: 10.703 Vali Acc: 0.088 Test Loss: 10.703 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6252260
	speed: 0.5098s/iter; left time: 813.1841s
Epoch: 20 cost time: 23.3077449798584
Epoch: 20, Steps: 154 | Train Loss: 0.870 Vali Loss: 8.959 Vali Acc: 0.114 Test Loss: 8.959 Test Acc: 0.114
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9916360
	speed: 0.4868s/iter; left time: 701.5322s
Epoch: 21 cost time: 24.165270805358887
Epoch: 21, Steps: 154 | Train Loss: 0.859 Vali Loss: 9.833 Vali Acc: 0.092 Test Loss: 9.833 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.6175007
	speed: 0.4951s/iter; left time: 637.2074s
Epoch: 22 cost time: 21.128971099853516
Epoch: 22, Steps: 154 | Train Loss: 0.841 Vali Loss: 12.024 Vali Acc: 0.098 Test Loss: 12.024 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.1988618
	speed: 0.4450s/iter; left time: 504.1305s
Epoch: 23 cost time: 20.005335569381714
Epoch: 23, Steps: 154 | Train Loss: 0.771 Vali Loss: 7.053 Vali Acc: 0.119 Test Loss: 7.053 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.9430069
	speed: 0.4087s/iter; left time: 400.1126s
Epoch: 24 cost time: 18.393563747406006
Epoch: 24, Steps: 154 | Train Loss: 0.792 Vali Loss: 12.553 Vali Acc: 0.087 Test Loss: 12.553 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39943227899432276
model parameter : 9408526
model size : 37.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9046593
	speed: 0.0963s/iter; left time: 435.1757s
Epoch: 1 cost time: 13.417101383209229
Epoch: 1, Steps: 154 | Train Loss: 2.114 Vali Loss: 2.087 Vali Acc: 0.328 Test Loss: 2.087 Test Acc: 0.328
Validation loss decreased (inf --> -0.328041).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8921701
	speed: 0.2766s/iter; left time: 1208.0016s
Epoch: 2 cost time: 12.44885778427124
Epoch: 2, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.077 Vali Acc: 0.354 Test Loss: 2.077 Test Acc: 0.354
Validation loss decreased (-0.328041 --> -0.354399).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4776154
	speed: 0.2885s/iter; left time: 1215.2507s
Epoch: 3 cost time: 10.673546314239502
Epoch: 3, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.025 Vali Acc: 0.362 Test Loss: 2.025 Test Acc: 0.362
Validation loss decreased (-0.354399 --> -0.362105).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8140453
	speed: 0.2928s/iter; left time: 1188.4853s
Epoch: 4 cost time: 11.0218985080719
Epoch: 4, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.460 Vali Acc: 0.358 Test Loss: 2.460 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4299657
	speed: 0.2805s/iter; left time: 1095.2407s
Epoch: 5 cost time: 12.662153959274292
Epoch: 5, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.548 Vali Acc: 0.383 Test Loss: 2.548 Test Acc: 0.383
Validation loss decreased (-0.362105 --> -0.382781).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0528742
	speed: 0.2725s/iter; left time: 1022.2174s
Epoch: 6 cost time: 11.123095273971558
Epoch: 6, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.344 Vali Acc: 0.387 Test Loss: 2.344 Test Acc: 0.387
Validation loss decreased (-0.382781 --> -0.386838).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0753964
	speed: 0.2890s/iter; left time: 1039.5063s
Epoch: 7 cost time: 11.17593264579773
Epoch: 7, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.701 Vali Acc: 0.367 Test Loss: 2.701 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9474019
	speed: 0.2902s/iter; left time: 999.2850s
Epoch: 8 cost time: 11.617702960968018
Epoch: 8, Steps: 154 | Train Loss: 1.370 Vali Loss: 4.287 Vali Acc: 0.081 Test Loss: 4.287 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7398129
	speed: 0.2823s/iter; left time: 928.3396s
Epoch: 9 cost time: 12.75162649154663
Epoch: 9, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.267 Vali Acc: 0.350 Test Loss: 3.267 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6467323
	speed: 0.2856s/iter; left time: 895.3152s
Epoch: 10 cost time: 10.881461143493652
Epoch: 10, Steps: 154 | Train Loss: 1.264 Vali Loss: 4.740 Vali Acc: 0.082 Test Loss: 4.740 Test Acc: 0.082
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1272329
	speed: 0.2981s/iter; left time: 888.6515s
Epoch: 11 cost time: 11.23125958442688
Epoch: 11, Steps: 154 | Train Loss: 1.206 Vali Loss: 3.946 Vali Acc: 0.225 Test Loss: 3.946 Test Acc: 0.225
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.5954450
	speed: 0.2823s/iter; left time: 798.0374s
Epoch: 12 cost time: 12.931100845336914
Epoch: 12, Steps: 154 | Train Loss: 1.177 Vali Loss: 6.248 Vali Acc: 0.186 Test Loss: 6.248 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1971376
	speed: 0.2816s/iter; left time: 752.6354s
Epoch: 13 cost time: 12.318439722061157
Epoch: 13, Steps: 154 | Train Loss: 1.127 Vali Loss: 5.789 Vali Acc: 0.086 Test Loss: 5.789 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.0108074
	speed: 0.3327s/iter; left time: 838.1120s
Epoch: 14 cost time: 12.704828977584839
Epoch: 14, Steps: 154 | Train Loss: 1.063 Vali Loss: 6.327 Vali Acc: 0.083 Test Loss: 6.327 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7572102
	speed: 0.3290s/iter; left time: 778.1794s
Epoch: 15 cost time: 13.618981838226318
Epoch: 15, Steps: 154 | Train Loss: 1.032 Vali Loss: 8.264 Vali Acc: 0.079 Test Loss: 8.264 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.0174111
	speed: 0.3215s/iter; left time: 710.7963s
Epoch: 16 cost time: 13.048335313796997
Epoch: 16, Steps: 154 | Train Loss: 0.989 Vali Loss: 6.727 Vali Acc: 0.102 Test Loss: 6.727 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 2788366
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7023252
	speed: 0.2806s/iter; left time: 1268.4718s
Epoch: 1 cost time: 42.61149597167969
Epoch: 1, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.118 Vali Acc: 0.326 Test Loss: 2.118 Test Acc: 0.326
Validation loss decreased (inf --> -0.326013).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7874800
	speed: 0.8797s/iter; left time: 3841.4698s
Epoch: 2 cost time: 44.06491303443909
Epoch: 2, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.135 Vali Acc: 0.337 Test Loss: 2.135 Test Acc: 0.337
Validation loss decreased (-0.326013 --> -0.336962).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4299721
	speed: 0.8593s/iter; left time: 3620.1564s
Epoch: 3 cost time: 41.723480224609375
Epoch: 3, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.186 Vali Acc: 0.339 Test Loss: 2.186 Test Acc: 0.339
Validation loss decreased (-0.336962 --> -0.339394).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3031840
	speed: 0.9353s/iter; left time: 3796.2952s
Epoch: 4 cost time: 47.57899451255798
Epoch: 4, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.246 Vali Acc: 0.309 Test Loss: 2.246 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9978677
	speed: 0.9095s/iter; left time: 3551.6165s
Epoch: 5 cost time: 45.50288939476013
Epoch: 5, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.032 Vali Acc: 0.367 Test Loss: 2.032 Test Acc: 0.367
Validation loss decreased (-0.339394 --> -0.366971).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6714158
	speed: 0.9542s/iter; left time: 3579.0204s
Epoch: 6 cost time: 47.34419107437134
Epoch: 6, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.266 Vali Acc: 0.348 Test Loss: 2.266 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0007855
	speed: 0.9235s/iter; left time: 3321.6560s
Epoch: 7 cost time: 45.77790307998657
Epoch: 7, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.309 Vali Acc: 0.342 Test Loss: 2.309 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9278189
	speed: 0.8833s/iter; left time: 3041.0969s
Epoch: 8 cost time: 42.119500398635864
Epoch: 8, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.519 Vali Acc: 0.188 Test Loss: 2.519 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.8873934
	speed: 0.8034s/iter; left time: 2642.3678s
Epoch: 9 cost time: 40.07874011993408
Epoch: 9, Steps: 154 | Train Loss: 1.358 Vali Loss: 5.084 Vali Acc: 0.120 Test Loss: 5.084 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3605337
	speed: 0.8246s/iter; left time: 2585.1221s
Epoch: 10 cost time: 42.352526903152466
Epoch: 10, Steps: 154 | Train Loss: 1.364 Vali Loss: 3.070 Vali Acc: 0.168 Test Loss: 3.070 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4057746
	speed: 0.7715s/iter; left time: 2299.7000s
Epoch: 11 cost time: 37.699934244155884
Epoch: 11, Steps: 154 | Train Loss: 1.295 Vali Loss: 3.078 Vali Acc: 0.142 Test Loss: 3.078 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.8960751
	speed: 0.7464s/iter; left time: 2110.1613s
Epoch: 12 cost time: 38.441861391067505
Epoch: 12, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.580 Vali Acc: 0.351 Test Loss: 2.580 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5511007
	speed: 0.7587s/iter; left time: 2027.9120s
Epoch: 13 cost time: 37.50015568733215
Epoch: 13, Steps: 154 | Train Loss: 1.202 Vali Loss: 5.491 Vali Acc: 0.088 Test Loss: 5.491 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.5138594
	speed: 0.7606s/iter; left time: 1916.0528s
Epoch: 14 cost time: 38.61449146270752
Epoch: 14, Steps: 154 | Train Loss: 1.159 Vali Loss: 4.756 Vali Acc: 0.099 Test Loss: 4.756 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.8813412
	speed: 0.7557s/iter; left time: 1787.1286s
Epoch: 15 cost time: 39.16289234161377
Epoch: 15, Steps: 154 | Train Loss: 1.108 Vali Loss: 5.246 Vali Acc: 0.102 Test Loss: 5.246 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 9392398
model size : 36.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1786785
	speed: 0.1627s/iter; left time: 735.5817s
Epoch: 1 cost time: 23.994242668151855
Epoch: 1, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.109 Vali Acc: 0.329 Test Loss: 2.109 Test Acc: 0.329
Validation loss decreased (inf --> -0.329257).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7950047
	speed: 0.4956s/iter; left time: 2164.4942s
Epoch: 2 cost time: 22.35658025741577
Epoch: 2, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.370 Vali Acc: 0.312 Test Loss: 2.370 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8252811
	speed: 0.4887s/iter; left time: 2058.8830s
Epoch: 3 cost time: 22.24859642982483
Epoch: 3, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.214 Vali Acc: 0.313 Test Loss: 2.214 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.5665451
	speed: 0.4864s/iter; left time: 1974.1204s
Epoch: 4 cost time: 22.140525817871094
Epoch: 4, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.515 Vali Acc: 0.182 Test Loss: 2.515 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 1.5471524
	speed: 0.5186s/iter; left time: 2025.1845s
Epoch: 5 cost time: 27.06356143951416
Epoch: 5, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.069 Vali Acc: 0.373 Test Loss: 2.069 Test Acc: 0.373
Validation loss decreased (-0.329257 --> -0.372648).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8001512
	speed: 0.5367s/iter; left time: 2013.1235s
Epoch: 6 cost time: 24.556588411331177
Epoch: 6, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.039 Vali Acc: 0.229 Test Loss: 3.039 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9442146
	speed: 0.5595s/iter; left time: 2012.5958s
Epoch: 7 cost time: 24.305907726287842
Epoch: 7, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.928 Vali Acc: 0.174 Test Loss: 2.928 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6013505
	speed: 0.5478s/iter; left time: 1885.9656s
Epoch: 8 cost time: 27.177473545074463
Epoch: 8, Steps: 154 | Train Loss: 1.377 Vali Loss: 6.801 Vali Acc: 0.117 Test Loss: 6.801 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5586327
	speed: 0.5409s/iter; left time: 1778.9962s
Epoch: 9 cost time: 23.953163862228394
Epoch: 9, Steps: 154 | Train Loss: 1.327 Vali Loss: 4.849 Vali Acc: 0.077 Test Loss: 4.849 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.5294802
	speed: 0.5622s/iter; left time: 1762.4921s
Epoch: 10 cost time: 24.565590858459473
Epoch: 10, Steps: 154 | Train Loss: 1.293 Vali Loss: 1.995 Vali Acc: 0.403 Test Loss: 1.995 Test Acc: 0.403
Validation loss decreased (-0.372648 --> -0.402656).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8186864
	speed: 0.5433s/iter; left time: 1619.6126s
Epoch: 11 cost time: 27.104439973831177
Epoch: 11, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.875 Vali Acc: 0.201 Test Loss: 2.875 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1152155
	speed: 0.5459s/iter; left time: 1543.1758s
Epoch: 12 cost time: 23.962684869766235
Epoch: 12, Steps: 154 | Train Loss: 1.193 Vali Loss: 9.931 Vali Acc: 0.087 Test Loss: 9.931 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9457955
	speed: 0.5612s/iter; left time: 1500.1132s
Epoch: 13 cost time: 24.382391214370728
Epoch: 13, Steps: 154 | Train Loss: 1.140 Vali Loss: 10.523 Vali Acc: 0.127 Test Loss: 10.523 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.5144091
	speed: 0.4927s/iter; left time: 1241.1610s
Epoch: 14 cost time: 24.548109769821167
Epoch: 14, Steps: 154 | Train Loss: 1.135 Vali Loss: 10.241 Vali Acc: 0.080 Test Loss: 10.241 Test Acc: 0.080
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7344744
	speed: 0.4936s/iter; left time: 1167.3200s
Epoch: 15 cost time: 21.35235857963562
Epoch: 15, Steps: 154 | Train Loss: 1.082 Vali Loss: 6.707 Vali Acc: 0.137 Test Loss: 6.707 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.7904506
	speed: 0.5068s/iter; left time: 1120.4897s
Epoch: 16 cost time: 22.890382766723633
Epoch: 16, Steps: 154 | Train Loss: 1.037 Vali Loss: 9.181 Vali Acc: 0.089 Test Loss: 9.181 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5180683
	speed: 0.4796s/iter; left time: 986.6382s
Epoch: 17 cost time: 23.538562774658203
Epoch: 17, Steps: 154 | Train Loss: 0.993 Vali Loss: 6.492 Vali Acc: 0.111 Test Loss: 6.492 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.6574874
	speed: 0.4926s/iter; left time: 937.4913s
Epoch: 18 cost time: 21.387811183929443
Epoch: 18, Steps: 154 | Train Loss: 0.974 Vali Loss: 10.200 Vali Acc: 0.079 Test Loss: 10.200 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.3457876
	speed: 0.4956s/iter; left time: 866.8734s
Epoch: 19 cost time: 22.612836599349976
Epoch: 19, Steps: 154 | Train Loss: 0.947 Vali Loss: 9.721 Vali Acc: 0.090 Test Loss: 9.721 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2759683
	speed: 0.4758s/iter; left time: 758.8763s
Epoch: 20 cost time: 22.98073720932007
Epoch: 20, Steps: 154 | Train Loss: 0.896 Vali Loss: 5.591 Vali Acc: 0.104 Test Loss: 5.591 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.402676399026764
model parameter : 2771982
model size : 11.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7216710
	speed: 0.2253s/iter; left time: 1018.5635s
Epoch: 1 cost time: 34.26487946510315
Epoch: 1, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.109 Vali Acc: 0.329 Test Loss: 2.109 Test Acc: 0.329
Validation loss decreased (inf --> -0.329257).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7295151
	speed: 0.6399s/iter; left time: 2794.3201s
Epoch: 2 cost time: 30.664036989212036
Epoch: 2, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.104 Vali Acc: 0.329 Test Loss: 2.104 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.5924394
	speed: 0.6521s/iter; left time: 2747.1836s
Epoch: 3 cost time: 29.820116996765137
Epoch: 3, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.195 Vali Acc: 0.334 Test Loss: 2.195 Test Acc: 0.334
Validation loss decreased (-0.329257 --> -0.333717).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0998955
	speed: 0.7087s/iter; left time: 2876.7471s
Epoch: 4 cost time: 34.008153200149536
Epoch: 4, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.086 Vali Acc: 0.200 Test Loss: 2.086 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0415075
	speed: 0.7260s/iter; left time: 2834.8735s
Epoch: 5 cost time: 35.98820185661316
Epoch: 5, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.049 Vali Acc: 0.365 Test Loss: 2.049 Test Acc: 0.365
Validation loss decreased (-0.333717 --> -0.365349).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7442564
	speed: 0.7157s/iter; left time: 2684.4798s
Epoch: 6 cost time: 36.63259744644165
Epoch: 6, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.201 Vali Acc: 0.351 Test Loss: 2.201 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9486118
	speed: 0.7175s/iter; left time: 2580.8594s
Epoch: 7 cost time: 35.38761639595032
Epoch: 7, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.225 Vali Acc: 0.352 Test Loss: 2.225 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9893935
	speed: 0.7297s/iter; left time: 2512.4348s
Epoch: 8 cost time: 33.45451784133911
Epoch: 8, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.601 Vali Acc: 0.238 Test Loss: 2.601 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3821397
	speed: 0.7283s/iter; left time: 2395.5223s
Epoch: 9 cost time: 33.594406604766846
Epoch: 9, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.779 Vali Acc: 0.206 Test Loss: 2.779 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2974951
	speed: 0.7357s/iter; left time: 2306.4807s
Epoch: 10 cost time: 35.79859185218811
Epoch: 10, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.160 Vali Acc: 0.204 Test Loss: 3.160 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.6458411
	speed: 0.7144s/iter; left time: 2129.5037s
Epoch: 11 cost time: 37.431092739105225
Epoch: 11, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.786 Vali Acc: 0.369 Test Loss: 2.786 Test Acc: 0.369
Validation loss decreased (-0.365349 --> -0.368991).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.8084800
	speed: 0.7256s/iter; left time: 2051.4125s
Epoch: 12 cost time: 35.878026485443115
Epoch: 12, Steps: 154 | Train Loss: 1.249 Vali Loss: 2.313 Vali Acc: 0.339 Test Loss: 2.313 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4216740
	speed: 0.7209s/iter; left time: 1926.9482s
Epoch: 13 cost time: 33.96565771102905
Epoch: 13, Steps: 154 | Train Loss: 1.204 Vali Loss: 4.721 Vali Acc: 0.085 Test Loss: 4.721 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4465606
	speed: 0.7291s/iter; left time: 1836.6534s
Epoch: 14 cost time: 33.556493282318115
Epoch: 14, Steps: 154 | Train Loss: 1.184 Vali Loss: 2.982 Vali Acc: 0.311 Test Loss: 2.982 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8700397
	speed: 0.7195s/iter; left time: 1701.7118s
Epoch: 15 cost time: 36.409557819366455
Epoch: 15, Steps: 154 | Train Loss: 1.140 Vali Loss: 3.097 Vali Acc: 0.199 Test Loss: 3.097 Test Acc: 0.199
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.7729307
	speed: 1.2772s/iter; left time: 2823.7850s
Epoch: 16 cost time: 68.26675128936768
Epoch: 16, Steps: 154 | Train Loss: 1.104 Vali Loss: 3.252 Vali Acc: 0.240 Test Loss: 3.252 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.4325469
	speed: 1.4135s/iter; left time: 2907.4905s
Epoch: 17 cost time: 69.30949115753174
Epoch: 17, Steps: 154 | Train Loss: 1.048 Vali Loss: 3.601 Vali Acc: 0.159 Test Loss: 3.601 Test Acc: 0.159
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.7203876
	speed: 1.5786s/iter; left time: 3004.0969s
Epoch: 18 cost time: 75.24021005630493
Epoch: 18, Steps: 154 | Train Loss: 1.085 Vali Loss: 3.753 Vali Acc: 0.369 Test Loss: 3.753 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.4593049
	speed: 1.4105s/iter; left time: 2466.9889s
Epoch: 19 cost time: 59.35427784919739
Epoch: 19, Steps: 154 | Train Loss: 1.015 Vali Loss: 4.070 Vali Acc: 0.311 Test Loss: 4.070 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.8558205
	speed: 1.2448s/iter; left time: 1985.5348s
Epoch: 20 cost time: 57.92564058303833
Epoch: 20, Steps: 154 | Train Loss: 0.970 Vali Loss: 9.342 Vali Acc: 0.090 Test Loss: 9.342 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.8630736
	speed: 1.2516s/iter; left time: 1803.5516s
Epoch: 21 cost time: 59.07524108886719
Epoch: 21, Steps: 154 | Train Loss: 0.947 Vali Loss: 5.456 Vali Acc: 0.127 Test Loss: 5.456 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36901865369018655
model parameter : 9392398
model size : 36.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1816397
	speed: 0.2659s/iter; left time: 1202.1918s
Epoch: 1 cost time: 40.37870478630066
Epoch: 1, Steps: 154 | Train Loss: 2.124 Vali Loss: 2.117 Vali Acc: 0.329 Test Loss: 2.117 Test Acc: 0.329
Validation loss decreased (inf --> -0.329257).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8003196
	speed: 0.8786s/iter; left time: 3836.8172s
Epoch: 2 cost time: 36.17615294456482
Epoch: 2, Steps: 154 | Train Loss: 1.912 Vali Loss: 2.199 Vali Acc: 0.344 Test Loss: 2.199 Test Acc: 0.344
Validation loss decreased (-0.329257 --> -0.344260).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7694212
	speed: 0.8856s/iter; left time: 3731.0782s
Epoch: 3 cost time: 36.46071434020996
Epoch: 3, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.151 Vali Acc: 0.365 Test Loss: 2.151 Test Acc: 0.365
Validation loss decreased (-0.344260 --> -0.364536).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6928413
	speed: 0.8473s/iter; left time: 3439.0489s
Epoch: 4 cost time: 40.418373584747314
Epoch: 4, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.545 Vali Acc: 0.190 Test Loss: 2.545 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3838875
	speed: 0.9158s/iter; left time: 3576.2668s
Epoch: 5 cost time: 39.90167784690857
Epoch: 5, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.055 Vali Acc: 0.374 Test Loss: 2.055 Test Acc: 0.374
Validation loss decreased (-0.364536 --> -0.374270).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5514871
	speed: 0.8883s/iter; left time: 3331.9465s
Epoch: 6 cost time: 38.76838254928589
Epoch: 6, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.328 Vali Acc: 0.182 Test Loss: 2.328 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2400475
	speed: 0.9462s/iter; left time: 3403.4976s
Epoch: 7 cost time: 39.13611888885498
Epoch: 7, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.222 Vali Acc: 0.095 Test Loss: 3.222 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6215203
	speed: 0.9561s/iter; left time: 3291.8081s
Epoch: 8 cost time: 39.84517502784729
Epoch: 8, Steps: 154 | Train Loss: 1.386 Vali Loss: 4.436 Vali Acc: 0.081 Test Loss: 4.436 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5793788
	speed: 0.9201s/iter; left time: 3026.2673s
Epoch: 9 cost time: 41.53619027137756
Epoch: 9, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.067 Vali Acc: 0.337 Test Loss: 3.067 Test Acc: 0.337
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.6388462
	speed: 0.9328s/iter; left time: 2924.3654s
Epoch: 10 cost time: 40.36556792259216
Epoch: 10, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.447 Vali Acc: 0.416 Test Loss: 2.447 Test Acc: 0.416
Validation loss decreased (-0.374270 --> -0.415628).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8279909
	speed: 0.8847s/iter; left time: 2637.2214s
Epoch: 11 cost time: 38.17140531539917
Epoch: 11, Steps: 154 | Train Loss: 1.235 Vali Loss: 2.766 Vali Acc: 0.250 Test Loss: 2.766 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9964286
	speed: 0.9262s/iter; left time: 2618.5016s
Epoch: 12 cost time: 38.467331647872925
Epoch: 12, Steps: 154 | Train Loss: 1.198 Vali Loss: 4.277 Vali Acc: 0.118 Test Loss: 4.277 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0117756
	speed: 0.9276s/iter; left time: 2479.4464s
Epoch: 13 cost time: 39.46445322036743
Epoch: 13, Steps: 154 | Train Loss: 1.157 Vali Loss: 7.365 Vali Acc: 0.105 Test Loss: 7.365 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6002127
	speed: 0.8639s/iter; left time: 2176.1528s
Epoch: 14 cost time: 41.11900186538696
Epoch: 14, Steps: 154 | Train Loss: 1.116 Vali Loss: 3.946 Vali Acc: 0.122 Test Loss: 3.946 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.7527887
	speed: 0.9174s/iter; left time: 2169.6455s
Epoch: 15 cost time: 38.34129095077515
Epoch: 15, Steps: 154 | Train Loss: 1.091 Vali Loss: 3.249 Vali Acc: 0.344 Test Loss: 3.249 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.8325406
	speed: 0.9267s/iter; left time: 2049.0129s
Epoch: 16 cost time: 41.946078300476074
Epoch: 16, Steps: 154 | Train Loss: 1.070 Vali Loss: 4.120 Vali Acc: 0.150 Test Loss: 4.120 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.1738164
	speed: 0.9480s/iter; left time: 1950.0554s
Epoch: 17 cost time: 41.02795743942261
Epoch: 17, Steps: 154 | Train Loss: 1.029 Vali Loss: 5.610 Vali Acc: 0.105 Test Loss: 5.610 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.6971608
	speed: 0.9667s/iter; left time: 1839.5968s
Epoch: 18 cost time: 40.32268404960632
Epoch: 18, Steps: 154 | Train Loss: 0.994 Vali Loss: 10.403 Vali Acc: 0.088 Test Loss: 10.403 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.4331735
	speed: 0.9204s/iter; left time: 1609.7124s
Epoch: 19 cost time: 37.24854016304016
Epoch: 19, Steps: 154 | Train Loss: 0.987 Vali Loss: 9.754 Vali Acc: 0.086 Test Loss: 9.754 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2664875
	speed: 0.8903s/iter; left time: 1419.9610s
Epoch: 20 cost time: 39.39518880844116
Epoch: 20, Steps: 154 | Train Loss: 0.932 Vali Loss: 7.703 Vali Acc: 0.084 Test Loss: 7.703 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41565287915652877
model parameter : 2771982
model size : 11.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7358620
	speed: 0.3143s/iter; left time: 1421.0924s
Epoch: 1 cost time: 47.00257682800293
Epoch: 1, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.129 Vali Acc: 0.317 Test Loss: 2.129 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7218103
	speed: 0.9549s/iter; left time: 4169.9639s
Epoch: 2 cost time: 44.49823307991028
Epoch: 2, Steps: 154 | Train Loss: 1.945 Vali Loss: 2.160 Vali Acc: 0.326 Test Loss: 2.160 Test Acc: 0.326
Validation loss decreased (-0.317091 --> -0.326418).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5664828
	speed: 0.9671s/iter; left time: 4074.4815s
Epoch: 3 cost time: 42.892704486846924
Epoch: 3, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.126 Vali Acc: 0.344 Test Loss: 2.126 Test Acc: 0.344
Validation loss decreased (-0.326418 --> -0.344261).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1464372
	speed: 0.9252s/iter; left time: 3755.5031s
Epoch: 4 cost time: 37.29714775085449
Epoch: 4, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.205 Vali Acc: 0.349 Test Loss: 2.205 Test Acc: 0.349
Validation loss decreased (-0.344261 --> -0.349126).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9369266
	speed: 0.9648s/iter; left time: 3767.3971s
Epoch: 5 cost time: 42.2571804523468
Epoch: 5, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.071 Vali Acc: 0.367 Test Loss: 2.071 Test Acc: 0.367
Validation loss decreased (-0.349126 --> -0.366970).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5871745
	speed: 0.8800s/iter; left time: 3300.8411s
Epoch: 6 cost time: 42.8134765625
Epoch: 6, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.441 Vali Acc: 0.369 Test Loss: 2.441 Test Acc: 0.369
Validation loss decreased (-0.366970 --> -0.368994).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8619145
	speed: 0.9046s/iter; left time: 3253.7664s
Epoch: 7 cost time: 37.30614686012268
Epoch: 7, Steps: 154 | Train Loss: 1.524 Vali Loss: 3.010 Vali Acc: 0.165 Test Loss: 3.010 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0761745
	speed: 0.9121s/iter; left time: 3140.2076s
Epoch: 8 cost time: 41.24441194534302
Epoch: 8, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.951 Vali Acc: 0.275 Test Loss: 2.951 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1029161
	speed: 0.9205s/iter; left time: 3027.5840s
Epoch: 9 cost time: 39.68293595314026
Epoch: 9, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.077 Vali Acc: 0.399 Test Loss: 3.077 Test Acc: 0.399
Validation loss decreased (-0.368994 --> -0.398996).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1059729
	speed: 0.9276s/iter; left time: 2908.1482s
Epoch: 10 cost time: 41.522817611694336
Epoch: 10, Steps: 154 | Train Loss: 1.423 Vali Loss: 7.004 Vali Acc: 0.106 Test Loss: 7.004 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3041525
	speed: 0.9240s/iter; left time: 2754.4577s
Epoch: 11 cost time: 44.66762137413025
Epoch: 11, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.098 Vali Acc: 0.372 Test Loss: 2.098 Test Acc: 0.372
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8930211
	speed: 0.8835s/iter; left time: 2497.6289s
Epoch: 12 cost time: 41.84711003303528
Epoch: 12, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.082 Vali Acc: 0.227 Test Loss: 3.082 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3636484
	speed: 0.9068s/iter; left time: 2423.8253s
Epoch: 13 cost time: 40.090906858444214
Epoch: 13, Steps: 154 | Train Loss: 1.282 Vali Loss: 5.403 Vali Acc: 0.192 Test Loss: 5.403 Test Acc: 0.192
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3899294
	speed: 0.9581s/iter; left time: 2413.5415s
Epoch: 14 cost time: 43.00776958465576
Epoch: 14, Steps: 154 | Train Loss: 1.256 Vali Loss: 5.934 Vali Acc: 0.178 Test Loss: 5.934 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.0231560
	speed: 0.9621s/iter; left time: 2275.2913s
Epoch: 15 cost time: 44.52156853675842
Epoch: 15, Steps: 154 | Train Loss: 1.224 Vali Loss: 4.126 Vali Acc: 0.179 Test Loss: 4.126 Test Acc: 0.179
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.7791911
	speed: 0.8869s/iter; left time: 1960.9529s
Epoch: 16 cost time: 41.980058431625366
Epoch: 16, Steps: 154 | Train Loss: 1.180 Vali Loss: 4.813 Vali Acc: 0.204 Test Loss: 4.813 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.5335431
	speed: 0.8934s/iter; left time: 1837.6691s
Epoch: 17 cost time: 39.62265467643738
Epoch: 17, Steps: 154 | Train Loss: 1.133 Vali Loss: 6.606 Vali Acc: 0.179 Test Loss: 6.606 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.5392283
	speed: 0.9743s/iter; left time: 1854.1390s
Epoch: 18 cost time: 42.834306955337524
Epoch: 18, Steps: 154 | Train Loss: 1.158 Vali Loss: 4.371 Vali Acc: 0.222 Test Loss: 4.371 Test Acc: 0.222
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.2271974
	speed: 0.9814s/iter; left time: 1716.3982s
Epoch: 19 cost time: 43.038986682891846
Epoch: 19, Steps: 154 | Train Loss: 1.173 Vali Loss: 5.222 Vali Acc: 0.238 Test Loss: 5.222 Test Acc: 0.238
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39902676399026765
model parameter : 9392398
model size : 36.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2359011
	speed: 0.2133s/iter; left time: 964.4369s
Epoch: 1 cost time: 31.447737216949463
Epoch: 1, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.122 Vali Acc: 0.324 Test Loss: 2.122 Test Acc: 0.324
Validation loss decreased (inf --> -0.324391).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8334558
	speed: 0.7066s/iter; left time: 3085.8944s
Epoch: 2 cost time: 29.2736554145813
Epoch: 2, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.249 Vali Acc: 0.346 Test Loss: 2.249 Test Acc: 0.346
Validation loss decreased (-0.324391 --> -0.346287).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6002008
	speed: 0.7023s/iter; left time: 2958.6853s
Epoch: 3 cost time: 28.94484305381775
Epoch: 3, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.188 Vali Acc: 0.372 Test Loss: 2.188 Test Acc: 0.372
Validation loss decreased (-0.346287 --> -0.371835).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6080741
	speed: 0.6911s/iter; left time: 2805.1306s
Epoch: 4 cost time: 29.204588174819946
Epoch: 4, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.248 Vali Acc: 0.262 Test Loss: 2.248 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4299093
	speed: 0.6945s/iter; left time: 2712.0605s
Epoch: 5 cost time: 28.446224212646484
Epoch: 5, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.204 Vali Acc: 0.361 Test Loss: 2.204 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6502386
	speed: 0.7074s/iter; left time: 2653.5615s
Epoch: 6 cost time: 28.198465824127197
Epoch: 6, Steps: 154 | Train Loss: 1.550 Vali Loss: 3.788 Vali Acc: 0.163 Test Loss: 3.788 Test Acc: 0.163
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5431896
	speed: 0.6931s/iter; left time: 2493.2248s
Epoch: 7 cost time: 29.555335998535156
Epoch: 7, Steps: 154 | Train Loss: 1.495 Vali Loss: 4.727 Vali Acc: 0.103 Test Loss: 4.727 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.4940815
	speed: 0.6325s/iter; left time: 2177.7099s
Epoch: 8 cost time: 27.27470874786377
Epoch: 8, Steps: 154 | Train Loss: 1.430 Vali Loss: 6.694 Vali Acc: 0.060 Test Loss: 6.694 Test Acc: 0.060
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.4933749
	speed: 0.6527s/iter; left time: 2146.8310s
Epoch: 9 cost time: 25.40881085395813
Epoch: 9, Steps: 154 | Train Loss: 1.383 Vali Loss: 5.379 Vali Acc: 0.158 Test Loss: 5.379 Test Acc: 0.158
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.7004879
	speed: 0.6552s/iter; left time: 2054.0326s
Epoch: 10 cost time: 26.43039608001709
Epoch: 10, Steps: 154 | Train Loss: 1.341 Vali Loss: 4.912 Vali Acc: 0.194 Test Loss: 4.912 Test Acc: 0.194
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.8552725
	speed: 0.5938s/iter; left time: 1770.1794s
Epoch: 11 cost time: 24.39385437965393
Epoch: 11, Steps: 154 | Train Loss: 1.309 Vali Loss: 3.474 Vali Acc: 0.313 Test Loss: 3.474 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.0109867
	speed: 0.6556s/iter; left time: 1853.4569s
Epoch: 12 cost time: 26.515347480773926
Epoch: 12, Steps: 154 | Train Loss: 1.265 Vali Loss: 3.970 Vali Acc: 0.227 Test Loss: 3.970 Test Acc: 0.227
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.2453014
	speed: 0.6663s/iter; left time: 1780.9917s
Epoch: 13 cost time: 26.110791444778442
Epoch: 13, Steps: 154 | Train Loss: 1.225 Vali Loss: 6.437 Vali Acc: 0.094 Test Loss: 6.437 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3718572587185726
model parameter : 2771982
model size : 11.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8611058
	speed: 0.3685s/iter; left time: 1666.0124s
Epoch: 1 cost time: 56.18484663963318
Epoch: 1, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.052 Vali Acc: 0.331 Test Loss: 2.052 Test Acc: 0.331
Validation loss decreased (inf --> -0.330880).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5494829
	speed: 1.1726s/iter; left time: 5120.8055s
Epoch: 2 cost time: 55.24374842643738
Epoch: 2, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.226 Vali Acc: 0.356 Test Loss: 2.226 Test Acc: 0.356
Validation loss decreased (-0.330880 --> -0.356020).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0313013
	speed: 1.1284s/iter; left time: 4753.8258s
Epoch: 3 cost time: 53.28585410118103
Epoch: 3, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.042 Vali Acc: 0.355 Test Loss: 2.042 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7816097
	speed: 1.1378s/iter; left time: 4618.2212s
Epoch: 4 cost time: 50.19401216506958
Epoch: 4, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.413 Vali Acc: 0.204 Test Loss: 2.413 Test Acc: 0.204
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.5396742
	speed: 1.0819s/iter; left time: 4224.6642s
Epoch: 5 cost time: 51.05534815788269
Epoch: 5, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.424 Vali Acc: 0.236 Test Loss: 2.424 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0186677
	speed: 1.1204s/iter; left time: 4202.6359s
Epoch: 6 cost time: 51.614237785339355
Epoch: 6, Steps: 154 | Train Loss: 1.480 Vali Loss: 3.003 Vali Acc: 0.193 Test Loss: 3.003 Test Acc: 0.193
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.8649851
	speed: 1.0767s/iter; left time: 3872.8776s
Epoch: 7 cost time: 52.30515694618225
Epoch: 7, Steps: 154 | Train Loss: 1.414 Vali Loss: 1.989 Vali Acc: 0.334 Test Loss: 1.989 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.2729685
	speed: 1.1442s/iter; left time: 3939.4726s
Epoch: 8 cost time: 57.10630798339844
Epoch: 8, Steps: 154 | Train Loss: 1.360 Vali Loss: 2.457 Vali Acc: 0.252 Test Loss: 2.457 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.4282138
	speed: 1.2447s/iter; left time: 4093.7400s
Epoch: 9 cost time: 58.78678011894226
Epoch: 9, Steps: 154 | Train Loss: 1.343 Vali Loss: 2.413 Vali Acc: 0.379 Test Loss: 2.413 Test Acc: 0.379
Validation loss decreased (-0.356020 --> -0.378727).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5904222
	speed: 1.2696s/iter; left time: 3980.3247s
Epoch: 10 cost time: 59.4165096282959
Epoch: 10, Steps: 154 | Train Loss: 1.322 Vali Loss: 3.525 Vali Acc: 0.108 Test Loss: 3.525 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3517097
	speed: 1.1879s/iter; left time: 3541.2650s
Epoch: 11 cost time: 57.22594094276428
Epoch: 11, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.005 Vali Acc: 0.178 Test Loss: 3.005 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9625192
	speed: 1.1891s/iter; left time: 3361.5621s
Epoch: 12 cost time: 57.54311680793762
Epoch: 12, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.600 Vali Acc: 0.222 Test Loss: 2.600 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4162562
	speed: 1.2443s/iter; left time: 3326.1306s
Epoch: 13 cost time: 58.620179176330566
Epoch: 13, Steps: 154 | Train Loss: 1.186 Vali Loss: 2.203 Vali Acc: 0.255 Test Loss: 2.203 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3132954
	speed: 1.2018s/iter; left time: 3027.2885s
Epoch: 14 cost time: 57.090189933776855
Epoch: 14, Steps: 154 | Train Loss: 1.130 Vali Loss: 3.397 Vali Acc: 0.131 Test Loss: 3.397 Test Acc: 0.131
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.6537210
	speed: 1.1768s/iter; left time: 2783.0766s
Epoch: 15 cost time: 57.06702280044556
Epoch: 15, Steps: 154 | Train Loss: 1.108 Vali Loss: 2.607 Vali Acc: 0.414 Test Loss: 2.607 Test Acc: 0.414
Validation loss decreased (-0.378727 --> -0.413599).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3080612
	speed: 1.1875s/iter; left time: 2625.6500s
Epoch: 16 cost time: 52.03828287124634
Epoch: 16, Steps: 154 | Train Loss: 1.118 Vali Loss: 2.387 Vali Acc: 0.230 Test Loss: 2.387 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.0845528
	speed: 1.1719s/iter; left time: 2410.6837s
Epoch: 17 cost time: 55.865477561950684
Epoch: 17, Steps: 154 | Train Loss: 1.041 Vali Loss: 3.611 Vali Acc: 0.129 Test Loss: 3.611 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.9069448
	speed: 1.2615s/iter; left time: 2400.6840s
Epoch: 18 cost time: 59.595800161361694
Epoch: 18, Steps: 154 | Train Loss: 0.995 Vali Loss: 3.147 Vali Acc: 0.224 Test Loss: 3.147 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.1296999
	speed: 1.1720s/iter; left time: 2049.8814s
Epoch: 19 cost time: 52.18410921096802
Epoch: 19, Steps: 154 | Train Loss: 0.987 Vali Loss: 4.099 Vali Acc: 0.103 Test Loss: 4.099 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9558501
	speed: 1.0210s/iter; left time: 1628.4368s
Epoch: 20 cost time: 48.9220495223999
Epoch: 20, Steps: 154 | Train Loss: 0.951 Vali Loss: 2.320 Vali Acc: 0.309 Test Loss: 2.320 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.7350038
	speed: 1.1365s/iter; left time: 1637.7014s
Epoch: 21 cost time: 52.580684185028076
Epoch: 21, Steps: 154 | Train Loss: 0.887 Vali Loss: 2.760 Vali Acc: 0.323 Test Loss: 2.760 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.1323109
	speed: 1.0518s/iter; left time: 1353.7294s
Epoch: 22 cost time: 48.18989944458008
Epoch: 22, Steps: 154 | Train Loss: 0.877 Vali Loss: 3.795 Vali Acc: 0.140 Test Loss: 3.795 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.7463313
	speed: 1.0988s/iter; left time: 1244.9950s
Epoch: 23 cost time: 52.568567514419556
Epoch: 23, Steps: 154 | Train Loss: 0.851 Vali Loss: 3.811 Vali Acc: 0.296 Test Loss: 3.811 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.4275029
	speed: 1.0166s/iter; left time: 995.2711s
Epoch: 24 cost time: 50.66551923751831
Epoch: 24, Steps: 154 | Train Loss: 0.808 Vali Loss: 5.351 Vali Acc: 0.101 Test Loss: 5.351 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.9597532
	speed: 1.1551s/iter; left time: 952.9163s
Epoch: 25 cost time: 53.668744802474976
Epoch: 25, Steps: 154 | Train Loss: 0.789 Vali Loss: 3.505 Vali Acc: 0.300 Test Loss: 3.505 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41362530413625304
model parameter : 4705038
model size : 18.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1445429
	speed: 0.2218s/iter; left time: 1002.9749s
Epoch: 1 cost time: 34.183594703674316
Epoch: 1, Steps: 154 | Train Loss: 2.115 Vali Loss: 2.172 Vali Acc: 0.324 Test Loss: 2.172 Test Acc: 0.324
Validation loss decreased (inf --> -0.323579).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0049841
	speed: 0.8004s/iter; left time: 3495.5056s
Epoch: 2 cost time: 35.874760150909424
Epoch: 2, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.055 Vali Acc: 0.339 Test Loss: 2.055 Test Acc: 0.339
Validation loss decreased (-0.323579 --> -0.338584).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9885421
	speed: 0.7650s/iter; left time: 3222.7629s
Epoch: 3 cost time: 36.82440996170044
Epoch: 3, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.303 Vali Acc: 0.090 Test Loss: 2.303 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5659024
	speed: 0.8523s/iter; left time: 3459.3854s
Epoch: 4 cost time: 38.22599267959595
Epoch: 4, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.876 Vali Acc: 0.113 Test Loss: 2.876 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2218854
	speed: 0.8113s/iter; left time: 3168.0480s
Epoch: 5 cost time: 32.4048810005188
Epoch: 5, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.101 Vali Acc: 0.371 Test Loss: 2.101 Test Acc: 0.371
Validation loss decreased (-0.338584 --> -0.371025).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1720920
	speed: 0.7541s/iter; left time: 2828.7362s
Epoch: 6 cost time: 25.52226424217224
Epoch: 6, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.310 Vali Acc: 0.170 Test Loss: 2.310 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0934393
	speed: 0.7790s/iter; left time: 2802.1713s
Epoch: 7 cost time: 35.93421268463135
Epoch: 7, Steps: 154 | Train Loss: 1.413 Vali Loss: 4.040 Vali Acc: 0.119 Test Loss: 4.040 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3393499
	speed: 0.7930s/iter; left time: 2730.1777s
Epoch: 8 cost time: 31.788674354553223
Epoch: 8, Steps: 154 | Train Loss: 1.337 Vali Loss: 4.523 Vali Acc: 0.097 Test Loss: 4.523 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.5948536
	speed: 0.7554s/iter; left time: 2484.3965s
Epoch: 9 cost time: 36.370251417160034
Epoch: 9, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.526 Vali Acc: 0.161 Test Loss: 2.526 Test Acc: 0.161
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2938781
	speed: 0.8451s/iter; left time: 2649.2628s
Epoch: 10 cost time: 37.74132442474365
Epoch: 10, Steps: 154 | Train Loss: 1.280 Vali Loss: 2.640 Vali Acc: 0.311 Test Loss: 2.640 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.6315203
	speed: 0.8037s/iter; left time: 2395.7025s
Epoch: 11 cost time: 35.26780462265015
Epoch: 11, Steps: 154 | Train Loss: 1.225 Vali Loss: 5.205 Vali Acc: 0.115 Test Loss: 5.205 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.4155875
	speed: 0.7937s/iter; left time: 2243.7985s
Epoch: 12 cost time: 31.18727159500122
Epoch: 12, Steps: 154 | Train Loss: 1.161 Vali Loss: 7.888 Vali Acc: 0.099 Test Loss: 7.888 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.8259256
	speed: 0.8138s/iter; left time: 2175.2192s
Epoch: 13 cost time: 35.68655061721802
Epoch: 13, Steps: 154 | Train Loss: 1.158 Vali Loss: 4.284 Vali Acc: 0.104 Test Loss: 4.284 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0069582
	speed: 0.7769s/iter; left time: 1957.0072s
Epoch: 14 cost time: 33.3633828163147
Epoch: 14, Steps: 154 | Train Loss: 1.109 Vali Loss: 7.036 Vali Acc: 0.100 Test Loss: 7.036 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.1795950
	speed: 0.7468s/iter; left time: 1766.2811s
Epoch: 15 cost time: 32.88685154914856
Epoch: 15, Steps: 154 | Train Loss: 1.081 Vali Loss: 6.380 Vali Acc: 0.103 Test Loss: 6.380 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3710462287104623
model parameter : 1394702
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8625945
	speed: 0.2521s/iter; left time: 1139.6968s
Epoch: 1 cost time: 39.63699436187744
Epoch: 1, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.056 Vali Acc: 0.333 Test Loss: 2.056 Test Acc: 0.333
Validation loss decreased (inf --> -0.332907).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5502752
	speed: 0.8478s/iter; left time: 3702.4989s
Epoch: 2 cost time: 38.167741775512695
Epoch: 2, Steps: 154 | Train Loss: 1.875 Vali Loss: 2.220 Vali Acc: 0.356 Test Loss: 2.220 Test Acc: 0.356
Validation loss decreased (-0.332907 --> -0.355614).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9224476
	speed: 0.8039s/iter; left time: 3386.6407s
Epoch: 3 cost time: 37.373799085617065
Epoch: 3, Steps: 154 | Train Loss: 1.727 Vali Loss: 1.998 Vali Acc: 0.364 Test Loss: 1.998 Test Acc: 0.364
Validation loss decreased (-0.355614 --> -0.363727).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8580519
	speed: 0.7706s/iter; left time: 3127.6911s
Epoch: 4 cost time: 37.108729124069214
Epoch: 4, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.126 Vali Acc: 0.218 Test Loss: 2.126 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4423852
	speed: 0.8480s/iter; left time: 3311.4942s
Epoch: 5 cost time: 39.99519872665405
Epoch: 5, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.422 Vali Acc: 0.129 Test Loss: 2.422 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0628266
	speed: 0.8203s/iter; left time: 3076.9019s
Epoch: 6 cost time: 33.93149209022522
Epoch: 6, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.594 Vali Acc: 0.206 Test Loss: 2.594 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.9650629
	speed: 0.7849s/iter; left time: 2823.3261s
Epoch: 7 cost time: 42.57996368408203
Epoch: 7, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.255 Vali Acc: 0.391 Test Loss: 2.255 Test Acc: 0.391
Validation loss decreased (-0.363727 --> -0.390488).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4627006
	speed: 0.9653s/iter; left time: 3323.4527s
Epoch: 8 cost time: 41.323760986328125
Epoch: 8, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.275 Vali Acc: 0.379 Test Loss: 2.275 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4563274
	speed: 0.9423s/iter; left time: 3099.2381s
Epoch: 9 cost time: 44.56830883026123
Epoch: 9, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.457 Vali Acc: 0.240 Test Loss: 2.457 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8372401
	speed: 0.8903s/iter; left time: 2791.1017s
Epoch: 10 cost time: 43.49918055534363
Epoch: 10, Steps: 154 | Train Loss: 1.321 Vali Loss: 4.331 Vali Acc: 0.112 Test Loss: 4.331 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4359481
	speed: 0.9557s/iter; left time: 2848.9558s
Epoch: 11 cost time: 40.7205536365509
Epoch: 11, Steps: 154 | Train Loss: 1.293 Vali Loss: 3.002 Vali Acc: 0.212 Test Loss: 3.002 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0772297
	speed: 0.8619s/iter; left time: 2436.4598s
Epoch: 12 cost time: 40.95189929008484
Epoch: 12, Steps: 154 | Train Loss: 1.262 Vali Loss: 2.649 Vali Acc: 0.333 Test Loss: 2.649 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.6550975
	speed: 0.9467s/iter; left time: 2530.4948s
Epoch: 13 cost time: 38.85593628883362
Epoch: 13, Steps: 154 | Train Loss: 1.221 Vali Loss: 2.847 Vali Acc: 0.232 Test Loss: 2.847 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4329017
	speed: 0.8563s/iter; left time: 2157.1320s
Epoch: 14 cost time: 43.08688426017761
Epoch: 14, Steps: 154 | Train Loss: 1.191 Vali Loss: 3.602 Vali Acc: 0.123 Test Loss: 3.602 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.7842772
	speed: 0.9363s/iter; left time: 2214.3016s
Epoch: 15 cost time: 41.101508378982544
Epoch: 15, Steps: 154 | Train Loss: 1.192 Vali Loss: 2.427 Vali Acc: 0.422 Test Loss: 2.427 Test Acc: 0.422
Validation loss decreased (-0.390488 --> -0.421711).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.3764086
	speed: 0.9043s/iter; left time: 1999.3957s
Epoch: 16 cost time: 47.118584871292114
Epoch: 16, Steps: 154 | Train Loss: 1.136 Vali Loss: 3.194 Vali Acc: 0.177 Test Loss: 3.194 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1426256
	speed: 0.9453s/iter; left time: 1944.3872s
Epoch: 17 cost time: 39.61760234832764
Epoch: 17, Steps: 154 | Train Loss: 1.095 Vali Loss: 5.390 Vali Acc: 0.103 Test Loss: 5.390 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.9501433
	speed: 0.8541s/iter; left time: 1625.3584s
Epoch: 18 cost time: 39.75729846954346
Epoch: 18, Steps: 154 | Train Loss: 1.055 Vali Loss: 2.936 Vali Acc: 0.354 Test Loss: 2.936 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.3591000
	speed: 0.8894s/iter; left time: 1555.5477s
Epoch: 19 cost time: 36.88113880157471
Epoch: 19, Steps: 154 | Train Loss: 1.049 Vali Loss: 3.559 Vali Acc: 0.137 Test Loss: 3.559 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.9385993
	speed: 0.8517s/iter; left time: 1358.3819s
Epoch: 20 cost time: 41.60040235519409
Epoch: 20, Steps: 154 | Train Loss: 1.006 Vali Loss: 3.491 Vali Acc: 0.331 Test Loss: 3.491 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8069679
	speed: 0.8802s/iter; left time: 1268.3132s
Epoch: 21 cost time: 36.83978891372681
Epoch: 21, Steps: 154 | Train Loss: 0.974 Vali Loss: 3.143 Vali Acc: 0.260 Test Loss: 3.143 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.3586940
	speed: 0.8641s/iter; left time: 1112.1447s
Epoch: 22 cost time: 42.184579372406006
Epoch: 22, Steps: 154 | Train Loss: 0.907 Vali Loss: 3.398 Vali Acc: 0.356 Test Loss: 3.398 Test Acc: 0.356
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.6775237
	speed: 0.8413s/iter; left time: 953.2093s
Epoch: 23 cost time: 38.2098925113678
Epoch: 23, Steps: 154 | Train Loss: 0.902 Vali Loss: 3.583 Vali Acc: 0.155 Test Loss: 3.583 Test Acc: 0.155
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.5413693
	speed: 0.9789s/iter; left time: 958.3662s
Epoch: 24 cost time: 45.532639026641846
Epoch: 24, Steps: 154 | Train Loss: 0.887 Vali Loss: 5.235 Vali Acc: 0.091 Test Loss: 5.235 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.7870016
	speed: 0.9049s/iter; left time: 746.5619s
Epoch: 25 cost time: 39.820613622665405
Epoch: 25, Steps: 154 | Train Loss: 0.883 Vali Loss: 3.421 Vali Acc: 0.229 Test Loss: 3.421 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.42173560421735606
model parameter : 4705038
model size : 18.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1474221
	speed: 0.2049s/iter; left time: 926.1505s
Epoch: 1 cost time: 30.10331630706787
Epoch: 1, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.134 Vali Acc: 0.327 Test Loss: 2.134 Test Acc: 0.327
Validation loss decreased (inf --> -0.327229).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0032268
	speed: 0.5622s/iter; left time: 2455.2763s
Epoch: 2 cost time: 20.40947198867798
Epoch: 2, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.108 Vali Acc: 0.339 Test Loss: 2.108 Test Acc: 0.339
Validation loss decreased (-0.327229 --> -0.338989).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9942135
	speed: 0.6365s/iter; left time: 2681.4311s
Epoch: 3 cost time: 28.852134227752686
Epoch: 3, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.205 Vali Acc: 0.350 Test Loss: 2.205 Test Acc: 0.350
Validation loss decreased (-0.338989 --> -0.349532).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5530617
	speed: 0.6066s/iter; left time: 2462.0281s
Epoch: 4 cost time: 24.30746293067932
Epoch: 4, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.454 Vali Acc: 0.342 Test Loss: 2.454 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2295376
	speed: 0.6382s/iter; left time: 2492.3158s
Epoch: 5 cost time: 29.716060161590576
Epoch: 5, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.446 Vali Acc: 0.373 Test Loss: 2.446 Test Acc: 0.373
Validation loss decreased (-0.349532 --> -0.372644).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2952967
	speed: 0.6385s/iter; left time: 2395.1204s
Epoch: 6 cost time: 25.15974712371826
Epoch: 6, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.303 Vali Acc: 0.363 Test Loss: 2.303 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3401737
	speed: 0.5643s/iter; left time: 2029.9643s
Epoch: 7 cost time: 23.540791273117065
Epoch: 7, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.154 Vali Acc: 0.091 Test Loss: 3.154 Test Acc: 0.091
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5255780
	speed: 0.6003s/iter; left time: 2066.7779s
Epoch: 8 cost time: 24.760828971862793
Epoch: 8, Steps: 154 | Train Loss: 1.362 Vali Loss: 4.781 Vali Acc: 0.097 Test Loss: 4.781 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.3304560
	speed: 0.5528s/iter; left time: 1818.3218s
Epoch: 9 cost time: 22.179476022720337
Epoch: 9, Steps: 154 | Train Loss: 1.326 Vali Loss: 5.159 Vali Acc: 0.094 Test Loss: 5.159 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4611453
	speed: 0.5960s/iter; left time: 1868.4839s
Epoch: 10 cost time: 27.58820343017578
Epoch: 10, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.785 Vali Acc: 0.388 Test Loss: 2.785 Test Acc: 0.388
Validation loss decreased (-0.372644 --> -0.387644).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6365290
	speed: 0.6205s/iter; left time: 1849.7073s
Epoch: 11 cost time: 23.52494764328003
Epoch: 11, Steps: 154 | Train Loss: 1.243 Vali Loss: 2.438 Vali Acc: 0.342 Test Loss: 2.438 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3930639
	speed: 0.5569s/iter; left time: 1574.3026s
Epoch: 12 cost time: 26.422141075134277
Epoch: 12, Steps: 154 | Train Loss: 1.213 Vali Loss: 7.235 Vali Acc: 0.099 Test Loss: 7.235 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.9641442
	speed: 0.6217s/iter; left time: 1661.7753s
Epoch: 13 cost time: 25.14731788635254
Epoch: 13, Steps: 154 | Train Loss: 1.182 Vali Loss: 6.191 Vali Acc: 0.080 Test Loss: 6.191 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2008604
	speed: 0.5339s/iter; left time: 1344.9681s
Epoch: 14 cost time: 19.769225120544434
Epoch: 14, Steps: 154 | Train Loss: 1.134 Vali Loss: 7.411 Vali Acc: 0.089 Test Loss: 7.411 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1428624
	speed: 0.5046s/iter; left time: 1193.4922s
Epoch: 15 cost time: 23.641422510147095
Epoch: 15, Steps: 154 | Train Loss: 1.119 Vali Loss: 4.208 Vali Acc: 0.099 Test Loss: 4.208 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0966425
	speed: 0.6018s/iter; left time: 1330.6844s
Epoch: 16 cost time: 27.595199584960938
Epoch: 16, Steps: 154 | Train Loss: 1.073 Vali Loss: 8.469 Vali Acc: 0.099 Test Loss: 8.469 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.7546706
	speed: 0.6697s/iter; left time: 1377.6402s
Epoch: 17 cost time: 29.205256938934326
Epoch: 17, Steps: 154 | Train Loss: 1.015 Vali Loss: 3.667 Vali Acc: 0.110 Test Loss: 3.667 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8841949
	speed: 0.7193s/iter; left time: 1368.7972s
Epoch: 18 cost time: 30.507668018341064
Epoch: 18, Steps: 154 | Train Loss: 0.993 Vali Loss: 9.218 Vali Acc: 0.094 Test Loss: 9.218 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9403907
	speed: 0.6760s/iter; left time: 1182.3196s
Epoch: 19 cost time: 28.473978281021118
Epoch: 19, Steps: 154 | Train Loss: 0.961 Vali Loss: 7.960 Vali Acc: 0.084 Test Loss: 7.960 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.8722506
	speed: 0.7089s/iter; left time: 1130.7370s
Epoch: 20 cost time: 30.72804832458496
Epoch: 20, Steps: 154 | Train Loss: 0.947 Vali Loss: 9.498 Vali Acc: 0.086 Test Loss: 9.498 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38767234387672345
model parameter : 1394702
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8667279
	speed: 0.2089s/iter; left time: 944.4950s
Epoch: 1 cost time: 31.877995252609253
Epoch: 1, Steps: 154 | Train Loss: 2.141 Vali Loss: 2.072 Vali Acc: 0.328 Test Loss: 2.072 Test Acc: 0.328
Validation loss decreased (inf --> -0.327635).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6863765
	speed: 0.7566s/iter; left time: 3304.0333s
Epoch: 2 cost time: 33.9517343044281
Epoch: 2, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.231 Vali Acc: 0.342 Test Loss: 2.231 Test Acc: 0.342
Validation loss decreased (-0.327635 --> -0.341827).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9813482
	speed: 0.7614s/iter; left time: 3207.6543s
Epoch: 3 cost time: 31.827213048934937
Epoch: 3, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.103 Vali Acc: 0.349 Test Loss: 2.103 Test Acc: 0.349
Validation loss decreased (-0.341827 --> -0.348722).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8874441
	speed: 0.7343s/iter; left time: 2980.6994s
Epoch: 4 cost time: 32.018601417541504
Epoch: 4, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.197 Vali Acc: 0.223 Test Loss: 2.197 Test Acc: 0.223
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7196188
	speed: 0.6785s/iter; left time: 2649.5897s
Epoch: 5 cost time: 33.15322422981262
Epoch: 5, Steps: 154 | Train Loss: 1.596 Vali Loss: 3.160 Vali Acc: 0.179 Test Loss: 3.160 Test Acc: 0.179
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0177209
	speed: 0.7252s/iter; left time: 2720.1409s
Epoch: 6 cost time: 30.526803970336914
Epoch: 6, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.715 Vali Acc: 0.124 Test Loss: 3.715 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.8823043
	speed: 0.7313s/iter; left time: 2630.5291s
Epoch: 7 cost time: 29.716960668563843
Epoch: 7, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.614 Vali Acc: 0.403 Test Loss: 2.614 Test Acc: 0.403
Validation loss decreased (-0.348722 --> -0.403056).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4542687
	speed: 0.6707s/iter; left time: 2309.1644s
Epoch: 8 cost time: 29.614231824874878
Epoch: 8, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.518 Vali Acc: 0.378 Test Loss: 2.518 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4679830
	speed: 0.7354s/iter; left time: 2418.8320s
Epoch: 9 cost time: 31.722594499588013
Epoch: 9, Steps: 154 | Train Loss: 1.440 Vali Loss: 3.510 Vali Acc: 0.199 Test Loss: 3.510 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4636049
	speed: 0.6936s/iter; left time: 2174.4347s
Epoch: 10 cost time: 30.79291605949402
Epoch: 10, Steps: 154 | Train Loss: 1.371 Vali Loss: 4.373 Vali Acc: 0.084 Test Loss: 4.373 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4455075
	speed: 0.7005s/iter; left time: 2088.2033s
Epoch: 11 cost time: 31.048630237579346
Epoch: 11, Steps: 154 | Train Loss: 1.320 Vali Loss: 3.886 Vali Acc: 0.104 Test Loss: 3.886 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1802337
	speed: 0.7074s/iter; left time: 1999.7181s
Epoch: 12 cost time: 32.44063758850098
Epoch: 12, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.142 Vali Acc: 0.227 Test Loss: 3.142 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5023859
	speed: 0.6841s/iter; left time: 1828.5132s
Epoch: 13 cost time: 28.73034405708313
Epoch: 13, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.219 Vali Acc: 0.253 Test Loss: 3.219 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4613230
	speed: 0.6899s/iter; left time: 1737.7478s
Epoch: 14 cost time: 31.752225399017334
Epoch: 14, Steps: 154 | Train Loss: 1.234 Vali Loss: 7.062 Vali Acc: 0.078 Test Loss: 7.062 Test Acc: 0.078
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.6484102
	speed: 0.7013s/iter; left time: 1658.6679s
Epoch: 15 cost time: 25.539141178131104
Epoch: 15, Steps: 154 | Train Loss: 1.206 Vali Loss: 3.619 Vali Acc: 0.180 Test Loss: 3.619 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3435729
	speed: 0.6344s/iter; left time: 1402.7471s
Epoch: 16 cost time: 30.678913831710815
Epoch: 16, Steps: 154 | Train Loss: 1.169 Vali Loss: 4.841 Vali Acc: 0.100 Test Loss: 4.841 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1252806
	speed: 0.6470s/iter; left time: 1330.9417s
Epoch: 17 cost time: 24.2074191570282
Epoch: 17, Steps: 154 | Train Loss: 1.135 Vali Loss: 4.582 Vali Acc: 0.099 Test Loss: 4.582 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40308191403081917
model parameter : 4705038
model size : 18.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1502230
	speed: 0.1794s/iter; left time: 811.1697s
Epoch: 1 cost time: 26.743649005889893
Epoch: 1, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.129 Vali Acc: 0.322 Test Loss: 2.129 Test Acc: 0.322
Validation loss decreased (inf --> -0.321552).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9871202
	speed: 0.6661s/iter; left time: 2908.7119s
Epoch: 2 cost time: 27.97896695137024
Epoch: 2, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.088 Vali Acc: 0.336 Test Loss: 2.088 Test Acc: 0.336
Validation loss decreased (-0.321552 --> -0.336151).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0181403
	speed: 0.6612s/iter; left time: 2785.8313s
Epoch: 3 cost time: 25.224174737930298
Epoch: 3, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.145 Vali Acc: 0.354 Test Loss: 2.145 Test Acc: 0.354
Validation loss decreased (-0.336151 --> -0.353993).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5310829
	speed: 0.6383s/iter; left time: 2590.9377s
Epoch: 4 cost time: 27.22612190246582
Epoch: 4, Steps: 154 | Train Loss: 1.639 Vali Loss: 3.211 Vali Acc: 0.167 Test Loss: 3.211 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.1497793
	speed: 0.6351s/iter; left time: 2480.0393s
Epoch: 5 cost time: 25.091753482818604
Epoch: 5, Steps: 154 | Train Loss: 1.547 Vali Loss: 2.788 Vali Acc: 0.200 Test Loss: 2.788 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1287429
	speed: 0.6501s/iter; left time: 2438.4345s
Epoch: 6 cost time: 26.81454610824585
Epoch: 6, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.822 Vali Acc: 0.382 Test Loss: 2.822 Test Acc: 0.382
Validation loss decreased (-0.353993 --> -0.381967).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2672040
	speed: 0.5756s/iter; left time: 2070.5795s
Epoch: 7 cost time: 22.98572087287903
Epoch: 7, Steps: 154 | Train Loss: 1.462 Vali Loss: 3.031 Vali Acc: 0.374 Test Loss: 3.031 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5708218
	speed: 0.6342s/iter; left time: 2183.6916s
Epoch: 8 cost time: 25.238940954208374
Epoch: 8, Steps: 154 | Train Loss: 1.419 Vali Loss: 5.858 Vali Acc: 0.054 Test Loss: 5.858 Test Acc: 0.054
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3531401
	speed: 0.5964s/iter; left time: 1961.4743s
Epoch: 9 cost time: 21.288930654525757
Epoch: 9, Steps: 154 | Train Loss: 1.385 Vali Loss: 4.795 Vali Acc: 0.091 Test Loss: 4.795 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2861484
	speed: 0.6100s/iter; left time: 1912.4955s
Epoch: 10 cost time: 26.0945086479187
Epoch: 10, Steps: 154 | Train Loss: 1.350 Vali Loss: 5.912 Vali Acc: 0.068 Test Loss: 5.912 Test Acc: 0.068
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6041440
	speed: 0.6050s/iter; left time: 1803.5502s
Epoch: 11 cost time: 24.47842836380005
Epoch: 11, Steps: 154 | Train Loss: 1.313 Vali Loss: 5.207 Vali Acc: 0.084 Test Loss: 5.207 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3161025
	speed: 0.6716s/iter; left time: 1898.5955s
Epoch: 12 cost time: 26.22836399078369
Epoch: 12, Steps: 154 | Train Loss: 1.249 Vali Loss: 6.136 Vali Acc: 0.094 Test Loss: 6.136 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9221505
	speed: 0.6273s/iter; left time: 1676.8350s
Epoch: 13 cost time: 25.78655982017517
Epoch: 13, Steps: 154 | Train Loss: 1.239 Vali Loss: 4.521 Vali Acc: 0.094 Test Loss: 4.521 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.3136358
	speed: 0.6764s/iter; left time: 1703.8595s
Epoch: 14 cost time: 26.14142680168152
Epoch: 14, Steps: 154 | Train Loss: 1.202 Vali Loss: 6.125 Vali Acc: 0.081 Test Loss: 6.125 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3323168
	speed: 0.6384s/iter; left time: 1509.8562s
Epoch: 15 cost time: 25.854181051254272
Epoch: 15, Steps: 154 | Train Loss: 1.246 Vali Loss: 7.954 Vali Acc: 0.178 Test Loss: 7.954 Test Acc: 0.178
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.8718069
	speed: 0.6033s/iter; left time: 1333.8794s
Epoch: 16 cost time: 24.445959091186523
Epoch: 16, Steps: 154 | Train Loss: 1.154 Vali Loss: 3.956 Vali Acc: 0.287 Test Loss: 3.956 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3819951338199513
model parameter : 1394702
model size : 5.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4723642
	speed: 0.2777s/iter; left time: 1255.5902s
Epoch: 1 cost time: 38.55212950706482
Epoch: 1, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.104 Vali Acc: 0.329 Test Loss: 2.104 Test Acc: 0.329
Validation loss decreased (inf --> -0.328852).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9395634
	speed: 0.8390s/iter; left time: 3663.9135s
Epoch: 2 cost time: 44.14517021179199
Epoch: 2, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.071 Vali Acc: 0.347 Test Loss: 2.071 Test Acc: 0.347
Validation loss decreased (-0.328852 --> -0.347100).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5285864
	speed: 0.8945s/iter; left time: 3768.5627s
Epoch: 3 cost time: 40.69977307319641
Epoch: 3, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.055 Vali Acc: 0.350 Test Loss: 2.055 Test Acc: 0.350
Validation loss decreased (-0.347100 --> -0.350344).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5855103
	speed: 0.9251s/iter; left time: 3754.9764s
Epoch: 4 cost time: 36.23514795303345
Epoch: 4, Steps: 154 | Train Loss: 1.630 Vali Loss: 1.954 Vali Acc: 0.365 Test Loss: 1.954 Test Acc: 0.365
Validation loss decreased (-0.350344 --> -0.365349).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6313066
	speed: 0.8345s/iter; left time: 3258.7850s
Epoch: 5 cost time: 42.72944355010986
Epoch: 5, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.152 Vali Acc: 0.324 Test Loss: 2.152 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2938876
	speed: 0.8308s/iter; left time: 3116.2752s
Epoch: 6 cost time: 40.38065052032471
Epoch: 6, Steps: 154 | Train Loss: 1.494 Vali Loss: 1.967 Vali Acc: 0.379 Test Loss: 1.967 Test Acc: 0.379
Validation loss decreased (-0.365349 --> -0.379137).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3863276
	speed: 0.9114s/iter; left time: 3278.3592s
Epoch: 7 cost time: 45.02397799491882
Epoch: 7, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.179 Vali Acc: 0.311 Test Loss: 2.179 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3186773
	speed: 0.9279s/iter; left time: 3194.7762s
Epoch: 8 cost time: 41.064494132995605
Epoch: 8, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.030 Vali Acc: 0.217 Test Loss: 2.030 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.6797271
	speed: 0.8324s/iter; left time: 2737.8621s
Epoch: 9 cost time: 40.20432662963867
Epoch: 9, Steps: 154 | Train Loss: 1.378 Vali Loss: 3.374 Vali Acc: 0.124 Test Loss: 3.374 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3396060
	speed: 0.8964s/iter; left time: 2810.0970s
Epoch: 10 cost time: 46.67027401924133
Epoch: 10, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.606 Vali Acc: 0.133 Test Loss: 3.606 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1622075
	speed: 0.8961s/iter; left time: 2671.2598s
Epoch: 11 cost time: 40.590853214263916
Epoch: 11, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.729 Vali Acc: 0.157 Test Loss: 3.729 Test Acc: 0.157
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.9460420
	speed: 1.0044s/iter; left time: 2839.4266s
Epoch: 12 cost time: 44.71540379524231
Epoch: 12, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.978 Vali Acc: 0.141 Test Loss: 2.978 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3038164
	speed: 0.9745s/iter; left time: 2604.9030s
Epoch: 13 cost time: 47.19047141075134
Epoch: 13, Steps: 154 | Train Loss: 1.213 Vali Loss: 6.356 Vali Acc: 0.131 Test Loss: 6.356 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.7750231
	speed: 0.9589s/iter; left time: 2415.5188s
Epoch: 14 cost time: 40.738404273986816
Epoch: 14, Steps: 154 | Train Loss: 1.200 Vali Loss: 3.406 Vali Acc: 0.152 Test Loss: 3.406 Test Acc: 0.152
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.8320611
	speed: 0.8855s/iter; left time: 2094.1295s
Epoch: 15 cost time: 40.92816519737244
Epoch: 15, Steps: 154 | Train Loss: 1.128 Vali Loss: 3.525 Vali Acc: 0.236 Test Loss: 3.525 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2878072
	speed: 0.8412s/iter; left time: 1860.0012s
Epoch: 16 cost time: 38.73559308052063
Epoch: 16, Steps: 154 | Train Loss: 1.090 Vali Loss: 2.344 Vali Acc: 0.357 Test Loss: 2.344 Test Acc: 0.357
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3791565287915653
model parameter : 2361358
model size : 9.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1933205
	speed: 0.2104s/iter; left time: 951.4063s
Epoch: 1 cost time: 31.77635669708252
Epoch: 1, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.094 Vali Acc: 0.330 Test Loss: 2.094 Test Acc: 0.330
Validation loss decreased (inf --> -0.329663).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2352841
	speed: 0.6861s/iter; left time: 2996.1411s
Epoch: 2 cost time: 28.455271005630493
Epoch: 2, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.128 Vali Acc: 0.341 Test Loss: 2.128 Test Acc: 0.341
Validation loss decreased (-0.329663 --> -0.341422).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6204665
	speed: 0.6634s/iter; left time: 2794.7144s
Epoch: 3 cost time: 30.573747158050537
Epoch: 3, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.070 Vali Acc: 0.349 Test Loss: 2.070 Test Acc: 0.349
Validation loss decreased (-0.341422 --> -0.348722).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5468470
	speed: 0.6327s/iter; left time: 2568.1510s
Epoch: 4 cost time: 27.57786226272583
Epoch: 4, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.603 Vali Acc: 0.148 Test Loss: 2.603 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3049654
	speed: 0.6439s/iter; left time: 2514.5067s
Epoch: 5 cost time: 30.599547147750854
Epoch: 5, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.394 Vali Acc: 0.090 Test Loss: 2.394 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4138111
	speed: 0.6836s/iter; left time: 2564.1066s
Epoch: 6 cost time: 30.169110774993896
Epoch: 6, Steps: 154 | Train Loss: 1.456 Vali Loss: 6.082 Vali Acc: 0.075 Test Loss: 6.082 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.0882268
	speed: 0.6615s/iter; left time: 2379.2855s
Epoch: 7 cost time: 31.633270025253296
Epoch: 7, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.314 Vali Acc: 0.382 Test Loss: 2.314 Test Acc: 0.382
Validation loss decreased (-0.348722 --> -0.381566).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8377888
	speed: 0.6894s/iter; left time: 2373.6275s
Epoch: 8 cost time: 28.862244844436646
Epoch: 8, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.460 Vali Acc: 0.088 Test Loss: 3.460 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1771822
	speed: 0.6183s/iter; left time: 2033.5868s
Epoch: 9 cost time: 28.686577558517456
Epoch: 9, Steps: 154 | Train Loss: 1.292 Vali Loss: 4.199 Vali Acc: 0.118 Test Loss: 4.199 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9690793
	speed: 0.6037s/iter; left time: 1892.7562s
Epoch: 10 cost time: 24.89630103111267
Epoch: 10, Steps: 154 | Train Loss: 1.277 Vali Loss: 6.195 Vali Acc: 0.081 Test Loss: 6.195 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4719328
	speed: 0.6898s/iter; left time: 2056.4327s
Epoch: 11 cost time: 31.463530778884888
Epoch: 11, Steps: 154 | Train Loss: 1.227 Vali Loss: 4.622 Vali Acc: 0.083 Test Loss: 4.622 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3041414
	speed: 0.6770s/iter; left time: 1913.8283s
Epoch: 12 cost time: 29.117436408996582
Epoch: 12, Steps: 154 | Train Loss: 1.206 Vali Loss: 5.138 Vali Acc: 0.092 Test Loss: 5.138 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3072778
	speed: 0.6534s/iter; left time: 1746.6099s
Epoch: 13 cost time: 25.868730545043945
Epoch: 13, Steps: 154 | Train Loss: 1.174 Vali Loss: 4.163 Vali Acc: 0.120 Test Loss: 4.163 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.8957030
	speed: 0.5410s/iter; left time: 1362.7583s
Epoch: 14 cost time: 26.10383915901184
Epoch: 14, Steps: 154 | Train Loss: 1.157 Vali Loss: 7.116 Vali Acc: 0.088 Test Loss: 7.116 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2085195
	speed: 0.6220s/iter; left time: 1471.1384s
Epoch: 15 cost time: 28.55587887763977
Epoch: 15, Steps: 154 | Train Loss: 1.088 Vali Loss: 4.484 Vali Acc: 0.086 Test Loss: 4.484 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.7757213
	speed: 0.5510s/iter; left time: 1218.3584s
Epoch: 16 cost time: 26.810806035995483
Epoch: 16, Steps: 154 | Train Loss: 1.094 Vali Loss: 10.944 Vali Acc: 0.087 Test Loss: 10.944 Test Acc: 0.087
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.8733308
	speed: 0.6692s/iter; left time: 1376.4761s
Epoch: 17 cost time: 29.754780054092407
Epoch: 17, Steps: 154 | Train Loss: 1.045 Vali Loss: 12.004 Vali Acc: 0.079 Test Loss: 12.004 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3815896188158962
model parameter : 706062
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4945831
	speed: 0.2372s/iter; left time: 1072.5791s
Epoch: 1 cost time: 35.7603759765625
Epoch: 1, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.105 Vali Acc: 0.328 Test Loss: 2.105 Test Acc: 0.328
Validation loss decreased (inf --> -0.327635).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9609021
	speed: 0.7019s/iter; left time: 3065.1434s
Epoch: 2 cost time: 26.807583332061768
Epoch: 2, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.105 Vali Acc: 0.340 Test Loss: 2.105 Test Acc: 0.340
Validation loss decreased (-0.327635 --> -0.339801).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5021117
	speed: 0.8198s/iter; left time: 3453.8828s
Epoch: 3 cost time: 36.71765947341919
Epoch: 3, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.218 Vali Acc: 0.346 Test Loss: 2.218 Test Acc: 0.346
Validation loss decreased (-0.339801 --> -0.345882).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5485102
	speed: 0.6304s/iter; left time: 2558.7015s
Epoch: 4 cost time: 27.518844842910767
Epoch: 4, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.143 Vali Acc: 0.357 Test Loss: 2.143 Test Acc: 0.357
Validation loss decreased (-0.345882 --> -0.357237).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6353378
	speed: 0.6985s/iter; left time: 2727.4655s
Epoch: 5 cost time: 32.805428981781006
Epoch: 5, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.263 Vali Acc: 0.308 Test Loss: 2.263 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3220249
	speed: 0.7335s/iter; left time: 2751.5278s
Epoch: 6 cost time: 34.30594825744629
Epoch: 6, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.539 Vali Acc: 0.146 Test Loss: 2.539 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3306912
	speed: 0.6610s/iter; left time: 2377.6175s
Epoch: 7 cost time: 30.500795602798462
Epoch: 7, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.782 Vali Acc: 0.195 Test Loss: 2.782 Test Acc: 0.195
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2598239
	speed: 0.6618s/iter; left time: 2278.4594s
Epoch: 8 cost time: 27.73711109161377
Epoch: 8, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.144 Vali Acc: 0.290 Test Loss: 2.144 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9342335
	speed: 0.6810s/iter; left time: 2239.8707s
Epoch: 9 cost time: 30.160354375839233
Epoch: 9, Steps: 154 | Train Loss: 1.406 Vali Loss: 5.407 Vali Acc: 0.134 Test Loss: 5.407 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.1488212
	speed: 0.6271s/iter; left time: 1965.8669s
Epoch: 10 cost time: 28.03175115585327
Epoch: 10, Steps: 154 | Train Loss: 1.359 Vali Loss: 4.993 Vali Acc: 0.135 Test Loss: 4.993 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.1296961
	speed: 0.5982s/iter; left time: 1783.1202s
Epoch: 11 cost time: 30.724627017974854
Epoch: 11, Steps: 154 | Train Loss: 1.314 Vali Loss: 5.786 Vali Acc: 0.126 Test Loss: 5.786 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2856503
	speed: 0.5856s/iter; left time: 1655.6256s
Epoch: 12 cost time: 28.90584421157837
Epoch: 12, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.596 Vali Acc: 0.216 Test Loss: 2.596 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3731856
	speed: 0.6593s/iter; left time: 1762.2613s
Epoch: 13 cost time: 30.98437213897705
Epoch: 13, Steps: 154 | Train Loss: 1.248 Vali Loss: 5.178 Vali Acc: 0.187 Test Loss: 5.178 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.9305135
	speed: 0.7382s/iter; left time: 1859.5901s
Epoch: 14 cost time: 30.604336261749268
Epoch: 14, Steps: 154 | Train Loss: 1.232 Vali Loss: 3.658 Vali Acc: 0.216 Test Loss: 3.658 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3572587185725872
model parameter : 2361358
model size : 9.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1907461
	speed: 0.1781s/iter; left time: 805.3775s
Epoch: 1 cost time: 26.856587648391724
Epoch: 1, Steps: 154 | Train Loss: 2.146 Vali Loss: 2.098 Vali Acc: 0.328 Test Loss: 2.098 Test Acc: 0.328
Validation loss decreased (inf --> -0.327635).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.2766420
	speed: 0.6297s/iter; left time: 2749.9629s
Epoch: 2 cost time: 22.8478102684021
Epoch: 2, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.127 Vali Acc: 0.341 Test Loss: 2.127 Test Acc: 0.341
Validation loss decreased (-0.327635 --> -0.341422).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6064093
	speed: 0.5576s/iter; left time: 2349.3221s
Epoch: 3 cost time: 25.966180562973022
Epoch: 3, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.180 Vali Acc: 0.339 Test Loss: 2.180 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5974722
	speed: 0.5495s/iter; left time: 2230.5871s
Epoch: 4 cost time: 24.72186827659607
Epoch: 4, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.494 Vali Acc: 0.186 Test Loss: 2.494 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.2307006
	speed: 0.6150s/iter; left time: 2401.6044s
Epoch: 5 cost time: 22.127455234527588
Epoch: 5, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.136 Vali Acc: 0.352 Test Loss: 2.136 Test Acc: 0.352
Validation loss decreased (-0.341422 --> -0.352371).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3928710
	speed: 0.5285s/iter; left time: 1982.3210s
Epoch: 6 cost time: 25.571311712265015
Epoch: 6, Steps: 154 | Train Loss: 1.476 Vali Loss: 4.772 Vali Acc: 0.073 Test Loss: 4.772 Test Acc: 0.073
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1186773
	speed: 0.5119s/iter; left time: 1841.4022s
Epoch: 7 cost time: 21.913983821868896
Epoch: 7, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.098 Vali Acc: 0.187 Test Loss: 3.098 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9086037
	speed: 0.5194s/iter; left time: 1788.4332s
Epoch: 8 cost time: 21.986819744110107
Epoch: 8, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.394 Vali Acc: 0.203 Test Loss: 2.394 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1447845
	speed: 0.4519s/iter; left time: 1486.3720s
Epoch: 9 cost time: 17.778310775756836
Epoch: 9, Steps: 154 | Train Loss: 1.343 Vali Loss: 5.422 Vali Acc: 0.123 Test Loss: 5.422 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.8476284
	speed: 0.4120s/iter; left time: 1291.5372s
Epoch: 10 cost time: 19.739684581756592
Epoch: 10, Steps: 154 | Train Loss: 1.319 Vali Loss: 5.450 Vali Acc: 0.080 Test Loss: 5.450 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3342807
	speed: 0.5268s/iter; left time: 1570.4608s
Epoch: 11 cost time: 20.66819190979004
Epoch: 11, Steps: 154 | Train Loss: 1.265 Vali Loss: 3.017 Vali Acc: 0.138 Test Loss: 3.017 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3464848
	speed: 0.4800s/iter; left time: 1356.9209s
Epoch: 12 cost time: 18.71529269218445
Epoch: 12, Steps: 154 | Train Loss: 1.228 Vali Loss: 5.339 Vali Acc: 0.125 Test Loss: 5.339 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.2921214
	speed: 0.4559s/iter; left time: 1218.5634s
Epoch: 13 cost time: 19.432042121887207
Epoch: 13, Steps: 154 | Train Loss: 1.214 Vali Loss: 3.510 Vali Acc: 0.124 Test Loss: 3.510 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.7000206
	speed: 0.4780s/iter; left time: 1204.0419s
Epoch: 14 cost time: 19.964056253433228
Epoch: 14, Steps: 154 | Train Loss: 1.192 Vali Loss: 4.555 Vali Acc: 0.094 Test Loss: 4.555 Test Acc: 0.094
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.2676423
	speed: 0.4714s/iter; left time: 1114.9771s
Epoch: 15 cost time: 18.566235780715942
Epoch: 15, Steps: 154 | Train Loss: 1.137 Vali Loss: 2.930 Vali Acc: 0.169 Test Loss: 2.930 Test Acc: 0.169
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3523925385239254
model parameter : 706062
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4944949
	speed: 0.1540s/iter; left time: 696.1362s
Epoch: 1 cost time: 20.89177417755127
Epoch: 1, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.107 Vali Acc: 0.324 Test Loss: 2.107 Test Acc: 0.324
Validation loss decreased (inf --> -0.324391).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9709228
	speed: 0.4988s/iter; left time: 2178.2417s
Epoch: 2 cost time: 21.522284507751465
Epoch: 2, Steps: 154 | Train Loss: 1.922 Vali Loss: 2.111 Vali Acc: 0.337 Test Loss: 2.111 Test Acc: 0.337
Validation loss decreased (-0.324391 --> -0.337367).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6213156
	speed: 0.4922s/iter; left time: 2073.5955s
Epoch: 3 cost time: 18.74591588973999
Epoch: 3, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.256 Vali Acc: 0.341 Test Loss: 2.256 Test Acc: 0.341
Validation loss decreased (-0.337367 --> -0.340610).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6413512
	speed: 0.5707s/iter; left time: 2316.3236s
Epoch: 4 cost time: 24.62549138069153
Epoch: 4, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.167 Vali Acc: 0.356 Test Loss: 2.167 Test Acc: 0.356
Validation loss decreased (-0.340610 --> -0.356426).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3043405
	speed: 0.5132s/iter; left time: 2003.9210s
Epoch: 5 cost time: 21.853986263275146
Epoch: 5, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.306 Vali Acc: 0.354 Test Loss: 2.306 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4043102
	speed: 0.5378s/iter; left time: 2017.3915s
Epoch: 6 cost time: 19.182729482650757
Epoch: 6, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.061 Vali Acc: 0.369 Test Loss: 2.061 Test Acc: 0.369
Validation loss decreased (-0.356426 --> -0.368998).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3649703
	speed: 0.5580s/iter; left time: 2007.1728s
Epoch: 7 cost time: 25.301559925079346
Epoch: 7, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.329 Vali Acc: 0.385 Test Loss: 2.329 Test Acc: 0.385
Validation loss decreased (-0.368998 --> -0.384810).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3699611
	speed: 0.5058s/iter; left time: 1741.4769s
Epoch: 8 cost time: 21.731728076934814
Epoch: 8, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.715 Vali Acc: 0.236 Test Loss: 2.715 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.8137547
	speed: 0.4754s/iter; left time: 1563.6565s
Epoch: 9 cost time: 18.659283876419067
Epoch: 9, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.702 Vali Acc: 0.406 Test Loss: 2.702 Test Acc: 0.406
Validation loss decreased (-0.384810 --> -0.405893).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2986808
	speed: 0.4250s/iter; left time: 1332.2233s
Epoch: 10 cost time: 18.641045570373535
Epoch: 10, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.585 Vali Acc: 0.393 Test Loss: 2.585 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1689363
	speed: 0.4449s/iter; left time: 1326.3680s
Epoch: 11 cost time: 21.799394845962524
Epoch: 11, Steps: 154 | Train Loss: 1.335 Vali Loss: 2.437 Vali Acc: 0.398 Test Loss: 2.437 Test Acc: 0.398
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2402362
	speed: 0.5417s/iter; left time: 1531.3551s
Epoch: 12 cost time: 21.32430124282837
Epoch: 12, Steps: 154 | Train Loss: 1.307 Vali Loss: 4.203 Vali Acc: 0.137 Test Loss: 4.203 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.2496332
	speed: 0.4175s/iter; left time: 1116.0670s
Epoch: 13 cost time: 17.118812799453735
Epoch: 13, Steps: 154 | Train Loss: 1.256 Vali Loss: 4.352 Vali Acc: 0.153 Test Loss: 4.352 Test Acc: 0.153
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.8990518
	speed: 0.3978s/iter; left time: 1002.0897s
Epoch: 14 cost time: 18.267834901809692
Epoch: 14, Steps: 154 | Train Loss: 1.246 Vali Loss: 3.633 Vali Acc: 0.209 Test Loss: 3.633 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.9671217
	speed: 0.4913s/iter; left time: 1161.9374s
Epoch: 15 cost time: 19.537738800048828
Epoch: 15, Steps: 154 | Train Loss: 1.194 Vali Loss: 5.976 Vali Acc: 0.076 Test Loss: 5.976 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.1490666
	speed: 0.4433s/iter; left time: 980.1556s
Epoch: 16 cost time: 20.62493872642517
Epoch: 16, Steps: 154 | Train Loss: 1.134 Vali Loss: 4.659 Vali Acc: 0.122 Test Loss: 4.659 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.6744671
	speed: 0.4597s/iter; left time: 945.6769s
Epoch: 17 cost time: 21.23289966583252
Epoch: 17, Steps: 154 | Train Loss: 1.128 Vali Loss: 4.970 Vali Acc: 0.146 Test Loss: 4.970 Test Acc: 0.146
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.9931346
	speed: 0.5106s/iter; left time: 971.7164s
Epoch: 18 cost time: 21.738656520843506
Epoch: 18, Steps: 154 | Train Loss: 1.080 Vali Loss: 7.777 Vali Acc: 0.086 Test Loss: 7.777 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.1084653
	speed: 0.4637s/iter; left time: 811.0394s
Epoch: 19 cost time: 19.630027294158936
Epoch: 19, Steps: 154 | Train Loss: 1.128 Vali Loss: 7.585 Vali Acc: 0.086 Test Loss: 7.585 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4059205190592052
model parameter : 2361358
model size : 9.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1859829
	speed: 0.1136s/iter; left time: 513.4312s
Epoch: 1 cost time: 17.856022119522095
Epoch: 1, Steps: 154 | Train Loss: 2.151 Vali Loss: 2.107 Vali Acc: 0.321 Test Loss: 2.107 Test Acc: 0.321
Validation loss decreased (inf --> -0.321147).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0883940
	speed: 0.4862s/iter; left time: 2123.0242s
Epoch: 2 cost time: 17.20414161682129
Epoch: 2, Steps: 154 | Train Loss: 1.951 Vali Loss: 2.104 Vali Acc: 0.336 Test Loss: 2.104 Test Acc: 0.336
Validation loss decreased (-0.321147 --> -0.336151).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6139431
	speed: 0.4627s/iter; left time: 1949.3640s
Epoch: 3 cost time: 21.848085403442383
Epoch: 3, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.292 Vali Acc: 0.339 Test Loss: 2.292 Test Acc: 0.339
Validation loss decreased (-0.336151 --> -0.339393).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6549708
	speed: 0.4781s/iter; left time: 1940.4807s
Epoch: 4 cost time: 17.586146593093872
Epoch: 4, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.242 Vali Acc: 0.179 Test Loss: 2.242 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2847840
	speed: 0.4577s/iter; left time: 1787.3978s
Epoch: 5 cost time: 17.841619968414307
Epoch: 5, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.834 Vali Acc: 0.167 Test Loss: 2.834 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4416810
	speed: 0.3765s/iter; left time: 1412.4310s
Epoch: 6 cost time: 16.889867067337036
Epoch: 6, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.814 Vali Acc: 0.188 Test Loss: 2.814 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.1740522
	speed: 0.4209s/iter; left time: 1513.8730s
Epoch: 7 cost time: 17.133798837661743
Epoch: 7, Steps: 154 | Train Loss: 1.515 Vali Loss: 5.258 Vali Acc: 0.144 Test Loss: 5.258 Test Acc: 0.144
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.9488595
	speed: 0.4547s/iter; left time: 1565.3976s
Epoch: 8 cost time: 16.044965982437134
Epoch: 8, Steps: 154 | Train Loss: 1.443 Vali Loss: 3.217 Vali Acc: 0.194 Test Loss: 3.217 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.0992849
	speed: 0.3832s/iter; left time: 1260.2506s
Epoch: 9 cost time: 15.601956129074097
Epoch: 9, Steps: 154 | Train Loss: 1.412 Vali Loss: 3.512 Vali Acc: 0.190 Test Loss: 3.512 Test Acc: 0.190
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.9932213
	speed: 0.3865s/iter; left time: 1211.5326s
Epoch: 10 cost time: 10.931614398956299
Epoch: 10, Steps: 154 | Train Loss: 1.414 Vali Loss: 6.433 Vali Acc: 0.082 Test Loss: 6.433 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.3246005
	speed: 0.3600s/iter; left time: 1073.1068s
Epoch: 11 cost time: 14.844813823699951
Epoch: 11, Steps: 154 | Train Loss: 1.326 Vali Loss: 5.520 Vali Acc: 0.077 Test Loss: 5.520 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.3694450
	speed: 0.3372s/iter; left time: 953.1385s
Epoch: 12 cost time: 16.084096670150757
Epoch: 12, Steps: 154 | Train Loss: 1.293 Vali Loss: 7.176 Vali Acc: 0.063 Test Loss: 7.176 Test Acc: 0.063
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.2770832
	speed: 0.3672s/iter; left time: 981.5054s
Epoch: 13 cost time: 13.97892451286316
Epoch: 13, Steps: 154 | Train Loss: 1.290 Vali Loss: 6.574 Vali Acc: 0.075 Test Loss: 6.574 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33941605839416056
model parameter : 706062
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1926320
	speed: 0.2100s/iter; left time: 949.5811s
Epoch: 1 cost time: 34.10620737075806
Epoch: 1, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.132 Vali Acc: 0.322 Test Loss: 2.132 Test Acc: 0.322
Validation loss decreased (inf --> -0.321552).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7870034
	speed: 0.7823s/iter; left time: 3416.3938s
Epoch: 2 cost time: 38.586586713790894
Epoch: 2, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.105 Vali Acc: 0.334 Test Loss: 2.105 Test Acc: 0.334
Validation loss decreased (-0.321552 --> -0.333718).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0823653
	speed: 0.7599s/iter; left time: 3201.2527s
Epoch: 3 cost time: 35.63789653778076
Epoch: 3, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.198 Vali Acc: 0.247 Test Loss: 2.198 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5619812
	speed: 0.7655s/iter; left time: 3107.2907s
Epoch: 4 cost time: 33.781832456588745
Epoch: 4, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.134 Vali Acc: 0.352 Test Loss: 2.134 Test Acc: 0.352
Validation loss decreased (-0.333718 --> -0.352371).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2197154
	speed: 0.7842s/iter; left time: 3062.3126s
Epoch: 5 cost time: 34.87269592285156
Epoch: 5, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.261 Vali Acc: 0.189 Test Loss: 2.261 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2783715
	speed: 0.6469s/iter; left time: 2426.5496s
Epoch: 6 cost time: 32.18525767326355
Epoch: 6, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.540 Vali Acc: 0.107 Test Loss: 2.540 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6953456
	speed: 0.6455s/iter; left time: 2321.9446s
Epoch: 7 cost time: 31.187177896499634
Epoch: 7, Steps: 154 | Train Loss: 1.588 Vali Loss: 3.682 Vali Acc: 0.094 Test Loss: 3.682 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3767650
	speed: 0.6123s/iter; left time: 2108.3154s
Epoch: 8 cost time: 29.24851369857788
Epoch: 8, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.461 Vali Acc: 0.194 Test Loss: 2.461 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.5473971
	speed: 0.5377s/iter; left time: 1768.6301s
Epoch: 9 cost time: 25.6029794216156
Epoch: 9, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.264 Vali Acc: 0.384 Test Loss: 2.264 Test Acc: 0.384
Validation loss decreased (-0.352371 --> -0.383595).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4387331
	speed: 0.5799s/iter; left time: 1817.8673s
Epoch: 10 cost time: 26.257426738739014
Epoch: 10, Steps: 154 | Train Loss: 1.482 Vali Loss: 5.730 Vali Acc: 0.105 Test Loss: 5.730 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8413631
	speed: 0.5481s/iter; left time: 1634.0070s
Epoch: 11 cost time: 25.33895206451416
Epoch: 11, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.405 Vali Acc: 0.109 Test Loss: 3.405 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9554218
	speed: 0.6173s/iter; left time: 1745.0097s
Epoch: 12 cost time: 30.257280588150024
Epoch: 12, Steps: 154 | Train Loss: 1.381 Vali Loss: 5.451 Vali Acc: 0.120 Test Loss: 5.451 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9754871
	speed: 0.5703s/iter; left time: 1524.4979s
Epoch: 13 cost time: 29.550685167312622
Epoch: 13, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.970 Vali Acc: 0.138 Test Loss: 2.970 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.1306969
	speed: 0.8613s/iter; left time: 2169.5719s
Epoch: 14 cost time: 43.02554798126221
Epoch: 14, Steps: 154 | Train Loss: 1.300 Vali Loss: 6.637 Vali Acc: 0.133 Test Loss: 6.637 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3429962
	speed: 0.9127s/iter; left time: 2158.4975s
Epoch: 15 cost time: 44.62434935569763
Epoch: 15, Steps: 154 | Train Loss: 1.264 Vali Loss: 3.479 Vali Acc: 0.105 Test Loss: 3.479 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.3757007
	speed: 0.9065s/iter; left time: 2004.2952s
Epoch: 16 cost time: 44.1902117729187
Epoch: 16, Steps: 154 | Train Loss: 1.250 Vali Loss: 2.273 Vali Acc: 0.348 Test Loss: 2.273 Test Acc: 0.348
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.4760860
	speed: 0.8829s/iter; left time: 1816.0718s
Epoch: 17 cost time: 40.90434670448303
Epoch: 17, Steps: 154 | Train Loss: 1.211 Vali Loss: 2.773 Vali Acc: 0.233 Test Loss: 2.773 Test Acc: 0.233
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.3881888
	speed: 0.8287s/iter; left time: 1576.9600s
Epoch: 18 cost time: 38.3362877368927
Epoch: 18, Steps: 154 | Train Loss: 1.179 Vali Loss: 5.518 Vali Acc: 0.089 Test Loss: 5.518 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.9935401
	speed: 0.7465s/iter; left time: 1305.6363s
Epoch: 19 cost time: 35.99721097946167
Epoch: 19, Steps: 154 | Train Loss: 1.143 Vali Loss: 4.241 Vali Acc: 0.088 Test Loss: 4.241 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38361719383617193
model parameter : 2353294
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.9062748
	speed: 0.1862s/iter; left time: 841.5917s
Epoch: 1 cost time: 27.66565442085266
Epoch: 1, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.216 Vali Acc: 0.317 Test Loss: 2.216 Test Acc: 0.317
Validation loss decreased (inf --> -0.316685).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9457849
	speed: 0.5168s/iter; left time: 2256.9405s
Epoch: 2 cost time: 20.253594160079956
Epoch: 2, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.063 Vali Acc: 0.337 Test Loss: 2.063 Test Acc: 0.337
Validation loss decreased (-0.316685 --> -0.336557).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5672426
	speed: 0.4811s/iter; left time: 2027.0363s
Epoch: 3 cost time: 21.41834855079651
Epoch: 3, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.196 Vali Acc: 0.328 Test Loss: 2.196 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7526670
	speed: 0.5431s/iter; left time: 2204.4526s
Epoch: 4 cost time: 26.370139837265015
Epoch: 4, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.195 Vali Acc: 0.340 Test Loss: 2.195 Test Acc: 0.340
Validation loss decreased (-0.336557 --> -0.340205).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6650022
	speed: 0.6405s/iter; left time: 2501.1479s
Epoch: 5 cost time: 27.124008178710938
Epoch: 5, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.267 Vali Acc: 0.354 Test Loss: 2.267 Test Acc: 0.354
Validation loss decreased (-0.340205 --> -0.353586).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9531071
	speed: 0.6217s/iter; left time: 2331.9141s
Epoch: 6 cost time: 25.33742070198059
Epoch: 6, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.190 Vali Acc: 0.357 Test Loss: 2.190 Test Acc: 0.357
Validation loss decreased (-0.353586 --> -0.357237).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0289614
	speed: 0.5492s/iter; left time: 1975.4858s
Epoch: 7 cost time: 26.92561101913452
Epoch: 7, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.204 Vali Acc: 0.358 Test Loss: 2.204 Test Acc: 0.358
Validation loss decreased (-0.357237 --> -0.357642).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2183002
	speed: 0.5069s/iter; left time: 1745.3979s
Epoch: 8 cost time: 20.65747308731079
Epoch: 8, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.122 Vali Acc: 0.363 Test Loss: 2.122 Test Acc: 0.363
Validation loss decreased (-0.357642 --> -0.362509).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4937810
	speed: 0.5581s/iter; left time: 1835.7071s
Epoch: 9 cost time: 26.17081046104431
Epoch: 9, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.186 Vali Acc: 0.361 Test Loss: 2.186 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3432604
	speed: 0.5597s/iter; left time: 1754.7051s
Epoch: 10 cost time: 24.926432609558105
Epoch: 10, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.062 Vali Acc: 0.367 Test Loss: 2.062 Test Acc: 0.367
Validation loss decreased (-0.362509 --> -0.367376).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3537165
	speed: 0.5508s/iter; left time: 1641.8388s
Epoch: 11 cost time: 24.42219114303589
Epoch: 11, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.450 Vali Acc: 0.363 Test Loss: 2.450 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2571896
	speed: 0.5547s/iter; left time: 1568.2010s
Epoch: 12 cost time: 26.027828693389893
Epoch: 12, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.598 Vali Acc: 0.115 Test Loss: 3.598 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6449525
	speed: 0.5902s/iter; left time: 1577.5455s
Epoch: 13 cost time: 28.890466928482056
Epoch: 13, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.605 Vali Acc: 0.303 Test Loss: 2.605 Test Acc: 0.303
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.2135324
	speed: 0.6112s/iter; left time: 1539.6354s
Epoch: 14 cost time: 26.70743155479431
Epoch: 14, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.365 Vali Acc: 0.371 Test Loss: 2.365 Test Acc: 0.371
Validation loss decreased (-0.367376 --> -0.370617).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2575067
	speed: 0.6585s/iter; left time: 1557.4069s
Epoch: 15 cost time: 29.801361560821533
Epoch: 15, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.628 Vali Acc: 0.254 Test Loss: 2.628 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.9153731
	speed: 0.5909s/iter; left time: 1306.5555s
Epoch: 16 cost time: 23.49484157562256
Epoch: 16, Steps: 154 | Train Loss: 1.221 Vali Loss: 4.546 Vali Acc: 0.126 Test Loss: 4.546 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9249265
	speed: 0.6170s/iter; left time: 1269.1767s
Epoch: 17 cost time: 25.753647804260254
Epoch: 17, Steps: 154 | Train Loss: 1.186 Vali Loss: 5.017 Vali Acc: 0.123 Test Loss: 5.017 Test Acc: 0.123
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.0827119
	speed: 0.5620s/iter; left time: 1069.5185s
Epoch: 18 cost time: 26.508475303649902
Epoch: 18, Steps: 154 | Train Loss: 1.148 Vali Loss: 2.787 Vali Acc: 0.275 Test Loss: 2.787 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.2530130
	speed: 0.6615s/iter; left time: 1156.9226s
Epoch: 19 cost time: 31.840497970581055
Epoch: 19, Steps: 154 | Train Loss: 1.109 Vali Loss: 3.382 Vali Acc: 0.154 Test Loss: 3.382 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6342470
	speed: 0.6336s/iter; left time: 1010.6135s
Epoch: 20 cost time: 28.61086893081665
Epoch: 20, Steps: 154 | Train Loss: 1.074 Vali Loss: 3.743 Vali Acc: 0.131 Test Loss: 3.743 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9799978
	speed: 0.6605s/iter; left time: 951.7596s
Epoch: 21 cost time: 30.863746643066406
Epoch: 21, Steps: 154 | Train Loss: 1.059 Vali Loss: 4.222 Vali Acc: 0.140 Test Loss: 4.222 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.3640070
	speed: 0.6675s/iter; left time: 859.1220s
Epoch: 22 cost time: 30.31917929649353
Epoch: 22, Steps: 154 | Train Loss: 1.018 Vali Loss: 4.100 Vali Acc: 0.133 Test Loss: 4.100 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.5725133
	speed: 0.6639s/iter; left time: 752.1659s
Epoch: 23 cost time: 28.38441276550293
Epoch: 23, Steps: 154 | Train Loss: 0.970 Vali Loss: 3.876 Vali Acc: 0.131 Test Loss: 3.876 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.6272368
	speed: 0.6419s/iter; left time: 628.4435s
Epoch: 24 cost time: 31.4269962310791
Epoch: 24, Steps: 154 | Train Loss: 0.959 Vali Loss: 4.150 Vali Acc: 0.148 Test Loss: 4.150 Test Acc: 0.148
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3706407137064071
model parameter : 697870
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1748343
	speed: 0.2714s/iter; left time: 1227.1213s
Epoch: 1 cost time: 40.61809062957764
Epoch: 1, Steps: 154 | Train Loss: 2.175 Vali Loss: 2.154 Vali Acc: 0.317 Test Loss: 2.154 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8407781
	speed: 0.8155s/iter; left time: 3561.3092s
Epoch: 2 cost time: 26.471299648284912
Epoch: 2, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.090 Vali Acc: 0.335 Test Loss: 2.090 Test Acc: 0.335
Validation loss decreased (-0.317091 --> -0.335340).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8943243
	speed: 0.6694s/iter; left time: 2820.0939s
Epoch: 3 cost time: 30.801021337509155
Epoch: 3, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.104 Vali Acc: 0.330 Test Loss: 2.104 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7497592
	speed: 0.7362s/iter; left time: 2988.0956s
Epoch: 4 cost time: 33.19199013710022
Epoch: 4, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.150 Vali Acc: 0.349 Test Loss: 2.150 Test Acc: 0.349
Validation loss decreased (-0.335340 --> -0.349127).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2572770
	speed: 0.7890s/iter; left time: 3081.2017s
Epoch: 5 cost time: 37.288318157196045
Epoch: 5, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.033 Vali Acc: 0.317 Test Loss: 2.033 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4447370
	speed: 0.7078s/iter; left time: 2655.0593s
Epoch: 6 cost time: 28.41764783859253
Epoch: 6, Steps: 154 | Train Loss: 1.635 Vali Loss: 3.392 Vali Acc: 0.110 Test Loss: 3.392 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7493098
	speed: 0.7139s/iter; left time: 2567.9328s
Epoch: 7 cost time: 31.800774812698364
Epoch: 7, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.313 Vali Acc: 0.294 Test Loss: 2.313 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4614472
	speed: 0.7393s/iter; left time: 2545.5019s
Epoch: 8 cost time: 37.85174083709717
Epoch: 8, Steps: 154 | Train Loss: 1.533 Vali Loss: 2.009 Vali Acc: 0.354 Test Loss: 2.009 Test Acc: 0.354
Validation loss decreased (-0.349127 --> -0.353995).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5296088
	speed: 0.7117s/iter; left time: 2340.6978s
Epoch: 9 cost time: 23.83565926551819
Epoch: 9, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.120 Vali Acc: 0.374 Test Loss: 2.120 Test Acc: 0.374
Validation loss decreased (-0.353995 --> -0.374269).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4958839
	speed: 0.7893s/iter; left time: 2474.6026s
Epoch: 10 cost time: 38.798064947128296
Epoch: 10, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.404 Vali Acc: 0.268 Test Loss: 2.404 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8170033
	speed: 0.8226s/iter; left time: 2452.3188s
Epoch: 11 cost time: 34.78314971923828
Epoch: 11, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.480 Vali Acc: 0.114 Test Loss: 3.480 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8657573
	speed: 0.7881s/iter; left time: 2227.9284s
Epoch: 12 cost time: 31.465116262435913
Epoch: 12, Steps: 154 | Train Loss: 1.355 Vali Loss: 5.895 Vali Acc: 0.109 Test Loss: 5.895 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1119879
	speed: 0.8217s/iter; left time: 2196.4478s
Epoch: 13 cost time: 38.52885389328003
Epoch: 13, Steps: 154 | Train Loss: 1.318 Vali Loss: 2.050 Vali Acc: 0.365 Test Loss: 2.050 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.0699451
	speed: 0.7494s/iter; left time: 1887.7396s
Epoch: 14 cost time: 32.346543312072754
Epoch: 14, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.141 Vali Acc: 0.277 Test Loss: 2.141 Test Acc: 0.277
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.0208046
	speed: 0.7168s/iter; left time: 1695.1734s
Epoch: 15 cost time: 31.16089653968811
Epoch: 15, Steps: 154 | Train Loss: 1.251 Vali Loss: 2.864 Vali Acc: 0.116 Test Loss: 2.864 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.2244221
	speed: 0.6132s/iter; left time: 1355.7637s
Epoch: 16 cost time: 29.554950952529907
Epoch: 16, Steps: 154 | Train Loss: 1.247 Vali Loss: 2.782 Vali Acc: 0.195 Test Loss: 2.782 Test Acc: 0.195
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.3405323
	speed: 0.7368s/iter; left time: 1515.5895s
Epoch: 17 cost time: 32.19894003868103
Epoch: 17, Steps: 154 | Train Loss: 1.238 Vali Loss: 2.677 Vali Acc: 0.197 Test Loss: 2.677 Test Acc: 0.197
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.4762557
	speed: 0.7212s/iter; left time: 1372.5205s
Epoch: 18 cost time: 31.31127667427063
Epoch: 18, Steps: 154 | Train Loss: 1.183 Vali Loss: 2.217 Vali Acc: 0.223 Test Loss: 2.217 Test Acc: 0.223
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.0691398
	speed: 0.6507s/iter; left time: 1138.1167s
Epoch: 19 cost time: 31.398900508880615
Epoch: 19, Steps: 154 | Train Loss: 1.155 Vali Loss: 3.328 Vali Acc: 0.158 Test Loss: 3.328 Test Acc: 0.158
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3742903487429035
model parameter : 2353294
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.9168372
	speed: 0.1461s/iter; left time: 660.7394s
Epoch: 1 cost time: 22.68803834915161
Epoch: 1, Steps: 154 | Train Loss: 2.173 Vali Loss: 2.189 Vali Acc: 0.315 Test Loss: 2.189 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9048965
	speed: 0.4609s/iter; left time: 2012.8562s
Epoch: 2 cost time: 17.60381031036377
Epoch: 2, Steps: 154 | Train Loss: 1.981 Vali Loss: 2.047 Vali Acc: 0.339 Test Loss: 2.047 Test Acc: 0.339
Validation loss decreased (-0.315469 --> -0.339396).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6120269
	speed: 0.4842s/iter; left time: 2040.0820s
Epoch: 3 cost time: 23.98382544517517
Epoch: 3, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.218 Vali Acc: 0.328 Test Loss: 2.218 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6940662
	speed: 0.5838s/iter; left time: 2369.5982s
Epoch: 4 cost time: 23.170878171920776
Epoch: 4, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.286 Vali Acc: 0.341 Test Loss: 2.286 Test Acc: 0.341
Validation loss decreased (-0.339396 --> -0.341421).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6421696
	speed: 0.5682s/iter; left time: 2218.7806s
Epoch: 5 cost time: 25.031023263931274
Epoch: 5, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.380 Vali Acc: 0.349 Test Loss: 2.380 Test Acc: 0.349
Validation loss decreased (-0.341421 --> -0.349125).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9341302
	speed: 0.5071s/iter; left time: 1902.2470s
Epoch: 6 cost time: 21.762863397598267
Epoch: 6, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.250 Vali Acc: 0.356 Test Loss: 2.250 Test Acc: 0.356
Validation loss decreased (-0.349125 --> -0.356020).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0666323
	speed: 0.5390s/iter; left time: 1938.7002s
Epoch: 7 cost time: 20.123356103897095
Epoch: 7, Steps: 154 | Train Loss: 1.553 Vali Loss: 2.266 Vali Acc: 0.348 Test Loss: 2.266 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3344634
	speed: 0.4781s/iter; left time: 1646.0987s
Epoch: 8 cost time: 23.269623279571533
Epoch: 8, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.317 Vali Acc: 0.357 Test Loss: 2.317 Test Acc: 0.357
Validation loss decreased (-0.356020 --> -0.357236).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5014431
	speed: 0.4661s/iter; left time: 1533.1536s
Epoch: 9 cost time: 15.733015060424805
Epoch: 9, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.354 Vali Acc: 0.351 Test Loss: 2.354 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3068484
	speed: 0.4261s/iter; left time: 1335.9384s
Epoch: 10 cost time: 17.157490253448486
Epoch: 10, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.270 Vali Acc: 0.367 Test Loss: 2.270 Test Acc: 0.367
Validation loss decreased (-0.357236 --> -0.366968).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3813316
	speed: 0.4111s/iter; left time: 1225.3787s
Epoch: 11 cost time: 15.972177267074585
Epoch: 11, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.296 Vali Acc: 0.365 Test Loss: 2.296 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3231733
	speed: 0.3252s/iter; left time: 919.4320s
Epoch: 12 cost time: 15.264694929122925
Epoch: 12, Steps: 154 | Train Loss: 1.378 Vali Loss: 3.874 Vali Acc: 0.113 Test Loss: 3.874 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5106711
	speed: 0.4117s/iter; left time: 1100.5217s
Epoch: 13 cost time: 21.026811122894287
Epoch: 13, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.468 Vali Acc: 0.109 Test Loss: 3.468 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.1626821
	speed: 0.4473s/iter; left time: 1126.8520s
Epoch: 14 cost time: 15.681037187576294
Epoch: 14, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.475 Vali Acc: 0.371 Test Loss: 2.475 Test Acc: 0.371
Validation loss decreased (-0.366968 --> -0.371427).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4286531
	speed: 0.4196s/iter; left time: 992.4350s
Epoch: 15 cost time: 16.23729968070984
Epoch: 15, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.925 Vali Acc: 0.174 Test Loss: 2.925 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8477683
	speed: 0.4283s/iter; left time: 946.8643s
Epoch: 16 cost time: 21.273317337036133
Epoch: 16, Steps: 154 | Train Loss: 1.237 Vali Loss: 3.278 Vali Acc: 0.124 Test Loss: 3.278 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9017503
	speed: 0.4776s/iter; left time: 982.4464s
Epoch: 17 cost time: 18.636740922927856
Epoch: 17, Steps: 154 | Train Loss: 1.251 Vali Loss: 2.813 Vali Acc: 0.170 Test Loss: 2.813 Test Acc: 0.170
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.1140584
	speed: 0.4199s/iter; left time: 799.0935s
Epoch: 18 cost time: 16.406023740768433
Epoch: 18, Steps: 154 | Train Loss: 1.189 Vali Loss: 3.528 Vali Acc: 0.140 Test Loss: 3.528 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.2836068
	speed: 0.3838s/iter; left time: 671.1872s
Epoch: 19 cost time: 16.412310123443604
Epoch: 19, Steps: 154 | Train Loss: 1.152 Vali Loss: 3.423 Vali Acc: 0.126 Test Loss: 3.423 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.6466908
	speed: 0.4216s/iter; left time: 672.5078s
Epoch: 20 cost time: 19.83515954017639
Epoch: 20, Steps: 154 | Train Loss: 1.112 Vali Loss: 2.907 Vali Acc: 0.306 Test Loss: 2.907 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9256501
	speed: 0.4437s/iter; left time: 639.3511s
Epoch: 21 cost time: 18.05296015739441
Epoch: 21, Steps: 154 | Train Loss: 1.107 Vali Loss: 3.086 Vali Acc: 0.129 Test Loss: 3.086 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.4496577
	speed: 0.3867s/iter; left time: 497.7315s
Epoch: 22 cost time: 17.278264045715332
Epoch: 22, Steps: 154 | Train Loss: 1.094 Vali Loss: 2.733 Vali Acc: 0.378 Test Loss: 2.733 Test Acc: 0.378
Validation loss decreased (-0.371427 --> -0.377507).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.5615125
	speed: 0.4974s/iter; left time: 563.5389s
Epoch: 23 cost time: 18.5672767162323
Epoch: 23, Steps: 154 | Train Loss: 1.060 Vali Loss: 4.712 Vali Acc: 0.128 Test Loss: 4.712 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.7720821
	speed: 0.3993s/iter; left time: 390.9527s
Epoch: 24 cost time: 16.816449880599976
Epoch: 24, Steps: 154 | Train Loss: 1.036 Vali Loss: 3.546 Vali Acc: 0.171 Test Loss: 3.546 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.8966815
	speed: 0.3919s/iter; left time: 323.3138s
Epoch: 25 cost time: 15.23446536064148
Epoch: 25, Steps: 154 | Train Loss: 1.005 Vali Loss: 2.962 Vali Acc: 0.339 Test Loss: 2.962 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.9691034
	speed: 0.3635s/iter; left time: 243.9260s
Epoch: 26 cost time: 17.597816705703735
Epoch: 26, Steps: 154 | Train Loss: 1.000 Vali Loss: 3.811 Vali Acc: 0.140 Test Loss: 3.811 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.6782529
	speed: 0.4616s/iter; left time: 238.6413s
Epoch: 27 cost time: 18.31352424621582
Epoch: 27, Steps: 154 | Train Loss: 0.940 Vali Loss: 6.901 Vali Acc: 0.122 Test Loss: 6.901 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.7946852
	speed: 0.4315s/iter; left time: 156.6218s
Epoch: 28 cost time: 19.145946741104126
Epoch: 28, Steps: 154 | Train Loss: 0.934 Vali Loss: 4.008 Vali Acc: 0.227 Test Loss: 4.008 Test Acc: 0.227
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.2721735
	speed: 0.4449s/iter; left time: 92.9923s
Epoch: 29 cost time: 17.52018976211548
Epoch: 29, Steps: 154 | Train Loss: 0.896 Vali Loss: 3.597 Vali Acc: 0.371 Test Loss: 3.597 Test Acc: 0.371
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.0976882
	speed: 0.4332s/iter; left time: 23.8251s
Epoch: 30 cost time: 17.818848133087158
Epoch: 30, Steps: 154 | Train Loss: 0.911 Vali Loss: 4.976 Vali Acc: 0.113 Test Loss: 4.976 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 697870
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1604083
	speed: 0.1556s/iter; left time: 703.2610s
Epoch: 1 cost time: 22.073319911956787
Epoch: 1, Steps: 154 | Train Loss: 2.186 Vali Loss: 2.119 Vali Acc: 0.317 Test Loss: 2.119 Test Acc: 0.317
Validation loss decreased (inf --> -0.317092).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8063874
	speed: 0.4389s/iter; left time: 1916.7454s
Epoch: 2 cost time: 22.727827548980713
Epoch: 2, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.078 Vali Acc: 0.332 Test Loss: 2.078 Test Acc: 0.332
Validation loss decreased (-0.317092 --> -0.332096).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0378118
	speed: 0.4723s/iter; left time: 1989.9668s
Epoch: 3 cost time: 19.02425265312195
Epoch: 3, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.100 Vali Acc: 0.348 Test Loss: 2.100 Test Acc: 0.348
Validation loss decreased (-0.332096 --> -0.348316).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8248657
	speed: 0.4627s/iter; left time: 1878.2880s
Epoch: 4 cost time: 22.0200834274292
Epoch: 4, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.149 Vali Acc: 0.340 Test Loss: 2.149 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3650424
	speed: 0.4579s/iter; left time: 1787.9247s
Epoch: 5 cost time: 17.996548175811768
Epoch: 5, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.143 Vali Acc: 0.355 Test Loss: 2.143 Test Acc: 0.355
Validation loss decreased (-0.348316 --> -0.355210).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6051493
	speed: 0.4567s/iter; left time: 1713.0369s
Epoch: 6 cost time: 18.803746938705444
Epoch: 6, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.081 Vali Acc: 0.377 Test Loss: 2.081 Test Acc: 0.377
Validation loss decreased (-0.355210 --> -0.376703).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7406824
	speed: 0.4066s/iter; left time: 1462.5153s
Epoch: 7 cost time: 20.721590757369995
Epoch: 7, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.666 Vali Acc: 0.195 Test Loss: 2.666 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4801966
	speed: 0.4378s/iter; left time: 1507.2144s
Epoch: 8 cost time: 15.4958336353302
Epoch: 8, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.293 Vali Acc: 0.413 Test Loss: 2.293 Test Acc: 0.413
Validation loss decreased (-0.376703 --> -0.413197).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6593671
	speed: 0.4571s/iter; left time: 1503.3670s
Epoch: 9 cost time: 20.84850239753723
Epoch: 9, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.430 Vali Acc: 0.209 Test Loss: 2.430 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6080649
	speed: 0.3954s/iter; left time: 1239.5546s
Epoch: 10 cost time: 17.70306897163391
Epoch: 10, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.771 Vali Acc: 0.213 Test Loss: 2.771 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8887421
	speed: 0.4169s/iter; left time: 1242.9056s
Epoch: 11 cost time: 18.19311237335205
Epoch: 11, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.189 Vali Acc: 0.406 Test Loss: 2.189 Test Acc: 0.406
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8796774
	speed: 0.4208s/iter; left time: 1189.6805s
Epoch: 12 cost time: 18.40696668624878
Epoch: 12, Steps: 154 | Train Loss: 1.440 Vali Loss: 3.073 Vali Acc: 0.368 Test Loss: 3.073 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2115022
	speed: 0.3837s/iter; left time: 1025.6115s
Epoch: 13 cost time: 15.582290172576904
Epoch: 13, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.722 Vali Acc: 0.223 Test Loss: 2.722 Test Acc: 0.223
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.9338379
	speed: 0.4131s/iter; left time: 1040.6630s
Epoch: 14 cost time: 15.933055877685547
Epoch: 14, Steps: 154 | Train Loss: 1.333 Vali Loss: 3.313 Vali Acc: 0.375 Test Loss: 3.313 Test Acc: 0.375
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2001305
	speed: 0.3010s/iter; left time: 711.8224s
Epoch: 15 cost time: 16.51863956451416
Epoch: 15, Steps: 154 | Train Loss: 1.288 Vali Loss: 3.340 Vali Acc: 0.183 Test Loss: 3.340 Test Acc: 0.183
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1513910
	speed: 0.3901s/iter; left time: 862.4385s
Epoch: 16 cost time: 18.419011116027832
Epoch: 16, Steps: 154 | Train Loss: 1.288 Vali Loss: 3.319 Vali Acc: 0.236 Test Loss: 3.319 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.4151716
	speed: 0.4530s/iter; left time: 931.7713s
Epoch: 17 cost time: 16.966765642166138
Epoch: 17, Steps: 154 | Train Loss: 1.287 Vali Loss: 4.519 Vali Acc: 0.150 Test Loss: 4.519 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.4014555
	speed: 0.3715s/iter; left time: 707.0169s
Epoch: 18 cost time: 17.59381103515625
Epoch: 18, Steps: 154 | Train Loss: 1.266 Vali Loss: 3.974 Vali Acc: 0.186 Test Loss: 3.974 Test Acc: 0.186
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41321978913219787
model parameter : 2353294
model size : 9.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.8800864
	speed: 0.1026s/iter; left time: 464.0537s
Epoch: 1 cost time: 15.120185375213623
Epoch: 1, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.163 Vali Acc: 0.315 Test Loss: 2.163 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9119799
	speed: 0.4223s/iter; left time: 1844.1668s
Epoch: 2 cost time: 16.195239305496216
Epoch: 2, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.057 Vali Acc: 0.333 Test Loss: 2.057 Test Acc: 0.333
Validation loss decreased (-0.315469 --> -0.332502).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7460437
	speed: 0.4498s/iter; left time: 1894.9797s
Epoch: 3 cost time: 18.567771673202515
Epoch: 3, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.126 Vali Acc: 0.335 Test Loss: 2.126 Test Acc: 0.335
Validation loss decreased (-0.332502 --> -0.334934).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8334014
	speed: 0.4017s/iter; left time: 1630.5423s
Epoch: 4 cost time: 16.13025736808777
Epoch: 4, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.131 Vali Acc: 0.337 Test Loss: 2.131 Test Acc: 0.337
Validation loss decreased (-0.334934 --> -0.337367).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7403637
	speed: 0.4782s/iter; left time: 1867.4390s
Epoch: 5 cost time: 19.20784091949463
Epoch: 5, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.277 Vali Acc: 0.341 Test Loss: 2.277 Test Acc: 0.341
Validation loss decreased (-0.337367 --> -0.340610).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8687527
	speed: 0.3850s/iter; left time: 1444.0185s
Epoch: 6 cost time: 17.266022443771362
Epoch: 6, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.107 Vali Acc: 0.351 Test Loss: 2.107 Test Acc: 0.351
Validation loss decreased (-0.340610 --> -0.350749).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9842356
	speed: 0.4088s/iter; left time: 1470.6052s
Epoch: 7 cost time: 15.856433391571045
Epoch: 7, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.235 Vali Acc: 0.345 Test Loss: 2.235 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4005864
	speed: 0.4040s/iter; left time: 1390.8384s
Epoch: 8 cost time: 16.53408670425415
Epoch: 8, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.074 Vali Acc: 0.354 Test Loss: 2.074 Test Acc: 0.354
Validation loss decreased (-0.350749 --> -0.353994).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6062303
	speed: 0.3789s/iter; left time: 1246.2322s
Epoch: 9 cost time: 14.763482570648193
Epoch: 9, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.334 Vali Acc: 0.351 Test Loss: 2.334 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4597213
	speed: 0.4136s/iter; left time: 1296.7570s
Epoch: 10 cost time: 16.836386919021606
Epoch: 10, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.292 Vali Acc: 0.368 Test Loss: 2.292 Test Acc: 0.368
Validation loss decreased (-0.353994 --> -0.368185).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3343136
	speed: 0.4142s/iter; left time: 1234.6552s
Epoch: 11 cost time: 17.875391006469727
Epoch: 11, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.933 Vali Acc: 0.174 Test Loss: 2.933 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2870181
	speed: 0.4629s/iter; left time: 1308.6025s
Epoch: 12 cost time: 16.904298305511475
Epoch: 12, Steps: 154 | Train Loss: 1.440 Vali Loss: 3.152 Vali Acc: 0.172 Test Loss: 3.152 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6792266
	speed: 0.4439s/iter; left time: 1186.6337s
Epoch: 13 cost time: 18.934406042099
Epoch: 13, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.087 Vali Acc: 0.176 Test Loss: 3.087 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.1328561
	speed: 0.4389s/iter; left time: 1105.5613s
Epoch: 14 cost time: 16.36220622062683
Epoch: 14, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.937 Vali Acc: 0.388 Test Loss: 2.937 Test Acc: 0.388
Validation loss decreased (-0.368185 --> -0.388048).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4109243
	speed: 0.4303s/iter; left time: 1017.6570s
Epoch: 15 cost time: 16.241097688674927
Epoch: 15, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.625 Vali Acc: 0.127 Test Loss: 3.625 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 2.1269360
	speed: 0.3688s/iter; left time: 815.3418s
Epoch: 16 cost time: 15.65115213394165
Epoch: 16, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.258 Vali Acc: 0.380 Test Loss: 3.258 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.0936469
	speed: 0.3868s/iter; left time: 795.6824s
Epoch: 17 cost time: 14.328812599182129
Epoch: 17, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.091 Vali Acc: 0.384 Test Loss: 3.091 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2579855
	speed: 0.3248s/iter; left time: 618.1603s
Epoch: 18 cost time: 14.295081377029419
Epoch: 18, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.951 Vali Acc: 0.203 Test Loss: 2.951 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.4360300
	speed: 0.3409s/iter; left time: 596.2416s
Epoch: 19 cost time: 13.174647331237793
Epoch: 19, Steps: 154 | Train Loss: 1.253 Vali Loss: 4.364 Vali Acc: 0.112 Test Loss: 4.364 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.0285300
	speed: 0.3555s/iter; left time: 566.9945s
Epoch: 20 cost time: 13.87655234336853
Epoch: 20, Steps: 154 | Train Loss: 1.213 Vali Loss: 3.053 Vali Acc: 0.397 Test Loss: 3.053 Test Acc: 0.397
Validation loss decreased (-0.388048 --> -0.396563).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.8335288
	speed: 0.3245s/iter; left time: 467.6472s
Epoch: 21 cost time: 14.259588479995728
Epoch: 21, Steps: 154 | Train Loss: 1.195 Vali Loss: 2.699 Vali Acc: 0.224 Test Loss: 2.699 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.5382773
	speed: 0.3509s/iter; left time: 451.5701s
Epoch: 22 cost time: 12.98837161064148
Epoch: 22, Steps: 154 | Train Loss: 1.175 Vali Loss: 2.684 Vali Acc: 0.422 Test Loss: 2.684 Test Acc: 0.422
Validation loss decreased (-0.396563 --> -0.422114).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.6900530
	speed: 0.3204s/iter; left time: 363.0657s
Epoch: 23 cost time: 14.794037103652954
Epoch: 23, Steps: 154 | Train Loss: 1.177 Vali Loss: 4.519 Vali Acc: 0.103 Test Loss: 4.519 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.9229624
	speed: 0.3542s/iter; left time: 346.7604s
Epoch: 24 cost time: 13.870331048965454
Epoch: 24, Steps: 154 | Train Loss: 1.149 Vali Loss: 4.564 Vali Acc: 0.135 Test Loss: 4.564 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.0458236
	speed: 0.3719s/iter; left time: 306.8259s
Epoch: 25 cost time: 14.333383798599243
Epoch: 25, Steps: 154 | Train Loss: 1.145 Vali Loss: 5.547 Vali Acc: 0.101 Test Loss: 5.547 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.2366314
	speed: 0.3627s/iter; left time: 243.3596s
Epoch: 26 cost time: 15.508172750473022
Epoch: 26, Steps: 154 | Train Loss: 1.129 Vali Loss: 4.301 Vali Acc: 0.149 Test Loss: 4.301 Test Acc: 0.149
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.6705489
	speed: 0.3695s/iter; left time: 191.0100s
Epoch: 27 cost time: 15.744165182113647
Epoch: 27, Steps: 154 | Train Loss: 1.087 Vali Loss: 3.974 Vali Acc: 0.196 Test Loss: 3.974 Test Acc: 0.196
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.8211911
	speed: 0.3751s/iter; left time: 136.1708s
Epoch: 28 cost time: 14.895918130874634
Epoch: 28, Steps: 154 | Train Loss: 1.050 Vali Loss: 4.221 Vali Acc: 0.337 Test Loss: 4.221 Test Acc: 0.337
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.2981290
	speed: 0.3867s/iter; left time: 80.8268s
Epoch: 29 cost time: 14.76796579360962
Epoch: 29, Steps: 154 | Train Loss: 1.054 Vali Loss: 3.948 Vali Acc: 0.197 Test Loss: 3.948 Test Acc: 0.197
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.2210107
	speed: 0.3276s/iter; left time: 18.0203s
Epoch: 30 cost time: 14.98284125328064
Epoch: 30, Steps: 154 | Train Loss: 1.041 Vali Loss: 6.534 Vali Acc: 0.107 Test Loss: 6.534 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4221411192214112
model parameter : 697870
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2852652
	speed: 0.1885s/iter; left time: 852.2400s
Epoch: 1 cost time: 27.63845705986023
Epoch: 1, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.115 Vali Acc: 0.317 Test Loss: 2.115 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3056917
	speed: 0.5334s/iter; left time: 2329.3446s
Epoch: 2 cost time: 25.85974907875061
Epoch: 2, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.101 Vali Acc: 0.343 Test Loss: 2.101 Test Acc: 0.343
Validation loss decreased (-0.316686 --> -0.343045).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6625636
	speed: 0.5135s/iter; left time: 2163.3018s
Epoch: 3 cost time: 25.42212748527527
Epoch: 3, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.077 Vali Acc: 0.355 Test Loss: 2.077 Test Acc: 0.355
Validation loss decreased (-0.343045 --> -0.355210).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7280568
	speed: 0.5491s/iter; left time: 2228.6624s
Epoch: 4 cost time: 27.189861059188843
Epoch: 4, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.137 Vali Acc: 0.351 Test Loss: 2.137 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8925095
	speed: 0.5498s/iter; left time: 2147.0735s
Epoch: 5 cost time: 27.34571671485901
Epoch: 5, Steps: 154 | Train Loss: 1.669 Vali Loss: 2.115 Vali Acc: 0.356 Test Loss: 2.115 Test Acc: 0.356
Validation loss decreased (-0.355210 --> -0.356021).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4502015
	speed: 0.5411s/iter; left time: 2029.8119s
Epoch: 6 cost time: 25.354214906692505
Epoch: 6, Steps: 154 | Train Loss: 1.616 Vali Loss: 1.996 Vali Acc: 0.369 Test Loss: 1.996 Test Acc: 0.369
Validation loss decreased (-0.356021 --> -0.368999).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3899481
	speed: 0.4290s/iter; left time: 1543.1324s
Epoch: 7 cost time: 21.751550912857056
Epoch: 7, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.039 Vali Acc: 0.369 Test Loss: 2.039 Test Acc: 0.369
Validation loss decreased (-0.368999 --> -0.369404).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4933431
	speed: 0.4394s/iter; left time: 1512.7168s
Epoch: 8 cost time: 21.686911582946777
Epoch: 8, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.234 Vali Acc: 0.354 Test Loss: 2.234 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4492348
	speed: 0.4771s/iter; left time: 1569.3057s
Epoch: 9 cost time: 27.02495837211609
Epoch: 9, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.434 Vali Acc: 0.351 Test Loss: 2.434 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4852297
	speed: 0.5487s/iter; left time: 1720.3088s
Epoch: 10 cost time: 26.07170796394348
Epoch: 10, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.286 Vali Acc: 0.365 Test Loss: 2.286 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4550924
	speed: 0.5439s/iter; left time: 1621.2618s
Epoch: 11 cost time: 26.150739908218384
Epoch: 11, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.213 Vali Acc: 0.363 Test Loss: 2.213 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2297367
	speed: 0.5517s/iter; left time: 1559.7469s
Epoch: 12 cost time: 25.662570476531982
Epoch: 12, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.297 Vali Acc: 0.378 Test Loss: 2.297 Test Acc: 0.378
Validation loss decreased (-0.369404 --> -0.377917).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3940747
	speed: 0.5511s/iter; left time: 1473.2215s
Epoch: 13 cost time: 25.342215538024902
Epoch: 13, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.504 Vali Acc: 0.358 Test Loss: 2.504 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1306615
	speed: 0.5556s/iter; left time: 1399.4918s
Epoch: 14 cost time: 27.031156063079834
Epoch: 14, Steps: 154 | Train Loss: 1.270 Vali Loss: 2.405 Vali Acc: 0.346 Test Loss: 2.405 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.4767247
	speed: 0.5797s/iter; left time: 1371.0523s
Epoch: 15 cost time: 23.86665654182434
Epoch: 15, Steps: 154 | Train Loss: 1.249 Vali Loss: 3.988 Vali Acc: 0.125 Test Loss: 3.988 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0581324
	speed: 0.5701s/iter; left time: 1260.4218s
Epoch: 16 cost time: 26.568782329559326
Epoch: 16, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.519 Vali Acc: 0.388 Test Loss: 2.519 Test Acc: 0.388
Validation loss decreased (-0.377917 --> -0.388053).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.2752109
	speed: 0.5762s/iter; left time: 1185.3054s
Epoch: 17 cost time: 26.331757307052612
Epoch: 17, Steps: 154 | Train Loss: 1.167 Vali Loss: 2.340 Vali Acc: 0.403 Test Loss: 2.340 Test Acc: 0.403
Validation loss decreased (-0.388053 --> -0.402653).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2152435
	speed: 0.5558s/iter; left time: 1057.6827s
Epoch: 18 cost time: 27.141920566558838
Epoch: 18, Steps: 154 | Train Loss: 1.146 Vali Loss: 2.320 Vali Acc: 0.408 Test Loss: 2.320 Test Acc: 0.408
Validation loss decreased (-0.402653 --> -0.407925).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3137956
	speed: 0.5733s/iter; left time: 1002.7696s
Epoch: 19 cost time: 27.504007577896118
Epoch: 19, Steps: 154 | Train Loss: 1.119 Vali Loss: 2.641 Vali Acc: 0.281 Test Loss: 2.641 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.3668230
	speed: 0.5757s/iter; left time: 918.2332s
Epoch: 20 cost time: 27.312703371047974
Epoch: 20, Steps: 154 | Train Loss: 1.083 Vali Loss: 4.093 Vali Acc: 0.142 Test Loss: 4.093 Test Acc: 0.142
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.3942508
	speed: 0.5633s/iter; left time: 811.7150s
Epoch: 21 cost time: 29.65583109855652
Epoch: 21, Steps: 154 | Train Loss: 1.055 Vali Loss: 2.513 Vali Acc: 0.312 Test Loss: 2.513 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.3257846
	speed: 0.6203s/iter; left time: 798.2820s
Epoch: 22 cost time: 29.71243190765381
Epoch: 22, Steps: 154 | Train Loss: 1.038 Vali Loss: 5.229 Vali Acc: 0.150 Test Loss: 5.229 Test Acc: 0.150
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.7574054
	speed: 0.6170s/iter; left time: 699.0923s
Epoch: 23 cost time: 29.61233949661255
Epoch: 23, Steps: 154 | Train Loss: 0.986 Vali Loss: 2.446 Vali Acc: 0.380 Test Loss: 2.446 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.7064381
	speed: 0.5929s/iter; left time: 580.4144s
Epoch: 24 cost time: 26.789290189743042
Epoch: 24, Steps: 154 | Train Loss: 0.951 Vali Loss: 4.814 Vali Acc: 0.154 Test Loss: 4.814 Test Acc: 0.154
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.3473225
	speed: 0.5547s/iter; left time: 457.6686s
Epoch: 25 cost time: 26.305702686309814
Epoch: 25, Steps: 154 | Train Loss: 0.947 Vali Loss: 4.831 Vali Acc: 0.133 Test Loss: 4.831 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.7096453
	speed: 0.5540s/iter; left time: 371.7190s
Epoch: 26 cost time: 26.45398712158203
Epoch: 26, Steps: 154 | Train Loss: 0.904 Vali Loss: 5.675 Vali Acc: 0.159 Test Loss: 5.675 Test Acc: 0.159
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.2602407
	speed: 0.5430s/iter; left time: 280.7553s
Epoch: 27 cost time: 23.14321279525757
Epoch: 27, Steps: 154 | Train Loss: 0.863 Vali Loss: 9.711 Vali Acc: 0.159 Test Loss: 9.711 Test Acc: 0.159
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.2737832
	speed: 0.4844s/iter; left time: 175.8459s
Epoch: 28 cost time: 24.34605121612549
Epoch: 28, Steps: 154 | Train Loss: 0.852 Vali Loss: 3.907 Vali Acc: 0.116 Test Loss: 3.907 Test Acc: 0.116
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40794809407948096
model parameter : 1181070
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7380713
	speed: 0.1347s/iter; left time: 609.1199s
Epoch: 1 cost time: 19.677276134490967
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.181 Vali Acc: 0.317 Test Loss: 2.181 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7873949
	speed: 0.4012s/iter; left time: 1752.1547s
Epoch: 2 cost time: 17.965104579925537
Epoch: 2, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.087 Vali Acc: 0.335 Test Loss: 2.087 Test Acc: 0.335
Validation loss decreased (-0.317091 --> -0.335340).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6441391
	speed: 0.3897s/iter; left time: 1641.9848s
Epoch: 3 cost time: 18.46999502182007
Epoch: 3, Steps: 154 | Train Loss: 1.877 Vali Loss: 2.184 Vali Acc: 0.331 Test Loss: 2.184 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9020541
	speed: 0.4092s/iter; left time: 1661.0223s
Epoch: 4 cost time: 19.559184551239014
Epoch: 4, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.282 Vali Acc: 0.342 Test Loss: 2.282 Test Acc: 0.342
Validation loss decreased (-0.335340 --> -0.342232).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7516619
	speed: 0.4204s/iter; left time: 1641.7605s
Epoch: 5 cost time: 19.92041254043579
Epoch: 5, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.454 Vali Acc: 0.343 Test Loss: 2.454 Test Acc: 0.343
Validation loss decreased (-0.342232 --> -0.342636).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9323636
	speed: 0.4475s/iter; left time: 1678.7425s
Epoch: 6 cost time: 19.50173544883728
Epoch: 6, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.287 Vali Acc: 0.343 Test Loss: 2.287 Test Acc: 0.343
Validation loss decreased (-0.342636 --> -0.343448).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3085412
	speed: 0.4511s/iter; left time: 1622.5665s
Epoch: 7 cost time: 20.027540922164917
Epoch: 7, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.239 Vali Acc: 0.354 Test Loss: 2.239 Test Acc: 0.354
Validation loss decreased (-0.343448 --> -0.353587).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2010376
	speed: 0.4482s/iter; left time: 1543.1507s
Epoch: 8 cost time: 20.5500271320343
Epoch: 8, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.583 Vali Acc: 0.358 Test Loss: 2.583 Test Acc: 0.358
Validation loss decreased (-0.353587 --> -0.357638).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8426454
	speed: 0.4399s/iter; left time: 1446.7502s
Epoch: 9 cost time: 20.560065269470215
Epoch: 9, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.334 Vali Acc: 0.378 Test Loss: 2.334 Test Acc: 0.378
Validation loss decreased (-0.357638 --> -0.377511).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7065146
	speed: 0.4024s/iter; left time: 1261.6043s
Epoch: 10 cost time: 18.866418838500977
Epoch: 10, Steps: 154 | Train Loss: 1.368 Vali Loss: 2.709 Vali Acc: 0.202 Test Loss: 2.709 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3994838
	speed: 0.4124s/iter; left time: 1229.2745s
Epoch: 11 cost time: 18.10964846611023
Epoch: 11, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.851 Vali Acc: 0.339 Test Loss: 2.851 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0747814
	speed: 0.3844s/iter; left time: 1086.6373s
Epoch: 12 cost time: 17.62341809272766
Epoch: 12, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.623 Vali Acc: 0.232 Test Loss: 2.623 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1409872
	speed: 0.3920s/iter; left time: 1047.7512s
Epoch: 13 cost time: 17.586095333099365
Epoch: 13, Steps: 154 | Train Loss: 1.266 Vali Loss: 2.776 Vali Acc: 0.256 Test Loss: 2.776 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.4123490
	speed: 0.3766s/iter; left time: 948.7163s
Epoch: 14 cost time: 17.605604648590088
Epoch: 14, Steps: 154 | Train Loss: 1.244 Vali Loss: 2.749 Vali Acc: 0.202 Test Loss: 2.749 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.7491851
	speed: 0.4398s/iter; left time: 1040.1067s
Epoch: 15 cost time: 19.700125217437744
Epoch: 15, Steps: 154 | Train Loss: 1.190 Vali Loss: 4.048 Vali Acc: 0.120 Test Loss: 4.048 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.6825068
	speed: 0.4102s/iter; left time: 906.9681s
Epoch: 16 cost time: 18.134356260299683
Epoch: 16, Steps: 154 | Train Loss: 1.180 Vali Loss: 5.881 Vali Acc: 0.088 Test Loss: 5.881 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.1749662
	speed: 0.4048s/iter; left time: 832.6446s
Epoch: 17 cost time: 17.905609846115112
Epoch: 17, Steps: 154 | Train Loss: 1.140 Vali Loss: 2.573 Vali Acc: 0.209 Test Loss: 2.573 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.8322801
	speed: 0.4075s/iter; left time: 775.5559s
Epoch: 18 cost time: 17.90795588493347
Epoch: 18, Steps: 154 | Train Loss: 1.092 Vali Loss: 3.611 Vali Acc: 0.126 Test Loss: 3.611 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.1214877
	speed: 0.4005s/iter; left time: 700.5431s
Epoch: 19 cost time: 17.680694818496704
Epoch: 19, Steps: 154 | Train Loss: 1.086 Vali Loss: 4.351 Vali Acc: 0.131 Test Loss: 4.351 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 353294
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3441687
	speed: 0.1351s/iter; left time: 610.5614s
Epoch: 1 cost time: 19.948193550109863
Epoch: 1, Steps: 154 | Train Loss: 2.200 Vali Loss: 2.124 Vali Acc: 0.316 Test Loss: 2.124 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2794199
	speed: 0.3775s/iter; left time: 1648.6281s
Epoch: 2 cost time: 18.123234272003174
Epoch: 2, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.058 Vali Acc: 0.340 Test Loss: 2.058 Test Acc: 0.340
Validation loss decreased (-0.316280 --> -0.339801).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5900222
	speed: 0.3800s/iter; left time: 1600.7309s
Epoch: 3 cost time: 18.040916681289673
Epoch: 3, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.060 Vali Acc: 0.341 Test Loss: 2.060 Test Acc: 0.341
Validation loss decreased (-0.339801 --> -0.341423).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7183286
	speed: 0.3626s/iter; left time: 1471.7481s
Epoch: 4 cost time: 16.766470193862915
Epoch: 4, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.199 Vali Acc: 0.349 Test Loss: 2.199 Test Acc: 0.349
Validation loss decreased (-0.341423 --> -0.349126).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8141501
	speed: 0.3768s/iter; left time: 1471.4771s
Epoch: 5 cost time: 19.21947741508484
Epoch: 5, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.011 Vali Acc: 0.351 Test Loss: 2.011 Test Acc: 0.351
Validation loss decreased (-0.349126 --> -0.351156).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6321359
	speed: 0.3908s/iter; left time: 1465.9509s
Epoch: 6 cost time: 20.677496194839478
Epoch: 6, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.044 Vali Acc: 0.357 Test Loss: 2.044 Test Acc: 0.357
Validation loss decreased (-0.351156 --> -0.356833).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4087418
	speed: 0.4297s/iter; left time: 1545.6039s
Epoch: 7 cost time: 21.04979944229126
Epoch: 7, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.586 Vali Acc: 0.099 Test Loss: 2.586 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4615023
	speed: 0.4367s/iter; left time: 1503.4062s
Epoch: 8 cost time: 21.014891147613525
Epoch: 8, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.197 Vali Acc: 0.358 Test Loss: 2.197 Test Acc: 0.358
Validation loss decreased (-0.356833 --> -0.358048).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2019650
	speed: 0.4356s/iter; left time: 1432.5365s
Epoch: 9 cost time: 21.113489627838135
Epoch: 9, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.417 Vali Acc: 0.336 Test Loss: 2.417 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4499539
	speed: 0.4355s/iter; left time: 1365.2076s
Epoch: 10 cost time: 20.38569211959839
Epoch: 10, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.208 Vali Acc: 0.376 Test Loss: 2.208 Test Acc: 0.376
Validation loss decreased (-0.358048 --> -0.375485).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5135096
	speed: 0.4293s/iter; left time: 1279.6200s
Epoch: 11 cost time: 18.375267028808594
Epoch: 11, Steps: 154 | Train Loss: 1.398 Vali Loss: 1.986 Vali Acc: 0.383 Test Loss: 1.986 Test Acc: 0.383
Validation loss decreased (-0.375485 --> -0.382786).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1044805
	speed: 0.3906s/iter; left time: 1104.1855s
Epoch: 12 cost time: 21.72173547744751
Epoch: 12, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.526 Vali Acc: 0.309 Test Loss: 2.526 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2580281
	speed: 0.4458s/iter; left time: 1191.6141s
Epoch: 13 cost time: 20.222335815429688
Epoch: 13, Steps: 154 | Train Loss: 1.308 Vali Loss: 4.023 Vali Acc: 0.132 Test Loss: 4.023 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2048541
	speed: 0.4516s/iter; left time: 1137.6214s
Epoch: 14 cost time: 21.6886568069458
Epoch: 14, Steps: 154 | Train Loss: 1.270 Vali Loss: 4.916 Vali Acc: 0.118 Test Loss: 4.916 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.5838186
	speed: 0.4346s/iter; left time: 1027.8109s
Epoch: 15 cost time: 21.07644510269165
Epoch: 15, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.561 Vali Acc: 0.142 Test Loss: 4.561 Test Acc: 0.142
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0305352
	speed: 0.4408s/iter; left time: 974.7120s
Epoch: 16 cost time: 18.27390146255493
Epoch: 16, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.597 Vali Acc: 0.360 Test Loss: 2.597 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.2519951
	speed: 0.4112s/iter; left time: 845.9053s
Epoch: 17 cost time: 20.414722204208374
Epoch: 17, Steps: 154 | Train Loss: 1.158 Vali Loss: 2.403 Vali Acc: 0.414 Test Loss: 2.403 Test Acc: 0.414
Validation loss decreased (-0.382786 --> -0.413601).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.2599691
	speed: 0.4033s/iter; left time: 767.4485s
Epoch: 18 cost time: 18.051905155181885
Epoch: 18, Steps: 154 | Train Loss: 1.167 Vali Loss: 3.012 Vali Acc: 0.248 Test Loss: 3.012 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2664644
	speed: 0.4217s/iter; left time: 737.4800s
Epoch: 19 cost time: 18.503217458724976
Epoch: 19, Steps: 154 | Train Loss: 1.122 Vali Loss: 2.824 Vali Acc: 0.248 Test Loss: 2.824 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.5725361
	speed: 0.3506s/iter; left time: 559.2094s
Epoch: 20 cost time: 18.346930503845215
Epoch: 20, Steps: 154 | Train Loss: 1.097 Vali Loss: 4.462 Vali Acc: 0.124 Test Loss: 4.462 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.4290787
	speed: 0.3760s/iter; left time: 541.7813s
Epoch: 21 cost time: 16.8724308013916
Epoch: 21, Steps: 154 | Train Loss: 1.071 Vali Loss: 2.409 Vali Acc: 0.358 Test Loss: 2.409 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.2663749
	speed: 0.3819s/iter; left time: 491.5150s
Epoch: 22 cost time: 17.81317448616028
Epoch: 22, Steps: 154 | Train Loss: 1.050 Vali Loss: 4.732 Vali Acc: 0.159 Test Loss: 4.732 Test Acc: 0.159
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.8140139
	speed: 0.3960s/iter; left time: 448.6275s
Epoch: 23 cost time: 19.367487907409668
Epoch: 23, Steps: 154 | Train Loss: 1.028 Vali Loss: 5.683 Vali Acc: 0.145 Test Loss: 5.683 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.7492259
	speed: 0.4377s/iter; left time: 428.4781s
Epoch: 24 cost time: 18.91544461250305
Epoch: 24, Steps: 154 | Train Loss: 0.991 Vali Loss: 4.710 Vali Acc: 0.126 Test Loss: 4.710 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 1.3532940
	speed: 0.4227s/iter; left time: 348.6977s
Epoch: 25 cost time: 20.935084581375122
Epoch: 25, Steps: 154 | Train Loss: 0.984 Vali Loss: 8.639 Vali Acc: 0.100 Test Loss: 8.639 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.6574209
	speed: 0.4511s/iter; left time: 302.6636s
Epoch: 26 cost time: 21.14006018638611
Epoch: 26, Steps: 154 | Train Loss: 0.925 Vali Loss: 5.316 Vali Acc: 0.147 Test Loss: 5.316 Test Acc: 0.147
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 1.0794774
	speed: 0.4435s/iter; left time: 229.3053s
Epoch: 27 cost time: 21.124390363693237
Epoch: 27, Steps: 154 | Train Loss: 0.908 Vali Loss: 4.687 Vali Acc: 0.160 Test Loss: 4.687 Test Acc: 0.160
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41362530413625304
model parameter : 1181070
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7609913
	speed: 0.1360s/iter; left time: 614.8168s
Epoch: 1 cost time: 20.187339782714844
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.182 Vali Acc: 0.315 Test Loss: 2.182 Test Acc: 0.315
Validation loss decreased (inf --> -0.315063).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8573556
	speed: 0.3859s/iter; left time: 1685.3612s
Epoch: 2 cost time: 16.461410522460938
Epoch: 2, Steps: 154 | Train Loss: 2.017 Vali Loss: 2.076 Vali Acc: 0.333 Test Loss: 2.076 Test Acc: 0.333
Validation loss decreased (-0.315063 --> -0.332502).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7483501
	speed: 0.4047s/iter; left time: 1704.9054s
Epoch: 3 cost time: 16.536621809005737
Epoch: 3, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.154 Vali Acc: 0.335 Test Loss: 2.154 Test Acc: 0.335
Validation loss decreased (-0.332502 --> -0.334934).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7836736
	speed: 0.3771s/iter; left time: 1530.7094s
Epoch: 4 cost time: 18.339965105056763
Epoch: 4, Steps: 154 | Train Loss: 1.790 Vali Loss: 2.200 Vali Acc: 0.351 Test Loss: 2.200 Test Acc: 0.351
Validation loss decreased (-0.334934 --> -0.351154).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7604368
	speed: 0.4242s/iter; left time: 1656.5468s
Epoch: 5 cost time: 17.17770004272461
Epoch: 5, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.425 Vali Acc: 0.343 Test Loss: 2.425 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8484519
	speed: 0.4065s/iter; left time: 1524.7404s
Epoch: 6 cost time: 18.967548608779907
Epoch: 6, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.342 Vali Acc: 0.343 Test Loss: 2.342 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4008032
	speed: 0.4099s/iter; left time: 1474.2993s
Epoch: 7 cost time: 17.321409225463867
Epoch: 7, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.375 Vali Acc: 0.329 Test Loss: 2.375 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1576525
	speed: 0.4236s/iter; left time: 1458.4284s
Epoch: 8 cost time: 19.061973571777344
Epoch: 8, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.683 Vali Acc: 0.355 Test Loss: 2.683 Test Acc: 0.355
Validation loss decreased (-0.351154 --> -0.355204).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9637632
	speed: 0.3992s/iter; left time: 1312.9146s
Epoch: 9 cost time: 15.87015962600708
Epoch: 9, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.443 Vali Acc: 0.369 Test Loss: 2.443 Test Acc: 0.369
Validation loss decreased (-0.355204 --> -0.368994).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6531603
	speed: 0.3923s/iter; left time: 1229.7572s
Epoch: 10 cost time: 16.344802618026733
Epoch: 10, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.684 Vali Acc: 0.211 Test Loss: 2.684 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2792011
	speed: 0.3250s/iter; left time: 968.8774s
Epoch: 11 cost time: 15.117523670196533
Epoch: 11, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.552 Vali Acc: 0.371 Test Loss: 2.552 Test Acc: 0.371
Validation loss decreased (-0.368994 --> -0.371426).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.0664514
	speed: 0.3494s/iter; left time: 987.7018s
Epoch: 12 cost time: 14.005123138427734
Epoch: 12, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.984 Vali Acc: 0.371 Test Loss: 2.984 Test Acc: 0.371
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0475280
	speed: 0.3363s/iter; left time: 898.9614s
Epoch: 13 cost time: 15.723673343658447
Epoch: 13, Steps: 154 | Train Loss: 1.297 Vali Loss: 4.450 Vali Acc: 0.125 Test Loss: 4.450 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3765661
	speed: 0.3227s/iter; left time: 813.0066s
Epoch: 14 cost time: 13.29539966583252
Epoch: 14, Steps: 154 | Train Loss: 1.287 Vali Loss: 3.193 Vali Acc: 0.221 Test Loss: 3.193 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.8091126
	speed: 0.3530s/iter; left time: 834.9547s
Epoch: 15 cost time: 15.861908674240112
Epoch: 15, Steps: 154 | Train Loss: 1.231 Vali Loss: 3.276 Vali Acc: 0.365 Test Loss: 3.276 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.6398369
	speed: 0.3399s/iter; left time: 751.4162s
Epoch: 16 cost time: 15.166705846786499
Epoch: 16, Steps: 154 | Train Loss: 1.212 Vali Loss: 5.017 Vali Acc: 0.088 Test Loss: 5.017 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.2963848
	speed: 0.3639s/iter; left time: 748.5492s
Epoch: 17 cost time: 14.692228555679321
Epoch: 17, Steps: 154 | Train Loss: 1.157 Vali Loss: 3.973 Vali Acc: 0.098 Test Loss: 3.973 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.7598062
	speed: 0.3327s/iter; left time: 633.2007s
Epoch: 18 cost time: 14.532104730606079
Epoch: 18, Steps: 154 | Train Loss: 1.135 Vali Loss: 5.792 Vali Acc: 0.094 Test Loss: 5.792 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0698941
	speed: 0.3202s/iter; left time: 560.0488s
Epoch: 19 cost time: 13.134547472000122
Epoch: 19, Steps: 154 | Train Loss: 1.131 Vali Loss: 4.010 Vali Acc: 0.152 Test Loss: 4.010 Test Acc: 0.152
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.8437816
	speed: 0.3197s/iter; left time: 509.9749s
Epoch: 20 cost time: 16.301958084106445
Epoch: 20, Steps: 154 | Train Loss: 1.069 Vali Loss: 5.117 Vali Acc: 0.129 Test Loss: 5.117 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.9236934
	speed: 0.3703s/iter; left time: 533.5592s
Epoch: 21 cost time: 15.687281847000122
Epoch: 21, Steps: 154 | Train Loss: 1.054 Vali Loss: 5.750 Vali Acc: 0.106 Test Loss: 5.750 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37145174371451745
model parameter : 353294
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3644199
	speed: 0.1764s/iter; left time: 797.7178s
Epoch: 1 cost time: 26.044451475143433
Epoch: 1, Steps: 154 | Train Loss: 2.202 Vali Loss: 2.113 Vali Acc: 0.315 Test Loss: 2.113 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3622229
	speed: 0.5057s/iter; left time: 2208.5999s
Epoch: 2 cost time: 23.934184551239014
Epoch: 2, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.045 Vali Acc: 0.332 Test Loss: 2.045 Test Acc: 0.332
Validation loss decreased (-0.315064 --> -0.332096).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6834110
	speed: 0.4557s/iter; left time: 1919.7101s
Epoch: 3 cost time: 22.792131900787354
Epoch: 3, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.103 Vali Acc: 0.330 Test Loss: 2.103 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9566799
	speed: 0.4628s/iter; left time: 1878.5488s
Epoch: 4 cost time: 24.401254415512085
Epoch: 4, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.105 Vali Acc: 0.349 Test Loss: 2.105 Test Acc: 0.349
Validation loss decreased (-0.332096 --> -0.349127).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9704159
	speed: 0.4505s/iter; left time: 1759.3609s
Epoch: 5 cost time: 21.902693271636963
Epoch: 5, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.143 Vali Acc: 0.351 Test Loss: 2.143 Test Acc: 0.351
Validation loss decreased (-0.349127 --> -0.350749).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4076549
	speed: 0.4514s/iter; left time: 1693.2337s
Epoch: 6 cost time: 21.2471284866333
Epoch: 6, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.043 Vali Acc: 0.361 Test Loss: 2.043 Test Acc: 0.361
Validation loss decreased (-0.350749 --> -0.360482).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7125263
	speed: 0.4507s/iter; left time: 1621.2440s
Epoch: 7 cost time: 21.208452939987183
Epoch: 7, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.228 Vali Acc: 0.374 Test Loss: 2.228 Test Acc: 0.374
Validation loss decreased (-0.360482 --> -0.374268).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6175122
	speed: 0.3933s/iter; left time: 1354.0381s
Epoch: 8 cost time: 16.90858268737793
Epoch: 8, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.254 Vali Acc: 0.355 Test Loss: 2.254 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2996216
	speed: 0.4008s/iter; left time: 1318.3248s
Epoch: 9 cost time: 17.70027732849121
Epoch: 9, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.463 Vali Acc: 0.368 Test Loss: 2.463 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5408702
	speed: 0.3953s/iter; left time: 1239.3799s
Epoch: 10 cost time: 16.973805904388428
Epoch: 10, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.660 Vali Acc: 0.363 Test Loss: 2.660 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6938479
	speed: 0.3323s/iter; left time: 990.5650s
Epoch: 11 cost time: 15.661103963851929
Epoch: 11, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.453 Vali Acc: 0.370 Test Loss: 2.453 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2068359
	speed: 0.3503s/iter; left time: 990.3495s
Epoch: 12 cost time: 14.862918138504028
Epoch: 12, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.328 Vali Acc: 0.365 Test Loss: 2.328 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9989287
	speed: 0.3407s/iter; left time: 910.6500s
Epoch: 13 cost time: 15.054684400558472
Epoch: 13, Steps: 154 | Train Loss: 1.338 Vali Loss: 3.053 Vali Acc: 0.380 Test Loss: 3.053 Test Acc: 0.380
Validation loss decreased (-0.374268 --> -0.380343).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1118249
	speed: 0.3115s/iter; left time: 784.7199s
Epoch: 14 cost time: 14.99688172340393
Epoch: 14, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.373 Vali Acc: 0.399 Test Loss: 2.373 Test Acc: 0.399
Validation loss decreased (-0.380343 --> -0.399409).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6843507
	speed: 0.3555s/iter; left time: 840.7507s
Epoch: 15 cost time: 14.648099899291992
Epoch: 15, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.468 Vali Acc: 0.416 Test Loss: 2.468 Test Acc: 0.416
Validation loss decreased (-0.399409 --> -0.415628).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.0612872
	speed: 0.3485s/iter; left time: 770.5197s
Epoch: 16 cost time: 16.5185546875
Epoch: 16, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.842 Vali Acc: 0.361 Test Loss: 2.842 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3693348
	speed: 0.3570s/iter; left time: 734.3006s
Epoch: 17 cost time: 14.929134845733643
Epoch: 17, Steps: 154 | Train Loss: 1.229 Vali Loss: 2.732 Vali Acc: 0.406 Test Loss: 2.732 Test Acc: 0.406
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.1570020
	speed: 0.3611s/iter; left time: 687.1931s
Epoch: 18 cost time: 15.441978931427002
Epoch: 18, Steps: 154 | Train Loss: 1.243 Vali Loss: 2.755 Vali Acc: 0.431 Test Loss: 2.755 Test Acc: 0.431
Validation loss decreased (-0.415628 --> -0.430629).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3415408
	speed: 0.3385s/iter; left time: 592.0506s
Epoch: 19 cost time: 15.542104005813599
Epoch: 19, Steps: 154 | Train Loss: 1.162 Vali Loss: 3.399 Vali Acc: 0.222 Test Loss: 3.399 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1080920
	speed: 0.3372s/iter; left time: 537.8736s
Epoch: 20 cost time: 12.611917734146118
Epoch: 20, Steps: 154 | Train Loss: 1.167 Vali Loss: 3.602 Vali Acc: 0.185 Test Loss: 3.602 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.5628310
	speed: 0.3581s/iter; left time: 516.0450s
Epoch: 21 cost time: 16.764296770095825
Epoch: 21, Steps: 154 | Train Loss: 1.147 Vali Loss: 3.054 Vali Acc: 0.249 Test Loss: 3.054 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.2652526
	speed: 0.3645s/iter; left time: 469.1463s
Epoch: 22 cost time: 16.025050401687622
Epoch: 22, Steps: 154 | Train Loss: 1.135 Vali Loss: 3.395 Vali Acc: 0.236 Test Loss: 3.395 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.7058093
	speed: 0.3798s/iter; left time: 430.3139s
Epoch: 23 cost time: 15.1194908618927
Epoch: 23, Steps: 154 | Train Loss: 1.102 Vali Loss: 3.430 Vali Acc: 0.245 Test Loss: 3.430 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.7562155
	speed: 0.3685s/iter; left time: 360.7325s
Epoch: 24 cost time: 16.833899974822998
Epoch: 24, Steps: 154 | Train Loss: 1.088 Vali Loss: 3.016 Vali Acc: 0.275 Test Loss: 3.016 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.1422353
	speed: 0.3723s/iter; left time: 307.1501s
Epoch: 25 cost time: 15.369450330734253
Epoch: 25, Steps: 154 | Train Loss: 1.067 Vali Loss: 4.157 Vali Acc: 0.130 Test Loss: 4.157 Test Acc: 0.130
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.6435202
	speed: 0.3538s/iter; left time: 237.3808s
Epoch: 26 cost time: 16.32543683052063
Epoch: 26, Steps: 154 | Train Loss: 1.038 Vali Loss: 2.801 Vali Acc: 0.414 Test Loss: 2.801 Test Acc: 0.414
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 1.4870805
	speed: 0.3614s/iter; left time: 186.8668s
Epoch: 27 cost time: 16.484808683395386
Epoch: 27, Steps: 154 | Train Loss: 1.012 Vali Loss: 3.847 Vali Acc: 0.189 Test Loss: 3.847 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.3308281
	speed: 0.3723s/iter; left time: 135.1318s
Epoch: 28 cost time: 15.735560178756714
Epoch: 28, Steps: 154 | Train Loss: 0.995 Vali Loss: 4.170 Vali Acc: 0.213 Test Loss: 4.170 Test Acc: 0.213
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4306569343065693
model parameter : 1181070
model size : 4.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7734623
	speed: 0.1023s/iter; left time: 462.4637s
Epoch: 1 cost time: 15.048570156097412
Epoch: 1, Steps: 154 | Train Loss: 2.234 Vali Loss: 2.166 Vali Acc: 0.315 Test Loss: 2.166 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8522598
	speed: 0.3160s/iter; left time: 1380.0539s
Epoch: 2 cost time: 13.830204963684082
Epoch: 2, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.085 Vali Acc: 0.327 Test Loss: 2.085 Test Acc: 0.327
Validation loss decreased (-0.315469 --> -0.327230).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6617414
	speed: 0.3136s/iter; left time: 1321.2934s
Epoch: 3 cost time: 13.835273742675781
Epoch: 3, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.186 Vali Acc: 0.330 Test Loss: 2.186 Test Acc: 0.330
Validation loss decreased (-0.327230 --> -0.330067).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9631592
	speed: 0.3175s/iter; left time: 1288.7230s
Epoch: 4 cost time: 11.405020952224731
Epoch: 4, Steps: 154 | Train Loss: 1.838 Vali Loss: 2.116 Vali Acc: 0.340 Test Loss: 2.116 Test Acc: 0.340
Validation loss decreased (-0.330067 --> -0.339800).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8524054
	speed: 0.2710s/iter; left time: 1058.3870s
Epoch: 5 cost time: 12.596954345703125
Epoch: 5, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.263 Vali Acc: 0.351 Test Loss: 2.263 Test Acc: 0.351
Validation loss decreased (-0.339800 --> -0.350748).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9460579
	speed: 0.2567s/iter; left time: 962.9560s
Epoch: 6 cost time: 11.100539445877075
Epoch: 6, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.387 Vali Acc: 0.342 Test Loss: 2.387 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5757768
	speed: 0.3172s/iter; left time: 1141.0667s
Epoch: 7 cost time: 13.630597352981567
Epoch: 7, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.200 Vali Acc: 0.367 Test Loss: 2.200 Test Acc: 0.367
Validation loss decreased (-0.350748 --> -0.367375).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3360065
	speed: 0.3026s/iter; left time: 1041.7160s
Epoch: 8 cost time: 12.804902791976929
Epoch: 8, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.575 Vali Acc: 0.365 Test Loss: 2.575 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0089767
	speed: 0.2774s/iter; left time: 912.3855s
Epoch: 9 cost time: 12.59456491470337
Epoch: 9, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.328 Vali Acc: 0.366 Test Loss: 2.328 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6178100
	speed: 0.3412s/iter; left time: 1069.7324s
Epoch: 10 cost time: 13.535792589187622
Epoch: 10, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.845 Vali Acc: 0.196 Test Loss: 2.845 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1737472
	speed: 0.3328s/iter; left time: 992.0158s
Epoch: 11 cost time: 14.790718793869019
Epoch: 11, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.736 Vali Acc: 0.204 Test Loss: 2.736 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1483040
	speed: 0.3193s/iter; left time: 902.7414s
Epoch: 12 cost time: 13.548189640045166
Epoch: 12, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.886 Vali Acc: 0.166 Test Loss: 2.886 Test Acc: 0.166
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1369823
	speed: 0.2970s/iter; left time: 793.9471s
Epoch: 13 cost time: 10.906677961349487
Epoch: 13, Steps: 154 | Train Loss: 1.353 Vali Loss: 4.061 Vali Acc: 0.077 Test Loss: 4.061 Test Acc: 0.077
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.7700925
	speed: 0.2880s/iter; left time: 725.4608s
Epoch: 14 cost time: 13.343445301055908
Epoch: 14, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.313 Vali Acc: 0.202 Test Loss: 3.313 Test Acc: 0.202
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.8065305
	speed: 0.3478s/iter; left time: 822.5928s
Epoch: 15 cost time: 13.786412715911865
Epoch: 15, Steps: 154 | Train Loss: 1.296 Vali Loss: 2.902 Vali Acc: 0.374 Test Loss: 2.902 Test Acc: 0.374
Validation loss decreased (-0.367375 --> -0.373856).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.6785674
	speed: 0.3534s/iter; left time: 781.4211s
Epoch: 16 cost time: 13.290721416473389
Epoch: 16, Steps: 154 | Train Loss: 1.269 Vali Loss: 4.052 Vali Acc: 0.191 Test Loss: 4.052 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2757957
	speed: 0.3395s/iter; left time: 698.2564s
Epoch: 17 cost time: 14.940613746643066
Epoch: 17, Steps: 154 | Train Loss: 1.243 Vali Loss: 5.183 Vali Acc: 0.082 Test Loss: 5.183 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8053539
	speed: 0.3164s/iter; left time: 602.0593s
Epoch: 18 cost time: 12.814910411834717
Epoch: 18, Steps: 154 | Train Loss: 1.218 Vali Loss: 5.059 Vali Acc: 0.070 Test Loss: 5.059 Test Acc: 0.070
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.2128044
	speed: 0.3653s/iter; left time: 638.9896s
Epoch: 19 cost time: 14.429188966751099
Epoch: 19, Steps: 154 | Train Loss: 1.210 Vali Loss: 5.019 Vali Acc: 0.073 Test Loss: 5.019 Test Acc: 0.073
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8678735
	speed: 0.3404s/iter; left time: 542.9877s
Epoch: 20 cost time: 15.028755187988281
Epoch: 20, Steps: 154 | Train Loss: 1.168 Vali Loss: 4.846 Vali Acc: 0.116 Test Loss: 4.846 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.9418494
	speed: 0.3516s/iter; left time: 506.6395s
Epoch: 21 cost time: 13.479390859603882
Epoch: 21, Steps: 154 | Train Loss: 1.144 Vali Loss: 3.625 Vali Acc: 0.232 Test Loss: 3.625 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.4746937
	speed: 0.3551s/iter; left time: 457.0133s
Epoch: 22 cost time: 14.909346103668213
Epoch: 22, Steps: 154 | Train Loss: 1.151 Vali Loss: 4.343 Vali Acc: 0.211 Test Loss: 4.343 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.2772436
	speed: 0.3378s/iter; left time: 382.7397s
Epoch: 23 cost time: 14.231398105621338
Epoch: 23, Steps: 154 | Train Loss: 1.132 Vali Loss: 5.368 Vali Acc: 0.167 Test Loss: 5.368 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.7981630
	speed: 0.3573s/iter; left time: 349.7793s
Epoch: 24 cost time: 13.446568250656128
Epoch: 24, Steps: 154 | Train Loss: 1.101 Vali Loss: 3.733 Vali Acc: 0.303 Test Loss: 3.733 Test Acc: 0.303
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.7017767
	speed: 0.3144s/iter; left time: 259.4139s
Epoch: 25 cost time: 13.826139450073242
Epoch: 25, Steps: 154 | Train Loss: 1.086 Vali Loss: 4.113 Vali Acc: 0.322 Test Loss: 4.113 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 353294
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9126848
	speed: 0.1725s/iter; left time: 779.7369s
Epoch: 1 cost time: 23.708366870880127
Epoch: 1, Steps: 154 | Train Loss: 2.187 Vali Loss: 2.100 Vali Acc: 0.318 Test Loss: 2.100 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9226811
	speed: 0.4072s/iter; left time: 1778.1369s
Epoch: 2 cost time: 21.12100052833557
Epoch: 2, Steps: 154 | Train Loss: 1.993 Vali Loss: 2.060 Vali Acc: 0.336 Test Loss: 2.060 Test Acc: 0.336
Validation loss decreased (-0.317497 --> -0.336151).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3981525
	speed: 0.3960s/iter; left time: 1668.4692s
Epoch: 3 cost time: 20.543290376663208
Epoch: 3, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.064 Vali Acc: 0.351 Test Loss: 2.064 Test Acc: 0.351
Validation loss decreased (-0.336151 --> -0.350750).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0374701
	speed: 0.4179s/iter; left time: 1696.2457s
Epoch: 4 cost time: 20.77631378173828
Epoch: 4, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.097 Vali Acc: 0.343 Test Loss: 2.097 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6084322
	speed: 0.4201s/iter; left time: 1640.3345s
Epoch: 5 cost time: 18.910462856292725
Epoch: 5, Steps: 154 | Train Loss: 1.676 Vali Loss: 1.981 Vali Acc: 0.373 Test Loss: 1.981 Test Acc: 0.373
Validation loss decreased (-0.350750 --> -0.373054).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5150958
	speed: 0.4197s/iter; left time: 1574.3053s
Epoch: 6 cost time: 18.88643527030945
Epoch: 6, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.097 Vali Acc: 0.364 Test Loss: 2.097 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8486080
	speed: 0.3980s/iter; left time: 1431.6415s
Epoch: 7 cost time: 18.4002103805542
Epoch: 7, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.025 Vali Acc: 0.373 Test Loss: 2.025 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4888464
	speed: 0.3650s/iter; left time: 1256.6340s
Epoch: 8 cost time: 16.688657999038696
Epoch: 8, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.134 Vali Acc: 0.371 Test Loss: 2.134 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.1833375
	speed: 0.3845s/iter; left time: 1264.5794s
Epoch: 9 cost time: 19.84296417236328
Epoch: 9, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.267 Vali Acc: 0.364 Test Loss: 2.267 Test Acc: 0.364
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6467154
	speed: 0.4224s/iter; left time: 1324.2390s
Epoch: 10 cost time: 20.11414909362793
Epoch: 10, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.288 Vali Acc: 0.365 Test Loss: 2.288 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5628346
	speed: 0.4729s/iter; left time: 1409.6322s
Epoch: 11 cost time: 22.289386749267578
Epoch: 11, Steps: 154 | Train Loss: 1.372 Vali Loss: 4.259 Vali Acc: 0.108 Test Loss: 4.259 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.2776853
	speed: 0.4724s/iter; left time: 1335.5646s
Epoch: 12 cost time: 21.524887561798096
Epoch: 12, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.220 Vali Acc: 0.260 Test Loss: 2.220 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.4605186
	speed: 0.4633s/iter; left time: 1238.5117s
Epoch: 13 cost time: 22.17248296737671
Epoch: 13, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.790 Vali Acc: 0.116 Test Loss: 2.790 Test Acc: 0.116
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.2983671
	speed: 0.4742s/iter; left time: 1194.6001s
Epoch: 14 cost time: 22.45880103111267
Epoch: 14, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.807 Vali Acc: 0.124 Test Loss: 3.807 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.7819660
	speed: 0.4526s/iter; left time: 1070.4904s
Epoch: 15 cost time: 20.730127573013306
Epoch: 15, Steps: 154 | Train Loss: 1.258 Vali Loss: 2.286 Vali Acc: 0.232 Test Loss: 2.286 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 594958
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7244372
	speed: 0.1255s/iter; left time: 567.2127s
Epoch: 1 cost time: 18.564133882522583
Epoch: 1, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.112 Vali Acc: 0.319 Test Loss: 2.112 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5030444
	speed: 0.3733s/iter; left time: 1630.3683s
Epoch: 2 cost time: 16.808366775512695
Epoch: 2, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.063 Vali Acc: 0.335 Test Loss: 2.063 Test Acc: 0.335
Validation loss decreased (-0.319119 --> -0.334529).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1373014
	speed: 0.3570s/iter; left time: 1504.2434s
Epoch: 3 cost time: 15.004829168319702
Epoch: 3, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.303 Vali Acc: 0.219 Test Loss: 2.303 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8451089
	speed: 0.3181s/iter; left time: 1291.3227s
Epoch: 4 cost time: 16.250462770462036
Epoch: 4, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.118 Vali Acc: 0.338 Test Loss: 2.118 Test Acc: 0.338
Validation loss decreased (-0.334529 --> -0.337773).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8795847
	speed: 0.3386s/iter; left time: 1322.1576s
Epoch: 5 cost time: 15.429518699645996
Epoch: 5, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.243 Vali Acc: 0.082 Test Loss: 2.243 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7269329
	speed: 0.3398s/iter; left time: 1274.7246s
Epoch: 6 cost time: 15.255608320236206
Epoch: 6, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.205 Vali Acc: 0.339 Test Loss: 2.205 Test Acc: 0.339
Validation loss decreased (-0.337773 --> -0.339394).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6702485
	speed: 0.3414s/iter; left time: 1228.1584s
Epoch: 7 cost time: 15.212622880935669
Epoch: 7, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.702 Vali Acc: 0.087 Test Loss: 2.702 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0720401
	speed: 0.3502s/iter; left time: 1205.6005s
Epoch: 8 cost time: 15.341866731643677
Epoch: 8, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.296 Vali Acc: 0.341 Test Loss: 2.296 Test Acc: 0.341
Validation loss decreased (-0.339394 --> -0.341015).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3174462
	speed: 0.3137s/iter; left time: 1031.7955s
Epoch: 9 cost time: 14.639005661010742
Epoch: 9, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.053 Vali Acc: 0.213 Test Loss: 2.053 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1644197
	speed: 0.3053s/iter; left time: 957.1821s
Epoch: 10 cost time: 13.792164087295532
Epoch: 10, Steps: 154 | Train Loss: 1.451 Vali Loss: 4.372 Vali Acc: 0.125 Test Loss: 4.372 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3192248
	speed: 0.3092s/iter; left time: 921.7538s
Epoch: 11 cost time: 15.510596752166748
Epoch: 11, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.693 Vali Acc: 0.101 Test Loss: 3.693 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2369145
	speed: 0.3659s/iter; left time: 1034.3444s
Epoch: 12 cost time: 17.095356702804565
Epoch: 12, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.415 Vali Acc: 0.097 Test Loss: 3.415 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0277804
	speed: 0.3610s/iter; left time: 964.9092s
Epoch: 13 cost time: 16.71141815185547
Epoch: 13, Steps: 154 | Train Loss: 1.357 Vali Loss: 5.460 Vali Acc: 0.123 Test Loss: 5.460 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.9594979
	speed: 0.3734s/iter; left time: 940.7205s
Epoch: 14 cost time: 17.792478561401367
Epoch: 14, Steps: 154 | Train Loss: 1.320 Vali Loss: 2.600 Vali Acc: 0.127 Test Loss: 2.600 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.4888924
	speed: 0.3879s/iter; left time: 917.4508s
Epoch: 15 cost time: 18.366886138916016
Epoch: 15, Steps: 154 | Train Loss: 1.282 Vali Loss: 2.652 Vali Acc: 0.217 Test Loss: 2.652 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1220186
	speed: 0.3857s/iter; left time: 852.8381s
Epoch: 16 cost time: 17.13024139404297
Epoch: 16, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.354 Vali Acc: 0.123 Test Loss: 3.354 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.3243494
	speed: 0.3557s/iter; left time: 731.7500s
Epoch: 17 cost time: 16.582698822021484
Epoch: 17, Steps: 154 | Train Loss: 1.237 Vali Loss: 4.557 Vali Acc: 0.116 Test Loss: 4.557 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.8852552
	speed: 0.3556s/iter; left time: 676.7310s
Epoch: 18 cost time: 16.30766725540161
Epoch: 18, Steps: 154 | Train Loss: 1.196 Vali Loss: 6.959 Vali Acc: 0.134 Test Loss: 6.959 Test Acc: 0.134
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3410381184103812
model parameter : 181006
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9445541
	speed: 0.1373s/iter; left time: 620.5282s
Epoch: 1 cost time: 19.692473649978638
Epoch: 1, Steps: 154 | Train Loss: 2.196 Vali Loss: 2.104 Vali Acc: 0.316 Test Loss: 2.104 Test Acc: 0.316
Validation loss decreased (inf --> -0.316281).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9192570
	speed: 0.4720s/iter; left time: 2061.2374s
Epoch: 2 cost time: 25.75284433364868
Epoch: 2, Steps: 154 | Train Loss: 1.997 Vali Loss: 2.063 Vali Acc: 0.335 Test Loss: 2.063 Test Acc: 0.335
Validation loss decreased (-0.316281 --> -0.335340).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4324136
	speed: 0.5423s/iter; left time: 2284.6347s
Epoch: 3 cost time: 26.26358461380005
Epoch: 3, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.053 Vali Acc: 0.350 Test Loss: 2.053 Test Acc: 0.350
Validation loss decreased (-0.335340 --> -0.349939).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0004919
	speed: 0.4924s/iter; left time: 1998.7936s
Epoch: 4 cost time: 23.06366539001465
Epoch: 4, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.043 Vali Acc: 0.355 Test Loss: 2.043 Test Acc: 0.355
Validation loss decreased (-0.349939 --> -0.354805).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5008072
	speed: 0.5044s/iter; left time: 1969.6447s
Epoch: 5 cost time: 24.820748805999756
Epoch: 5, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.013 Vali Acc: 0.377 Test Loss: 2.013 Test Acc: 0.377
Validation loss decreased (-0.354805 --> -0.377109).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5281526
	speed: 0.4901s/iter; left time: 1838.2504s
Epoch: 6 cost time: 23.240300178527832
Epoch: 6, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.118 Vali Acc: 0.369 Test Loss: 2.118 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9418318
	speed: 0.4882s/iter; left time: 1755.9282s
Epoch: 7 cost time: 23.33223009109497
Epoch: 7, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.268 Vali Acc: 0.197 Test Loss: 2.268 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5572824
	speed: 0.4871s/iter; left time: 1677.1898s
Epoch: 8 cost time: 23.12387180328369
Epoch: 8, Steps: 154 | Train Loss: 1.515 Vali Loss: 1.994 Vali Acc: 0.380 Test Loss: 1.994 Test Acc: 0.380
Validation loss decreased (-0.377109 --> -0.380353).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0608211
	speed: 0.4780s/iter; left time: 1572.2072s
Epoch: 9 cost time: 22.349179983139038
Epoch: 9, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.164 Vali Acc: 0.197 Test Loss: 2.164 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7046491
	speed: 0.5002s/iter; left time: 1568.2108s
Epoch: 10 cost time: 22.610302448272705
Epoch: 10, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.035 Vali Acc: 0.386 Test Loss: 2.035 Test Acc: 0.386
Validation loss decreased (-0.380353 --> -0.386030).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6519634
	speed: 0.4628s/iter; left time: 1379.5504s
Epoch: 11 cost time: 21.44511842727661
Epoch: 11, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.256 Vali Acc: 0.276 Test Loss: 2.256 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3440506
	speed: 0.4651s/iter; left time: 1314.8080s
Epoch: 12 cost time: 21.477731943130493
Epoch: 12, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.519 Vali Acc: 0.144 Test Loss: 2.519 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4919229
	speed: 0.4533s/iter; left time: 1211.6243s
Epoch: 13 cost time: 20.930641412734985
Epoch: 13, Steps: 154 | Train Loss: 1.309 Vali Loss: 3.458 Vali Acc: 0.125 Test Loss: 3.458 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2978756
	speed: 0.4738s/iter; left time: 1193.5583s
Epoch: 14 cost time: 22.781206130981445
Epoch: 14, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.959 Vali Acc: 0.152 Test Loss: 2.959 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.8688246
	speed: 0.5156s/iter; left time: 1219.3653s
Epoch: 15 cost time: 23.094005823135376
Epoch: 15, Steps: 154 | Train Loss: 1.281 Vali Loss: 2.910 Vali Acc: 0.168 Test Loss: 2.910 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0135026
	speed: 0.5023s/iter; left time: 1110.4779s
Epoch: 16 cost time: 23.018439531326294
Epoch: 16, Steps: 154 | Train Loss: 1.255 Vali Loss: 4.581 Vali Acc: 0.116 Test Loss: 4.581 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5029042
	speed: 0.5071s/iter; left time: 1043.1286s
Epoch: 17 cost time: 23.292341709136963
Epoch: 17, Steps: 154 | Train Loss: 1.214 Vali Loss: 3.981 Vali Acc: 0.105 Test Loss: 3.981 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.0182673
	speed: 0.5044s/iter; left time: 959.7980s
Epoch: 18 cost time: 20.431731700897217
Epoch: 18, Steps: 154 | Train Loss: 1.185 Vali Loss: 3.516 Vali Acc: 0.130 Test Loss: 3.516 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.8536982
	speed: 0.4304s/iter; left time: 752.7276s
Epoch: 19 cost time: 23.19353938102722
Epoch: 19, Steps: 154 | Train Loss: 1.162 Vali Loss: 3.043 Vali Acc: 0.200 Test Loss: 3.043 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.7647649
	speed: 0.5013s/iter; left time: 799.6230s
Epoch: 20 cost time: 22.560473918914795
Epoch: 20, Steps: 154 | Train Loss: 1.145 Vali Loss: 3.502 Vali Acc: 0.125 Test Loss: 3.502 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38605028386050283
model parameter : 594958
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7272339
	speed: 0.1389s/iter; left time: 628.1007s
Epoch: 1 cost time: 20.710062980651855
Epoch: 1, Steps: 154 | Train Loss: 2.187 Vali Loss: 2.116 Vali Acc: 0.319 Test Loss: 2.116 Test Acc: 0.319
Validation loss decreased (inf --> -0.318714).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5383037
	speed: 0.4483s/iter; left time: 1957.6261s
Epoch: 2 cost time: 19.318206548690796
Epoch: 2, Steps: 154 | Train Loss: 1.963 Vali Loss: 2.070 Vali Acc: 0.330 Test Loss: 2.070 Test Acc: 0.330
Validation loss decreased (-0.318714 --> -0.329663).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1186225
	speed: 0.4386s/iter; left time: 1847.9477s
Epoch: 3 cost time: 19.446743726730347
Epoch: 3, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.180 Vali Acc: 0.324 Test Loss: 2.180 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9389294
	speed: 0.4538s/iter; left time: 1841.9677s
Epoch: 4 cost time: 19.82938265800476
Epoch: 4, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.170 Vali Acc: 0.337 Test Loss: 2.170 Test Acc: 0.337
Validation loss decreased (-0.329663 --> -0.336556).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8532217
	speed: 0.4349s/iter; left time: 1698.2249s
Epoch: 5 cost time: 19.217931270599365
Epoch: 5, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.107 Vali Acc: 0.352 Test Loss: 2.107 Test Acc: 0.352
Validation loss decreased (-0.336556 --> -0.351560).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6208625
	speed: 0.4032s/iter; left time: 1512.4895s
Epoch: 6 cost time: 14.48386287689209
Epoch: 6, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.176 Vali Acc: 0.348 Test Loss: 2.176 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7680647
	speed: 0.3417s/iter; left time: 1229.0639s
Epoch: 7 cost time: 17.105632781982422
Epoch: 7, Steps: 154 | Train Loss: 1.610 Vali Loss: 2.402 Vali Acc: 0.349 Test Loss: 2.402 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1264710
	speed: 0.4485s/iter; left time: 1544.1636s
Epoch: 8 cost time: 24.417840719223022
Epoch: 8, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.352 Vali Acc: 0.330 Test Loss: 2.352 Test Acc: 0.330
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3884196
	speed: 0.5709s/iter; left time: 1877.7244s
Epoch: 9 cost time: 24.270533084869385
Epoch: 9, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.358 Vali Acc: 0.102 Test Loss: 2.358 Test Acc: 0.102
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3112388
	speed: 0.5565s/iter; left time: 1744.4953s
Epoch: 10 cost time: 24.424492597579956
Epoch: 10, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.172 Vali Acc: 0.122 Test Loss: 3.172 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4169588
	speed: 0.5679s/iter; left time: 1692.8315s
Epoch: 11 cost time: 24.269946575164795
Epoch: 11, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.997 Vali Acc: 0.079 Test Loss: 2.997 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.1823947
	speed: 0.5668s/iter; left time: 1602.4378s
Epoch: 12 cost time: 24.113722801208496
Epoch: 12, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.428 Vali Acc: 0.208 Test Loss: 2.428 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.2047131
	speed: 0.5692s/iter; left time: 1521.4128s
Epoch: 13 cost time: 24.18185544013977
Epoch: 13, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.999 Vali Acc: 0.110 Test Loss: 2.999 Test Acc: 0.110
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.1904899
	speed: 0.5847s/iter; left time: 1472.7627s
Epoch: 14 cost time: 23.775658130645752
Epoch: 14, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.358 Vali Acc: 0.377 Test Loss: 2.358 Test Acc: 0.377
Validation loss decreased (-0.351560 --> -0.377105).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4686249
	speed: 0.5563s/iter; left time: 1315.5353s
Epoch: 15 cost time: 23.416635751724243
Epoch: 15, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.539 Vali Acc: 0.238 Test Loss: 2.539 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0812432
	speed: 0.5546s/iter; left time: 1226.1595s
Epoch: 16 cost time: 23.35189127922058
Epoch: 16, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.138 Vali Acc: 0.134 Test Loss: 3.138 Test Acc: 0.134
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.2479389
	speed: 0.5672s/iter; left time: 1166.7156s
Epoch: 17 cost time: 24.990949869155884
Epoch: 17, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.627 Vali Acc: 0.127 Test Loss: 3.627 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.9251381
	speed: 0.5969s/iter; left time: 1135.9047s
Epoch: 18 cost time: 25.1481716632843
Epoch: 18, Steps: 154 | Train Loss: 1.205 Vali Loss: 3.626 Vali Acc: 0.133 Test Loss: 3.626 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.3907282
	speed: 0.6125s/iter; left time: 1071.2711s
Epoch: 19 cost time: 26.929562091827393
Epoch: 19, Steps: 154 | Train Loss: 1.182 Vali Loss: 4.611 Vali Acc: 0.112 Test Loss: 4.611 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.2593085
	speed: 0.6155s/iter; left time: 981.7473s
Epoch: 20 cost time: 25.672818660736084
Epoch: 20, Steps: 154 | Train Loss: 1.160 Vali Loss: 3.780 Vali Acc: 0.099 Test Loss: 3.780 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.9341463
	speed: 0.6071s/iter; left time: 874.8423s
Epoch: 21 cost time: 25.71596646308899
Epoch: 21, Steps: 154 | Train Loss: 1.128 Vali Loss: 3.918 Vali Acc: 0.120 Test Loss: 3.918 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.1539797
	speed: 0.5555s/iter; left time: 714.8917s
Epoch: 22 cost time: 25.08757972717285
Epoch: 22, Steps: 154 | Train Loss: 1.109 Vali Loss: 4.169 Vali Acc: 0.114 Test Loss: 4.169 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.6997007
	speed: 0.5887s/iter; left time: 667.0507s
Epoch: 23 cost time: 24.89279079437256
Epoch: 23, Steps: 154 | Train Loss: 1.094 Vali Loss: 4.314 Vali Acc: 0.128 Test Loss: 4.314 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.0848503
	speed: 0.5943s/iter; left time: 581.8331s
Epoch: 24 cost time: 25.566450119018555
Epoch: 24, Steps: 154 | Train Loss: 1.067 Vali Loss: 4.332 Vali Acc: 0.107 Test Loss: 4.332 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 181006
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9320248
	speed: 0.2408s/iter; left time: 1088.4565s
Epoch: 1 cost time: 35.15187382698059
Epoch: 1, Steps: 154 | Train Loss: 2.196 Vali Loss: 2.103 Vali Acc: 0.315 Test Loss: 2.103 Test Acc: 0.315
Validation loss decreased (inf --> -0.315470).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9098135
	speed: 0.6556s/iter; left time: 2862.9640s
Epoch: 2 cost time: 33.48723387718201
Epoch: 2, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.061 Vali Acc: 0.331 Test Loss: 2.061 Test Acc: 0.331
Validation loss decreased (-0.315470 --> -0.330880).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4853668
	speed: 0.6973s/iter; left time: 2937.6151s
Epoch: 3 cost time: 35.39789009094238
Epoch: 3, Steps: 154 | Train Loss: 1.892 Vali Loss: 1.978 Vali Acc: 0.350 Test Loss: 1.978 Test Acc: 0.350
Validation loss decreased (-0.330880 --> -0.349940).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0708220
	speed: 0.6376s/iter; left time: 2588.0259s
Epoch: 4 cost time: 35.829442739486694
Epoch: 4, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.061 Vali Acc: 0.355 Test Loss: 2.061 Test Acc: 0.355
Validation loss decreased (-0.349940 --> -0.355211).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5518062
	speed: 0.7029s/iter; left time: 2744.9208s
Epoch: 5 cost time: 33.047393560409546
Epoch: 5, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.131 Vali Acc: 0.365 Test Loss: 2.131 Test Acc: 0.365
Validation loss decreased (-0.355211 --> -0.364537).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4724865
	speed: 0.6326s/iter; left time: 2372.9243s
Epoch: 6 cost time: 30.72003197669983
Epoch: 6, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.016 Vali Acc: 0.384 Test Loss: 2.016 Test Acc: 0.384
Validation loss decreased (-0.364537 --> -0.384408).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0376809
	speed: 0.6238s/iter; left time: 2243.8037s
Epoch: 7 cost time: 28.306452751159668
Epoch: 7, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.134 Vali Acc: 0.355 Test Loss: 2.134 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5086248
	speed: 0.6021s/iter; left time: 2073.1242s
Epoch: 8 cost time: 27.783449411392212
Epoch: 8, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.056 Vali Acc: 0.380 Test Loss: 2.056 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.0876961
	speed: 0.6010s/iter; left time: 1976.6607s
Epoch: 9 cost time: 28.486640214920044
Epoch: 9, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.273 Vali Acc: 0.360 Test Loss: 2.273 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6264277
	speed: 0.6116s/iter; left time: 1917.4103s
Epoch: 10 cost time: 27.259085655212402
Epoch: 10, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.285 Vali Acc: 0.371 Test Loss: 2.285 Test Acc: 0.371
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5781198
	speed: 0.5848s/iter; left time: 1743.3137s
Epoch: 11 cost time: 26.296114206314087
Epoch: 11, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.468 Vali Acc: 0.378 Test Loss: 2.468 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3414193
	speed: 0.5569s/iter; left time: 1574.3308s
Epoch: 12 cost time: 20.779692888259888
Epoch: 12, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.883 Vali Acc: 0.200 Test Loss: 2.883 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.6420436
	speed: 0.4928s/iter; left time: 1317.1494s
Epoch: 13 cost time: 21.92896580696106
Epoch: 13, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.343 Vali Acc: 0.382 Test Loss: 2.343 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4587672
	speed: 0.5198s/iter; left time: 1309.3301s
Epoch: 14 cost time: 23.371307373046875
Epoch: 14, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.474 Vali Acc: 0.399 Test Loss: 2.474 Test Acc: 0.399
Validation loss decreased (-0.384408 --> -0.399002).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.8272544
	speed: 0.5339s/iter; left time: 1262.7377s
Epoch: 15 cost time: 23.545708894729614
Epoch: 15, Steps: 154 | Train Loss: 1.325 Vali Loss: 3.023 Vali Acc: 0.219 Test Loss: 3.023 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1028814
	speed: 0.5375s/iter; left time: 1188.4748s
Epoch: 16 cost time: 23.925394535064697
Epoch: 16, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.380 Vali Acc: 0.122 Test Loss: 3.380 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.3531868
	speed: 0.5670s/iter; left time: 1166.2313s
Epoch: 17 cost time: 25.289568662643433
Epoch: 17, Steps: 154 | Train Loss: 1.286 Vali Loss: 3.234 Vali Acc: 0.201 Test Loss: 3.234 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.0228387
	speed: 0.5948s/iter; left time: 1131.8700s
Epoch: 18 cost time: 26.499826669692993
Epoch: 18, Steps: 154 | Train Loss: 1.254 Vali Loss: 2.918 Vali Acc: 0.229 Test Loss: 2.918 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.0244861
	speed: 0.5661s/iter; left time: 990.0605s
Epoch: 19 cost time: 27.10201644897461
Epoch: 19, Steps: 154 | Train Loss: 1.232 Vali Loss: 3.188 Vali Acc: 0.193 Test Loss: 3.188 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.1597525
	speed: 0.6364s/iter; left time: 1015.1165s
Epoch: 20 cost time: 26.550379514694214
Epoch: 20, Steps: 154 | Train Loss: 1.197 Vali Loss: 2.871 Vali Acc: 0.342 Test Loss: 2.871 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.1110752
	speed: 0.6115s/iter; left time: 881.2167s
Epoch: 21 cost time: 26.601893663406372
Epoch: 21, Steps: 154 | Train Loss: 1.212 Vali Loss: 3.399 Vali Acc: 0.142 Test Loss: 3.399 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.3114682
	speed: 0.6113s/iter; left time: 786.7150s
Epoch: 22 cost time: 26.030954599380493
Epoch: 22, Steps: 154 | Train Loss: 1.163 Vali Loss: 3.692 Vali Acc: 0.195 Test Loss: 3.692 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.4232928
	speed: 0.6086s/iter; left time: 689.5416s
Epoch: 23 cost time: 25.895105361938477
Epoch: 23, Steps: 154 | Train Loss: 1.135 Vali Loss: 3.431 Vali Acc: 0.210 Test Loss: 3.431 Test Acc: 0.210
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.0528669
	speed: 0.6037s/iter; left time: 591.0153s
Epoch: 24 cost time: 26.30070161819458
Epoch: 24, Steps: 154 | Train Loss: 1.121 Vali Loss: 4.837 Vali Acc: 0.147 Test Loss: 4.837 Test Acc: 0.147
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39902676399026765
model parameter : 594958
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7177951
	speed: 0.1881s/iter; left time: 850.4802s
Epoch: 1 cost time: 28.563493967056274
Epoch: 1, Steps: 154 | Train Loss: 2.193 Vali Loss: 2.108 Vali Acc: 0.318 Test Loss: 2.108 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5367280
	speed: 0.6202s/iter; left time: 2708.2854s
Epoch: 2 cost time: 27.557601928710938
Epoch: 2, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.106 Vali Acc: 0.333 Test Loss: 2.106 Test Acc: 0.333
Validation loss decreased (-0.317903 --> -0.332501).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0501311
	speed: 0.6126s/iter; left time: 2580.7564s
Epoch: 3 cost time: 26.896204233169556
Epoch: 3, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.135 Vali Acc: 0.336 Test Loss: 2.135 Test Acc: 0.336
Validation loss decreased (-0.332501 --> -0.335745).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9736655
	speed: 0.6120s/iter; left time: 2484.3020s
Epoch: 4 cost time: 26.47009038925171
Epoch: 4, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.181 Vali Acc: 0.337 Test Loss: 2.181 Test Acc: 0.337
Validation loss decreased (-0.335745 --> -0.336961).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9010993
	speed: 0.6021s/iter; left time: 2351.0473s
Epoch: 5 cost time: 26.810735940933228
Epoch: 5, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.118 Vali Acc: 0.350 Test Loss: 2.118 Test Acc: 0.350
Validation loss decreased (-0.336961 --> -0.350344).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6893848
	speed: 0.6137s/iter; left time: 2301.9075s
Epoch: 6 cost time: 25.431488752365112
Epoch: 6, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.261 Vali Acc: 0.345 Test Loss: 2.261 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7660799
	speed: 0.5678s/iter; left time: 2042.5415s
Epoch: 7 cost time: 24.248053073883057
Epoch: 7, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.206 Vali Acc: 0.354 Test Loss: 2.206 Test Acc: 0.354
Validation loss decreased (-0.350344 --> -0.353587).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2600992
	speed: 0.5464s/iter; left time: 1881.2137s
Epoch: 8 cost time: 22.751027822494507
Epoch: 8, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.123 Vali Acc: 0.365 Test Loss: 2.123 Test Acc: 0.365
Validation loss decreased (-0.353587 --> -0.364942).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4295661
	speed: 0.5515s/iter; left time: 1813.8891s
Epoch: 9 cost time: 23.7105233669281
Epoch: 9, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.000 Vali Acc: 0.384 Test Loss: 2.000 Test Acc: 0.384
Validation loss decreased (-0.364942 --> -0.384003).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1918845
	speed: 0.5413s/iter; left time: 1696.8660s
Epoch: 10 cost time: 22.958890676498413
Epoch: 10, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.510 Vali Acc: 0.377 Test Loss: 2.510 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5995220
	speed: 0.5430s/iter; left time: 1618.5356s
Epoch: 11 cost time: 23.208772659301758
Epoch: 11, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.340 Vali Acc: 0.380 Test Loss: 2.340 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3381267
	speed: 0.5464s/iter; left time: 1544.6711s
Epoch: 12 cost time: 23.282361268997192
Epoch: 12, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.769 Vali Acc: 0.202 Test Loss: 2.769 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0052745
	speed: 0.5108s/iter; left time: 1365.3777s
Epoch: 13 cost time: 18.102327823638916
Epoch: 13, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.217 Vali Acc: 0.383 Test Loss: 2.217 Test Acc: 0.383
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.1437721
	speed: 0.5201s/iter; left time: 1310.1598s
Epoch: 14 cost time: 21.51106595993042
Epoch: 14, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.959 Vali Acc: 0.203 Test Loss: 2.959 Test Acc: 0.203
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4283301
	speed: 0.5200s/iter; left time: 1229.7699s
Epoch: 15 cost time: 21.22639536857605
Epoch: 15, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.546 Vali Acc: 0.392 Test Loss: 2.546 Test Acc: 0.392
Validation loss decreased (-0.384003 --> -0.392108).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1921414
	speed: 0.5268s/iter; left time: 1164.6478s
Epoch: 16 cost time: 21.816362857818604
Epoch: 16, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.121 Vali Acc: 0.219 Test Loss: 3.121 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2734369
	speed: 0.5208s/iter; left time: 1071.1946s
Epoch: 17 cost time: 21.134717226028442
Epoch: 17, Steps: 154 | Train Loss: 1.290 Vali Loss: 2.983 Vali Acc: 0.369 Test Loss: 2.983 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.8449864
	speed: 0.5454s/iter; left time: 1037.9221s
Epoch: 18 cost time: 23.305809259414673
Epoch: 18, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.009 Vali Acc: 0.358 Test Loss: 3.009 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.4793501
	speed: 0.5145s/iter; left time: 899.8753s
Epoch: 19 cost time: 21.114776849746704
Epoch: 19, Steps: 154 | Train Loss: 1.260 Vali Loss: 3.843 Vali Acc: 0.152 Test Loss: 3.843 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.3480325
	speed: 0.5693s/iter; left time: 907.9665s
Epoch: 20 cost time: 23.01451873779297
Epoch: 20, Steps: 154 | Train Loss: 1.221 Vali Loss: 4.444 Vali Acc: 0.086 Test Loss: 4.444 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.0964510
	speed: 0.5588s/iter; left time: 805.2353s
Epoch: 21 cost time: 21.98017120361328
Epoch: 21, Steps: 154 | Train Loss: 1.207 Vali Loss: 3.768 Vali Acc: 0.273 Test Loss: 3.768 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.1033128
	speed: 0.5611s/iter; left time: 722.1939s
Epoch: 22 cost time: 22.938542366027832
Epoch: 22, Steps: 154 | Train Loss: 1.173 Vali Loss: 3.658 Vali Acc: 0.403 Test Loss: 3.658 Test Acc: 0.403
Validation loss decreased (-0.392108 --> -0.403045).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.9244387
	speed: 0.5642s/iter; left time: 639.2131s
Epoch: 23 cost time: 22.37777304649353
Epoch: 23, Steps: 154 | Train Loss: 1.178 Vali Loss: 3.984 Vali Acc: 0.195 Test Loss: 3.984 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.4774724
	speed: 0.5734s/iter; left time: 561.3584s
Epoch: 24 cost time: 23.06588339805603
Epoch: 24, Steps: 154 | Train Loss: 1.144 Vali Loss: 5.179 Vali Acc: 0.086 Test Loss: 5.179 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.9836251
	speed: 0.5706s/iter; left time: 470.7563s
Epoch: 25 cost time: 22.6902437210083
Epoch: 25, Steps: 154 | Train Loss: 1.141 Vali Loss: 6.328 Vali Acc: 0.086 Test Loss: 6.328 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.9342245
	speed: 0.5713s/iter; left time: 383.3273s
Epoch: 26 cost time: 22.47466492652893
Epoch: 26, Steps: 154 | Train Loss: 1.125 Vali Loss: 3.656 Vali Acc: 0.249 Test Loss: 3.656 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.0149577
	speed: 0.5718s/iter; left time: 295.5955s
Epoch: 27 cost time: 23.14603877067566
Epoch: 27, Steps: 154 | Train Loss: 1.098 Vali Loss: 5.840 Vali Acc: 0.116 Test Loss: 5.840 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.3527535
	speed: 0.5644s/iter; left time: 204.8776s
Epoch: 28 cost time: 22.500831365585327
Epoch: 28, Steps: 154 | Train Loss: 1.063 Vali Loss: 5.372 Vali Acc: 0.105 Test Loss: 5.372 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.7537944
	speed: 0.5718s/iter; left time: 119.5118s
Epoch: 29 cost time: 23.031675815582275
Epoch: 29, Steps: 154 | Train Loss: 1.076 Vali Loss: 5.032 Vali Acc: 0.090 Test Loss: 5.032 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.9668134
	speed: 0.5694s/iter; left time: 31.3178s
Epoch: 30 cost time: 22.386037826538086
Epoch: 30, Steps: 154 | Train Loss: 1.050 Vali Loss: 4.727 Vali Acc: 0.135 Test Loss: 4.727 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40308191403081917
model parameter : 181006
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9356824
	speed: 0.3100s/iter; left time: 1401.7178s
Epoch: 1 cost time: 47.40789532661438
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.121 Vali Acc: 0.316 Test Loss: 2.121 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0258858
	speed: 0.8444s/iter; left time: 3687.4866s
Epoch: 2 cost time: 42.39915585517883
Epoch: 2, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.090 Vali Acc: 0.330 Test Loss: 2.090 Test Acc: 0.330
Validation loss decreased (-0.316280 --> -0.330474).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7707291
	speed: 0.8214s/iter; left time: 3460.7043s
Epoch: 3 cost time: 38.60711932182312
Epoch: 3, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.048 Vali Acc: 0.337 Test Loss: 2.048 Test Acc: 0.337
Validation loss decreased (-0.330474 --> -0.336962).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5891788
	speed: 0.7721s/iter; left time: 3133.7639s
Epoch: 4 cost time: 40.15545177459717
Epoch: 4, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.099 Vali Acc: 0.341 Test Loss: 2.099 Test Acc: 0.341
Validation loss decreased (-0.336962 --> -0.341423).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2106006
	speed: 0.7953s/iter; left time: 3105.8058s
Epoch: 5 cost time: 40.40078043937683
Epoch: 5, Steps: 154 | Train Loss: 1.786 Vali Loss: 2.105 Vali Acc: 0.352 Test Loss: 2.105 Test Acc: 0.352
Validation loss decreased (-0.341423 --> -0.352371).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2318877
	speed: 0.8017s/iter; left time: 3006.9970s
Epoch: 6 cost time: 40.637216329574585
Epoch: 6, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.350 Vali Acc: 0.356 Test Loss: 2.350 Test Acc: 0.356
Validation loss decreased (-0.352371 --> -0.356424).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3899078
	speed: 0.7633s/iter; left time: 2745.6072s
Epoch: 7 cost time: 39.42932868003845
Epoch: 7, Steps: 154 | Train Loss: 1.669 Vali Loss: 2.506 Vali Acc: 0.155 Test Loss: 2.506 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6195501
	speed: 0.8001s/iter; left time: 2754.7085s
Epoch: 8 cost time: 39.96062660217285
Epoch: 8, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.167 Vali Acc: 0.269 Test Loss: 2.167 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6336690
	speed: 0.8063s/iter; left time: 2651.8778s
Epoch: 9 cost time: 39.42167568206787
Epoch: 9, Steps: 154 | Train Loss: 1.609 Vali Loss: 2.779 Vali Acc: 0.101 Test Loss: 2.779 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9416062
	speed: 0.8240s/iter; left time: 2583.3519s
Epoch: 10 cost time: 42.50162172317505
Epoch: 10, Steps: 154 | Train Loss: 1.583 Vali Loss: 3.550 Vali Acc: 0.099 Test Loss: 3.550 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7311652
	speed: 0.8041s/iter; left time: 2397.0563s
Epoch: 11 cost time: 36.418410301208496
Epoch: 11, Steps: 154 | Train Loss: 1.545 Vali Loss: 4.574 Vali Acc: 0.112 Test Loss: 4.574 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4493090
	speed: 0.8168s/iter; left time: 2309.0834s
Epoch: 12 cost time: 40.483590841293335
Epoch: 12, Steps: 154 | Train Loss: 1.537 Vali Loss: 3.991 Vali Acc: 0.067 Test Loss: 3.991 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3162614
	speed: 0.8285s/iter; left time: 2214.4601s
Epoch: 13 cost time: 40.94730353355408
Epoch: 13, Steps: 154 | Train Loss: 1.515 Vali Loss: 4.850 Vali Acc: 0.114 Test Loss: 4.850 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.9441007
	speed: 0.8089s/iter; left time: 2037.5950s
Epoch: 14 cost time: 40.08263945579529
Epoch: 14, Steps: 154 | Train Loss: 1.453 Vali Loss: 4.626 Vali Acc: 0.111 Test Loss: 4.626 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2935472
	speed: 0.8996s/iter; left time: 2127.4975s
Epoch: 15 cost time: 44.53329014778137
Epoch: 15, Steps: 154 | Train Loss: 1.468 Vali Loss: 5.114 Vali Acc: 0.114 Test Loss: 5.114 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.3716053
	speed: 0.8784s/iter; left time: 1942.2397s
Epoch: 16 cost time: 42.861133098602295
Epoch: 16, Steps: 154 | Train Loss: 1.432 Vali Loss: 6.191 Vali Acc: 0.092 Test Loss: 6.191 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3564476885644769
model parameter : 1177422
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5191104
	speed: 0.2543s/iter; left time: 1149.7886s
Epoch: 1 cost time: 38.69731855392456
Epoch: 1, Steps: 154 | Train Loss: 2.258 Vali Loss: 2.142 Vali Acc: 0.316 Test Loss: 2.142 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8098059
	speed: 0.7898s/iter; left time: 3449.0929s
Epoch: 2 cost time: 36.014240980148315
Epoch: 2, Steps: 154 | Train Loss: 2.052 Vali Loss: 2.123 Vali Acc: 0.321 Test Loss: 2.123 Test Acc: 0.321
Validation loss decreased (-0.315875 --> -0.321147).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9140836
	speed: 0.7883s/iter; left time: 3321.3015s
Epoch: 3 cost time: 36.09689545631409
Epoch: 3, Steps: 154 | Train Loss: 1.945 Vali Loss: 2.080 Vali Acc: 0.332 Test Loss: 2.080 Test Acc: 0.332
Validation loss decreased (-0.321147 --> -0.331690).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7584651
	speed: 0.7638s/iter; left time: 3100.1800s
Epoch: 4 cost time: 34.82621741294861
Epoch: 4, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.183 Vali Acc: 0.329 Test Loss: 2.183 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7975112
	speed: 0.7417s/iter; left time: 2896.1627s
Epoch: 5 cost time: 33.42841029167175
Epoch: 5, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.186 Vali Acc: 0.332 Test Loss: 2.186 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8732370
	speed: 0.7386s/iter; left time: 2770.5607s
Epoch: 6 cost time: 33.1606011390686
Epoch: 6, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.076 Vali Acc: 0.346 Test Loss: 2.076 Test Acc: 0.346
Validation loss decreased (-0.331690 --> -0.346289).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3919444
	speed: 0.7258s/iter; left time: 2610.5740s
Epoch: 7 cost time: 33.145368814468384
Epoch: 7, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.215 Vali Acc: 0.275 Test Loss: 2.215 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7526808
	speed: 0.7162s/iter; left time: 2465.8290s
Epoch: 8 cost time: 31.393186569213867
Epoch: 8, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.349 Vali Acc: 0.160 Test Loss: 2.349 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9048476
	speed: 0.6875s/iter; left time: 2261.3384s
Epoch: 9 cost time: 32.000009536743164
Epoch: 9, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.668 Vali Acc: 0.095 Test Loss: 2.668 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4817375
	speed: 0.6741s/iter; left time: 2113.3585s
Epoch: 10 cost time: 31.476310968399048
Epoch: 10, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.128 Vali Acc: 0.206 Test Loss: 2.128 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4614323
	speed: 0.6547s/iter; left time: 1951.7635s
Epoch: 11 cost time: 27.495414972305298
Epoch: 11, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.316 Vali Acc: 0.155 Test Loss: 2.316 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0731686
	speed: 0.6546s/iter; left time: 1850.6085s
Epoch: 12 cost time: 30.22782564163208
Epoch: 12, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.114 Vali Acc: 0.362 Test Loss: 2.114 Test Acc: 0.362
Validation loss decreased (-0.346289 --> -0.362104).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6564376
	speed: 0.7120s/iter; left time: 1903.1089s
Epoch: 13 cost time: 32.079041719436646
Epoch: 13, Steps: 154 | Train Loss: 1.452 Vali Loss: 3.091 Vali Acc: 0.106 Test Loss: 3.091 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4260838
	speed: 0.7313s/iter; left time: 1842.1900s
Epoch: 14 cost time: 32.58973813056946
Epoch: 14, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.903 Vali Acc: 0.152 Test Loss: 2.903 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1521642
	speed: 0.7406s/iter; left time: 1751.5490s
Epoch: 15 cost time: 32.33252763748169
Epoch: 15, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.197 Vali Acc: 0.092 Test Loss: 3.197 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1434891
	speed: 0.7109s/iter; left time: 1571.8685s
Epoch: 16 cost time: 32.08663845062256
Epoch: 16, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.774 Vali Acc: 0.095 Test Loss: 2.774 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.1142224
	speed: 0.7280s/iter; left time: 1497.5145s
Epoch: 17 cost time: 31.88243532180786
Epoch: 17, Steps: 154 | Train Loss: 1.344 Vali Loss: 6.352 Vali Acc: 0.080 Test Loss: 6.352 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.9638196
	speed: 0.7220s/iter; left time: 1373.9948s
Epoch: 18 cost time: 31.53855013847351
Epoch: 18, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.285 Vali Acc: 0.128 Test Loss: 3.285 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.2576400
	speed: 0.7076s/iter; left time: 1237.6446s
Epoch: 19 cost time: 31.709233045578003
Epoch: 19, Steps: 154 | Train Loss: 1.286 Vali Loss: 4.663 Vali Acc: 0.124 Test Loss: 4.663 Test Acc: 0.124
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6140769
	speed: 0.6984s/iter; left time: 1113.9680s
Epoch: 20 cost time: 31.715296506881714
Epoch: 20, Steps: 154 | Train Loss: 1.271 Vali Loss: 3.093 Vali Acc: 0.111 Test Loss: 3.093 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.4341371
	speed: 0.6801s/iter; left time: 980.0395s
Epoch: 21 cost time: 28.091593027114868
Epoch: 21, Steps: 154 | Train Loss: 1.257 Vali Loss: 3.778 Vali Acc: 0.120 Test Loss: 3.778 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.9662187
	speed: 0.7183s/iter; left time: 924.4633s
Epoch: 22 cost time: 32.611032247543335
Epoch: 22, Steps: 154 | Train Loss: 1.231 Vali Loss: 6.901 Vali Acc: 0.120 Test Loss: 6.901 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36212489862124897
model parameter : 349454
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9318810
	speed: 0.2640s/iter; left time: 1193.7361s
Epoch: 1 cost time: 39.39443588256836
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.124 Vali Acc: 0.316 Test Loss: 2.124 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0203502
	speed: 0.7005s/iter; left time: 3059.2637s
Epoch: 2 cost time: 35.27500677108765
Epoch: 2, Steps: 154 | Train Loss: 2.044 Vali Loss: 2.085 Vali Acc: 0.326 Test Loss: 2.085 Test Acc: 0.326
Validation loss decreased (-0.316280 --> -0.325608).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9817154
	speed: 0.6929s/iter; left time: 2919.0222s
Epoch: 3 cost time: 34.18301510810852
Epoch: 3, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.029 Vali Acc: 0.341 Test Loss: 2.029 Test Acc: 0.341
Validation loss decreased (-0.325608 --> -0.341018).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6606309
	speed: 0.7099s/iter; left time: 2881.2985s
Epoch: 4 cost time: 34.504363775253296
Epoch: 4, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.083 Vali Acc: 0.345 Test Loss: 2.083 Test Acc: 0.345
Validation loss decreased (-0.341018 --> -0.345478).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1745389
	speed: 0.6649s/iter; left time: 2596.5650s
Epoch: 5 cost time: 33.447532415390015
Epoch: 5, Steps: 154 | Train Loss: 1.777 Vali Loss: 2.390 Vali Acc: 0.059 Test Loss: 2.390 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2324922
	speed: 0.6871s/iter; left time: 2577.4156s
Epoch: 6 cost time: 32.63792538642883
Epoch: 6, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.310 Vali Acc: 0.302 Test Loss: 2.310 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.2774444
	speed: 0.6794s/iter; left time: 2443.7856s
Epoch: 7 cost time: 33.12131333351135
Epoch: 7, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.193 Vali Acc: 0.323 Test Loss: 2.193 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5978167
	speed: 0.6555s/iter; left time: 2256.7465s
Epoch: 8 cost time: 33.03780150413513
Epoch: 8, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.318 Vali Acc: 0.091 Test Loss: 2.318 Test Acc: 0.091
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.5972943
	speed: 0.6889s/iter; left time: 2265.8334s
Epoch: 9 cost time: 33.59466099739075
Epoch: 9, Steps: 154 | Train Loss: 1.599 Vali Loss: 3.723 Vali Acc: 0.109 Test Loss: 3.723 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 2.0590260
	speed: 0.6972s/iter; left time: 2185.5791s
Epoch: 10 cost time: 32.24491262435913
Epoch: 10, Steps: 154 | Train Loss: 1.582 Vali Loss: 3.950 Vali Acc: 0.097 Test Loss: 3.950 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.7396396
	speed: 0.6039s/iter; left time: 1800.1773s
Epoch: 11 cost time: 31.71684741973877
Epoch: 11, Steps: 154 | Train Loss: 1.560 Vali Loss: 4.472 Vali Acc: 0.117 Test Loss: 4.472 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.3481193
	speed: 0.6931s/iter; left time: 1959.3497s
Epoch: 12 cost time: 33.27463722229004
Epoch: 12, Steps: 154 | Train Loss: 1.529 Vali Loss: 5.511 Vali Acc: 0.111 Test Loss: 5.511 Test Acc: 0.111
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.2955694
	speed: 0.7205s/iter; left time: 1925.8067s
Epoch: 13 cost time: 34.18752980232239
Epoch: 13, Steps: 154 | Train Loss: 1.529 Vali Loss: 3.773 Vali Acc: 0.107 Test Loss: 3.773 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0164541
	speed: 0.6979s/iter; left time: 1758.0622s
Epoch: 14 cost time: 32.76739168167114
Epoch: 14, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.544 Vali Acc: 0.144 Test Loss: 2.544 Test Acc: 0.144
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34549878345498786
model parameter : 1177422
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5184784
	speed: 0.2016s/iter; left time: 911.2970s
Epoch: 1 cost time: 30.26550006866455
Epoch: 1, Steps: 154 | Train Loss: 2.258 Vali Loss: 2.141 Vali Acc: 0.316 Test Loss: 2.141 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8152407
	speed: 0.6287s/iter; left time: 2745.7455s
Epoch: 2 cost time: 29.428569793701172
Epoch: 2, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.157 Vali Acc: 0.318 Test Loss: 2.157 Test Acc: 0.318
Validation loss decreased (-0.315875 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8645597
	speed: 0.5864s/iter; left time: 2470.3659s
Epoch: 3 cost time: 27.753824472427368
Epoch: 3, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.073 Vali Acc: 0.329 Test Loss: 2.073 Test Acc: 0.329
Validation loss decreased (-0.318308 --> -0.328852).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7968266
	speed: 0.6527s/iter; left time: 2649.3368s
Epoch: 4 cost time: 30.032517194747925
Epoch: 4, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.183 Vali Acc: 0.328 Test Loss: 2.183 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8147995
	speed: 0.6525s/iter; left time: 2548.1765s
Epoch: 5 cost time: 29.92234492301941
Epoch: 5, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.175 Vali Acc: 0.328 Test Loss: 2.175 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8361681
	speed: 0.6561s/iter; left time: 2461.1801s
Epoch: 6 cost time: 29.414109468460083
Epoch: 6, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.122 Vali Acc: 0.337 Test Loss: 2.122 Test Acc: 0.337
Validation loss decreased (-0.328852 --> -0.337367).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4359224
	speed: 0.6397s/iter; left time: 2301.0732s
Epoch: 7 cost time: 29.49634027481079
Epoch: 7, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.758 Vali Acc: 0.077 Test Loss: 2.758 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8088961
	speed: 0.6296s/iter; left time: 2167.5707s
Epoch: 8 cost time: 28.630773305892944
Epoch: 8, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.387 Vali Acc: 0.073 Test Loss: 2.387 Test Acc: 0.073
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.8463317
	speed: 0.6399s/iter; left time: 2104.7170s
Epoch: 9 cost time: 29.623963117599487
Epoch: 9, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.560 Vali Acc: 0.107 Test Loss: 2.560 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4837109
	speed: 0.6002s/iter; left time: 1881.6516s
Epoch: 10 cost time: 26.415318965911865
Epoch: 10, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.633 Vali Acc: 0.120 Test Loss: 2.633 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.5752599
	speed: 0.5170s/iter; left time: 1541.3137s
Epoch: 11 cost time: 24.239420652389526
Epoch: 11, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.237 Vali Acc: 0.233 Test Loss: 2.237 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1351432
	speed: 0.5330s/iter; left time: 1506.7340s
Epoch: 12 cost time: 24.535540342330933
Epoch: 12, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.151 Vali Acc: 0.355 Test Loss: 2.151 Test Acc: 0.355
Validation loss decreased (-0.337367 --> -0.354804).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7503775
	speed: 0.5423s/iter; left time: 1449.6288s
Epoch: 13 cost time: 24.051816940307617
Epoch: 13, Steps: 154 | Train Loss: 1.466 Vali Loss: 4.481 Vali Acc: 0.108 Test Loss: 4.481 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4862326
	speed: 0.5342s/iter; left time: 1345.7707s
Epoch: 14 cost time: 24.43591022491455
Epoch: 14, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.412 Vali Acc: 0.172 Test Loss: 2.412 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1281265
	speed: 0.5176s/iter; left time: 1224.0726s
Epoch: 15 cost time: 25.658079385757446
Epoch: 15, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.736 Vali Acc: 0.110 Test Loss: 2.736 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.2266678
	speed: 0.5783s/iter; left time: 1278.6210s
Epoch: 16 cost time: 26.259900331497192
Epoch: 16, Steps: 154 | Train Loss: 1.388 Vali Loss: 3.395 Vali Acc: 0.083 Test Loss: 3.395 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0650903
	speed: 0.5836s/iter; left time: 1200.4087s
Epoch: 17 cost time: 26.092756986618042
Epoch: 17, Steps: 154 | Train Loss: 1.353 Vali Loss: 5.282 Vali Acc: 0.082 Test Loss: 5.282 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.0203940
	speed: 0.5802s/iter; left time: 1104.2023s
Epoch: 18 cost time: 25.805074214935303
Epoch: 18, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.961 Vali Acc: 0.146 Test Loss: 2.961 Test Acc: 0.146
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.3777194
	speed: 0.5769s/iter; left time: 1009.0357s
Epoch: 19 cost time: 25.393924474716187
Epoch: 19, Steps: 154 | Train Loss: 1.303 Vali Loss: 5.520 Vali Acc: 0.135 Test Loss: 5.520 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6142263
	speed: 0.5872s/iter; left time: 936.5790s
Epoch: 20 cost time: 25.522809982299805
Epoch: 20, Steps: 154 | Train Loss: 1.281 Vali Loss: 8.190 Vali Acc: 0.078 Test Loss: 8.190 Test Acc: 0.078
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.4469340
	speed: 0.5665s/iter; left time: 816.2788s
Epoch: 21 cost time: 25.69870662689209
Epoch: 21, Steps: 154 | Train Loss: 1.268 Vali Loss: 4.339 Vali Acc: 0.124 Test Loss: 4.339 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.9424779
	speed: 0.5733s/iter; left time: 737.8406s
Epoch: 22 cost time: 25.37863254547119
Epoch: 22, Steps: 154 | Train Loss: 1.230 Vali Loss: 5.057 Vali Acc: 0.126 Test Loss: 5.057 Test Acc: 0.126
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3548256285482563
model parameter : 349454
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0000224
	speed: 0.2822s/iter; left time: 1275.6941s
Epoch: 1 cost time: 42.0537748336792
Epoch: 1, Steps: 154 | Train Loss: 2.225 Vali Loss: 2.128 Vali Acc: 0.315 Test Loss: 2.128 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1272073
	speed: 0.6832s/iter; left time: 2983.6970s
Epoch: 2 cost time: 40.541173696517944
Epoch: 2, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.089 Vali Acc: 0.322 Test Loss: 2.089 Test Acc: 0.322
Validation loss decreased (-0.315469 --> -0.322364).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9469519
	speed: 0.6018s/iter; left time: 2535.5297s
Epoch: 3 cost time: 30.526671171188354
Epoch: 3, Steps: 154 | Train Loss: 1.994 Vali Loss: 2.022 Vali Acc: 0.337 Test Loss: 2.022 Test Acc: 0.337
Validation loss decreased (-0.322364 --> -0.336963).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6654928
	speed: 0.6471s/iter; left time: 2626.5123s
Epoch: 4 cost time: 30.420613288879395
Epoch: 4, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.083 Vali Acc: 0.339 Test Loss: 2.083 Test Acc: 0.339
Validation loss decreased (-0.336963 --> -0.338990).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0327475
	speed: 0.6150s/iter; left time: 2401.4841s
Epoch: 5 cost time: 32.649502754211426
Epoch: 5, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.031 Vali Acc: 0.345 Test Loss: 2.031 Test Acc: 0.345
Validation loss decreased (-0.338990 --> -0.344667).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1981226
	speed: 0.6072s/iter; left time: 2277.5359s
Epoch: 6 cost time: 28.841458797454834
Epoch: 6, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.198 Vali Acc: 0.174 Test Loss: 2.198 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.4070911
	speed: 0.6107s/iter; left time: 2196.7055s
Epoch: 7 cost time: 30.07611656188965
Epoch: 7, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.002 Vali Acc: 0.360 Test Loss: 2.002 Test Acc: 0.360
Validation loss decreased (-0.344667 --> -0.359672).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7539160
	speed: 0.6338s/iter; left time: 2182.3153s
Epoch: 8 cost time: 31.877421379089355
Epoch: 8, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.472 Vali Acc: 0.189 Test Loss: 2.472 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6502570
	speed: 0.5598s/iter; left time: 1841.1390s
Epoch: 9 cost time: 28.58324432373047
Epoch: 9, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.446 Vali Acc: 0.215 Test Loss: 2.446 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0579178
	speed: 0.5568s/iter; left time: 1745.6341s
Epoch: 10 cost time: 29.709258794784546
Epoch: 10, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.805 Vali Acc: 0.178 Test Loss: 2.805 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7026366
	speed: 0.4861s/iter; left time: 1449.1788s
Epoch: 11 cost time: 23.251447200775146
Epoch: 11, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.741 Vali Acc: 0.096 Test Loss: 2.741 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6171362
	speed: 0.4971s/iter; left time: 1405.2547s
Epoch: 12 cost time: 23.95643138885498
Epoch: 12, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.383 Vali Acc: 0.326 Test Loss: 2.383 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2607797
	speed: 0.5086s/iter; left time: 1359.6030s
Epoch: 13 cost time: 24.541141510009766
Epoch: 13, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.220 Vali Acc: 0.357 Test Loss: 2.220 Test Acc: 0.357
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.1899379
	speed: 0.5111s/iter; left time: 1287.5040s
Epoch: 14 cost time: 25.356329202651978
Epoch: 14, Steps: 154 | Train Loss: 1.591 Vali Loss: 3.644 Vali Acc: 0.089 Test Loss: 3.644 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6197441
	speed: 0.5273s/iter; left time: 1247.1534s
Epoch: 15 cost time: 26.272226572036743
Epoch: 15, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.760 Vali Acc: 0.180 Test Loss: 2.760 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3490309
	speed: 0.5678s/iter; left time: 1255.4536s
Epoch: 16 cost time: 26.23541522026062
Epoch: 16, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.849 Vali Acc: 0.186 Test Loss: 2.849 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.6114303
	speed: 0.5922s/iter; left time: 1218.2145s
Epoch: 17 cost time: 28.68705916404724
Epoch: 17, Steps: 154 | Train Loss: 1.547 Vali Loss: 3.555 Vali Acc: 0.075 Test Loss: 3.555 Test Acc: 0.075
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3596918085969181
model parameter : 1177422
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4387300
	speed: 0.1862s/iter; left time: 841.9826s
Epoch: 1 cost time: 28.498960256576538
Epoch: 1, Steps: 154 | Train Loss: 2.304 Vali Loss: 2.134 Vali Acc: 0.315 Test Loss: 2.134 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7867651
	speed: 0.5584s/iter; left time: 2438.6754s
Epoch: 2 cost time: 23.15281867980957
Epoch: 2, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.113 Vali Acc: 0.320 Test Loss: 2.113 Test Acc: 0.320
Validation loss decreased (-0.314658 --> -0.319525).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0029678
	speed: 0.4472s/iter; left time: 1883.8481s
Epoch: 3 cost time: 24.06147813796997
Epoch: 3, Steps: 154 | Train Loss: 2.005 Vali Loss: 2.172 Vali Acc: 0.328 Test Loss: 2.172 Test Acc: 0.328
Validation loss decreased (-0.319525 --> -0.327634).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8117743
	speed: 0.4667s/iter; left time: 1894.4326s
Epoch: 4 cost time: 23.186187267303467
Epoch: 4, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.166 Vali Acc: 0.326 Test Loss: 2.166 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9122251
	speed: 0.4461s/iter; left time: 1742.1669s
Epoch: 5 cost time: 19.59601402282715
Epoch: 5, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.089 Vali Acc: 0.333 Test Loss: 2.089 Test Acc: 0.333
Validation loss decreased (-0.327634 --> -0.333312).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9335208
	speed: 0.5074s/iter; left time: 1903.3829s
Epoch: 6 cost time: 25.354289770126343
Epoch: 6, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.024 Vali Acc: 0.345 Test Loss: 2.024 Test Acc: 0.345
Validation loss decreased (-0.333312 --> -0.344668).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2886137
	speed: 0.5089s/iter; left time: 1830.6915s
Epoch: 7 cost time: 24.174936056137085
Epoch: 7, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.068 Vali Acc: 0.352 Test Loss: 2.068 Test Acc: 0.352
Validation loss decreased (-0.344668 --> -0.351561).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9293023
	speed: 0.5120s/iter; left time: 1762.7922s
Epoch: 8 cost time: 25.759999752044678
Epoch: 8, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.312 Vali Acc: 0.186 Test Loss: 2.312 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5956730
	speed: 0.5936s/iter; left time: 1952.3468s
Epoch: 9 cost time: 28.47893500328064
Epoch: 9, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.315 Vali Acc: 0.192 Test Loss: 2.315 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5640963
	speed: 0.5782s/iter; left time: 1812.6391s
Epoch: 10 cost time: 26.71614670753479
Epoch: 10, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.135 Vali Acc: 0.371 Test Loss: 2.135 Test Acc: 0.371
Validation loss decreased (-0.351561 --> -0.370619).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5433066
	speed: 0.5661s/iter; left time: 1687.4850s
Epoch: 11 cost time: 25.896423816680908
Epoch: 11, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.177 Vali Acc: 0.273 Test Loss: 2.177 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3658705
	speed: 0.4948s/iter; left time: 1398.8381s
Epoch: 12 cost time: 22.85799551010132
Epoch: 12, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.260 Vali Acc: 0.373 Test Loss: 2.260 Test Acc: 0.373
Validation loss decreased (-0.370619 --> -0.373457).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.7581644
	speed: 0.5125s/iter; left time: 1370.0225s
Epoch: 13 cost time: 23.382030248641968
Epoch: 13, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.037 Vali Acc: 0.367 Test Loss: 2.037 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.6003984
	speed: 0.4499s/iter; left time: 1133.3283s
Epoch: 14 cost time: 20.150588274002075
Epoch: 14, Steps: 154 | Train Loss: 1.516 Vali Loss: 1.999 Vali Acc: 0.383 Test Loss: 1.999 Test Acc: 0.383
Validation loss decreased (-0.373457 --> -0.383192).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2791692
	speed: 0.4411s/iter; left time: 1043.3181s
Epoch: 15 cost time: 19.49861216545105
Epoch: 15, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.584 Vali Acc: 0.086 Test Loss: 2.584 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2035854
	speed: 0.3817s/iter; left time: 843.9730s
Epoch: 16 cost time: 9.518484354019165
Epoch: 16, Steps: 154 | Train Loss: 1.452 Vali Loss: 3.819 Vali Acc: 0.102 Test Loss: 3.819 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.4415047
	speed: 0.3193s/iter; left time: 656.7484s
Epoch: 17 cost time: 20.78246831893921
Epoch: 17, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.668 Vali Acc: 0.127 Test Loss: 2.668 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.0062863
	speed: 0.4518s/iter; left time: 859.7975s
Epoch: 18 cost time: 19.15064287185669
Epoch: 18, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.193 Vali Acc: 0.379 Test Loss: 2.193 Test Acc: 0.379
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.5366039
	speed: 0.4392s/iter; left time: 768.2158s
Epoch: 19 cost time: 18.055198669433594
Epoch: 19, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.453 Vali Acc: 0.197 Test Loss: 2.453 Test Acc: 0.197
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.0297244
	speed: 0.4427s/iter; left time: 706.1391s
Epoch: 20 cost time: 21.425309419631958
Epoch: 20, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.475 Vali Acc: 0.107 Test Loss: 2.475 Test Acc: 0.107
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.5224564
	speed: 0.4906s/iter; left time: 707.0176s
Epoch: 21 cost time: 21.178121089935303
Epoch: 21, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.203 Vali Acc: 0.373 Test Loss: 2.203 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.1406001
	speed: 0.4586s/iter; left time: 590.2469s
Epoch: 22 cost time: 18.10678219795227
Epoch: 22, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.463 Vali Acc: 0.370 Test Loss: 2.463 Test Acc: 0.370
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.4322852
	speed: 0.4694s/iter; left time: 531.8298s
Epoch: 23 cost time: 20.325612545013428
Epoch: 23, Steps: 154 | Train Loss: 1.341 Vali Loss: 2.602 Vali Acc: 0.234 Test Loss: 2.602 Test Acc: 0.234
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.1807628
	speed: 0.4568s/iter; left time: 447.1695s
Epoch: 24 cost time: 19.887181997299194
Epoch: 24, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.769 Vali Acc: 0.375 Test Loss: 2.769 Test Acc: 0.375
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 349454
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3718081
	speed: 0.1999s/iter; left time: 903.9417s
Epoch: 1 cost time: 29.628396034240723
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.129 Vali Acc: 0.316 Test Loss: 2.129 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5655582
	speed: 0.6257s/iter; left time: 2732.4566s
Epoch: 2 cost time: 31.88883352279663
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.116 Vali Acc: 0.326 Test Loss: 2.116 Test Acc: 0.326
Validation loss decreased (-0.316280 --> -0.326418).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7425156
	speed: 0.6165s/iter; left time: 2597.3814s
Epoch: 3 cost time: 28.816248416900635
Epoch: 3, Steps: 154 | Train Loss: 1.989 Vali Loss: 2.085 Vali Acc: 0.329 Test Loss: 2.085 Test Acc: 0.329
Validation loss decreased (-0.326418 --> -0.328852).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6941807
	speed: 0.5611s/iter; left time: 2277.6704s
Epoch: 4 cost time: 25.200392484664917
Epoch: 4, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.076 Vali Acc: 0.334 Test Loss: 2.076 Test Acc: 0.334
Validation loss decreased (-0.328852 --> -0.334124).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8888682
	speed: 0.5689s/iter; left time: 2221.5402s
Epoch: 5 cost time: 28.246606588363647
Epoch: 5, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.142 Vali Acc: 0.350 Test Loss: 2.142 Test Acc: 0.350
Validation loss decreased (-0.334124 --> -0.349533).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6268518
	speed: 0.5767s/iter; left time: 2163.3697s
Epoch: 6 cost time: 27.86501407623291
Epoch: 6, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.078 Vali Acc: 0.350 Test Loss: 2.078 Test Acc: 0.350
Validation loss decreased (-0.349533 --> -0.349533).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8729173
	speed: 0.6896s/iter; left time: 2480.4020s
Epoch: 7 cost time: 33.84671592712402
Epoch: 7, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.264 Vali Acc: 0.333 Test Loss: 2.264 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2721310
	speed: 0.7497s/iter; left time: 2581.3746s
Epoch: 8 cost time: 35.593955278396606
Epoch: 8, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.072 Vali Acc: 0.369 Test Loss: 2.072 Test Acc: 0.369
Validation loss decreased (-0.349533 --> -0.368998).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4617041
	speed: 0.7261s/iter; left time: 2388.1883s
Epoch: 9 cost time: 33.24591660499573
Epoch: 9, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.175 Vali Acc: 0.204 Test Loss: 2.175 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7065589
	speed: 0.7007s/iter; left time: 2196.5493s
Epoch: 10 cost time: 31.6926908493042
Epoch: 10, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.090 Vali Acc: 0.359 Test Loss: 2.090 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6030949
	speed: 0.6608s/iter; left time: 1969.7710s
Epoch: 11 cost time: 31.155879974365234
Epoch: 11, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.096 Vali Acc: 0.204 Test Loss: 2.096 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3656049
	speed: 0.6693s/iter; left time: 1891.9950s
Epoch: 12 cost time: 30.881630182266235
Epoch: 12, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.222 Vali Acc: 0.327 Test Loss: 2.222 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.7361308
	speed: 0.6038s/iter; left time: 1613.9391s
Epoch: 13 cost time: 23.969876050949097
Epoch: 13, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.668 Vali Acc: 0.101 Test Loss: 2.668 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3141402
	speed: 0.5471s/iter; left time: 1378.2415s
Epoch: 14 cost time: 29.14978814125061
Epoch: 14, Steps: 154 | Train Loss: 1.466 Vali Loss: 1.972 Vali Acc: 0.378 Test Loss: 1.972 Test Acc: 0.378
Validation loss decreased (-0.368998 --> -0.377920).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7554885
	speed: 0.6135s/iter; left time: 1450.9051s
Epoch: 15 cost time: 29.879576444625854
Epoch: 15, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.102 Vali Acc: 0.361 Test Loss: 2.102 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.4269105
	speed: 0.6724s/iter; left time: 1486.7459s
Epoch: 16 cost time: 30.854432821273804
Epoch: 16, Steps: 154 | Train Loss: 1.401 Vali Loss: 3.447 Vali Acc: 0.116 Test Loss: 3.447 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.3731512
	speed: 0.6596s/iter; left time: 1356.7154s
Epoch: 17 cost time: 31.176249504089355
Epoch: 17, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.045 Vali Acc: 0.355 Test Loss: 2.045 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.0657910
	speed: 0.6922s/iter; left time: 1317.2549s
Epoch: 18 cost time: 32.37389326095581
Epoch: 18, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.311 Vali Acc: 0.105 Test Loss: 2.311 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.1835860
	speed: 0.6490s/iter; left time: 1135.0419s
Epoch: 19 cost time: 29.370937824249268
Epoch: 19, Steps: 154 | Train Loss: 1.309 Vali Loss: 2.589 Vali Acc: 0.106 Test Loss: 2.589 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.1080453
	speed: 0.6403s/iter; left time: 1021.2100s
Epoch: 20 cost time: 28.371044397354126
Epoch: 20, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.440 Vali Acc: 0.124 Test Loss: 2.440 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.1322962
	speed: 0.6253s/iter; left time: 901.1068s
Epoch: 21 cost time: 29.94446563720703
Epoch: 21, Steps: 154 | Train Loss: 1.268 Vali Loss: 2.449 Vali Acc: 0.118 Test Loss: 2.449 Test Acc: 0.118
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.1138163
	speed: 0.6446s/iter; left time: 829.5691s
Epoch: 22 cost time: 30.148434162139893
Epoch: 22, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.004 Vali Acc: 0.122 Test Loss: 3.004 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.8981500
	speed: 0.6137s/iter; left time: 695.3404s
Epoch: 23 cost time: 28.75118064880371
Epoch: 23, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.273 Vali Acc: 0.270 Test Loss: 2.273 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 1.2824111
	speed: 0.6171s/iter; left time: 604.1280s
Epoch: 24 cost time: 26.643242120742798
Epoch: 24, Steps: 154 | Train Loss: 1.185 Vali Loss: 3.547 Vali Acc: 0.118 Test Loss: 3.547 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37793998377939986
model parameter : 590926
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3224001
	speed: 0.2087s/iter; left time: 943.5197s
Epoch: 1 cost time: 31.04160761833191
Epoch: 1, Steps: 154 | Train Loss: 2.228 Vali Loss: 2.126 Vali Acc: 0.315 Test Loss: 2.126 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1372378
	speed: 0.6268s/iter; left time: 2737.0331s
Epoch: 2 cost time: 27.72002863883972
Epoch: 2, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.101 Vali Acc: 0.326 Test Loss: 2.101 Test Acc: 0.326
Validation loss decreased (-0.315064 --> -0.325608).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8519291
	speed: 0.6149s/iter; left time: 2590.3673s
Epoch: 3 cost time: 28.349077939987183
Epoch: 3, Steps: 154 | Train Loss: 1.937 Vali Loss: 2.058 Vali Acc: 0.331 Test Loss: 2.058 Test Acc: 0.331
Validation loss decreased (-0.325608 --> -0.331285).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1719875
	speed: 0.6518s/iter; left time: 2645.7943s
Epoch: 4 cost time: 28.864434003829956
Epoch: 4, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.119 Vali Acc: 0.332 Test Loss: 2.119 Test Acc: 0.332
Validation loss decreased (-0.331285 --> -0.331690).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6237650
	speed: 0.5704s/iter; left time: 2227.3995s
Epoch: 5 cost time: 21.851705074310303
Epoch: 5, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.303 Vali Acc: 0.299 Test Loss: 2.303 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0429688
	speed: 0.5175s/iter; left time: 1941.1729s
Epoch: 6 cost time: 23.045586824417114
Epoch: 6, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.141 Vali Acc: 0.342 Test Loss: 2.141 Test Acc: 0.342
Validation loss decreased (-0.331690 --> -0.342233).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8229761
	speed: 0.5378s/iter; left time: 1934.3990s
Epoch: 7 cost time: 24.49921202659607
Epoch: 7, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.037 Vali Acc: 0.343 Test Loss: 2.037 Test Acc: 0.343
Validation loss decreased (-0.342233 --> -0.343451).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7525735
	speed: 0.5504s/iter; left time: 1894.9223s
Epoch: 8 cost time: 24.66776156425476
Epoch: 8, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.161 Vali Acc: 0.343 Test Loss: 2.161 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5403897
	speed: 0.4805s/iter; left time: 1580.4564s
Epoch: 9 cost time: 19.564175605773926
Epoch: 9, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.645 Vali Acc: 0.155 Test Loss: 2.645 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9819145
	speed: 0.4783s/iter; left time: 1499.4492s
Epoch: 10 cost time: 22.268900156021118
Epoch: 10, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.385 Vali Acc: 0.095 Test Loss: 2.385 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.9523025
	speed: 0.5653s/iter; left time: 1685.2440s
Epoch: 11 cost time: 25.242505311965942
Epoch: 11, Steps: 154 | Train Loss: 1.574 Vali Loss: 4.075 Vali Acc: 0.109 Test Loss: 4.075 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4320242
	speed: 0.5625s/iter; left time: 1590.0875s
Epoch: 12 cost time: 23.37277865409851
Epoch: 12, Steps: 154 | Train Loss: 1.531 Vali Loss: 3.962 Vali Acc: 0.103 Test Loss: 3.962 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2032677
	speed: 0.5619s/iter; left time: 1501.9248s
Epoch: 13 cost time: 26.108136892318726
Epoch: 13, Steps: 154 | Train Loss: 1.506 Vali Loss: 5.271 Vali Acc: 0.119 Test Loss: 5.271 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.0273857
	speed: 0.6251s/iter; left time: 1574.7254s
Epoch: 14 cost time: 27.630778551101685
Epoch: 14, Steps: 154 | Train Loss: 1.475 Vali Loss: 4.455 Vali Acc: 0.112 Test Loss: 4.455 Test Acc: 0.112
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.9937146
	speed: 0.6223s/iter; left time: 1471.6421s
Epoch: 15 cost time: 24.776427745819092
Epoch: 15, Steps: 154 | Train Loss: 1.447 Vali Loss: 4.636 Vali Acc: 0.123 Test Loss: 4.636 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.9608114
	speed: 0.5334s/iter; left time: 1179.4408s
Epoch: 16 cost time: 23.468583345413208
Epoch: 16, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.602 Vali Acc: 0.083 Test Loss: 3.602 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.5304722
	speed: 0.5352s/iter; left time: 1100.8356s
Epoch: 17 cost time: 23.962848901748657
Epoch: 17, Steps: 154 | Train Loss: 1.414 Vali Loss: 5.595 Vali Acc: 0.127 Test Loss: 5.595 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34347120843471207
model parameter : 176910
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3781290
	speed: 0.1887s/iter; left time: 852.9482s
Epoch: 1 cost time: 28.31961464881897
Epoch: 1, Steps: 154 | Train Loss: 2.220 Vali Loss: 2.127 Vali Acc: 0.315 Test Loss: 2.127 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5377417
	speed: 0.5141s/iter; left time: 2245.2362s
Epoch: 2 cost time: 25.074740409851074
Epoch: 2, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.116 Vali Acc: 0.324 Test Loss: 2.116 Test Acc: 0.324
Validation loss decreased (-0.315469 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7562592
	speed: 0.4749s/iter; left time: 2000.8530s
Epoch: 3 cost time: 23.17464518547058
Epoch: 3, Steps: 154 | Train Loss: 1.990 Vali Loss: 2.084 Vali Acc: 0.328 Test Loss: 2.084 Test Acc: 0.328
Validation loss decreased (-0.324391 --> -0.328041).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7875656
	speed: 0.5677s/iter; left time: 2304.2158s
Epoch: 4 cost time: 27.66178560256958
Epoch: 4, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.074 Vali Acc: 0.334 Test Loss: 2.074 Test Acc: 0.334
Validation loss decreased (-0.328041 --> -0.334124).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9281526
	speed: 0.5587s/iter; left time: 2181.5313s
Epoch: 5 cost time: 25.958062648773193
Epoch: 5, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.098 Vali Acc: 0.341 Test Loss: 2.098 Test Acc: 0.341
Validation loss decreased (-0.334124 --> -0.340612).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5180053
	speed: 0.5311s/iter; left time: 1992.0519s
Epoch: 6 cost time: 25.39902138710022
Epoch: 6, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.066 Vali Acc: 0.357 Test Loss: 2.066 Test Acc: 0.357
Validation loss decreased (-0.340612 --> -0.357238).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8358536
	speed: 0.5127s/iter; left time: 1844.1999s
Epoch: 7 cost time: 21.964837074279785
Epoch: 7, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.319 Vali Acc: 0.283 Test Loss: 2.319 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.2047756
	speed: 0.4727s/iter; left time: 1627.6414s
Epoch: 8 cost time: 18.110372066497803
Epoch: 8, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.085 Vali Acc: 0.349 Test Loss: 2.085 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5257730
	speed: 0.4962s/iter; left time: 1631.8603s
Epoch: 9 cost time: 24.21168851852417
Epoch: 9, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.128 Vali Acc: 0.371 Test Loss: 2.128 Test Acc: 0.371
Validation loss decreased (-0.357238 --> -0.371025).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7457916
	speed: 0.5195s/iter; left time: 1628.5703s
Epoch: 10 cost time: 24.157190561294556
Epoch: 10, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.027 Vali Acc: 0.367 Test Loss: 2.027 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5358262
	speed: 0.5233s/iter; left time: 1559.8557s
Epoch: 11 cost time: 24.196149587631226
Epoch: 11, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.100 Vali Acc: 0.271 Test Loss: 2.100 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.3097377
	speed: 0.5222s/iter; left time: 1476.3850s
Epoch: 12 cost time: 22.389987468719482
Epoch: 12, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.231 Vali Acc: 0.359 Test Loss: 2.231 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6907011
	speed: 0.4350s/iter; left time: 1162.8352s
Epoch: 13 cost time: 21.673053741455078
Epoch: 13, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.096 Vali Acc: 0.360 Test Loss: 2.096 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2979726
	speed: 0.4672s/iter; left time: 1176.9667s
Epoch: 14 cost time: 23.42443609237671
Epoch: 14, Steps: 154 | Train Loss: 1.462 Vali Loss: 1.991 Vali Acc: 0.313 Test Loss: 1.991 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.7969558
	speed: 0.5351s/iter; left time: 1265.4778s
Epoch: 15 cost time: 24.40922999382019
Epoch: 15, Steps: 154 | Train Loss: 1.446 Vali Loss: 1.981 Vali Acc: 0.367 Test Loss: 1.981 Test Acc: 0.367
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.4006318
	speed: 0.5353s/iter; left time: 1183.6187s
Epoch: 16 cost time: 23.533259391784668
Epoch: 16, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.435 Vali Acc: 0.366 Test Loss: 2.435 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.4358033
	speed: 0.5516s/iter; left time: 1134.7076s
Epoch: 17 cost time: 25.085692644119263
Epoch: 17, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.093 Vali Acc: 0.374 Test Loss: 2.093 Test Acc: 0.374
Validation loss decreased (-0.371025 --> -0.374269).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.0857277
	speed: 0.5589s/iter; left time: 1063.5093s
Epoch: 18 cost time: 25.109559297561646
Epoch: 18, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.395 Vali Acc: 0.168 Test Loss: 2.395 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.1090764
	speed: 0.5426s/iter; left time: 949.0542s
Epoch: 19 cost time: 24.353015184402466
Epoch: 19, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.603 Vali Acc: 0.114 Test Loss: 2.603 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.2134457
	speed: 0.4336s/iter; left time: 691.5996s
Epoch: 20 cost time: 20.534087419509888
Epoch: 20, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.604 Vali Acc: 0.142 Test Loss: 3.604 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 1.1061593
	speed: 0.4345s/iter; left time: 626.1545s
Epoch: 21 cost time: 20.46042561531067
Epoch: 21, Steps: 154 | Train Loss: 1.277 Vali Loss: 2.106 Vali Acc: 0.303 Test Loss: 2.106 Test Acc: 0.303
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 1.0781928
	speed: 0.4191s/iter; left time: 539.3493s
Epoch: 22 cost time: 19.068700551986694
Epoch: 22, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.347 Vali Acc: 0.133 Test Loss: 3.347 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 1.0399840
	speed: 0.4639s/iter; left time: 525.6354s
Epoch: 23 cost time: 23.314976453781128
Epoch: 23, Steps: 154 | Train Loss: 1.208 Vali Loss: 2.188 Vali Acc: 0.390 Test Loss: 2.188 Test Acc: 0.390
Validation loss decreased (-0.374269 --> -0.390084).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.1999592
	speed: 0.4926s/iter; left time: 482.2656s
Epoch: 24 cost time: 22.835532665252686
Epoch: 24, Steps: 154 | Train Loss: 1.193 Vali Loss: 4.494 Vali Acc: 0.108 Test Loss: 4.494 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.8171918
	speed: 0.4900s/iter; left time: 404.2225s
Epoch: 25 cost time: 22.873440265655518
Epoch: 25, Steps: 154 | Train Loss: 1.154 Vali Loss: 5.360 Vali Acc: 0.127 Test Loss: 5.360 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 1.1285647
	speed: 0.5440s/iter; left time: 365.0029s
Epoch: 26 cost time: 25.650529623031616
Epoch: 26, Steps: 154 | Train Loss: 1.112 Vali Loss: 4.571 Vali Acc: 0.125 Test Loss: 4.571 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 1.2007773
	speed: 0.5035s/iter; left time: 260.2994s
Epoch: 27 cost time: 22.79642963409424
Epoch: 27, Steps: 154 | Train Loss: 1.107 Vali Loss: 5.747 Vali Acc: 0.129 Test Loss: 5.747 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 1.2504408
	speed: 0.5027s/iter; left time: 182.4650s
Epoch: 28 cost time: 23.379770040512085
Epoch: 28, Steps: 154 | Train Loss: 1.093 Vali Loss: 4.949 Vali Acc: 0.126 Test Loss: 4.949 Test Acc: 0.126
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.0585234
	speed: 0.5089s/iter; left time: 106.3627s
Epoch: 29 cost time: 23.614046096801758
Epoch: 29, Steps: 154 | Train Loss: 1.048 Vali Loss: 7.349 Vali Acc: 0.137 Test Loss: 7.349 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 1.1758299
	speed: 0.4984s/iter; left time: 27.4146s
Epoch: 30 cost time: 24.97510576248169
Epoch: 30, Steps: 154 | Train Loss: 1.020 Vali Loss: 6.332 Vali Acc: 0.109 Test Loss: 6.332 Test Acc: 0.109
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39010543390105434
model parameter : 590926
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3238494
	speed: 0.1519s/iter; left time: 686.6215s
Epoch: 1 cost time: 22.79235816001892
Epoch: 1, Steps: 154 | Train Loss: 2.228 Vali Loss: 2.128 Vali Acc: 0.315 Test Loss: 2.128 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1499259
	speed: 0.4581s/iter; left time: 2000.6473s
Epoch: 2 cost time: 20.770354986190796
Epoch: 2, Steps: 154 | Train Loss: 2.050 Vali Loss: 2.111 Vali Acc: 0.322 Test Loss: 2.111 Test Acc: 0.322
Validation loss decreased (-0.315064 --> -0.321958).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8466520
	speed: 0.4455s/iter; left time: 1876.8491s
Epoch: 3 cost time: 20.064009189605713
Epoch: 3, Steps: 154 | Train Loss: 1.949 Vali Loss: 2.061 Vali Acc: 0.332 Test Loss: 2.061 Test Acc: 0.332
Validation loss decreased (-0.321958 --> -0.331691).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1399853
	speed: 0.4263s/iter; left time: 1730.3383s
Epoch: 4 cost time: 17.193923473358154
Epoch: 4, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.097 Vali Acc: 0.332 Test Loss: 2.097 Test Acc: 0.332
Validation loss decreased (-0.331691 --> -0.332096).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5796862
	speed: 0.4030s/iter; left time: 1573.5394s
Epoch: 5 cost time: 18.421833753585815
Epoch: 5, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.201 Vali Acc: 0.341 Test Loss: 2.201 Test Acc: 0.341
Validation loss decreased (-0.332096 --> -0.340611).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1113670
	speed: 0.4039s/iter; left time: 1514.9561s
Epoch: 6 cost time: 18.282271146774292
Epoch: 6, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.104 Vali Acc: 0.343 Test Loss: 2.104 Test Acc: 0.343
Validation loss decreased (-0.340611 --> -0.343450).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7620399
	speed: 0.4572s/iter; left time: 1644.7276s
Epoch: 7 cost time: 20.95616340637207
Epoch: 7, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.050 Vali Acc: 0.343 Test Loss: 2.050 Test Acc: 0.343
Validation loss decreased (-0.343450 --> -0.343451).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8771724
	speed: 0.4608s/iter; left time: 1586.5395s
Epoch: 8 cost time: 21.677407026290894
Epoch: 8, Steps: 154 | Train Loss: 1.703 Vali Loss: 3.154 Vali Acc: 0.105 Test Loss: 3.154 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4953507
	speed: 0.4991s/iter; left time: 1641.5507s
Epoch: 9 cost time: 21.657928943634033
Epoch: 9, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.655 Vali Acc: 0.138 Test Loss: 2.655 Test Acc: 0.138
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0275724
	speed: 0.4966s/iter; left time: 1556.7158s
Epoch: 10 cost time: 19.99827241897583
Epoch: 10, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.412 Vali Acc: 0.182 Test Loss: 2.412 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.8556114
	speed: 0.4429s/iter; left time: 1320.3323s
Epoch: 11 cost time: 19.808568239212036
Epoch: 11, Steps: 154 | Train Loss: 1.575 Vali Loss: 1.989 Vali Acc: 0.371 Test Loss: 1.989 Test Acc: 0.371
Validation loss decreased (-0.343451 --> -0.371026).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3519787
	speed: 0.4137s/iter; left time: 1169.5543s
Epoch: 12 cost time: 17.06128478050232
Epoch: 12, Steps: 154 | Train Loss: 1.519 Vali Loss: 5.613 Vali Acc: 0.112 Test Loss: 5.613 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2452185
	speed: 0.4168s/iter; left time: 1113.9816s
Epoch: 13 cost time: 20.598962783813477
Epoch: 13, Steps: 154 | Train Loss: 1.485 Vali Loss: 4.871 Vali Acc: 0.131 Test Loss: 4.871 Test Acc: 0.131
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1137493
	speed: 0.4603s/iter; left time: 1159.3892s
Epoch: 14 cost time: 20.884660720825195
Epoch: 14, Steps: 154 | Train Loss: 1.459 Vali Loss: 5.106 Vali Acc: 0.116 Test Loss: 5.106 Test Acc: 0.116
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.7747127
	speed: 0.4755s/iter; left time: 1124.5816s
Epoch: 15 cost time: 21.476413011550903
Epoch: 15, Steps: 154 | Train Loss: 1.433 Vali Loss: 4.692 Vali Acc: 0.126 Test Loss: 4.692 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.9487162
	speed: 0.4854s/iter; left time: 1073.2563s
Epoch: 16 cost time: 21.184521198272705
Epoch: 16, Steps: 154 | Train Loss: 1.410 Vali Loss: 6.426 Vali Acc: 0.116 Test Loss: 6.426 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.4693550
	speed: 0.4806s/iter; left time: 988.5014s
Epoch: 17 cost time: 21.028449535369873
Epoch: 17, Steps: 154 | Train Loss: 1.379 Vali Loss: 5.136 Vali Acc: 0.129 Test Loss: 5.136 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9641497
	speed: 0.4951s/iter; left time: 942.0874s
Epoch: 18 cost time: 22.207958459854126
Epoch: 18, Steps: 154 | Train Loss: 1.348 Vali Loss: 8.884 Vali Acc: 0.131 Test Loss: 8.884 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.2653756
	speed: 0.4882s/iter; left time: 853.8920s
Epoch: 19 cost time: 21.353333473205566
Epoch: 19, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.462 Vali Acc: 0.127 Test Loss: 3.462 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.4509248
	speed: 0.4896s/iter; left time: 780.9221s
Epoch: 20 cost time: 21.07612895965576
Epoch: 20, Steps: 154 | Train Loss: 1.320 Vali Loss: 6.205 Vali Acc: 0.117 Test Loss: 6.205 Test Acc: 0.117
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.3080487
	speed: 0.4881s/iter; left time: 703.2888s
Epoch: 21 cost time: 21.51491641998291
Epoch: 21, Steps: 154 | Train Loss: 1.272 Vali Loss: 5.438 Vali Acc: 0.100 Test Loss: 5.438 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3710462287104623
model parameter : 176910
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3713779
	speed: 0.2058s/iter; left time: 930.3724s
Epoch: 1 cost time: 29.058688402175903
Epoch: 1, Steps: 154 | Train Loss: 2.248 Vali Loss: 2.111 Vali Acc: 0.315 Test Loss: 2.111 Test Acc: 0.315
Validation loss decreased (inf --> -0.315470).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5641606
	speed: 0.5068s/iter; left time: 2213.2970s
Epoch: 2 cost time: 21.843143463134766
Epoch: 2, Steps: 154 | Train Loss: 2.076 Vali Loss: 2.109 Vali Acc: 0.320 Test Loss: 2.109 Test Acc: 0.320
Validation loss decreased (-0.315470 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7555140
	speed: 0.4693s/iter; left time: 1977.3376s
Epoch: 3 cost time: 28.53735876083374
Epoch: 3, Steps: 154 | Train Loss: 2.023 Vali Loss: 2.053 Vali Acc: 0.330 Test Loss: 2.053 Test Acc: 0.330
Validation loss decreased (-0.319930 --> -0.330474).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7820266
	speed: 0.5068s/iter; left time: 2057.1737s
Epoch: 4 cost time: 22.004974603652954
Epoch: 4, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.066 Vali Acc: 0.335 Test Loss: 2.066 Test Acc: 0.335
Validation loss decreased (-0.330474 --> -0.334935).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9843562
	speed: 0.4506s/iter; left time: 1759.6204s
Epoch: 5 cost time: 20.526079416275024
Epoch: 5, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.095 Vali Acc: 0.346 Test Loss: 2.095 Test Acc: 0.346
Validation loss decreased (-0.334935 --> -0.345883).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4624718
	speed: 0.4516s/iter; left time: 1693.9464s
Epoch: 6 cost time: 20.23044443130493
Epoch: 6, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.025 Vali Acc: 0.352 Test Loss: 2.025 Test Acc: 0.352
Validation loss decreased (-0.345883 --> -0.352372).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8634138
	speed: 0.4430s/iter; left time: 1593.6207s
Epoch: 7 cost time: 20.072040796279907
Epoch: 7, Steps: 154 | Train Loss: 1.716 Vali Loss: 3.160 Vali Acc: 0.062 Test Loss: 3.160 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.3187783
	speed: 0.4236s/iter; left time: 1458.5631s
Epoch: 8 cost time: 17.507208824157715
Epoch: 8, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.257 Vali Acc: 0.343 Test Loss: 2.257 Test Acc: 0.343
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4560554
	speed: 0.4629s/iter; left time: 1522.3494s
Epoch: 9 cost time: 21.102442979812622
Epoch: 9, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.073 Vali Acc: 0.368 Test Loss: 2.073 Test Acc: 0.368
Validation loss decreased (-0.352372 --> -0.368187).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8146912
	speed: 0.4698s/iter; left time: 1472.6898s
Epoch: 10 cost time: 21.06109070777893
Epoch: 10, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.049 Vali Acc: 0.361 Test Loss: 2.049 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.6116889
	speed: 0.4697s/iter; left time: 1400.0387s
Epoch: 11 cost time: 20.70905303955078
Epoch: 11, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.072 Vali Acc: 0.373 Test Loss: 2.072 Test Acc: 0.373
Validation loss decreased (-0.368187 --> -0.373459).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4239100
	speed: 0.4713s/iter; left time: 1332.4151s
Epoch: 12 cost time: 20.652998208999634
Epoch: 12, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.135 Vali Acc: 0.372 Test Loss: 2.135 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.6535001
	speed: 0.4504s/iter; left time: 1203.8253s
Epoch: 13 cost time: 18.8039288520813
Epoch: 13, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.359 Vali Acc: 0.358 Test Loss: 2.359 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.1624560
	speed: 0.4253s/iter; left time: 1071.3971s
Epoch: 14 cost time: 18.06167244911194
Epoch: 14, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.048 Vali Acc: 0.370 Test Loss: 2.048 Test Acc: 0.370
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.0737748
	speed: 0.4060s/iter; left time: 960.2427s
Epoch: 15 cost time: 18.018925666809082
Epoch: 15, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.182 Vali Acc: 0.361 Test Loss: 2.182 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3570516
	speed: 0.4055s/iter; left time: 896.5797s
Epoch: 16 cost time: 19.091957569122314
Epoch: 16, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.158 Vali Acc: 0.217 Test Loss: 2.158 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.2806816
	speed: 0.3842s/iter; left time: 790.2656s
Epoch: 17 cost time: 15.902089357376099
Epoch: 17, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.077 Vali Acc: 0.350 Test Loss: 2.077 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.2700803
	speed: 0.3829s/iter; left time: 728.5740s
Epoch: 18 cost time: 17.150211572647095
Epoch: 18, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.761 Vali Acc: 0.161 Test Loss: 2.761 Test Acc: 0.161
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.3274915
	speed: 0.3868s/iter; left time: 676.6003s
Epoch: 19 cost time: 16.978256225585938
Epoch: 19, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.229 Vali Acc: 0.383 Test Loss: 2.229 Test Acc: 0.383
Validation loss decreased (-0.373459 --> -0.383189).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.0582668
	speed: 0.3763s/iter; left time: 600.1976s
Epoch: 20 cost time: 16.563859701156616
Epoch: 20, Steps: 154 | Train Loss: 1.394 Vali Loss: 2.699 Vali Acc: 0.200 Test Loss: 2.699 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2272491
	speed: 0.4208s/iter; left time: 606.3360s
Epoch: 21 cost time: 20.406734228134155
Epoch: 21, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.261 Vali Acc: 0.373 Test Loss: 2.261 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.4157774
	speed: 0.4651s/iter; left time: 598.5646s
Epoch: 22 cost time: 20.643181324005127
Epoch: 22, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.833 Vali Acc: 0.084 Test Loss: 3.833 Test Acc: 0.084
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.1946968
	speed: 0.4696s/iter; left time: 532.1132s
Epoch: 23 cost time: 20.486353874206543
Epoch: 23, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.367 Vali Acc: 0.378 Test Loss: 2.367 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.9029566
	speed: 0.4744s/iter; left time: 464.4443s
Epoch: 24 cost time: 20.799070596694946
Epoch: 24, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.468 Vali Acc: 0.372 Test Loss: 2.468 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.0482864
	speed: 0.4382s/iter; left time: 361.5277s
Epoch: 25 cost time: 19.038000345230103
Epoch: 25, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.234 Vali Acc: 0.373 Test Loss: 2.234 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.0385274
	speed: 0.4444s/iter; left time: 298.1758s
Epoch: 26 cost time: 18.77422547340393
Epoch: 26, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.685 Vali Acc: 0.393 Test Loss: 2.685 Test Acc: 0.393
Validation loss decreased (-0.383189 --> -0.393323).  Saving model ...
	iters: 100, epoch: 27 | loss: 1.3718458
	speed: 0.3867s/iter; left time: 199.9051s
Epoch: 27 cost time: 17.18390417098999
Epoch: 27, Steps: 154 | Train Loss: 1.289 Vali Loss: 4.718 Vali Acc: 0.075 Test Loss: 4.718 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.3852131
	speed: 0.3844s/iter; left time: 139.5451s
Epoch: 28 cost time: 16.409074306488037
Epoch: 28, Steps: 154 | Train Loss: 1.273 Vali Loss: 2.413 Vali Acc: 0.365 Test Loss: 2.413 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.0861185
	speed: 0.3734s/iter; left time: 78.0462s
Epoch: 29 cost time: 16.558143854141235
Epoch: 29, Steps: 154 | Train Loss: 1.232 Vali Loss: 2.330 Vali Acc: 0.376 Test Loss: 2.330 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.5596551
	speed: 0.3534s/iter; left time: 19.4397s
Epoch: 30 cost time: 17.512526750564575
Epoch: 30, Steps: 154 | Train Loss: 1.229 Vali Loss: 2.680 Vali Acc: 0.149 Test Loss: 2.680 Test Acc: 0.149
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3933495539334955
model parameter : 590926
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3860633
	speed: 0.1443s/iter; left time: 652.4003s
Epoch: 1 cost time: 22.09999442100525
Epoch: 1, Steps: 154 | Train Loss: 2.236 Vali Loss: 2.129 Vali Acc: 0.315 Test Loss: 2.129 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1217585
	speed: 0.4481s/iter; left time: 1956.7737s
Epoch: 2 cost time: 23.045973777770996
Epoch: 2, Steps: 154 | Train Loss: 2.050 Vali Loss: 2.116 Vali Acc: 0.321 Test Loss: 2.116 Test Acc: 0.321
Validation loss decreased (-0.314658 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8583208
	speed: 0.4499s/iter; left time: 1895.4597s
Epoch: 3 cost time: 21.542672872543335
Epoch: 3, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.074 Vali Acc: 0.328 Test Loss: 2.074 Test Acc: 0.328
Validation loss decreased (-0.320741 --> -0.328041).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0662723
	speed: 0.4570s/iter; left time: 1855.0999s
Epoch: 4 cost time: 21.9871027469635
Epoch: 4, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.046 Vali Acc: 0.332 Test Loss: 2.046 Test Acc: 0.332
Validation loss decreased (-0.328041 --> -0.331691).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6111840
	speed: 0.4439s/iter; left time: 1733.3767s
Epoch: 5 cost time: 20.02844548225403
Epoch: 5, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.124 Vali Acc: 0.335 Test Loss: 2.124 Test Acc: 0.335
Validation loss decreased (-0.331691 --> -0.334529).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0476720
	speed: 0.4305s/iter; left time: 1614.7952s
Epoch: 6 cost time: 19.40103006362915
Epoch: 6, Steps: 154 | Train Loss: 1.823 Vali Loss: 2.184 Vali Acc: 0.348 Test Loss: 2.184 Test Acc: 0.348
Validation loss decreased (-0.334529 --> -0.347505).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7993190
	speed: 0.4058s/iter; left time: 1459.5027s
Epoch: 7 cost time: 19.843037843704224
Epoch: 7, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.064 Vali Acc: 0.339 Test Loss: 2.064 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9229237
	speed: 0.3848s/iter; left time: 1324.7377s
Epoch: 8 cost time: 16.520062923431396
Epoch: 8, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.012 Vali Acc: 0.359 Test Loss: 2.012 Test Acc: 0.359
Validation loss decreased (-0.347505 --> -0.359266).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4496400
	speed: 0.3816s/iter; left time: 1255.2280s
Epoch: 9 cost time: 17.647608757019043
Epoch: 9, Steps: 154 | Train Loss: 1.726 Vali Loss: 1.991 Vali Acc: 0.356 Test Loss: 1.991 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.0359857
	speed: 0.3859s/iter; left time: 1209.9417s
Epoch: 10 cost time: 17.075201272964478
Epoch: 10, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.097 Vali Acc: 0.384 Test Loss: 2.097 Test Acc: 0.384
Validation loss decreased (-0.359266 --> -0.384407).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.0047948
	speed: 0.3602s/iter; left time: 1073.7907s
Epoch: 11 cost time: 14.693056106567383
Epoch: 11, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.035 Vali Acc: 0.369 Test Loss: 2.035 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4439189
	speed: 0.3480s/iter; left time: 983.8047s
Epoch: 12 cost time: 15.312883615493774
Epoch: 12, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.191 Vali Acc: 0.354 Test Loss: 2.191 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2456369
	speed: 0.3397s/iter; left time: 908.1148s
Epoch: 13 cost time: 14.862856149673462
Epoch: 13, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.193 Vali Acc: 0.360 Test Loss: 2.193 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4033905
	speed: 0.3437s/iter; left time: 865.6594s
Epoch: 14 cost time: 16.267457723617554
Epoch: 14, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.275 Vali Acc: 0.322 Test Loss: 2.275 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.7547548
	speed: 0.4275s/iter; left time: 1011.0271s
Epoch: 15 cost time: 19.439703226089478
Epoch: 15, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.387 Vali Acc: 0.268 Test Loss: 2.387 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.1721529
	speed: 0.4383s/iter; left time: 969.0774s
Epoch: 16 cost time: 19.194084882736206
Epoch: 16, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.155 Vali Acc: 0.372 Test Loss: 2.155 Test Acc: 0.372
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5618896
	speed: 0.4518s/iter; left time: 929.4126s
Epoch: 17 cost time: 19.239009618759155
Epoch: 17, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.318 Vali Acc: 0.279 Test Loss: 2.318 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.1307077
	speed: 0.4506s/iter; left time: 857.5715s
Epoch: 18 cost time: 19.083815336227417
Epoch: 18, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.246 Vali Acc: 0.360 Test Loss: 2.246 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.4882617
	speed: 0.4004s/iter; left time: 700.2765s
Epoch: 19 cost time: 17.382195949554443
Epoch: 19, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.118 Vali Acc: 0.366 Test Loss: 2.118 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.7701163
	speed: 0.3876s/iter; left time: 618.2498s
Epoch: 20 cost time: 15.36946177482605
Epoch: 20, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.207 Vali Acc: 0.333 Test Loss: 2.207 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 176910
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9757768
	speed: 0.1761s/iter; left time: 796.3508s
Epoch: 1 cost time: 26.406763315200806
Epoch: 1, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.133 Vali Acc: 0.317 Test Loss: 2.133 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0479226
	speed: 0.5065s/iter; left time: 2211.6931s
Epoch: 2 cost time: 25.747055768966675
Epoch: 2, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.084 Vali Acc: 0.328 Test Loss: 2.084 Test Acc: 0.328
Validation loss decreased (-0.317091 --> -0.328041).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8776269
	speed: 0.5328s/iter; left time: 2244.5296s
Epoch: 3 cost time: 26.225439071655273
Epoch: 3, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.043 Vali Acc: 0.345 Test Loss: 2.043 Test Acc: 0.345
Validation loss decreased (-0.328041 --> -0.345073).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8765366
	speed: 0.5428s/iter; left time: 2203.3031s
Epoch: 4 cost time: 25.795101165771484
Epoch: 4, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.098 Vali Acc: 0.343 Test Loss: 2.098 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1669631
	speed: 0.4853s/iter; left time: 1894.9872s
Epoch: 5 cost time: 24.081019639968872
Epoch: 5, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.126 Vali Acc: 0.348 Test Loss: 2.126 Test Acc: 0.348
Validation loss decreased (-0.345073 --> -0.347911).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2457049
	speed: 0.5000s/iter; left time: 1875.6167s
Epoch: 6 cost time: 23.61084008216858
Epoch: 6, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.160 Vali Acc: 0.348 Test Loss: 2.160 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1426471
	speed: 0.4629s/iter; left time: 1664.9990s
Epoch: 7 cost time: 19.925177574157715
Epoch: 7, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.146 Vali Acc: 0.361 Test Loss: 2.146 Test Acc: 0.361
Validation loss decreased (-0.347911 --> -0.361292).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5701065
	speed: 0.5760s/iter; left time: 1983.0778s
Epoch: 8 cost time: 27.79589009284973
Epoch: 8, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.465 Vali Acc: 0.122 Test Loss: 2.465 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6757499
	speed: 0.5920s/iter; left time: 1946.9719s
Epoch: 9 cost time: 28.204050302505493
Epoch: 9, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.594 Vali Acc: 0.103 Test Loss: 2.594 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6275014
	speed: 0.6018s/iter; left time: 1886.7803s
Epoch: 10 cost time: 26.90692901611328
Epoch: 10, Steps: 154 | Train Loss: 1.549 Vali Loss: 3.962 Vali Acc: 0.120 Test Loss: 3.962 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7070873
	speed: 0.5839s/iter; left time: 1740.5428s
Epoch: 11 cost time: 27.32844090461731
Epoch: 11, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.406 Vali Acc: 0.116 Test Loss: 2.406 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3304946
	speed: 0.5746s/iter; left time: 1624.3950s
Epoch: 12 cost time: 26.95654606819153
Epoch: 12, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.248 Vali Acc: 0.330 Test Loss: 2.248 Test Acc: 0.330
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3226322
	speed: 0.6425s/iter; left time: 1717.3173s
Epoch: 13 cost time: 29.4055233001709
Epoch: 13, Steps: 154 | Train Loss: 1.445 Vali Loss: 4.134 Vali Acc: 0.120 Test Loss: 4.134 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2733769
	speed: 0.6325s/iter; left time: 1593.1678s
Epoch: 14 cost time: 27.201327323913574
Epoch: 14, Steps: 154 | Train Loss: 1.397 Vali Loss: 4.277 Vali Acc: 0.123 Test Loss: 4.277 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.4423186
	speed: 0.5685s/iter; left time: 1344.5394s
Epoch: 15 cost time: 26.602241277694702
Epoch: 15, Steps: 154 | Train Loss: 1.362 Vali Loss: 4.364 Vali Acc: 0.118 Test Loss: 4.364 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3202857
	speed: 0.5872s/iter; left time: 1298.2030s
Epoch: 16 cost time: 26.589519023895264
Epoch: 16, Steps: 154 | Train Loss: 1.346 Vali Loss: 4.941 Vali Acc: 0.126 Test Loss: 4.941 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.5991917
	speed: 0.5878s/iter; left time: 1209.1358s
Epoch: 17 cost time: 26.889397621154785
Epoch: 17, Steps: 154 | Train Loss: 1.314 Vali Loss: 4.830 Vali Acc: 0.127 Test Loss: 4.830 Test Acc: 0.127
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3613138686131387
model parameter : 297678
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9598053
	speed: 0.1678s/iter; left time: 758.5512s
Epoch: 1 cost time: 25.09724736213684
Epoch: 1, Steps: 154 | Train Loss: 2.244 Vali Loss: 2.136 Vali Acc: 0.316 Test Loss: 2.136 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9698714
	speed: 0.5128s/iter; left time: 2239.3713s
Epoch: 2 cost time: 23.37348508834839
Epoch: 2, Steps: 154 | Train Loss: 2.062 Vali Loss: 2.113 Vali Acc: 0.320 Test Loss: 2.113 Test Acc: 0.320
Validation loss decreased (-0.315875 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6883067
	speed: 0.5010s/iter; left time: 2110.8819s
Epoch: 3 cost time: 25.87319254875183
Epoch: 3, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.092 Vali Acc: 0.329 Test Loss: 2.092 Test Acc: 0.329
Validation loss decreased (-0.319930 --> -0.328852).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2221007
	speed: 0.5400s/iter; left time: 2191.7955s
Epoch: 4 cost time: 25.23765277862549
Epoch: 4, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.063 Vali Acc: 0.337 Test Loss: 2.063 Test Acc: 0.337
Validation loss decreased (-0.328852 --> -0.336557).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9292068
	speed: 0.6083s/iter; left time: 2375.2300s
Epoch: 5 cost time: 27.49991726875305
Epoch: 5, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.098 Vali Acc: 0.341 Test Loss: 2.098 Test Acc: 0.341
Validation loss decreased (-0.336557 --> -0.341017).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3662992
	speed: 0.6167s/iter; left time: 2313.1584s
Epoch: 6 cost time: 26.850393533706665
Epoch: 6, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.010 Vali Acc: 0.362 Test Loss: 2.010 Test Acc: 0.362
Validation loss decreased (-0.341017 --> -0.362105).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8008451
	speed: 0.6079s/iter; left time: 2186.4814s
Epoch: 7 cost time: 27.022440433502197
Epoch: 7, Steps: 154 | Train Loss: 1.683 Vali Loss: 1.991 Vali Acc: 0.377 Test Loss: 1.991 Test Acc: 0.377
Validation loss decreased (-0.362105 --> -0.376704).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4535466
	speed: 0.6029s/iter; left time: 2075.8106s
Epoch: 8 cost time: 25.882095336914062
Epoch: 8, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.252 Vali Acc: 0.206 Test Loss: 2.252 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4386622
	speed: 0.5587s/iter; left time: 1837.7185s
Epoch: 9 cost time: 24.905019521713257
Epoch: 9, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.218 Vali Acc: 0.209 Test Loss: 2.218 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6276846
	speed: 0.5361s/iter; left time: 1680.6214s
Epoch: 10 cost time: 21.207557439804077
Epoch: 10, Steps: 154 | Train Loss: 1.538 Vali Loss: 2.162 Vali Acc: 0.266 Test Loss: 2.162 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7681035
	speed: 0.5234s/iter; left time: 1560.2955s
Epoch: 11 cost time: 24.09020447731018
Epoch: 11, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.321 Vali Acc: 0.212 Test Loss: 2.321 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3611677
	speed: 0.5286s/iter; left time: 1494.3674s
Epoch: 12 cost time: 21.54729676246643
Epoch: 12, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.703 Vali Acc: 0.210 Test Loss: 2.703 Test Acc: 0.210
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.7557775
	speed: 0.5205s/iter; left time: 1391.3887s
Epoch: 13 cost time: 23.137279272079468
Epoch: 13, Steps: 154 | Train Loss: 1.440 Vali Loss: 3.182 Vali Acc: 0.126 Test Loss: 3.182 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.5263209
	speed: 0.5320s/iter; left time: 1340.0229s
Epoch: 14 cost time: 22.66746973991394
Epoch: 14, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.947 Vali Acc: 0.185 Test Loss: 2.947 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0440276
	speed: 0.5225s/iter; left time: 1235.8063s
Epoch: 15 cost time: 22.73577356338501
Epoch: 15, Steps: 154 | Train Loss: 1.385 Vali Loss: 2.821 Vali Acc: 0.210 Test Loss: 2.821 Test Acc: 0.210
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.5499606
	speed: 0.4789s/iter; left time: 1058.8242s
Epoch: 16 cost time: 20.784891605377197
Epoch: 16, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.795 Vali Acc: 0.101 Test Loss: 2.795 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.4229069
	speed: 0.5457s/iter; left time: 1122.4055s
Epoch: 17 cost time: 24.04028058052063
Epoch: 17, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.618 Vali Acc: 0.111 Test Loss: 2.618 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 90638
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9794106
	speed: 0.1799s/iter; left time: 813.5335s
Epoch: 1 cost time: 27.703400373458862
Epoch: 1, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.133 Vali Acc: 0.317 Test Loss: 2.133 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0535057
	speed: 0.5917s/iter; left time: 2583.8043s
Epoch: 2 cost time: 28.044999361038208
Epoch: 2, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.084 Vali Acc: 0.327 Test Loss: 2.084 Test Acc: 0.327
Validation loss decreased (-0.317091 --> -0.327230).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8719112
	speed: 0.5731s/iter; left time: 2414.5917s
Epoch: 3 cost time: 27.88719391822815
Epoch: 3, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.039 Vali Acc: 0.350 Test Loss: 2.039 Test Acc: 0.350
Validation loss decreased (-0.327230 --> -0.350345).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8250372
	speed: 0.5798s/iter; left time: 2353.3961s
Epoch: 4 cost time: 27.64156198501587
Epoch: 4, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.063 Vali Acc: 0.347 Test Loss: 2.063 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0738292
	speed: 0.5562s/iter; left time: 2172.1492s
Epoch: 5 cost time: 25.774105548858643
Epoch: 5, Steps: 154 | Train Loss: 1.765 Vali Loss: 2.192 Vali Acc: 0.346 Test Loss: 2.192 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4000952
	speed: 0.5337s/iter; left time: 2001.8116s
Epoch: 6 cost time: 25.096630811691284
Epoch: 6, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.169 Vali Acc: 0.348 Test Loss: 2.169 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.1307318
	speed: 0.4839s/iter; left time: 1740.5294s
Epoch: 7 cost time: 22.284186840057373
Epoch: 7, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.148 Vali Acc: 0.369 Test Loss: 2.148 Test Acc: 0.369
Validation loss decreased (-0.350345 --> -0.368997).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5881227
	speed: 0.4738s/iter; left time: 1631.3439s
Epoch: 8 cost time: 21.192148685455322
Epoch: 8, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.582 Vali Acc: 0.098 Test Loss: 2.582 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6241089
	speed: 0.4780s/iter; left time: 1572.2543s
Epoch: 9 cost time: 22.70565938949585
Epoch: 9, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.554 Vali Acc: 0.106 Test Loss: 2.554 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6547084
	speed: 0.4934s/iter; left time: 1546.6665s
Epoch: 10 cost time: 23.7927405834198
Epoch: 10, Steps: 154 | Train Loss: 1.544 Vali Loss: 3.681 Vali Acc: 0.118 Test Loss: 3.681 Test Acc: 0.118
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6839892
	speed: 0.4953s/iter; left time: 1476.5129s
Epoch: 11 cost time: 22.59310746192932
Epoch: 11, Steps: 154 | Train Loss: 1.489 Vali Loss: 3.058 Vali Acc: 0.115 Test Loss: 3.058 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3522301
	speed: 0.4739s/iter; left time: 1339.6231s
Epoch: 12 cost time: 22.651944637298584
Epoch: 12, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.570 Vali Acc: 0.099 Test Loss: 2.570 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3409606
	speed: 0.4584s/iter; left time: 1225.1701s
Epoch: 13 cost time: 21.101076364517212
Epoch: 13, Steps: 154 | Train Loss: 1.433 Vali Loss: 5.766 Vali Acc: 0.136 Test Loss: 5.766 Test Acc: 0.136
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2281845
	speed: 0.4623s/iter; left time: 1164.6336s
Epoch: 14 cost time: 22.670346975326538
Epoch: 14, Steps: 154 | Train Loss: 1.380 Vali Loss: 3.586 Vali Acc: 0.119 Test Loss: 3.586 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.4570397
	speed: 0.5137s/iter; left time: 1214.8222s
Epoch: 15 cost time: 23.953777074813843
Epoch: 15, Steps: 154 | Train Loss: 1.348 Vali Loss: 3.378 Vali Acc: 0.123 Test Loss: 3.378 Test Acc: 0.123
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4345771
	speed: 0.4323s/iter; left time: 955.8835s
Epoch: 16 cost time: 22.83619213104248
Epoch: 16, Steps: 154 | Train Loss: 1.330 Vali Loss: 5.835 Vali Acc: 0.130 Test Loss: 5.835 Test Acc: 0.130
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.5617572
	speed: 0.5204s/iter; left time: 1070.5585s
Epoch: 17 cost time: 24.4809992313385
Epoch: 17, Steps: 154 | Train Loss: 1.292 Vali Loss: 6.631 Vali Acc: 0.138 Test Loss: 6.631 Test Acc: 0.138
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36901865369018655
model parameter : 297678
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9657942
	speed: 0.1562s/iter; left time: 706.3757s
Epoch: 1 cost time: 23.632208108901978
Epoch: 1, Steps: 154 | Train Loss: 2.245 Vali Loss: 2.136 Vali Acc: 0.315 Test Loss: 2.136 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9559155
	speed: 0.4844s/iter; left time: 2115.5711s
Epoch: 2 cost time: 22.850033283233643
Epoch: 2, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.113 Vali Acc: 0.321 Test Loss: 2.113 Test Acc: 0.321
Validation loss decreased (-0.315469 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6927360
	speed: 0.4613s/iter; left time: 1943.2767s
Epoch: 3 cost time: 20.71355128288269
Epoch: 3, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.090 Vali Acc: 0.331 Test Loss: 2.090 Test Acc: 0.331
Validation loss decreased (-0.320741 --> -0.330879).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2358618
	speed: 0.4347s/iter; left time: 1764.6440s
Epoch: 4 cost time: 18.01385807991028
Epoch: 4, Steps: 154 | Train Loss: 1.896 Vali Loss: 2.043 Vali Acc: 0.342 Test Loss: 2.043 Test Acc: 0.342
Validation loss decreased (-0.330879 --> -0.341829).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8982841
	speed: 0.4124s/iter; left time: 1610.2959s
Epoch: 5 cost time: 20.572147607803345
Epoch: 5, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.094 Vali Acc: 0.339 Test Loss: 2.094 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4037011
	speed: 0.4409s/iter; left time: 1653.8305s
Epoch: 6 cost time: 19.82186484336853
Epoch: 6, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.026 Vali Acc: 0.361 Test Loss: 2.026 Test Acc: 0.361
Validation loss decreased (-0.341829 --> -0.360888).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8061378
	speed: 0.4168s/iter; left time: 1499.2683s
Epoch: 7 cost time: 18.698237419128418
Epoch: 7, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.007 Vali Acc: 0.361 Test Loss: 2.007 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4157220
	speed: 0.4384s/iter; left time: 1509.5645s
Epoch: 8 cost time: 20.639667510986328
Epoch: 8, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.258 Vali Acc: 0.212 Test Loss: 2.258 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5565560
	speed: 0.4094s/iter; left time: 1346.3960s
Epoch: 9 cost time: 18.00007462501526
Epoch: 9, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.220 Vali Acc: 0.208 Test Loss: 2.220 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6038594
	speed: 0.3879s/iter; left time: 1216.0242s
Epoch: 10 cost time: 17.874834775924683
Epoch: 10, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.473 Vali Acc: 0.217 Test Loss: 2.473 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7828616
	speed: 0.4187s/iter; left time: 1248.1619s
Epoch: 11 cost time: 20.377060890197754
Epoch: 11, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.427 Vali Acc: 0.215 Test Loss: 2.427 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3690492
	speed: 0.4610s/iter; left time: 1303.3868s
Epoch: 12 cost time: 19.832497358322144
Epoch: 12, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.663 Vali Acc: 0.215 Test Loss: 2.663 Test Acc: 0.215
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.7142776
	speed: 0.4564s/iter; left time: 1219.8277s
Epoch: 13 cost time: 21.140226364135742
Epoch: 13, Steps: 154 | Train Loss: 1.438 Vali Loss: 3.092 Vali Acc: 0.131 Test Loss: 3.092 Test Acc: 0.131
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4567307
	speed: 0.4761s/iter; left time: 1199.3733s
Epoch: 14 cost time: 21.41448187828064
Epoch: 14, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.588 Vali Acc: 0.212 Test Loss: 2.588 Test Acc: 0.212
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0681061
	speed: 0.4913s/iter; left time: 1161.9160s
Epoch: 15 cost time: 21.620442867279053
Epoch: 15, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.003 Vali Acc: 0.205 Test Loss: 3.003 Test Acc: 0.205
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.5432969
	speed: 0.4668s/iter; left time: 1032.1585s
Epoch: 16 cost time: 20.4423725605011
Epoch: 16, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.201 Vali Acc: 0.084 Test Loss: 3.201 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3609083536090835
model parameter : 90638
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9862797
	speed: 0.1924s/iter; left time: 870.0118s
Epoch: 1 cost time: 28.718878269195557
Epoch: 1, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.121 Vali Acc: 0.315 Test Loss: 2.121 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0221057
	speed: 0.5139s/iter; left time: 2244.1462s
Epoch: 2 cost time: 25.388567209243774
Epoch: 2, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.127 Vali Acc: 0.327 Test Loss: 2.127 Test Acc: 0.327
Validation loss decreased (-0.315469 --> -0.326824).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9429572
	speed: 0.4415s/iter; left time: 1859.8767s
Epoch: 3 cost time: 22.351235389709473
Epoch: 3, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.096 Vali Acc: 0.340 Test Loss: 2.096 Test Acc: 0.340
Validation loss decreased (-0.326824 --> -0.340206).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7945192
	speed: 0.4454s/iter; left time: 1807.8929s
Epoch: 4 cost time: 22.748759746551514
Epoch: 4, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.116 Vali Acc: 0.341 Test Loss: 2.116 Test Acc: 0.341
Validation loss decreased (-0.340206 --> -0.340611).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1371040
	speed: 0.3925s/iter; left time: 1532.8333s
Epoch: 5 cost time: 18.67712140083313
Epoch: 5, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.040 Vali Acc: 0.350 Test Loss: 2.040 Test Acc: 0.350
Validation loss decreased (-0.340611 --> -0.349939).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5636355
	speed: 0.3978s/iter; left time: 1492.1553s
Epoch: 6 cost time: 20.253087997436523
Epoch: 6, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.068 Vali Acc: 0.350 Test Loss: 2.068 Test Acc: 0.350
Validation loss decreased (-0.349939 --> -0.350344).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1104984
	speed: 0.3933s/iter; left time: 1414.6420s
Epoch: 7 cost time: 18.76959538459778
Epoch: 7, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.115 Vali Acc: 0.341 Test Loss: 2.115 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4138762
	speed: 0.3639s/iter; left time: 1252.9218s
Epoch: 8 cost time: 16.733102083206177
Epoch: 8, Steps: 154 | Train Loss: 1.700 Vali Loss: 2.019 Vali Acc: 0.350 Test Loss: 2.019 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7115440
	speed: 0.3668s/iter; left time: 1206.3393s
Epoch: 9 cost time: 19.49008822441101
Epoch: 9, Steps: 154 | Train Loss: 1.652 Vali Loss: 1.996 Vali Acc: 0.375 Test Loss: 1.996 Test Acc: 0.375
Validation loss decreased (-0.350344 --> -0.375081).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.6160355
	speed: 0.4498s/iter; left time: 1410.1359s
Epoch: 10 cost time: 23.24491596221924
Epoch: 10, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.187 Vali Acc: 0.358 Test Loss: 2.187 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.8737409
	speed: 0.5965s/iter; left time: 1778.0734s
Epoch: 11 cost time: 28.496182918548584
Epoch: 11, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.073 Vali Acc: 0.371 Test Loss: 2.073 Test Acc: 0.371
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4188806
	speed: 0.5819s/iter; left time: 1644.9045s
Epoch: 12 cost time: 26.04612159729004
Epoch: 12, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.428 Vali Acc: 0.203 Test Loss: 2.428 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3239176
	speed: 0.6152s/iter; left time: 1644.4780s
Epoch: 13 cost time: 28.249233722686768
Epoch: 13, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.122 Vali Acc: 0.379 Test Loss: 2.122 Test Acc: 0.379
Validation loss decreased (-0.375081 --> -0.379135).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.6638385
	speed: 0.6007s/iter; left time: 1513.0765s
Epoch: 14 cost time: 26.71707320213318
Epoch: 14, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.019 Vali Acc: 0.389 Test Loss: 2.019 Test Acc: 0.389
Validation loss decreased (-0.379135 --> -0.388869).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4582949
	speed: 0.5716s/iter; left time: 1351.9256s
Epoch: 15 cost time: 26.312907934188843
Epoch: 15, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.766 Vali Acc: 0.141 Test Loss: 2.766 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.3526986
	speed: 0.6037s/iter; left time: 1334.8019s
Epoch: 16 cost time: 26.730076551437378
Epoch: 16, Steps: 154 | Train Loss: 1.445 Vali Loss: 4.735 Vali Acc: 0.117 Test Loss: 4.735 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.8830258
	speed: 0.5956s/iter; left time: 1225.1700s
Epoch: 17 cost time: 25.291470766067505
Epoch: 17, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.395 Vali Acc: 0.210 Test Loss: 2.395 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.4908258
	speed: 0.5361s/iter; left time: 1020.2340s
Epoch: 18 cost time: 22.549455881118774
Epoch: 18, Steps: 154 | Train Loss: 1.400 Vali Loss: 2.236 Vali Acc: 0.391 Test Loss: 2.236 Test Acc: 0.391
Validation loss decreased (-0.388869 --> -0.390894).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0217708
	speed: 0.5314s/iter; left time: 929.3980s
Epoch: 19 cost time: 23.015079498291016
Epoch: 19, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.029 Vali Acc: 0.272 Test Loss: 2.029 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.9941022
	speed: 0.5377s/iter; left time: 857.7005s
Epoch: 20 cost time: 24.453230381011963
Epoch: 20, Steps: 154 | Train Loss: 1.355 Vali Loss: 2.193 Vali Acc: 0.373 Test Loss: 2.193 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1788800
	speed: 0.5226s/iter; left time: 753.0198s
Epoch: 21 cost time: 22.16658616065979
Epoch: 21, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.348 Vali Acc: 0.375 Test Loss: 2.348 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.3206044
	speed: 0.5131s/iter; left time: 660.3192s
Epoch: 22 cost time: 24.309160709381104
Epoch: 22, Steps: 154 | Train Loss: 1.307 Vali Loss: 2.280 Vali Acc: 0.351 Test Loss: 2.280 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 1.1744616
	speed: 0.5431s/iter; left time: 615.3819s
Epoch: 23 cost time: 23.83996081352234
Epoch: 23, Steps: 154 | Train Loss: 1.299 Vali Loss: 2.361 Vali Acc: 0.384 Test Loss: 2.361 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.3079138
	speed: 0.5293s/iter; left time: 518.1840s
Epoch: 24 cost time: 23.031581163406372
Epoch: 24, Steps: 154 | Train Loss: 1.281 Vali Loss: 2.081 Vali Acc: 0.404 Test Loss: 2.081 Test Acc: 0.404
Validation loss decreased (-0.390894 --> -0.403872).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.8927410
	speed: 0.4969s/iter; left time: 409.9670s
Epoch: 25 cost time: 22.286922693252563
Epoch: 25, Steps: 154 | Train Loss: 1.254 Vali Loss: 2.274 Vali Acc: 0.412 Test Loss: 2.274 Test Acc: 0.412
Validation loss decreased (-0.403872 --> -0.411575).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0456500
	speed: 0.5675s/iter; left time: 380.7838s
Epoch: 26 cost time: 26.14331865310669
Epoch: 26, Steps: 154 | Train Loss: 1.223 Vali Loss: 2.370 Vali Acc: 0.383 Test Loss: 2.370 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.0932938
	speed: 0.5957s/iter; left time: 307.9683s
Epoch: 27 cost time: 25.181843042373657
Epoch: 27, Steps: 154 | Train Loss: 1.228 Vali Loss: 2.495 Vali Acc: 0.393 Test Loss: 2.495 Test Acc: 0.393
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.0976275
	speed: 0.5715s/iter; left time: 207.4706s
Epoch: 28 cost time: 24.84989356994629
Epoch: 28, Steps: 154 | Train Loss: 1.197 Vali Loss: 2.424 Vali Acc: 0.388 Test Loss: 2.424 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.2491581
	speed: 0.5719s/iter; left time: 119.5272s
Epoch: 29 cost time: 25.53425097465515
Epoch: 29, Steps: 154 | Train Loss: 1.196 Vali Loss: 3.400 Vali Acc: 0.127 Test Loss: 3.400 Test Acc: 0.127
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 1.3219136
	speed: 0.6130s/iter; left time: 33.7148s
Epoch: 30 cost time: 27.054996490478516
Epoch: 30, Steps: 154 | Train Loss: 1.189 Vali Loss: 3.799 Vali Acc: 0.336 Test Loss: 3.799 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4115977291159773
model parameter : 297678
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0281603
	speed: 0.2118s/iter; left time: 957.5120s
Epoch: 1 cost time: 31.96856713294983
Epoch: 1, Steps: 154 | Train Loss: 2.259 Vali Loss: 2.130 Vali Acc: 0.315 Test Loss: 2.130 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9785080
	speed: 0.5900s/iter; left time: 2576.5029s
Epoch: 2 cost time: 29.248432874679565
Epoch: 2, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.095 Vali Acc: 0.318 Test Loss: 2.095 Test Acc: 0.318
Validation loss decreased (-0.314658 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7570419
	speed: 0.6385s/iter; left time: 2690.1822s
Epoch: 3 cost time: 30.806148529052734
Epoch: 3, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.059 Vali Acc: 0.329 Test Loss: 2.059 Test Acc: 0.329
Validation loss decreased (-0.318308 --> -0.328852).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2983227
	speed: 0.5482s/iter; left time: 2225.2456s
Epoch: 4 cost time: 25.454389095306396
Epoch: 4, Steps: 154 | Train Loss: 1.915 Vali Loss: 2.195 Vali Acc: 0.181 Test Loss: 2.195 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9248298
	speed: 0.5351s/iter; left time: 2089.5797s
Epoch: 5 cost time: 25.85758686065674
Epoch: 5, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.048 Vali Acc: 0.343 Test Loss: 2.048 Test Acc: 0.343
Validation loss decreased (-0.328852 --> -0.343451).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5083368
	speed: 0.5418s/iter; left time: 2032.1143s
Epoch: 6 cost time: 26.08528971672058
Epoch: 6, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.076 Vali Acc: 0.343 Test Loss: 2.076 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6753461
	speed: 0.4389s/iter; left time: 1578.6219s
Epoch: 7 cost time: 16.210938692092896
Epoch: 7, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.145 Vali Acc: 0.348 Test Loss: 2.145 Test Acc: 0.348
Validation loss decreased (-0.343451 --> -0.347505).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6287751
	speed: 0.5012s/iter; left time: 1725.4793s
Epoch: 8 cost time: 23.654584646224976
Epoch: 8, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.006 Vali Acc: 0.383 Test Loss: 2.006 Test Acc: 0.383
Validation loss decreased (-0.347505 --> -0.382786).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3462994
	speed: 0.5319s/iter; left time: 1749.5766s
Epoch: 9 cost time: 24.367814540863037
Epoch: 9, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.632 Vali Acc: 0.196 Test Loss: 2.632 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6121846
	speed: 0.4946s/iter; left time: 1550.6661s
Epoch: 10 cost time: 22.59687089920044
Epoch: 10, Steps: 154 | Train Loss: 1.572 Vali Loss: 2.244 Vali Acc: 0.385 Test Loss: 2.244 Test Acc: 0.385
Validation loss decreased (-0.382786 --> -0.384811).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6854663
	speed: 0.5171s/iter; left time: 1541.3894s
Epoch: 11 cost time: 24.515568733215332
Epoch: 11, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.484 Vali Acc: 0.124 Test Loss: 2.484 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4410186
	speed: 0.5804s/iter; left time: 1640.8432s
Epoch: 12 cost time: 25.189653635025024
Epoch: 12, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.475 Vali Acc: 0.135 Test Loss: 2.475 Test Acc: 0.135
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7515711
	speed: 0.5800s/iter; left time: 1550.3449s
Epoch: 13 cost time: 24.704394817352295
Epoch: 13, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.193 Vali Acc: 0.380 Test Loss: 2.193 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6874435
	speed: 0.5599s/iter; left time: 1410.3612s
Epoch: 14 cost time: 24.30233335494995
Epoch: 14, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.461 Vali Acc: 0.380 Test Loss: 2.461 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1327046
	speed: 0.5572s/iter; left time: 1317.8523s
Epoch: 15 cost time: 23.571995735168457
Epoch: 15, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.335 Vali Acc: 0.236 Test Loss: 2.335 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5980475
	speed: 0.5136s/iter; left time: 1135.5125s
Epoch: 16 cost time: 24.709847927093506
Epoch: 16, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.469 Vali Acc: 0.178 Test Loss: 2.469 Test Acc: 0.178
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5661740
	speed: 0.5876s/iter; left time: 1208.7000s
Epoch: 17 cost time: 24.785109996795654
Epoch: 17, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.571 Vali Acc: 0.232 Test Loss: 2.571 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.4427083
	speed: 0.5786s/iter; left time: 1101.1706s
Epoch: 18 cost time: 25.363248348236084
Epoch: 18, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.474 Vali Acc: 0.167 Test Loss: 2.474 Test Acc: 0.167
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.9050589
	speed: 0.5933s/iter; left time: 1037.6444s
Epoch: 19 cost time: 24.738192081451416
Epoch: 19, Steps: 154 | Train Loss: 1.373 Vali Loss: 5.120 Vali Acc: 0.095 Test Loss: 5.120 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2267216
	speed: 0.5434s/iter; left time: 866.6686s
Epoch: 20 cost time: 21.2273211479187
Epoch: 20, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.304 Vali Acc: 0.393 Test Loss: 2.304 Test Acc: 0.393
Validation loss decreased (-0.384811 --> -0.392515).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.6514599
	speed: 0.5203s/iter; left time: 749.7398s
Epoch: 21 cost time: 22.679092407226562
Epoch: 21, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.414 Vali Acc: 0.402 Test Loss: 2.414 Test Acc: 0.402
Validation loss decreased (-0.392515 --> -0.401841).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.3995433
	speed: 0.5361s/iter; left time: 690.0019s
Epoch: 22 cost time: 23.117297887802124
Epoch: 22, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.467 Vali Acc: 0.354 Test Loss: 2.467 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.0519300
	speed: 0.5434s/iter; left time: 615.6938s
Epoch: 23 cost time: 23.277833223342896
Epoch: 23, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.416 Vali Acc: 0.376 Test Loss: 2.416 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.1077139
	speed: 0.5155s/iter; left time: 504.7086s
Epoch: 24 cost time: 20.86027503013611
Epoch: 24, Steps: 154 | Train Loss: 1.303 Vali Loss: 2.059 Vali Acc: 0.420 Test Loss: 2.059 Test Acc: 0.420
Validation loss decreased (-0.401841 --> -0.419687).  Saving model ...
	iters: 100, epoch: 25 | loss: 1.4497533
	speed: 0.5098s/iter; left time: 420.5997s
Epoch: 25 cost time: 21.641583681106567
Epoch: 25, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.210 Vali Acc: 0.407 Test Loss: 2.210 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1940010
	speed: 0.4432s/iter; left time: 297.4110s
Epoch: 26 cost time: 21.310697078704834
Epoch: 26, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.323 Vali Acc: 0.378 Test Loss: 2.323 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 1.6406844
	speed: 0.5102s/iter; left time: 263.7753s
Epoch: 27 cost time: 21.973222970962524
Epoch: 27, Steps: 154 | Train Loss: 1.263 Vali Loss: 2.502 Vali Acc: 0.265 Test Loss: 2.502 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.7077484
	speed: 0.5182s/iter; left time: 188.1096s
Epoch: 28 cost time: 22.513080835342407
Epoch: 28, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.646 Vali Acc: 0.314 Test Loss: 2.646 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 1.3267970
	speed: 0.5549s/iter; left time: 115.9655s
Epoch: 29 cost time: 23.147327661514282
Epoch: 29, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.220 Vali Acc: 0.123 Test Loss: 3.220 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.2358656
	speed: 0.5439s/iter; left time: 29.9161s
Epoch: 30 cost time: 22.59033441543579
Epoch: 30, Steps: 154 | Train Loss: 1.224 Vali Loss: 2.424 Vali Acc: 0.411 Test Loss: 2.424 Test Acc: 0.411
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4197080291970803
model parameter : 90638
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6189858
	speed: 1.5479s/iter; left time: 6998.0978s
Epoch: 1 cost time: 236.29352569580078
Epoch: 1, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.132 Vali Acc: 0.328 Test Loss: 2.132 Test Acc: 0.328
Validation loss decreased (inf --> -0.328040).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3815010
	speed: 3.9395s/iter; left time: 17203.8144s
Epoch: 2 cost time: 211.12675189971924
Epoch: 2, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.218 Vali Acc: 0.345 Test Loss: 2.218 Test Acc: 0.345
Validation loss decreased (-0.328040 --> -0.345071).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3533998
	speed: 3.4977s/iter; left time: 14735.6028s
Epoch: 3 cost time: 201.19479656219482
Epoch: 3, Steps: 154 | Train Loss: 1.816 Vali Loss: 2.817 Vali Acc: 0.082 Test Loss: 2.817 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7845242
	speed: 3.9760s/iter; left time: 16138.4884s
Epoch: 4 cost time: 226.23709559440613
Epoch: 4, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.562 Vali Acc: 0.315 Test Loss: 2.562 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.8070792
	speed: 3.9093s/iter; left time: 15265.9422s
Epoch: 5 cost time: 209.41373586654663
Epoch: 5, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.598 Vali Acc: 0.194 Test Loss: 2.598 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.0002775
	speed: 3.5242s/iter; left time: 13219.1051s
Epoch: 6 cost time: 195.9988398551941
Epoch: 6, Steps: 154 | Train Loss: 1.512 Vali Loss: 3.409 Vali Acc: 0.075 Test Loss: 3.409 Test Acc: 0.075
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.6398909
	speed: 3.7878s/iter; left time: 13624.5653s
Epoch: 7 cost time: 225.28469944000244
Epoch: 7, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.617 Vali Acc: 0.366 Test Loss: 3.617 Test Acc: 0.366
Validation loss decreased (-0.345071 --> -0.365738).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1392871
	speed: 3.8054s/iter; left time: 13101.9069s
Epoch: 8 cost time: 199.2835066318512
Epoch: 8, Steps: 154 | Train Loss: 1.368 Vali Loss: 7.893 Vali Acc: 0.090 Test Loss: 7.893 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8041718
	speed: 3.1757s/iter; left time: 10444.8993s
Epoch: 9 cost time: 184.2324800491333
Epoch: 9, Steps: 154 | Train Loss: 1.297 Vali Loss: 4.883 Vali Acc: 0.086 Test Loss: 4.883 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1347715
	speed: 3.3137s/iter; left time: 10388.4468s
Epoch: 10 cost time: 205.52091550827026
Epoch: 10, Steps: 154 | Train Loss: 1.240 Vali Loss: 3.858 Vali Acc: 0.210 Test Loss: 3.858 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1635776
	speed: 3.7723s/iter; left time: 11245.2540s
Epoch: 11 cost time: 204.9274296760559
Epoch: 11, Steps: 154 | Train Loss: 1.196 Vali Loss: 2.971 Vali Acc: 0.259 Test Loss: 2.971 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4306897
	speed: 3.3884s/iter; left time: 9578.9261s
Epoch: 12 cost time: 194.78275966644287
Epoch: 12, Steps: 154 | Train Loss: 1.162 Vali Loss: 3.668 Vali Acc: 0.173 Test Loss: 3.668 Test Acc: 0.173
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.6911555
	speed: 3.4337s/iter; left time: 9178.1593s
Epoch: 13 cost time: 200.59266090393066
Epoch: 13, Steps: 154 | Train Loss: 1.125 Vali Loss: 3.747 Vali Acc: 0.376 Test Loss: 3.747 Test Acc: 0.376
Validation loss decreased (-0.365738 --> -0.375469).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7792609
	speed: 3.6013s/iter; left time: 9071.7896s
Epoch: 14 cost time: 207.00274515151978
Epoch: 14, Steps: 154 | Train Loss: 1.072 Vali Loss: 2.616 Vali Acc: 0.396 Test Loss: 2.616 Test Acc: 0.396
Validation loss decreased (-0.375469 --> -0.396162).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2504776
	speed: 3.3771s/iter; left time: 7986.8979s
Epoch: 15 cost time: 183.09282517433167
Epoch: 15, Steps: 154 | Train Loss: 1.020 Vali Loss: 4.150 Vali Acc: 0.182 Test Loss: 4.150 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2589463
	speed: 3.4870s/iter; left time: 7709.7614s
Epoch: 16 cost time: 199.38429355621338
Epoch: 16, Steps: 154 | Train Loss: 0.960 Vali Loss: 4.405 Vali Acc: 0.363 Test Loss: 4.405 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.8169430
	speed: 3.3962s/iter; left time: 6986.0480s
Epoch: 17 cost time: 196.1734402179718
Epoch: 17, Steps: 154 | Train Loss: 0.944 Vali Loss: 4.674 Vali Acc: 0.217 Test Loss: 4.674 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.7596443
	speed: 3.1826s/iter; left time: 6056.4765s
Epoch: 18 cost time: 183.3427836894989
Epoch: 18, Steps: 154 | Train Loss: 0.917 Vali Loss: 3.050 Vali Acc: 0.398 Test Loss: 3.050 Test Acc: 0.398
Validation loss decreased (-0.396162 --> -0.397780).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.7948859
	speed: 3.5121s/iter; left time: 6142.6572s
Epoch: 19 cost time: 192.06488943099976
Epoch: 19, Steps: 154 | Train Loss: 0.887 Vali Loss: 4.848 Vali Acc: 0.203 Test Loss: 4.848 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.9595510
	speed: 3.0201s/iter; left time: 4816.9964s
Epoch: 20 cost time: 188.94220304489136
Epoch: 20, Steps: 154 | Train Loss: 0.871 Vali Loss: 5.578 Vali Acc: 0.093 Test Loss: 5.578 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.7586547
	speed: 3.4285s/iter; left time: 4940.4713s
Epoch: 21 cost time: 176.78462886810303
Epoch: 21, Steps: 154 | Train Loss: 0.831 Vali Loss: 4.252 Vali Acc: 0.376 Test Loss: 4.252 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.7518952
	speed: 3.1445s/iter; left time: 4046.9907s
Epoch: 22 cost time: 193.03027892112732
Epoch: 22, Steps: 154 | Train Loss: 0.794 Vali Loss: 3.132 Vali Acc: 0.385 Test Loss: 3.132 Test Acc: 0.385
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.4320523
	speed: 3.4158s/iter; left time: 3870.0882s
Epoch: 23 cost time: 180.2028534412384
Epoch: 23, Steps: 154 | Train Loss: 0.714 Vali Loss: 3.044 Vali Acc: 0.353 Test Loss: 3.044 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.5848151
	speed: 3.1687s/iter; left time: 3102.2021s
Epoch: 24 cost time: 187.46810221672058
Epoch: 24, Steps: 154 | Train Loss: 0.717 Vali Loss: 4.407 Vali Acc: 0.278 Test Loss: 4.407 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6670655
	speed: 3.0710s/iter; left time: 2533.6039s
Epoch: 25 cost time: 171.15084958076477
Epoch: 25, Steps: 154 | Train Loss: 0.691 Vali Loss: 5.242 Vali Acc: 0.308 Test Loss: 5.242 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.7931297
	speed: 3.2433s/iter; left time: 2176.2373s
Epoch: 26 cost time: 180.20738887786865
Epoch: 26, Steps: 154 | Train Loss: 0.667 Vali Loss: 4.643 Vali Acc: 0.255 Test Loss: 4.643 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.5009776
	speed: 2.9177s/iter; left time: 1508.4581s
Epoch: 27 cost time: 165.5105803012848
Epoch: 27, Steps: 154 | Train Loss: 0.657 Vali Loss: 4.966 Vali Acc: 0.345 Test Loss: 4.966 Test Acc: 0.345
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.7367572
	speed: 3.0236s/iter; left time: 1097.5813s
Epoch: 28 cost time: 163.98209261894226
Epoch: 28, Steps: 154 | Train Loss: 0.635 Vali Loss: 4.612 Vali Acc: 0.198 Test Loss: 4.612 Test Acc: 0.198
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3978102189781022
model parameter : 56304398
model size : 217.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2852881
	speed: 0.4255s/iter; left time: 1923.7132s
Epoch: 1 cost time: 66.14338111877441
Epoch: 1, Steps: 154 | Train Loss: 2.064 Vali Loss: 2.038 Vali Acc: 0.348 Test Loss: 2.038 Test Acc: 0.348
Validation loss decreased (inf --> -0.348317).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4116220
	speed: 1.2571s/iter; left time: 5489.8665s
Epoch: 2 cost time: 67.2721004486084
Epoch: 2, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.131 Vali Acc: 0.343 Test Loss: 2.131 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0485954
	speed: 1.1540s/iter; left time: 4861.9382s
Epoch: 3 cost time: 57.67264103889465
Epoch: 3, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.368 Vali Acc: 0.339 Test Loss: 2.368 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.4713243
	speed: 1.0436s/iter; left time: 4235.8458s
Epoch: 4 cost time: 56.159541845321655
Epoch: 4, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.539 Vali Acc: 0.363 Test Loss: 2.539 Test Acc: 0.363
Validation loss decreased (-0.348317 --> -0.362911).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8684027
	speed: 0.9072s/iter; left time: 3542.6386s
Epoch: 5 cost time: 42.36671042442322
Epoch: 5, Steps: 154 | Train Loss: 1.543 Vali Loss: 3.538 Vali Acc: 0.083 Test Loss: 3.538 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4839522
	speed: 1.1257s/iter; left time: 4222.3830s
Epoch: 6 cost time: 60.41709113121033
Epoch: 6, Steps: 154 | Train Loss: 1.509 Vali Loss: 5.099 Vali Acc: 0.095 Test Loss: 5.099 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5424895
	speed: 1.1859s/iter; left time: 4265.6424s
Epoch: 7 cost time: 63.76707410812378
Epoch: 7, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.758 Vali Acc: 0.197 Test Loss: 2.758 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3959545
	speed: 1.0876s/iter; left time: 3744.5927s
Epoch: 8 cost time: 57.75641632080078
Epoch: 8, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.672 Vali Acc: 0.388 Test Loss: 2.672 Test Acc: 0.388
Validation loss decreased (-0.362911 --> -0.388051).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5062191
	speed: 0.9695s/iter; left time: 3188.6933s
Epoch: 9 cost time: 49.346630573272705
Epoch: 9, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.318 Vali Acc: 0.167 Test Loss: 3.318 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2173657
	speed: 0.9765s/iter; left time: 3061.2418s
Epoch: 10 cost time: 52.12546968460083
Epoch: 10, Steps: 154 | Train Loss: 1.211 Vali Loss: 3.561 Vali Acc: 0.123 Test Loss: 3.561 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8340963
	speed: 1.0258s/iter; left time: 3057.8300s
Epoch: 11 cost time: 58.54752779006958
Epoch: 11, Steps: 154 | Train Loss: 1.070 Vali Loss: 4.120 Vali Acc: 0.131 Test Loss: 4.120 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5547167
	speed: 1.0779s/iter; left time: 3047.1314s
Epoch: 12 cost time: 56.84038257598877
Epoch: 12, Steps: 154 | Train Loss: 1.079 Vali Loss: 5.295 Vali Acc: 0.111 Test Loss: 5.295 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7881221
	speed: 0.9226s/iter; left time: 2466.0532s
Epoch: 13 cost time: 46.76306080818176
Epoch: 13, Steps: 154 | Train Loss: 1.004 Vali Loss: 3.011 Vali Acc: 0.392 Test Loss: 3.011 Test Acc: 0.392
Validation loss decreased (-0.388051 --> -0.391697).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.1880972
	speed: 0.9064s/iter; left time: 2283.2308s
Epoch: 14 cost time: 56.50270652770996
Epoch: 14, Steps: 154 | Train Loss: 0.943 Vali Loss: 9.284 Vali Acc: 0.131 Test Loss: 9.284 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.3590569
	speed: 0.9949s/iter; left time: 2352.9712s
Epoch: 15 cost time: 57.422951459884644
Epoch: 15, Steps: 154 | Train Loss: 0.898 Vali Loss: 5.179 Vali Acc: 0.243 Test Loss: 5.179 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.9301333
	speed: 1.1513s/iter; left time: 2545.4355s
Epoch: 16 cost time: 58.86181616783142
Epoch: 16, Steps: 154 | Train Loss: 0.871 Vali Loss: 5.064 Vali Acc: 0.096 Test Loss: 5.064 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.8463299
	speed: 1.0940s/iter; left time: 2250.4169s
Epoch: 17 cost time: 54.74667763710022
Epoch: 17, Steps: 154 | Train Loss: 0.815 Vali Loss: 11.175 Vali Acc: 0.134 Test Loss: 11.175 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.8705849
	speed: 0.9220s/iter; left time: 1754.4835s
Epoch: 18 cost time: 51.59823179244995
Epoch: 18, Steps: 154 | Train Loss: 0.746 Vali Loss: 3.833 Vali Acc: 0.372 Test Loss: 3.833 Test Acc: 0.372
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.6512905
	speed: 0.9261s/iter; left time: 1619.7923s
Epoch: 19 cost time: 50.83945631980896
Epoch: 19, Steps: 154 | Train Loss: 0.714 Vali Loss: 7.298 Vali Acc: 0.085 Test Loss: 7.298 Test Acc: 0.085
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.1815917
	speed: 1.0373s/iter; left time: 1654.5217s
Epoch: 20 cost time: 60.22269082069397
Epoch: 20, Steps: 154 | Train Loss: 0.713 Vali Loss: 4.985 Vali Acc: 0.135 Test Loss: 4.985 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8496729
	speed: 1.0607s/iter; left time: 1528.5254s
Epoch: 21 cost time: 56.846967935562134
Epoch: 21, Steps: 154 | Train Loss: 0.649 Vali Loss: 8.136 Vali Acc: 0.097 Test Loss: 8.136 Test Acc: 0.097
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.5031542
	speed: 1.0068s/iter; left time: 1295.8038s
Epoch: 22 cost time: 48.008801221847534
Epoch: 22, Steps: 154 | Train Loss: 0.629 Vali Loss: 4.507 Vali Acc: 0.282 Test Loss: 4.507 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.5851262
	speed: 0.9159s/iter; left time: 1037.6815s
Epoch: 23 cost time: 50.2262909412384
Epoch: 23, Steps: 154 | Train Loss: 0.571 Vali Loss: 3.957 Vali Acc: 0.312 Test Loss: 3.957 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 16587278
model size : 65.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6291003
	speed: 0.6293s/iter; left time: 2844.9158s
Epoch: 1 cost time: 96.1129503250122
Epoch: 1, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.090 Vali Acc: 0.333 Test Loss: 2.090 Test Acc: 0.333
Validation loss decreased (inf --> -0.332501).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3196390
	speed: 1.9584s/iter; left time: 8552.4969s
Epoch: 2 cost time: 135.4141297340393
Epoch: 2, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.144 Vali Acc: 0.345 Test Loss: 2.144 Test Acc: 0.345
Validation loss decreased (-0.332501 --> -0.345477).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0670993
	speed: 2.2967s/iter; left time: 9676.1750s
Epoch: 3 cost time: 127.79349565505981
Epoch: 3, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.168 Vali Acc: 0.361 Test Loss: 2.168 Test Acc: 0.361
Validation loss decreased (-0.345477 --> -0.360481).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7878481
	speed: 2.2811s/iter; left time: 9258.9523s
Epoch: 4 cost time: 131.51621985435486
Epoch: 4, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.615 Vali Acc: 0.176 Test Loss: 2.615 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7217869
	speed: 2.1993s/iter; left time: 8588.3470s
Epoch: 5 cost time: 119.65279221534729
Epoch: 5, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.534 Vali Acc: 0.363 Test Loss: 2.534 Test Acc: 0.363
Validation loss decreased (-0.360481 --> -0.362505).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2572076
	speed: 2.2383s/iter; left time: 8395.9771s
Epoch: 6 cost time: 125.94089555740356
Epoch: 6, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.318 Vali Acc: 0.386 Test Loss: 2.318 Test Acc: 0.386
Validation loss decreased (-0.362505 --> -0.386027).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7920061
	speed: 2.4505s/iter; left time: 8814.3505s
Epoch: 7 cost time: 145.56663513183594
Epoch: 7, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.146 Vali Acc: 0.392 Test Loss: 2.146 Test Acc: 0.392
Validation loss decreased (-0.386027 --> -0.391706).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8929709
	speed: 2.3774s/iter; left time: 8185.2548s
Epoch: 8 cost time: 133.92918467521667
Epoch: 8, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.460 Vali Acc: 0.394 Test Loss: 2.460 Test Acc: 0.394
Validation loss decreased (-0.391706 --> -0.394136).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8761652
	speed: 2.2924s/iter; left time: 7539.5725s
Epoch: 9 cost time: 130.1890585422516
Epoch: 9, Steps: 154 | Train Loss: 1.332 Vali Loss: 10.976 Vali Acc: 0.080 Test Loss: 10.976 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2380799
	speed: 2.3945s/iter; left time: 7506.6694s
Epoch: 10 cost time: 131.23589253425598
Epoch: 10, Steps: 154 | Train Loss: 1.292 Vali Loss: 4.055 Vali Acc: 0.205 Test Loss: 4.055 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1979641
	speed: 2.2487s/iter; left time: 6703.4652s
Epoch: 11 cost time: 129.32424139976501
Epoch: 11, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.596 Vali Acc: 0.146 Test Loss: 3.596 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2236860
	speed: 2.2925s/iter; left time: 6480.9168s
Epoch: 12 cost time: 134.22503399848938
Epoch: 12, Steps: 154 | Train Loss: 1.219 Vali Loss: 3.162 Vali Acc: 0.370 Test Loss: 3.162 Test Acc: 0.370
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9434823
	speed: 2.3682s/iter; left time: 6330.1406s
Epoch: 13 cost time: 140.0556993484497
Epoch: 13, Steps: 154 | Train Loss: 1.185 Vali Loss: 5.627 Vali Acc: 0.085 Test Loss: 5.627 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.6478012
	speed: 2.3148s/iter; left time: 5831.0830s
Epoch: 14 cost time: 129.4762065410614
Epoch: 14, Steps: 154 | Train Loss: 1.074 Vali Loss: 2.865 Vali Acc: 0.380 Test Loss: 2.865 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.6994717
	speed: 2.3801s/iter; left time: 5628.8364s
Epoch: 15 cost time: 130.48466038703918
Epoch: 15, Steps: 154 | Train Loss: 1.087 Vali Loss: 2.625 Vali Acc: 0.389 Test Loss: 2.625 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.8165712
	speed: 2.2649s/iter; left time: 5007.7363s
Epoch: 16 cost time: 132.77019691467285
Epoch: 16, Steps: 154 | Train Loss: 0.997 Vali Loss: 3.536 Vali Acc: 0.124 Test Loss: 3.536 Test Acc: 0.124
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.5110084
	speed: 2.1978s/iter; left time: 4520.9755s
Epoch: 17 cost time: 129.30945253372192
Epoch: 17, Steps: 154 | Train Loss: 1.000 Vali Loss: 5.397 Vali Acc: 0.211 Test Loss: 5.397 Test Acc: 0.211
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.6340852
	speed: 2.1939s/iter; left time: 4175.0641s
Epoch: 18 cost time: 121.04123592376709
Epoch: 18, Steps: 154 | Train Loss: 0.963 Vali Loss: 4.236 Vali Acc: 0.191 Test Loss: 4.236 Test Acc: 0.191
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39416058394160586
model parameter : 56304398
model size : 217.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3422258
	speed: 0.3082s/iter; left time: 1393.5886s
Epoch: 1 cost time: 46.57738471031189
Epoch: 1, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.058 Vali Acc: 0.346 Test Loss: 2.058 Test Acc: 0.346
Validation loss decreased (inf --> -0.346289).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2663445
	speed: 0.8430s/iter; left time: 3681.4084s
Epoch: 2 cost time: 44.75718808174133
Epoch: 2, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.547 Vali Acc: 0.350 Test Loss: 2.547 Test Acc: 0.350
Validation loss decreased (-0.346289 --> -0.350339).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9913434
	speed: 0.8827s/iter; left time: 3718.9003s
Epoch: 3 cost time: 45.34875249862671
Epoch: 3, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.104 Vali Acc: 0.352 Test Loss: 2.104 Test Acc: 0.352
Validation loss decreased (-0.350339 --> -0.352371).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2627858
	speed: 0.8554s/iter; left time: 3472.0811s
Epoch: 4 cost time: 44.23805522918701
Epoch: 4, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.404 Vali Acc: 0.369 Test Loss: 2.404 Test Acc: 0.369
Validation loss decreased (-0.352371 --> -0.368995).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1509509
	speed: 0.8636s/iter; left time: 3372.2726s
Epoch: 5 cost time: 44.35505962371826
Epoch: 5, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.788 Vali Acc: 0.083 Test Loss: 3.788 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5198438
	speed: 0.8687s/iter; left time: 3258.3669s
Epoch: 6 cost time: 45.21012234687805
Epoch: 6, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.482 Vali Acc: 0.212 Test Loss: 2.482 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5263427
	speed: 0.9908s/iter; left time: 3564.0342s
Epoch: 7 cost time: 52.20968055725098
Epoch: 7, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.816 Vali Acc: 0.237 Test Loss: 2.816 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5212970
	speed: 1.0360s/iter; left time: 3567.1081s
Epoch: 8 cost time: 53.88080811500549
Epoch: 8, Steps: 154 | Train Loss: 1.344 Vali Loss: 3.084 Vali Acc: 0.377 Test Loss: 3.084 Test Acc: 0.377
Validation loss decreased (-0.368995 --> -0.377098).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7300978
	speed: 1.0400s/iter; left time: 3420.4101s
Epoch: 9 cost time: 49.84979772567749
Epoch: 9, Steps: 154 | Train Loss: 1.291 Vali Loss: 4.334 Vali Acc: 0.204 Test Loss: 4.334 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2969983
	speed: 0.9813s/iter; left time: 3076.2805s
Epoch: 10 cost time: 49.94951796531677
Epoch: 10, Steps: 154 | Train Loss: 1.250 Vali Loss: 6.763 Vali Acc: 0.079 Test Loss: 6.763 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.9809393
	speed: 0.9846s/iter; left time: 2935.0826s
Epoch: 11 cost time: 50.92438316345215
Epoch: 11, Steps: 154 | Train Loss: 1.105 Vali Loss: 5.319 Vali Acc: 0.108 Test Loss: 5.319 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5386368
	speed: 1.0399s/iter; left time: 2939.8016s
Epoch: 12 cost time: 51.98012328147888
Epoch: 12, Steps: 154 | Train Loss: 1.114 Vali Loss: 4.679 Vali Acc: 0.115 Test Loss: 4.679 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6817876
	speed: 1.0225s/iter; left time: 2733.0267s
Epoch: 13 cost time: 51.98591375350952
Epoch: 13, Steps: 154 | Train Loss: 1.056 Vali Loss: 7.266 Vali Acc: 0.089 Test Loss: 7.266 Test Acc: 0.089
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.5012414
	speed: 0.9080s/iter; left time: 2287.3496s
Epoch: 14 cost time: 43.18478059768677
Epoch: 14, Steps: 154 | Train Loss: 0.996 Vali Loss: 11.216 Vali Acc: 0.102 Test Loss: 11.216 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1745601
	speed: 0.9137s/iter; left time: 2160.9863s
Epoch: 15 cost time: 44.55027627944946
Epoch: 15, Steps: 154 | Train Loss: 0.946 Vali Loss: 10.113 Vali Acc: 0.090 Test Loss: 10.113 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.7428541
	speed: 0.8968s/iter; left time: 1982.8187s
Epoch: 16 cost time: 47.514628648757935
Epoch: 16, Steps: 154 | Train Loss: 0.914 Vali Loss: 8.761 Vali Acc: 0.081 Test Loss: 8.761 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.7733236
	speed: 0.8902s/iter; left time: 1831.1662s
Epoch: 17 cost time: 46.240838050842285
Epoch: 17, Steps: 154 | Train Loss: 0.884 Vali Loss: 5.731 Vali Acc: 0.204 Test Loss: 5.731 Test Acc: 0.204
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.6452195
	speed: 0.8473s/iter; left time: 1612.4899s
Epoch: 18 cost time: 40.81340169906616
Epoch: 18, Steps: 154 | Train Loss: 0.827 Vali Loss: 7.881 Vali Acc: 0.109 Test Loss: 7.881 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 16587278
model size : 65.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6051141
	speed: 0.4580s/iter; left time: 2070.5539s
Epoch: 1 cost time: 71.76461291313171
Epoch: 1, Steps: 154 | Train Loss: 2.101 Vali Loss: 2.186 Vali Acc: 0.325 Test Loss: 2.186 Test Acc: 0.325
Validation loss decreased (inf --> -0.325201).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3167045
	speed: 1.2611s/iter; left time: 5507.2432s
Epoch: 2 cost time: 68.14136004447937
Epoch: 2, Steps: 154 | Train Loss: 1.903 Vali Loss: 2.072 Vali Acc: 0.342 Test Loss: 2.072 Test Acc: 0.342
Validation loss decreased (-0.325201 --> -0.341828).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.2579994
	speed: 1.1927s/iter; left time: 5024.6481s
Epoch: 3 cost time: 65.78963804244995
Epoch: 3, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.180 Vali Acc: 0.373 Test Loss: 2.180 Test Acc: 0.373
Validation loss decreased (-0.341828 --> -0.373458).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7397437
	speed: 1.1890s/iter; left time: 4825.9843s
Epoch: 4 cost time: 68.01511454582214
Epoch: 4, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.486 Vali Acc: 0.152 Test Loss: 2.486 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7043891
	speed: 1.2084s/iter; left time: 4718.6628s
Epoch: 5 cost time: 66.50589442253113
Epoch: 5, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.350 Vali Acc: 0.357 Test Loss: 2.350 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1830963
	speed: 1.1440s/iter; left time: 4291.2307s
Epoch: 6 cost time: 65.3004469871521
Epoch: 6, Steps: 154 | Train Loss: 1.643 Vali Loss: 3.528 Vali Acc: 0.085 Test Loss: 3.528 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.6536177
	speed: 1.1520s/iter; left time: 4143.8494s
Epoch: 7 cost time: 67.62307262420654
Epoch: 7, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.724 Vali Acc: 0.356 Test Loss: 2.724 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.9071743
	speed: 1.2311s/iter; left time: 4238.8407s
Epoch: 8 cost time: 67.89127516746521
Epoch: 8, Steps: 154 | Train Loss: 1.476 Vali Loss: 4.222 Vali Acc: 0.093 Test Loss: 4.222 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.3256557
	speed: 1.2176s/iter; left time: 4004.5782s
Epoch: 9 cost time: 70.54334998130798
Epoch: 9, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.521 Vali Acc: 0.302 Test Loss: 2.521 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.2290629
	speed: 1.3019s/iter; left time: 4081.5537s
Epoch: 10 cost time: 73.30975532531738
Epoch: 10, Steps: 154 | Train Loss: 1.323 Vali Loss: 4.689 Vali Acc: 0.212 Test Loss: 4.689 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.1731834
	speed: 1.2577s/iter; left time: 3749.1782s
Epoch: 11 cost time: 70.14551305770874
Epoch: 11, Steps: 154 | Train Loss: 1.239 Vali Loss: 6.066 Vali Acc: 0.203 Test Loss: 6.066 Test Acc: 0.203
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.3343531
	speed: 1.2421s/iter; left time: 3511.4368s
Epoch: 12 cost time: 70.3266179561615
Epoch: 12, Steps: 154 | Train Loss: 1.185 Vali Loss: 5.077 Vali Acc: 0.099 Test Loss: 5.077 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.6635529
	speed: 1.2821s/iter; left time: 3427.1531s
Epoch: 13 cost time: 70.40123963356018
Epoch: 13, Steps: 154 | Train Loss: 1.150 Vali Loss: 8.581 Vali Acc: 0.080 Test Loss: 8.581 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 56304398
model size : 217.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4137061
	speed: 0.2091s/iter; left time: 945.4729s
Epoch: 1 cost time: 31.466277360916138
Epoch: 1, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.084 Vali Acc: 0.343 Test Loss: 2.084 Test Acc: 0.343
Validation loss decreased (inf --> -0.343045).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1009526
	speed: 0.6017s/iter; left time: 2627.6531s
Epoch: 2 cost time: 28.085731029510498
Epoch: 2, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.401 Vali Acc: 0.336 Test Loss: 2.401 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0171950
	speed: 0.6029s/iter; left time: 2540.1373s
Epoch: 3 cost time: 30.75674843788147
Epoch: 3, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.352 Vali Acc: 0.364 Test Loss: 2.352 Test Acc: 0.364
Validation loss decreased (-0.343045 --> -0.364129).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3458443
	speed: 0.5945s/iter; left time: 2413.1597s
Epoch: 4 cost time: 25.476951360702515
Epoch: 4, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.411 Vali Acc: 0.358 Test Loss: 2.411 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4372168
	speed: 0.5490s/iter; left time: 2144.0110s
Epoch: 5 cost time: 27.85615849494934
Epoch: 5, Steps: 154 | Train Loss: 1.631 Vali Loss: 3.170 Vali Acc: 0.177 Test Loss: 3.170 Test Acc: 0.177
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4534303
	speed: 0.5444s/iter; left time: 2041.9516s
Epoch: 6 cost time: 25.08716130256653
Epoch: 6, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.767 Vali Acc: 0.215 Test Loss: 2.767 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.6128612
	speed: 0.5287s/iter; left time: 1901.5620s
Epoch: 7 cost time: 26.79081106185913
Epoch: 7, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.818 Vali Acc: 0.363 Test Loss: 2.818 Test Acc: 0.363
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3048393
	speed: 0.5107s/iter; left time: 1758.4261s
Epoch: 8 cost time: 24.300045490264893
Epoch: 8, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.837 Vali Acc: 0.377 Test Loss: 2.837 Test Acc: 0.377
Validation loss decreased (-0.364129 --> -0.377101).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6226138
	speed: 0.4562s/iter; left time: 1500.3732s
Epoch: 9 cost time: 20.676034927368164
Epoch: 9, Steps: 154 | Train Loss: 1.372 Vali Loss: 2.348 Vali Acc: 0.286 Test Loss: 2.348 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4338642
	speed: 0.5653s/iter; left time: 1772.3163s
Epoch: 10 cost time: 27.698339462280273
Epoch: 10, Steps: 154 | Train Loss: 1.263 Vali Loss: 7.791 Vali Acc: 0.072 Test Loss: 7.791 Test Acc: 0.072
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9336214
	speed: 0.5348s/iter; left time: 1594.3390s
Epoch: 11 cost time: 25.695291757583618
Epoch: 11, Steps: 154 | Train Loss: 1.176 Vali Loss: 5.089 Vali Acc: 0.139 Test Loss: 5.089 Test Acc: 0.139
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3072270
	speed: 0.5450s/iter; left time: 1540.8132s
Epoch: 12 cost time: 27.51400113105774
Epoch: 12, Steps: 154 | Train Loss: 1.142 Vali Loss: 6.538 Vali Acc: 0.157 Test Loss: 6.538 Test Acc: 0.157
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7684914
	speed: 0.5580s/iter; left time: 1491.4322s
Epoch: 13 cost time: 25.877158880233765
Epoch: 13, Steps: 154 | Train Loss: 1.076 Vali Loss: 5.632 Vali Acc: 0.236 Test Loss: 5.632 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3855437
	speed: 0.5244s/iter; left time: 1321.0054s
Epoch: 14 cost time: 25.709420919418335
Epoch: 14, Steps: 154 | Train Loss: 1.019 Vali Loss: 11.591 Vali Acc: 0.086 Test Loss: 11.591 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2365844
	speed: 0.5654s/iter; left time: 1337.1137s
Epoch: 15 cost time: 27.60271906852722
Epoch: 15, Steps: 154 | Train Loss: 0.996 Vali Loss: 5.380 Vali Acc: 0.122 Test Loss: 5.380 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.9737110
	speed: 0.5426s/iter; left time: 1199.6812s
Epoch: 16 cost time: 25.738030433654785
Epoch: 16, Steps: 154 | Train Loss: 0.931 Vali Loss: 7.567 Vali Acc: 0.154 Test Loss: 7.567 Test Acc: 0.154
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.7530726
	speed: 0.5462s/iter; left time: 1123.5530s
Epoch: 17 cost time: 27.630008459091187
Epoch: 17, Steps: 154 | Train Loss: 0.880 Vali Loss: 5.377 Vali Acc: 0.321 Test Loss: 5.377 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.8968613
	speed: 0.5873s/iter; left time: 1117.6429s
Epoch: 18 cost time: 28.322957038879395
Epoch: 18, Steps: 154 | Train Loss: 0.856 Vali Loss: 10.211 Vali Acc: 0.159 Test Loss: 10.211 Test Acc: 0.159
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 16587278
model size : 65.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7581317
	speed: 0.6653s/iter; left time: 3007.7895s
Epoch: 1 cost time: 101.3931200504303
Epoch: 1, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.022 Vali Acc: 0.342 Test Loss: 2.022 Test Acc: 0.342
Validation loss decreased (inf --> -0.342234).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6695004
	speed: 1.8247s/iter; left time: 7968.4778s
Epoch: 2 cost time: 97.82587003707886
Epoch: 2, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.148 Vali Acc: 0.343 Test Loss: 2.148 Test Acc: 0.343
Validation loss decreased (-0.342234 --> -0.343450).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3026125
	speed: 1.8066s/iter; left time: 7611.4067s
Epoch: 3 cost time: 96.66360259056091
Epoch: 3, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.199 Vali Acc: 0.346 Test Loss: 2.199 Test Acc: 0.346
Validation loss decreased (-0.343450 --> -0.345882).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8295289
	speed: 1.7971s/iter; left time: 7294.4514s
Epoch: 4 cost time: 95.00681948661804
Epoch: 4, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.688 Vali Acc: 0.359 Test Loss: 2.688 Test Acc: 0.359
Validation loss decreased (-0.345882 --> -0.358854).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7156934
	speed: 1.7727s/iter; left time: 6922.1998s
Epoch: 5 cost time: 93.12309455871582
Epoch: 5, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.244 Vali Acc: 0.381 Test Loss: 2.244 Test Acc: 0.381
Validation loss decreased (-0.358854 --> -0.381162).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5332825
	speed: 1.7616s/iter; left time: 6607.7356s
Epoch: 6 cost time: 92.0502724647522
Epoch: 6, Steps: 154 | Train Loss: 1.493 Vali Loss: 3.166 Vali Acc: 0.114 Test Loss: 3.166 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4128137
	speed: 1.6623s/iter; left time: 5979.1685s
Epoch: 7 cost time: 90.9648232460022
Epoch: 7, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.776 Vali Acc: 0.118 Test Loss: 2.776 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1866454
	speed: 1.6505s/iter; left time: 5682.6912s
Epoch: 8 cost time: 88.72440266609192
Epoch: 8, Steps: 154 | Train Loss: 1.364 Vali Loss: 4.284 Vali Acc: 0.115 Test Loss: 4.284 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2043533
	speed: 1.6282s/iter; left time: 5355.1384s
Epoch: 9 cost time: 86.61693978309631
Epoch: 9, Steps: 154 | Train Loss: 1.339 Vali Loss: 2.854 Vali Acc: 0.146 Test Loss: 2.854 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.9759386
	speed: 1.5190s/iter; left time: 4762.1993s
Epoch: 10 cost time: 81.85133099555969
Epoch: 10, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.509 Vali Acc: 0.133 Test Loss: 3.509 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3393688
	speed: 1.5428s/iter; left time: 4599.1362s
Epoch: 11 cost time: 85.4034731388092
Epoch: 11, Steps: 154 | Train Loss: 1.257 Vali Loss: 3.201 Vali Acc: 0.148 Test Loss: 3.201 Test Acc: 0.148
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.4919665
	speed: 1.6630s/iter; left time: 4701.3680s
Epoch: 12 cost time: 89.20447421073914
Epoch: 12, Steps: 154 | Train Loss: 1.178 Vali Loss: 3.409 Vali Acc: 0.211 Test Loss: 3.409 Test Acc: 0.211
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.2629946
	speed: 1.6442s/iter; left time: 4394.8538s
Epoch: 13 cost time: 88.56188368797302
Epoch: 13, Steps: 154 | Train Loss: 1.120 Vali Loss: 3.301 Vali Acc: 0.180 Test Loss: 3.301 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0497167
	speed: 1.6286s/iter; left time: 4102.3455s
Epoch: 14 cost time: 88.17169117927551
Epoch: 14, Steps: 154 | Train Loss: 1.113 Vali Loss: 5.771 Vali Acc: 0.121 Test Loss: 5.771 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.8721007
	speed: 1.6142s/iter; left time: 3817.4679s
Epoch: 15 cost time: 87.35196709632874
Epoch: 15, Steps: 154 | Train Loss: 1.042 Vali Loss: 5.252 Vali Acc: 0.093 Test Loss: 5.252 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38118410381184104
model parameter : 28187150
model size : 109.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2093623
	speed: 0.2297s/iter; left time: 1038.5889s
Epoch: 1 cost time: 34.34159326553345
Epoch: 1, Steps: 154 | Train Loss: 2.090 Vali Loss: 2.150 Vali Acc: 0.330 Test Loss: 2.150 Test Acc: 0.330
Validation loss decreased (inf --> -0.330473).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8088577
	speed: 0.6423s/iter; left time: 2804.7312s
Epoch: 2 cost time: 33.116936683654785
Epoch: 2, Steps: 154 | Train Loss: 1.840 Vali Loss: 2.090 Vali Acc: 0.353 Test Loss: 2.090 Test Acc: 0.353
Validation loss decreased (-0.330473 --> -0.353183).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1160226
	speed: 0.6130s/iter; left time: 2582.7075s
Epoch: 3 cost time: 31.317896127700806
Epoch: 3, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.674 Vali Acc: 0.370 Test Loss: 2.674 Test Acc: 0.370
Validation loss decreased (-0.353183 --> -0.369803).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5794739
	speed: 0.5975s/iter; left time: 2425.3458s
Epoch: 4 cost time: 31.49425506591797
Epoch: 4, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.674 Vali Acc: 0.092 Test Loss: 2.674 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5151441
	speed: 0.5855s/iter; left time: 2286.4809s
Epoch: 5 cost time: 30.80707573890686
Epoch: 5, Steps: 154 | Train Loss: 1.494 Vali Loss: 3.837 Vali Acc: 0.060 Test Loss: 3.837 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7977508
	speed: 0.5840s/iter; left time: 2190.6859s
Epoch: 6 cost time: 30.99692440032959
Epoch: 6, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.266 Vali Acc: 0.210 Test Loss: 2.266 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5511088
	speed: 0.5909s/iter; left time: 2125.5673s
Epoch: 7 cost time: 30.586021423339844
Epoch: 7, Steps: 154 | Train Loss: 1.359 Vali Loss: 3.003 Vali Acc: 0.383 Test Loss: 3.003 Test Acc: 0.383
Validation loss decreased (-0.369803 --> -0.382776).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8742839
	speed: 0.5879s/iter; left time: 2024.1645s
Epoch: 8 cost time: 30.064507484436035
Epoch: 8, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.303 Vali Acc: 0.141 Test Loss: 3.303 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1919652
	speed: 0.5774s/iter; left time: 1899.0432s
Epoch: 9 cost time: 27.15549111366272
Epoch: 9, Steps: 154 | Train Loss: 1.223 Vali Loss: 6.359 Vali Acc: 0.082 Test Loss: 6.359 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9303459
	speed: 0.6218s/iter; left time: 1949.4769s
Epoch: 10 cost time: 35.48420858383179
Epoch: 10, Steps: 154 | Train Loss: 1.218 Vali Loss: 4.151 Vali Acc: 0.098 Test Loss: 4.151 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0824217
	speed: 0.7140s/iter; left time: 2128.4091s
Epoch: 11 cost time: 35.97370219230652
Epoch: 11, Steps: 154 | Train Loss: 1.118 Vali Loss: 6.763 Vali Acc: 0.162 Test Loss: 6.763 Test Acc: 0.162
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0844693
	speed: 0.7220s/iter; left time: 2041.0786s
Epoch: 12 cost time: 34.80375838279724
Epoch: 12, Steps: 154 | Train Loss: 1.095 Vali Loss: 6.401 Vali Acc: 0.086 Test Loss: 6.401 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0908388
	speed: 0.6737s/iter; left time: 1800.9043s
Epoch: 13 cost time: 33.72252941131592
Epoch: 13, Steps: 154 | Train Loss: 0.998 Vali Loss: 6.252 Vali Acc: 0.206 Test Loss: 6.252 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.0261613
	speed: 0.6996s/iter; left time: 1762.3429s
Epoch: 14 cost time: 36.801766872406006
Epoch: 14, Steps: 154 | Train Loss: 0.954 Vali Loss: 5.511 Vali Acc: 0.091 Test Loss: 5.511 Test Acc: 0.091
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.9772907
	speed: 0.7624s/iter; left time: 1802.9769s
Epoch: 15 cost time: 38.025567293167114
Epoch: 15, Steps: 154 | Train Loss: 0.899 Vali Loss: 11.737 Vali Acc: 0.082 Test Loss: 11.737 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.7374865
	speed: 0.7653s/iter; left time: 1692.1277s
Epoch: 16 cost time: 38.53526854515076
Epoch: 16, Steps: 154 | Train Loss: 0.834 Vali Loss: 8.622 Vali Acc: 0.084 Test Loss: 8.622 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.6638443
	speed: 0.7588s/iter; left time: 1560.8249s
Epoch: 17 cost time: 36.57019114494324
Epoch: 17, Steps: 154 | Train Loss: 0.813 Vali Loss: 6.571 Vali Acc: 0.084 Test Loss: 6.571 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38280616382806165
model parameter : 8328206
model size : 34.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7726529
	speed: 0.4700s/iter; left time: 2124.8782s
Epoch: 1 cost time: 73.1307761669159
Epoch: 1, Steps: 154 | Train Loss: 2.078 Vali Loss: 2.022 Vali Acc: 0.341 Test Loss: 2.022 Test Acc: 0.341
Validation loss decreased (inf --> -0.340612).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6975758
	speed: 1.3588s/iter; left time: 5933.7419s
Epoch: 2 cost time: 72.45458626747131
Epoch: 2, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.165 Vali Acc: 0.345 Test Loss: 2.165 Test Acc: 0.345
Validation loss decreased (-0.340612 --> -0.345477).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.4603076
	speed: 1.3441s/iter; left time: 5662.6955s
Epoch: 3 cost time: 69.4105920791626
Epoch: 3, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.599 Vali Acc: 0.086 Test Loss: 2.599 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9161384
	speed: 1.2997s/iter; left time: 5275.2959s
Epoch: 4 cost time: 72.0588812828064
Epoch: 4, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.565 Vali Acc: 0.367 Test Loss: 2.565 Test Acc: 0.367
Validation loss decreased (-0.345477 --> -0.366560).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9334706
	speed: 1.3616s/iter; left time: 5317.1943s
Epoch: 5 cost time: 72.61617612838745
Epoch: 5, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.463 Vali Acc: 0.304 Test Loss: 2.463 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5195442
	speed: 1.3229s/iter; left time: 4962.1869s
Epoch: 6 cost time: 69.34752869606018
Epoch: 6, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.587 Vali Acc: 0.209 Test Loss: 2.587 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2933918
	speed: 1.2509s/iter; left time: 4499.5855s
Epoch: 7 cost time: 67.863853931427
Epoch: 7, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.407 Vali Acc: 0.375 Test Loss: 2.407 Test Acc: 0.375
Validation loss decreased (-0.366560 --> -0.375077).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1540377
	speed: 1.2624s/iter; left time: 4346.6073s
Epoch: 8 cost time: 67.41225075721741
Epoch: 8, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.854 Vali Acc: 0.197 Test Loss: 3.854 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4563317
	speed: 1.2158s/iter; left time: 3998.6727s
Epoch: 9 cost time: 64.4257185459137
Epoch: 9, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.676 Vali Acc: 0.386 Test Loss: 2.676 Test Acc: 0.386
Validation loss decreased (-0.375077 --> -0.386429).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9918735
	speed: 1.2302s/iter; left time: 3856.5247s
Epoch: 10 cost time: 67.56496691703796
Epoch: 10, Steps: 154 | Train Loss: 1.314 Vali Loss: 3.344 Vali Acc: 0.186 Test Loss: 3.344 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3407454
	speed: 1.2623s/iter; left time: 3763.0403s
Epoch: 11 cost time: 67.48298287391663
Epoch: 11, Steps: 154 | Train Loss: 1.254 Vali Loss: 2.936 Vali Acc: 0.136 Test Loss: 2.936 Test Acc: 0.136
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4758370
	speed: 1.2163s/iter; left time: 3438.3640s
Epoch: 12 cost time: 64.52078628540039
Epoch: 12, Steps: 154 | Train Loss: 1.245 Vali Loss: 3.209 Vali Acc: 0.220 Test Loss: 3.209 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1124990
	speed: 1.2341s/iter; left time: 3298.8026s
Epoch: 13 cost time: 67.65918612480164
Epoch: 13, Steps: 154 | Train Loss: 1.210 Vali Loss: 3.926 Vali Acc: 0.137 Test Loss: 3.926 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2501605
	speed: 1.3139s/iter; left time: 3309.8132s
Epoch: 14 cost time: 70.37797689437866
Epoch: 14, Steps: 154 | Train Loss: 1.177 Vali Loss: 3.795 Vali Acc: 0.119 Test Loss: 3.795 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.8876395
	speed: 1.2814s/iter; left time: 3030.6124s
Epoch: 15 cost time: 68.96760821342468
Epoch: 15, Steps: 154 | Train Loss: 1.073 Vali Loss: 3.038 Vali Acc: 0.169 Test Loss: 3.038 Test Acc: 0.169
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.4134914
	speed: 1.3180s/iter; left time: 2914.1180s
Epoch: 16 cost time: 71.64742088317871
Epoch: 16, Steps: 154 | Train Loss: 1.058 Vali Loss: 2.648 Vali Acc: 0.258 Test Loss: 2.648 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.7936043
	speed: 1.3387s/iter; left time: 2753.6518s
Epoch: 17 cost time: 70.8162431716919
Epoch: 17, Steps: 154 | Train Loss: 1.018 Vali Loss: 3.736 Vali Acc: 0.102 Test Loss: 3.736 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.1067677
	speed: 1.2897s/iter; left time: 2454.3343s
Epoch: 18 cost time: 69.34140586853027
Epoch: 18, Steps: 154 | Train Loss: 0.951 Vali Loss: 2.745 Vali Acc: 0.214 Test Loss: 2.745 Test Acc: 0.214
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.1433073
	speed: 1.3264s/iter; left time: 2319.8732s
Epoch: 19 cost time: 71.68482613563538
Epoch: 19, Steps: 154 | Train Loss: 0.939 Vali Loss: 4.489 Vali Acc: 0.102 Test Loss: 4.489 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.386455798864558
model parameter : 28187150
model size : 109.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2295716
	speed: 0.1957s/iter; left time: 884.7846s
Epoch: 1 cost time: 29.673211097717285
Epoch: 1, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.164 Vali Acc: 0.329 Test Loss: 2.164 Test Acc: 0.329
Validation loss decreased (inf --> -0.329257).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8103548
	speed: 0.5924s/iter; left time: 2586.9888s
Epoch: 2 cost time: 28.647754907608032
Epoch: 2, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.053 Vali Acc: 0.353 Test Loss: 2.053 Test Acc: 0.353
Validation loss decreased (-0.329257 --> -0.352778).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1115682
	speed: 0.5997s/iter; left time: 2526.5077s
Epoch: 3 cost time: 29.53013777732849
Epoch: 3, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.568 Vali Acc: 0.382 Test Loss: 2.568 Test Acc: 0.382
Validation loss decreased (-0.352778 --> -0.381969).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8445789
	speed: 0.6102s/iter; left time: 2476.6249s
Epoch: 4 cost time: 28.41341519355774
Epoch: 4, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.363 Vali Acc: 0.373 Test Loss: 2.363 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5140889
	speed: 0.5860s/iter; left time: 2288.1655s
Epoch: 5 cost time: 28.24531865119934
Epoch: 5, Steps: 154 | Train Loss: 1.508 Vali Loss: 5.136 Vali Acc: 0.064 Test Loss: 5.136 Test Acc: 0.064
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5498248
	speed: 0.5826s/iter; left time: 2185.4324s
Epoch: 6 cost time: 27.951765775680542
Epoch: 6, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.907 Vali Acc: 0.187 Test Loss: 2.907 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4496144
	speed: 0.5605s/iter; left time: 2016.0789s
Epoch: 7 cost time: 27.21444344520569
Epoch: 7, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.559 Vali Acc: 0.353 Test Loss: 3.559 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.8095232
	speed: 0.5543s/iter; left time: 1908.6148s
Epoch: 8 cost time: 26.72684121131897
Epoch: 8, Steps: 154 | Train Loss: 1.314 Vali Loss: 3.294 Vali Acc: 0.202 Test Loss: 3.294 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.8888012
	speed: 0.5642s/iter; left time: 1855.7206s
Epoch: 9 cost time: 28.11692762374878
Epoch: 9, Steps: 154 | Train Loss: 1.263 Vali Loss: 5.298 Vali Acc: 0.115 Test Loss: 5.298 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.7928326
	speed: 0.5835s/iter; left time: 1829.3369s
Epoch: 10 cost time: 28.216694831848145
Epoch: 10, Steps: 154 | Train Loss: 1.192 Vali Loss: 5.128 Vali Acc: 0.133 Test Loss: 5.128 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.2630692
	speed: 0.5806s/iter; left time: 1730.6990s
Epoch: 11 cost time: 28.219256162643433
Epoch: 11, Steps: 154 | Train Loss: 1.129 Vali Loss: 7.265 Vali Acc: 0.185 Test Loss: 7.265 Test Acc: 0.185
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.9179630
	speed: 0.5757s/iter; left time: 1627.4671s
Epoch: 12 cost time: 26.98349928855896
Epoch: 12, Steps: 154 | Train Loss: 1.102 Vali Loss: 8.420 Vali Acc: 0.081 Test Loss: 8.420 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.1420691
	speed: 0.5518s/iter; left time: 1474.9168s
Epoch: 13 cost time: 26.53854751586914
Epoch: 13, Steps: 154 | Train Loss: 1.001 Vali Loss: 6.797 Vali Acc: 0.212 Test Loss: 6.797 Test Acc: 0.212
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3819951338199513
model parameter : 8328206
model size : 34.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7747500
	speed: 0.2727s/iter; left time: 1232.6618s
Epoch: 1 cost time: 41.51466512680054
Epoch: 1, Steps: 154 | Train Loss: 2.093 Vali Loss: 2.129 Vali Acc: 0.330 Test Loss: 2.129 Test Acc: 0.330
Validation loss decreased (inf --> -0.330068).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7233646
	speed: 0.7626s/iter; left time: 3330.4506s
Epoch: 2 cost time: 40.28547024726868
Epoch: 2, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.136 Vali Acc: 0.350 Test Loss: 2.136 Test Acc: 0.350
Validation loss decreased (-0.330068 --> -0.349938).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3708832
	speed: 0.7688s/iter; left time: 3239.1594s
Epoch: 3 cost time: 40.438764572143555
Epoch: 3, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.501 Vali Acc: 0.103 Test Loss: 2.501 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7008302
	speed: 0.7752s/iter; left time: 3146.7344s
Epoch: 4 cost time: 41.04682207107544
Epoch: 4, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.529 Vali Acc: 0.368 Test Loss: 2.529 Test Acc: 0.368
Validation loss decreased (-0.349938 --> -0.367777).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8918433
	speed: 0.7821s/iter; left time: 3054.1111s
Epoch: 5 cost time: 41.21874785423279
Epoch: 5, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.494 Vali Acc: 0.206 Test Loss: 2.494 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4752526
	speed: 0.8002s/iter; left time: 3001.6247s
Epoch: 6 cost time: 42.733691930770874
Epoch: 6, Steps: 154 | Train Loss: 1.603 Vali Loss: 3.327 Vali Acc: 0.139 Test Loss: 3.327 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3569297
	speed: 0.8061s/iter; left time: 2899.4310s
Epoch: 7 cost time: 42.70804834365845
Epoch: 7, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.892 Vali Acc: 0.125 Test Loss: 2.892 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3451917
	speed: 0.8026s/iter; left time: 2763.2750s
Epoch: 8 cost time: 41.91439461708069
Epoch: 8, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.805 Vali Acc: 0.176 Test Loss: 3.805 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.5253750
	speed: 0.7757s/iter; left time: 2551.4160s
Epoch: 9 cost time: 41.14966702461243
Epoch: 9, Steps: 154 | Train Loss: 1.446 Vali Loss: 3.357 Vali Acc: 0.353 Test Loss: 3.357 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.1005616
	speed: 0.7802s/iter; left time: 2445.8017s
Epoch: 10 cost time: 42.13225698471069
Epoch: 10, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.281 Vali Acc: 0.163 Test Loss: 3.281 Test Acc: 0.163
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.2117348
	speed: 0.8075s/iter; left time: 2407.2019s
Epoch: 11 cost time: 42.85084581375122
Epoch: 11, Steps: 154 | Train Loss: 1.310 Vali Loss: 4.801 Vali Acc: 0.087 Test Loss: 4.801 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.5746261
	speed: 0.8070s/iter; left time: 2281.3333s
Epoch: 12 cost time: 42.85755252838135
Epoch: 12, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.489 Vali Acc: 0.214 Test Loss: 3.489 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.0826249
	speed: 0.7920s/iter; left time: 2117.1308s
Epoch: 13 cost time: 41.35578632354736
Epoch: 13, Steps: 154 | Train Loss: 1.282 Vali Loss: 7.238 Vali Acc: 0.095 Test Loss: 7.238 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0273206
	speed: 0.7780s/iter; left time: 1959.6838s
Epoch: 14 cost time: 41.35979461669922
Epoch: 14, Steps: 154 | Train Loss: 1.225 Vali Loss: 5.481 Vali Acc: 0.074 Test Loss: 5.481 Test Acc: 0.074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3678021086780211
model parameter : 28187150
model size : 109.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1811252
	speed: 0.1512s/iter; left time: 683.4257s
Epoch: 1 cost time: 22.695184469223022
Epoch: 1, Steps: 154 | Train Loss: 2.108 Vali Loss: 2.172 Vali Acc: 0.330 Test Loss: 2.172 Test Acc: 0.330
Validation loss decreased (inf --> -0.330473).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8006443
	speed: 0.4759s/iter; left time: 2078.0902s
Epoch: 2 cost time: 21.532988786697388
Epoch: 2, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.018 Vali Acc: 0.360 Test Loss: 2.018 Test Acc: 0.360
Validation loss decreased (-0.330473 --> -0.359672).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0698261
	speed: 0.4776s/iter; left time: 2012.0284s
Epoch: 3 cost time: 21.57750177383423
Epoch: 3, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.565 Vali Acc: 0.354 Test Loss: 2.565 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7524478
	speed: 0.4572s/iter; left time: 1855.7327s
Epoch: 4 cost time: 19.97487735748291
Epoch: 4, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.191 Vali Acc: 0.366 Test Loss: 2.191 Test Acc: 0.366
Validation loss decreased (-0.359672 --> -0.365753).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5290238
	speed: 0.4261s/iter; left time: 1664.0789s
Epoch: 5 cost time: 19.347999811172485
Epoch: 5, Steps: 154 | Train Loss: 1.609 Vali Loss: 4.931 Vali Acc: 0.061 Test Loss: 4.931 Test Acc: 0.061
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8758259
	speed: 0.4191s/iter; left time: 1572.2288s
Epoch: 6 cost time: 19.45668077468872
Epoch: 6, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.372 Vali Acc: 0.210 Test Loss: 2.372 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4866433
	speed: 0.4165s/iter; left time: 1498.0208s
Epoch: 7 cost time: 18.321128845214844
Epoch: 7, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.973 Vali Acc: 0.377 Test Loss: 3.973 Test Acc: 0.377
Validation loss decreased (-0.365753 --> -0.377089).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9310589
	speed: 0.4260s/iter; left time: 1466.7008s
Epoch: 8 cost time: 19.457480669021606
Epoch: 8, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.906 Vali Acc: 0.210 Test Loss: 3.906 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0355561
	speed: 0.3346s/iter; left time: 1100.6380s
Epoch: 9 cost time: 15.8278648853302
Epoch: 9, Steps: 154 | Train Loss: 1.365 Vali Loss: 6.002 Vali Acc: 0.187 Test Loss: 6.002 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7075964
	speed: 0.4223s/iter; left time: 1324.0314s
Epoch: 10 cost time: 19.083317518234253
Epoch: 10, Steps: 154 | Train Loss: 1.253 Vali Loss: 7.050 Vali Acc: 0.191 Test Loss: 7.050 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3189422
	speed: 0.3981s/iter; left time: 1186.7001s
Epoch: 11 cost time: 17.299515962600708
Epoch: 11, Steps: 154 | Train Loss: 1.189 Vali Loss: 9.804 Vali Acc: 0.090 Test Loss: 9.804 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.9156107
	speed: 0.3724s/iter; left time: 1052.7126s
Epoch: 12 cost time: 17.78561496734619
Epoch: 12, Steps: 154 | Train Loss: 1.131 Vali Loss: 11.695 Vali Acc: 0.099 Test Loss: 11.695 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0356750
	speed: 0.4217s/iter; left time: 1127.0857s
Epoch: 13 cost time: 19.271158695220947
Epoch: 13, Steps: 154 | Train Loss: 1.095 Vali Loss: 9.326 Vali Acc: 0.090 Test Loss: 9.326 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.8472635
	speed: 0.4068s/iter; left time: 1024.7148s
Epoch: 14 cost time: 17.660829067230225
Epoch: 14, Steps: 154 | Train Loss: 0.998 Vali Loss: 11.108 Vali Acc: 0.084 Test Loss: 11.108 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0061901
	speed: 0.3844s/iter; left time: 909.0941s
Epoch: 15 cost time: 17.37003993988037
Epoch: 15, Steps: 154 | Train Loss: 0.967 Vali Loss: 13.915 Vali Acc: 0.093 Test Loss: 13.915 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.8232644
	speed: 0.4157s/iter; left time: 919.0544s
Epoch: 16 cost time: 19.393630027770996
Epoch: 16, Steps: 154 | Train Loss: 0.952 Vali Loss: 13.241 Vali Acc: 0.065 Test Loss: 13.241 Test Acc: 0.065
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.7669762
	speed: 0.4164s/iter; left time: 856.5179s
Epoch: 17 cost time: 17.758867502212524
Epoch: 17, Steps: 154 | Train Loss: 0.886 Vali Loss: 14.617 Vali Acc: 0.076 Test Loss: 14.617 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 8328206
model size : 34.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1861839
	speed: 0.6741s/iter; left time: 3047.5167s
Epoch: 1 cost time: 102.63682413101196
Epoch: 1, Steps: 154 | Train Loss: 2.088 Vali Loss: 2.241 Vali Acc: 0.326 Test Loss: 2.241 Test Acc: 0.326
Validation loss decreased (inf --> -0.326012).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4840204
	speed: 1.9666s/iter; left time: 8588.0990s
Epoch: 2 cost time: 102.30931854248047
Epoch: 2, Steps: 154 | Train Loss: 1.892 Vali Loss: 2.140 Vali Acc: 0.346 Test Loss: 2.140 Test Acc: 0.346
Validation loss decreased (-0.326012 --> -0.345883).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6745734
	speed: 1.9472s/iter; left time: 8203.5450s
Epoch: 3 cost time: 100.6742594242096
Epoch: 3, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.396 Vali Acc: 0.184 Test Loss: 2.396 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6229328
	speed: 1.9625s/iter; left time: 7965.6580s
Epoch: 4 cost time: 100.80959558486938
Epoch: 4, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.607 Vali Acc: 0.346 Test Loss: 2.607 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.1858348
	speed: 1.9670s/iter; left time: 7681.2962s
Epoch: 5 cost time: 102.72384881973267
Epoch: 5, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.578 Vali Acc: 0.076 Test Loss: 2.578 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5835326
	speed: 1.9824s/iter; left time: 7435.9825s
Epoch: 6 cost time: 104.59191346168518
Epoch: 6, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.843 Vali Acc: 0.206 Test Loss: 2.843 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.6117049
	speed: 1.9192s/iter; left time: 6903.3480s
Epoch: 7 cost time: 98.56945466995239
Epoch: 7, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.210 Vali Acc: 0.371 Test Loss: 2.210 Test Acc: 0.371
Validation loss decreased (-0.345883 --> -0.370619).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2050631
	speed: 1.8626s/iter; left time: 6412.9111s
Epoch: 8 cost time: 96.45109105110168
Epoch: 8, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.327 Vali Acc: 0.347 Test Loss: 2.327 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9133322
	speed: 1.8468s/iter; left time: 6073.9722s
Epoch: 9 cost time: 95.02255630493164
Epoch: 9, Steps: 154 | Train Loss: 1.301 Vali Loss: 3.501 Vali Acc: 0.111 Test Loss: 3.501 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2296021
	speed: 1.8644s/iter; left time: 5844.8648s
Epoch: 10 cost time: 96.23370623588562
Epoch: 10, Steps: 154 | Train Loss: 1.264 Vali Loss: 4.370 Vali Acc: 0.102 Test Loss: 4.370 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2942090
	speed: 1.8635s/iter; left time: 5555.2192s
Epoch: 11 cost time: 101.21291756629944
Epoch: 11, Steps: 154 | Train Loss: 1.180 Vali Loss: 7.085 Vali Acc: 0.095 Test Loss: 7.085 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.6800796
	speed: 1.9930s/iter; left time: 5634.2113s
Epoch: 12 cost time: 105.13061594963074
Epoch: 12, Steps: 154 | Train Loss: 1.124 Vali Loss: 3.844 Vali Acc: 0.115 Test Loss: 3.844 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0556267
	speed: 1.9026s/iter; left time: 5085.6674s
Epoch: 13 cost time: 101.99143028259277
Epoch: 13, Steps: 154 | Train Loss: 1.054 Vali Loss: 4.015 Vali Acc: 0.157 Test Loss: 4.015 Test Acc: 0.157
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7661202
	speed: 2.0575s/iter; left time: 5182.9174s
Epoch: 14 cost time: 104.28648209571838
Epoch: 14, Steps: 154 | Train Loss: 1.024 Vali Loss: 4.175 Vali Acc: 0.216 Test Loss: 4.175 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.9652001
	speed: 2.0604s/iter; left time: 4872.9134s
Epoch: 15 cost time: 105.01809811592102
Epoch: 15, Steps: 154 | Train Loss: 0.952 Vali Loss: 4.257 Vali Acc: 0.213 Test Loss: 4.257 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3106706
	speed: 2.0312s/iter; left time: 4490.9226s
Epoch: 16 cost time: 109.35836601257324
Epoch: 16, Steps: 154 | Train Loss: 0.928 Vali Loss: 7.051 Vali Acc: 0.110 Test Loss: 7.051 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.3856181
	speed: 1.9429s/iter; left time: 3996.6083s
Epoch: 17 cost time: 98.60707330703735
Epoch: 17, Steps: 154 | Train Loss: 0.876 Vali Loss: 4.164 Vali Acc: 0.209 Test Loss: 4.164 Test Acc: 0.209
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3706407137064071
model parameter : 28154510
model size : 108.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1950674
	speed: 0.2473s/iter; left time: 1118.2212s
Epoch: 1 cost time: 37.784382581710815
Epoch: 1, Steps: 154 | Train Loss: 2.077 Vali Loss: 2.025 Vali Acc: 0.332 Test Loss: 2.025 Test Acc: 0.332
Validation loss decreased (inf --> -0.332097).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0265300
	speed: 0.7445s/iter; left time: 3251.1797s
Epoch: 2 cost time: 38.53049564361572
Epoch: 2, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.098 Vali Acc: 0.358 Test Loss: 2.098 Test Acc: 0.358
Validation loss decreased (-0.332097 --> -0.358049).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4496279
	speed: 0.7783s/iter; left time: 3279.1476s
Epoch: 3 cost time: 38.540852308273315
Epoch: 3, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.237 Vali Acc: 0.201 Test Loss: 2.237 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3726547
	speed: 0.7497s/iter; left time: 3042.8987s
Epoch: 4 cost time: 36.83881092071533
Epoch: 4, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.039 Vali Acc: 0.373 Test Loss: 2.039 Test Acc: 0.373
Validation loss decreased (-0.358049 --> -0.373459).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9291738
	speed: 0.7330s/iter; left time: 2862.1824s
Epoch: 5 cost time: 36.6523072719574
Epoch: 5, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.222 Vali Acc: 0.207 Test Loss: 2.222 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3953655
	speed: 0.7798s/iter; left time: 2924.8860s
Epoch: 6 cost time: 38.599825620651245
Epoch: 6, Steps: 154 | Train Loss: 1.522 Vali Loss: 4.084 Vali Acc: 0.120 Test Loss: 4.084 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6963171
	speed: 0.7748s/iter; left time: 2787.0958s
Epoch: 7 cost time: 38.5509979724884
Epoch: 7, Steps: 154 | Train Loss: 1.454 Vali Loss: 3.092 Vali Acc: 0.221 Test Loss: 3.092 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2684830
	speed: 0.8011s/iter; left time: 2758.3005s
Epoch: 8 cost time: 40.08194422721863
Epoch: 8, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.739 Vali Acc: 0.113 Test Loss: 3.739 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9971963
	speed: 0.8308s/iter; left time: 2732.4427s
Epoch: 9 cost time: 41.89724564552307
Epoch: 9, Steps: 154 | Train Loss: 1.332 Vali Loss: 6.279 Vali Acc: 0.102 Test Loss: 6.279 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.4954915
	speed: 0.8449s/iter; left time: 2648.7726s
Epoch: 10 cost time: 41.76591753959656
Epoch: 10, Steps: 154 | Train Loss: 1.252 Vali Loss: 5.694 Vali Acc: 0.106 Test Loss: 5.694 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.4030787
	speed: 0.8007s/iter; left time: 2386.7861s
Epoch: 11 cost time: 39.322394371032715
Epoch: 11, Steps: 154 | Train Loss: 1.194 Vali Loss: 3.566 Vali Acc: 0.176 Test Loss: 3.566 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.0868282
	speed: 0.8122s/iter; left time: 2296.1431s
Epoch: 12 cost time: 41.497493267059326
Epoch: 12, Steps: 154 | Train Loss: 1.105 Vali Loss: 7.236 Vali Acc: 0.128 Test Loss: 7.236 Test Acc: 0.128
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.8601853
	speed: 0.8368s/iter; left time: 2236.7637s
Epoch: 13 cost time: 41.85782027244568
Epoch: 13, Steps: 154 | Train Loss: 1.058 Vali Loss: 8.152 Vali Acc: 0.095 Test Loss: 8.152 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7857205
	speed: 0.8194s/iter; left time: 2064.1118s
Epoch: 14 cost time: 39.94258952140808
Epoch: 14, Steps: 154 | Train Loss: 1.046 Vali Loss: 4.503 Vali Acc: 0.097 Test Loss: 4.503 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 8295182
model size : 32.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1657345
	speed: 0.5047s/iter; left time: 2281.9427s
Epoch: 1 cost time: 77.08025193214417
Epoch: 1, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.225 Vali Acc: 0.324 Test Loss: 2.225 Test Acc: 0.324
Validation loss decreased (inf --> -0.323579).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5806333
	speed: 1.4018s/iter; left time: 6121.8462s
Epoch: 2 cost time: 71.18384623527527
Epoch: 2, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.243 Vali Acc: 0.333 Test Loss: 2.243 Test Acc: 0.333
Validation loss decreased (-0.323579 --> -0.332500).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5294049
	speed: 1.3894s/iter; left time: 5853.6100s
Epoch: 3 cost time: 74.9699695110321
Epoch: 3, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.575 Vali Acc: 0.337 Test Loss: 2.575 Test Acc: 0.337
Validation loss decreased (-0.332500 --> -0.337363).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9861178
	speed: 1.3517s/iter; left time: 5486.6614s
Epoch: 4 cost time: 67.03904509544373
Epoch: 4, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.483 Vali Acc: 0.343 Test Loss: 2.483 Test Acc: 0.343
Validation loss decreased (-0.337363 --> -0.342635).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3845676
	speed: 1.3007s/iter; left time: 5079.4214s
Epoch: 5 cost time: 70.43429517745972
Epoch: 5, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.358 Vali Acc: 0.240 Test Loss: 2.358 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6307042
	speed: 1.3254s/iter; left time: 4971.6605s
Epoch: 6 cost time: 67.82378149032593
Epoch: 6, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.255 Vali Acc: 0.354 Test Loss: 2.255 Test Acc: 0.354
Validation loss decreased (-0.342635 --> -0.353587).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6130935
	speed: 1.3417s/iter; left time: 4826.1579s
Epoch: 7 cost time: 72.45035862922668
Epoch: 7, Steps: 154 | Train Loss: 1.500 Vali Loss: 3.078 Vali Acc: 0.364 Test Loss: 3.078 Test Acc: 0.364
Validation loss decreased (-0.353587 --> -0.363716).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2415614
	speed: 1.3497s/iter; left time: 4647.0117s
Epoch: 8 cost time: 68.36709237098694
Epoch: 8, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.025 Vali Acc: 0.387 Test Loss: 2.025 Test Acc: 0.387
Validation loss decreased (-0.363716 --> -0.386841).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8692078
	speed: 1.3342s/iter; left time: 4388.0721s
Epoch: 9 cost time: 72.02197813987732
Epoch: 9, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.686 Vali Acc: 0.337 Test Loss: 2.686 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1334625
	speed: 1.3647s/iter; left time: 4278.4494s
Epoch: 10 cost time: 72.75170660018921
Epoch: 10, Steps: 154 | Train Loss: 1.265 Vali Loss: 4.546 Vali Acc: 0.112 Test Loss: 4.546 Test Acc: 0.112
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2656897
	speed: 1.4282s/iter; left time: 4257.5644s
Epoch: 11 cost time: 75.14280772209167
Epoch: 11, Steps: 154 | Train Loss: 1.193 Vali Loss: 4.000 Vali Acc: 0.307 Test Loss: 4.000 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.8583133
	speed: 1.4111s/iter; left time: 3989.1856s
Epoch: 12 cost time: 72.29164624214172
Epoch: 12, Steps: 154 | Train Loss: 1.174 Vali Loss: 5.001 Vali Acc: 0.088 Test Loss: 5.001 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2067149
	speed: 1.4302s/iter; left time: 3822.9306s
Epoch: 13 cost time: 75.4270408153534
Epoch: 13, Steps: 154 | Train Loss: 1.144 Vali Loss: 3.205 Vali Acc: 0.389 Test Loss: 3.205 Test Acc: 0.389
Validation loss decreased (-0.386841 --> -0.389262).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7282876
	speed: 1.4227s/iter; left time: 3583.8007s
Epoch: 14 cost time: 72.87449526786804
Epoch: 14, Steps: 154 | Train Loss: 1.028 Vali Loss: 4.299 Vali Acc: 0.217 Test Loss: 4.299 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.0618240
	speed: 1.3947s/iter; left time: 3298.3952s
Epoch: 15 cost time: 66.81741738319397
Epoch: 15, Steps: 154 | Train Loss: 0.990 Vali Loss: 3.995 Vali Acc: 0.174 Test Loss: 3.995 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.4077427
	speed: 1.2757s/iter; left time: 2820.5822s
Epoch: 16 cost time: 67.3300507068634
Epoch: 16, Steps: 154 | Train Loss: 0.954 Vali Loss: 5.160 Vali Acc: 0.233 Test Loss: 5.160 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0008187
	speed: 1.3265s/iter; left time: 2728.5358s
Epoch: 17 cost time: 67.88523936271667
Epoch: 17, Steps: 154 | Train Loss: 0.899 Vali Loss: 6.160 Vali Acc: 0.094 Test Loss: 6.160 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.5757716
	speed: 1.2604s/iter; left time: 2398.6337s
Epoch: 18 cost time: 65.41906070709229
Epoch: 18, Steps: 154 | Train Loss: 0.879 Vali Loss: 4.875 Vali Acc: 0.210 Test Loss: 4.875 Test Acc: 0.210
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.3250141
	speed: 1.2559s/iter; left time: 2196.6387s
Epoch: 19 cost time: 65.28044724464417
Epoch: 19, Steps: 154 | Train Loss: 0.822 Vali Loss: 4.551 Vali Acc: 0.217 Test Loss: 4.551 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.0462211
	speed: 1.2638s/iter; left time: 2015.8051s
Epoch: 20 cost time: 67.20986342430115
Epoch: 20, Steps: 154 | Train Loss: 0.781 Vali Loss: 6.307 Vali Acc: 0.223 Test Loss: 6.307 Test Acc: 0.223
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6708698
	speed: 1.2569s/iter; left time: 1811.1686s
Epoch: 21 cost time: 66.73148202896118
Epoch: 21, Steps: 154 | Train Loss: 0.748 Vali Loss: 7.794 Vali Acc: 0.208 Test Loss: 7.794 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.7650395
	speed: 1.2691s/iter; left time: 1633.2767s
Epoch: 22 cost time: 67.53767132759094
Epoch: 22, Steps: 154 | Train Loss: 0.750 Vali Loss: 6.493 Vali Acc: 0.188 Test Loss: 6.493 Test Acc: 0.188
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.4933543
	speed: 1.2439s/iter; left time: 1409.3816s
Epoch: 23 cost time: 67.13366627693176
Epoch: 23, Steps: 154 | Train Loss: 0.687 Vali Loss: 7.124 Vali Acc: 0.216 Test Loss: 7.124 Test Acc: 0.216
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 28154510
model size : 108.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1644363
	speed: 0.2050s/iter; left time: 926.6642s
Epoch: 1 cost time: 30.176492929458618
Epoch: 1, Steps: 154 | Train Loss: 2.090 Vali Loss: 2.062 Vali Acc: 0.330 Test Loss: 2.062 Test Acc: 0.330
Validation loss decreased (inf --> -0.329663).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8976201
	speed: 0.5521s/iter; left time: 2411.1317s
Epoch: 2 cost time: 27.592981100082397
Epoch: 2, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.120 Vali Acc: 0.345 Test Loss: 2.120 Test Acc: 0.345
Validation loss decreased (-0.329663 --> -0.345478).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3970001
	speed: 0.6001s/iter; left time: 2528.0991s
Epoch: 3 cost time: 28.836881160736084
Epoch: 3, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.245 Vali Acc: 0.280 Test Loss: 2.245 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3147904
	speed: 0.5654s/iter; left time: 2295.0788s
Epoch: 4 cost time: 28.867198705673218
Epoch: 4, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.086 Vali Acc: 0.373 Test Loss: 2.086 Test Acc: 0.373
Validation loss decreased (-0.345478 --> -0.372647).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7549999
	speed: 0.6060s/iter; left time: 2366.2933s
Epoch: 5 cost time: 28.82409167289734
Epoch: 5, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.260 Vali Acc: 0.204 Test Loss: 2.260 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5235493
	speed: 0.5548s/iter; left time: 2080.9940s
Epoch: 6 cost time: 28.32961392402649
Epoch: 6, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.029 Vali Acc: 0.341 Test Loss: 2.029 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6309247
	speed: 0.6046s/iter; left time: 2174.7934s
Epoch: 7 cost time: 28.94044589996338
Epoch: 7, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.704 Vali Acc: 0.231 Test Loss: 2.704 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.0093412
	speed: 0.5716s/iter; left time: 1967.9307s
Epoch: 8 cost time: 29.14745783805847
Epoch: 8, Steps: 154 | Train Loss: 1.374 Vali Loss: 2.518 Vali Acc: 0.292 Test Loss: 2.518 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.9833769
	speed: 0.6036s/iter; left time: 1985.1366s
Epoch: 9 cost time: 28.797300815582275
Epoch: 9, Steps: 154 | Train Loss: 1.371 Vali Loss: 6.266 Vali Acc: 0.094 Test Loss: 6.266 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.3855054
	speed: 0.5619s/iter; left time: 1761.4510s
Epoch: 10 cost time: 28.642361402511597
Epoch: 10, Steps: 154 | Train Loss: 1.273 Vali Loss: 5.401 Vali Acc: 0.103 Test Loss: 5.401 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3622532
	speed: 0.6045s/iter; left time: 1802.1262s
Epoch: 11 cost time: 28.87278699874878
Epoch: 11, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.777 Vali Acc: 0.230 Test Loss: 3.777 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.0483541
	speed: 0.5718s/iter; left time: 1616.4953s
Epoch: 12 cost time: 28.9003643989563
Epoch: 12, Steps: 154 | Train Loss: 1.140 Vali Loss: 4.707 Vali Acc: 0.221 Test Loss: 4.707 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.1018691
	speed: 0.5990s/iter; left time: 1601.0861s
Epoch: 13 cost time: 28.5049569606781
Epoch: 13, Steps: 154 | Train Loss: 1.067 Vali Loss: 3.250 Vali Acc: 0.260 Test Loss: 3.250 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.7722529
	speed: 0.5611s/iter; left time: 1413.3457s
Epoch: 14 cost time: 28.558104038238525
Epoch: 14, Steps: 154 | Train Loss: 1.027 Vali Loss: 8.916 Vali Acc: 0.080 Test Loss: 8.916 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3726682887266829
model parameter : 8295182
model size : 32.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1616967
	speed: 0.2746s/iter; left time: 1241.3824s
Epoch: 1 cost time: 41.0380220413208
Epoch: 1, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.118 Vali Acc: 0.323 Test Loss: 2.118 Test Acc: 0.323
Validation loss decreased (inf --> -0.322769).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4789116
	speed: 0.7296s/iter; left time: 3186.0331s
Epoch: 2 cost time: 38.618407249450684
Epoch: 2, Steps: 154 | Train Loss: 1.915 Vali Loss: 2.208 Vali Acc: 0.329 Test Loss: 2.208 Test Acc: 0.329
Validation loss decreased (-0.322769 --> -0.328851).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5347040
	speed: 0.6850s/iter; left time: 2885.7289s
Epoch: 3 cost time: 36.621967792510986
Epoch: 3, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.357 Vali Acc: 0.348 Test Loss: 2.357 Test Acc: 0.348
Validation loss decreased (-0.328851 --> -0.348314).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9028946
	speed: 0.6901s/iter; left time: 2801.0954s
Epoch: 4 cost time: 42.121350049972534
Epoch: 4, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.293 Vali Acc: 0.368 Test Loss: 2.293 Test Acc: 0.368
Validation loss decreased (-0.348314 --> -0.368185).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0957372
	speed: 0.7478s/iter; left time: 2920.0799s
Epoch: 5 cost time: 37.88585448265076
Epoch: 5, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.710 Vali Acc: 0.215 Test Loss: 2.710 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5712266
	speed: 0.7301s/iter; left time: 2738.5475s
Epoch: 6 cost time: 40.8847177028656
Epoch: 6, Steps: 154 | Train Loss: 1.535 Vali Loss: 3.289 Vali Acc: 0.360 Test Loss: 3.289 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3268421
	speed: 0.7449s/iter; left time: 2679.5186s
Epoch: 7 cost time: 38.879050493240356
Epoch: 7, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.025 Vali Acc: 0.363 Test Loss: 3.025 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2972616
	speed: 0.7256s/iter; left time: 2498.3662s
Epoch: 8 cost time: 40.67988204956055
Epoch: 8, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.362 Vali Acc: 0.384 Test Loss: 2.362 Test Acc: 0.384
Validation loss decreased (-0.368185 --> -0.383594).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8591493
	speed: 0.7572s/iter; left time: 2490.2721s
Epoch: 9 cost time: 39.07456636428833
Epoch: 9, Steps: 154 | Train Loss: 1.314 Vali Loss: 6.159 Vali Acc: 0.075 Test Loss: 6.159 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2548801
	speed: 0.7243s/iter; left time: 2270.6044s
Epoch: 10 cost time: 40.86229610443115
Epoch: 10, Steps: 154 | Train Loss: 1.238 Vali Loss: 4.461 Vali Acc: 0.247 Test Loss: 4.461 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2203330
	speed: 0.7628s/iter; left time: 2273.9400s
Epoch: 11 cost time: 39.742496967315674
Epoch: 11, Steps: 154 | Train Loss: 1.229 Vali Loss: 2.906 Vali Acc: 0.386 Test Loss: 2.906 Test Acc: 0.386
Validation loss decreased (-0.383594 --> -0.386021).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7939006
	speed: 0.7394s/iter; left time: 2090.4219s
Epoch: 12 cost time: 41.98640060424805
Epoch: 12, Steps: 154 | Train Loss: 1.171 Vali Loss: 8.002 Vali Acc: 0.083 Test Loss: 8.002 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0822601
	speed: 0.8100s/iter; left time: 2165.2353s
Epoch: 13 cost time: 43.435387134552
Epoch: 13, Steps: 154 | Train Loss: 1.081 Vali Loss: 2.998 Vali Acc: 0.401 Test Loss: 2.998 Test Acc: 0.401
Validation loss decreased (-0.386021 --> -0.400619).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.7738808
	speed: 0.7738s/iter; left time: 1949.0931s
Epoch: 14 cost time: 41.285247564315796
Epoch: 14, Steps: 154 | Train Loss: 1.072 Vali Loss: 7.750 Vali Acc: 0.086 Test Loss: 7.750 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.9110109
	speed: 0.8051s/iter; left time: 1904.0566s
Epoch: 15 cost time: 42.690929651260376
Epoch: 15, Steps: 154 | Train Loss: 1.007 Vali Loss: 11.947 Vali Acc: 0.084 Test Loss: 11.947 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3795499
	speed: 0.7591s/iter; left time: 1678.4679s
Epoch: 16 cost time: 41.18128442764282
Epoch: 16, Steps: 154 | Train Loss: 0.938 Vali Loss: 7.535 Vali Acc: 0.097 Test Loss: 7.535 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.0359521
	speed: 0.8110s/iter; left time: 1668.3084s
Epoch: 17 cost time: 43.17481279373169
Epoch: 17, Steps: 154 | Train Loss: 0.910 Vali Loss: 10.825 Vali Acc: 0.097 Test Loss: 10.825 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.4867750
	speed: 0.7581s/iter; left time: 1442.6754s
Epoch: 18 cost time: 40.39975118637085
Epoch: 18, Steps: 154 | Train Loss: 0.864 Vali Loss: 8.124 Vali Acc: 0.142 Test Loss: 8.124 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.1039310
	speed: 0.7966s/iter; left time: 1393.2665s
Epoch: 19 cost time: 43.0396511554718
Epoch: 19, Steps: 154 | Train Loss: 0.820 Vali Loss: 4.312 Vali Acc: 0.233 Test Loss: 4.312 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.8514223
	speed: 0.7787s/iter; left time: 1242.0985s
Epoch: 20 cost time: 40.37811231613159
Epoch: 20, Steps: 154 | Train Loss: 0.787 Vali Loss: 10.286 Vali Acc: 0.187 Test Loss: 10.286 Test Acc: 0.187
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.6109058
	speed: 0.7864s/iter; left time: 1133.2597s
Epoch: 21 cost time: 42.17562913894653
Epoch: 21, Steps: 154 | Train Loss: 0.727 Vali Loss: 12.316 Vali Acc: 0.077 Test Loss: 12.316 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.5960867
	speed: 0.7491s/iter; left time: 964.1092s
Epoch: 22 cost time: 40.767494201660156
Epoch: 22, Steps: 154 | Train Loss: 0.743 Vali Loss: 10.754 Vali Acc: 0.088 Test Loss: 10.754 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.5174557
	speed: 0.8095s/iter; left time: 917.1679s
Epoch: 23 cost time: 41.903210163116455
Epoch: 23, Steps: 154 | Train Loss: 0.799 Vali Loss: 9.922 Vali Acc: 0.085 Test Loss: 9.922 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4006488240064882
model parameter : 28154510
model size : 108.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1265831
	speed: 0.1537s/iter; left time: 694.9144s
Epoch: 1 cost time: 23.00969886779785
Epoch: 1, Steps: 154 | Train Loss: 2.100 Vali Loss: 2.059 Vali Acc: 0.328 Test Loss: 2.059 Test Acc: 0.328
Validation loss decreased (inf --> -0.328447).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9541019
	speed: 0.4490s/iter; left time: 1960.7667s
Epoch: 2 cost time: 20.297921180725098
Epoch: 2, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.134 Vali Acc: 0.358 Test Loss: 2.134 Test Acc: 0.358
Validation loss decreased (-0.328447 --> -0.358454).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3521467
	speed: 0.4159s/iter; left time: 1752.0338s
Epoch: 3 cost time: 19.50479006767273
Epoch: 3, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.213 Vali Acc: 0.368 Test Loss: 2.213 Test Acc: 0.368
Validation loss decreased (-0.358454 --> -0.368185).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3322158
	speed: 0.4226s/iter; left time: 1715.3040s
Epoch: 4 cost time: 20.32925844192505
Epoch: 4, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.073 Vali Acc: 0.224 Test Loss: 2.073 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6580898
	speed: 0.4375s/iter; left time: 1708.3730s
Epoch: 5 cost time: 20.004515886306763
Epoch: 5, Steps: 154 | Train Loss: 1.624 Vali Loss: 2.588 Vali Acc: 0.127 Test Loss: 2.588 Test Acc: 0.127
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3533198
	speed: 0.4023s/iter; left time: 1509.0374s
Epoch: 6 cost time: 18.374885082244873
Epoch: 6, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.061 Vali Acc: 0.372 Test Loss: 2.061 Test Acc: 0.372
Validation loss decreased (-0.368185 --> -0.371837).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7233437
	speed: 0.4168s/iter; left time: 1499.2247s
Epoch: 7 cost time: 20.264689207077026
Epoch: 7, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.023 Vali Acc: 0.398 Test Loss: 2.023 Test Acc: 0.398
Validation loss decreased (-0.371837 --> -0.397790).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9610099
	speed: 0.4489s/iter; left time: 1545.6624s
Epoch: 8 cost time: 20.394144535064697
Epoch: 8, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.887 Vali Acc: 0.202 Test Loss: 2.887 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.9660313
	speed: 0.4010s/iter; left time: 1319.0085s
Epoch: 9 cost time: 18.352642059326172
Epoch: 9, Steps: 154 | Train Loss: 1.386 Vali Loss: 8.890 Vali Acc: 0.093 Test Loss: 8.890 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3806621
	speed: 0.4156s/iter; left time: 1302.8100s
Epoch: 10 cost time: 20.294995546340942
Epoch: 10, Steps: 154 | Train Loss: 1.297 Vali Loss: 6.876 Vali Acc: 0.092 Test Loss: 6.876 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5039394
	speed: 0.4364s/iter; left time: 1300.8452s
Epoch: 11 cost time: 19.700920581817627
Epoch: 11, Steps: 154 | Train Loss: 1.273 Vali Loss: 4.054 Vali Acc: 0.236 Test Loss: 4.054 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0107626
	speed: 0.3995s/iter; left time: 1129.4889s
Epoch: 12 cost time: 18.52384042739868
Epoch: 12, Steps: 154 | Train Loss: 1.186 Vali Loss: 8.314 Vali Acc: 0.106 Test Loss: 8.314 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.8744450
	speed: 0.4309s/iter; left time: 1151.8238s
Epoch: 13 cost time: 20.344874620437622
Epoch: 13, Steps: 154 | Train Loss: 1.068 Vali Loss: 4.845 Vali Acc: 0.219 Test Loss: 4.845 Test Acc: 0.219
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5607753
	speed: 0.4353s/iter; left time: 1096.4687s
Epoch: 14 cost time: 19.53603172302246
Epoch: 14, Steps: 154 | Train Loss: 1.066 Vali Loss: 7.898 Vali Acc: 0.087 Test Loss: 7.898 Test Acc: 0.087
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.9985211
	speed: 0.3969s/iter; left time: 938.6672s
Epoch: 15 cost time: 18.761854887008667
Epoch: 15, Steps: 154 | Train Loss: 1.042 Vali Loss: 9.169 Vali Acc: 0.187 Test Loss: 9.169 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4952399
	speed: 0.4208s/iter; left time: 930.4002s
Epoch: 16 cost time: 20.348236799240112
Epoch: 16, Steps: 154 | Train Loss: 1.040 Vali Loss: 5.291 Vali Acc: 0.131 Test Loss: 5.291 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.7617238
	speed: 0.4328s/iter; left time: 890.2893s
Epoch: 17 cost time: 19.78633689880371
Epoch: 17, Steps: 154 | Train Loss: 0.957 Vali Loss: 10.444 Vali Acc: 0.083 Test Loss: 10.444 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3978102189781022
model parameter : 8295182
model size : 32.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2510619
	speed: 0.3846s/iter; left time: 1738.9310s
Epoch: 1 cost time: 59.034791707992554
Epoch: 1, Steps: 154 | Train Loss: 2.080 Vali Loss: 2.161 Vali Acc: 0.328 Test Loss: 2.161 Test Acc: 0.328
Validation loss decreased (inf --> -0.328040).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7626438
	speed: 1.1427s/iter; left time: 4990.1784s
Epoch: 2 cost time: 56.31499671936035
Epoch: 2, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.156 Vali Acc: 0.342 Test Loss: 2.156 Test Acc: 0.342
Validation loss decreased (-0.328040 --> -0.342233).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6475227
	speed: 1.1854s/iter; left time: 4993.9572s
Epoch: 3 cost time: 54.559977531433105
Epoch: 3, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.152 Vali Acc: 0.354 Test Loss: 2.152 Test Acc: 0.354
Validation loss decreased (-0.342233 --> -0.353588).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6113316
	speed: 1.0815s/iter; left time: 4389.7160s
Epoch: 4 cost time: 46.359217405319214
Epoch: 4, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.328 Vali Acc: 0.345 Test Loss: 2.328 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0154790
	speed: 1.1478s/iter; left time: 4482.0144s
Epoch: 5 cost time: 56.631027936935425
Epoch: 5, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.379 Vali Acc: 0.192 Test Loss: 2.379 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.5673122
	speed: 1.1177s/iter; left time: 4192.6018s
Epoch: 6 cost time: 57.27053618431091
Epoch: 6, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.258 Vali Acc: 0.156 Test Loss: 2.258 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.6089618
	speed: 1.1188s/iter; left time: 4024.3556s
Epoch: 7 cost time: 52.98501896858215
Epoch: 7, Steps: 154 | Train Loss: 1.422 Vali Loss: 6.491 Vali Acc: 0.128 Test Loss: 6.491 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.6505717
	speed: 0.8934s/iter; left time: 3075.9529s
Epoch: 8 cost time: 43.85785484313965
Epoch: 8, Steps: 154 | Train Loss: 1.344 Vali Loss: 5.993 Vali Acc: 0.137 Test Loss: 5.993 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.4303377
	speed: 0.9400s/iter; left time: 3091.7312s
Epoch: 9 cost time: 47.222044467926025
Epoch: 9, Steps: 154 | Train Loss: 1.298 Vali Loss: 8.115 Vali Acc: 0.127 Test Loss: 8.115 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.9932591
	speed: 0.9353s/iter; left time: 2932.3160s
Epoch: 10 cost time: 45.41837167739868
Epoch: 10, Steps: 154 | Train Loss: 1.267 Vali Loss: 5.329 Vali Acc: 0.122 Test Loss: 5.329 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.8944898
	speed: 0.9594s/iter; left time: 2860.0300s
Epoch: 11 cost time: 50.850131034851074
Epoch: 11, Steps: 154 | Train Loss: 1.148 Vali Loss: 7.875 Vali Acc: 0.088 Test Loss: 7.875 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.9621806
	speed: 1.0652s/iter; left time: 3011.3948s
Epoch: 12 cost time: 52.86711072921753
Epoch: 12, Steps: 154 | Train Loss: 1.107 Vali Loss: 2.295 Vali Acc: 0.406 Test Loss: 2.295 Test Acc: 0.406
Validation loss decreased (-0.353588 --> -0.405898).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.8478907
	speed: 1.0344s/iter; left time: 2764.8259s
Epoch: 13 cost time: 49.74710822105408
Epoch: 13, Steps: 154 | Train Loss: 1.030 Vali Loss: 4.041 Vali Acc: 0.112 Test Loss: 4.041 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0361594
	speed: 1.0447s/iter; left time: 2631.6516s
Epoch: 14 cost time: 50.31460905075073
Epoch: 14, Steps: 154 | Train Loss: 1.017 Vali Loss: 5.275 Vali Acc: 0.155 Test Loss: 5.275 Test Acc: 0.155
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1704025
	speed: 0.8991s/iter; left time: 2126.3428s
Epoch: 15 cost time: 43.09815979003906
Epoch: 15, Steps: 154 | Train Loss: 0.974 Vali Loss: 7.149 Vali Acc: 0.133 Test Loss: 7.149 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8720157
	speed: 0.9002s/iter; left time: 1990.3886s
Epoch: 16 cost time: 45.45969820022583
Epoch: 16, Steps: 154 | Train Loss: 0.936 Vali Loss: 6.335 Vali Acc: 0.093 Test Loss: 6.335 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9156197
	speed: 0.8999s/iter; left time: 1851.1426s
Epoch: 17 cost time: 43.36803364753723
Epoch: 17, Steps: 154 | Train Loss: 0.899 Vali Loss: 3.225 Vali Acc: 0.155 Test Loss: 3.225 Test Acc: 0.155
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.9488747
	speed: 0.9680s/iter; left time: 1842.0691s
Epoch: 18 cost time: 51.457289934158325
Epoch: 18, Steps: 154 | Train Loss: 0.865 Vali Loss: 6.553 Vali Acc: 0.084 Test Loss: 6.553 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.3162525
	speed: 1.0242s/iter; left time: 1791.2968s
Epoch: 19 cost time: 49.382922410964966
Epoch: 19, Steps: 154 | Train Loss: 0.818 Vali Loss: 5.647 Vali Acc: 0.102 Test Loss: 5.647 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.5629938
	speed: 1.0193s/iter; left time: 1625.7900s
Epoch: 20 cost time: 51.53056573867798
Epoch: 20, Steps: 154 | Train Loss: 0.752 Vali Loss: 9.768 Vali Acc: 0.090 Test Loss: 9.768 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.9276865
	speed: 0.9355s/iter; left time: 1348.0545s
Epoch: 21 cost time: 44.22920274734497
Epoch: 21, Steps: 154 | Train Loss: 0.725 Vali Loss: 10.477 Vali Acc: 0.086 Test Loss: 10.477 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.4831239
	speed: 1.0580s/iter; left time: 1361.6072s
Epoch: 22 cost time: 49.319538593292236
Epoch: 22, Steps: 154 | Train Loss: 0.729 Vali Loss: 7.337 Vali Acc: 0.099 Test Loss: 7.337 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4059205190592052
model parameter : 14094734
model size : 55.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4916604
	speed: 0.1576s/iter; left time: 712.7077s
Epoch: 1 cost time: 23.50753951072693
Epoch: 1, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.164 Vali Acc: 0.328 Test Loss: 2.164 Test Acc: 0.328
Validation loss decreased (inf --> -0.328446).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7345734
	speed: 0.4505s/iter; left time: 1967.3028s
Epoch: 2 cost time: 20.45328164100647
Epoch: 2, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.188 Vali Acc: 0.342 Test Loss: 2.188 Test Acc: 0.342
Validation loss decreased (-0.328446 --> -0.342233).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4681069
	speed: 0.4473s/iter; left time: 1884.2968s
Epoch: 3 cost time: 23.146177530288696
Epoch: 3, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.203 Vali Acc: 0.191 Test Loss: 2.203 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8620589
	speed: 0.5257s/iter; left time: 2133.6161s
Epoch: 4 cost time: 24.88470196723938
Epoch: 4, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.817 Vali Acc: 0.361 Test Loss: 2.817 Test Acc: 0.361
Validation loss decreased (-0.342233 --> -0.360880).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3476788
	speed: 0.5377s/iter; left time: 2099.5689s
Epoch: 5 cost time: 24.265987634658813
Epoch: 5, Steps: 154 | Train Loss: 1.529 Vali Loss: 3.190 Vali Acc: 0.187 Test Loss: 3.190 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1718085
	speed: 0.4947s/iter; left time: 1855.7687s
Epoch: 6 cost time: 23.15142512321472
Epoch: 6, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.445 Vali Acc: 0.351 Test Loss: 2.445 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3037307
	speed: 0.5127s/iter; left time: 1844.1533s
Epoch: 7 cost time: 25.14475679397583
Epoch: 7, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.680 Vali Acc: 0.384 Test Loss: 2.680 Test Acc: 0.384
Validation loss decreased (-0.360880 --> -0.383590).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7470729
	speed: 0.5400s/iter; left time: 1859.3664s
Epoch: 8 cost time: 25.098397731781006
Epoch: 8, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.751 Vali Acc: 0.305 Test Loss: 2.751 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2999215
	speed: 0.5165s/iter; left time: 1698.6598s
Epoch: 9 cost time: 23.633480548858643
Epoch: 9, Steps: 154 | Train Loss: 1.226 Vali Loss: 7.926 Vali Acc: 0.092 Test Loss: 7.926 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5182788
	speed: 0.4528s/iter; left time: 1419.4970s
Epoch: 10 cost time: 21.05087423324585
Epoch: 10, Steps: 154 | Train Loss: 1.172 Vali Loss: 6.220 Vali Acc: 0.107 Test Loss: 6.220 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.6165856
	speed: 0.4804s/iter; left time: 1432.0572s
Epoch: 11 cost time: 22.55642604827881
Epoch: 11, Steps: 154 | Train Loss: 1.140 Vali Loss: 4.951 Vali Acc: 0.109 Test Loss: 4.951 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1205758
	speed: 0.4747s/iter; left time: 1341.8453s
Epoch: 12 cost time: 21.39376735687256
Epoch: 12, Steps: 154 | Train Loss: 1.053 Vali Loss: 5.907 Vali Acc: 0.097 Test Loss: 5.907 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0130495
	speed: 0.4364s/iter; left time: 1166.3826s
Epoch: 13 cost time: 20.838498830795288
Epoch: 13, Steps: 154 | Train Loss: 1.049 Vali Loss: 8.263 Vali Acc: 0.080 Test Loss: 8.263 Test Acc: 0.080
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7530895
	speed: 0.4603s/iter; left time: 1159.4755s
Epoch: 14 cost time: 22.51023578643799
Epoch: 14, Steps: 154 | Train Loss: 1.011 Vali Loss: 8.837 Vali Acc: 0.103 Test Loss: 8.837 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.9359619
	speed: 0.4795s/iter; left time: 1134.0472s
Epoch: 15 cost time: 22.478692531585693
Epoch: 15, Steps: 154 | Train Loss: 0.951 Vali Loss: 6.178 Vali Acc: 0.152 Test Loss: 6.178 Test Acc: 0.152
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.0822018
	speed: 0.4496s/iter; left time: 994.1518s
Epoch: 16 cost time: 21.45415711402893
Epoch: 16, Steps: 154 | Train Loss: 0.893 Vali Loss: 9.949 Vali Acc: 0.090 Test Loss: 9.949 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.4623275
	speed: 0.5019s/iter; left time: 1032.3991s
Epoch: 17 cost time: 24.341418504714966
Epoch: 17, Steps: 154 | Train Loss: 0.867 Vali Loss: 6.621 Vali Acc: 0.111 Test Loss: 6.621 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38361719383617193
model parameter : 4164878
model size : 17.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2500670
	speed: 0.2915s/iter; left time: 1317.6542s
Epoch: 1 cost time: 43.58106708526611
Epoch: 1, Steps: 154 | Train Loss: 2.085 Vali Loss: 2.158 Vali Acc: 0.332 Test Loss: 2.158 Test Acc: 0.332
Validation loss decreased (inf --> -0.332095).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7986492
	speed: 0.7959s/iter; left time: 3475.5731s
Epoch: 2 cost time: 39.255898237228394
Epoch: 2, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.155 Vali Acc: 0.338 Test Loss: 2.155 Test Acc: 0.338
Validation loss decreased (-0.332095 --> -0.337772).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6284950
	speed: 0.8385s/iter; left time: 3532.4168s
Epoch: 3 cost time: 41.99561882019043
Epoch: 3, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.079 Vali Acc: 0.354 Test Loss: 2.079 Test Acc: 0.354
Validation loss decreased (-0.337772 --> -0.353588).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5375899
	speed: 0.7984s/iter; left time: 3240.8821s
Epoch: 4 cost time: 34.97941303253174
Epoch: 4, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.369 Vali Acc: 0.343 Test Loss: 2.369 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0558698
	speed: 0.7145s/iter; left time: 2790.0959s
Epoch: 5 cost time: 37.699957609176636
Epoch: 5, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.409 Vali Acc: 0.187 Test Loss: 2.409 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.5034742
	speed: 0.7430s/iter; left time: 2787.0779s
Epoch: 6 cost time: 35.72100877761841
Epoch: 6, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.088 Vali Acc: 0.339 Test Loss: 2.088 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5251633
	speed: 0.6885s/iter; left time: 2476.3922s
Epoch: 7 cost time: 35.3258740901947
Epoch: 7, Steps: 154 | Train Loss: 1.455 Vali Loss: 4.609 Vali Acc: 0.112 Test Loss: 4.609 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.6730117
	speed: 0.7545s/iter; left time: 2597.8437s
Epoch: 8 cost time: 37.46324443817139
Epoch: 8, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.076 Vali Acc: 0.202 Test Loss: 3.076 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2773341
	speed: 0.7562s/iter; left time: 2487.0357s
Epoch: 9 cost time: 38.68897247314453
Epoch: 9, Steps: 154 | Train Loss: 1.316 Vali Loss: 4.637 Vali Acc: 0.140 Test Loss: 4.637 Test Acc: 0.140
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.1294631
	speed: 0.8081s/iter; left time: 2533.4885s
Epoch: 10 cost time: 41.612409830093384
Epoch: 10, Steps: 154 | Train Loss: 1.285 Vali Loss: 3.318 Vali Acc: 0.213 Test Loss: 3.318 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.9801505
	speed: 0.8216s/iter; left time: 2449.1234s
Epoch: 11 cost time: 38.402459383010864
Epoch: 11, Steps: 154 | Train Loss: 1.201 Vali Loss: 4.066 Vali Acc: 0.098 Test Loss: 4.066 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.3263515
	speed: 0.7856s/iter; left time: 2220.9232s
Epoch: 12 cost time: 40.91730809211731
Epoch: 12, Steps: 154 | Train Loss: 1.145 Vali Loss: 4.074 Vali Acc: 0.125 Test Loss: 4.074 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7837808
	speed: 0.8432s/iter; left time: 2253.8677s
Epoch: 13 cost time: 39.46163272857666
Epoch: 13, Steps: 154 | Train Loss: 1.106 Vali Loss: 4.295 Vali Acc: 0.191 Test Loss: 4.295 Test Acc: 0.191
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35360908353609083
model parameter : 14094734
model size : 55.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4980270
	speed: 0.1210s/iter; left time: 547.1856s
Epoch: 1 cost time: 18.33871102333069
Epoch: 1, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.138 Vali Acc: 0.329 Test Loss: 2.138 Test Acc: 0.329
Validation loss decreased (inf --> -0.328851).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6687200
	speed: 0.3839s/iter; left time: 1676.6674s
Epoch: 2 cost time: 17.32813262939453
Epoch: 2, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.217 Vali Acc: 0.341 Test Loss: 2.217 Test Acc: 0.341
Validation loss decreased (-0.328851 --> -0.341421).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3666306
	speed: 0.3837s/iter; left time: 1616.4092s
Epoch: 3 cost time: 17.281982898712158
Epoch: 3, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.157 Vali Acc: 0.341 Test Loss: 2.157 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.8996954
	speed: 0.3522s/iter; left time: 1429.6769s
Epoch: 4 cost time: 15.794472932815552
Epoch: 4, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.726 Vali Acc: 0.364 Test Loss: 2.726 Test Acc: 0.364
Validation loss decreased (-0.341421 --> -0.363720).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3933023
	speed: 0.3453s/iter; left time: 1348.5792s
Epoch: 5 cost time: 16.040857553482056
Epoch: 5, Steps: 154 | Train Loss: 1.540 Vali Loss: 4.510 Vali Acc: 0.077 Test Loss: 4.510 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4046229
	speed: 0.3782s/iter; left time: 1418.6032s
Epoch: 6 cost time: 17.51084327697754
Epoch: 6, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.540 Vali Acc: 0.367 Test Loss: 2.540 Test Acc: 0.367
Validation loss decreased (-0.363720 --> -0.366966).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3876748
	speed: 0.3950s/iter; left time: 1420.9350s
Epoch: 7 cost time: 19.55671453475952
Epoch: 7, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.352 Vali Acc: 0.326 Test Loss: 3.352 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.9769438
	speed: 0.4076s/iter; left time: 1403.2484s
Epoch: 8 cost time: 18.249714374542236
Epoch: 8, Steps: 154 | Train Loss: 1.367 Vali Loss: 4.494 Vali Acc: 0.123 Test Loss: 4.494 Test Acc: 0.123
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3453808
	speed: 0.3991s/iter; left time: 1312.5748s
Epoch: 9 cost time: 18.344618558883667
Epoch: 9, Steps: 154 | Train Loss: 1.251 Vali Loss: 4.162 Vali Acc: 0.105 Test Loss: 4.162 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4054306
	speed: 0.4205s/iter; left time: 1318.3109s
Epoch: 10 cost time: 19.60297465324402
Epoch: 10, Steps: 154 | Train Loss: 1.229 Vali Loss: 3.631 Vali Acc: 0.227 Test Loss: 3.631 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.5383365
	speed: 0.4304s/iter; left time: 1283.1037s
Epoch: 11 cost time: 19.614441871643066
Epoch: 11, Steps: 154 | Train Loss: 1.172 Vali Loss: 2.913 Vali Acc: 0.158 Test Loss: 2.913 Test Acc: 0.158
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1172264
	speed: 0.4188s/iter; left time: 1183.8726s
Epoch: 12 cost time: 18.445417881011963
Epoch: 12, Steps: 154 | Train Loss: 1.105 Vali Loss: 5.499 Vali Acc: 0.084 Test Loss: 5.499 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9649490
	speed: 0.3983s/iter; left time: 1064.6613s
Epoch: 13 cost time: 18.603731870651245
Epoch: 13, Steps: 154 | Train Loss: 1.057 Vali Loss: 6.932 Vali Acc: 0.072 Test Loss: 6.932 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.6483839
	speed: 0.4163s/iter; left time: 1048.5432s
Epoch: 14 cost time: 19.734654664993286
Epoch: 14, Steps: 154 | Train Loss: 1.019 Vali Loss: 6.026 Vali Acc: 0.094 Test Loss: 6.026 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0064477
	speed: 0.4206s/iter; left time: 994.7549s
Epoch: 15 cost time: 17.629561185836792
Epoch: 15, Steps: 154 | Train Loss: 0.987 Vali Loss: 6.557 Vali Acc: 0.083 Test Loss: 6.557 Test Acc: 0.083
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.0115216
	speed: 0.3743s/iter; left time: 827.5588s
Epoch: 16 cost time: 16.223387718200684
Epoch: 16, Steps: 154 | Train Loss: 0.925 Vali Loss: 8.552 Vali Acc: 0.084 Test Loss: 8.552 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 4164878
model size : 17.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2394574
	speed: 0.1569s/iter; left time: 709.2025s
Epoch: 1 cost time: 24.021425485610962
Epoch: 1, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.117 Vali Acc: 0.329 Test Loss: 2.117 Test Acc: 0.329
Validation loss decreased (inf --> -0.329257).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7839178
	speed: 0.4773s/iter; left time: 2084.5490s
Epoch: 2 cost time: 23.475831508636475
Epoch: 2, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.023 Vali Acc: 0.351 Test Loss: 2.023 Test Acc: 0.351
Validation loss decreased (-0.329257 --> -0.351156).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6743382
	speed: 0.4792s/iter; left time: 2019.0173s
Epoch: 3 cost time: 22.20185160636902
Epoch: 3, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.067 Vali Acc: 0.360 Test Loss: 2.067 Test Acc: 0.360
Validation loss decreased (-0.351156 --> -0.360077).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6250882
	speed: 0.4474s/iter; left time: 1816.0357s
Epoch: 4 cost time: 22.177347421646118
Epoch: 4, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.275 Vali Acc: 0.364 Test Loss: 2.275 Test Acc: 0.364
Validation loss decreased (-0.360077 --> -0.364130).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2946980
	speed: 0.4752s/iter; left time: 1855.7799s
Epoch: 5 cost time: 23.701854944229126
Epoch: 5, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.518 Vali Acc: 0.210 Test Loss: 2.518 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.2209339
	speed: 0.5362s/iter; left time: 2011.4215s
Epoch: 6 cost time: 26.40627408027649
Epoch: 6, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.331 Vali Acc: 0.392 Test Loss: 2.331 Test Acc: 0.392
Validation loss decreased (-0.364130 --> -0.392110).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7308263
	speed: 0.5205s/iter; left time: 1872.2512s
Epoch: 7 cost time: 24.850775957107544
Epoch: 7, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.092 Vali Acc: 0.413 Test Loss: 2.092 Test Acc: 0.413
Validation loss decreased (-0.392110 --> -0.412793).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5337439
	speed: 0.5229s/iter; left time: 1800.3507s
Epoch: 8 cost time: 25.913055896759033
Epoch: 8, Steps: 154 | Train Loss: 1.393 Vali Loss: 3.629 Vali Acc: 0.209 Test Loss: 3.629 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4236497
	speed: 0.5448s/iter; left time: 1791.9490s
Epoch: 9 cost time: 26.453909397125244
Epoch: 9, Steps: 154 | Train Loss: 1.332 Vali Loss: 4.464 Vali Acc: 0.215 Test Loss: 4.464 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.8120952
	speed: 0.5355s/iter; left time: 1678.6573s
Epoch: 10 cost time: 24.98407292366028
Epoch: 10, Steps: 154 | Train Loss: 1.289 Vali Loss: 5.109 Vali Acc: 0.087 Test Loss: 5.109 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9608488
	speed: 0.5131s/iter; left time: 1529.4172s
Epoch: 11 cost time: 24.90971064567566
Epoch: 11, Steps: 154 | Train Loss: 1.207 Vali Loss: 4.078 Vali Acc: 0.106 Test Loss: 4.078 Test Acc: 0.106
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0958829
	speed: 0.5145s/iter; left time: 1454.6091s
Epoch: 12 cost time: 23.733396291732788
Epoch: 12, Steps: 154 | Train Loss: 1.157 Vali Loss: 3.601 Vali Acc: 0.390 Test Loss: 3.601 Test Acc: 0.390
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9873726
	speed: 0.4868s/iter; left time: 1301.1087s
Epoch: 13 cost time: 23.99867606163025
Epoch: 13, Steps: 154 | Train Loss: 1.118 Vali Loss: 4.337 Vali Acc: 0.147 Test Loss: 4.337 Test Acc: 0.147
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.1583282
	speed: 0.4536s/iter; left time: 1142.7102s
Epoch: 14 cost time: 21.805013179779053
Epoch: 14, Steps: 154 | Train Loss: 1.095 Vali Loss: 4.893 Vali Acc: 0.139 Test Loss: 4.893 Test Acc: 0.139
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2098888
	speed: 0.4548s/iter; left time: 1075.5989s
Epoch: 15 cost time: 23.43860960006714
Epoch: 15, Steps: 154 | Train Loss: 1.008 Vali Loss: 8.311 Vali Acc: 0.103 Test Loss: 8.311 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.8868568
	speed: 0.4859s/iter; left time: 1074.3534s
Epoch: 16 cost time: 23.91343402862549
Epoch: 16, Steps: 154 | Train Loss: 0.953 Vali Loss: 8.415 Vali Acc: 0.101 Test Loss: 8.415 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.7432906
	speed: 0.4719s/iter; left time: 970.7462s
Epoch: 17 cost time: 21.87242317199707
Epoch: 17, Steps: 154 | Train Loss: 0.953 Vali Loss: 6.579 Vali Acc: 0.136 Test Loss: 6.579 Test Acc: 0.136
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41281427412814276
model parameter : 14094734
model size : 55.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5276849
	speed: 0.1060s/iter; left time: 479.3033s
Epoch: 1 cost time: 15.733033418655396
Epoch: 1, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.144 Vali Acc: 0.325 Test Loss: 2.144 Test Acc: 0.325
Validation loss decreased (inf --> -0.324796).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7017121
	speed: 0.3329s/iter; left time: 1453.9640s
Epoch: 2 cost time: 14.62978196144104
Epoch: 2, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.155 Vali Acc: 0.341 Test Loss: 2.155 Test Acc: 0.341
Validation loss decreased (-0.324796 --> -0.340611).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4821680
	speed: 0.3310s/iter; left time: 1394.6396s
Epoch: 3 cost time: 14.325534105300903
Epoch: 3, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.155 Vali Acc: 0.202 Test Loss: 2.155 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.0067450
	speed: 0.3136s/iter; left time: 1273.0323s
Epoch: 4 cost time: 13.351293563842773
Epoch: 4, Steps: 154 | Train Loss: 1.649 Vali Loss: 2.574 Vali Acc: 0.361 Test Loss: 2.574 Test Acc: 0.361
Validation loss decreased (-0.340611 --> -0.360883).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6166749
	speed: 0.3037s/iter; left time: 1186.1101s
Epoch: 5 cost time: 13.498816967010498
Epoch: 5, Steps: 154 | Train Loss: 1.558 Vali Loss: 4.187 Vali Acc: 0.192 Test Loss: 4.187 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3463384
	speed: 0.3055s/iter; left time: 1145.8969s
Epoch: 6 cost time: 13.766174793243408
Epoch: 6, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.305 Vali Acc: 0.384 Test Loss: 2.305 Test Acc: 0.384
Validation loss decreased (-0.360883 --> -0.384000).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4510467
	speed: 0.3394s/iter; left time: 1220.7146s
Epoch: 7 cost time: 14.636664390563965
Epoch: 7, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.674 Vali Acc: 0.387 Test Loss: 3.674 Test Acc: 0.387
Validation loss decreased (-0.384000 --> -0.386825).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.8532814
	speed: 0.3318s/iter; left time: 1142.5556s
Epoch: 8 cost time: 14.365835189819336
Epoch: 8, Steps: 154 | Train Loss: 1.397 Vali Loss: 5.366 Vali Acc: 0.122 Test Loss: 5.366 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7156972
	speed: 0.3210s/iter; left time: 1055.8751s
Epoch: 9 cost time: 13.300343751907349
Epoch: 9, Steps: 154 | Train Loss: 1.312 Vali Loss: 5.719 Vali Acc: 0.084 Test Loss: 5.719 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4641515
	speed: 0.3039s/iter; left time: 952.6188s
Epoch: 10 cost time: 13.167235851287842
Epoch: 10, Steps: 154 | Train Loss: 1.276 Vali Loss: 4.498 Vali Acc: 0.173 Test Loss: 4.498 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.7809500
	speed: 0.2998s/iter; left time: 893.6405s
Epoch: 11 cost time: 11.851458311080933
Epoch: 11, Steps: 154 | Train Loss: 1.218 Vali Loss: 4.885 Vali Acc: 0.201 Test Loss: 4.885 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2704511
	speed: 0.2909s/iter; left time: 822.4946s
Epoch: 12 cost time: 12.821706533432007
Epoch: 12, Steps: 154 | Train Loss: 1.147 Vali Loss: 9.666 Vali Acc: 0.076 Test Loss: 9.666 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.7278279
	speed: 0.2932s/iter; left time: 783.6456s
Epoch: 13 cost time: 12.812058925628662
Epoch: 13, Steps: 154 | Train Loss: 1.122 Vali Loss: 11.928 Vali Acc: 0.063 Test Loss: 11.928 Test Acc: 0.063
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.5711883
	speed: 0.2885s/iter; left time: 726.8173s
Epoch: 14 cost time: 12.090522527694702
Epoch: 14, Steps: 154 | Train Loss: 1.098 Vali Loss: 9.351 Vali Acc: 0.085 Test Loss: 9.351 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2601202
	speed: 0.2689s/iter; left time: 635.9080s
Epoch: 15 cost time: 11.680912494659424
Epoch: 15, Steps: 154 | Train Loss: 1.047 Vali Loss: 9.299 Vali Acc: 0.074 Test Loss: 9.299 Test Acc: 0.074
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.0777400
	speed: 0.2736s/iter; left time: 604.8318s
Epoch: 16 cost time: 11.896741151809692
Epoch: 16, Steps: 154 | Train Loss: 0.981 Vali Loss: 9.005 Vali Acc: 0.095 Test Loss: 9.005 Test Acc: 0.095
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.5644313
	speed: 0.2786s/iter; left time: 573.1540s
Epoch: 17 cost time: 12.807658433914185
Epoch: 17, Steps: 154 | Train Loss: 0.952 Vali Loss: 10.138 Vali Acc: 0.097 Test Loss: 10.138 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 4164878
model size : 17.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7952704
	speed: 0.2436s/iter; left time: 1101.0965s
Epoch: 1 cost time: 35.931822061538696
Epoch: 1, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.060 Vali Acc: 0.340 Test Loss: 2.060 Test Acc: 0.340
Validation loss decreased (inf --> -0.340206).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5126245
	speed: 0.7245s/iter; left time: 3163.9932s
Epoch: 2 cost time: 35.439313888549805
Epoch: 2, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.124 Vali Acc: 0.341 Test Loss: 2.124 Test Acc: 0.341
Validation loss decreased (-0.340206 --> -0.341422).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5489056
	speed: 0.8277s/iter; left time: 3487.3052s
Epoch: 3 cost time: 38.312496185302734
Epoch: 3, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.193 Vali Acc: 0.365 Test Loss: 2.193 Test Acc: 0.365
Validation loss decreased (-0.341422 --> -0.364942).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5063777
	speed: 0.8134s/iter; left time: 3301.7645s
Epoch: 4 cost time: 36.06397247314453
Epoch: 4, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.828 Vali Acc: 0.187 Test Loss: 2.828 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9665699
	speed: 0.8002s/iter; left time: 3124.5930s
Epoch: 5 cost time: 38.32629036903381
Epoch: 5, Steps: 154 | Train Loss: 1.532 Vali Loss: 5.065 Vali Acc: 0.076 Test Loss: 5.065 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8878462
	speed: 0.8328s/iter; left time: 3123.7203s
Epoch: 6 cost time: 37.16614007949829
Epoch: 6, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.525 Vali Acc: 0.146 Test Loss: 2.525 Test Acc: 0.146
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2010137
	speed: 0.7251s/iter; left time: 2608.3225s
Epoch: 7 cost time: 32.639737606048584
Epoch: 7, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.235 Vali Acc: 0.373 Test Loss: 2.235 Test Acc: 0.373
Validation loss decreased (-0.364942 --> -0.373051).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8767202
	speed: 0.7528s/iter; left time: 2591.9462s
Epoch: 8 cost time: 34.961987018585205
Epoch: 8, Steps: 154 | Train Loss: 1.346 Vali Loss: 2.971 Vali Acc: 0.104 Test Loss: 2.971 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6978867
	speed: 0.7023s/iter; left time: 2309.9293s
Epoch: 9 cost time: 31.96728277206421
Epoch: 9, Steps: 154 | Train Loss: 1.285 Vali Loss: 5.130 Vali Acc: 0.094 Test Loss: 5.130 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0238379
	speed: 0.7246s/iter; left time: 2271.7223s
Epoch: 10 cost time: 35.09113001823425
Epoch: 10, Steps: 154 | Train Loss: 1.222 Vali Loss: 3.913 Vali Acc: 0.204 Test Loss: 3.913 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.8537570
	speed: 0.7311s/iter; left time: 2179.4929s
Epoch: 11 cost time: 32.27921390533447
Epoch: 11, Steps: 154 | Train Loss: 1.177 Vali Loss: 3.743 Vali Acc: 0.184 Test Loss: 3.743 Test Acc: 0.184
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1925669
	speed: 0.7773s/iter; left time: 2197.4579s
Epoch: 12 cost time: 38.09604811668396
Epoch: 12, Steps: 154 | Train Loss: 1.156 Vali Loss: 3.614 Vali Acc: 0.090 Test Loss: 3.614 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3676697
	speed: 0.8363s/iter; left time: 2235.4464s
Epoch: 13 cost time: 37.93997144699097
Epoch: 13, Steps: 154 | Train Loss: 1.124 Vali Loss: 3.657 Vali Acc: 0.126 Test Loss: 3.657 Test Acc: 0.126
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.9678028
	speed: 0.7892s/iter; left time: 1988.0115s
Epoch: 14 cost time: 36.457767724990845
Epoch: 14, Steps: 154 | Train Loss: 1.073 Vali Loss: 5.849 Vali Acc: 0.135 Test Loss: 5.849 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.7499692
	speed: 0.7173s/iter; left time: 1696.4760s
Epoch: 15 cost time: 29.388267993927002
Epoch: 15, Steps: 154 | Train Loss: 1.018 Vali Loss: 3.386 Vali Acc: 0.107 Test Loss: 3.386 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1451688
	speed: 0.7121s/iter; left time: 1574.5407s
Epoch: 16 cost time: 28.166407823562622
Epoch: 16, Steps: 154 | Train Loss: 0.991 Vali Loss: 9.450 Vali Acc: 0.093 Test Loss: 9.450 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.9524338
	speed: 0.6545s/iter; left time: 1346.2101s
Epoch: 17 cost time: 29.132111310958862
Epoch: 17, Steps: 154 | Train Loss: 0.939 Vali Loss: 4.079 Vali Acc: 0.113 Test Loss: 4.079 Test Acc: 0.113
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37307380373073806
model parameter : 7064846
model size : 28.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0737133
	speed: 0.1100s/iter; left time: 497.2948s
Epoch: 1 cost time: 15.84573769569397
Epoch: 1, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.133 Vali Acc: 0.333 Test Loss: 2.133 Test Acc: 0.333
Validation loss decreased (inf --> -0.333312).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8551996
	speed: 0.3144s/iter; left time: 1373.0876s
Epoch: 2 cost time: 15.794715881347656
Epoch: 2, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.163 Vali Acc: 0.199 Test Loss: 2.163 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1956029
	speed: 0.3334s/iter; left time: 1404.7965s
Epoch: 3 cost time: 14.080502986907959
Epoch: 3, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.180 Vali Acc: 0.356 Test Loss: 2.180 Test Acc: 0.356
Validation loss decreased (-0.333312 --> -0.356020).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3159708
	speed: 0.3101s/iter; left time: 1258.8534s
Epoch: 4 cost time: 15.51303482055664
Epoch: 4, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.255 Vali Acc: 0.198 Test Loss: 2.255 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3196710
	speed: 0.3731s/iter; left time: 1457.0423s
Epoch: 5 cost time: 16.808693408966064
Epoch: 5, Steps: 154 | Train Loss: 1.490 Vali Loss: 3.512 Vali Acc: 0.190 Test Loss: 3.512 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.8115320
	speed: 0.3504s/iter; left time: 1314.3980s
Epoch: 6 cost time: 16.849220037460327
Epoch: 6, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.860 Vali Acc: 0.115 Test Loss: 3.860 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.0360764
	speed: 0.3947s/iter; left time: 1419.7498s
Epoch: 7 cost time: 17.461172819137573
Epoch: 7, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.648 Vali Acc: 0.215 Test Loss: 2.648 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.5272554
	speed: 0.3534s/iter; left time: 1216.8395s
Epoch: 8 cost time: 16.530597448349
Epoch: 8, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.651 Vali Acc: 0.152 Test Loss: 2.651 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.8970618
	speed: 0.3928s/iter; left time: 1291.7734s
Epoch: 9 cost time: 18.13185954093933
Epoch: 9, Steps: 154 | Train Loss: 1.290 Vali Loss: 5.085 Vali Acc: 0.095 Test Loss: 5.085 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.3229700
	speed: 0.3588s/iter; left time: 1124.8504s
Epoch: 10 cost time: 16.052817344665527
Epoch: 10, Steps: 154 | Train Loss: 1.237 Vali Loss: 4.273 Vali Acc: 0.092 Test Loss: 4.273 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.1749430
	speed: 0.3803s/iter; left time: 1133.5945s
Epoch: 11 cost time: 18.154701948165894
Epoch: 11, Steps: 154 | Train Loss: 1.202 Vali Loss: 4.682 Vali Acc: 0.091 Test Loss: 4.682 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.3562515
	speed: 0.3711s/iter; left time: 1049.1732s
Epoch: 12 cost time: 16.116917610168457
Epoch: 12, Steps: 154 | Train Loss: 1.145 Vali Loss: 4.118 Vali Acc: 0.103 Test Loss: 4.118 Test Acc: 0.103
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.1527424
	speed: 0.3406s/iter; left time: 910.4739s
Epoch: 13 cost time: 16.008652687072754
Epoch: 13, Steps: 154 | Train Loss: 1.093 Vali Loss: 4.267 Vali Acc: 0.156 Test Loss: 4.267 Test Acc: 0.156
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3560421735604217
model parameter : 2099726
model size : 9.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8110316
	speed: 0.1548s/iter; left time: 700.0752s
Epoch: 1 cost time: 23.81386637687683
Epoch: 1, Steps: 154 | Train Loss: 2.082 Vali Loss: 2.102 Vali Acc: 0.345 Test Loss: 2.102 Test Acc: 0.345
Validation loss decreased (inf --> -0.345478).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5784907
	speed: 0.4860s/iter; left time: 2122.1480s
Epoch: 2 cost time: 20.473772525787354
Epoch: 2, Steps: 154 | Train Loss: 1.847 Vali Loss: 2.186 Vali Acc: 0.344 Test Loss: 2.186 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9420217
	speed: 0.4605s/iter; left time: 1939.9041s
Epoch: 3 cost time: 22.91893219947815
Epoch: 3, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.362 Vali Acc: 0.355 Test Loss: 2.362 Test Acc: 0.355
Validation loss decreased (-0.345478 --> -0.354802).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4643874
	speed: 0.4643s/iter; left time: 1884.4768s
Epoch: 4 cost time: 20.126956462860107
Epoch: 4, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.356 Vali Acc: 0.359 Test Loss: 2.356 Test Acc: 0.359
Validation loss decreased (-0.354802 --> -0.359263).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.0295701
	speed: 0.4828s/iter; left time: 1885.2846s
Epoch: 5 cost time: 21.619515657424927
Epoch: 5, Steps: 154 | Train Loss: 1.540 Vali Loss: 4.105 Vali Acc: 0.074 Test Loss: 4.105 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0636330
	speed: 0.5000s/iter; left time: 1875.6765s
Epoch: 6 cost time: 25.335292100906372
Epoch: 6, Steps: 154 | Train Loss: 1.451 Vali Loss: 3.739 Vali Acc: 0.117 Test Loss: 3.739 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3177487
	speed: 0.5447s/iter; left time: 1959.2423s
Epoch: 7 cost time: 23.35464072227478
Epoch: 7, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.827 Vali Acc: 0.204 Test Loss: 2.827 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.9277282
	speed: 0.5462s/iter; left time: 1880.6372s
Epoch: 8 cost time: 26.064955949783325
Epoch: 8, Steps: 154 | Train Loss: 1.371 Vali Loss: 3.853 Vali Acc: 0.112 Test Loss: 3.853 Test Acc: 0.112
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.6915793
	speed: 0.5161s/iter; left time: 1697.3441s
Epoch: 9 cost time: 24.42025661468506
Epoch: 9, Steps: 154 | Train Loss: 1.335 Vali Loss: 5.745 Vali Acc: 0.099 Test Loss: 5.745 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.6724024
	speed: 0.5599s/iter; left time: 1755.4092s
Epoch: 10 cost time: 23.848785161972046
Epoch: 10, Steps: 154 | Train Loss: 1.228 Vali Loss: 4.689 Vali Acc: 0.154 Test Loss: 4.689 Test Acc: 0.154
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.9654049
	speed: 0.5030s/iter; left time: 1499.5851s
Epoch: 11 cost time: 21.55792808532715
Epoch: 11, Steps: 154 | Train Loss: 1.220 Vali Loss: 5.708 Vali Acc: 0.094 Test Loss: 5.708 Test Acc: 0.094
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.3655457
	speed: 0.4547s/iter; left time: 1285.4313s
Epoch: 12 cost time: 25.087373971939087
Epoch: 12, Steps: 154 | Train Loss: 1.191 Vali Loss: 4.579 Vali Acc: 0.099 Test Loss: 4.579 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.2630345
	speed: 0.5193s/iter; left time: 1388.2212s
Epoch: 13 cost time: 22.507736921310425
Epoch: 13, Steps: 154 | Train Loss: 1.128 Vali Loss: 5.188 Vali Acc: 0.147 Test Loss: 5.188 Test Acc: 0.147
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0429050
	speed: 0.5007s/iter; left time: 1261.3875s
Epoch: 14 cost time: 24.756420373916626
Epoch: 14, Steps: 154 | Train Loss: 1.065 Vali Loss: 4.860 Vali Acc: 0.114 Test Loss: 4.860 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35928629359286296
model parameter : 7064846
model size : 28.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1406283
	speed: 0.1049s/iter; left time: 474.4606s
Epoch: 1 cost time: 14.933497428894043
Epoch: 1, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.130 Vali Acc: 0.333 Test Loss: 2.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333312).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8492750
	speed: 0.3042s/iter; left time: 1328.3514s
Epoch: 2 cost time: 14.145058155059814
Epoch: 2, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.142 Vali Acc: 0.193 Test Loss: 2.142 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.2347779
	speed: 0.3409s/iter; left time: 1436.2805s
Epoch: 3 cost time: 15.224676370620728
Epoch: 3, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.128 Vali Acc: 0.358 Test Loss: 2.128 Test Acc: 0.358
Validation loss decreased (-0.333312 --> -0.357643).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2887052
	speed: 0.3469s/iter; left time: 1408.1470s
Epoch: 4 cost time: 15.226550340652466
Epoch: 4, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.179 Vali Acc: 0.354 Test Loss: 2.179 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4476241
	speed: 0.3469s/iter; left time: 1354.5000s
Epoch: 5 cost time: 15.048124074935913
Epoch: 5, Steps: 154 | Train Loss: 1.520 Vali Loss: 3.567 Vali Acc: 0.115 Test Loss: 3.567 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.9194450
	speed: 0.3749s/iter; left time: 1406.3628s
Epoch: 6 cost time: 16.45072340965271
Epoch: 6, Steps: 154 | Train Loss: 1.452 Vali Loss: 4.538 Vali Acc: 0.109 Test Loss: 4.538 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.9576743
	speed: 0.3840s/iter; left time: 1381.4191s
Epoch: 7 cost time: 15.764425277709961
Epoch: 7, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.722 Vali Acc: 0.214 Test Loss: 2.722 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.4288461
	speed: 0.3466s/iter; left time: 1193.3636s
Epoch: 8 cost time: 15.203754901885986
Epoch: 8, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.779 Vali Acc: 0.230 Test Loss: 2.779 Test Acc: 0.230
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.8772472
	speed: 0.3593s/iter; left time: 1181.6711s
Epoch: 9 cost time: 16.396236658096313
Epoch: 9, Steps: 154 | Train Loss: 1.314 Vali Loss: 4.842 Vali Acc: 0.103 Test Loss: 4.842 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.3588718
	speed: 0.3826s/iter; left time: 1199.4726s
Epoch: 10 cost time: 16.452675104141235
Epoch: 10, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.995 Vali Acc: 0.241 Test Loss: 2.995 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.1211675
	speed: 0.3665s/iter; left time: 1092.5893s
Epoch: 11 cost time: 15.190342426300049
Epoch: 11, Steps: 154 | Train Loss: 1.239 Vali Loss: 5.763 Vali Acc: 0.087 Test Loss: 5.763 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.3622892
	speed: 0.3418s/iter; left time: 966.4082s
Epoch: 12 cost time: 14.617942094802856
Epoch: 12, Steps: 154 | Train Loss: 1.144 Vali Loss: 5.278 Vali Acc: 0.090 Test Loss: 5.278 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.0952473
	speed: 0.3373s/iter; left time: 901.7174s
Epoch: 13 cost time: 14.69233226776123
Epoch: 13, Steps: 154 | Train Loss: 1.099 Vali Loss: 3.947 Vali Acc: 0.205 Test Loss: 3.947 Test Acc: 0.205
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35766423357664234
model parameter : 2099726
model size : 9.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8308648
	speed: 0.1066s/iter; left time: 482.0296s
Epoch: 1 cost time: 15.832741975784302
Epoch: 1, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.115 Vali Acc: 0.339 Test Loss: 2.115 Test Acc: 0.339
Validation loss decreased (inf --> -0.338584).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6103920
	speed: 0.3302s/iter; left time: 1441.8144s
Epoch: 2 cost time: 15.774133682250977
Epoch: 2, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.246 Vali Acc: 0.337 Test Loss: 2.246 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8184937
	speed: 0.3511s/iter; left time: 1479.1104s
Epoch: 3 cost time: 15.700604915618896
Epoch: 3, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.336 Vali Acc: 0.368 Test Loss: 2.336 Test Acc: 0.368
Validation loss decreased (-0.338584 --> -0.367779).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4863225
	speed: 0.3355s/iter; left time: 1361.8168s
Epoch: 4 cost time: 14.698646068572998
Epoch: 4, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.632 Vali Acc: 0.357 Test Loss: 2.632 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2014635
	speed: 0.3147s/iter; left time: 1229.0358s
Epoch: 5 cost time: 14.54843521118164
Epoch: 5, Steps: 154 | Train Loss: 1.598 Vali Loss: 3.533 Vali Acc: 0.082 Test Loss: 3.533 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7161256
	speed: 0.3519s/iter; left time: 1320.0526s
Epoch: 6 cost time: 15.709798097610474
Epoch: 6, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.572 Vali Acc: 0.185 Test Loss: 2.572 Test Acc: 0.185
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2531148
	speed: 0.3563s/iter; left time: 1281.7097s
Epoch: 7 cost time: 16.417442798614502
Epoch: 7, Steps: 154 | Train Loss: 1.485 Vali Loss: 4.195 Vali Acc: 0.066 Test Loss: 4.195 Test Acc: 0.066
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 2.0552702
	speed: 0.3637s/iter; left time: 1252.3632s
Epoch: 8 cost time: 16.194790601730347
Epoch: 8, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.631 Vali Acc: 0.378 Test Loss: 3.631 Test Acc: 0.378
Validation loss decreased (-0.367779 --> -0.377498).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2743974
	speed: 0.3848s/iter; left time: 1265.6957s
Epoch: 9 cost time: 17.58717942237854
Epoch: 9, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.920 Vali Acc: 0.157 Test Loss: 3.920 Test Acc: 0.157
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.7316926
	speed: 0.4005s/iter; left time: 1255.5247s
Epoch: 10 cost time: 17.705009698867798
Epoch: 10, Steps: 154 | Train Loss: 1.321 Vali Loss: 5.191 Vali Acc: 0.182 Test Loss: 5.191 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.8415353
	speed: 0.3699s/iter; left time: 1102.5264s
Epoch: 11 cost time: 16.127121686935425
Epoch: 11, Steps: 154 | Train Loss: 1.266 Vali Loss: 8.496 Vali Acc: 0.067 Test Loss: 8.496 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1469882
	speed: 0.3746s/iter; left time: 1059.1231s
Epoch: 12 cost time: 17.439809560775757
Epoch: 12, Steps: 154 | Train Loss: 1.291 Vali Loss: 8.094 Vali Acc: 0.059 Test Loss: 8.094 Test Acc: 0.059
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.5007643
	speed: 0.4017s/iter; left time: 1073.8571s
Epoch: 13 cost time: 17.589234352111816
Epoch: 13, Steps: 154 | Train Loss: 1.203 Vali Loss: 5.093 Vali Acc: 0.223 Test Loss: 5.093 Test Acc: 0.223
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.1663960
	speed: 0.3840s/iter; left time: 967.3703s
Epoch: 14 cost time: 16.41750693321228
Epoch: 14, Steps: 154 | Train Loss: 1.164 Vali Loss: 6.310 Vali Acc: 0.089 Test Loss: 6.310 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.8612377
	speed: 0.3685s/iter; left time: 871.4971s
Epoch: 15 cost time: 16.272834539413452
Epoch: 15, Steps: 154 | Train Loss: 1.109 Vali Loss: 8.617 Vali Acc: 0.123 Test Loss: 8.617 Test Acc: 0.123
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1996071
	speed: 0.3544s/iter; left time: 783.4987s
Epoch: 16 cost time: 15.807360649108887
Epoch: 16, Steps: 154 | Train Loss: 1.047 Vali Loss: 10.706 Vali Acc: 0.073 Test Loss: 10.706 Test Acc: 0.073
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.1301361
	speed: 0.3559s/iter; left time: 732.0181s
Epoch: 17 cost time: 15.12471055984497
Epoch: 17, Steps: 154 | Train Loss: 0.998 Vali Loss: 8.508 Vali Acc: 0.084 Test Loss: 8.508 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.0101869
	speed: 0.3199s/iter; left time: 608.7687s
Epoch: 18 cost time: 14.36306357383728
Epoch: 18, Steps: 154 | Train Loss: 1.015 Vali Loss: 8.046 Vali Acc: 0.095 Test Loss: 8.046 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 7064846
model size : 28.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1566744
	speed: 0.0784s/iter; left time: 354.5549s
Epoch: 1 cost time: 11.529683828353882
Epoch: 1, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.133 Vali Acc: 0.328 Test Loss: 2.133 Test Acc: 0.328
Validation loss decreased (inf --> -0.327635).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8868114
	speed: 0.2616s/iter; left time: 1142.5956s
Epoch: 2 cost time: 10.303455114364624
Epoch: 2, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.024 Vali Acc: 0.351 Test Loss: 2.024 Test Acc: 0.351
Validation loss decreased (-0.327635 --> -0.350750).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3148820
	speed: 0.2383s/iter; left time: 1003.9908s
Epoch: 3 cost time: 9.12167239189148
Epoch: 3, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.091 Vali Acc: 0.354 Test Loss: 2.091 Test Acc: 0.354
Validation loss decreased (-0.350750 --> -0.354399).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4107738
	speed: 0.2339s/iter; left time: 949.2434s
Epoch: 4 cost time: 9.809186220169067
Epoch: 4, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.082 Vali Acc: 0.214 Test Loss: 2.082 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4962620
	speed: 0.2570s/iter; left time: 1003.4586s
Epoch: 5 cost time: 10.414030313491821
Epoch: 5, Steps: 154 | Train Loss: 1.557 Vali Loss: 3.146 Vali Acc: 0.192 Test Loss: 3.146 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7505444
	speed: 0.2519s/iter; left time: 944.9725s
Epoch: 6 cost time: 9.860460042953491
Epoch: 6, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.862 Vali Acc: 0.199 Test Loss: 2.862 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.0728346
	speed: 0.2392s/iter; left time: 860.5041s
Epoch: 7 cost time: 9.897225379943848
Epoch: 7, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.034 Vali Acc: 0.211 Test Loss: 3.034 Test Acc: 0.211
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3211610
	speed: 0.2371s/iter; left time: 816.2408s
Epoch: 8 cost time: 9.967914819717407
Epoch: 8, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.489 Vali Acc: 0.178 Test Loss: 3.489 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.9038343
	speed: 0.2540s/iter; left time: 835.5696s
Epoch: 9 cost time: 10.444639921188354
Epoch: 9, Steps: 154 | Train Loss: 1.366 Vali Loss: 6.077 Vali Acc: 0.089 Test Loss: 6.077 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.2427877
	speed: 0.2621s/iter; left time: 821.5488s
Epoch: 10 cost time: 10.555393695831299
Epoch: 10, Steps: 154 | Train Loss: 1.319 Vali Loss: 4.673 Vali Acc: 0.093 Test Loss: 4.673 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.1153717
	speed: 0.2338s/iter; left time: 696.8201s
Epoch: 11 cost time: 7.643138647079468
Epoch: 11, Steps: 154 | Train Loss: 1.262 Vali Loss: 6.601 Vali Acc: 0.094 Test Loss: 6.601 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.6151135
	speed: 0.1717s/iter; left time: 485.4618s
Epoch: 12 cost time: 8.940686702728271
Epoch: 12, Steps: 154 | Train Loss: 1.205 Vali Loss: 8.263 Vali Acc: 0.076 Test Loss: 8.263 Test Acc: 0.076
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.3233562
	speed: 0.3055s/iter; left time: 816.6808s
Epoch: 13 cost time: 12.643158674240112
Epoch: 13, Steps: 154 | Train Loss: 1.150 Vali Loss: 5.920 Vali Acc: 0.074 Test Loss: 5.920 Test Acc: 0.074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3544201135442011
model parameter : 2099726
model size : 9.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6946149
	speed: 0.2320s/iter; left time: 1048.9059s
Epoch: 1 cost time: 34.99930477142334
Epoch: 1, Steps: 154 | Train Loss: 2.102 Vali Loss: 2.034 Vali Acc: 0.337 Test Loss: 2.034 Test Acc: 0.337
Validation loss decreased (inf --> -0.337368).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5986900
	speed: 0.6781s/iter; left time: 2961.4565s
Epoch: 2 cost time: 34.5677330493927
Epoch: 2, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.312 Vali Acc: 0.331 Test Loss: 2.312 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8384129
	speed: 0.7198s/iter; left time: 3032.6713s
Epoch: 3 cost time: 34.64733862876892
Epoch: 3, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.127 Vali Acc: 0.354 Test Loss: 2.127 Test Acc: 0.354
Validation loss decreased (-0.337368 --> -0.353588).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9881473
	speed: 0.6768s/iter; left time: 2747.3095s
Epoch: 4 cost time: 33.64893126487732
Epoch: 4, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.720 Vali Acc: 0.347 Test Loss: 2.720 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7652729
	speed: 0.7146s/iter; left time: 2790.6149s
Epoch: 5 cost time: 35.48173189163208
Epoch: 5, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.049 Vali Acc: 0.385 Test Loss: 2.049 Test Acc: 0.385
Validation loss decreased (-0.353588 --> -0.384813).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3583832
	speed: 0.6861s/iter; left time: 2573.6391s
Epoch: 6 cost time: 33.265623331069946
Epoch: 6, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.259 Vali Acc: 0.302 Test Loss: 2.259 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4410527
	speed: 0.7058s/iter; left time: 2538.7591s
Epoch: 7 cost time: 35.36261320114136
Epoch: 7, Steps: 154 | Train Loss: 1.451 Vali Loss: 3.131 Vali Acc: 0.125 Test Loss: 3.131 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9130936
	speed: 0.6929s/iter; left time: 2385.5466s
Epoch: 8 cost time: 33.10128378868103
Epoch: 8, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.572 Vali Acc: 0.180 Test Loss: 2.572 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3107585
	speed: 0.6908s/iter; left time: 2272.0485s
Epoch: 9 cost time: 35.47524571418762
Epoch: 9, Steps: 154 | Train Loss: 1.369 Vali Loss: 2.858 Vali Acc: 0.176 Test Loss: 2.858 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.1233538
	speed: 0.6723s/iter; left time: 2107.7425s
Epoch: 10 cost time: 30.399012327194214
Epoch: 10, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.488 Vali Acc: 0.394 Test Loss: 2.488 Test Acc: 0.394
Validation loss decreased (-0.384813 --> -0.393730).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4372596
	speed: 0.6227s/iter; left time: 1856.3643s
Epoch: 11 cost time: 31.652747869491577
Epoch: 11, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.811 Vali Acc: 0.155 Test Loss: 2.811 Test Acc: 0.155
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8738124
	speed: 0.6546s/iter; left time: 1850.5882s
Epoch: 12 cost time: 31.256439685821533
Epoch: 12, Steps: 154 | Train Loss: 1.207 Vali Loss: 3.265 Vali Acc: 0.110 Test Loss: 3.265 Test Acc: 0.110
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6651838
	speed: 0.6073s/iter; left time: 1623.2178s
Epoch: 13 cost time: 30.65097165107727
Epoch: 13, Steps: 154 | Train Loss: 1.163 Vali Loss: 3.108 Vali Acc: 0.110 Test Loss: 3.108 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.8602505
	speed: 0.6513s/iter; left time: 1640.6230s
Epoch: 14 cost time: 32.54440975189209
Epoch: 14, Steps: 154 | Train Loss: 1.142 Vali Loss: 3.365 Vali Acc: 0.140 Test Loss: 3.365 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1267220
	speed: 0.6218s/iter; left time: 1470.5639s
Epoch: 15 cost time: 30.34472417831421
Epoch: 15, Steps: 154 | Train Loss: 1.095 Vali Loss: 3.913 Vali Acc: 0.148 Test Loss: 3.913 Test Acc: 0.148
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.1084832
	speed: 0.5581s/iter; left time: 1233.8602s
Epoch: 16 cost time: 24.021605253219604
Epoch: 16, Steps: 154 | Train Loss: 1.059 Vali Loss: 6.976 Vali Acc: 0.096 Test Loss: 6.976 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.0352746
	speed: 0.5671s/iter; left time: 1166.5594s
Epoch: 17 cost time: 26.400833129882812
Epoch: 17, Steps: 154 | Train Loss: 1.016 Vali Loss: 4.905 Vali Acc: 0.107 Test Loss: 4.905 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8070905
	speed: 0.5881s/iter; left time: 1119.1511s
Epoch: 18 cost time: 30.25650668144226
Epoch: 18, Steps: 154 | Train Loss: 0.991 Vali Loss: 5.659 Vali Acc: 0.115 Test Loss: 5.659 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1089407
	speed: 0.6323s/iter; left time: 1105.8754s
Epoch: 19 cost time: 31.65230107307434
Epoch: 19, Steps: 154 | Train Loss: 0.930 Vali Loss: 4.654 Vali Acc: 0.096 Test Loss: 4.654 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.6424407
	speed: 0.6186s/iter; left time: 986.7018s
Epoch: 20 cost time: 32.718085527420044
Epoch: 20, Steps: 154 | Train Loss: 0.897 Vali Loss: 8.345 Vali Acc: 0.096 Test Loss: 8.345 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3937550689375507
model parameter : 7048526
model size : 27.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0700917
	speed: 0.1417s/iter; left time: 640.5303s
Epoch: 1 cost time: 21.022644758224487
Epoch: 1, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.087 Vali Acc: 0.324 Test Loss: 2.087 Test Acc: 0.324
Validation loss decreased (inf --> -0.323986).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0190182
	speed: 0.3844s/iter; left time: 1678.7448s
Epoch: 2 cost time: 17.614293098449707
Epoch: 2, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.090 Vali Acc: 0.348 Test Loss: 2.090 Test Acc: 0.348
Validation loss decreased (-0.323986 --> -0.347911).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9594665
	speed: 0.4108s/iter; left time: 1730.7309s
Epoch: 3 cost time: 18.4726665019989
Epoch: 3, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.212 Vali Acc: 0.171 Test Loss: 2.212 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.4055914
	speed: 0.3804s/iter; left time: 1543.8632s
Epoch: 4 cost time: 18.455397844314575
Epoch: 4, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.671 Vali Acc: 0.065 Test Loss: 2.671 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0484209
	speed: 0.4042s/iter; left time: 1578.4042s
Epoch: 5 cost time: 17.199273347854614
Epoch: 5, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.415 Vali Acc: 0.365 Test Loss: 2.415 Test Acc: 0.365
Validation loss decreased (-0.347911 --> -0.364939).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2641796
	speed: 0.3873s/iter; left time: 1452.7447s
Epoch: 6 cost time: 19.43591046333313
Epoch: 6, Steps: 154 | Train Loss: 1.539 Vali Loss: 3.123 Vali Acc: 0.077 Test Loss: 3.123 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.9793833
	speed: 0.3973s/iter; left time: 1429.1810s
Epoch: 7 cost time: 17.691767692565918
Epoch: 7, Steps: 154 | Train Loss: 1.452 Vali Loss: 3.268 Vali Acc: 0.076 Test Loss: 3.268 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.9500895
	speed: 0.4038s/iter; left time: 1390.3679s
Epoch: 8 cost time: 19.28760027885437
Epoch: 8, Steps: 154 | Train Loss: 1.379 Vali Loss: 2.690 Vali Acc: 0.081 Test Loss: 2.690 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 2.0150700
	speed: 0.3844s/iter; left time: 1264.2214s
Epoch: 9 cost time: 17.533003568649292
Epoch: 9, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.117 Vali Acc: 0.380 Test Loss: 2.117 Test Acc: 0.380
Validation loss decreased (-0.364939 --> -0.380352).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8534918
	speed: 0.3944s/iter; left time: 1236.3898s
Epoch: 10 cost time: 17.062259435653687
Epoch: 10, Steps: 154 | Train Loss: 1.288 Vali Loss: 5.351 Vali Acc: 0.092 Test Loss: 5.351 Test Acc: 0.092
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9921277
	speed: 0.3438s/iter; left time: 1025.0015s
Epoch: 11 cost time: 16.927119493484497
Epoch: 11, Steps: 154 | Train Loss: 1.251 Vali Loss: 3.263 Vali Acc: 0.311 Test Loss: 3.263 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1470797
	speed: 0.3658s/iter; left time: 1034.1221s
Epoch: 12 cost time: 15.692529439926147
Epoch: 12, Steps: 154 | Train Loss: 1.222 Vali Loss: 4.690 Vali Acc: 0.115 Test Loss: 4.690 Test Acc: 0.115
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5457954
	speed: 0.3549s/iter; left time: 948.5197s
Epoch: 13 cost time: 17.418406009674072
Epoch: 13, Steps: 154 | Train Loss: 1.178 Vali Loss: 6.503 Vali Acc: 0.110 Test Loss: 6.503 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.6256361
	speed: 0.3531s/iter; left time: 889.4959s
Epoch: 14 cost time: 15.784950971603394
Epoch: 14, Steps: 154 | Train Loss: 1.119 Vali Loss: 4.209 Vali Acc: 0.127 Test Loss: 4.209 Test Acc: 0.127
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.9546379
	speed: 0.3672s/iter; left time: 868.4019s
Epoch: 15 cost time: 17.273861169815063
Epoch: 15, Steps: 154 | Train Loss: 1.086 Vali Loss: 7.962 Vali Acc: 0.120 Test Loss: 7.962 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.2981991
	speed: 0.3394s/iter; left time: 750.4645s
Epoch: 16 cost time: 16.31249690055847
Epoch: 16, Steps: 154 | Train Loss: 1.047 Vali Loss: 2.934 Vali Acc: 0.209 Test Loss: 2.934 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.0757307
	speed: 0.3702s/iter; left time: 761.5855s
Epoch: 17 cost time: 16.302104711532593
Epoch: 17, Steps: 154 | Train Loss: 1.032 Vali Loss: 7.450 Vali Acc: 0.105 Test Loss: 7.450 Test Acc: 0.105
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.6899750
	speed: 0.3510s/iter; left time: 667.9201s
Epoch: 18 cost time: 17.535503387451172
Epoch: 18, Steps: 154 | Train Loss: 0.970 Vali Loss: 7.931 Vali Acc: 0.097 Test Loss: 7.931 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.7084863
	speed: 0.3623s/iter; left time: 633.6114s
Epoch: 19 cost time: 15.735262155532837
Epoch: 19, Steps: 154 | Train Loss: 0.942 Vali Loss: 3.448 Vali Acc: 0.180 Test Loss: 3.448 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38037307380373075
model parameter : 2083214
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6686960
	speed: 0.1701s/iter; left time: 768.9997s
Epoch: 1 cost time: 25.777762413024902
Epoch: 1, Steps: 154 | Train Loss: 2.108 Vali Loss: 2.042 Vali Acc: 0.336 Test Loss: 2.042 Test Acc: 0.336
Validation loss decreased (inf --> -0.336152).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6781762
	speed: 0.5349s/iter; left time: 2336.0511s
Epoch: 2 cost time: 24.24384069442749
Epoch: 2, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.266 Vali Acc: 0.333 Test Loss: 2.266 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9388413
	speed: 0.5327s/iter; left time: 2244.3024s
Epoch: 3 cost time: 26.63240146636963
Epoch: 3, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.140 Vali Acc: 0.347 Test Loss: 2.140 Test Acc: 0.347
Validation loss decreased (-0.336152 --> -0.346694).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0255170
	speed: 0.5300s/iter; left time: 2151.3537s
Epoch: 4 cost time: 24.35746932029724
Epoch: 4, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.453 Vali Acc: 0.361 Test Loss: 2.453 Test Acc: 0.361
Validation loss decreased (-0.346694 --> -0.361289).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7351168
	speed: 0.5536s/iter; left time: 2161.7061s
Epoch: 5 cost time: 26.28855323791504
Epoch: 5, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.358 Vali Acc: 0.369 Test Loss: 2.358 Test Acc: 0.369
Validation loss decreased (-0.361289 --> -0.368590).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4646657
	speed: 0.5208s/iter; left time: 1953.5301s
Epoch: 6 cost time: 25.376785039901733
Epoch: 6, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.418 Vali Acc: 0.385 Test Loss: 2.418 Test Acc: 0.385
Validation loss decreased (-0.368590 --> -0.384810).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3311714
	speed: 0.5605s/iter; left time: 2016.2071s
Epoch: 7 cost time: 25.502339601516724
Epoch: 7, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.681 Vali Acc: 0.337 Test Loss: 2.681 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9206482
	speed: 0.5282s/iter; left time: 1818.5376s
Epoch: 8 cost time: 26.444355249404907
Epoch: 8, Steps: 154 | Train Loss: 1.437 Vali Loss: 5.332 Vali Acc: 0.077 Test Loss: 5.332 Test Acc: 0.077
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5702696
	speed: 0.5478s/iter; left time: 1801.7223s
Epoch: 9 cost time: 24.5302255153656
Epoch: 9, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.733 Vali Acc: 0.387 Test Loss: 2.733 Test Acc: 0.387
Validation loss decreased (-0.384810 --> -0.387239).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.1462817
	speed: 0.5382s/iter; left time: 1687.1768s
Epoch: 10 cost time: 26.905376195907593
Epoch: 10, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.844 Vali Acc: 0.379 Test Loss: 2.844 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4577117
	speed: 0.5355s/iter; left time: 1596.2374s
Epoch: 11 cost time: 24.54981756210327
Epoch: 11, Steps: 154 | Train Loss: 1.299 Vali Loss: 3.651 Vali Acc: 0.084 Test Loss: 3.651 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.8531569
	speed: 0.5468s/iter; left time: 1545.6633s
Epoch: 12 cost time: 26.861618041992188
Epoch: 12, Steps: 154 | Train Loss: 1.261 Vali Loss: 2.948 Vali Acc: 0.249 Test Loss: 2.948 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.7192850
	speed: 0.5149s/iter; left time: 1376.2605s
Epoch: 13 cost time: 23.42135000228882
Epoch: 13, Steps: 154 | Train Loss: 1.238 Vali Loss: 3.989 Vali Acc: 0.094 Test Loss: 3.989 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.9682463
	speed: 0.5070s/iter; left time: 1277.1378s
Epoch: 14 cost time: 23.101194620132446
Epoch: 14, Steps: 154 | Train Loss: 1.203 Vali Loss: 3.573 Vali Acc: 0.358 Test Loss: 3.573 Test Acc: 0.358
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4421225
	speed: 0.4692s/iter; left time: 1109.6639s
Epoch: 15 cost time: 23.846152544021606
Epoch: 15, Steps: 154 | Train Loss: 1.169 Vali Loss: 4.399 Vali Acc: 0.092 Test Loss: 4.399 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.0590588
	speed: 0.4931s/iter; left time: 1090.3237s
Epoch: 16 cost time: 21.95354413986206
Epoch: 16, Steps: 154 | Train Loss: 1.123 Vali Loss: 8.072 Vali Acc: 0.079 Test Loss: 8.072 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.9861050
	speed: 0.4852s/iter; left time: 998.0221s
Epoch: 17 cost time: 24.44663405418396
Epoch: 17, Steps: 154 | Train Loss: 1.072 Vali Loss: 6.118 Vali Acc: 0.098 Test Loss: 6.118 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.8758137
	speed: 0.4733s/iter; left time: 900.7226s
Epoch: 18 cost time: 21.823076486587524
Epoch: 18, Steps: 154 | Train Loss: 1.029 Vali Loss: 4.606 Vali Acc: 0.199 Test Loss: 4.606 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.0894027
	speed: 0.5015s/iter; left time: 877.0671s
Epoch: 19 cost time: 23.044298887252808
Epoch: 19, Steps: 154 | Train Loss: 0.981 Vali Loss: 5.358 Vali Acc: 0.112 Test Loss: 5.358 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3872668288726683
model parameter : 7048526
model size : 27.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0853558
	speed: 0.1143s/iter; left time: 516.9587s
Epoch: 1 cost time: 16.65824818611145
Epoch: 1, Steps: 154 | Train Loss: 2.132 Vali Loss: 2.091 Vali Acc: 0.325 Test Loss: 2.091 Test Acc: 0.325
Validation loss decreased (inf --> -0.325202).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0362194
	speed: 0.3183s/iter; left time: 1389.8231s
Epoch: 2 cost time: 13.496999502182007
Epoch: 2, Steps: 154 | Train Loss: 1.907 Vali Loss: 2.175 Vali Acc: 0.340 Test Loss: 2.175 Test Acc: 0.340
Validation loss decreased (-0.325202 --> -0.340205).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0733919
	speed: 0.3403s/iter; left time: 1433.5792s
Epoch: 3 cost time: 15.518826961517334
Epoch: 3, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.214 Vali Acc: 0.173 Test Loss: 2.214 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3463938
	speed: 0.3088s/iter; left time: 1253.3857s
Epoch: 4 cost time: 12.952510118484497
Epoch: 4, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.166 Vali Acc: 0.229 Test Loss: 2.166 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.1963129
	speed: 0.3616s/iter; left time: 1412.2364s
Epoch: 5 cost time: 16.36330819129944
Epoch: 5, Steps: 154 | Train Loss: 1.575 Vali Loss: 3.303 Vali Acc: 0.072 Test Loss: 3.303 Test Acc: 0.072
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1643898
	speed: 0.3721s/iter; left time: 1395.6731s
Epoch: 6 cost time: 15.006584405899048
Epoch: 6, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.861 Vali Acc: 0.178 Test Loss: 2.861 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9505125
	speed: 0.3516s/iter; left time: 1264.8180s
Epoch: 7 cost time: 16.96847176551819
Epoch: 7, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.813 Vali Acc: 0.132 Test Loss: 2.813 Test Acc: 0.132
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.0876449
	speed: 0.3614s/iter; left time: 1244.2732s
Epoch: 8 cost time: 15.018737316131592
Epoch: 8, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.141 Vali Acc: 0.074 Test Loss: 3.141 Test Acc: 0.074
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.9294773
	speed: 0.3526s/iter; left time: 1159.7145s
Epoch: 9 cost time: 16.688832998275757
Epoch: 9, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.991 Vali Acc: 0.369 Test Loss: 2.991 Test Acc: 0.369
Validation loss decreased (-0.340205 --> -0.368583).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8500607
	speed: 0.3696s/iter; left time: 1158.7472s
Epoch: 10 cost time: 15.793717861175537
Epoch: 10, Steps: 154 | Train Loss: 1.326 Vali Loss: 5.537 Vali Acc: 0.097 Test Loss: 5.537 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1319116
	speed: 0.3402s/iter; left time: 1014.1117s
Epoch: 11 cost time: 15.654160022735596
Epoch: 11, Steps: 154 | Train Loss: 1.265 Vali Loss: 2.991 Vali Acc: 0.215 Test Loss: 2.991 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2752140
	speed: 0.3738s/iter; left time: 1056.7206s
Epoch: 12 cost time: 16.00842809677124
Epoch: 12, Steps: 154 | Train Loss: 1.259 Vali Loss: 2.709 Vali Acc: 0.357 Test Loss: 2.709 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1968954
	speed: 0.3495s/iter; left time: 934.0903s
Epoch: 13 cost time: 15.433297395706177
Epoch: 13, Steps: 154 | Train Loss: 1.188 Vali Loss: 6.455 Vali Acc: 0.092 Test Loss: 6.455 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.5661911
	speed: 0.3689s/iter; left time: 929.3010s
Epoch: 14 cost time: 16.670843839645386
Epoch: 14, Steps: 154 | Train Loss: 1.159 Vali Loss: 4.283 Vali Acc: 0.129 Test Loss: 4.283 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.0234568
	speed: 0.3437s/iter; left time: 812.7670s
Epoch: 15 cost time: 15.117065191268921
Epoch: 15, Steps: 154 | Train Loss: 1.121 Vali Loss: 4.343 Vali Acc: 0.109 Test Loss: 4.343 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.4199843
	speed: 0.3655s/iter; left time: 808.2227s
Epoch: 16 cost time: 16.709187269210815
Epoch: 16, Steps: 154 | Train Loss: 1.081 Vali Loss: 2.951 Vali Acc: 0.220 Test Loss: 2.951 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8190264
	speed: 0.3554s/iter; left time: 731.0805s
Epoch: 17 cost time: 15.11624550819397
Epoch: 17, Steps: 154 | Train Loss: 1.060 Vali Loss: 4.676 Vali Acc: 0.100 Test Loss: 4.676 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.6348430
	speed: 0.3602s/iter; left time: 685.3764s
Epoch: 18 cost time: 17.443645238876343
Epoch: 18, Steps: 154 | Train Loss: 1.023 Vali Loss: 7.390 Vali Acc: 0.082 Test Loss: 7.390 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.7226920
	speed: 0.3590s/iter; left time: 627.8350s
Epoch: 19 cost time: 15.053179264068604
Epoch: 19, Steps: 154 | Train Loss: 1.004 Vali Loss: 5.606 Vali Acc: 0.096 Test Loss: 5.606 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3686131386861314
model parameter : 2083214
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6610559
	speed: 0.1236s/iter; left time: 558.8226s
Epoch: 1 cost time: 17.8956515789032
Epoch: 1, Steps: 154 | Train Loss: 2.120 Vali Loss: 2.056 Vali Acc: 0.330 Test Loss: 2.056 Test Acc: 0.330
Validation loss decreased (inf --> -0.329663).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6969935
	speed: 0.3395s/iter; left time: 1482.7821s
Epoch: 2 cost time: 15.247594594955444
Epoch: 2, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.265 Vali Acc: 0.331 Test Loss: 2.265 Test Acc: 0.331
Validation loss decreased (-0.329663 --> -0.331283).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0574737
	speed: 0.3775s/iter; left time: 1590.2539s
Epoch: 3 cost time: 16.54905605316162
Epoch: 3, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.113 Vali Acc: 0.353 Test Loss: 2.113 Test Acc: 0.353
Validation loss decreased (-0.331283 --> -0.353182).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1096458
	speed: 0.3420s/iter; left time: 1388.2648s
Epoch: 4 cost time: 15.50616979598999
Epoch: 4, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.024 Vali Acc: 0.361 Test Loss: 2.024 Test Acc: 0.361
Validation loss decreased (-0.353182 --> -0.360888).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5685241
	speed: 0.3798s/iter; left time: 1483.2041s
Epoch: 5 cost time: 16.475518226623535
Epoch: 5, Steps: 154 | Train Loss: 1.657 Vali Loss: 2.554 Vali Acc: 0.332 Test Loss: 2.554 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3723128
	speed: 0.3329s/iter; left time: 1248.7165s
Epoch: 6 cost time: 14.912530183792114
Epoch: 6, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.104 Vali Acc: 0.385 Test Loss: 2.104 Test Acc: 0.385
Validation loss decreased (-0.360888 --> -0.385218).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5031080
	speed: 0.3749s/iter; left time: 1348.6778s
Epoch: 7 cost time: 16.543784856796265
Epoch: 7, Steps: 154 | Train Loss: 1.523 Vali Loss: 4.490 Vali Acc: 0.097 Test Loss: 4.490 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8532466
	speed: 0.3370s/iter; left time: 1160.4079s
Epoch: 8 cost time: 15.34895944595337
Epoch: 8, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.969 Vali Acc: 0.119 Test Loss: 3.969 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2906830
	speed: 0.3778s/iter; left time: 1242.4416s
Epoch: 9 cost time: 16.433634757995605
Epoch: 9, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.638 Vali Acc: 0.071 Test Loss: 3.638 Test Acc: 0.071
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1849152
	speed: 0.3365s/iter; left time: 1054.9459s
Epoch: 10 cost time: 15.478963851928711
Epoch: 10, Steps: 154 | Train Loss: 1.516 Vali Loss: 4.591 Vali Acc: 0.070 Test Loss: 4.591 Test Acc: 0.070
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3389623
	speed: 0.3730s/iter; left time: 1111.8998s
Epoch: 11 cost time: 16.324084758758545
Epoch: 11, Steps: 154 | Train Loss: 1.369 Vali Loss: 5.512 Vali Acc: 0.083 Test Loss: 5.512 Test Acc: 0.083
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.8842068
	speed: 0.3358s/iter; left time: 949.3586s
Epoch: 12 cost time: 15.894042015075684
Epoch: 12, Steps: 154 | Train Loss: 1.302 Vali Loss: 4.195 Vali Acc: 0.213 Test Loss: 4.195 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.6358148
	speed: 0.4121s/iter; left time: 1101.6710s
Epoch: 13 cost time: 18.07074522972107
Epoch: 13, Steps: 154 | Train Loss: 1.269 Vali Loss: 5.182 Vali Acc: 0.074 Test Loss: 5.182 Test Acc: 0.074
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.9663537
	speed: 0.3723s/iter; left time: 937.7691s
Epoch: 14 cost time: 16.8550968170166
Epoch: 14, Steps: 154 | Train Loss: 1.210 Vali Loss: 4.792 Vali Acc: 0.172 Test Loss: 4.792 Test Acc: 0.172
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1951106
	speed: 0.4120s/iter; left time: 974.4626s
Epoch: 15 cost time: 17.937476634979248
Epoch: 15, Steps: 154 | Train Loss: 1.165 Vali Loss: 7.482 Vali Acc: 0.064 Test Loss: 7.482 Test Acc: 0.064
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.9368019
	speed: 0.3737s/iter; left time: 826.2064s
Epoch: 16 cost time: 17.007336139678955
Epoch: 16, Steps: 154 | Train Loss: 1.142 Vali Loss: 9.744 Vali Acc: 0.080 Test Loss: 9.744 Test Acc: 0.080
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38523925385239255
model parameter : 7048526
model size : 27.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0828552
	speed: 0.0889s/iter; left time: 401.9622s
Epoch: 1 cost time: 13.047604084014893
Epoch: 1, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.111 Vali Acc: 0.319 Test Loss: 2.111 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0519109
	speed: 0.2930s/iter; left time: 1279.4960s
Epoch: 2 cost time: 13.204111576080322
Epoch: 2, Steps: 154 | Train Loss: 1.920 Vali Loss: 2.131 Vali Acc: 0.358 Test Loss: 2.131 Test Acc: 0.358
Validation loss decreased (-0.319119 --> -0.358048).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0133300
	speed: 0.3066s/iter; left time: 1291.8716s
Epoch: 3 cost time: 12.352238893508911
Epoch: 3, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.163 Vali Acc: 0.340 Test Loss: 2.163 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.3936071
	speed: 0.2843s/iter; left time: 1154.0013s
Epoch: 4 cost time: 11.438039302825928
Epoch: 4, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.333 Vali Acc: 0.203 Test Loss: 2.333 Test Acc: 0.203
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 2.0767353
	speed: 0.2563s/iter; left time: 1000.8175s
Epoch: 5 cost time: 8.751867055892944
Epoch: 5, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.857 Vali Acc: 0.184 Test Loss: 2.857 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.1903857
	speed: 0.2488s/iter; left time: 933.1365s
Epoch: 6 cost time: 12.046718120574951
Epoch: 6, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.820 Vali Acc: 0.203 Test Loss: 2.820 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.9169523
	speed: 0.2602s/iter; left time: 936.0278s
Epoch: 7 cost time: 11.133622884750366
Epoch: 7, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.754 Vali Acc: 0.215 Test Loss: 2.754 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.1017340
	speed: 0.2798s/iter; left time: 963.4930s
Epoch: 8 cost time: 11.021828651428223
Epoch: 8, Steps: 154 | Train Loss: 1.467 Vali Loss: 4.625 Vali Acc: 0.065 Test Loss: 4.625 Test Acc: 0.065
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.8849463
	speed: 0.2670s/iter; left time: 878.2229s
Epoch: 9 cost time: 12.34359860420227
Epoch: 9, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.208 Vali Acc: 0.257 Test Loss: 3.208 Test Acc: 0.257
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.1402310
	speed: 0.2737s/iter; left time: 858.1133s
Epoch: 10 cost time: 11.116228818893433
Epoch: 10, Steps: 154 | Train Loss: 1.357 Vali Loss: 4.935 Vali Acc: 0.088 Test Loss: 4.935 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.1619028
	speed: 0.2826s/iter; left time: 842.3326s
Epoch: 11 cost time: 12.106968641281128
Epoch: 11, Steps: 154 | Train Loss: 1.318 Vali Loss: 6.850 Vali Acc: 0.058 Test Loss: 6.850 Test Acc: 0.058
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.6264391
	speed: 0.2530s/iter; left time: 715.1171s
Epoch: 12 cost time: 10.678559064865112
Epoch: 12, Steps: 154 | Train Loss: 1.297 Vali Loss: 7.303 Vali Acc: 0.071 Test Loss: 7.303 Test Acc: 0.071
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3580697485806975
model parameter : 2083214
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8022473
	speed: 0.1571s/iter; left time: 710.2878s
Epoch: 1 cost time: 23.339837551116943
Epoch: 1, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.067 Vali Acc: 0.335 Test Loss: 2.067 Test Acc: 0.335
Validation loss decreased (inf --> -0.334529).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7930484
	speed: 0.4236s/iter; left time: 1849.7989s
Epoch: 2 cost time: 20.85798168182373
Epoch: 2, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.183 Vali Acc: 0.331 Test Loss: 2.183 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.7035779
	speed: 0.4203s/iter; left time: 1770.7906s
Epoch: 3 cost time: 20.897000312805176
Epoch: 3, Steps: 154 | Train Loss: 1.781 Vali Loss: 2.201 Vali Acc: 0.333 Test Loss: 2.201 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.7422093
	speed: 0.4207s/iter; left time: 1707.7227s
Epoch: 4 cost time: 20.80449867248535
Epoch: 4, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.424 Vali Acc: 0.189 Test Loss: 2.424 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 2.0384750
	speed: 0.4163s/iter; left time: 1625.4985s
Epoch: 5 cost time: 20.13267183303833
Epoch: 5, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.381 Vali Acc: 0.201 Test Loss: 2.381 Test Acc: 0.201
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 6 | loss: 1.9321980
	speed: 0.4207s/iter; left time: 1578.2327s
Epoch: 6 cost time: 20.344178915023804
Epoch: 6, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.563 Vali Acc: 0.152 Test Loss: 2.563 Test Acc: 0.152
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 7 | loss: 1.3956996
	speed: 0.4247s/iter; left time: 1527.6579s
Epoch: 7 cost time: 20.02196216583252
Epoch: 7, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.828 Vali Acc: 0.365 Test Loss: 2.828 Test Acc: 0.365
Validation loss decreased (-0.334529 --> -0.364935).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1444005
	speed: 0.4222s/iter; left time: 1453.5304s
Epoch: 8 cost time: 19.66012716293335
Epoch: 8, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.295 Vali Acc: 0.157 Test Loss: 3.295 Test Acc: 0.157
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5413177
	speed: 0.4105s/iter; left time: 1350.1662s
Epoch: 9 cost time: 19.33441472053528
Epoch: 9, Steps: 154 | Train Loss: 1.353 Vali Loss: 3.050 Vali Acc: 0.202 Test Loss: 3.050 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.9585133
	speed: 0.4644s/iter; left time: 1455.9126s
Epoch: 10 cost time: 21.561452627182007
Epoch: 10, Steps: 154 | Train Loss: 1.304 Vali Loss: 3.360 Vali Acc: 0.082 Test Loss: 3.360 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4580590
	speed: 0.4658s/iter; left time: 1388.5365s
Epoch: 11 cost time: 21.314327239990234
Epoch: 11, Steps: 154 | Train Loss: 1.257 Vali Loss: 2.986 Vali Acc: 0.175 Test Loss: 2.986 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3287672
	speed: 0.4646s/iter; left time: 1313.4667s
Epoch: 12 cost time: 20.985384225845337
Epoch: 12, Steps: 154 | Train Loss: 1.226 Vali Loss: 3.136 Vali Acc: 0.133 Test Loss: 3.136 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.3371752
	speed: 0.4621s/iter; left time: 1235.1855s
Epoch: 13 cost time: 20.715203762054443
Epoch: 13, Steps: 154 | Train Loss: 1.169 Vali Loss: 3.232 Vali Acc: 0.138 Test Loss: 3.232 Test Acc: 0.138
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.8448857
	speed: 0.4605s/iter; left time: 1160.0096s
Epoch: 14 cost time: 20.720690965652466
Epoch: 14, Steps: 154 | Train Loss: 1.141 Vali Loss: 2.927 Vali Acc: 0.207 Test Loss: 2.927 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.7241513
	speed: 0.4585s/iter; left time: 1084.3489s
Epoch: 15 cost time: 20.88105082511902
Epoch: 15, Steps: 154 | Train Loss: 1.113 Vali Loss: 6.218 Vali Acc: 0.089 Test Loss: 6.218 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.7030922
	speed: 0.4286s/iter; left time: 947.6989s
Epoch: 16 cost time: 23.75520348548889
Epoch: 16, Steps: 154 | Train Loss: 1.076 Vali Loss: 4.121 Vali Acc: 0.191 Test Loss: 4.121 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.9389729
	speed: 0.5667s/iter; left time: 1165.8040s
Epoch: 17 cost time: 26.090864658355713
Epoch: 17, Steps: 154 | Train Loss: 1.046 Vali Loss: 5.026 Vali Acc: 0.192 Test Loss: 5.026 Test Acc: 0.192
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36496350364963503
model parameter : 3533006
model size : 14.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8680896
	speed: 0.1268s/iter; left time: 573.2623s
Epoch: 1 cost time: 18.578528881072998
Epoch: 1, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.060 Vali Acc: 0.336 Test Loss: 2.060 Test Acc: 0.336
Validation loss decreased (inf --> -0.336151).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4808965
	speed: 0.3805s/iter; left time: 1661.5136s
Epoch: 2 cost time: 16.88842225074768
Epoch: 2, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.155 Vali Acc: 0.343 Test Loss: 2.155 Test Acc: 0.343
Validation loss decreased (-0.336151 --> -0.342639).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0753367
	speed: 0.3573s/iter; left time: 1505.3890s
Epoch: 3 cost time: 16.18002963066101
Epoch: 3, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.117 Vali Acc: 0.359 Test Loss: 2.117 Test Acc: 0.359
Validation loss decreased (-0.342639 --> -0.358860).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8092571
	speed: 0.3490s/iter; left time: 1416.3935s
Epoch: 4 cost time: 16.176640272140503
Epoch: 4, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.248 Vali Acc: 0.363 Test Loss: 2.248 Test Acc: 0.363
Validation loss decreased (-0.358860 --> -0.362913).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3369896
	speed: 0.3462s/iter; left time: 1351.9085s
Epoch: 5 cost time: 15.896740674972534
Epoch: 5, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.215 Vali Acc: 0.217 Test Loss: 2.215 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3670313
	speed: 0.3277s/iter; left time: 1229.1395s
Epoch: 6 cost time: 14.661643505096436
Epoch: 6, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.370 Vali Acc: 0.223 Test Loss: 2.370 Test Acc: 0.223
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4210200
	speed: 0.3177s/iter; left time: 1142.6909s
Epoch: 7 cost time: 15.60842514038086
Epoch: 7, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.121 Vali Acc: 0.404 Test Loss: 2.121 Test Acc: 0.404
Validation loss decreased (-0.362913 --> -0.403872).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9526330
	speed: 0.3444s/iter; left time: 1185.7878s
Epoch: 8 cost time: 15.972968101501465
Epoch: 8, Steps: 154 | Train Loss: 1.354 Vali Loss: 3.132 Vali Acc: 0.094 Test Loss: 3.132 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9748982
	speed: 0.3283s/iter; left time: 1079.6765s
Epoch: 9 cost time: 14.266201496124268
Epoch: 9, Steps: 154 | Train Loss: 1.322 Vali Loss: 3.341 Vali Acc: 0.233 Test Loss: 3.341 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2849861
	speed: 0.3290s/iter; left time: 1031.3658s
Epoch: 10 cost time: 15.70960807800293
Epoch: 10, Steps: 154 | Train Loss: 1.265 Vali Loss: 5.340 Vali Acc: 0.117 Test Loss: 5.340 Test Acc: 0.117
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0869774
	speed: 0.3645s/iter; left time: 1086.6514s
Epoch: 11 cost time: 16.84076952934265
Epoch: 11, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.858 Vali Acc: 0.361 Test Loss: 2.858 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1356456
	speed: 0.3521s/iter; left time: 995.2585s
Epoch: 12 cost time: 15.176799535751343
Epoch: 12, Steps: 154 | Train Loss: 1.223 Vali Loss: 5.407 Vali Acc: 0.102 Test Loss: 5.407 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0976114
	speed: 0.3342s/iter; left time: 893.3506s
Epoch: 13 cost time: 15.707397699356079
Epoch: 13, Steps: 154 | Train Loss: 1.162 Vali Loss: 5.302 Vali Acc: 0.090 Test Loss: 5.302 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.0979331
	speed: 0.3584s/iter; left time: 902.7085s
Epoch: 14 cost time: 16.802587509155273
Epoch: 14, Steps: 154 | Train Loss: 1.133 Vali Loss: 3.377 Vali Acc: 0.228 Test Loss: 3.377 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1811478
	speed: 0.3611s/iter; left time: 853.9599s
Epoch: 15 cost time: 16.485778093338013
Epoch: 15, Steps: 154 | Train Loss: 1.119 Vali Loss: 3.389 Vali Acc: 0.345 Test Loss: 3.389 Test Acc: 0.345
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.9964908
	speed: 0.3381s/iter; left time: 747.5287s
Epoch: 16 cost time: 15.52524471282959
Epoch: 16, Steps: 154 | Train Loss: 1.061 Vali Loss: 8.083 Vali Acc: 0.101 Test Loss: 8.083 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.9139740
	speed: 0.3497s/iter; left time: 719.3485s
Epoch: 17 cost time: 16.3564932346344
Epoch: 17, Steps: 154 | Train Loss: 1.036 Vali Loss: 4.766 Vali Acc: 0.107 Test Loss: 4.766 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40389294403892945
model parameter : 1050254
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8016014
	speed: 0.1486s/iter; left time: 671.7913s
Epoch: 1 cost time: 22.13801884651184
Epoch: 1, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.084 Vali Acc: 0.327 Test Loss: 2.084 Test Acc: 0.327
Validation loss decreased (inf --> -0.326824).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7588717
	speed: 0.4417s/iter; left time: 1928.8443s
Epoch: 2 cost time: 20.350961208343506
Epoch: 2, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.177 Vali Acc: 0.340 Test Loss: 2.177 Test Acc: 0.340
Validation loss decreased (-0.326824 --> -0.340205).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7620879
	speed: 0.4829s/iter; left time: 2034.2554s
Epoch: 3 cost time: 22.173135995864868
Epoch: 3, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.231 Vali Acc: 0.337 Test Loss: 2.231 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7791001
	speed: 0.4674s/iter; left time: 1897.3726s
Epoch: 4 cost time: 20.47538423538208
Epoch: 4, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.277 Vali Acc: 0.194 Test Loss: 2.277 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.6402919
	speed: 0.4427s/iter; left time: 1728.9338s
Epoch: 5 cost time: 21.40255117416382
Epoch: 5, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.197 Vali Acc: 0.231 Test Loss: 2.197 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.8908942
	speed: 0.4848s/iter; left time: 1818.3631s
Epoch: 6 cost time: 22.071184873580933
Epoch: 6, Steps: 154 | Train Loss: 1.501 Vali Loss: 4.019 Vali Acc: 0.084 Test Loss: 4.019 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.2638608
	speed: 0.4547s/iter; left time: 1635.4778s
Epoch: 7 cost time: 19.866947174072266
Epoch: 7, Steps: 154 | Train Loss: 1.472 Vali Loss: 3.094 Vali Acc: 0.144 Test Loss: 3.094 Test Acc: 0.144
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 1.2325634
	speed: 0.4530s/iter; left time: 1559.7659s
Epoch: 8 cost time: 22.056405544281006
Epoch: 8, Steps: 154 | Train Loss: 1.403 Vali Loss: 4.436 Vali Acc: 0.086 Test Loss: 4.436 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 1.7153573
	speed: 0.4846s/iter; left time: 1593.8605s
Epoch: 9 cost time: 21.943028211593628
Epoch: 9, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.274 Vali Acc: 0.117 Test Loss: 3.274 Test Acc: 0.117
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 1.0033871
	speed: 0.4514s/iter; left time: 1415.0786s
Epoch: 10 cost time: 20.52807092666626
Epoch: 10, Steps: 154 | Train Loss: 1.341 Vali Loss: 5.684 Vali Acc: 0.079 Test Loss: 5.684 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 1.3510219
	speed: 0.4620s/iter; left time: 1377.0824s
Epoch: 11 cost time: 22.21040153503418
Epoch: 11, Steps: 154 | Train Loss: 1.282 Vali Loss: 3.530 Vali Acc: 0.189 Test Loss: 3.530 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 1.7827388
	speed: 0.4791s/iter; left time: 1354.5443s
Epoch: 12 cost time: 21.59118366241455
Epoch: 12, Steps: 154 | Train Loss: 1.238 Vali Loss: 3.839 Vali Acc: 0.102 Test Loss: 3.839 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3402270884022709
model parameter : 3533006
model size : 14.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8673643
	speed: 0.1100s/iter; left time: 497.1124s
Epoch: 1 cost time: 16.600325107574463
Epoch: 1, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.062 Vali Acc: 0.332 Test Loss: 2.062 Test Acc: 0.332
Validation loss decreased (inf --> -0.331691).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5221493
	speed: 0.3547s/iter; left time: 1549.1135s
Epoch: 2 cost time: 14.601889848709106
Epoch: 2, Steps: 154 | Train Loss: 1.918 Vali Loss: 2.100 Vali Acc: 0.339 Test Loss: 2.100 Test Acc: 0.339
Validation loss decreased (-0.331691 --> -0.338584).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1085052
	speed: 0.3297s/iter; left time: 1389.0067s
Epoch: 3 cost time: 13.81942343711853
Epoch: 3, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.121 Vali Acc: 0.346 Test Loss: 2.121 Test Acc: 0.346
Validation loss decreased (-0.338584 --> -0.346289).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8320987
	speed: 0.3068s/iter; left time: 1245.4277s
Epoch: 4 cost time: 13.544851541519165
Epoch: 4, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.320 Vali Acc: 0.386 Test Loss: 2.320 Test Acc: 0.386
Validation loss decreased (-0.346289 --> -0.386027).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3712404
	speed: 0.3160s/iter; left time: 1233.9172s
Epoch: 5 cost time: 14.837921380996704
Epoch: 5, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.206 Vali Acc: 0.210 Test Loss: 2.206 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2218987
	speed: 0.3364s/iter; left time: 1261.9218s
Epoch: 6 cost time: 14.587220191955566
Epoch: 6, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.249 Vali Acc: 0.322 Test Loss: 2.249 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3320687
	speed: 0.3116s/iter; left time: 1120.6544s
Epoch: 7 cost time: 13.444942712783813
Epoch: 7, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.701 Vali Acc: 0.249 Test Loss: 2.701 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.0276270
	speed: 0.3007s/iter; left time: 1035.1949s
Epoch: 8 cost time: 13.895671844482422
Epoch: 8, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.128 Vali Acc: 0.089 Test Loss: 3.128 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.0135949
	speed: 0.3334s/iter; left time: 1096.4677s
Epoch: 9 cost time: 14.509088277816772
Epoch: 9, Steps: 154 | Train Loss: 1.354 Vali Loss: 3.889 Vali Acc: 0.182 Test Loss: 3.889 Test Acc: 0.182
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.3727542
	speed: 0.3281s/iter; left time: 1028.5599s
Epoch: 10 cost time: 13.253614664077759
Epoch: 10, Steps: 154 | Train Loss: 1.305 Vali Loss: 3.390 Vali Acc: 0.129 Test Loss: 3.390 Test Acc: 0.129
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.1813545
	speed: 0.2979s/iter; left time: 888.1803s
Epoch: 11 cost time: 13.481538772583008
Epoch: 11, Steps: 154 | Train Loss: 1.280 Vali Loss: 2.893 Vali Acc: 0.165 Test Loss: 2.893 Test Acc: 0.165
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.0856018
	speed: 0.3228s/iter; left time: 912.4566s
Epoch: 12 cost time: 14.715438842773438
Epoch: 12, Steps: 154 | Train Loss: 1.248 Vali Loss: 7.969 Vali Acc: 0.092 Test Loss: 7.969 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.7733443
	speed: 0.3373s/iter; left time: 901.7234s
Epoch: 13 cost time: 14.917794466018677
Epoch: 13, Steps: 154 | Train Loss: 1.199 Vali Loss: 5.227 Vali Acc: 0.085 Test Loss: 5.227 Test Acc: 0.085
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.2374043
	speed: 0.3080s/iter; left time: 775.7261s
Epoch: 14 cost time: 13.226606607437134
Epoch: 14, Steps: 154 | Train Loss: 1.171 Vali Loss: 4.088 Vali Acc: 0.104 Test Loss: 4.088 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38605028386050283
model parameter : 1050254
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7985929
	speed: 0.1113s/iter; left time: 503.2713s
Epoch: 1 cost time: 16.40073847770691
Epoch: 1, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.108 Vali Acc: 0.319 Test Loss: 2.108 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8209109
	speed: 0.3517s/iter; left time: 1536.0340s
Epoch: 2 cost time: 15.464500665664673
Epoch: 2, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.171 Vali Acc: 0.333 Test Loss: 2.171 Test Acc: 0.333
Validation loss decreased (-0.319119 --> -0.332906).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7478554
	speed: 0.3373s/iter; left time: 1421.1478s
Epoch: 3 cost time: 14.597718715667725
Epoch: 3, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.050 Vali Acc: 0.343 Test Loss: 2.050 Test Acc: 0.343
Validation loss decreased (-0.332906 --> -0.342640).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7773702
	speed: 0.3450s/iter; left time: 1400.4459s
Epoch: 4 cost time: 15.861673593521118
Epoch: 4, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.383 Vali Acc: 0.196 Test Loss: 2.383 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7637304
	speed: 0.3666s/iter; left time: 1431.6361s
Epoch: 5 cost time: 15.718241930007935
Epoch: 5, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.372 Vali Acc: 0.339 Test Loss: 2.372 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.0574589
	speed: 0.3552s/iter; left time: 1332.3884s
Epoch: 6 cost time: 14.835209608078003
Epoch: 6, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.945 Vali Acc: 0.205 Test Loss: 2.945 Test Acc: 0.205
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3057802
	speed: 0.3380s/iter; left time: 1215.6544s
Epoch: 7 cost time: 14.923957824707031
Epoch: 7, Steps: 154 | Train Loss: 1.510 Vali Loss: 4.307 Vali Acc: 0.103 Test Loss: 4.307 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.1646479
	speed: 0.3532s/iter; left time: 1215.9007s
Epoch: 8 cost time: 15.758131980895996
Epoch: 8, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.477 Vali Acc: 0.090 Test Loss: 3.477 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.7167696
	speed: 0.3697s/iter; left time: 1215.9787s
Epoch: 9 cost time: 16.2348895072937
Epoch: 9, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.580 Vali Acc: 0.199 Test Loss: 3.580 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.0446135
	speed: 0.3466s/iter; left time: 1086.7437s
Epoch: 10 cost time: 14.548783779144287
Epoch: 10, Steps: 154 | Train Loss: 1.368 Vali Loss: 5.460 Vali Acc: 0.075 Test Loss: 5.460 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.4414412
	speed: 0.3285s/iter; left time: 979.2725s
Epoch: 11 cost time: 14.258400917053223
Epoch: 11, Steps: 154 | Train Loss: 1.353 Vali Loss: 5.840 Vali Acc: 0.073 Test Loss: 5.840 Test Acc: 0.073
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.3425189
	speed: 0.3085s/iter; left time: 872.0163s
Epoch: 12 cost time: 10.192126274108887
Epoch: 12, Steps: 154 | Train Loss: 1.343 Vali Loss: 5.053 Vali Acc: 0.084 Test Loss: 5.053 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.4774180
	speed: 0.3192s/iter; left time: 853.1854s
Epoch: 13 cost time: 14.884652137756348
Epoch: 13, Steps: 154 | Train Loss: 1.281 Vali Loss: 7.130 Vali Acc: 0.077 Test Loss: 7.130 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3426601784266018
model parameter : 3533006
model size : 14.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8804944
	speed: 0.0967s/iter; left time: 437.1872s
Epoch: 1 cost time: 14.164180755615234
Epoch: 1, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.075 Vali Acc: 0.327 Test Loss: 2.075 Test Acc: 0.327
Validation loss decreased (inf --> -0.327230).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5548531
	speed: 0.2899s/iter; left time: 1266.1654s
Epoch: 2 cost time: 10.906850099563599
Epoch: 2, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.058 Vali Acc: 0.340 Test Loss: 2.058 Test Acc: 0.340
Validation loss decreased (-0.327230 --> -0.339801).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1250629
	speed: 0.2905s/iter; left time: 1223.8904s
Epoch: 3 cost time: 12.689215660095215
Epoch: 3, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.114 Vali Acc: 0.348 Test Loss: 2.114 Test Acc: 0.348
Validation loss decreased (-0.339801 --> -0.347911).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9523127
	speed: 0.2838s/iter; left time: 1152.0151s
Epoch: 4 cost time: 11.029622077941895
Epoch: 4, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.314 Vali Acc: 0.366 Test Loss: 2.314 Test Acc: 0.366
Validation loss decreased (-0.347911 --> -0.366157).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4338017
	speed: 0.2885s/iter; left time: 1126.7190s
Epoch: 5 cost time: 12.584885835647583
Epoch: 5, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.980 Vali Acc: 0.204 Test Loss: 2.980 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2343242
	speed: 0.2638s/iter; left time: 989.3897s
Epoch: 6 cost time: 10.032312393188477
Epoch: 6, Steps: 154 | Train Loss: 1.536 Vali Loss: 3.942 Vali Acc: 0.067 Test Loss: 3.942 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4377093
	speed: 0.2508s/iter; left time: 902.2479s
Epoch: 7 cost time: 11.046097993850708
Epoch: 7, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.325 Vali Acc: 0.281 Test Loss: 2.325 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1849103
	speed: 0.2615s/iter; left time: 900.2943s
Epoch: 8 cost time: 10.025234937667847
Epoch: 8, Steps: 154 | Train Loss: 1.427 Vali Loss: 2.814 Vali Acc: 0.391 Test Loss: 2.814 Test Acc: 0.391
Validation loss decreased (-0.366157 --> -0.391294).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0340209
	speed: 0.2594s/iter; left time: 853.2579s
Epoch: 9 cost time: 11.624336004257202
Epoch: 9, Steps: 154 | Train Loss: 1.437 Vali Loss: 5.539 Vali Acc: 0.099 Test Loss: 5.539 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4491553
	speed: 0.2609s/iter; left time: 818.0488s
Epoch: 10 cost time: 9.666839838027954
Epoch: 10, Steps: 154 | Train Loss: 1.364 Vali Loss: 6.624 Vali Acc: 0.080 Test Loss: 6.624 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1698294
	speed: 0.2504s/iter; left time: 746.3677s
Epoch: 11 cost time: 11.330971240997314
Epoch: 11, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.257 Vali Acc: 0.385 Test Loss: 3.257 Test Acc: 0.385
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1938908
	speed: 0.2649s/iter; left time: 748.9718s
Epoch: 12 cost time: 10.04757571220398
Epoch: 12, Steps: 154 | Train Loss: 1.296 Vali Loss: 7.648 Vali Acc: 0.092 Test Loss: 7.648 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.4110572
	speed: 0.2479s/iter; left time: 662.7655s
Epoch: 13 cost time: 10.653192043304443
Epoch: 13, Steps: 154 | Train Loss: 1.290 Vali Loss: 5.739 Vali Acc: 0.067 Test Loss: 5.739 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.6731583
	speed: 0.2617s/iter; left time: 659.3459s
Epoch: 14 cost time: 10.000675916671753
Epoch: 14, Steps: 154 | Train Loss: 1.223 Vali Loss: 4.556 Vali Acc: 0.108 Test Loss: 4.556 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2576941
	speed: 0.2529s/iter; left time: 598.2235s
Epoch: 15 cost time: 11.32276201248169
Epoch: 15, Steps: 154 | Train Loss: 1.194 Vali Loss: 6.639 Vali Acc: 0.070 Test Loss: 6.639 Test Acc: 0.070
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.0862769
	speed: 0.2653s/iter; left time: 586.6656s
Epoch: 16 cost time: 9.88474178314209
Epoch: 16, Steps: 154 | Train Loss: 1.166 Vali Loss: 7.134 Vali Acc: 0.092 Test Loss: 7.134 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0424012
	speed: 0.2482s/iter; left time: 510.4464s
Epoch: 17 cost time: 11.191603660583496
Epoch: 17, Steps: 154 | Train Loss: 1.127 Vali Loss: 6.455 Vali Acc: 0.081 Test Loss: 6.455 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.8917623
	speed: 0.2721s/iter; left time: 517.8856s
Epoch: 18 cost time: 10.232783555984497
Epoch: 18, Steps: 154 | Train Loss: 1.125 Vali Loss: 8.581 Vali Acc: 0.077 Test Loss: 8.581 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3913219789132198
model parameter : 1050254
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7998923
	speed: 0.1372s/iter; left time: 620.2695s
Epoch: 1 cost time: 20.155901432037354
Epoch: 1, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.105 Vali Acc: 0.324 Test Loss: 2.105 Test Acc: 0.324
Validation loss decreased (inf --> -0.324391).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8658073
	speed: 0.4099s/iter; left time: 1789.9412s
Epoch: 2 cost time: 21.4483859539032
Epoch: 2, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.105 Vali Acc: 0.345 Test Loss: 2.105 Test Acc: 0.345
Validation loss decreased (-0.324391 --> -0.345072).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0589232
	speed: 0.4264s/iter; left time: 1796.5361s
Epoch: 3 cost time: 18.993768215179443
Epoch: 3, Steps: 154 | Train Loss: 1.817 Vali Loss: 2.075 Vali Acc: 0.345 Test Loss: 2.075 Test Acc: 0.345
Validation loss decreased (-0.345072 --> -0.345073).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3352208
	speed: 0.4429s/iter; left time: 1797.7964s
Epoch: 4 cost time: 20.748520612716675
Epoch: 4, Steps: 154 | Train Loss: 1.724 Vali Loss: 1.931 Vali Acc: 0.371 Test Loss: 1.931 Test Acc: 0.371
Validation loss decreased (-0.345073 --> -0.370621).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0425026
	speed: 0.4222s/iter; left time: 1648.6427s
Epoch: 5 cost time: 21.273462772369385
Epoch: 5, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.079 Vali Acc: 0.373 Test Loss: 2.079 Test Acc: 0.373
Validation loss decreased (-0.370621 --> -0.373053).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5803964
	speed: 0.4276s/iter; left time: 1603.9903s
Epoch: 6 cost time: 19.323742628097534
Epoch: 6, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.301 Vali Acc: 0.367 Test Loss: 2.301 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4482577
	speed: 0.4397s/iter; left time: 1581.6019s
Epoch: 7 cost time: 20.66384220123291
Epoch: 7, Steps: 154 | Train Loss: 1.452 Vali Loss: 1.925 Vali Acc: 0.392 Test Loss: 1.925 Test Acc: 0.392
Validation loss decreased (-0.373053 --> -0.391708).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2940960
	speed: 0.4118s/iter; left time: 1417.9820s
Epoch: 8 cost time: 20.745097398757935
Epoch: 8, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.106 Vali Acc: 0.333 Test Loss: 2.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4228187
	speed: 0.4345s/iter; left time: 1429.0802s
Epoch: 9 cost time: 19.425118923187256
Epoch: 9, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.316 Vali Acc: 0.308 Test Loss: 2.316 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1092405
	speed: 0.4370s/iter; left time: 1369.9567s
Epoch: 10 cost time: 20.755528688430786
Epoch: 10, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.002 Vali Acc: 0.217 Test Loss: 3.002 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9545877
	speed: 0.4161s/iter; left time: 1240.5310s
Epoch: 11 cost time: 20.88111639022827
Epoch: 11, Steps: 154 | Train Loss: 1.286 Vali Loss: 3.662 Vali Acc: 0.184 Test Loss: 3.662 Test Acc: 0.184
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.8053772
	speed: 0.4351s/iter; left time: 1229.8986s
Epoch: 12 cost time: 19.152403593063354
Epoch: 12, Steps: 154 | Train Loss: 1.227 Vali Loss: 4.235 Vali Acc: 0.118 Test Loss: 4.235 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0947394
	speed: 0.4343s/iter; left time: 1160.8464s
Epoch: 13 cost time: 21.095601797103882
Epoch: 13, Steps: 154 | Train Loss: 1.178 Vali Loss: 4.852 Vali Acc: 0.100 Test Loss: 4.852 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.0488632
	speed: 0.4187s/iter; left time: 1054.7169s
Epoch: 14 cost time: 20.71603775024414
Epoch: 14, Steps: 154 | Train Loss: 1.179 Vali Loss: 3.111 Vali Acc: 0.107 Test Loss: 3.111 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.5369232
	speed: 0.4267s/iter; left time: 1009.1514s
Epoch: 15 cost time: 17.842962741851807
Epoch: 15, Steps: 154 | Train Loss: 1.123 Vali Loss: 3.864 Vali Acc: 0.183 Test Loss: 3.864 Test Acc: 0.183
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.0528405
	speed: 0.3880s/iter; left time: 857.9225s
Epoch: 16 cost time: 19.218057870864868
Epoch: 16, Steps: 154 | Train Loss: 1.063 Vali Loss: 4.446 Vali Acc: 0.125 Test Loss: 4.446 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.6787695
	speed: 0.3741s/iter; left time: 769.4774s
Epoch: 17 cost time: 18.74026870727539
Epoch: 17, Steps: 154 | Train Loss: 1.052 Vali Loss: 3.564 Vali Acc: 0.178 Test Loss: 3.564 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 1775246
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0146403
	speed: 0.1059s/iter; left time: 478.8007s
Epoch: 1 cost time: 15.6731276512146
Epoch: 1, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.072 Vali Acc: 0.328 Test Loss: 2.072 Test Acc: 0.328
Validation loss decreased (inf --> -0.328446).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6843984
	speed: 0.2987s/iter; left time: 1304.2087s
Epoch: 2 cost time: 12.99726915359497
Epoch: 2, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.064 Vali Acc: 0.336 Test Loss: 2.064 Test Acc: 0.336
Validation loss decreased (-0.328446 --> -0.335746).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7499390
	speed: 0.2985s/iter; left time: 1257.6920s
Epoch: 3 cost time: 14.46399188041687
Epoch: 3, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.128 Vali Acc: 0.341 Test Loss: 2.128 Test Acc: 0.341
Validation loss decreased (-0.335746 --> -0.340611).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9656792
	speed: 0.2936s/iter; left time: 1191.8034s
Epoch: 4 cost time: 13.439010858535767
Epoch: 4, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.178 Vali Acc: 0.352 Test Loss: 2.178 Test Acc: 0.352
Validation loss decreased (-0.340611 --> -0.352371).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7653348
	speed: 0.3082s/iter; left time: 1203.3432s
Epoch: 5 cost time: 14.470906019210815
Epoch: 5, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.016 Vali Acc: 0.367 Test Loss: 2.016 Test Acc: 0.367
Validation loss decreased (-0.352371 --> -0.366971).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7620868
	speed: 0.2949s/iter; left time: 1106.0025s
Epoch: 6 cost time: 14.119123220443726
Epoch: 6, Steps: 154 | Train Loss: 1.447 Vali Loss: 4.457 Vali Acc: 0.076 Test Loss: 4.457 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2189831
	speed: 0.3126s/iter; left time: 1124.3003s
Epoch: 7 cost time: 13.414871454238892
Epoch: 7, Steps: 154 | Train Loss: 1.409 Vali Loss: 2.465 Vali Acc: 0.146 Test Loss: 2.465 Test Acc: 0.146
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2342420
	speed: 0.2924s/iter; left time: 1006.8775s
Epoch: 8 cost time: 14.885225534439087
Epoch: 8, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.565 Vali Acc: 0.095 Test Loss: 3.565 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4550575
	speed: 0.3035s/iter; left time: 998.2443s
Epoch: 9 cost time: 13.205458402633667
Epoch: 9, Steps: 154 | Train Loss: 1.307 Vali Loss: 2.952 Vali Acc: 0.114 Test Loss: 2.952 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3339329
	speed: 0.3096s/iter; left time: 970.7177s
Epoch: 10 cost time: 15.247397422790527
Epoch: 10, Steps: 154 | Train Loss: 1.278 Vali Loss: 4.585 Vali Acc: 0.118 Test Loss: 4.585 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.1505998
	speed: 0.3188s/iter; left time: 950.2737s
Epoch: 11 cost time: 14.306667804718018
Epoch: 11, Steps: 154 | Train Loss: 1.229 Vali Loss: 3.637 Vali Acc: 0.104 Test Loss: 3.637 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.1833812
	speed: 0.3295s/iter; left time: 931.6177s
Epoch: 12 cost time: 15.92719316482544
Epoch: 12, Steps: 154 | Train Loss: 1.224 Vali Loss: 2.852 Vali Acc: 0.114 Test Loss: 2.852 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.9784966
	speed: 0.3197s/iter; left time: 854.5796s
Epoch: 13 cost time: 14.74566912651062
Epoch: 13, Steps: 154 | Train Loss: 1.182 Vali Loss: 3.551 Vali Acc: 0.155 Test Loss: 3.551 Test Acc: 0.155
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.3113493
	speed: 0.2881s/iter; left time: 725.6549s
Epoch: 14 cost time: 13.464589595794678
Epoch: 14, Steps: 154 | Train Loss: 1.134 Vali Loss: 5.524 Vali Acc: 0.098 Test Loss: 5.524 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.3814291
	speed: 0.3458s/iter; left time: 817.9167s
Epoch: 15 cost time: 15.288073062896729
Epoch: 15, Steps: 154 | Train Loss: 1.115 Vali Loss: 4.433 Vali Acc: 0.095 Test Loss: 4.433 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 533774
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7956284
	speed: 0.1233s/iter; left time: 557.5011s
Epoch: 1 cost time: 19.06645154953003
Epoch: 1, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.099 Vali Acc: 0.326 Test Loss: 2.099 Test Acc: 0.326
Validation loss decreased (inf --> -0.325608).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8969972
	speed: 0.4250s/iter; left time: 1855.8786s
Epoch: 2 cost time: 18.60492777824402
Epoch: 2, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.102 Vali Acc: 0.340 Test Loss: 2.102 Test Acc: 0.340
Validation loss decreased (-0.325608 --> -0.340206).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1991084
	speed: 0.3903s/iter; left time: 1644.1437s
Epoch: 3 cost time: 17.202988386154175
Epoch: 3, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.048 Vali Acc: 0.345 Test Loss: 2.048 Test Acc: 0.345
Validation loss decreased (-0.340206 --> -0.344667).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1814985
	speed: 0.4127s/iter; left time: 1675.0911s
Epoch: 4 cost time: 19.446741819381714
Epoch: 4, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.075 Vali Acc: 0.371 Test Loss: 2.075 Test Acc: 0.371
Validation loss decreased (-0.344667 --> -0.371431).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0635424
	speed: 0.4015s/iter; left time: 1567.8969s
Epoch: 5 cost time: 17.120547771453857
Epoch: 5, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.443 Vali Acc: 0.206 Test Loss: 2.443 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7580287
	speed: 0.3984s/iter; left time: 1494.3046s
Epoch: 6 cost time: 18.772265911102295
Epoch: 6, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.968 Vali Acc: 0.197 Test Loss: 2.968 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3630126
	speed: 0.4130s/iter; left time: 1485.4424s
Epoch: 7 cost time: 17.097893238067627
Epoch: 7, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.695 Vali Acc: 0.151 Test Loss: 2.695 Test Acc: 0.151
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3630240
	speed: 0.3877s/iter; left time: 1334.7450s
Epoch: 8 cost time: 18.4560546875
Epoch: 8, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.569 Vali Acc: 0.107 Test Loss: 2.569 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.5762596
	speed: 0.4213s/iter; left time: 1385.7233s
Epoch: 9 cost time: 17.354675769805908
Epoch: 9, Steps: 154 | Train Loss: 1.357 Vali Loss: 3.811 Vali Acc: 0.078 Test Loss: 3.811 Test Acc: 0.078
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.2731000
	speed: 0.3462s/iter; left time: 1085.3071s
Epoch: 10 cost time: 15.741291761398315
Epoch: 10, Steps: 154 | Train Loss: 1.318 Vali Loss: 4.311 Vali Acc: 0.202 Test Loss: 4.311 Test Acc: 0.202
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.0048450
	speed: 0.3897s/iter; left time: 1161.6758s
Epoch: 11 cost time: 17.731154441833496
Epoch: 11, Steps: 154 | Train Loss: 1.319 Vali Loss: 4.277 Vali Acc: 0.099 Test Loss: 4.277 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.9012266
	speed: 0.3572s/iter; left time: 1009.8551s
Epoch: 12 cost time: 15.3750901222229
Epoch: 12, Steps: 154 | Train Loss: 1.259 Vali Loss: 4.574 Vali Acc: 0.091 Test Loss: 4.574 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.1601118
	speed: 0.3774s/iter; left time: 1008.7916s
Epoch: 13 cost time: 17.789378881454468
Epoch: 13, Steps: 154 | Train Loss: 1.233 Vali Loss: 5.087 Vali Acc: 0.093 Test Loss: 5.087 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0298007
	speed: 0.3661s/iter; left time: 922.2931s
Epoch: 14 cost time: 15.527087926864624
Epoch: 14, Steps: 154 | Train Loss: 1.218 Vali Loss: 3.754 Vali Acc: 0.098 Test Loss: 3.754 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37145174371451745
model parameter : 1775246
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0221648
	speed: 0.1036s/iter; left time: 468.1984s
Epoch: 1 cost time: 14.945858716964722
Epoch: 1, Steps: 154 | Train Loss: 2.148 Vali Loss: 2.072 Vali Acc: 0.330 Test Loss: 2.072 Test Acc: 0.330
Validation loss decreased (inf --> -0.330474).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6945845
	speed: 0.2873s/iter; left time: 1254.5975s
Epoch: 2 cost time: 12.487990856170654
Epoch: 2, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.048 Vali Acc: 0.339 Test Loss: 2.048 Test Acc: 0.339
Validation loss decreased (-0.330474 --> -0.339396).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8200359
	speed: 0.2915s/iter; left time: 1228.1143s
Epoch: 3 cost time: 13.826958179473877
Epoch: 3, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.099 Vali Acc: 0.359 Test Loss: 2.099 Test Acc: 0.359
Validation loss decreased (-0.339396 --> -0.358860).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9128700
	speed: 0.3102s/iter; left time: 1258.9783s
Epoch: 4 cost time: 12.96651005744934
Epoch: 4, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.069 Vali Acc: 0.360 Test Loss: 2.069 Test Acc: 0.360
Validation loss decreased (-0.358860 --> -0.359671).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5671690
	speed: 0.2820s/iter; left time: 1101.0722s
Epoch: 5 cost time: 12.38841700553894
Epoch: 5, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.020 Vali Acc: 0.372 Test Loss: 2.020 Test Acc: 0.372
Validation loss decreased (-0.359671 --> -0.371837).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7033843
	speed: 0.3023s/iter; left time: 1134.0193s
Epoch: 6 cost time: 13.665860891342163
Epoch: 6, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.351 Vali Acc: 0.076 Test Loss: 3.351 Test Acc: 0.076
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0520684
	speed: 0.3009s/iter; left time: 1082.4719s
Epoch: 7 cost time: 12.543731212615967
Epoch: 7, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.686 Vali Acc: 0.090 Test Loss: 2.686 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1531163
	speed: 0.3021s/iter; left time: 1040.0693s
Epoch: 8 cost time: 13.9996919631958
Epoch: 8, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.433 Vali Acc: 0.165 Test Loss: 2.433 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5533136
	speed: 0.3393s/iter; left time: 1115.8054s
Epoch: 9 cost time: 14.69350552558899
Epoch: 9, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.692 Vali Acc: 0.134 Test Loss: 2.692 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3869095
	speed: 0.3147s/iter; left time: 986.5668s
Epoch: 10 cost time: 13.194140911102295
Epoch: 10, Steps: 154 | Train Loss: 1.293 Vali Loss: 3.029 Vali Acc: 0.140 Test Loss: 3.029 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.2473801
	speed: 0.3173s/iter; left time: 946.0187s
Epoch: 11 cost time: 14.733462572097778
Epoch: 11, Steps: 154 | Train Loss: 1.248 Vali Loss: 5.022 Vali Acc: 0.094 Test Loss: 5.022 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3371300
	speed: 0.3386s/iter; left time: 957.1208s
Epoch: 12 cost time: 14.522967100143433
Epoch: 12, Steps: 154 | Train Loss: 1.234 Vali Loss: 4.395 Vali Acc: 0.092 Test Loss: 4.395 Test Acc: 0.092
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.8874488
	speed: 0.3073s/iter; left time: 821.3475s
Epoch: 13 cost time: 13.40531301498413
Epoch: 13, Steps: 154 | Train Loss: 1.200 Vali Loss: 4.799 Vali Acc: 0.100 Test Loss: 4.799 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.4628807
	speed: 0.3263s/iter; left time: 821.9428s
Epoch: 14 cost time: 14.734553337097168
Epoch: 14, Steps: 154 | Train Loss: 1.157 Vali Loss: 5.159 Vali Acc: 0.084 Test Loss: 5.159 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.3737621
	speed: 0.3350s/iter; left time: 792.3849s
Epoch: 15 cost time: 13.888229131698608
Epoch: 15, Steps: 154 | Train Loss: 1.134 Vali Loss: 4.758 Vali Acc: 0.114 Test Loss: 4.758 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3718572587185726
model parameter : 533774
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7933451
	speed: 0.1072s/iter; left time: 484.7292s
Epoch: 1 cost time: 15.796369075775146
Epoch: 1, Steps: 154 | Train Loss: 2.161 Vali Loss: 2.108 Vali Acc: 0.319 Test Loss: 2.108 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8915231
	speed: 0.3371s/iter; left time: 1471.9535s
Epoch: 2 cost time: 13.917649745941162
Epoch: 2, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.057 Vali Acc: 0.339 Test Loss: 2.057 Test Acc: 0.339
Validation loss decreased (-0.319119 --> -0.338990).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2369018
	speed: 0.3010s/iter; left time: 1268.0734s
Epoch: 3 cost time: 12.771891117095947
Epoch: 3, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.026 Vali Acc: 0.350 Test Loss: 2.026 Test Acc: 0.350
Validation loss decreased (-0.338990 --> -0.349534).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2043099
	speed: 0.3175s/iter; left time: 1288.8348s
Epoch: 4 cost time: 14.21224308013916
Epoch: 4, Steps: 154 | Train Loss: 1.738 Vali Loss: 1.984 Vali Acc: 0.364 Test Loss: 1.984 Test Acc: 0.364
Validation loss decreased (-0.349534 --> -0.364133).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9109691
	speed: 0.3304s/iter; left time: 1290.3655s
Epoch: 5 cost time: 13.28815221786499
Epoch: 5, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.185 Vali Acc: 0.333 Test Loss: 2.185 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5212222
	speed: 0.3002s/iter; left time: 1126.0635s
Epoch: 6 cost time: 13.114115715026855
Epoch: 6, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.505 Vali Acc: 0.199 Test Loss: 2.505 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4238142
	speed: 0.3258s/iter; left time: 1172.0384s
Epoch: 7 cost time: 14.586024761199951
Epoch: 7, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.426 Vali Acc: 0.387 Test Loss: 2.426 Test Acc: 0.387
Validation loss decreased (-0.364133 --> -0.386837).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.6023159
	speed: 0.3259s/iter; left time: 1122.0378s
Epoch: 8 cost time: 12.927006244659424
Epoch: 8, Steps: 154 | Train Loss: 1.492 Vali Loss: 3.854 Vali Acc: 0.102 Test Loss: 3.854 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4401523
	speed: 0.3030s/iter; left time: 996.6035s
Epoch: 9 cost time: 12.585215330123901
Epoch: 9, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.824 Vali Acc: 0.109 Test Loss: 2.824 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1366115
	speed: 0.3028s/iter; left time: 949.2007s
Epoch: 10 cost time: 13.286129713058472
Epoch: 10, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.474 Vali Acc: 0.408 Test Loss: 2.474 Test Acc: 0.408
Validation loss decreased (-0.386837 --> -0.407923).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9373652
	speed: 0.2915s/iter; left time: 868.9402s
Epoch: 11 cost time: 11.843755960464478
Epoch: 11, Steps: 154 | Train Loss: 1.358 Vali Loss: 6.391 Vali Acc: 0.072 Test Loss: 6.391 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.8221560
	speed: 0.2751s/iter; left time: 777.6854s
Epoch: 12 cost time: 12.660127401351929
Epoch: 12, Steps: 154 | Train Loss: 1.298 Vali Loss: 6.155 Vali Acc: 0.124 Test Loss: 6.155 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3650544
	speed: 0.3134s/iter; left time: 837.6905s
Epoch: 13 cost time: 13.20487642288208
Epoch: 13, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.522 Vali Acc: 0.409 Test Loss: 3.522 Test Acc: 0.409
Validation loss decreased (-0.407923 --> -0.408724).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2363787
	speed: 0.2849s/iter; left time: 717.5980s
Epoch: 14 cost time: 11.751307249069214
Epoch: 14, Steps: 154 | Train Loss: 1.212 Vali Loss: 5.511 Vali Acc: 0.091 Test Loss: 5.511 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7025821
	speed: 0.2740s/iter; left time: 647.9351s
Epoch: 15 cost time: 11.922697067260742
Epoch: 15, Steps: 154 | Train Loss: 1.208 Vali Loss: 3.420 Vali Acc: 0.245 Test Loss: 3.420 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0757163
	speed: 0.2292s/iter; left time: 506.6956s
Epoch: 16 cost time: 9.037731647491455
Epoch: 16, Steps: 154 | Train Loss: 1.149 Vali Loss: 4.962 Vali Acc: 0.104 Test Loss: 4.962 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7562451
	speed: 0.2612s/iter; left time: 537.3430s
Epoch: 17 cost time: 10.66280484199524
Epoch: 17, Steps: 154 | Train Loss: 1.108 Vali Loss: 7.529 Vali Acc: 0.103 Test Loss: 7.529 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.9198927
	speed: 0.2593s/iter; left time: 493.3534s
Epoch: 18 cost time: 12.253691673278809
Epoch: 18, Steps: 154 | Train Loss: 1.080 Vali Loss: 5.342 Vali Acc: 0.120 Test Loss: 5.342 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.3570673
	speed: 0.2523s/iter; left time: 441.3142s
Epoch: 19 cost time: 10.48024868965149
Epoch: 19, Steps: 154 | Train Loss: 1.061 Vali Loss: 9.861 Vali Acc: 0.084 Test Loss: 9.861 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.9291959
	speed: 0.2626s/iter; left time: 418.8579s
Epoch: 20 cost time: 11.41255497932434
Epoch: 20, Steps: 154 | Train Loss: 1.002 Vali Loss: 7.612 Vali Acc: 0.096 Test Loss: 7.612 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8073753
	speed: 0.2548s/iter; left time: 367.1461s
Epoch: 21 cost time: 11.784099102020264
Epoch: 21, Steps: 154 | Train Loss: 0.985 Vali Loss: 12.009 Vali Acc: 0.080 Test Loss: 12.009 Test Acc: 0.080
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.5084249
	speed: 0.2651s/iter; left time: 341.1810s
Epoch: 22 cost time: 10.50916600227356
Epoch: 22, Steps: 154 | Train Loss: 0.944 Vali Loss: 9.286 Vali Acc: 0.086 Test Loss: 9.286 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.9289422
	speed: 0.2666s/iter; left time: 302.0806s
Epoch: 23 cost time: 12.373207569122314
Epoch: 23, Steps: 154 | Train Loss: 0.977 Vali Loss: 12.119 Vali Acc: 0.070 Test Loss: 12.119 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40875912408759124
model parameter : 1775246
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0388262
	speed: 0.0856s/iter; left time: 387.0879s
Epoch: 1 cost time: 12.50076675415039
Epoch: 1, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.084 Vali Acc: 0.324 Test Loss: 2.084 Test Acc: 0.324
Validation loss decreased (inf --> -0.323580).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7549127
	speed: 0.2558s/iter; left time: 1117.0880s
Epoch: 2 cost time: 10.5359365940094
Epoch: 2, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.045 Vali Acc: 0.336 Test Loss: 2.045 Test Acc: 0.336
Validation loss decreased (-0.323580 --> -0.336151).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8094989
	speed: 0.2794s/iter; left time: 1177.0020s
Epoch: 3 cost time: 10.515843629837036
Epoch: 3, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.162 Vali Acc: 0.362 Test Loss: 2.162 Test Acc: 0.362
Validation loss decreased (-0.336151 --> -0.362103).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8634646
	speed: 0.2621s/iter; left time: 1063.9289s
Epoch: 4 cost time: 11.950082778930664
Epoch: 4, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.349 Vali Acc: 0.361 Test Loss: 2.349 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7431735
	speed: 0.2691s/iter; left time: 1050.9308s
Epoch: 5 cost time: 10.22483229637146
Epoch: 5, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.467 Vali Acc: 0.384 Test Loss: 2.467 Test Acc: 0.384
Validation loss decreased (-0.362103 --> -0.384404).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1509874
	speed: 0.2782s/iter; left time: 1043.5593s
Epoch: 6 cost time: 12.019712448120117
Epoch: 6, Steps: 154 | Train Loss: 1.536 Vali Loss: 3.245 Vali Acc: 0.082 Test Loss: 3.245 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1172373
	speed: 0.2610s/iter; left time: 938.7262s
Epoch: 7 cost time: 10.56188702583313
Epoch: 7, Steps: 154 | Train Loss: 1.460 Vali Loss: 4.052 Vali Acc: 0.068 Test Loss: 4.052 Test Acc: 0.068
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3215333
	speed: 0.2749s/iter; left time: 946.4720s
Epoch: 8 cost time: 10.443469285964966
Epoch: 8, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.146 Vali Acc: 0.207 Test Loss: 3.146 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5257223
	speed: 0.2619s/iter; left time: 861.2865s
Epoch: 9 cost time: 11.767029762268066
Epoch: 9, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.077 Vali Acc: 0.216 Test Loss: 3.077 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2665961
	speed: 0.2725s/iter; left time: 854.4343s
Epoch: 10 cost time: 10.284862041473389
Epoch: 10, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.535 Vali Acc: 0.185 Test Loss: 3.535 Test Acc: 0.185
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4445271
	speed: 0.2711s/iter; left time: 808.2393s
Epoch: 11 cost time: 11.711338520050049
Epoch: 11, Steps: 154 | Train Loss: 1.312 Vali Loss: 5.845 Vali Acc: 0.068 Test Loss: 5.845 Test Acc: 0.068
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3388485
	speed: 0.2599s/iter; left time: 734.8089s
Epoch: 12 cost time: 10.532320022583008
Epoch: 12, Steps: 154 | Train Loss: 1.285 Vali Loss: 4.811 Vali Acc: 0.079 Test Loss: 4.811 Test Acc: 0.079
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.7765614
	speed: 0.2815s/iter; left time: 752.4023s
Epoch: 13 cost time: 10.761922121047974
Epoch: 13, Steps: 154 | Train Loss: 1.249 Vali Loss: 7.694 Vali Acc: 0.068 Test Loss: 7.694 Test Acc: 0.068
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.3850131
	speed: 0.2601s/iter; left time: 655.2636s
Epoch: 14 cost time: 11.595571041107178
Epoch: 14, Steps: 154 | Train Loss: 1.213 Vali Loss: 8.229 Vali Acc: 0.093 Test Loss: 8.229 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.5612082
	speed: 0.2702s/iter; left time: 639.0302s
Epoch: 15 cost time: 10.5053129196167
Epoch: 15, Steps: 154 | Train Loss: 1.204 Vali Loss: 9.366 Vali Acc: 0.069 Test Loss: 9.366 Test Acc: 0.069
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 533774
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2427137
	speed: 0.1387s/iter; left time: 626.9758s
Epoch: 1 cost time: 20.724156141281128
Epoch: 1, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.120 Vali Acc: 0.316 Test Loss: 2.120 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6940153
	speed: 0.4017s/iter; left time: 1754.1838s
Epoch: 2 cost time: 17.56011128425598
Epoch: 2, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.078 Vali Acc: 0.328 Test Loss: 2.078 Test Acc: 0.328
Validation loss decreased (-0.315875 --> -0.328041).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8189276
	speed: 0.3864s/iter; left time: 1628.0198s
Epoch: 3 cost time: 18.219960927963257
Epoch: 3, Steps: 154 | Train Loss: 1.930 Vali Loss: 2.020 Vali Acc: 0.339 Test Loss: 2.020 Test Acc: 0.339
Validation loss decreased (-0.328041 --> -0.338990).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5809807
	speed: 0.3818s/iter; left time: 1549.5246s
Epoch: 4 cost time: 19.749144315719604
Epoch: 4, Steps: 154 | Train Loss: 1.829 Vali Loss: 2.029 Vali Acc: 0.355 Test Loss: 2.029 Test Acc: 0.355
Validation loss decreased (-0.338990 --> -0.354805).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3868979
	speed: 0.3801s/iter; left time: 1484.3255s
Epoch: 5 cost time: 19.141749382019043
Epoch: 5, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.180 Vali Acc: 0.343 Test Loss: 2.180 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6184050
	speed: 0.3752s/iter; left time: 1407.4531s
Epoch: 6 cost time: 17.607146501541138
Epoch: 6, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.406 Vali Acc: 0.166 Test Loss: 2.406 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6773249
	speed: 0.3403s/iter; left time: 1224.0153s
Epoch: 7 cost time: 19.75865912437439
Epoch: 7, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.231 Vali Acc: 0.351 Test Loss: 2.231 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5606633
	speed: 0.3986s/iter; left time: 1372.4402s
Epoch: 8 cost time: 18.203750371932983
Epoch: 8, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.316 Vali Acc: 0.369 Test Loss: 2.316 Test Acc: 0.369
Validation loss decreased (-0.354805 --> -0.368995).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9527310
	speed: 0.4152s/iter; left time: 1365.6420s
Epoch: 9 cost time: 19.254544019699097
Epoch: 9, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.532 Vali Acc: 0.367 Test Loss: 2.532 Test Acc: 0.367
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4036158
	speed: 0.3999s/iter; left time: 1253.8410s
Epoch: 10 cost time: 20.69085121154785
Epoch: 10, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.401 Vali Acc: 0.364 Test Loss: 2.401 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4764003
	speed: 0.3940s/iter; left time: 1174.4711s
Epoch: 11 cost time: 19.094173192977905
Epoch: 11, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.174 Vali Acc: 0.392 Test Loss: 2.174 Test Acc: 0.392
Validation loss decreased (-0.368995 --> -0.392111).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3809713
	speed: 0.4118s/iter; left time: 1164.2804s
Epoch: 12 cost time: 18.30462646484375
Epoch: 12, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.761 Vali Acc: 0.372 Test Loss: 2.761 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1853431
	speed: 0.4423s/iter; left time: 1182.2148s
Epoch: 13 cost time: 22.109750032424927
Epoch: 13, Steps: 154 | Train Loss: 1.318 Vali Loss: 2.314 Vali Acc: 0.382 Test Loss: 2.314 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2718718
	speed: 0.4258s/iter; left time: 1072.6718s
Epoch: 14 cost time: 21.215482473373413
Epoch: 14, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.358 Vali Acc: 0.389 Test Loss: 2.358 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.1598899
	speed: 0.4410s/iter; left time: 1042.9144s
Epoch: 15 cost time: 19.89951205253601
Epoch: 15, Steps: 154 | Train Loss: 1.256 Vali Loss: 2.720 Vali Acc: 0.388 Test Loss: 2.720 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2545636
	speed: 0.4491s/iter; left time: 992.8873s
Epoch: 16 cost time: 21.34765648841858
Epoch: 16, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.788 Vali Acc: 0.143 Test Loss: 3.788 Test Acc: 0.143
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9926063
	speed: 0.4224s/iter; left time: 868.9546s
Epoch: 17 cost time: 21.636887550354004
Epoch: 17, Steps: 154 | Train Loss: 1.198 Vali Loss: 2.573 Vali Acc: 0.390 Test Loss: 2.573 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.2483639
	speed: 0.4384s/iter; left time: 834.2991s
Epoch: 18 cost time: 20.002871990203857
Epoch: 18, Steps: 154 | Train Loss: 1.173 Vali Loss: 3.187 Vali Acc: 0.181 Test Loss: 3.187 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.5721940
	speed: 0.4431s/iter; left time: 774.9981s
Epoch: 19 cost time: 20.39433526992798
Epoch: 19, Steps: 154 | Train Loss: 1.148 Vali Loss: 2.904 Vali Acc: 0.395 Test Loss: 2.904 Test Acc: 0.395
Validation loss decreased (-0.392111 --> -0.394537).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3181103
	speed: 0.4291s/iter; left time: 684.3543s
Epoch: 20 cost time: 22.14175581932068
Epoch: 20, Steps: 154 | Train Loss: 1.130 Vali Loss: 3.008 Vali Acc: 0.379 Test Loss: 3.008 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2471423
	speed: 0.4248s/iter; left time: 612.0728s
Epoch: 21 cost time: 20.202398777008057
Epoch: 21, Steps: 154 | Train Loss: 1.095 Vali Loss: 2.796 Vali Acc: 0.373 Test Loss: 2.796 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.7640225
	speed: 0.4408s/iter; left time: 567.2504s
Epoch: 22 cost time: 19.50265407562256
Epoch: 22, Steps: 154 | Train Loss: 1.039 Vali Loss: 4.338 Vali Acc: 0.172 Test Loss: 4.338 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.9281152
	speed: 0.4328s/iter; left time: 490.3066s
Epoch: 23 cost time: 21.263907194137573
Epoch: 23, Steps: 154 | Train Loss: 1.011 Vali Loss: 2.546 Vali Acc: 0.396 Test Loss: 2.546 Test Acc: 0.396
Validation loss decreased (-0.394537 --> -0.396163).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.9324717
	speed: 0.4211s/iter; left time: 412.2384s
Epoch: 24 cost time: 21.090438842773438
Epoch: 24, Steps: 154 | Train Loss: 0.993 Vali Loss: 2.409 Vali Acc: 0.410 Test Loss: 2.409 Test Acc: 0.410
Validation loss decreased (-0.396163 --> -0.409546).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.5698419
	speed: 0.4321s/iter; left time: 356.4627s
Epoch: 25 cost time: 19.27159810066223
Epoch: 25, Steps: 154 | Train Loss: 0.966 Vali Loss: 3.249 Vali Acc: 0.165 Test Loss: 3.249 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 1.1729003
	speed: 0.4235s/iter; left time: 284.1952s
Epoch: 26 cost time: 19.058974742889404
Epoch: 26, Steps: 154 | Train Loss: 0.940 Vali Loss: 3.188 Vali Acc: 0.283 Test Loss: 3.188 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.9658631
	speed: 0.3900s/iter; left time: 201.6279s
Epoch: 27 cost time: 19.85014033317566
Epoch: 27, Steps: 154 | Train Loss: 0.912 Vali Loss: 3.375 Vali Acc: 0.203 Test Loss: 3.375 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.9034723
	speed: 0.3854s/iter; left time: 139.9032s
Epoch: 28 cost time: 18.631145477294922
Epoch: 28, Steps: 154 | Train Loss: 0.877 Vali Loss: 4.430 Vali Acc: 0.206 Test Loss: 4.430 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.7441462
	speed: 0.4063s/iter; left time: 84.9098s
Epoch: 29 cost time: 17.677234888076782
Epoch: 29, Steps: 154 | Train Loss: 0.829 Vali Loss: 5.545 Vali Acc: 0.199 Test Loss: 5.545 Test Acc: 0.199
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 1.2956221
	speed: 0.3966s/iter; left time: 21.8151s
Epoch: 30 cost time: 19.330400228500366
Epoch: 30, Steps: 154 | Train Loss: 0.820 Vali Loss: 4.742 Vali Acc: 0.189 Test Loss: 4.742 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4095701540957015
model parameter : 1767086
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1515977
	speed: 0.0827s/iter; left time: 373.9715s
Epoch: 1 cost time: 12.962958812713623
Epoch: 1, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.118 Vali Acc: 0.320 Test Loss: 2.118 Test Acc: 0.320
Validation loss decreased (inf --> -0.319525).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9011639
	speed: 0.2800s/iter; left time: 1222.5514s
Epoch: 2 cost time: 12.031850099563599
Epoch: 2, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.125 Vali Acc: 0.333 Test Loss: 2.125 Test Acc: 0.333
Validation loss decreased (-0.319525 --> -0.333312).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7614468
	speed: 0.2863s/iter; left time: 1206.2862s
Epoch: 3 cost time: 12.759451150894165
Epoch: 3, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.109 Vali Acc: 0.337 Test Loss: 2.109 Test Acc: 0.337
Validation loss decreased (-0.333312 --> -0.336556).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3603517
	speed: 0.2803s/iter; left time: 1137.7540s
Epoch: 4 cost time: 12.156304359436035
Epoch: 4, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.090 Vali Acc: 0.355 Test Loss: 2.090 Test Acc: 0.355
Validation loss decreased (-0.336556 --> -0.355210).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5798280
	speed: 0.2830s/iter; left time: 1104.9690s
Epoch: 5 cost time: 13.214176177978516
Epoch: 5, Steps: 154 | Train Loss: 1.627 Vali Loss: 2.098 Vali Acc: 0.365 Test Loss: 2.098 Test Acc: 0.365
Validation loss decreased (-0.355210 --> -0.364943).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6606778
	speed: 0.2856s/iter; left time: 1071.2732s
Epoch: 6 cost time: 13.151082992553711
Epoch: 6, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.160 Vali Acc: 0.365 Test Loss: 2.160 Test Acc: 0.365
Validation loss decreased (-0.364943 --> -0.365347).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5670202
	speed: 0.2877s/iter; left time: 1034.9114s
Epoch: 7 cost time: 14.23468542098999
Epoch: 7, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.401 Vali Acc: 0.366 Test Loss: 2.401 Test Acc: 0.366
Validation loss decreased (-0.365347 --> -0.365751).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5166701
	speed: 0.2986s/iter; left time: 1028.0586s
Epoch: 8 cost time: 14.21035885810852
Epoch: 8, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.002 Vali Acc: 0.089 Test Loss: 3.002 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7126380
	speed: 0.2967s/iter; left time: 975.9275s
Epoch: 9 cost time: 13.631919622421265
Epoch: 9, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.179 Vali Acc: 0.369 Test Loss: 2.179 Test Acc: 0.369
Validation loss decreased (-0.365751 --> -0.369402).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3463312
	speed: 0.2992s/iter; left time: 938.1005s
Epoch: 10 cost time: 12.7251558303833
Epoch: 10, Steps: 154 | Train Loss: 1.412 Vali Loss: 4.081 Vali Acc: 0.108 Test Loss: 4.081 Test Acc: 0.108
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.8528517
	speed: 0.3003s/iter; left time: 895.1253s
Epoch: 11 cost time: 13.208312034606934
Epoch: 11, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.986 Vali Acc: 0.132 Test Loss: 2.986 Test Acc: 0.132
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2818743
	speed: 0.2978s/iter; left time: 841.9613s
Epoch: 12 cost time: 13.742211818695068
Epoch: 12, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.267 Vali Acc: 0.367 Test Loss: 2.267 Test Acc: 0.367
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0489519
	speed: 0.3032s/iter; left time: 810.5787s
Epoch: 13 cost time: 14.459317207336426
Epoch: 13, Steps: 154 | Train Loss: 1.279 Vali Loss: 3.245 Vali Acc: 0.124 Test Loss: 3.245 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.0778151
	speed: 0.2979s/iter; left time: 750.3215s
Epoch: 14 cost time: 14.430688619613647
Epoch: 14, Steps: 154 | Train Loss: 1.254 Vali Loss: 7.929 Vali Acc: 0.129 Test Loss: 7.929 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4107223
	speed: 0.3009s/iter; left time: 711.5738s
Epoch: 15 cost time: 14.349604368209839
Epoch: 15, Steps: 154 | Train Loss: 1.236 Vali Loss: 5.855 Vali Acc: 0.131 Test Loss: 5.855 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.9575694
	speed: 0.2994s/iter; left time: 661.9145s
Epoch: 16 cost time: 13.093905448913574
Epoch: 16, Steps: 154 | Train Loss: 1.196 Vali Loss: 3.992 Vali Acc: 0.136 Test Loss: 3.992 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.9979768
	speed: 0.2748s/iter; left time: 565.1649s
Epoch: 17 cost time: 14.625597715377808
Epoch: 17, Steps: 154 | Train Loss: 1.183 Vali Loss: 4.012 Vali Acc: 0.132 Test Loss: 4.012 Test Acc: 0.132
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.2806728
	speed: 0.3744s/iter; left time: 712.5687s
Epoch: 18 cost time: 17.022505283355713
Epoch: 18, Steps: 154 | Train Loss: 1.134 Vali Loss: 2.622 Vali Acc: 0.235 Test Loss: 2.622 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.4607308
	speed: 0.3732s/iter; left time: 652.7482s
Epoch: 19 cost time: 16.306052684783936
Epoch: 19, Steps: 154 | Train Loss: 1.108 Vali Loss: 5.824 Vali Acc: 0.111 Test Loss: 5.824 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36942416869424166
model parameter : 525518
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2157438
	speed: 0.1377s/iter; left time: 622.5797s
Epoch: 1 cost time: 21.20047354698181
Epoch: 1, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.120 Vali Acc: 0.315 Test Loss: 2.120 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7190967
	speed: 0.4585s/iter; left time: 2002.1431s
Epoch: 2 cost time: 20.627416849136353
Epoch: 2, Steps: 154 | Train Loss: 2.026 Vali Loss: 2.098 Vali Acc: 0.325 Test Loss: 2.098 Test Acc: 0.325
Validation loss decreased (-0.315469 --> -0.324797).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8358833
	speed: 0.4256s/iter; left time: 1793.1086s
Epoch: 3 cost time: 17.439303636550903
Epoch: 3, Steps: 154 | Train Loss: 1.922 Vali Loss: 2.057 Vali Acc: 0.341 Test Loss: 2.057 Test Acc: 0.341
Validation loss decreased (-0.324797 --> -0.340612).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6083666
	speed: 0.3679s/iter; left time: 1493.2663s
Epoch: 4 cost time: 17.112212896347046
Epoch: 4, Steps: 154 | Train Loss: 1.821 Vali Loss: 2.121 Vali Acc: 0.348 Test Loss: 2.121 Test Acc: 0.348
Validation loss decreased (-0.340612 --> -0.347911).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4367012
	speed: 0.4039s/iter; left time: 1577.2085s
Epoch: 5 cost time: 18.560450553894043
Epoch: 5, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.176 Vali Acc: 0.339 Test Loss: 2.176 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6969523
	speed: 0.4093s/iter; left time: 1535.2395s
Epoch: 6 cost time: 17.52666687965393
Epoch: 6, Steps: 154 | Train Loss: 1.639 Vali Loss: 1.995 Vali Acc: 0.369 Test Loss: 1.995 Test Acc: 0.369
Validation loss decreased (-0.347911 --> -0.368593).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6315979
	speed: 0.3585s/iter; left time: 1289.4643s
Epoch: 7 cost time: 16.45201802253723
Epoch: 7, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.291 Vali Acc: 0.354 Test Loss: 2.291 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5214516
	speed: 0.3920s/iter; left time: 1349.7189s
Epoch: 8 cost time: 18.80808448791504
Epoch: 8, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.199 Vali Acc: 0.355 Test Loss: 2.199 Test Acc: 0.355
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9328201
	speed: 0.4060s/iter; left time: 1335.3304s
Epoch: 9 cost time: 18.39331555366516
Epoch: 9, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.723 Vali Acc: 0.372 Test Loss: 2.723 Test Acc: 0.372
Validation loss decreased (-0.368593 --> -0.371830).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4358550
	speed: 0.3735s/iter; left time: 1170.9225s
Epoch: 10 cost time: 16.836953163146973
Epoch: 10, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.574 Vali Acc: 0.375 Test Loss: 2.574 Test Acc: 0.375
Validation loss decreased (-0.371830 --> -0.375076).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5092578
	speed: 0.3808s/iter; left time: 1135.2204s
Epoch: 11 cost time: 18.428411722183228
Epoch: 11, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.200 Vali Acc: 0.394 Test Loss: 2.200 Test Acc: 0.394
Validation loss decreased (-0.375076 --> -0.393733).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3067298
	speed: 0.4130s/iter; left time: 1167.6794s
Epoch: 12 cost time: 18.648982524871826
Epoch: 12, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.800 Vali Acc: 0.392 Test Loss: 2.800 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.1557897
	speed: 0.3792s/iter; left time: 1013.5868s
Epoch: 13 cost time: 16.16759204864502
Epoch: 13, Steps: 154 | Train Loss: 1.315 Vali Loss: 2.479 Vali Acc: 0.366 Test Loss: 2.479 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3225818
	speed: 0.3681s/iter; left time: 927.1744s
Epoch: 14 cost time: 18.19573402404785
Epoch: 14, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.950 Vali Acc: 0.157 Test Loss: 2.950 Test Acc: 0.157
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0670582
	speed: 0.4290s/iter; left time: 1014.4689s
Epoch: 15 cost time: 19.902677536010742
Epoch: 15, Steps: 154 | Train Loss: 1.259 Vali Loss: 2.398 Vali Acc: 0.386 Test Loss: 2.398 Test Acc: 0.386
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.2000899
	speed: 0.4276s/iter; left time: 945.4493s
Epoch: 16 cost time: 18.075175762176514
Epoch: 16, Steps: 154 | Train Loss: 1.229 Vali Loss: 2.732 Vali Acc: 0.294 Test Loss: 2.732 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.7661929
	speed: 0.3982s/iter; left time: 819.0341s
Epoch: 17 cost time: 18.259716987609863
Epoch: 17, Steps: 154 | Train Loss: 1.203 Vali Loss: 3.167 Vali Acc: 0.384 Test Loss: 3.167 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.2884037
	speed: 0.4355s/iter; left time: 828.7579s
Epoch: 18 cost time: 19.925399780273438
Epoch: 18, Steps: 154 | Train Loss: 1.163 Vali Loss: 3.909 Vali Acc: 0.106 Test Loss: 3.909 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.7013270
	speed: 0.4407s/iter; left time: 770.7732s
Epoch: 19 cost time: 18.876245975494385
Epoch: 19, Steps: 154 | Train Loss: 1.114 Vali Loss: 2.340 Vali Acc: 0.406 Test Loss: 2.340 Test Acc: 0.406
Validation loss decreased (-0.393733 --> -0.405492).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3708199
	speed: 0.4007s/iter; left time: 639.1018s
Epoch: 20 cost time: 18.567312955856323
Epoch: 20, Steps: 154 | Train Loss: 1.116 Vali Loss: 4.488 Vali Acc: 0.115 Test Loss: 4.488 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2157619
	speed: 0.4283s/iter; left time: 617.1127s
Epoch: 21 cost time: 19.73390793800354
Epoch: 21, Steps: 154 | Train Loss: 1.069 Vali Loss: 2.624 Vali Acc: 0.363 Test Loss: 2.624 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.6804457
	speed: 0.4401s/iter; left time: 566.3853s
Epoch: 22 cost time: 19.66307044029236
Epoch: 22, Steps: 154 | Train Loss: 1.030 Vali Loss: 4.816 Vali Acc: 0.110 Test Loss: 4.816 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.9678110
	speed: 0.4089s/iter; left time: 463.3206s
Epoch: 23 cost time: 17.7919020652771
Epoch: 23, Steps: 154 | Train Loss: 1.015 Vali Loss: 3.072 Vali Acc: 0.243 Test Loss: 3.072 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.9058739
	speed: 0.4091s/iter; left time: 400.5330s
Epoch: 24 cost time: 19.919798612594604
Epoch: 24, Steps: 154 | Train Loss: 0.989 Vali Loss: 3.176 Vali Acc: 0.188 Test Loss: 3.176 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.6362848
	speed: 0.4435s/iter; left time: 365.8776s
Epoch: 25 cost time: 19.794286251068115
Epoch: 25, Steps: 154 | Train Loss: 1.001 Vali Loss: 5.444 Vali Acc: 0.097 Test Loss: 5.444 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.3366154
	speed: 0.4231s/iter; left time: 283.9158s
Epoch: 26 cost time: 18.41153311729431
Epoch: 26, Steps: 154 | Train Loss: 0.926 Vali Loss: 4.589 Vali Acc: 0.104 Test Loss: 4.589 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.9181302
	speed: 0.3990s/iter; left time: 206.2992s
Epoch: 27 cost time: 18.51774501800537
Epoch: 27, Steps: 154 | Train Loss: 0.888 Vali Loss: 4.433 Vali Acc: 0.094 Test Loss: 4.433 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.6248368
	speed: 0.4401s/iter; left time: 159.7496s
Epoch: 28 cost time: 20.03654646873474
Epoch: 28, Steps: 154 | Train Loss: 0.883 Vali Loss: 4.242 Vali Acc: 0.110 Test Loss: 4.242 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.7225504
	speed: 0.4277s/iter; left time: 89.3838s
Epoch: 29 cost time: 17.113468647003174
Epoch: 29, Steps: 154 | Train Loss: 0.852 Vali Loss: 4.573 Vali Acc: 0.104 Test Loss: 4.573 Test Acc: 0.104
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40551500405515006
model parameter : 1767086
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1435270
	speed: 0.1043s/iter; left time: 471.4352s
Epoch: 1 cost time: 15.161624670028687
Epoch: 1, Steps: 154 | Train Loss: 2.187 Vali Loss: 2.128 Vali Acc: 0.320 Test Loss: 2.128 Test Acc: 0.320
Validation loss decreased (inf --> -0.319525).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8771122
	speed: 0.3154s/iter; left time: 1377.1859s
Epoch: 2 cost time: 13.92853593826294
Epoch: 2, Steps: 154 | Train Loss: 1.994 Vali Loss: 2.130 Vali Acc: 0.334 Test Loss: 2.130 Test Acc: 0.334
Validation loss decreased (-0.319525 --> -0.334123).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7887640
	speed: 0.3145s/iter; left time: 1324.8559s
Epoch: 3 cost time: 13.156777381896973
Epoch: 3, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.131 Vali Acc: 0.337 Test Loss: 2.131 Test Acc: 0.337
Validation loss decreased (-0.334123 --> -0.337367).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4373807
	speed: 0.2854s/iter; left time: 1158.5255s
Epoch: 4 cost time: 12.172251462936401
Epoch: 4, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.196 Vali Acc: 0.356 Test Loss: 2.196 Test Acc: 0.356
Validation loss decreased (-0.337367 --> -0.356426).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5753479
	speed: 0.2956s/iter; left time: 1154.4388s
Epoch: 5 cost time: 14.04161262512207
Epoch: 5, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.136 Vali Acc: 0.356 Test Loss: 2.136 Test Acc: 0.356
Validation loss decreased (-0.356426 --> -0.356426).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7478004
	speed: 0.3207s/iter; left time: 1202.7707s
Epoch: 6 cost time: 13.863644361495972
Epoch: 6, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.257 Vali Acc: 0.361 Test Loss: 2.257 Test Acc: 0.361
Validation loss decreased (-0.356426 --> -0.360886).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6781584
	speed: 0.3099s/iter; left time: 1114.7978s
Epoch: 7 cost time: 12.557975053787231
Epoch: 7, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.768 Vali Acc: 0.319 Test Loss: 2.768 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5687960
	speed: 0.2853s/iter; left time: 982.3239s
Epoch: 8 cost time: 12.826134443283081
Epoch: 8, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.779 Vali Acc: 0.234 Test Loss: 2.779 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7487563
	speed: 0.3009s/iter; left time: 989.6409s
Epoch: 9 cost time: 13.821781635284424
Epoch: 9, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.408 Vali Acc: 0.354 Test Loss: 2.408 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3145440
	speed: 0.3137s/iter; left time: 983.5334s
Epoch: 10 cost time: 13.735567569732666
Epoch: 10, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.441 Vali Acc: 0.298 Test Loss: 2.441 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8960034
	speed: 0.3123s/iter; left time: 930.9775s
Epoch: 11 cost time: 12.836005210876465
Epoch: 11, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.749 Vali Acc: 0.333 Test Loss: 2.749 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2134494
	speed: 0.2849s/iter; left time: 805.4312s
Epoch: 12 cost time: 12.672701120376587
Epoch: 12, Steps: 154 | Train Loss: 1.351 Vali Loss: 3.056 Vali Acc: 0.122 Test Loss: 3.056 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9798794
	speed: 0.3049s/iter; left time: 814.9357s
Epoch: 13 cost time: 14.115027904510498
Epoch: 13, Steps: 154 | Train Loss: 1.295 Vali Loss: 3.463 Vali Acc: 0.133 Test Loss: 3.463 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.9813660
	speed: 0.3039s/iter; left time: 765.5488s
Epoch: 14 cost time: 13.442680358886719
Epoch: 14, Steps: 154 | Train Loss: 1.256 Vali Loss: 4.225 Vali Acc: 0.122 Test Loss: 4.225 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3437757
	speed: 0.3052s/iter; left time: 721.9153s
Epoch: 15 cost time: 12.88867974281311
Epoch: 15, Steps: 154 | Train Loss: 1.233 Vali Loss: 3.282 Vali Acc: 0.161 Test Loss: 3.282 Test Acc: 0.161
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.0596486
	speed: 0.2896s/iter; left time: 640.3476s
Epoch: 16 cost time: 12.831129312515259
Epoch: 16, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.041 Vali Acc: 0.125 Test Loss: 3.041 Test Acc: 0.125
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3609083536090835
model parameter : 525518
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1992381
	speed: 0.0703s/iter; left time: 317.7497s
Epoch: 1 cost time: 11.491496324539185
Epoch: 1, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.118 Vali Acc: 0.315 Test Loss: 2.118 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.7517889
	speed: 0.2985s/iter; left time: 1303.6504s
Epoch: 2 cost time: 13.162741422653198
Epoch: 2, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.079 Vali Acc: 0.324 Test Loss: 2.079 Test Acc: 0.324
Validation loss decreased (-0.315469 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8868055
	speed: 0.2648s/iter; left time: 1115.7116s
Epoch: 3 cost time: 10.301504611968994
Epoch: 3, Steps: 154 | Train Loss: 1.947 Vali Loss: 2.037 Vali Acc: 0.337 Test Loss: 2.037 Test Acc: 0.337
Validation loss decreased (-0.324391 --> -0.337368).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5714728
	speed: 0.1846s/iter; left time: 749.1240s
Epoch: 4 cost time: 9.338156938552856
Epoch: 4, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.021 Vali Acc: 0.349 Test Loss: 2.021 Test Acc: 0.349
Validation loss decreased (-0.337368 --> -0.349128).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5049676
	speed: 0.2592s/iter; left time: 1012.1808s
Epoch: 5 cost time: 10.76918625831604
Epoch: 5, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.068 Vali Acc: 0.341 Test Loss: 2.068 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7593544
	speed: 0.2657s/iter; left time: 996.4975s
Epoch: 6 cost time: 13.089306831359863
Epoch: 6, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.165 Vali Acc: 0.190 Test Loss: 2.165 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5905451
	speed: 0.2854s/iter; left time: 1026.7622s
Epoch: 7 cost time: 11.309885025024414
Epoch: 7, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.156 Vali Acc: 0.350 Test Loss: 2.156 Test Acc: 0.350
Validation loss decreased (-0.349128 --> -0.350343).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4801491
	speed: 0.2519s/iter; left time: 867.3429s
Epoch: 8 cost time: 12.165350198745728
Epoch: 8, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.030 Vali Acc: 0.359 Test Loss: 2.030 Test Acc: 0.359
Validation loss decreased (-0.350343 --> -0.359266).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9103968
	speed: 0.2960s/iter; left time: 973.5062s
Epoch: 9 cost time: 12.96504545211792
Epoch: 9, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.393 Vali Acc: 0.367 Test Loss: 2.393 Test Acc: 0.367
Validation loss decreased (-0.359266 --> -0.366967).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3775303
	speed: 0.2505s/iter; left time: 785.4706s
Epoch: 10 cost time: 10.828514814376831
Epoch: 10, Steps: 154 | Train Loss: 1.509 Vali Loss: 2.526 Vali Acc: 0.361 Test Loss: 2.526 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5592219
	speed: 0.2848s/iter; left time: 848.9409s
Epoch: 11 cost time: 12.673352241516113
Epoch: 11, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.089 Vali Acc: 0.403 Test Loss: 2.089 Test Acc: 0.403
Validation loss decreased (-0.366967 --> -0.402656).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4102606
	speed: 0.2408s/iter; left time: 680.6202s
Epoch: 12 cost time: 9.349546670913696
Epoch: 12, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.426 Vali Acc: 0.378 Test Loss: 2.426 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.2585503
	speed: 0.2293s/iter; left time: 612.9594s
Epoch: 13 cost time: 11.456444025039673
Epoch: 13, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.235 Vali Acc: 0.183 Test Loss: 3.235 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.5351903
	speed: 0.2438s/iter; left time: 614.0942s
Epoch: 14 cost time: 9.358950853347778
Epoch: 14, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.651 Vali Acc: 0.381 Test Loss: 2.651 Test Acc: 0.381
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.0884620
	speed: 0.2185s/iter; left time: 516.6369s
Epoch: 15 cost time: 10.861512899398804
Epoch: 15, Steps: 154 | Train Loss: 1.308 Vali Loss: 2.460 Vali Acc: 0.384 Test Loss: 2.460 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1351085
	speed: 0.2571s/iter; left time: 568.5513s
Epoch: 16 cost time: 10.66445255279541
Epoch: 16, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.187 Vali Acc: 0.215 Test Loss: 3.187 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.9770625
	speed: 0.2101s/iter; left time: 432.1721s
Epoch: 17 cost time: 9.764890193939209
Epoch: 17, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.623 Vali Acc: 0.207 Test Loss: 3.623 Test Acc: 0.207
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3109086
	speed: 0.2514s/iter; left time: 478.4582s
Epoch: 18 cost time: 11.31837010383606
Epoch: 18, Steps: 154 | Train Loss: 1.233 Vali Loss: 3.329 Vali Acc: 0.212 Test Loss: 3.329 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.5525459
	speed: 0.2349s/iter; left time: 410.8393s
Epoch: 19 cost time: 10.89322543144226
Epoch: 19, Steps: 154 | Train Loss: 1.205 Vali Loss: 3.096 Vali Acc: 0.305 Test Loss: 3.096 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2734792
	speed: 0.2770s/iter; left time: 441.8045s
Epoch: 20 cost time: 12.836628198623657
Epoch: 20, Steps: 154 | Train Loss: 1.218 Vali Loss: 3.910 Vali Acc: 0.209 Test Loss: 3.910 Test Acc: 0.209
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.4433277
	speed: 0.2653s/iter; left time: 382.3369s
Epoch: 21 cost time: 10.802788257598877
Epoch: 21, Steps: 154 | Train Loss: 1.170 Vali Loss: 2.784 Vali Acc: 0.386 Test Loss: 2.784 Test Acc: 0.386
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.402676399026764
model parameter : 1767086
model size : 7.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1124890
	speed: 0.0838s/iter; left time: 378.6834s
Epoch: 1 cost time: 12.350830316543579
Epoch: 1, Steps: 154 | Train Loss: 2.190 Vali Loss: 2.122 Vali Acc: 0.319 Test Loss: 2.122 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9106815
	speed: 0.2311s/iter; left time: 1009.0434s
Epoch: 2 cost time: 9.180038452148438
Epoch: 2, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.088 Vali Acc: 0.334 Test Loss: 2.088 Test Acc: 0.334
Validation loss decreased (-0.319119 --> -0.333718).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7420040
	speed: 0.2489s/iter; left time: 1048.7515s
Epoch: 3 cost time: 10.956167221069336
Epoch: 3, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.057 Vali Acc: 0.346 Test Loss: 2.057 Test Acc: 0.346
Validation loss decreased (-0.333718 --> -0.345884).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5278770
	speed: 0.2488s/iter; left time: 1009.9846s
Epoch: 4 cost time: 9.196070194244385
Epoch: 4, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.070 Vali Acc: 0.351 Test Loss: 2.070 Test Acc: 0.351
Validation loss decreased (-0.345884 --> -0.351155).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7585704
	speed: 0.2031s/iter; left time: 792.9600s
Epoch: 5 cost time: 9.631714105606079
Epoch: 5, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.115 Vali Acc: 0.354 Test Loss: 2.115 Test Acc: 0.354
Validation loss decreased (-0.351155 --> -0.353588).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8659230
	speed: 0.2285s/iter; left time: 857.2084s
Epoch: 6 cost time: 8.656195640563965
Epoch: 6, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.121 Vali Acc: 0.364 Test Loss: 2.121 Test Acc: 0.364
Validation loss decreased (-0.353588 --> -0.364131).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7013912
	speed: 0.1846s/iter; left time: 664.1308s
Epoch: 7 cost time: 7.8199968338012695
Epoch: 7, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.366 Vali Acc: 0.365 Test Loss: 2.366 Test Acc: 0.365
Validation loss decreased (-0.364131 --> -0.364940).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4500656
	speed: 0.2207s/iter; left time: 759.8282s
Epoch: 8 cost time: 9.268267631530762
Epoch: 8, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.383 Vali Acc: 0.367 Test Loss: 2.383 Test Acc: 0.367
Validation loss decreased (-0.364940 --> -0.366967).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8692943
	speed: 0.1964s/iter; left time: 645.9016s
Epoch: 9 cost time: 7.758403062820435
Epoch: 9, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.270 Vali Acc: 0.370 Test Loss: 2.270 Test Acc: 0.370
Validation loss decreased (-0.366967 --> -0.370213).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4684443
	speed: 0.2114s/iter; left time: 662.8850s
Epoch: 10 cost time: 9.560776710510254
Epoch: 10, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.140 Vali Acc: 0.313 Test Loss: 2.140 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9036385
	speed: 0.2139s/iter; left time: 637.7519s
Epoch: 11 cost time: 8.046669483184814
Epoch: 11, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.727 Vali Acc: 0.292 Test Loss: 2.727 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2890029
	speed: 0.1946s/iter; left time: 550.2353s
Epoch: 12 cost time: 9.647987365722656
Epoch: 12, Steps: 154 | Train Loss: 1.403 Vali Loss: 3.247 Vali Acc: 0.186 Test Loss: 3.247 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.6096665
	speed: 0.2656s/iter; left time: 709.8780s
Epoch: 13 cost time: 10.558833122253418
Epoch: 13, Steps: 154 | Train Loss: 1.365 Vali Loss: 2.786 Vali Acc: 0.390 Test Loss: 2.786 Test Acc: 0.390
Validation loss decreased (-0.370213 --> -0.389672).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.0351720
	speed: 0.2288s/iter; left time: 576.3829s
Epoch: 14 cost time: 9.587664365768433
Epoch: 14, Steps: 154 | Train Loss: 1.331 Vali Loss: 4.412 Vali Acc: 0.090 Test Loss: 4.412 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.2924187
	speed: 0.2576s/iter; left time: 609.1125s
Epoch: 15 cost time: 11.034314632415771
Epoch: 15, Steps: 154 | Train Loss: 1.296 Vali Loss: 2.598 Vali Acc: 0.215 Test Loss: 2.598 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.1287115
	speed: 0.2431s/iter; left time: 537.4361s
Epoch: 16 cost time: 9.274236917495728
Epoch: 16, Steps: 154 | Train Loss: 1.274 Vali Loss: 4.718 Vali Acc: 0.087 Test Loss: 4.718 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.9650812
	speed: 0.2148s/iter; left time: 441.8059s
Epoch: 17 cost time: 9.554486751556396
Epoch: 17, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.739 Vali Acc: 0.171 Test Loss: 3.739 Test Acc: 0.171
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.6408620
	speed: 0.1717s/iter; left time: 326.7331s
Epoch: 18 cost time: 7.370727062225342
Epoch: 18, Steps: 154 | Train Loss: 1.226 Vali Loss: 3.243 Vali Acc: 0.318 Test Loss: 3.243 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.4450676
	speed: 0.2671s/iter; left time: 467.2078s
Epoch: 19 cost time: 11.27917194366455
Epoch: 19, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.980 Vali Acc: 0.137 Test Loss: 3.980 Test Acc: 0.137
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.2980655
	speed: 0.2440s/iter; left time: 389.1886s
Epoch: 20 cost time: 8.874612092971802
Epoch: 20, Steps: 154 | Train Loss: 1.175 Vali Loss: 3.439 Vali Acc: 0.245 Test Loss: 3.439 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.0349314
	speed: 0.2106s/iter; left time: 303.4051s
Epoch: 21 cost time: 9.020276308059692
Epoch: 21, Steps: 154 | Train Loss: 1.176 Vali Loss: 4.122 Vali Acc: 0.139 Test Loss: 4.122 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.3958244
	speed: 0.2392s/iter; left time: 307.8478s
Epoch: 22 cost time: 10.150195837020874
Epoch: 22, Steps: 154 | Train Loss: 1.151 Vali Loss: 5.466 Vali Acc: 0.116 Test Loss: 5.466 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.4680697
	speed: 0.2311s/iter; left time: 261.8123s
Epoch: 23 cost time: 8.950056076049805
Epoch: 23, Steps: 154 | Train Loss: 1.128 Vali Loss: 2.956 Vali Acc: 0.404 Test Loss: 2.956 Test Acc: 0.404
Validation loss decreased (-0.389672 --> -0.404269).  Saving model ...
	iters: 100, epoch: 24 | loss: 1.8789843
	speed: 0.2077s/iter; left time: 203.3325s
Epoch: 24 cost time: 9.053583860397339
Epoch: 24, Steps: 154 | Train Loss: 1.105 Vali Loss: 5.388 Vali Acc: 0.118 Test Loss: 5.388 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.6909688
	speed: 0.2381s/iter; left time: 196.4734s
Epoch: 25 cost time: 10.11622929573059
Epoch: 25, Steps: 154 | Train Loss: 1.090 Vali Loss: 5.055 Vali Acc: 0.141 Test Loss: 5.055 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.8268126
	speed: 0.2323s/iter; left time: 155.9051s
Epoch: 26 cost time: 8.67504596710205
Epoch: 26, Steps: 154 | Train Loss: 1.074 Vali Loss: 5.160 Vali Acc: 0.103 Test Loss: 5.160 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.7676225
	speed: 0.2116s/iter; left time: 109.4042s
Epoch: 27 cost time: 8.414348602294922
Epoch: 27, Steps: 154 | Train Loss: 1.055 Vali Loss: 5.031 Vali Acc: 0.139 Test Loss: 5.031 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.8954802
	speed: 0.2571s/iter; left time: 93.3303s
Epoch: 28 cost time: 11.330392837524414
Epoch: 28, Steps: 154 | Train Loss: 1.028 Vali Loss: 5.820 Vali Acc: 0.099 Test Loss: 5.820 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 1.4419276
	speed: 0.2737s/iter; left time: 57.1930s
Epoch: 29 cost time: 10.488056659698486
Epoch: 29, Steps: 154 | Train Loss: 1.011 Vali Loss: 6.937 Vali Acc: 0.102 Test Loss: 6.937 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.6671506
	speed: 0.2442s/iter; left time: 13.4311s
Epoch: 30 cost time: 9.919067859649658
Epoch: 30, Steps: 154 | Train Loss: 1.005 Vali Loss: 5.651 Vali Acc: 0.142 Test Loss: 5.651 Test Acc: 0.142
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4042984590429846
model parameter : 525518
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3669708
	speed: 0.1509s/iter; left time: 682.4326s
Epoch: 1 cost time: 22.743061304092407
Epoch: 1, Steps: 154 | Train Loss: 2.191 Vali Loss: 2.109 Vali Acc: 0.318 Test Loss: 2.109 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0367806
	speed: 0.3959s/iter; left time: 1729.0932s
Epoch: 2 cost time: 19.399351119995117
Epoch: 2, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.030 Vali Acc: 0.334 Test Loss: 2.030 Test Acc: 0.334
Validation loss decreased (-0.318308 --> -0.333719).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6675313
	speed: 0.4207s/iter; left time: 1772.3639s
Epoch: 3 cost time: 21.269526481628418
Epoch: 3, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.471 Vali Acc: 0.088 Test Loss: 2.471 Test Acc: 0.088
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5702196
	speed: 0.3582s/iter; left time: 1453.7857s
Epoch: 4 cost time: 16.10527992248535
Epoch: 4, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.169 Vali Acc: 0.360 Test Loss: 2.169 Test Acc: 0.360
Validation loss decreased (-0.333719 --> -0.359670).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2672286
	speed: 0.3510s/iter; left time: 1370.6923s
Epoch: 5 cost time: 17.995103359222412
Epoch: 5, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.151 Vali Acc: 0.356 Test Loss: 2.151 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6694528
	speed: 0.3495s/iter; left time: 1311.0716s
Epoch: 6 cost time: 15.62347412109375
Epoch: 6, Steps: 154 | Train Loss: 1.560 Vali Loss: 2.650 Vali Acc: 0.093 Test Loss: 2.650 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7389789
	speed: 0.3348s/iter; left time: 1204.3441s
Epoch: 7 cost time: 17.716356992721558
Epoch: 7, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.267 Vali Acc: 0.296 Test Loss: 2.267 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4199754
	speed: 0.3609s/iter; left time: 1242.4425s
Epoch: 8 cost time: 16.666414499282837
Epoch: 8, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.607 Vali Acc: 0.092 Test Loss: 2.607 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.0447021
	speed: 0.3314s/iter; left time: 1089.8321s
Epoch: 9 cost time: 17.28504204750061
Epoch: 9, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.797 Vali Acc: 0.104 Test Loss: 3.797 Test Acc: 0.104
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5266266
	speed: 0.4148s/iter; left time: 1300.3540s
Epoch: 10 cost time: 20.06550359725952
Epoch: 10, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.816 Vali Acc: 0.116 Test Loss: 3.816 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.5752151
	speed: 0.3788s/iter; left time: 1129.2168s
Epoch: 11 cost time: 18.06739830970764
Epoch: 11, Steps: 154 | Train Loss: 1.412 Vali Loss: 4.330 Vali Acc: 0.116 Test Loss: 4.330 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.3075404
	speed: 0.4066s/iter; left time: 1149.3223s
Epoch: 12 cost time: 20.025825023651123
Epoch: 12, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.648 Vali Acc: 0.109 Test Loss: 3.648 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.6807621
	speed: 0.3842s/iter; left time: 1026.9735s
Epoch: 13 cost time: 17.789307594299316
Epoch: 13, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.516 Vali Acc: 0.329 Test Loss: 2.516 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0247855
	speed: 0.3962s/iter; left time: 998.1188s
Epoch: 14 cost time: 20.494250059127808
Epoch: 14, Steps: 154 | Train Loss: 1.288 Vali Loss: 4.609 Vali Acc: 0.133 Test Loss: 4.609 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3596918085969181
model parameter : 887918
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6912041
	speed: 0.0999s/iter; left time: 451.4637s
Epoch: 1 cost time: 14.504549026489258
Epoch: 1, Steps: 154 | Train Loss: 2.192 Vali Loss: 2.112 Vali Acc: 0.319 Test Loss: 2.112 Test Acc: 0.319
Validation loss decreased (inf --> -0.318714).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9582790
	speed: 0.3015s/iter; left time: 1316.7629s
Epoch: 2 cost time: 14.746256589889526
Epoch: 2, Steps: 154 | Train Loss: 1.991 Vali Loss: 2.153 Vali Acc: 0.326 Test Loss: 2.153 Test Acc: 0.326
Validation loss decreased (-0.318714 --> -0.325607).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1796124
	speed: 0.2828s/iter; left time: 1191.3818s
Epoch: 3 cost time: 12.466700553894043
Epoch: 3, Steps: 154 | Train Loss: 1.864 Vali Loss: 2.076 Vali Acc: 0.333 Test Loss: 2.076 Test Acc: 0.333
Validation loss decreased (-0.325607 --> -0.332907).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8193696
	speed: 0.2815s/iter; left time: 1142.4950s
Epoch: 4 cost time: 14.629719495773315
Epoch: 4, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.011 Vali Acc: 0.349 Test Loss: 2.011 Test Acc: 0.349
Validation loss decreased (-0.332907 --> -0.349128).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4316657
	speed: 0.2980s/iter; left time: 1163.5325s
Epoch: 5 cost time: 13.434661865234375
Epoch: 5, Steps: 154 | Train Loss: 1.697 Vali Loss: 1.992 Vali Acc: 0.353 Test Loss: 1.992 Test Acc: 0.353
Validation loss decreased (-0.349128 --> -0.352778).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6239048
	speed: 0.2662s/iter; left time: 998.5907s
Epoch: 6 cost time: 12.440900087356567
Epoch: 6, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.160 Vali Acc: 0.347 Test Loss: 2.160 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1076846
	speed: 0.3180s/iter; left time: 1143.6855s
Epoch: 7 cost time: 15.549774169921875
Epoch: 7, Steps: 154 | Train Loss: 1.564 Vali Loss: 2.071 Vali Acc: 0.369 Test Loss: 2.071 Test Acc: 0.369
Validation loss decreased (-0.352778 --> -0.368592).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5217186
	speed: 0.3150s/iter; left time: 1084.6101s
Epoch: 8 cost time: 14.413955688476562
Epoch: 8, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.453 Vali Acc: 0.110 Test Loss: 2.453 Test Acc: 0.110
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4569945
	speed: 0.3122s/iter; left time: 1026.9350s
Epoch: 9 cost time: 15.854673862457275
Epoch: 9, Steps: 154 | Train Loss: 1.435 Vali Loss: 4.692 Vali Acc: 0.081 Test Loss: 4.692 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7227637
	speed: 0.3341s/iter; left time: 1047.3500s
Epoch: 10 cost time: 15.922433614730835
Epoch: 10, Steps: 154 | Train Loss: 1.401 Vali Loss: 3.015 Vali Acc: 0.102 Test Loss: 3.015 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5332273
	speed: 0.3092s/iter; left time: 921.6944s
Epoch: 11 cost time: 14.179324626922607
Epoch: 11, Steps: 154 | Train Loss: 1.353 Vali Loss: 4.527 Vali Acc: 0.138 Test Loss: 4.527 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2853090
	speed: 0.3214s/iter; left time: 908.4791s
Epoch: 12 cost time: 16.066946029663086
Epoch: 12, Steps: 154 | Train Loss: 1.328 Vali Loss: 3.144 Vali Acc: 0.120 Test Loss: 3.144 Test Acc: 0.120
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4785001
	speed: 0.3337s/iter; left time: 891.9755s
Epoch: 13 cost time: 14.395832061767578
Epoch: 13, Steps: 154 | Train Loss: 1.288 Vali Loss: 4.244 Vali Acc: 0.150 Test Loss: 4.244 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.9021370
	speed: 0.2700s/iter; left time: 680.1992s
Epoch: 14 cost time: 12.747360229492188
Epoch: 14, Steps: 154 | Train Loss: 1.242 Vali Loss: 6.696 Vali Acc: 0.140 Test Loss: 6.696 Test Acc: 0.140
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0844864
	speed: 0.2961s/iter; left time: 700.2780s
Epoch: 15 cost time: 14.20012640953064
Epoch: 15, Steps: 154 | Train Loss: 1.210 Vali Loss: 8.472 Vali Acc: 0.096 Test Loss: 8.472 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3525523
	speed: 0.2747s/iter; left time: 607.3347s
Epoch: 16 cost time: 12.203472137451172
Epoch: 16, Steps: 154 | Train Loss: 1.186 Vali Loss: 7.880 Vali Acc: 0.135 Test Loss: 7.880 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.5123295
	speed: 0.2805s/iter; left time: 576.9402s
Epoch: 17 cost time: 14.421168565750122
Epoch: 17, Steps: 154 | Train Loss: 1.159 Vali Loss: 7.345 Vali Acc: 0.133 Test Loss: 7.345 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3686131386861314
model parameter : 267086
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3646526
	speed: 0.1018s/iter; left time: 460.3275s
Epoch: 1 cost time: 14.996140718460083
Epoch: 1, Steps: 154 | Train Loss: 2.198 Vali Loss: 2.111 Vali Acc: 0.318 Test Loss: 2.111 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0453334
	speed: 0.2978s/iter; left time: 1300.5870s
Epoch: 2 cost time: 16.329018115997314
Epoch: 2, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.035 Vali Acc: 0.335 Test Loss: 2.035 Test Acc: 0.335
Validation loss decreased (-0.317903 --> -0.334530).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8723303
	speed: 0.3472s/iter; left time: 1462.9392s
Epoch: 3 cost time: 16.228238582611084
Epoch: 3, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.229 Vali Acc: 0.343 Test Loss: 2.229 Test Acc: 0.343
Validation loss decreased (-0.334530 --> -0.343449).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7235188
	speed: 0.3240s/iter; left time: 1315.0733s
Epoch: 4 cost time: 16.60490131378174
Epoch: 4, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.197 Vali Acc: 0.340 Test Loss: 2.197 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3400699
	speed: 0.3505s/iter; left time: 1368.6132s
Epoch: 5 cost time: 17.404504776000977
Epoch: 5, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.164 Vali Acc: 0.361 Test Loss: 2.164 Test Acc: 0.361
Validation loss decreased (-0.343449 --> -0.360481).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6233865
	speed: 0.3339s/iter; left time: 1252.2881s
Epoch: 6 cost time: 15.342860460281372
Epoch: 6, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.662 Vali Acc: 0.091 Test Loss: 2.662 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8519545
	speed: 0.3226s/iter; left time: 1160.3026s
Epoch: 7 cost time: 16.9301278591156
Epoch: 7, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.808 Vali Acc: 0.107 Test Loss: 2.808 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4252665
	speed: 0.3411s/iter; left time: 1174.3660s
Epoch: 8 cost time: 16.305474519729614
Epoch: 8, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.587 Vali Acc: 0.102 Test Loss: 2.587 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.0810729
	speed: 0.2960s/iter; left time: 973.5342s
Epoch: 9 cost time: 13.356755495071411
Epoch: 9, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.660 Vali Acc: 0.118 Test Loss: 3.660 Test Acc: 0.118
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.4331181
	speed: 0.2918s/iter; left time: 914.9230s
Epoch: 10 cost time: 14.72728681564331
Epoch: 10, Steps: 154 | Train Loss: 1.432 Vali Loss: 3.827 Vali Acc: 0.118 Test Loss: 3.827 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4169579
	speed: 0.2948s/iter; left time: 878.7328s
Epoch: 11 cost time: 12.936593294143677
Epoch: 11, Steps: 154 | Train Loss: 1.403 Vali Loss: 4.998 Vali Acc: 0.139 Test Loss: 4.998 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3566123
	speed: 0.2707s/iter; left time: 765.3329s
Epoch: 12 cost time: 13.249506950378418
Epoch: 12, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.626 Vali Acc: 0.154 Test Loss: 2.626 Test Acc: 0.154
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.4840701
	speed: 0.3026s/iter; left time: 808.9089s
Epoch: 13 cost time: 14.639624834060669
Epoch: 13, Steps: 154 | Train Loss: 1.355 Vali Loss: 4.726 Vali Acc: 0.146 Test Loss: 4.726 Test Acc: 0.146
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.9278977
	speed: 0.2887s/iter; left time: 727.2400s
Epoch: 14 cost time: 12.996338367462158
Epoch: 14, Steps: 154 | Train Loss: 1.300 Vali Loss: 5.675 Vali Acc: 0.142 Test Loss: 5.675 Test Acc: 0.142
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.3855788
	speed: 0.2742s/iter; left time: 648.4710s
Epoch: 15 cost time: 14.474701404571533
Epoch: 15, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.511 Vali Acc: 0.267 Test Loss: 2.511 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3605028386050284
model parameter : 887918
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6969137
	speed: 0.0983s/iter; left time: 444.3079s
Epoch: 1 cost time: 14.53304672241211
Epoch: 1, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.114 Vali Acc: 0.318 Test Loss: 2.114 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0130212
	speed: 0.2829s/iter; left time: 1235.5796s
Epoch: 2 cost time: 13.562324523925781
Epoch: 2, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.123 Vali Acc: 0.327 Test Loss: 2.123 Test Acc: 0.327
Validation loss decreased (-0.317903 --> -0.327229).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1599095
	speed: 0.3052s/iter; left time: 1285.6675s
Epoch: 3 cost time: 13.767183542251587
Epoch: 3, Steps: 154 | Train Loss: 1.866 Vali Loss: 2.086 Vali Acc: 0.335 Test Loss: 2.086 Test Acc: 0.335
Validation loss decreased (-0.327229 --> -0.335340).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7575916
	speed: 0.2942s/iter; left time: 1194.1231s
Epoch: 4 cost time: 12.69837999343872
Epoch: 4, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.090 Vali Acc: 0.345 Test Loss: 2.090 Test Acc: 0.345
Validation loss decreased (-0.335340 --> -0.344667).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4722657
	speed: 0.2843s/iter; left time: 1110.0763s
Epoch: 5 cost time: 13.198974847793579
Epoch: 5, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.024 Vali Acc: 0.346 Test Loss: 2.024 Test Acc: 0.346
Validation loss decreased (-0.344667 --> -0.346290).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8342001
	speed: 0.3018s/iter; left time: 1132.0731s
Epoch: 6 cost time: 13.914021253585815
Epoch: 6, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.212 Vali Acc: 0.347 Test Loss: 2.212 Test Acc: 0.347
Validation loss decreased (-0.346290 --> -0.346693).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1914963
	speed: 0.2702s/iter; left time: 972.0616s
Epoch: 7 cost time: 10.924612760543823
Epoch: 7, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.008 Vali Acc: 0.366 Test Loss: 2.008 Test Acc: 0.366
Validation loss decreased (-0.346693 --> -0.365754).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4846742
	speed: 0.2537s/iter; left time: 873.3555s
Epoch: 8 cost time: 12.53174877166748
Epoch: 8, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.246 Vali Acc: 0.380 Test Loss: 2.246 Test Acc: 0.380
Validation loss decreased (-0.365754 --> -0.379945).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5396986
	speed: 0.2679s/iter; left time: 881.0962s
Epoch: 9 cost time: 11.745340347290039
Epoch: 9, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.207 Vali Acc: 0.358 Test Loss: 2.207 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6737554
	speed: 0.2394s/iter; left time: 750.4328s
Epoch: 10 cost time: 10.64940357208252
Epoch: 10, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.264 Vali Acc: 0.378 Test Loss: 2.264 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5281709
	speed: 0.2510s/iter; left time: 748.0823s
Epoch: 11 cost time: 12.109454154968262
Epoch: 11, Steps: 154 | Train Loss: 1.368 Vali Loss: 3.531 Vali Acc: 0.135 Test Loss: 3.531 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1765804
	speed: 0.2615s/iter; left time: 739.2263s
Epoch: 12 cost time: 11.308688402175903
Epoch: 12, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.478 Vali Acc: 0.202 Test Loss: 2.478 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3983973
	speed: 0.2365s/iter; left time: 632.1624s
Epoch: 13 cost time: 10.782037734985352
Epoch: 13, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.661 Vali Acc: 0.377 Test Loss: 2.661 Test Acc: 0.377
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.8888384
	speed: 0.2642s/iter; left time: 665.4820s
Epoch: 14 cost time: 13.50164246559143
Epoch: 14, Steps: 154 | Train Loss: 1.267 Vali Loss: 4.563 Vali Acc: 0.144 Test Loss: 4.563 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.0991355
	speed: 0.2926s/iter; left time: 691.8933s
Epoch: 15 cost time: 12.454894781112671
Epoch: 15, Steps: 154 | Train Loss: 1.231 Vali Loss: 4.404 Vali Acc: 0.107 Test Loss: 4.404 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.4464899
	speed: 0.2701s/iter; left time: 597.2033s
Epoch: 16 cost time: 12.45219898223877
Epoch: 16, Steps: 154 | Train Loss: 1.202 Vali Loss: 3.649 Vali Acc: 0.138 Test Loss: 3.649 Test Acc: 0.138
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.3687909
	speed: 0.2942s/iter; left time: 605.1200s
Epoch: 17 cost time: 12.94593596458435
Epoch: 17, Steps: 154 | Train Loss: 1.198 Vali Loss: 3.421 Vali Acc: 0.130 Test Loss: 3.421 Test Acc: 0.130
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.3043377
	speed: 0.2939s/iter; left time: 559.3059s
Epoch: 18 cost time: 12.808775424957275
Epoch: 18, Steps: 154 | Train Loss: 1.186 Vali Loss: 3.469 Vali Acc: 0.156 Test Loss: 3.469 Test Acc: 0.156
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 267086
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3772573
	speed: 0.1018s/iter; left time: 460.0916s
Epoch: 1 cost time: 13.324654817581177
Epoch: 1, Steps: 154 | Train Loss: 2.199 Vali Loss: 2.112 Vali Acc: 0.318 Test Loss: 2.112 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0916328
	speed: 0.2110s/iter; left time: 921.3823s
Epoch: 2 cost time: 13.389318704605103
Epoch: 2, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.110 Vali Acc: 0.324 Test Loss: 2.110 Test Acc: 0.324
Validation loss decreased (-0.317497 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7866374
	speed: 0.2252s/iter; left time: 948.8303s
Epoch: 3 cost time: 9.690796852111816
Epoch: 3, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.160 Vali Acc: 0.179 Test Loss: 2.160 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8043005
	speed: 0.2330s/iter; left time: 945.6141s
Epoch: 4 cost time: 11.48380160331726
Epoch: 4, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.281 Vali Acc: 0.249 Test Loss: 2.281 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.3437455
	speed: 0.2040s/iter; left time: 796.4772s
Epoch: 5 cost time: 10.659121751785278
Epoch: 5, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.249 Vali Acc: 0.349 Test Loss: 2.249 Test Acc: 0.349
Validation loss decreased (-0.324391 --> -0.349126).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7484627
	speed: 0.2292s/iter; left time: 859.7333s
Epoch: 6 cost time: 8.702587842941284
Epoch: 6, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.568 Vali Acc: 0.285 Test Loss: 2.568 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8972130
	speed: 0.2154s/iter; left time: 774.9332s
Epoch: 7 cost time: 11.11416220664978
Epoch: 7, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.593 Vali Acc: 0.356 Test Loss: 2.593 Test Acc: 0.356
Validation loss decreased (-0.349126 --> -0.356016).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3027231
	speed: 0.2130s/iter; left time: 733.1989s
Epoch: 8 cost time: 8.65514874458313
Epoch: 8, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.757 Vali Acc: 0.356 Test Loss: 2.757 Test Acc: 0.356
Validation loss decreased (-0.356016 --> -0.356420).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.0094463
	speed: 0.2488s/iter; left time: 818.2568s
Epoch: 9 cost time: 12.640869140625
Epoch: 9, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.451 Vali Acc: 0.367 Test Loss: 2.451 Test Acc: 0.367
Validation loss decreased (-0.356420 --> -0.366967).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4293170
	speed: 0.2410s/iter; left time: 755.6344s
Epoch: 10 cost time: 11.462856531143188
Epoch: 10, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.168 Vali Acc: 0.372 Test Loss: 2.168 Test Acc: 0.372
Validation loss decreased (-0.366967 --> -0.371836).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3257530
	speed: 0.2708s/iter; left time: 807.2292s
Epoch: 11 cost time: 11.260468244552612
Epoch: 11, Steps: 154 | Train Loss: 1.444 Vali Loss: 3.711 Vali Acc: 0.102 Test Loss: 3.711 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4194360
	speed: 0.2482s/iter; left time: 701.7108s
Epoch: 12 cost time: 12.621872663497925
Epoch: 12, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.283 Vali Acc: 0.363 Test Loss: 2.283 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1650548
	speed: 0.2596s/iter; left time: 693.9150s
Epoch: 13 cost time: 10.661990404129028
Epoch: 13, Steps: 154 | Train Loss: 1.382 Vali Loss: 2.390 Vali Acc: 0.369 Test Loss: 2.390 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.9137788
	speed: 0.2636s/iter; left time: 664.0427s
Epoch: 14 cost time: 13.182759523391724
Epoch: 14, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.545 Vali Acc: 0.394 Test Loss: 2.545 Test Acc: 0.394
Validation loss decreased (-0.371836 --> -0.393730).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.6677119
	speed: 0.2523s/iter; left time: 596.7105s
Epoch: 15 cost time: 10.852148056030273
Epoch: 15, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.530 Vali Acc: 0.395 Test Loss: 2.530 Test Acc: 0.395
Validation loss decreased (-0.393730 --> -0.394946).  Saving model ...
	iters: 100, epoch: 16 | loss: 2.0466719
	speed: 0.2375s/iter; left time: 525.2022s
Epoch: 16 cost time: 10.283479690551758
Epoch: 16, Steps: 154 | Train Loss: 1.306 Vali Loss: 2.968 Vali Acc: 0.372 Test Loss: 2.968 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.2026558
	speed: 0.2055s/iter; left time: 422.7177s
Epoch: 17 cost time: 10.42646074295044
Epoch: 17, Steps: 154 | Train Loss: 1.250 Vali Loss: 3.965 Vali Acc: 0.156 Test Loss: 3.965 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.5014918
	speed: 0.2233s/iter; left time: 425.0057s
Epoch: 18 cost time: 9.150517702102661
Epoch: 18, Steps: 154 | Train Loss: 1.244 Vali Loss: 4.566 Vali Acc: 0.238 Test Loss: 4.566 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.5067601
	speed: 0.2154s/iter; left time: 376.7643s
Epoch: 19 cost time: 10.924738883972168
Epoch: 19, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.141 Vali Acc: 0.175 Test Loss: 3.141 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.2088543
	speed: 0.2084s/iter; left time: 332.4125s
Epoch: 20 cost time: 8.96006989479065
Epoch: 20, Steps: 154 | Train Loss: 1.179 Vali Loss: 3.763 Vali Acc: 0.135 Test Loss: 3.763 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.8831894
	speed: 0.2271s/iter; left time: 327.1801s
Epoch: 21 cost time: 10.160584449768066
Epoch: 21, Steps: 154 | Train Loss: 1.152 Vali Loss: 4.535 Vali Acc: 0.142 Test Loss: 4.535 Test Acc: 0.142
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.9555326
	speed: 0.1996s/iter; left time: 256.8784s
Epoch: 22 cost time: 10.200908660888672
Epoch: 22, Steps: 154 | Train Loss: 1.190 Vali Loss: 3.790 Vali Acc: 0.364 Test Loss: 3.790 Test Acc: 0.364
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.2222219
	speed: 0.2705s/iter; left time: 306.4899s
Epoch: 23 cost time: 11.147362232208252
Epoch: 23, Steps: 154 | Train Loss: 1.121 Vali Loss: 5.141 Vali Acc: 0.148 Test Loss: 5.141 Test Acc: 0.148
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.7012902
	speed: 0.2481s/iter; left time: 242.8787s
Epoch: 24 cost time: 12.195357322692871
Epoch: 24, Steps: 154 | Train Loss: 1.140 Vali Loss: 4.618 Vali Acc: 0.187 Test Loss: 4.618 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.5461276
	speed: 0.2601s/iter; left time: 214.5821s
Epoch: 25 cost time: 11.003136157989502
Epoch: 25, Steps: 154 | Train Loss: 1.106 Vali Loss: 3.485 Vali Acc: 0.322 Test Loss: 3.485 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39497161394971614
model parameter : 887918
model size : 3.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6686280
	speed: 0.0763s/iter; left time: 344.9868s
Epoch: 1 cost time: 10.908081531524658
Epoch: 1, Steps: 154 | Train Loss: 2.205 Vali Loss: 2.105 Vali Acc: 0.318 Test Loss: 2.105 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0185897
	speed: 0.2408s/iter; left time: 1051.5125s
Epoch: 2 cost time: 11.889045476913452
Epoch: 2, Steps: 154 | Train Loss: 2.009 Vali Loss: 2.111 Vali Acc: 0.327 Test Loss: 2.111 Test Acc: 0.327
Validation loss decreased (-0.317497 --> -0.327229).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2087715
	speed: 0.2417s/iter; left time: 1018.2227s
Epoch: 3 cost time: 9.814873218536377
Epoch: 3, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.092 Vali Acc: 0.336 Test Loss: 2.092 Test Acc: 0.336
Validation loss decreased (-0.327229 --> -0.336151).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7977194
	speed: 0.1705s/iter; left time: 692.1295s
Epoch: 4 cost time: 5.986963987350464
Epoch: 4, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.091 Vali Acc: 0.345 Test Loss: 2.091 Test Acc: 0.345
Validation loss decreased (-0.336151 --> -0.345478).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5986218
	speed: 0.1377s/iter; left time: 537.6600s
Epoch: 5 cost time: 8.258358240127563
Epoch: 5, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.027 Vali Acc: 0.345 Test Loss: 2.027 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9431076
	speed: 0.2183s/iter; left time: 818.9008s
Epoch: 6 cost time: 8.426753520965576
Epoch: 6, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.143 Vali Acc: 0.339 Test Loss: 2.143 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3314407
	speed: 0.1959s/iter; left time: 704.5441s
Epoch: 7 cost time: 9.575359106063843
Epoch: 7, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.157 Vali Acc: 0.363 Test Loss: 2.157 Test Acc: 0.363
Validation loss decreased (-0.345478 --> -0.362914).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4339675
	speed: 0.2218s/iter; left time: 763.5983s
Epoch: 8 cost time: 8.473449945449829
Epoch: 8, Steps: 154 | Train Loss: 1.577 Vali Loss: 2.511 Vali Acc: 0.204 Test Loss: 2.511 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6143805
	speed: 0.1992s/iter; left time: 655.0162s
Epoch: 9 cost time: 10.146140098571777
Epoch: 9, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.024 Vali Acc: 0.375 Test Loss: 2.024 Test Acc: 0.375
Validation loss decreased (-0.362914 --> -0.375081).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8119689
	speed: 0.2156s/iter; left time: 675.9525s
Epoch: 10 cost time: 8.321855783462524
Epoch: 10, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.161 Vali Acc: 0.407 Test Loss: 2.161 Test Acc: 0.407
Validation loss decreased (-0.375081 --> -0.406710).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4432052
	speed: 0.2302s/iter; left time: 686.1163s
Epoch: 11 cost time: 11.494965553283691
Epoch: 11, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.178 Vali Acc: 0.377 Test Loss: 2.178 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2817644
	speed: 0.2514s/iter; left time: 710.5908s
Epoch: 12 cost time: 10.054200410842896
Epoch: 12, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.473 Vali Acc: 0.212 Test Loss: 2.473 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5309138
	speed: 0.2392s/iter; left time: 639.4475s
Epoch: 13 cost time: 11.394251823425293
Epoch: 13, Steps: 154 | Train Loss: 1.369 Vali Loss: 3.110 Vali Acc: 0.393 Test Loss: 3.110 Test Acc: 0.393
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1102030
	speed: 0.2478s/iter; left time: 624.0840s
Epoch: 14 cost time: 9.348411321640015
Epoch: 14, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.910 Vali Acc: 0.107 Test Loss: 2.910 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1353337
	speed: 0.2293s/iter; left time: 542.2616s
Epoch: 15 cost time: 10.797415971755981
Epoch: 15, Steps: 154 | Train Loss: 1.304 Vali Loss: 3.643 Vali Acc: 0.140 Test Loss: 3.643 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5556825
	speed: 0.2487s/iter; left time: 549.8506s
Epoch: 16 cost time: 9.780781030654907
Epoch: 16, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.267 Vali Acc: 0.388 Test Loss: 3.267 Test Acc: 0.388
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5628062
	speed: 0.2370s/iter; left time: 487.5005s
Epoch: 17 cost time: 10.705378770828247
Epoch: 17, Steps: 154 | Train Loss: 1.271 Vali Loss: 3.700 Vali Acc: 0.276 Test Loss: 3.700 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.4805993
	speed: 0.2342s/iter; left time: 445.7611s
Epoch: 18 cost time: 7.997695684432983
Epoch: 18, Steps: 154 | Train Loss: 1.245 Vali Loss: 4.330 Vali Acc: 0.193 Test Loss: 4.330 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1169125
	speed: 0.2009s/iter; left time: 351.4165s
Epoch: 19 cost time: 9.316972494125366
Epoch: 19, Steps: 154 | Train Loss: 1.209 Vali Loss: 4.584 Vali Acc: 0.104 Test Loss: 4.584 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0716043
	speed: 0.2028s/iter; left time: 323.4806s
Epoch: 20 cost time: 8.066099882125854
Epoch: 20, Steps: 154 | Train Loss: 1.239 Vali Loss: 3.364 Vali Acc: 0.206 Test Loss: 3.364 Test Acc: 0.206
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4067315490673155
model parameter : 267086
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1344860
	speed: 0.1093s/iter; left time: 494.2558s
Epoch: 1 cost time: 15.98071002960205
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.126 Vali Acc: 0.320 Test Loss: 2.126 Test Acc: 0.320
Validation loss decreased (inf --> -0.319525).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8801076
	speed: 0.3142s/iter; left time: 1371.9821s
Epoch: 2 cost time: 15.730575561523438
Epoch: 2, Steps: 154 | Train Loss: 2.014 Vali Loss: 2.124 Vali Acc: 0.330 Test Loss: 2.124 Test Acc: 0.330
Validation loss decreased (-0.319525 --> -0.329662).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8647442
	speed: 0.3015s/iter; left time: 1270.0276s
Epoch: 3 cost time: 16.654436349868774
Epoch: 3, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.046 Vali Acc: 0.346 Test Loss: 2.046 Test Acc: 0.346
Validation loss decreased (-0.329662 --> -0.346289).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6780181
	speed: 0.3321s/iter; left time: 1348.1594s
Epoch: 4 cost time: 17.271071195602417
Epoch: 4, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.221 Vali Acc: 0.348 Test Loss: 2.221 Test Acc: 0.348
Validation loss decreased (-0.346289 --> -0.348315).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3382590
	speed: 0.3586s/iter; left time: 1400.4070s
Epoch: 5 cost time: 16.615150690078735
Epoch: 5, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.251 Vali Acc: 0.352 Test Loss: 2.251 Test Acc: 0.352
Validation loss decreased (-0.348315 --> -0.351965).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9592234
	speed: 0.3471s/iter; left time: 1301.7966s
Epoch: 6 cost time: 18.724156618118286
Epoch: 6, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.303 Vali Acc: 0.350 Test Loss: 2.303 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6067424
	speed: 0.3340s/iter; left time: 1201.3129s
Epoch: 7 cost time: 16.56000018119812
Epoch: 7, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.115 Vali Acc: 0.366 Test Loss: 2.115 Test Acc: 0.366
Validation loss decreased (-0.351965 --> -0.365753).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6403737
	speed: 0.3462s/iter; left time: 1191.9424s
Epoch: 8 cost time: 15.630836725234985
Epoch: 8, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.387 Vali Acc: 0.355 Test Loss: 2.387 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4309226
	speed: 0.3440s/iter; left time: 1131.5061s
Epoch: 9 cost time: 17.430261611938477
Epoch: 9, Steps: 154 | Train Loss: 1.441 Vali Loss: 2.288 Vali Acc: 0.366 Test Loss: 2.288 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2145358
	speed: 0.2915s/iter; left time: 913.9746s
Epoch: 10 cost time: 14.93137788772583
Epoch: 10, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.528 Vali Acc: 0.099 Test Loss: 2.528 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3982201
	speed: 0.3047s/iter; left time: 908.2665s
Epoch: 11 cost time: 14.240488290786743
Epoch: 11, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.262 Vali Acc: 0.310 Test Loss: 2.262 Test Acc: 0.310
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2363999
	speed: 0.3017s/iter; left time: 852.9971s
Epoch: 12 cost time: 14.619547367095947
Epoch: 12, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.443 Vali Acc: 0.368 Test Loss: 2.443 Test Acc: 0.368
Validation loss decreased (-0.365753 --> -0.367778).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5110000
	speed: 0.2894s/iter; left time: 773.6728s
Epoch: 13 cost time: 16.209207773208618
Epoch: 13, Steps: 154 | Train Loss: 1.283 Vali Loss: 2.321 Vali Acc: 0.259 Test Loss: 2.321 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.3855449
	speed: 0.2995s/iter; left time: 754.5583s
Epoch: 14 cost time: 13.887063264846802
Epoch: 14, Steps: 154 | Train Loss: 1.279 Vali Loss: 2.968 Vali Acc: 0.263 Test Loss: 2.968 Test Acc: 0.263
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.7093103
	speed: 0.3158s/iter; left time: 746.7917s
Epoch: 15 cost time: 16.15630340576172
Epoch: 15, Steps: 154 | Train Loss: 1.258 Vali Loss: 2.255 Vali Acc: 0.391 Test Loss: 2.255 Test Acc: 0.391
Validation loss decreased (-0.367778 --> -0.390894).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.9796954
	speed: 0.3450s/iter; left time: 762.7095s
Epoch: 16 cost time: 17.73532772064209
Epoch: 16, Steps: 154 | Train Loss: 1.216 Vali Loss: 3.197 Vali Acc: 0.124 Test Loss: 3.197 Test Acc: 0.124
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.6850426
	speed: 0.3301s/iter; left time: 679.0000s
Epoch: 17 cost time: 17.04473900794983
Epoch: 17, Steps: 154 | Train Loss: 1.209 Vali Loss: 2.673 Vali Acc: 0.384 Test Loss: 2.673 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.7285057
	speed: 0.3465s/iter; left time: 659.3899s
Epoch: 18 cost time: 16.136544466018677
Epoch: 18, Steps: 154 | Train Loss: 1.163 Vali Loss: 2.334 Vali Acc: 0.396 Test Loss: 2.334 Test Acc: 0.396
Validation loss decreased (-0.390894 --> -0.396165).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.0976473
	speed: 0.3445s/iter; left time: 602.4555s
Epoch: 19 cost time: 16.631960153579712
Epoch: 19, Steps: 154 | Train Loss: 1.132 Vali Loss: 2.972 Vali Acc: 0.244 Test Loss: 2.972 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.7448062
	speed: 0.3212s/iter; left time: 512.2630s
Epoch: 20 cost time: 16.59621000289917
Epoch: 20, Steps: 154 | Train Loss: 1.113 Vali Loss: 2.550 Vali Acc: 0.415 Test Loss: 2.550 Test Acc: 0.415
Validation loss decreased (-0.396165 --> -0.414816).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.1276594
	speed: 0.3140s/iter; left time: 452.4403s
Epoch: 21 cost time: 13.419618368148804
Epoch: 21, Steps: 154 | Train Loss: 1.096 Vali Loss: 2.176 Vali Acc: 0.381 Test Loss: 2.176 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.4238505
	speed: 0.3001s/iter; left time: 386.2892s
Epoch: 22 cost time: 14.599897861480713
Epoch: 22, Steps: 154 | Train Loss: 1.093 Vali Loss: 2.282 Vali Acc: 0.380 Test Loss: 2.282 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.9293434
	speed: 0.2946s/iter; left time: 333.7351s
Epoch: 23 cost time: 16.029408931732178
Epoch: 23, Steps: 154 | Train Loss: 1.055 Vali Loss: 3.176 Vali Acc: 0.142 Test Loss: 3.176 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.9236416
	speed: 0.2837s/iter; left time: 277.7045s
Epoch: 24 cost time: 13.64819884300232
Epoch: 24, Steps: 154 | Train Loss: 1.027 Vali Loss: 2.733 Vali Acc: 0.138 Test Loss: 2.733 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.1625034
	speed: 0.2437s/iter; left time: 201.0888s
Epoch: 25 cost time: 12.277484655380249
Epoch: 25, Steps: 154 | Train Loss: 1.009 Vali Loss: 2.444 Vali Acc: 0.215 Test Loss: 2.444 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.2240473
	speed: 0.2702s/iter; left time: 181.2902s
Epoch: 26 cost time: 14.499130964279175
Epoch: 26, Steps: 154 | Train Loss: 0.964 Vali Loss: 2.425 Vali Acc: 0.364 Test Loss: 2.425 Test Acc: 0.364
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.0065877
	speed: 0.3150s/iter; left time: 162.8493s
Epoch: 27 cost time: 15.203233480453491
Epoch: 27, Steps: 154 | Train Loss: 0.949 Vali Loss: 2.453 Vali Acc: 0.404 Test Loss: 2.453 Test Acc: 0.404
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.9128894
	speed: 0.3127s/iter; left time: 113.4966s
Epoch: 28 cost time: 15.219645977020264
Epoch: 28, Steps: 154 | Train Loss: 0.952 Vali Loss: 2.510 Vali Acc: 0.399 Test Loss: 2.510 Test Acc: 0.399
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.0889977
	speed: 0.3123s/iter; left time: 65.2702s
Epoch: 29 cost time: 15.2544527053833
Epoch: 29, Steps: 154 | Train Loss: 0.905 Vali Loss: 2.543 Vali Acc: 0.377 Test Loss: 2.543 Test Acc: 0.377
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.7293407
	speed: 0.3107s/iter; left time: 17.0877s
Epoch: 30 cost time: 15.154179334640503
Epoch: 30, Steps: 154 | Train Loss: 0.921 Vali Loss: 2.402 Vali Acc: 0.379 Test Loss: 2.402 Test Acc: 0.379
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4148418491484185
model parameter : 448334
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2767134
	speed: 0.0891s/iter; left time: 402.9592s
Epoch: 1 cost time: 12.672723770141602
Epoch: 1, Steps: 154 | Train Loss: 2.182 Vali Loss: 2.105 Vali Acc: 0.318 Test Loss: 2.105 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9169683
	speed: 0.2333s/iter; left time: 1019.0168s
Epoch: 2 cost time: 11.079551696777344
Epoch: 2, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.150 Vali Acc: 0.330 Test Loss: 2.150 Test Acc: 0.330
Validation loss decreased (-0.318308 --> -0.330473).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7209815
	speed: 0.2297s/iter; left time: 967.7338s
Epoch: 3 cost time: 10.703908443450928
Epoch: 3, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.135 Vali Acc: 0.341 Test Loss: 2.135 Test Acc: 0.341
Validation loss decreased (-0.330473 --> -0.341422).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4810332
	speed: 0.2272s/iter; left time: 922.1510s
Epoch: 4 cost time: 10.889972448348999
Epoch: 4, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.168 Vali Acc: 0.354 Test Loss: 2.168 Test Acc: 0.354
Validation loss decreased (-0.341422 --> -0.353587).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5587475
	speed: 0.2322s/iter; left time: 906.8679s
Epoch: 5 cost time: 10.722124338150024
Epoch: 5, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.250 Vali Acc: 0.191 Test Loss: 2.250 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1444721
	speed: 0.2255s/iter; left time: 845.8503s
Epoch: 6 cost time: 10.638948440551758
Epoch: 6, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.421 Vali Acc: 0.197 Test Loss: 2.421 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5036405
	speed: 0.2364s/iter; left time: 850.3654s
Epoch: 7 cost time: 12.517925024032593
Epoch: 7, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.708 Vali Acc: 0.088 Test Loss: 2.708 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.1651825
	speed: 0.2601s/iter; left time: 895.6584s
Epoch: 8 cost time: 12.209742546081543
Epoch: 8, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.518 Vali Acc: 0.198 Test Loss: 2.518 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.4114976
	speed: 0.2691s/iter; left time: 885.0124s
Epoch: 9 cost time: 13.1304612159729
Epoch: 9, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.217 Vali Acc: 0.079 Test Loss: 3.217 Test Acc: 0.079
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.3719467
	speed: 0.2594s/iter; left time: 813.2977s
Epoch: 10 cost time: 12.454857349395752
Epoch: 10, Steps: 154 | Train Loss: 1.403 Vali Loss: 5.047 Vali Acc: 0.094 Test Loss: 5.047 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3151175
	speed: 0.2557s/iter; left time: 762.2111s
Epoch: 11 cost time: 13.007030010223389
Epoch: 11, Steps: 154 | Train Loss: 1.384 Vali Loss: 4.309 Vali Acc: 0.102 Test Loss: 4.309 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2839658
	speed: 0.2581s/iter; left time: 729.5661s
Epoch: 12 cost time: 12.875610828399658
Epoch: 12, Steps: 154 | Train Loss: 1.336 Vali Loss: 2.937 Vali Acc: 0.129 Test Loss: 2.937 Test Acc: 0.129
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.9661230
	speed: 0.2380s/iter; left time: 636.1387s
Epoch: 13 cost time: 11.336515665054321
Epoch: 13, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.830 Vali Acc: 0.084 Test Loss: 3.830 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.5472510
	speed: 0.2313s/iter; left time: 582.6830s
Epoch: 14 cost time: 11.40376353263855
Epoch: 14, Steps: 154 | Train Loss: 1.295 Vali Loss: 5.255 Vali Acc: 0.094 Test Loss: 5.255 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35360908353609083
model parameter : 137870
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1692092
	speed: 0.0955s/iter; left time: 431.9147s
Epoch: 1 cost time: 13.604186296463013
Epoch: 1, Steps: 154 | Train Loss: 2.220 Vali Loss: 2.126 Vali Acc: 0.319 Test Loss: 2.126 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8794327
	speed: 0.2316s/iter; left time: 1011.5918s
Epoch: 2 cost time: 12.035311937332153
Epoch: 2, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.122 Vali Acc: 0.327 Test Loss: 2.122 Test Acc: 0.327
Validation loss decreased (-0.319119 --> -0.326824).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0133488
	speed: 0.2405s/iter; left time: 1013.4364s
Epoch: 3 cost time: 12.28096890449524
Epoch: 3, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.029 Vali Acc: 0.349 Test Loss: 2.029 Test Acc: 0.349
Validation loss decreased (-0.326824 --> -0.348723).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7183273
	speed: 0.2497s/iter; left time: 1013.7163s
Epoch: 4 cost time: 13.8676917552948
Epoch: 4, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.099 Vali Acc: 0.349 Test Loss: 2.099 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.0693250
	speed: 0.2643s/iter; left time: 1031.9123s
Epoch: 5 cost time: 13.914469957351685
Epoch: 5, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.256 Vali Acc: 0.344 Test Loss: 2.256 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.9669049
	speed: 0.2659s/iter; left time: 997.2279s
Epoch: 6 cost time: 13.422157526016235
Epoch: 6, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.208 Vali Acc: 0.333 Test Loss: 2.208 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.7190477
	speed: 0.2640s/iter; left time: 949.6279s
Epoch: 7 cost time: 14.404371500015259
Epoch: 7, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.239 Vali Acc: 0.380 Test Loss: 2.239 Test Acc: 0.380
Validation loss decreased (-0.348723 --> -0.379945).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5896618
	speed: 0.2676s/iter; left time: 921.3186s
Epoch: 8 cost time: 13.759611129760742
Epoch: 8, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.331 Vali Acc: 0.362 Test Loss: 2.331 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3969097
	speed: 0.2667s/iter; left time: 877.3148s
Epoch: 9 cost time: 13.528891563415527
Epoch: 9, Steps: 154 | Train Loss: 1.432 Vali Loss: 2.305 Vali Acc: 0.378 Test Loss: 2.305 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1148932
	speed: 0.2329s/iter; left time: 730.1792s
Epoch: 10 cost time: 10.391313314437866
Epoch: 10, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.213 Vali Acc: 0.381 Test Loss: 2.213 Test Acc: 0.381
Validation loss decreased (-0.379945 --> -0.381162).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3457012
	speed: 0.2054s/iter; left time: 612.2378s
Epoch: 11 cost time: 13.79836106300354
Epoch: 11, Steps: 154 | Train Loss: 1.367 Vali Loss: 2.091 Vali Acc: 0.390 Test Loss: 2.091 Test Acc: 0.390
Validation loss decreased (-0.381162 --> -0.389679).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.2056305
	speed: 0.2916s/iter; left time: 824.2693s
Epoch: 12 cost time: 12.852253913879395
Epoch: 12, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.532 Vali Acc: 0.372 Test Loss: 2.532 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5386008
	speed: 0.2407s/iter; left time: 643.2636s
Epoch: 13 cost time: 11.903951168060303
Epoch: 13, Steps: 154 | Train Loss: 1.276 Vali Loss: 2.129 Vali Acc: 0.401 Test Loss: 2.129 Test Acc: 0.401
Validation loss decreased (-0.389679 --> -0.401033).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.4258974
	speed: 0.2827s/iter; left time: 711.9962s
Epoch: 14 cost time: 13.777178764343262
Epoch: 14, Steps: 154 | Train Loss: 1.263 Vali Loss: 2.762 Vali Acc: 0.168 Test Loss: 2.762 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6388870
	speed: 0.2577s/iter; left time: 609.4524s
Epoch: 15 cost time: 11.877831935882568
Epoch: 15, Steps: 154 | Train Loss: 1.239 Vali Loss: 2.614 Vali Acc: 0.361 Test Loss: 2.614 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0523897
	speed: 0.2685s/iter; left time: 593.5995s
Epoch: 16 cost time: 14.56533408164978
Epoch: 16, Steps: 154 | Train Loss: 1.203 Vali Loss: 3.581 Vali Acc: 0.107 Test Loss: 3.581 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.7106416
	speed: 0.2675s/iter; left time: 550.3118s
Epoch: 17 cost time: 11.516503810882568
Epoch: 17, Steps: 154 | Train Loss: 1.189 Vali Loss: 2.600 Vali Acc: 0.386 Test Loss: 2.600 Test Acc: 0.386
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.7118101
	speed: 0.2515s/iter; left time: 478.5743s
Epoch: 18 cost time: 13.300049543380737
Epoch: 18, Steps: 154 | Train Loss: 1.149 Vali Loss: 3.511 Vali Acc: 0.115 Test Loss: 3.511 Test Acc: 0.115
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.4018099
	speed: 0.2606s/iter; left time: 455.8622s
Epoch: 19 cost time: 9.935772895812988
Epoch: 19, Steps: 154 | Train Loss: 1.117 Vali Loss: 2.367 Vali Acc: 0.372 Test Loss: 2.367 Test Acc: 0.372
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.6255304
	speed: 0.2287s/iter; left time: 364.8361s
Epoch: 20 cost time: 14.7066490650177
Epoch: 20, Steps: 154 | Train Loss: 1.116 Vali Loss: 3.180 Vali Acc: 0.119 Test Loss: 3.180 Test Acc: 0.119
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.3077433
	speed: 0.3496s/iter; left time: 503.8334s
Epoch: 21 cost time: 16.046160221099854
Epoch: 21, Steps: 154 | Train Loss: 1.074 Vali Loss: 2.191 Vali Acc: 0.403 Test Loss: 2.191 Test Acc: 0.403
Validation loss decreased (-0.401033 --> -0.403466).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.5174345
	speed: 0.3127s/iter; left time: 402.4298s
Epoch: 22 cost time: 14.388022899627686
Epoch: 22, Steps: 154 | Train Loss: 1.102 Vali Loss: 2.183 Vali Acc: 0.411 Test Loss: 2.183 Test Acc: 0.411
Validation loss decreased (-0.403466 --> -0.411170).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.9285267
	speed: 0.3253s/iter; left time: 368.6209s
Epoch: 23 cost time: 16.389678478240967
Epoch: 23, Steps: 154 | Train Loss: 1.077 Vali Loss: 4.078 Vali Acc: 0.113 Test Loss: 4.078 Test Acc: 0.113
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.9341766
	speed: 0.3277s/iter; left time: 320.7780s
Epoch: 24 cost time: 14.295588254928589
Epoch: 24, Steps: 154 | Train Loss: 1.019 Vali Loss: 6.747 Vali Acc: 0.105 Test Loss: 6.747 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.0541267
	speed: 0.3009s/iter; left time: 248.2227s
Epoch: 25 cost time: 14.24644684791565
Epoch: 25, Steps: 154 | Train Loss: 1.032 Vali Loss: 4.690 Vali Acc: 0.121 Test Loss: 4.690 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.2964983
	speed: 0.3401s/iter; left time: 228.1933s
Epoch: 26 cost time: 16.169079303741455
Epoch: 26, Steps: 154 | Train Loss: 0.983 Vali Loss: 3.117 Vali Acc: 0.147 Test Loss: 3.117 Test Acc: 0.147
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.9868568
	speed: 0.3269s/iter; left time: 169.0114s
Epoch: 27 cost time: 14.984439849853516
Epoch: 27, Steps: 154 | Train Loss: 0.961 Vali Loss: 2.504 Vali Acc: 0.378 Test Loss: 2.504 Test Acc: 0.378
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.9662104
	speed: 0.3258s/iter; left time: 118.2685s
Epoch: 28 cost time: 16.50856876373291
Epoch: 28, Steps: 154 | Train Loss: 0.965 Vali Loss: 4.376 Vali Acc: 0.118 Test Loss: 4.376 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.8520848
	speed: 0.3334s/iter; left time: 69.6761s
Epoch: 29 cost time: 14.369318962097168
Epoch: 29, Steps: 154 | Train Loss: 0.941 Vali Loss: 3.077 Vali Acc: 0.342 Test Loss: 3.077 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.6305248
	speed: 0.2769s/iter; left time: 15.2292s
Epoch: 30 cost time: 14.052882432937622
Epoch: 30, Steps: 154 | Train Loss: 0.919 Vali Loss: 4.166 Vali Acc: 0.140 Test Loss: 4.166 Test Acc: 0.140
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41119221411192214
model parameter : 448334
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2882252
	speed: 0.0851s/iter; left time: 384.8227s
Epoch: 1 cost time: 12.54240870475769
Epoch: 1, Steps: 154 | Train Loss: 2.185 Vali Loss: 2.107 Vali Acc: 0.318 Test Loss: 2.107 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9447551
	speed: 0.2666s/iter; left time: 1164.3452s
Epoch: 2 cost time: 12.604665279388428
Epoch: 2, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.134 Vali Acc: 0.324 Test Loss: 2.134 Test Acc: 0.324
Validation loss decreased (-0.317497 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7177551
	speed: 0.2650s/iter; left time: 1116.3966s
Epoch: 3 cost time: 11.42782998085022
Epoch: 3, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.132 Vali Acc: 0.341 Test Loss: 2.132 Test Acc: 0.341
Validation loss decreased (-0.324391 --> -0.341017).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4538219
	speed: 0.2440s/iter; left time: 990.3151s
Epoch: 4 cost time: 11.308303594589233
Epoch: 4, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.225 Vali Acc: 0.349 Test Loss: 2.225 Test Acc: 0.349
Validation loss decreased (-0.341017 --> -0.348721).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6690172
	speed: 0.2699s/iter; left time: 1054.0449s
Epoch: 5 cost time: 12.19900894165039
Epoch: 5, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.361 Vali Acc: 0.356 Test Loss: 2.361 Test Acc: 0.356
Validation loss decreased (-0.348721 --> -0.355613).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2733039
	speed: 0.2576s/iter; left time: 966.4091s
Epoch: 6 cost time: 11.085518598556519
Epoch: 6, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.266 Vali Acc: 0.352 Test Loss: 2.266 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5326608
	speed: 0.2643s/iter; left time: 950.5188s
Epoch: 7 cost time: 13.883240938186646
Epoch: 7, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.256 Vali Acc: 0.363 Test Loss: 2.256 Test Acc: 0.363
Validation loss decreased (-0.355613 --> -0.363319).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3119016
	speed: 0.3185s/iter; left time: 1096.5924s
Epoch: 8 cost time: 13.358214378356934
Epoch: 8, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.694 Vali Acc: 0.258 Test Loss: 2.694 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4266846
	speed: 0.2766s/iter; left time: 909.8987s
Epoch: 9 cost time: 12.665270805358887
Epoch: 9, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.921 Vali Acc: 0.063 Test Loss: 2.921 Test Acc: 0.063
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3355277
	speed: 0.3041s/iter; left time: 953.3920s
Epoch: 10 cost time: 14.00088906288147
Epoch: 10, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.355 Vali Acc: 0.189 Test Loss: 2.355 Test Acc: 0.189
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3579105
	speed: 0.2970s/iter; left time: 885.3640s
Epoch: 11 cost time: 12.840262651443481
Epoch: 11, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.617 Vali Acc: 0.097 Test Loss: 2.617 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2983561
	speed: 0.2773s/iter; left time: 784.0083s
Epoch: 12 cost time: 12.468839645385742
Epoch: 12, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.687 Vali Acc: 0.215 Test Loss: 2.687 Test Acc: 0.215
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.8791704
	speed: 0.2448s/iter; left time: 654.4068s
Epoch: 13 cost time: 11.16391897201538
Epoch: 13, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.846 Vali Acc: 0.090 Test Loss: 3.846 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.5192518
	speed: 0.2804s/iter; left time: 706.2798s
Epoch: 14 cost time: 11.888955354690552
Epoch: 14, Steps: 154 | Train Loss: 1.315 Vali Loss: 4.364 Vali Acc: 0.090 Test Loss: 4.364 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.3179169
	speed: 0.2678s/iter; left time: 633.3674s
Epoch: 15 cost time: 13.368921756744385
Epoch: 15, Steps: 154 | Train Loss: 1.273 Vali Loss: 3.286 Vali Acc: 0.168 Test Loss: 3.286 Test Acc: 0.168
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.9157129
	speed: 0.2681s/iter; left time: 592.7071s
Epoch: 16 cost time: 11.756946086883545
Epoch: 16, Steps: 154 | Train Loss: 1.249 Vali Loss: 3.587 Vali Acc: 0.126 Test Loss: 3.587 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1745557
	speed: 0.2481s/iter; left time: 510.3079s
Epoch: 17 cost time: 11.116281747817993
Epoch: 17, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.759 Vali Acc: 0.109 Test Loss: 3.759 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3633414436334144
model parameter : 137870
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1733072
	speed: 0.0880s/iter; left time: 397.6985s
Epoch: 1 cost time: 12.399147510528564
Epoch: 1, Steps: 154 | Train Loss: 2.221 Vali Loss: 2.116 Vali Acc: 0.319 Test Loss: 2.116 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8889608
	speed: 0.2325s/iter; left time: 1015.2181s
Epoch: 2 cost time: 13.804455041885376
Epoch: 2, Steps: 154 | Train Loss: 2.027 Vali Loss: 2.103 Vali Acc: 0.327 Test Loss: 2.103 Test Acc: 0.327
Validation loss decreased (-0.319119 --> -0.327230).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9887053
	speed: 0.2327s/iter; left time: 980.1754s
Epoch: 3 cost time: 10.480632066726685
Epoch: 3, Steps: 154 | Train Loss: 1.925 Vali Loss: 2.043 Vali Acc: 0.270 Test Loss: 2.043 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7720021
	speed: 0.2504s/iter; left time: 1016.4673s
Epoch: 4 cost time: 11.75450086593628
Epoch: 4, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.123 Vali Acc: 0.344 Test Loss: 2.123 Test Acc: 0.344
Validation loss decreased (-0.327230 --> -0.344261).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1645834
	speed: 0.2243s/iter; left time: 876.0445s
Epoch: 5 cost time: 12.652737855911255
Epoch: 5, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.286 Vali Acc: 0.342 Test Loss: 2.286 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9426779
	speed: 0.2313s/iter; left time: 867.7117s
Epoch: 6 cost time: 9.786741495132446
Epoch: 6, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.382 Vali Acc: 0.337 Test Loss: 2.382 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7215015
	speed: 0.2501s/iter; left time: 899.7498s
Epoch: 7 cost time: 14.681227684020996
Epoch: 7, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.229 Vali Acc: 0.213 Test Loss: 2.229 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.8399295
	speed: 0.2651s/iter; left time: 912.7447s
Epoch: 8 cost time: 13.744806289672852
Epoch: 8, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.275 Vali Acc: 0.367 Test Loss: 2.275 Test Acc: 0.367
Validation loss decreased (-0.344261 --> -0.366563).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6205771
	speed: 0.2868s/iter; left time: 943.2158s
Epoch: 9 cost time: 12.472833395004272
Epoch: 9, Steps: 154 | Train Loss: 1.475 Vali Loss: 2.898 Vali Acc: 0.198 Test Loss: 2.898 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2555001
	speed: 0.2728s/iter; left time: 855.3726s
Epoch: 10 cost time: 13.649665594100952
Epoch: 10, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.991 Vali Acc: 0.205 Test Loss: 2.991 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5347445
	speed: 0.2552s/iter; left time: 760.6673s
Epoch: 11 cost time: 11.850610494613647
Epoch: 11, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.403 Vali Acc: 0.387 Test Loss: 2.403 Test Acc: 0.387
Validation loss decreased (-0.366563 --> -0.386837).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1261251
	speed: 0.2840s/iter; left time: 802.9148s
Epoch: 12 cost time: 12.658041000366211
Epoch: 12, Steps: 154 | Train Loss: 1.383 Vali Loss: 2.660 Vali Acc: 0.373 Test Loss: 2.660 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5112749
	speed: 0.2588s/iter; left time: 691.7567s
Epoch: 13 cost time: 13.25339961051941
Epoch: 13, Steps: 154 | Train Loss: 1.343 Vali Loss: 2.527 Vali Acc: 0.387 Test Loss: 2.527 Test Acc: 0.387
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4389894
	speed: 0.2723s/iter; left time: 685.9919s
Epoch: 14 cost time: 11.505046367645264
Epoch: 14, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.537 Vali Acc: 0.390 Test Loss: 2.537 Test Acc: 0.390
Validation loss decreased (-0.386837 --> -0.389675).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7545922
	speed: 0.2732s/iter; left time: 646.0209s
Epoch: 15 cost time: 13.27591347694397
Epoch: 15, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.948 Vali Acc: 0.382 Test Loss: 2.948 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2401824
	speed: 0.2373s/iter; left time: 524.7257s
Epoch: 16 cost time: 9.8516845703125
Epoch: 16, Steps: 154 | Train Loss: 1.292 Vali Loss: 2.571 Vali Acc: 0.388 Test Loss: 2.571 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.8264128
	speed: 0.2396s/iter; left time: 492.8981s
Epoch: 17 cost time: 9.910547971725464
Epoch: 17, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.527 Vali Acc: 0.108 Test Loss: 3.527 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.7596714
	speed: 0.2235s/iter; left time: 425.2622s
Epoch: 18 cost time: 11.308240413665771
Epoch: 18, Steps: 154 | Train Loss: 1.249 Vali Loss: 2.456 Vali Acc: 0.404 Test Loss: 2.456 Test Acc: 0.404
Validation loss decreased (-0.389675 --> -0.403868).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.1104026
	speed: 0.2227s/iter; left time: 389.5040s
Epoch: 19 cost time: 9.450130701065063
Epoch: 19, Steps: 154 | Train Loss: 1.223 Vali Loss: 2.852 Vali Acc: 0.284 Test Loss: 2.852 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.8093276
	speed: 0.2347s/iter; left time: 374.3211s
Epoch: 20 cost time: 10.479563236236572
Epoch: 20, Steps: 154 | Train Loss: 1.218 Vali Loss: 2.820 Vali Acc: 0.412 Test Loss: 2.820 Test Acc: 0.412
Validation loss decreased (-0.403868 --> -0.411975).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.1869868
	speed: 0.2094s/iter; left time: 301.6836s
Epoch: 21 cost time: 10.523073434829712
Epoch: 21, Steps: 154 | Train Loss: 1.181 Vali Loss: 2.707 Vali Acc: 0.399 Test Loss: 2.707 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.6518919
	speed: 0.2406s/iter; left time: 309.6381s
Epoch: 22 cost time: 9.451086282730103
Epoch: 22, Steps: 154 | Train Loss: 1.211 Vali Loss: 2.537 Vali Acc: 0.410 Test Loss: 2.537 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.2185597
	speed: 0.2201s/iter; left time: 249.3804s
Epoch: 23 cost time: 11.078824043273926
Epoch: 23, Steps: 154 | Train Loss: 1.182 Vali Loss: 2.974 Vali Acc: 0.375 Test Loss: 2.974 Test Acc: 0.375
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.0399740
	speed: 0.2164s/iter; left time: 211.8558s
Epoch: 24 cost time: 9.521624326705933
Epoch: 24, Steps: 154 | Train Loss: 1.141 Vali Loss: 2.982 Vali Acc: 0.263 Test Loss: 2.982 Test Acc: 0.263
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.2764012
	speed: 0.2688s/iter; left time: 221.7833s
Epoch: 25 cost time: 12.220360040664673
Epoch: 25, Steps: 154 | Train Loss: 1.173 Vali Loss: 3.035 Vali Acc: 0.379 Test Loss: 3.035 Test Acc: 0.379
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.4412464
	speed: 0.2467s/iter; left time: 165.5393s
Epoch: 26 cost time: 11.931877851486206
Epoch: 26, Steps: 154 | Train Loss: 1.107 Vali Loss: 3.082 Vali Acc: 0.390 Test Loss: 3.082 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.0616883
	speed: 0.2730s/iter; left time: 141.1322s
Epoch: 27 cost time: 11.194298028945923
Epoch: 27, Steps: 154 | Train Loss: 1.084 Vali Loss: 2.838 Vali Acc: 0.382 Test Loss: 2.838 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.9999439
	speed: 0.2613s/iter; left time: 94.8465s
Epoch: 28 cost time: 13.02798867225647
Epoch: 28, Steps: 154 | Train Loss: 1.092 Vali Loss: 2.802 Vali Acc: 0.422 Test Loss: 2.802 Test Acc: 0.422
Validation loss decreased (-0.411975 --> -0.421708).  Saving model ...
	iters: 100, epoch: 29 | loss: 1.1022270
	speed: 0.2563s/iter; left time: 53.5738s
Epoch: 29 cost time: 10.976788759231567
Epoch: 29, Steps: 154 | Train Loss: 1.080 Vali Loss: 2.975 Vali Acc: 0.410 Test Loss: 2.975 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.8023425
	speed: 0.2725s/iter; left time: 14.9866s
Epoch: 30 cost time: 12.162779808044434
Epoch: 30, Steps: 154 | Train Loss: 1.047 Vali Loss: 2.751 Vali Acc: 0.376 Test Loss: 2.751 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.42173560421735606
model parameter : 448334
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2883077
	speed: 0.0870s/iter; left time: 393.4085s
Epoch: 1 cost time: 12.804835557937622
Epoch: 1, Steps: 154 | Train Loss: 2.188 Vali Loss: 2.108 Vali Acc: 0.316 Test Loss: 2.108 Test Acc: 0.316
Validation loss decreased (inf --> -0.316281).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9663864
	speed: 0.2312s/iter; left time: 1009.7534s
Epoch: 2 cost time: 9.904370784759521
Epoch: 2, Steps: 154 | Train Loss: 2.015 Vali Loss: 2.145 Vali Acc: 0.325 Test Loss: 2.145 Test Acc: 0.325
Validation loss decreased (-0.316281 --> -0.325202).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7430319
	speed: 0.2602s/iter; left time: 1096.0162s
Epoch: 3 cost time: 10.984933376312256
Epoch: 3, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.127 Vali Acc: 0.335 Test Loss: 2.127 Test Acc: 0.335
Validation loss decreased (-0.325202 --> -0.335340).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6208780
	speed: 0.2036s/iter; left time: 826.5004s
Epoch: 4 cost time: 9.61568832397461
Epoch: 4, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.141 Vali Acc: 0.346 Test Loss: 2.141 Test Acc: 0.346
Validation loss decreased (-0.335340 --> -0.345883).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7900442
	speed: 0.2161s/iter; left time: 843.9001s
Epoch: 5 cost time: 8.081133842468262
Epoch: 5, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.324 Vali Acc: 0.350 Test Loss: 2.324 Test Acc: 0.350
Validation loss decreased (-0.345883 --> -0.350342).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3543757
	speed: 0.2020s/iter; left time: 757.5980s
Epoch: 6 cost time: 10.286291122436523
Epoch: 6, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.287 Vali Acc: 0.350 Test Loss: 2.287 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6302034
	speed: 0.2068s/iter; left time: 743.6931s
Epoch: 7 cost time: 8.270862340927124
Epoch: 7, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.380 Vali Acc: 0.355 Test Loss: 2.380 Test Acc: 0.355
Validation loss decreased (-0.350342 --> -0.354802).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3667823
	speed: 0.2113s/iter; left time: 727.5442s
Epoch: 8 cost time: 10.011102676391602
Epoch: 8, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.390 Vali Acc: 0.382 Test Loss: 2.390 Test Acc: 0.382
Validation loss decreased (-0.354802 --> -0.382377).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4962726
	speed: 0.1965s/iter; left time: 646.2670s
Epoch: 9 cost time: 8.265835046768188
Epoch: 9, Steps: 154 | Train Loss: 1.519 Vali Loss: 3.093 Vali Acc: 0.060 Test Loss: 3.093 Test Acc: 0.060
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3881128
	speed: 0.2219s/iter; left time: 695.6015s
Epoch: 10 cost time: 9.20319414138794
Epoch: 10, Steps: 154 | Train Loss: 1.500 Vali Loss: 3.051 Vali Acc: 0.106 Test Loss: 3.051 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2908115
	speed: 0.1854s/iter; left time: 552.5866s
Epoch: 11 cost time: 8.135460138320923
Epoch: 11, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.524 Vali Acc: 0.215 Test Loss: 2.524 Test Acc: 0.215
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.4217300
	speed: 0.1693s/iter; left time: 478.4761s
Epoch: 12 cost time: 6.724992990493774
Epoch: 12, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.867 Vali Acc: 0.196 Test Loss: 2.867 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0089759
	speed: 0.2577s/iter; left time: 688.9456s
Epoch: 13 cost time: 11.754536151885986
Epoch: 13, Steps: 154 | Train Loss: 1.400 Vali Loss: 4.244 Vali Acc: 0.082 Test Loss: 4.244 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.3941114
	speed: 0.2482s/iter; left time: 625.0987s
Epoch: 14 cost time: 10.118746519088745
Epoch: 14, Steps: 154 | Train Loss: 1.391 Vali Loss: 3.956 Vali Acc: 0.092 Test Loss: 3.956 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.3331492
	speed: 0.2629s/iter; left time: 621.6512s
Epoch: 15 cost time: 11.615755558013916
Epoch: 15, Steps: 154 | Train Loss: 1.372 Vali Loss: 4.507 Vali Acc: 0.063 Test Loss: 4.507 Test Acc: 0.063
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.9840441
	speed: 0.2557s/iter; left time: 565.3376s
Epoch: 16 cost time: 10.193429946899414
Epoch: 16, Steps: 154 | Train Loss: 1.334 Vali Loss: 3.245 Vali Acc: 0.153 Test Loss: 3.245 Test Acc: 0.153
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.3137218
	speed: 0.2548s/iter; left time: 524.1494s
Epoch: 17 cost time: 11.586135387420654
Epoch: 17, Steps: 154 | Train Loss: 1.316 Vali Loss: 5.287 Vali Acc: 0.071 Test Loss: 5.287 Test Acc: 0.071
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.0081576
	speed: 0.2627s/iter; left time: 499.8900s
Epoch: 18 cost time: 10.145139217376709
Epoch: 18, Steps: 154 | Train Loss: 1.271 Vali Loss: 5.639 Vali Acc: 0.077 Test Loss: 5.639 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3824006488240065
model parameter : 137870
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7491407
	speed: 0.1671s/iter; left time: 755.2927s
Epoch: 1 cost time: 24.23674178123474
Epoch: 1, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.128 Vali Acc: 0.315 Test Loss: 2.128 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8801365
	speed: 0.4193s/iter; left time: 1830.8703s
Epoch: 2 cost time: 23.138263702392578
Epoch: 2, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.093 Vali Acc: 0.322 Test Loss: 2.093 Test Acc: 0.322
Validation loss decreased (-0.315064 --> -0.321958).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9508605
	speed: 0.4046s/iter; left time: 1704.7343s
Epoch: 3 cost time: 18.045759201049805
Epoch: 3, Steps: 154 | Train Loss: 1.998 Vali Loss: 2.091 Vali Acc: 0.326 Test Loss: 2.091 Test Acc: 0.326
Validation loss decreased (-0.321958 --> -0.326013).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8615729
	speed: 0.3766s/iter; left time: 1528.7728s
Epoch: 4 cost time: 19.03535032272339
Epoch: 4, Steps: 154 | Train Loss: 1.933 Vali Loss: 2.122 Vali Acc: 0.326 Test Loss: 2.122 Test Acc: 0.326
Validation loss decreased (-0.326013 --> -0.326418).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6691900
	speed: 0.3568s/iter; left time: 1393.3035s
Epoch: 5 cost time: 19.697147846221924
Epoch: 5, Steps: 154 | Train Loss: 1.873 Vali Loss: 2.059 Vali Acc: 0.335 Test Loss: 2.059 Test Acc: 0.335
Validation loss decreased (-0.326418 --> -0.334529).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1445982
	speed: 0.3598s/iter; left time: 1349.6217s
Epoch: 6 cost time: 17.134321212768555
Epoch: 6, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.081 Vali Acc: 0.341 Test Loss: 2.081 Test Acc: 0.341
Validation loss decreased (-0.334529 --> -0.341017).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9227926
	speed: 0.3711s/iter; left time: 1334.8961s
Epoch: 7 cost time: 18.622335195541382
Epoch: 7, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.076 Vali Acc: 0.345 Test Loss: 2.076 Test Acc: 0.345
Validation loss decreased (-0.341017 --> -0.344667).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9397447
	speed: 0.3529s/iter; left time: 1215.1787s
Epoch: 8 cost time: 18.729814052581787
Epoch: 8, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.070 Vali Acc: 0.340 Test Loss: 2.070 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.1799650
	speed: 0.3561s/iter; left time: 1171.2122s
Epoch: 9 cost time: 16.480269193649292
Epoch: 9, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.067 Vali Acc: 0.361 Test Loss: 2.067 Test Acc: 0.361
Validation loss decreased (-0.344667 --> -0.360888).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2745738
	speed: 0.3958s/iter; left time: 1240.7153s
Epoch: 10 cost time: 20.5821053981781
Epoch: 10, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.047 Vali Acc: 0.367 Test Loss: 2.047 Test Acc: 0.367
Validation loss decreased (-0.360888 --> -0.366971).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2590322
	speed: 0.3835s/iter; left time: 1143.2838s
Epoch: 11 cost time: 20.14931035041809
Epoch: 11, Steps: 154 | Train Loss: 1.586 Vali Loss: 2.245 Vali Acc: 0.347 Test Loss: 2.245 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5674732
	speed: 0.4029s/iter; left time: 1139.0613s
Epoch: 12 cost time: 18.10853123664856
Epoch: 12, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.127 Vali Acc: 0.364 Test Loss: 2.127 Test Acc: 0.364
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7574438
	speed: 0.3888s/iter; left time: 1039.1755s
Epoch: 13 cost time: 20.50308060646057
Epoch: 13, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.097 Vali Acc: 0.365 Test Loss: 2.097 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.0880692
	speed: 0.3823s/iter; left time: 963.0523s
Epoch: 14 cost time: 18.014708757400513
Epoch: 14, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.630 Vali Acc: 0.361 Test Loss: 2.630 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.0598564
	speed: 0.4076s/iter; left time: 964.0445s
Epoch: 15 cost time: 19.62322735786438
Epoch: 15, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.275 Vali Acc: 0.076 Test Loss: 3.275 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2729661
	speed: 0.3737s/iter; left time: 826.2533s
Epoch: 16 cost time: 18.915748596191406
Epoch: 16, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.057 Vali Acc: 0.076 Test Loss: 3.057 Test Acc: 0.076
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.8218516
	speed: 0.3851s/iter; left time: 792.0490s
Epoch: 17 cost time: 16.18723702430725
Epoch: 17, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.350 Vali Acc: 0.309 Test Loss: 2.350 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3438168
	speed: 0.3483s/iter; left time: 662.8899s
Epoch: 18 cost time: 17.688507556915283
Epoch: 18, Steps: 154 | Train Loss: 1.373 Vali Loss: 6.726 Vali Acc: 0.085 Test Loss: 6.726 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.6857896
	speed: 0.3360s/iter; left time: 587.6739s
Epoch: 19 cost time: 15.254159688949585
Epoch: 19, Steps: 154 | Train Loss: 1.350 Vali Loss: 4.959 Vali Acc: 0.088 Test Loss: 4.959 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.8620656
	speed: 0.2872s/iter; left time: 458.0261s
Epoch: 20 cost time: 13.339120388031006
Epoch: 20, Steps: 154 | Train Loss: 1.340 Vali Loss: 6.208 Vali Acc: 0.089 Test Loss: 6.208 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36699107866991076
model parameter : 884126
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0864112
	speed: 0.1034s/iter; left time: 467.6776s
Epoch: 1 cost time: 14.852049112319946
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.128 Vali Acc: 0.316 Test Loss: 2.128 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0242569
	speed: 0.2838s/iter; left time: 1239.2004s
Epoch: 2 cost time: 13.536763429641724
Epoch: 2, Steps: 154 | Train Loss: 2.052 Vali Loss: 2.107 Vali Acc: 0.322 Test Loss: 2.107 Test Acc: 0.322
Validation loss decreased (-0.315875 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4545004
	speed: 0.3032s/iter; left time: 1277.5546s
Epoch: 3 cost time: 16.28205394744873
Epoch: 3, Steps: 154 | Train Loss: 1.961 Vali Loss: 2.091 Vali Acc: 0.329 Test Loss: 2.091 Test Acc: 0.329
Validation loss decreased (-0.322363 --> -0.329257).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6748364
	speed: 0.3295s/iter; left time: 1337.5804s
Epoch: 4 cost time: 16.350024461746216
Epoch: 4, Steps: 154 | Train Loss: 1.899 Vali Loss: 2.124 Vali Acc: 0.334 Test Loss: 2.124 Test Acc: 0.334
Validation loss decreased (-0.329257 --> -0.334123).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8495358
	speed: 0.3255s/iter; left time: 1270.9683s
Epoch: 5 cost time: 16.398669242858887
Epoch: 5, Steps: 154 | Train Loss: 1.830 Vali Loss: 2.140 Vali Acc: 0.329 Test Loss: 2.140 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7957243
	speed: 0.3242s/iter; left time: 1215.9520s
Epoch: 6 cost time: 16.79702854156494
Epoch: 6, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.137 Vali Acc: 0.338 Test Loss: 2.137 Test Acc: 0.338
Validation loss decreased (-0.334123 --> -0.338178).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0671043
	speed: 0.3208s/iter; left time: 1153.7936s
Epoch: 7 cost time: 16.37072992324829
Epoch: 7, Steps: 154 | Train Loss: 1.736 Vali Loss: 2.817 Vali Acc: 0.053 Test Loss: 2.817 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5563626
	speed: 0.3230s/iter; left time: 1111.9367s
Epoch: 8 cost time: 15.57947564125061
Epoch: 8, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.462 Vali Acc: 0.165 Test Loss: 2.462 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9278117
	speed: 0.3223s/iter; left time: 1060.2006s
Epoch: 9 cost time: 15.591373682022095
Epoch: 9, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.527 Vali Acc: 0.121 Test Loss: 2.527 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2442348
	speed: 0.3209s/iter; left time: 1006.1306s
Epoch: 10 cost time: 15.046080589294434
Epoch: 10, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.415 Vali Acc: 0.178 Test Loss: 2.415 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4257267
	speed: 0.2918s/iter; left time: 869.9577s
Epoch: 11 cost time: 13.271459579467773
Epoch: 11, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.735 Vali Acc: 0.323 Test Loss: 2.735 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7462320
	speed: 0.2849s/iter; left time: 805.4234s
Epoch: 12 cost time: 12.848252058029175
Epoch: 12, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.828 Vali Acc: 0.079 Test Loss: 2.828 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.2672644
	speed: 0.2784s/iter; left time: 744.2015s
Epoch: 13 cost time: 12.316660165786743
Epoch: 13, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.291 Vali Acc: 0.368 Test Loss: 2.291 Test Acc: 0.368
Validation loss decreased (-0.338178 --> -0.368185).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3022256
	speed: 0.2742s/iter; left time: 690.6758s
Epoch: 14 cost time: 12.909486532211304
Epoch: 14, Steps: 154 | Train Loss: 1.461 Vali Loss: 4.816 Vali Acc: 0.116 Test Loss: 4.816 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.6898078
	speed: 0.2805s/iter; left time: 663.4377s
Epoch: 15 cost time: 12.122449398040771
Epoch: 15, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.764 Vali Acc: 0.089 Test Loss: 2.764 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5083246
	speed: 0.2807s/iter; left time: 620.6895s
Epoch: 16 cost time: 12.43192172050476
Epoch: 16, Steps: 154 | Train Loss: 1.411 Vali Loss: 2.875 Vali Acc: 0.092 Test Loss: 2.875 Test Acc: 0.092
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.8626374
	speed: 0.2808s/iter; left time: 577.6235s
Epoch: 17 cost time: 13.068318128585815
Epoch: 17, Steps: 154 | Train Loss: 1.371 Vali Loss: 4.808 Vali Acc: 0.126 Test Loss: 4.808 Test Acc: 0.126
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.1724522
	speed: 0.3181s/iter; left time: 605.3688s
Epoch: 18 cost time: 13.973772525787354
Epoch: 18, Steps: 154 | Train Loss: 1.383 Vali Loss: 4.230 Vali Acc: 0.123 Test Loss: 4.230 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.4665397
	speed: 0.2795s/iter; left time: 488.8178s
Epoch: 19 cost time: 13.184357166290283
Epoch: 19, Steps: 154 | Train Loss: 1.340 Vali Loss: 4.282 Vali Acc: 0.112 Test Loss: 4.282 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.7375854
	speed: 0.3290s/iter; left time: 524.7310s
Epoch: 20 cost time: 14.708981990814209
Epoch: 20, Steps: 154 | Train Loss: 1.301 Vali Loss: 5.055 Vali Acc: 0.128 Test Loss: 5.055 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.5148879
	speed: 0.3385s/iter; left time: 487.8456s
Epoch: 21 cost time: 14.66940426826477
Epoch: 21, Steps: 154 | Train Loss: 1.284 Vali Loss: 5.347 Vali Acc: 0.127 Test Loss: 5.347 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.0319543
	speed: 0.3316s/iter; left time: 426.7734s
Epoch: 22 cost time: 15.34158730506897
Epoch: 22, Steps: 154 | Train Loss: 1.262 Vali Loss: 7.446 Vali Acc: 0.125 Test Loss: 7.446 Test Acc: 0.125
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.3458431
	speed: 0.3226s/iter; left time: 365.4576s
Epoch: 23 cost time: 16.088486433029175
Epoch: 23, Steps: 154 | Train Loss: 1.234 Vali Loss: 5.900 Vali Acc: 0.112 Test Loss: 5.900 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3682076236820762
model parameter : 263150
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7482489
	speed: 0.1238s/iter; left time: 559.7597s
Epoch: 1 cost time: 18.304320335388184
Epoch: 1, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.128 Vali Acc: 0.315 Test Loss: 2.128 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8831245
	speed: 0.3058s/iter; left time: 1335.2380s
Epoch: 2 cost time: 14.748244047164917
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.096 Vali Acc: 0.323 Test Loss: 2.096 Test Acc: 0.323
Validation loss decreased (-0.315064 --> -0.322769).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9434199
	speed: 0.2879s/iter; left time: 1212.8150s
Epoch: 3 cost time: 15.765309810638428
Epoch: 3, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.065 Vali Acc: 0.331 Test Loss: 2.065 Test Acc: 0.331
Validation loss decreased (-0.322769 --> -0.330880).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8804233
	speed: 0.2885s/iter; left time: 1171.0068s
Epoch: 4 cost time: 15.42421817779541
Epoch: 4, Steps: 154 | Train Loss: 1.931 Vali Loss: 2.100 Vali Acc: 0.326 Test Loss: 2.100 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6980183
	speed: 0.2851s/iter; left time: 1113.1704s
Epoch: 5 cost time: 14.619304656982422
Epoch: 5, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.044 Vali Acc: 0.343 Test Loss: 2.044 Test Acc: 0.343
Validation loss decreased (-0.330880 --> -0.343045).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3953583
	speed: 0.2854s/iter; left time: 1070.4107s
Epoch: 6 cost time: 13.6406729221344
Epoch: 6, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.029 Vali Acc: 0.345 Test Loss: 2.029 Test Acc: 0.345
Validation loss decreased (-0.343045 --> -0.345073).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0059514
	speed: 0.2807s/iter; left time: 1009.5218s
Epoch: 7 cost time: 13.04080057144165
Epoch: 7, Steps: 154 | Train Loss: 1.792 Vali Loss: 2.102 Vali Acc: 0.305 Test Loss: 2.102 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8782823
	speed: 0.2928s/iter; left time: 1008.0250s
Epoch: 8 cost time: 13.05781078338623
Epoch: 8, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.085 Vali Acc: 0.350 Test Loss: 2.085 Test Acc: 0.350
Validation loss decreased (-0.345073 --> -0.349533).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.2298160
	speed: 0.3069s/iter; left time: 1009.3006s
Epoch: 9 cost time: 15.554521560668945
Epoch: 9, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.077 Vali Acc: 0.352 Test Loss: 2.077 Test Acc: 0.352
Validation loss decreased (-0.349533 --> -0.352372).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3567795
	speed: 0.3248s/iter; left time: 1018.1963s
Epoch: 10 cost time: 15.61587643623352
Epoch: 10, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.022 Vali Acc: 0.359 Test Loss: 2.022 Test Acc: 0.359
Validation loss decreased (-0.352372 --> -0.359266).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2841418
	speed: 0.3115s/iter; left time: 928.7172s
Epoch: 11 cost time: 15.94136667251587
Epoch: 11, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.192 Vali Acc: 0.370 Test Loss: 2.192 Test Acc: 0.370
Validation loss decreased (-0.359266 --> -0.369808).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6444016
	speed: 0.3077s/iter; left time: 869.9835s
Epoch: 12 cost time: 15.622262239456177
Epoch: 12, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.569 Vali Acc: 0.090 Test Loss: 2.569 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8480563
	speed: 0.3167s/iter; left time: 846.4871s
Epoch: 13 cost time: 14.461674928665161
Epoch: 13, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.106 Vali Acc: 0.371 Test Loss: 2.106 Test Acc: 0.371
Validation loss decreased (-0.369808 --> -0.371431).  Saving model ...
	iters: 100, epoch: 14 | loss: 2.2497685
	speed: 0.3109s/iter; left time: 783.1243s
Epoch: 14 cost time: 14.288147449493408
Epoch: 14, Steps: 154 | Train Loss: 1.527 Vali Loss: 2.339 Vali Acc: 0.200 Test Loss: 2.339 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.1235806
	speed: 0.3048s/iter; left time: 720.9193s
Epoch: 15 cost time: 14.912398338317871
Epoch: 15, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.761 Vali Acc: 0.085 Test Loss: 2.761 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.2810149
	speed: 0.3092s/iter; left time: 683.7270s
Epoch: 16 cost time: 15.571824789047241
Epoch: 16, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.137 Vali Acc: 0.386 Test Loss: 2.137 Test Acc: 0.386
Validation loss decreased (-0.371431 --> -0.386029).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.0235252
	speed: 0.2962s/iter; left time: 609.3191s
Epoch: 17 cost time: 12.86602783203125
Epoch: 17, Steps: 154 | Train Loss: 1.416 Vali Loss: 3.562 Vali Acc: 0.094 Test Loss: 3.562 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2853370
	speed: 0.2367s/iter; left time: 450.4410s
Epoch: 18 cost time: 12.268394947052002
Epoch: 18, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.689 Vali Acc: 0.102 Test Loss: 2.689 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.9443234
	speed: 0.2477s/iter; left time: 433.2361s
Epoch: 19 cost time: 12.098281145095825
Epoch: 19, Steps: 154 | Train Loss: 1.361 Vali Loss: 4.746 Vali Acc: 0.086 Test Loss: 4.746 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.1752137
	speed: 0.2550s/iter; left time: 406.6614s
Epoch: 20 cost time: 11.775493383407593
Epoch: 20, Steps: 154 | Train Loss: 1.363 Vali Loss: 2.554 Vali Acc: 0.124 Test Loss: 2.554 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.4165503
	speed: 0.2443s/iter; left time: 352.0131s
Epoch: 21 cost time: 11.896563053131104
Epoch: 21, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.617 Vali Acc: 0.081 Test Loss: 3.617 Test Acc: 0.081
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.1702478
	speed: 0.2435s/iter; left time: 313.4328s
Epoch: 22 cost time: 11.915507793426514
Epoch: 22, Steps: 154 | Train Loss: 1.290 Vali Loss: 3.605 Vali Acc: 0.081 Test Loss: 3.605 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.2622623
	speed: 0.2481s/iter; left time: 281.1197s
Epoch: 23 cost time: 12.113508939743042
Epoch: 23, Steps: 154 | Train Loss: 1.282 Vali Loss: 5.726 Vali Acc: 0.120 Test Loss: 5.726 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 1.5761503
	speed: 0.2546s/iter; left time: 249.2739s
Epoch: 24 cost time: 13.830007076263428
Epoch: 24, Steps: 154 | Train Loss: 1.259 Vali Loss: 2.782 Vali Acc: 0.166 Test Loss: 2.782 Test Acc: 0.166
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.0675023
	speed: 0.2806s/iter; left time: 231.5160s
Epoch: 25 cost time: 14.278416633605957
Epoch: 25, Steps: 154 | Train Loss: 1.234 Vali Loss: 5.573 Vali Acc: 0.086 Test Loss: 5.573 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.1141378
	speed: 0.2841s/iter; left time: 190.6401s
Epoch: 26 cost time: 14.136176347732544
Epoch: 26, Steps: 154 | Train Loss: 1.194 Vali Loss: 6.927 Vali Acc: 0.090 Test Loss: 6.927 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38605028386050283
model parameter : 884126
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0960653
	speed: 0.0963s/iter; left time: 435.4070s
Epoch: 1 cost time: 14.61707067489624
Epoch: 1, Steps: 154 | Train Loss: 2.248 Vali Loss: 2.127 Vali Acc: 0.315 Test Loss: 2.127 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0192754
	speed: 0.2621s/iter; left time: 1144.4605s
Epoch: 2 cost time: 13.316860675811768
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.111 Vali Acc: 0.321 Test Loss: 2.111 Test Acc: 0.321
Validation loss decreased (-0.315469 --> -0.320741).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4818393
	speed: 0.2583s/iter; left time: 1088.3705s
Epoch: 3 cost time: 13.276234865188599
Epoch: 3, Steps: 154 | Train Loss: 1.969 Vali Loss: 2.072 Vali Acc: 0.327 Test Loss: 2.072 Test Acc: 0.327
Validation loss decreased (-0.320741 --> -0.326824).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7592683
	speed: 0.2708s/iter; left time: 1099.0540s
Epoch: 4 cost time: 13.31709361076355
Epoch: 4, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.131 Vali Acc: 0.333 Test Loss: 2.131 Test Acc: 0.333
Validation loss decreased (-0.326824 --> -0.332907).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9398443
	speed: 0.2640s/iter; left time: 1031.0905s
Epoch: 5 cost time: 12.60534381866455
Epoch: 5, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.131 Vali Acc: 0.335 Test Loss: 2.131 Test Acc: 0.335
Validation loss decreased (-0.332907 --> -0.334529).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7993753
	speed: 0.2321s/iter; left time: 870.6607s
Epoch: 6 cost time: 10.177818298339844
Epoch: 6, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.125 Vali Acc: 0.339 Test Loss: 2.125 Test Acc: 0.339
Validation loss decreased (-0.334529 --> -0.339395).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8656249
	speed: 0.2231s/iter; left time: 802.5033s
Epoch: 7 cost time: 10.034894704818726
Epoch: 7, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.216 Vali Acc: 0.182 Test Loss: 2.216 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4919375
	speed: 0.2320s/iter; left time: 798.9109s
Epoch: 8 cost time: 10.518942594528198
Epoch: 8, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.295 Vali Acc: 0.357 Test Loss: 2.295 Test Acc: 0.357
Validation loss decreased (-0.339395 --> -0.356830).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.9001346
	speed: 0.2221s/iter; left time: 730.4240s
Epoch: 9 cost time: 10.382890462875366
Epoch: 9, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.828 Vali Acc: 0.056 Test Loss: 2.828 Test Acc: 0.056
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4325678
	speed: 0.2321s/iter; left time: 727.4967s
Epoch: 10 cost time: 10.83629560470581
Epoch: 10, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.244 Vali Acc: 0.185 Test Loss: 2.244 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4364924
	speed: 0.2290s/iter; left time: 682.7687s
Epoch: 11 cost time: 10.828386068344116
Epoch: 11, Steps: 154 | Train Loss: 1.569 Vali Loss: 3.214 Vali Acc: 0.101 Test Loss: 3.214 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.7187699
	speed: 0.2171s/iter; left time: 613.7761s
Epoch: 12 cost time: 10.362038850784302
Epoch: 12, Steps: 154 | Train Loss: 1.529 Vali Loss: 3.250 Vali Acc: 0.096 Test Loss: 3.250 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3408275
	speed: 0.2259s/iter; left time: 603.9278s
Epoch: 13 cost time: 11.240191459655762
Epoch: 13, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.200 Vali Acc: 0.365 Test Loss: 2.200 Test Acc: 0.365
Validation loss decreased (-0.356830 --> -0.364536).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3225334
	speed: 0.2447s/iter; left time: 616.3404s
Epoch: 14 cost time: 11.653677225112915
Epoch: 14, Steps: 154 | Train Loss: 1.474 Vali Loss: 5.003 Vali Acc: 0.104 Test Loss: 5.003 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.7626107
	speed: 0.2579s/iter; left time: 610.0466s
Epoch: 15 cost time: 11.042133331298828
Epoch: 15, Steps: 154 | Train Loss: 1.440 Vali Loss: 4.019 Vali Acc: 0.118 Test Loss: 4.019 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.5221891
	speed: 0.2488s/iter; left time: 550.1111s
Epoch: 16 cost time: 11.09924054145813
Epoch: 16, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.784 Vali Acc: 0.108 Test Loss: 2.784 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.6955428
	speed: 0.2466s/iter; left time: 507.3234s
Epoch: 17 cost time: 11.110463380813599
Epoch: 17, Steps: 154 | Train Loss: 1.379 Vali Loss: 4.588 Vali Acc: 0.120 Test Loss: 4.588 Test Acc: 0.120
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.1876752
	speed: 0.2538s/iter; left time: 482.9488s
Epoch: 18 cost time: 11.6394522190094
Epoch: 18, Steps: 154 | Train Loss: 1.363 Vali Loss: 5.508 Vali Acc: 0.119 Test Loss: 5.508 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.5526400
	speed: 0.2427s/iter; left time: 424.5331s
Epoch: 19 cost time: 12.507463455200195
Epoch: 19, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.972 Vali Acc: 0.131 Test Loss: 3.972 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.7632332
	speed: 0.3062s/iter; left time: 488.3419s
Epoch: 20 cost time: 13.105486631393433
Epoch: 20, Steps: 154 | Train Loss: 1.302 Vali Loss: 5.742 Vali Acc: 0.129 Test Loss: 5.742 Test Acc: 0.129
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.5249045
	speed: 0.2881s/iter; left time: 415.1253s
Epoch: 21 cost time: 13.232996940612793
Epoch: 21, Steps: 154 | Train Loss: 1.272 Vali Loss: 5.302 Vali Acc: 0.131 Test Loss: 5.302 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.1346861
	speed: 0.2595s/iter; left time: 333.9889s
Epoch: 22 cost time: 10.744346618652344
Epoch: 22, Steps: 154 | Train Loss: 1.267 Vali Loss: 5.499 Vali Acc: 0.126 Test Loss: 5.499 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.1468644
	speed: 0.2538s/iter; left time: 287.5169s
Epoch: 23 cost time: 12.468544006347656
Epoch: 23, Steps: 154 | Train Loss: 1.227 Vali Loss: 5.533 Vali Acc: 0.128 Test Loss: 5.533 Test Acc: 0.128
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36455798864557987
model parameter : 263150
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7274954
	speed: 0.1100s/iter; left time: 497.2697s
Epoch: 1 cost time: 15.516217231750488
Epoch: 1, Steps: 154 | Train Loss: 2.195 Vali Loss: 2.127 Vali Acc: 0.315 Test Loss: 2.127 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9177067
	speed: 0.2478s/iter; left time: 1082.0233s
Epoch: 2 cost time: 10.958802938461304
Epoch: 2, Steps: 154 | Train Loss: 2.088 Vali Loss: 2.090 Vali Acc: 0.319 Test Loss: 2.090 Test Acc: 0.319
Validation loss decreased (-0.314658 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9788430
	speed: 0.2517s/iter; left time: 1060.4752s
Epoch: 3 cost time: 13.80309796333313
Epoch: 3, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.075 Vali Acc: 0.326 Test Loss: 2.075 Test Acc: 0.326
Validation loss decreased (-0.319119 --> -0.325608).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9238890
	speed: 0.2483s/iter; left time: 1008.0125s
Epoch: 4 cost time: 11.062316179275513
Epoch: 4, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.066 Vali Acc: 0.334 Test Loss: 2.066 Test Acc: 0.334
Validation loss decreased (-0.325608 --> -0.333718).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8090845
	speed: 0.2555s/iter; left time: 997.7155s
Epoch: 5 cost time: 13.926363468170166
Epoch: 5, Steps: 154 | Train Loss: 1.927 Vali Loss: 2.046 Vali Acc: 0.334 Test Loss: 2.046 Test Acc: 0.334
Validation loss decreased (-0.333718 --> -0.333718).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4121902
	speed: 0.2826s/iter; left time: 1060.0574s
Epoch: 6 cost time: 13.627730131149292
Epoch: 6, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.004 Vali Acc: 0.347 Test Loss: 2.004 Test Acc: 0.347
Validation loss decreased (-0.333718 --> -0.347101).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9937172
	speed: 0.3060s/iter; left time: 1100.5432s
Epoch: 7 cost time: 15.24323844909668
Epoch: 7, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.099 Vali Acc: 0.346 Test Loss: 2.099 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6596874
	speed: 0.2726s/iter; left time: 938.6023s
Epoch: 8 cost time: 13.148602485656738
Epoch: 8, Steps: 154 | Train Loss: 1.738 Vali Loss: 2.134 Vali Acc: 0.345 Test Loss: 2.134 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.8171446
	speed: 0.3041s/iter; left time: 1000.0676s
Epoch: 9 cost time: 14.340861558914185
Epoch: 9, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.125 Vali Acc: 0.354 Test Loss: 2.125 Test Acc: 0.354
Validation loss decreased (-0.347101 --> -0.353993).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3747129
	speed: 0.2694s/iter; left time: 844.5246s
Epoch: 10 cost time: 13.513428211212158
Epoch: 10, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.396 Vali Acc: 0.121 Test Loss: 2.396 Test Acc: 0.121
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5456393
	speed: 0.2957s/iter; left time: 881.5922s
Epoch: 11 cost time: 12.772947072982788
Epoch: 11, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.438 Vali Acc: 0.189 Test Loss: 2.438 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8818017
	speed: 0.2675s/iter; left time: 756.3567s
Epoch: 12 cost time: 13.321761131286621
Epoch: 12, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.453 Vali Acc: 0.179 Test Loss: 2.453 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.9011796
	speed: 0.2869s/iter; left time: 766.8504s
Epoch: 13 cost time: 11.829482316970825
Epoch: 13, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.731 Vali Acc: 0.189 Test Loss: 2.731 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 2.0601966
	speed: 0.2626s/iter; left time: 661.4262s
Epoch: 14 cost time: 13.19683575630188
Epoch: 14, Steps: 154 | Train Loss: 1.531 Vali Loss: 2.928 Vali Acc: 0.265 Test Loss: 2.928 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.1740773
	speed: 0.2753s/iter; left time: 651.1742s
Epoch: 15 cost time: 10.369483470916748
Epoch: 15, Steps: 154 | Train Loss: 1.489 Vali Loss: 2.757 Vali Acc: 0.209 Test Loss: 2.757 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.1746826
	speed: 0.2235s/iter; left time: 494.1647s
Epoch: 16 cost time: 11.152666091918945
Epoch: 16, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.619 Vali Acc: 0.197 Test Loss: 2.619 Test Acc: 0.197
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.0506837
	speed: 0.2481s/iter; left time: 510.4019s
Epoch: 17 cost time: 10.06772756576538
Epoch: 17, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.221 Vali Acc: 0.366 Test Loss: 2.221 Test Acc: 0.366
Validation loss decreased (-0.353993 --> -0.366158).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.4844620
	speed: 0.2250s/iter; left time: 428.1254s
Epoch: 18 cost time: 11.017300844192505
Epoch: 18, Steps: 154 | Train Loss: 1.479 Vali Loss: 2.255 Vali Acc: 0.383 Test Loss: 2.255 Test Acc: 0.383
Validation loss decreased (-0.366158 --> -0.383189).  Saving model ...
	iters: 100, epoch: 19 | loss: 2.0074844
	speed: 0.2488s/iter; left time: 435.1805s
Epoch: 19 cost time: 10.06906771659851
Epoch: 19, Steps: 154 | Train Loss: 1.378 Vali Loss: 2.549 Vali Acc: 0.387 Test Loss: 2.549 Test Acc: 0.387
Validation loss decreased (-0.383189 --> -0.386836).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.1713705
	speed: 0.2224s/iter; left time: 354.7501s
Epoch: 20 cost time: 11.197485446929932
Epoch: 20, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.595 Vali Acc: 0.348 Test Loss: 2.595 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.5752720
	speed: 0.2488s/iter; left time: 358.5271s
Epoch: 21 cost time: 10.557327270507812
Epoch: 21, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.257 Vali Acc: 0.327 Test Loss: 2.257 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.1520894
	speed: 0.2276s/iter; left time: 292.9555s
Epoch: 22 cost time: 11.282345294952393
Epoch: 22, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.530 Vali Acc: 0.081 Test Loss: 2.530 Test Acc: 0.081
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.2175211
	speed: 0.2531s/iter; left time: 286.7370s
Epoch: 23 cost time: 10.067274808883667
Epoch: 23, Steps: 154 | Train Loss: 1.337 Vali Loss: 3.181 Vali Acc: 0.122 Test Loss: 3.181 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.4105319
	speed: 0.2380s/iter; left time: 233.0231s
Epoch: 24 cost time: 11.514070749282837
Epoch: 24, Steps: 154 | Train Loss: 1.319 Vali Loss: 2.424 Vali Acc: 0.357 Test Loss: 2.424 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1550747
	speed: 0.2293s/iter; left time: 189.1958s
Epoch: 25 cost time: 10.790114879608154
Epoch: 25, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.408 Vali Acc: 0.365 Test Loss: 2.408 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.1861196
	speed: 0.2543s/iter; left time: 170.6057s
Epoch: 26 cost time: 10.955524444580078
Epoch: 26, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.927 Vali Acc: 0.378 Test Loss: 2.927 Test Acc: 0.378
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.2166454
	speed: 0.2612s/iter; left time: 135.0263s
Epoch: 27 cost time: 11.369492769241333
Epoch: 27, Steps: 154 | Train Loss: 1.222 Vali Loss: 2.731 Vali Acc: 0.376 Test Loss: 2.731 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.2900070
	speed: 0.2440s/iter; left time: 88.5768s
Epoch: 28 cost time: 12.14801812171936
Epoch: 28, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.676 Vali Acc: 0.316 Test Loss: 2.676 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.6296874
	speed: 0.2435s/iter; left time: 50.8918s
Epoch: 29 cost time: 11.017332077026367
Epoch: 29, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.028 Vali Acc: 0.371 Test Loss: 3.028 Test Acc: 0.371
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 884126
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0946198
	speed: 0.0992s/iter; left time: 448.4497s
Epoch: 1 cost time: 14.71127986907959
Epoch: 1, Steps: 154 | Train Loss: 2.262 Vali Loss: 2.125 Vali Acc: 0.315 Test Loss: 2.125 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9959400
	speed: 0.2522s/iter; left time: 1101.3713s
Epoch: 2 cost time: 12.335041284561157
Epoch: 2, Steps: 154 | Train Loss: 2.061 Vali Loss: 2.140 Vali Acc: 0.320 Test Loss: 2.140 Test Acc: 0.320
Validation loss decreased (-0.315469 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5280453
	speed: 0.2439s/iter; left time: 1027.6450s
Epoch: 3 cost time: 9.692295789718628
Epoch: 3, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.123 Vali Acc: 0.330 Test Loss: 2.123 Test Acc: 0.330
Validation loss decreased (-0.319930 --> -0.330473).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8144404
	speed: 0.2116s/iter; left time: 858.7367s
Epoch: 4 cost time: 9.309125661849976
Epoch: 4, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.164 Vali Acc: 0.333 Test Loss: 2.164 Test Acc: 0.333
Validation loss decreased (-0.330473 --> -0.333312).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0068533
	speed: 0.2027s/iter; left time: 791.4964s
Epoch: 5 cost time: 10.622860670089722
Epoch: 5, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.094 Vali Acc: 0.330 Test Loss: 2.094 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9066465
	speed: 0.1974s/iter; left time: 740.4691s
Epoch: 6 cost time: 9.175222158432007
Epoch: 6, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.088 Vali Acc: 0.333 Test Loss: 2.088 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8634645
	speed: 0.2023s/iter; left time: 727.5696s
Epoch: 7 cost time: 7.901407480239868
Epoch: 7, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.820 Vali Acc: 0.055 Test Loss: 2.820 Test Acc: 0.055
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4436427
	speed: 0.1986s/iter; left time: 683.7193s
Epoch: 8 cost time: 9.504682540893555
Epoch: 8, Steps: 154 | Train Loss: 1.791 Vali Loss: 2.102 Vali Acc: 0.342 Test Loss: 2.102 Test Acc: 0.342
Validation loss decreased (-0.333312 --> -0.342234).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8401731
	speed: 0.1982s/iter; left time: 651.8652s
Epoch: 9 cost time: 9.679606914520264
Epoch: 9, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.082 Vali Acc: 0.355 Test Loss: 2.082 Test Acc: 0.355
Validation loss decreased (-0.342234 --> -0.354805).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7984569
	speed: 0.1997s/iter; left time: 626.0123s
Epoch: 10 cost time: 8.34536862373352
Epoch: 10, Steps: 154 | Train Loss: 1.666 Vali Loss: 2.241 Vali Acc: 0.188 Test Loss: 2.241 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4795749
	speed: 0.2014s/iter; left time: 600.2483s
Epoch: 11 cost time: 8.539125919342041
Epoch: 11, Steps: 154 | Train Loss: 1.615 Vali Loss: 3.266 Vali Acc: 0.067 Test Loss: 3.266 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8208746
	speed: 0.2253s/iter; left time: 636.7912s
Epoch: 12 cost time: 11.849271535873413
Epoch: 12, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.231 Vali Acc: 0.351 Test Loss: 2.231 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4098437
	speed: 0.2350s/iter; left time: 628.0595s
Epoch: 13 cost time: 10.752625703811646
Epoch: 13, Steps: 154 | Train Loss: 1.562 Vali Loss: 1.984 Vali Acc: 0.367 Test Loss: 1.984 Test Acc: 0.367
Validation loss decreased (-0.354805 --> -0.366566).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2548075
	speed: 0.2383s/iter; left time: 600.2697s
Epoch: 14 cost time: 9.791598558425903
Epoch: 14, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.863 Vali Acc: 0.099 Test Loss: 2.863 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9185119
	speed: 0.2376s/iter; left time: 561.8592s
Epoch: 15 cost time: 10.781513929367065
Epoch: 15, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.299 Vali Acc: 0.376 Test Loss: 2.299 Test Acc: 0.376
Validation loss decreased (-0.366566 --> -0.375889).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4052106
	speed: 0.2270s/iter; left time: 501.9246s
Epoch: 16 cost time: 10.982470512390137
Epoch: 16, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.353 Vali Acc: 0.380 Test Loss: 2.353 Test Acc: 0.380
Validation loss decreased (-0.375889 --> -0.379944).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.7552643
	speed: 0.2347s/iter; left time: 482.8773s
Epoch: 17 cost time: 10.233691930770874
Epoch: 17, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.744 Vali Acc: 0.100 Test Loss: 2.744 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.3619348
	speed: 0.2403s/iter; left time: 457.3687s
Epoch: 18 cost time: 9.299622297286987
Epoch: 18, Steps: 154 | Train Loss: 1.426 Vali Loss: 3.110 Vali Acc: 0.092 Test Loss: 3.110 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.5151159
	speed: 0.2252s/iter; left time: 393.9057s
Epoch: 19 cost time: 11.266987562179565
Epoch: 19, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.857 Vali Acc: 0.094 Test Loss: 3.857 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.9015524
	speed: 0.2201s/iter; left time: 351.1391s
Epoch: 20 cost time: 9.785084962844849
Epoch: 20, Steps: 154 | Train Loss: 1.393 Vali Loss: 2.316 Vali Acc: 0.258 Test Loss: 2.316 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.6116724
	speed: 0.2308s/iter; left time: 332.6201s
Epoch: 21 cost time: 8.589508056640625
Epoch: 21, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.829 Vali Acc: 0.116 Test Loss: 2.829 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.3076590
	speed: 0.2005s/iter; left time: 258.0992s
Epoch: 22 cost time: 9.24233889579773
Epoch: 22, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.333 Vali Acc: 0.391 Test Loss: 2.333 Test Acc: 0.391
Validation loss decreased (-0.379944 --> -0.391299).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.7994409
	speed: 0.1906s/iter; left time: 215.9152s
Epoch: 23 cost time: 9.060828447341919
Epoch: 23, Steps: 154 | Train Loss: 1.348 Vali Loss: 2.600 Vali Acc: 0.315 Test Loss: 2.600 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.4855189
	speed: 0.1957s/iter; left time: 191.6178s
Epoch: 24 cost time: 8.23624038696289
Epoch: 24, Steps: 154 | Train Loss: 1.340 Vali Loss: 3.050 Vali Acc: 0.306 Test Loss: 3.050 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.3439003
	speed: 0.1776s/iter; left time: 146.5061s
Epoch: 25 cost time: 6.591894865036011
Epoch: 25, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.750 Vali Acc: 0.350 Test Loss: 2.750 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.1393074
	speed: 0.1920s/iter; left time: 128.8189s
Epoch: 26 cost time: 10.300112247467041
Epoch: 26, Steps: 154 | Train Loss: 1.287 Vali Loss: 5.246 Vali Acc: 0.084 Test Loss: 5.246 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.2554241
	speed: 0.2015s/iter; left time: 104.1953s
Epoch: 27 cost time: 8.99129033088684
Epoch: 27, Steps: 154 | Train Loss: 1.289 Vali Loss: 5.070 Vali Acc: 0.148 Test Loss: 5.070 Test Acc: 0.148
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.2263535
	speed: 0.2188s/iter; left time: 79.4225s
Epoch: 28 cost time: 8.661571741104126
Epoch: 28, Steps: 154 | Train Loss: 1.255 Vali Loss: 5.240 Vali Acc: 0.120 Test Loss: 5.240 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.8488988
	speed: 0.2067s/iter; left time: 43.1935s
Epoch: 29 cost time: 10.027802228927612
Epoch: 29, Steps: 154 | Train Loss: 1.247 Vali Loss: 5.183 Vali Acc: 0.110 Test Loss: 5.183 Test Acc: 0.110
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.4816236
	speed: 0.2144s/iter; left time: 11.7924s
Epoch: 30 cost time: 9.656703233718872
Epoch: 30, Steps: 154 | Train Loss: 1.242 Vali Loss: 3.065 Vali Acc: 0.161 Test Loss: 3.065 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3913219789132198
model parameter : 263150
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2142668
	speed: 0.1357s/iter; left time: 613.5308s
Epoch: 1 cost time: 21.02050018310547
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.127 Vali Acc: 0.316 Test Loss: 2.127 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0846298
	speed: 0.3829s/iter; left time: 1672.1523s
Epoch: 2 cost time: 18.738772869110107
Epoch: 2, Steps: 154 | Train Loss: 2.069 Vali Loss: 2.128 Vali Acc: 0.321 Test Loss: 2.128 Test Acc: 0.321
Validation loss decreased (-0.315875 --> -0.321147).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2010689
	speed: 0.3868s/iter; left time: 1629.7975s
Epoch: 3 cost time: 19.11298704147339
Epoch: 3, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.117 Vali Acc: 0.324 Test Loss: 2.117 Test Acc: 0.324
Validation loss decreased (-0.321147 --> -0.324391).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7091364
	speed: 0.3851s/iter; left time: 1562.9682s
Epoch: 4 cost time: 19.134150743484497
Epoch: 4, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.066 Vali Acc: 0.332 Test Loss: 2.066 Test Acc: 0.332
Validation loss decreased (-0.324391 --> -0.331691).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2878380
	speed: 0.3772s/iter; left time: 1472.8846s
Epoch: 5 cost time: 19.152358770370483
Epoch: 5, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.104 Vali Acc: 0.339 Test Loss: 2.104 Test Acc: 0.339
Validation loss decreased (-0.331691 --> -0.338990).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8256904
	speed: 0.3808s/iter; left time: 1428.2758s
Epoch: 6 cost time: 19.91571283340454
Epoch: 6, Steps: 154 | Train Loss: 1.831 Vali Loss: 2.107 Vali Acc: 0.336 Test Loss: 2.107 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7150437
	speed: 0.3517s/iter; left time: 1265.0741s
Epoch: 7 cost time: 18.180070400238037
Epoch: 7, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.096 Vali Acc: 0.350 Test Loss: 2.096 Test Acc: 0.350
Validation loss decreased (-0.338990 --> -0.350344).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9459186
	speed: 0.3355s/iter; left time: 1155.0860s
Epoch: 8 cost time: 17.75102663040161
Epoch: 8, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.219 Vali Acc: 0.313 Test Loss: 2.219 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1677405
	speed: 0.3290s/iter; left time: 1081.9607s
Epoch: 9 cost time: 16.729464292526245
Epoch: 9, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.262 Vali Acc: 0.350 Test Loss: 2.262 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9367915
	speed: 0.3273s/iter; left time: 1026.0109s
Epoch: 10 cost time: 16.042843341827393
Epoch: 10, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.308 Vali Acc: 0.363 Test Loss: 2.308 Test Acc: 0.363
Validation loss decreased (-0.350344 --> -0.363318).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4395487
	speed: 0.3270s/iter; left time: 974.7569s
Epoch: 11 cost time: 15.400736093521118
Epoch: 11, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.266 Vali Acc: 0.366 Test Loss: 2.266 Test Acc: 0.366
Validation loss decreased (-0.363318 --> -0.366157).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.9436822
	speed: 0.3249s/iter; left time: 918.4333s
Epoch: 12 cost time: 14.874531269073486
Epoch: 12, Steps: 154 | Train Loss: 1.530 Vali Loss: 2.294 Vali Acc: 0.357 Test Loss: 2.294 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0886601
	speed: 0.3214s/iter; left time: 859.0182s
Epoch: 13 cost time: 15.70119333267212
Epoch: 13, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.612 Vali Acc: 0.330 Test Loss: 2.612 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4461648
	speed: 0.3583s/iter; left time: 902.5472s
Epoch: 14 cost time: 18.777310132980347
Epoch: 14, Steps: 154 | Train Loss: 1.458 Vali Loss: 3.655 Vali Acc: 0.107 Test Loss: 3.655 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 2.0048504
	speed: 0.3637s/iter; left time: 860.1366s
Epoch: 15 cost time: 18.876460790634155
Epoch: 15, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.328 Vali Acc: 0.360 Test Loss: 2.328 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0624324
	speed: 0.3574s/iter; left time: 790.3074s
Epoch: 16 cost time: 18.122190475463867
Epoch: 16, Steps: 154 | Train Loss: 1.414 Vali Loss: 3.131 Vali Acc: 0.099 Test Loss: 3.131 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1386087
	speed: 0.3674s/iter; left time: 755.8386s
Epoch: 17 cost time: 17.030327320098877
Epoch: 17, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.865 Vali Acc: 0.116 Test Loss: 3.865 Test Acc: 0.116
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.2374344
	speed: 0.3712s/iter; left time: 706.3171s
Epoch: 18 cost time: 17.110851049423218
Epoch: 18, Steps: 154 | Train Loss: 1.358 Vali Loss: 5.502 Vali Acc: 0.073 Test Loss: 5.502 Test Acc: 0.073
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0305201
	speed: 0.3221s/iter; left time: 563.4316s
Epoch: 19 cost time: 14.482792615890503
Epoch: 19, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.196 Vali Acc: 0.098 Test Loss: 3.196 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.4295412
	speed: 0.3306s/iter; left time: 527.2602s
Epoch: 20 cost time: 16.449395179748535
Epoch: 20, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.839 Vali Acc: 0.099 Test Loss: 2.839 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1916635
	speed: 0.3103s/iter; left time: 447.1960s
Epoch: 21 cost time: 15.098304271697998
Epoch: 21, Steps: 154 | Train Loss: 1.261 Vali Loss: 4.430 Vali Acc: 0.108 Test Loss: 4.430 Test Acc: 0.108
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3661800486618005
model parameter : 444254
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1219237
	speed: 0.0970s/iter; left time: 438.3693s
Epoch: 1 cost time: 14.553764581680298
Epoch: 1, Steps: 154 | Train Loss: 2.257 Vali Loss: 2.122 Vali Acc: 0.316 Test Loss: 2.122 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8563833
	speed: 0.2672s/iter; left time: 1167.0590s
Epoch: 2 cost time: 13.073016166687012
Epoch: 2, Steps: 154 | Train Loss: 2.067 Vali Loss: 2.119 Vali Acc: 0.320 Test Loss: 2.119 Test Acc: 0.320
Validation loss decreased (-0.315875 --> -0.319930).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3106384
	speed: 0.2703s/iter; left time: 1138.7772s
Epoch: 3 cost time: 12.913432598114014
Epoch: 3, Steps: 154 | Train Loss: 1.984 Vali Loss: 2.076 Vali Acc: 0.327 Test Loss: 2.076 Test Acc: 0.327
Validation loss decreased (-0.319930 --> -0.327230).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1717865
	speed: 0.2625s/iter; left time: 1065.6405s
Epoch: 4 cost time: 12.159887790679932
Epoch: 4, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.100 Vali Acc: 0.335 Test Loss: 2.100 Test Acc: 0.335
Validation loss decreased (-0.327230 --> -0.335340).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3656843
	speed: 0.2655s/iter; left time: 1036.6493s
Epoch: 5 cost time: 13.560359001159668
Epoch: 5, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.038 Vali Acc: 0.347 Test Loss: 2.038 Test Acc: 0.347
Validation loss decreased (-0.335340 --> -0.347100).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7279552
	speed: 0.2908s/iter; left time: 1090.7114s
Epoch: 6 cost time: 13.113789558410645
Epoch: 6, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.027 Vali Acc: 0.363 Test Loss: 2.027 Test Acc: 0.363
Validation loss decreased (-0.347100 --> -0.363321).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8217148
	speed: 0.2945s/iter; left time: 1059.2903s
Epoch: 7 cost time: 13.310202836990356
Epoch: 7, Steps: 154 | Train Loss: 1.648 Vali Loss: 2.076 Vali Acc: 0.388 Test Loss: 2.076 Test Acc: 0.388
Validation loss decreased (-0.363321 --> -0.387652).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0058283
	speed: 0.2982s/iter; left time: 1026.7751s
Epoch: 8 cost time: 13.729586124420166
Epoch: 8, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.079 Vali Acc: 0.369 Test Loss: 2.079 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2245017
	speed: 0.2931s/iter; left time: 964.0418s
Epoch: 9 cost time: 13.943137168884277
Epoch: 9, Steps: 154 | Train Loss: 1.571 Vali Loss: 2.138 Vali Acc: 0.357 Test Loss: 2.138 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0295309
	speed: 0.3002s/iter; left time: 941.0385s
Epoch: 10 cost time: 13.837218761444092
Epoch: 10, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.723 Vali Acc: 0.107 Test Loss: 2.723 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0931814
	speed: 0.2929s/iter; left time: 873.1886s
Epoch: 11 cost time: 13.890617370605469
Epoch: 11, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.404 Vali Acc: 0.125 Test Loss: 2.404 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6006240
	speed: 0.2961s/iter; left time: 836.9759s
Epoch: 12 cost time: 14.31134295463562
Epoch: 12, Steps: 154 | Train Loss: 1.480 Vali Loss: 1.997 Vali Acc: 0.370 Test Loss: 1.997 Test Acc: 0.370
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4401304
	speed: 0.2650s/iter; left time: 708.2233s
Epoch: 13 cost time: 11.555027484893799
Epoch: 13, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.882 Vali Acc: 0.090 Test Loss: 2.882 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.7415049
	speed: 0.2529s/iter; left time: 637.0739s
Epoch: 14 cost time: 12.739363193511963
Epoch: 14, Steps: 154 | Train Loss: 1.406 Vali Loss: 6.349 Vali Acc: 0.093 Test Loss: 6.349 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1394104
	speed: 0.2719s/iter; left time: 643.0173s
Epoch: 15 cost time: 12.728502750396729
Epoch: 15, Steps: 154 | Train Loss: 1.376 Vali Loss: 5.787 Vali Acc: 0.082 Test Loss: 5.787 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1513445
	speed: 0.2671s/iter; left time: 590.5998s
Epoch: 16 cost time: 12.79914116859436
Epoch: 16, Steps: 154 | Train Loss: 1.355 Vali Loss: 5.458 Vali Acc: 0.084 Test Loss: 5.458 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.2519621
	speed: 0.2706s/iter; left time: 556.6572s
Epoch: 17 cost time: 12.184065341949463
Epoch: 17, Steps: 154 | Train Loss: 1.324 Vali Loss: 2.944 Vali Acc: 0.263 Test Loss: 2.944 Test Acc: 0.263
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38767234387672345
model parameter : 133742
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2156520
	speed: 0.1083s/iter; left time: 489.6271s
Epoch: 1 cost time: 14.737369060516357
Epoch: 1, Steps: 154 | Train Loss: 2.258 Vali Loss: 2.128 Vali Acc: 0.315 Test Loss: 2.128 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1035740
	speed: 0.2855s/iter; left time: 1246.8205s
Epoch: 2 cost time: 15.857450723648071
Epoch: 2, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.129 Vali Acc: 0.320 Test Loss: 2.129 Test Acc: 0.320
Validation loss decreased (-0.315469 --> -0.320336).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1947985
	speed: 0.3002s/iter; left time: 1264.5891s
Epoch: 3 cost time: 16.683656930923462
Epoch: 3, Steps: 154 | Train Loss: 2.013 Vali Loss: 2.115 Vali Acc: 0.324 Test Loss: 2.115 Test Acc: 0.324
Validation loss decreased (-0.320336 --> -0.324391).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6899433
	speed: 0.3046s/iter; left time: 1236.5344s
Epoch: 4 cost time: 16.439619064331055
Epoch: 4, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.063 Vali Acc: 0.334 Test Loss: 2.063 Test Acc: 0.334
Validation loss decreased (-0.324391 --> -0.334124).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3856232
	speed: 0.3015s/iter; left time: 1177.4088s
Epoch: 5 cost time: 16.35083270072937
Epoch: 5, Steps: 154 | Train Loss: 1.917 Vali Loss: 2.112 Vali Acc: 0.335 Test Loss: 2.112 Test Acc: 0.335
Validation loss decreased (-0.334124 --> -0.335340).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8111777
	speed: 0.2954s/iter; left time: 1108.2224s
Epoch: 6 cost time: 14.948267698287964
Epoch: 6, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.065 Vali Acc: 0.333 Test Loss: 2.065 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8279332
	speed: 0.2982s/iter; left time: 1072.7366s
Epoch: 7 cost time: 16.26103949546814
Epoch: 7, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.065 Vali Acc: 0.343 Test Loss: 2.065 Test Acc: 0.343
Validation loss decreased (-0.335340 --> -0.343045).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8432547
	speed: 0.3049s/iter; left time: 1049.8235s
Epoch: 8 cost time: 16.76440930366516
Epoch: 8, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.182 Vali Acc: 0.351 Test Loss: 2.182 Test Acc: 0.351
Validation loss decreased (-0.343045 --> -0.350749).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1809222
	speed: 0.3050s/iter; left time: 1003.2034s
Epoch: 9 cost time: 15.58972954750061
Epoch: 9, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.218 Vali Acc: 0.347 Test Loss: 2.218 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 2.1880734
	speed: 0.2690s/iter; left time: 843.2438s
Epoch: 10 cost time: 11.687005758285522
Epoch: 10, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.272 Vali Acc: 0.345 Test Loss: 2.272 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4686177
	speed: 0.2332s/iter; left time: 695.0371s
Epoch: 11 cost time: 11.742064476013184
Epoch: 11, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.171 Vali Acc: 0.348 Test Loss: 2.171 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.8825090
	speed: 0.2387s/iter; left time: 674.9053s
Epoch: 12 cost time: 12.008162498474121
Epoch: 12, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.493 Vali Acc: 0.352 Test Loss: 2.493 Test Acc: 0.352
Validation loss decreased (-0.350749 --> -0.351557).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0009981
	speed: 0.2504s/iter; left time: 669.1985s
Epoch: 13 cost time: 12.334411859512329
Epoch: 13, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.513 Vali Acc: 0.332 Test Loss: 2.513 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4602355
	speed: 0.2368s/iter; left time: 596.3889s
Epoch: 14 cost time: 11.27158498764038
Epoch: 14, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.594 Vali Acc: 0.133 Test Loss: 2.594 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.8349160
	speed: 0.2324s/iter; left time: 549.5725s
Epoch: 15 cost time: 11.610694408416748
Epoch: 15, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.215 Vali Acc: 0.316 Test Loss: 2.215 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0695596
	speed: 0.2519s/iter; left time: 556.9118s
Epoch: 16 cost time: 13.996217489242554
Epoch: 16, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.251 Vali Acc: 0.365 Test Loss: 2.251 Test Acc: 0.365
Validation loss decreased (-0.351557 --> -0.364535).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.2708441
	speed: 0.2679s/iter; left time: 550.9688s
Epoch: 17 cost time: 13.065286636352539
Epoch: 17, Steps: 154 | Train Loss: 1.385 Vali Loss: 3.335 Vali Acc: 0.119 Test Loss: 3.335 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.2990913
	speed: 0.2650s/iter; left time: 504.2592s
Epoch: 18 cost time: 13.342967748641968
Epoch: 18, Steps: 154 | Train Loss: 1.365 Vali Loss: 4.655 Vali Acc: 0.117 Test Loss: 4.655 Test Acc: 0.117
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.1260651
	speed: 0.2691s/iter; left time: 470.6858s
Epoch: 19 cost time: 13.576781034469604
Epoch: 19, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.962 Vali Acc: 0.096 Test Loss: 2.962 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.4736118
	speed: 0.2818s/iter; left time: 449.4240s
Epoch: 20 cost time: 13.852889776229858
Epoch: 20, Steps: 154 | Train Loss: 1.296 Vali Loss: 5.892 Vali Acc: 0.128 Test Loss: 5.892 Test Acc: 0.128
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.2197049
	speed: 0.2694s/iter; left time: 388.2411s
Epoch: 21 cost time: 13.504756450653076
Epoch: 21, Steps: 154 | Train Loss: 1.273 Vali Loss: 4.594 Vali Acc: 0.114 Test Loss: 4.594 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 1.5858728
	speed: 0.2638s/iter; left time: 339.4983s
Epoch: 22 cost time: 12.926934957504272
Epoch: 22, Steps: 154 | Train Loss: 1.258 Vali Loss: 3.586 Vali Acc: 0.127 Test Loss: 3.586 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 1.2669649
	speed: 0.2644s/iter; left time: 299.5186s
Epoch: 23 cost time: 13.257568120956421
Epoch: 23, Steps: 154 | Train Loss: 1.225 Vali Loss: 6.273 Vali Acc: 0.082 Test Loss: 6.273 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.6804711
	speed: 0.2526s/iter; left time: 247.2946s
Epoch: 24 cost time: 11.28922724723816
Epoch: 24, Steps: 154 | Train Loss: 1.182 Vali Loss: 5.283 Vali Acc: 0.107 Test Loss: 5.283 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 1.2727237
	speed: 0.2361s/iter; left time: 194.7485s
Epoch: 25 cost time: 11.334909200668335
Epoch: 25, Steps: 154 | Train Loss: 1.161 Vali Loss: 5.155 Vali Acc: 0.082 Test Loss: 5.155 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 1.4602402
	speed: 0.2685s/iter; left time: 180.1816s
Epoch: 26 cost time: 14.966176986694336
Epoch: 26, Steps: 154 | Train Loss: 1.118 Vali Loss: 4.884 Vali Acc: 0.139 Test Loss: 4.884 Test Acc: 0.139
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36455798864557987
model parameter : 444254
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1214185
	speed: 0.1021s/iter; left time: 461.6171s
Epoch: 1 cost time: 14.919513702392578
Epoch: 1, Steps: 154 | Train Loss: 2.259 Vali Loss: 2.122 Vali Acc: 0.316 Test Loss: 2.122 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8695546
	speed: 0.2569s/iter; left time: 1121.9925s
Epoch: 2 cost time: 11.097593069076538
Epoch: 2, Steps: 154 | Train Loss: 2.068 Vali Loss: 2.124 Vali Acc: 0.320 Test Loss: 2.124 Test Acc: 0.320
Validation loss decreased (-0.315875 --> -0.319525).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3429615
	speed: 0.2514s/iter; left time: 1059.3541s
Epoch: 3 cost time: 12.654459238052368
Epoch: 3, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.072 Vali Acc: 0.327 Test Loss: 2.072 Test Acc: 0.327
Validation loss decreased (-0.319525 --> -0.326824).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1806390
	speed: 0.2509s/iter; left time: 1018.3063s
Epoch: 4 cost time: 10.562118291854858
Epoch: 4, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.110 Vali Acc: 0.337 Test Loss: 2.110 Test Acc: 0.337
Validation loss decreased (-0.326824 --> -0.337367).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3495727
	speed: 0.2648s/iter; left time: 1034.2120s
Epoch: 5 cost time: 14.268838882446289
Epoch: 5, Steps: 154 | Train Loss: 1.808 Vali Loss: 2.023 Vali Acc: 0.350 Test Loss: 2.023 Test Acc: 0.350
Validation loss decreased (-0.337367 --> -0.349939).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7102898
	speed: 0.2949s/iter; left time: 1106.2676s
Epoch: 6 cost time: 13.010881423950195
Epoch: 6, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.028 Vali Acc: 0.356 Test Loss: 2.028 Test Acc: 0.356
Validation loss decreased (-0.349939 --> -0.356022).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8403138
	speed: 0.2802s/iter; left time: 1007.7060s
Epoch: 7 cost time: 13.459803581237793
Epoch: 7, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.047 Vali Acc: 0.361 Test Loss: 2.047 Test Acc: 0.361
Validation loss decreased (-0.356022 --> -0.360888).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9917389
	speed: 0.2863s/iter; left time: 985.6478s
Epoch: 8 cost time: 12.502479314804077
Epoch: 8, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.077 Vali Acc: 0.361 Test Loss: 2.077 Test Acc: 0.361
Validation loss decreased (-0.360888 --> -0.361293).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2213280
	speed: 0.2829s/iter; left time: 930.4590s
Epoch: 9 cost time: 14.61403226852417
Epoch: 9, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.100 Vali Acc: 0.364 Test Loss: 2.100 Test Acc: 0.364
Validation loss decreased (-0.361293 --> -0.363726).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.9496521
	speed: 0.2978s/iter; left time: 933.6421s
Epoch: 10 cost time: 12.947636842727661
Epoch: 10, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.672 Vali Acc: 0.106 Test Loss: 2.672 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1934717
	speed: 0.2821s/iter; left time: 840.8955s
Epoch: 11 cost time: 14.04835057258606
Epoch: 11, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.270 Vali Acc: 0.276 Test Loss: 2.270 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5544736
	speed: 0.2947s/iter; left time: 833.2302s
Epoch: 12 cost time: 12.983634948730469
Epoch: 12, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.073 Vali Acc: 0.374 Test Loss: 2.073 Test Acc: 0.374
Validation loss decreased (-0.363726 --> -0.373864).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4934387
	speed: 0.2828s/iter; left time: 755.9597s
Epoch: 13 cost time: 14.470344305038452
Epoch: 13, Steps: 154 | Train Loss: 1.447 Vali Loss: 2.710 Vali Acc: 0.097 Test Loss: 2.710 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7502968
	speed: 0.2945s/iter; left time: 741.7633s
Epoch: 14 cost time: 12.6291823387146
Epoch: 14, Steps: 154 | Train Loss: 1.414 Vali Loss: 6.168 Vali Acc: 0.090 Test Loss: 6.168 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1465511
	speed: 0.2518s/iter; left time: 595.4684s
Epoch: 15 cost time: 12.960643768310547
Epoch: 15, Steps: 154 | Train Loss: 1.389 Vali Loss: 5.200 Vali Acc: 0.082 Test Loss: 5.200 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.1038684
	speed: 0.2553s/iter; left time: 564.5439s
Epoch: 16 cost time: 11.086101055145264
Epoch: 16, Steps: 154 | Train Loss: 1.366 Vali Loss: 4.417 Vali Acc: 0.087 Test Loss: 4.417 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.2852035
	speed: 0.2476s/iter; left time: 509.2167s
Epoch: 17 cost time: 12.330964803695679
Epoch: 17, Steps: 154 | Train Loss: 1.335 Vali Loss: 3.988 Vali Acc: 0.101 Test Loss: 3.988 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.9018472
	speed: 0.2504s/iter; left time: 476.4575s
Epoch: 18 cost time: 10.33287763595581
Epoch: 18, Steps: 154 | Train Loss: 1.318 Vali Loss: 6.280 Vali Acc: 0.079 Test Loss: 6.280 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.3052864
	speed: 0.2454s/iter; left time: 429.2188s
Epoch: 19 cost time: 12.72489881515503
Epoch: 19, Steps: 154 | Train Loss: 1.292 Vali Loss: 6.741 Vali Acc: 0.113 Test Loss: 6.741 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.0228337
	speed: 0.2557s/iter; left time: 407.7898s
Epoch: 20 cost time: 10.243432760238647
Epoch: 20, Steps: 154 | Train Loss: 1.256 Vali Loss: 6.917 Vali Acc: 0.104 Test Loss: 6.917 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.1675774
	speed: 0.2401s/iter; left time: 346.0028s
Epoch: 21 cost time: 12.52767038345337
Epoch: 21, Steps: 154 | Train Loss: 1.229 Vali Loss: 6.636 Vali Acc: 0.107 Test Loss: 6.636 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.2142719
	speed: 0.2600s/iter; left time: 334.6310s
Epoch: 22 cost time: 10.69036602973938
Epoch: 22, Steps: 154 | Train Loss: 1.191 Vali Loss: 6.897 Vali Acc: 0.103 Test Loss: 6.897 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 133742
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2030623
	speed: 0.1242s/iter; left time: 561.6144s
Epoch: 1 cost time: 17.495068311691284
Epoch: 1, Steps: 154 | Train Loss: 2.267 Vali Loss: 2.121 Vali Acc: 0.316 Test Loss: 2.121 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1195278
	speed: 0.2818s/iter; left time: 1230.6627s
Epoch: 2 cost time: 16.75511860847473
Epoch: 2, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.129 Vali Acc: 0.318 Test Loss: 2.129 Test Acc: 0.318
Validation loss decreased (-0.315875 --> -0.317902).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1890416
	speed: 0.2950s/iter; left time: 1242.8278s
Epoch: 3 cost time: 14.234302759170532
Epoch: 3, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.088 Vali Acc: 0.327 Test Loss: 2.088 Test Acc: 0.327
Validation loss decreased (-0.317902 --> -0.326824).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7596319
	speed: 0.2064s/iter; left time: 837.8513s
Epoch: 4 cost time: 9.993979215621948
Epoch: 4, Steps: 154 | Train Loss: 1.985 Vali Loss: 2.100 Vali Acc: 0.323 Test Loss: 2.100 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4220479
	speed: 0.1920s/iter; left time: 749.8185s
Epoch: 5 cost time: 12.616788625717163
Epoch: 5, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.139 Vali Acc: 0.334 Test Loss: 2.139 Test Acc: 0.334
Validation loss decreased (-0.326824 --> -0.333717).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7273915
	speed: 0.2765s/iter; left time: 1037.1447s
Epoch: 6 cost time: 15.209942102432251
Epoch: 6, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.050 Vali Acc: 0.339 Test Loss: 2.050 Test Acc: 0.339
Validation loss decreased (-0.333717 --> -0.339396).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6574724
	speed: 0.2399s/iter; left time: 863.0050s
Epoch: 7 cost time: 10.282185077667236
Epoch: 7, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.214 Vali Acc: 0.347 Test Loss: 2.214 Test Acc: 0.347
Validation loss decreased (-0.339396 --> -0.346693).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9800764
	speed: 0.2422s/iter; left time: 834.0213s
Epoch: 8 cost time: 12.375934839248657
Epoch: 8, Steps: 154 | Train Loss: 1.728 Vali Loss: 2.871 Vali Acc: 0.165 Test Loss: 2.871 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1243323
	speed: 0.2404s/iter; left time: 790.8325s
Epoch: 9 cost time: 11.046719789505005
Epoch: 9, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.104 Vali Acc: 0.348 Test Loss: 2.104 Test Acc: 0.348
Validation loss decreased (-0.346693 --> -0.347505).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0577755
	speed: 0.2062s/iter; left time: 646.3370s
Epoch: 10 cost time: 10.402963638305664
Epoch: 10, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.819 Vali Acc: 0.114 Test Loss: 2.819 Test Acc: 0.114
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4297552
	speed: 0.1991s/iter; left time: 593.4766s
Epoch: 11 cost time: 8.473819017410278
Epoch: 11, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.449 Vali Acc: 0.219 Test Loss: 2.449 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.8709624
	speed: 0.1890s/iter; left time: 534.3698s
Epoch: 12 cost time: 10.185454607009888
Epoch: 12, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.404 Vali Acc: 0.349 Test Loss: 2.404 Test Acc: 0.349
Validation loss decreased (-0.347505 --> -0.349124).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.2395569
	speed: 0.2049s/iter; left time: 547.6404s
Epoch: 13 cost time: 8.650696039199829
Epoch: 13, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.721 Vali Acc: 0.142 Test Loss: 2.721 Test Acc: 0.142
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4323708
	speed: 0.1890s/iter; left time: 476.1989s
Epoch: 14 cost time: 10.165168523788452
Epoch: 14, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.687 Vali Acc: 0.177 Test Loss: 2.687 Test Acc: 0.177
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 2.2702708
	speed: 0.2300s/iter; left time: 543.9403s
Epoch: 15 cost time: 10.80884051322937
Epoch: 15, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.379 Vali Acc: 0.095 Test Loss: 3.379 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0012716
	speed: 0.2313s/iter; left time: 511.3053s
Epoch: 16 cost time: 12.10017442703247
Epoch: 16, Steps: 154 | Train Loss: 1.485 Vali Loss: 2.489 Vali Acc: 0.349 Test Loss: 2.489 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.2504201
	speed: 0.2527s/iter; left time: 519.7821s
Epoch: 17 cost time: 10.516771793365479
Epoch: 17, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.309 Vali Acc: 0.188 Test Loss: 3.309 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.3660748
	speed: 0.2203s/iter; left time: 419.2646s
Epoch: 18 cost time: 11.299931287765503
Epoch: 18, Steps: 154 | Train Loss: 1.428 Vali Loss: 2.951 Vali Acc: 0.191 Test Loss: 2.951 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.1189663
	speed: 0.2605s/iter; left time: 455.6117s
Epoch: 19 cost time: 11.482226133346558
Epoch: 19, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.667 Vali Acc: 0.385 Test Loss: 2.667 Test Acc: 0.385
Validation loss decreased (-0.349124 --> -0.385213).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.8979239
	speed: 0.1818s/iter; left time: 290.0166s
Epoch: 20 cost time: 8.322986602783203
Epoch: 20, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.517 Vali Acc: 0.175 Test Loss: 3.517 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2342765
	speed: 0.2153s/iter; left time: 310.2342s
Epoch: 21 cost time: 10.238954782485962
Epoch: 21, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.206 Vali Acc: 0.232 Test Loss: 3.206 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.7452723
	speed: 0.1790s/iter; left time: 230.3152s
Epoch: 22 cost time: 8.291958808898926
Epoch: 22, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.773 Vali Acc: 0.363 Test Loss: 2.773 Test Acc: 0.363
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.2871826
	speed: 0.1604s/iter; left time: 181.6852s
Epoch: 23 cost time: 6.382232904434204
Epoch: 23, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.021 Vali Acc: 0.315 Test Loss: 3.021 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.7993570
	speed: 0.1293s/iter; left time: 126.6023s
Epoch: 24 cost time: 8.388262510299683
Epoch: 24, Steps: 154 | Train Loss: 1.317 Vali Loss: 4.098 Vali Acc: 0.188 Test Loss: 4.098 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.5780751
	speed: 0.1838s/iter; left time: 151.6328s
Epoch: 25 cost time: 8.783047676086426
Epoch: 25, Steps: 154 | Train Loss: 1.378 Vali Loss: 4.312 Vali Acc: 0.128 Test Loss: 4.312 Test Acc: 0.128
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 1.4800000
	speed: 0.2106s/iter; left time: 141.3170s
Epoch: 26 cost time: 10.510720014572144
Epoch: 26, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.276 Vali Acc: 0.361 Test Loss: 2.276 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.9103353
	speed: 0.1883s/iter; left time: 97.3677s
Epoch: 27 cost time: 9.274431705474854
Epoch: 27, Steps: 154 | Train Loss: 1.271 Vali Loss: 2.564 Vali Acc: 0.347 Test Loss: 2.564 Test Acc: 0.347
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.6700249
	speed: 0.2112s/iter; left time: 76.6524s
Epoch: 28 cost time: 8.994065046310425
Epoch: 28, Steps: 154 | Train Loss: 1.267 Vali Loss: 2.595 Vali Acc: 0.379 Test Loss: 2.595 Test Acc: 0.379
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.4503939
	speed: 0.1977s/iter; left time: 41.3274s
Epoch: 29 cost time: 9.450048923492432
Epoch: 29, Steps: 154 | Train Loss: 1.234 Vali Loss: 2.360 Vali Acc: 0.416 Test Loss: 2.360 Test Acc: 0.416
Validation loss decreased (-0.385213 --> -0.415629).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.6862646
	speed: 0.1501s/iter; left time: 8.2574s
Epoch: 30 cost time: 7.265251159667969
Epoch: 30, Steps: 154 | Train Loss: 1.232 Vali Loss: 2.347 Vali Acc: 0.376 Test Loss: 2.347 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.41565287915652877
model parameter : 444254
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1467648
	speed: 0.0609s/iter; left time: 275.2446s
Epoch: 1 cost time: 8.724448204040527
Epoch: 1, Steps: 154 | Train Loss: 2.265 Vali Loss: 2.122 Vali Acc: 0.315 Test Loss: 2.122 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8555237
	speed: 0.1437s/iter; left time: 627.5354s
Epoch: 2 cost time: 5.669395446777344
Epoch: 2, Steps: 154 | Train Loss: 2.074 Vali Loss: 2.121 Vali Acc: 0.317 Test Loss: 2.121 Test Acc: 0.317
Validation loss decreased (-0.315469 --> -0.317092).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2725081
	speed: 0.1413s/iter; left time: 595.1585s
Epoch: 3 cost time: 8.069790601730347
Epoch: 3, Steps: 154 | Train Loss: 1.978 Vali Loss: 2.060 Vali Acc: 0.323 Test Loss: 2.060 Test Acc: 0.323
Validation loss decreased (-0.317092 --> -0.323175).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2087226
	speed: 0.1718s/iter; left time: 697.3156s
Epoch: 4 cost time: 7.395559787750244
Epoch: 4, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.109 Vali Acc: 0.333 Test Loss: 2.109 Test Acc: 0.333
Validation loss decreased (-0.323175 --> -0.332907).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3830892
	speed: 0.1938s/iter; left time: 756.6293s
Epoch: 5 cost time: 8.819655418395996
Epoch: 5, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.026 Vali Acc: 0.342 Test Loss: 2.026 Test Acc: 0.342
Validation loss decreased (-0.332907 --> -0.342234).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6224605
	speed: 0.1734s/iter; left time: 650.4187s
Epoch: 6 cost time: 9.097316980361938
Epoch: 6, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.238 Vali Acc: 0.335 Test Loss: 2.238 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0787745
	speed: 0.1856s/iter; left time: 667.4980s
Epoch: 7 cost time: 7.252171516418457
Epoch: 7, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.050 Vali Acc: 0.352 Test Loss: 2.050 Test Acc: 0.352
Validation loss decreased (-0.342234 --> -0.352372).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1844137
	speed: 0.1762s/iter; left time: 606.7478s
Epoch: 8 cost time: 8.275777101516724
Epoch: 8, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.095 Vali Acc: 0.368 Test Loss: 2.095 Test Acc: 0.368
Validation loss decreased (-0.352372 --> -0.368187).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1939158
	speed: 0.1263s/iter; left time: 415.3032s
Epoch: 9 cost time: 5.290238618850708
Epoch: 9, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.099 Vali Acc: 0.352 Test Loss: 2.099 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2148628
	speed: 0.1423s/iter; left time: 446.0444s
Epoch: 10 cost time: 7.1826441287994385
Epoch: 10, Steps: 154 | Train Loss: 1.607 Vali Loss: 2.049 Vali Acc: 0.376 Test Loss: 2.049 Test Acc: 0.376
Validation loss decreased (-0.368187 --> -0.375892).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2180673
	speed: 0.1282s/iter; left time: 382.2537s
Epoch: 11 cost time: 5.417048931121826
Epoch: 11, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.349 Vali Acc: 0.118 Test Loss: 2.349 Test Acc: 0.118
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8086491
	speed: 0.1465s/iter; left time: 414.2912s
Epoch: 12 cost time: 6.248167276382446
Epoch: 12, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.209 Vali Acc: 0.380 Test Loss: 2.209 Test Acc: 0.380
Validation loss decreased (-0.375892 --> -0.379945).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.6180778
	speed: 0.1297s/iter; left time: 346.5629s
Epoch: 13 cost time: 6.365914344787598
Epoch: 13, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.033 Vali Acc: 0.365 Test Loss: 2.033 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.7902203
	speed: 0.1626s/iter; left time: 409.5024s
Epoch: 14 cost time: 7.6190855503082275
Epoch: 14, Steps: 154 | Train Loss: 1.498 Vali Loss: 3.063 Vali Acc: 0.084 Test Loss: 3.063 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.3138703
	speed: 0.1785s/iter; left time: 422.1984s
Epoch: 15 cost time: 9.410406351089478
Epoch: 15, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.559 Vali Acc: 0.178 Test Loss: 2.559 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.0962784
	speed: 0.1775s/iter; left time: 392.4764s
Epoch: 16 cost time: 7.821761131286621
Epoch: 16, Steps: 154 | Train Loss: 1.470 Vali Loss: 2.211 Vali Acc: 0.376 Test Loss: 2.211 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.2855864
	speed: 0.1904s/iter; left time: 391.7235s
Epoch: 17 cost time: 8.67941951751709
Epoch: 17, Steps: 154 | Train Loss: 1.471 Vali Loss: 2.784 Vali Acc: 0.269 Test Loss: 2.784 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.8587489
	speed: 0.1655s/iter; left time: 314.8775s
Epoch: 18 cost time: 8.329404592514038
Epoch: 18, Steps: 154 | Train Loss: 1.432 Vali Loss: 3.805 Vali Acc: 0.073 Test Loss: 3.805 Test Acc: 0.073
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4194882
	speed: 0.1670s/iter; left time: 292.1536s
Epoch: 19 cost time: 5.673559188842773
Epoch: 19, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.466 Vali Acc: 0.207 Test Loss: 2.466 Test Acc: 0.207
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.1615537
	speed: 0.1343s/iter; left time: 214.1407s
Epoch: 20 cost time: 7.106988906860352
Epoch: 20, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.391 Vali Acc: 0.363 Test Loss: 2.391 Test Acc: 0.363
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.3663924
	speed: 0.1417s/iter; left time: 204.1424s
Epoch: 21 cost time: 5.817397117614746
Epoch: 21, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.366 Vali Acc: 0.367 Test Loss: 2.366 Test Acc: 0.367
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.2697114
	speed: 0.1351s/iter; left time: 173.8855s
Epoch: 22 cost time: 6.719427824020386
Epoch: 22, Steps: 154 | Train Loss: 1.377 Vali Loss: 2.123 Vali Acc: 0.387 Test Loss: 2.123 Test Acc: 0.387
Validation loss decreased (-0.379945 --> -0.386840).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.3599838
	speed: 0.1331s/iter; left time: 150.7856s
Epoch: 23 cost time: 5.9181883335113525
Epoch: 23, Steps: 154 | Train Loss: 1.351 Vali Loss: 5.554 Vali Acc: 0.087 Test Loss: 5.554 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.7896160
	speed: 0.1523s/iter; left time: 149.0779s
Epoch: 24 cost time: 6.987579107284546
Epoch: 24, Steps: 154 | Train Loss: 1.321 Vali Loss: 3.655 Vali Acc: 0.088 Test Loss: 3.655 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.1423098
	speed: 0.1607s/iter; left time: 132.6120s
Epoch: 25 cost time: 8.196476936340332
Epoch: 25, Steps: 154 | Train Loss: 1.310 Vali Loss: 3.525 Vali Acc: 0.306 Test Loss: 3.525 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.3946258
	speed: 0.1949s/iter; left time: 130.7482s
Epoch: 26 cost time: 7.993934154510498
Epoch: 26, Steps: 154 | Train Loss: 1.304 Vali Loss: 3.931 Vali Acc: 0.103 Test Loss: 3.931 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.4428054
	speed: 0.1672s/iter; left time: 86.4183s
Epoch: 27 cost time: 7.700720548629761
Epoch: 27, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.425 Vali Acc: 0.210 Test Loss: 3.425 Test Acc: 0.210
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.8298690
	speed: 0.1261s/iter; left time: 45.7600s
Epoch: 28 cost time: 6.086851596832275
Epoch: 28, Steps: 154 | Train Loss: 1.268 Vali Loss: 4.355 Vali Acc: 0.090 Test Loss: 4.355 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.8427849
	speed: 0.2123s/iter; left time: 44.3671s
Epoch: 29 cost time: 8.378154993057251
Epoch: 29, Steps: 154 | Train Loss: 1.249 Vali Loss: 3.426 Vali Acc: 0.363 Test Loss: 3.426 Test Acc: 0.363
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.5231212
	speed: 0.1439s/iter; left time: 7.9170s
Epoch: 30 cost time: 7.0087385177612305
Epoch: 30, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.133 Vali Acc: 0.356 Test Loss: 3.133 Test Acc: 0.356
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38686131386861317
model parameter : 133742
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9867971
	speed: 0.1120s/iter; left time: 506.2999s
Epoch: 1 cost time: 16.38416337966919
Epoch: 1, Steps: 154 | Train Loss: 2.241 Vali Loss: 2.123 Vali Acc: 0.316 Test Loss: 2.123 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7565032
	speed: 0.2746s/iter; left time: 1199.0818s
Epoch: 2 cost time: 14.060853958129883
Epoch: 2, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.122 Vali Acc: 0.326 Test Loss: 2.122 Test Acc: 0.326
Validation loss decreased (-0.316280 --> -0.326013).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8605952
	speed: 0.2753s/iter; left time: 1159.7535s
Epoch: 3 cost time: 14.87660813331604
Epoch: 3, Steps: 154 | Train Loss: 1.991 Vali Loss: 2.041 Vali Acc: 0.336 Test Loss: 2.041 Test Acc: 0.336
Validation loss decreased (-0.326013 --> -0.336152).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8828619
	speed: 0.3286s/iter; left time: 1333.8916s
Epoch: 4 cost time: 15.62982726097107
Epoch: 4, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.043 Vali Acc: 0.349 Test Loss: 2.043 Test Acc: 0.349
Validation loss decreased (-0.336152 --> -0.349128).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0691428
	speed: 0.3300s/iter; left time: 1288.5074s
Epoch: 5 cost time: 15.649409055709839
Epoch: 5, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.111 Vali Acc: 0.355 Test Loss: 2.111 Test Acc: 0.355
Validation loss decreased (-0.349128 --> -0.355210).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6460279
	speed: 0.3201s/iter; left time: 1200.7515s
Epoch: 6 cost time: 16.41289186477661
Epoch: 6, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.241 Vali Acc: 0.192 Test Loss: 2.241 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6143637
	speed: 0.2880s/iter; left time: 1035.8777s
Epoch: 7 cost time: 13.928030490875244
Epoch: 7, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.183 Vali Acc: 0.371 Test Loss: 2.183 Test Acc: 0.371
Validation loss decreased (-0.355210 --> -0.370619).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.8909110
	speed: 0.2741s/iter; left time: 943.6600s
Epoch: 8 cost time: 14.107599020004272
Epoch: 8, Steps: 154 | Train Loss: 1.633 Vali Loss: 2.259 Vali Acc: 0.380 Test Loss: 2.259 Test Acc: 0.380
Validation loss decreased (-0.370619 --> -0.379945).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2115827
	speed: 0.2732s/iter; left time: 898.6361s
Epoch: 9 cost time: 13.144428968429565
Epoch: 9, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.223 Vali Acc: 0.379 Test Loss: 2.223 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4180752
	speed: 0.2805s/iter; left time: 879.3242s
Epoch: 10 cost time: 12.740238666534424
Epoch: 10, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.543 Vali Acc: 0.209 Test Loss: 2.543 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2651089
	speed: 0.3003s/iter; left time: 895.2112s
Epoch: 11 cost time: 15.273927688598633
Epoch: 11, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.674 Vali Acc: 0.119 Test Loss: 2.674 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3226725
	speed: 0.3229s/iter; left time: 912.9388s
Epoch: 12 cost time: 15.791483163833618
Epoch: 12, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.977 Vali Acc: 0.117 Test Loss: 2.977 Test Acc: 0.117
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2177818
	speed: 0.3150s/iter; left time: 841.9625s
Epoch: 13 cost time: 16.94548463821411
Epoch: 13, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.455 Vali Acc: 0.207 Test Loss: 2.455 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.9436811
	speed: 0.3162s/iter; left time: 796.5785s
Epoch: 14 cost time: 14.690043449401855
Epoch: 14, Steps: 154 | Train Loss: 1.451 Vali Loss: 2.761 Vali Acc: 0.143 Test Loss: 2.761 Test Acc: 0.143
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.3784237
	speed: 0.2741s/iter; left time: 648.3031s
Epoch: 15 cost time: 13.030743837356567
Epoch: 15, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.971 Vali Acc: 0.120 Test Loss: 2.971 Test Acc: 0.120
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.9895234
	speed: 0.2803s/iter; left time: 619.6513s
Epoch: 16 cost time: 13.136795282363892
Epoch: 16, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.022 Vali Acc: 0.198 Test Loss: 3.022 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0045757
	speed: 0.2743s/iter; left time: 564.3092s
Epoch: 17 cost time: 12.84624457359314
Epoch: 17, Steps: 154 | Train Loss: 1.386 Vali Loss: 3.370 Vali Acc: 0.198 Test Loss: 3.370 Test Acc: 0.198
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.4534642
	speed: 0.2790s/iter; left time: 531.0242s
Epoch: 18 cost time: 14.647438764572144
Epoch: 18, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.283 Vali Acc: 0.180 Test Loss: 3.283 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 224318
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0630457
	speed: 0.0976s/iter; left time: 441.4236s
Epoch: 1 cost time: 14.357945680618286
Epoch: 1, Steps: 154 | Train Loss: 2.288 Vali Loss: 2.128 Vali Acc: 0.315 Test Loss: 2.128 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0437105
	speed: 0.2976s/iter; left time: 1299.4790s
Epoch: 2 cost time: 13.725293636322021
Epoch: 2, Steps: 154 | Train Loss: 2.066 Vali Loss: 2.113 Vali Acc: 0.319 Test Loss: 2.113 Test Acc: 0.319
Validation loss decreased (-0.315064 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9829239
	speed: 0.2858s/iter; left time: 1203.9463s
Epoch: 3 cost time: 14.77272891998291
Epoch: 3, Steps: 154 | Train Loss: 1.986 Vali Loss: 2.079 Vali Acc: 0.328 Test Loss: 2.079 Test Acc: 0.328
Validation loss decreased (-0.319119 --> -0.328446).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6768328
	speed: 0.2290s/iter; left time: 929.4436s
Epoch: 4 cost time: 10.856517314910889
Epoch: 4, Steps: 154 | Train Loss: 1.883 Vali Loss: 2.053 Vali Acc: 0.333 Test Loss: 2.053 Test Acc: 0.333
Validation loss decreased (-0.328446 --> -0.332907).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6925004
	speed: 0.1856s/iter; left time: 724.9058s
Epoch: 5 cost time: 8.68187403678894
Epoch: 5, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.060 Vali Acc: 0.343 Test Loss: 2.060 Test Acc: 0.343
Validation loss decreased (-0.332907 --> -0.342640).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4192967
	speed: 0.2010s/iter; left time: 753.8148s
Epoch: 6 cost time: 9.826205015182495
Epoch: 6, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.095 Vali Acc: 0.360 Test Loss: 2.095 Test Acc: 0.360
Validation loss decreased (-0.342640 --> -0.359671).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5731747
	speed: 0.2180s/iter; left time: 784.2167s
Epoch: 7 cost time: 11.319959163665771
Epoch: 7, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.055 Vali Acc: 0.344 Test Loss: 2.055 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0029790
	speed: 0.2441s/iter; left time: 840.5555s
Epoch: 8 cost time: 11.343278169631958
Epoch: 8, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.338 Vali Acc: 0.086 Test Loss: 2.338 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9452037
	speed: 0.2460s/iter; left time: 809.0979s
Epoch: 9 cost time: 11.03742265701294
Epoch: 9, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.383 Vali Acc: 0.181 Test Loss: 2.383 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.7243944
	speed: 0.2590s/iter; left time: 812.0450s
Epoch: 10 cost time: 11.483970165252686
Epoch: 10, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.078 Vali Acc: 0.362 Test Loss: 2.078 Test Acc: 0.362
Validation loss decreased (-0.359671 --> -0.362104).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5336134
	speed: 0.2188s/iter; left time: 652.1753s
Epoch: 11 cost time: 9.552331447601318
Epoch: 11, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.329 Vali Acc: 0.208 Test Loss: 2.329 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4879436
	speed: 0.2097s/iter; left time: 592.7881s
Epoch: 12 cost time: 9.387423276901245
Epoch: 12, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.126 Vali Acc: 0.350 Test Loss: 2.126 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5515772
	speed: 0.2051s/iter; left time: 548.3051s
Epoch: 13 cost time: 9.67449164390564
Epoch: 13, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.837 Vali Acc: 0.088 Test Loss: 2.837 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4679670
	speed: 0.2108s/iter; left time: 531.1123s
Epoch: 14 cost time: 10.403021097183228
Epoch: 14, Steps: 154 | Train Loss: 1.494 Vali Loss: 4.040 Vali Acc: 0.109 Test Loss: 4.040 Test Acc: 0.109
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.0622790
	speed: 0.2448s/iter; left time: 578.9699s
Epoch: 15 cost time: 11.090950012207031
Epoch: 15, Steps: 154 | Train Loss: 1.467 Vali Loss: 2.181 Vali Acc: 0.182 Test Loss: 2.181 Test Acc: 0.182
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2771175
	speed: 0.2473s/iter; left time: 546.7863s
Epoch: 16 cost time: 11.004821300506592
Epoch: 16, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.025 Vali Acc: 0.122 Test Loss: 3.025 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.8434812
	speed: 0.2523s/iter; left time: 518.9026s
Epoch: 17 cost time: 11.141791820526123
Epoch: 17, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.755 Vali Acc: 0.111 Test Loss: 2.755 Test Acc: 0.111
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.9418240
	speed: 0.2206s/iter; left time: 419.8383s
Epoch: 18 cost time: 9.394986629486084
Epoch: 18, Steps: 154 | Train Loss: 1.414 Vali Loss: 5.004 Vali Acc: 0.115 Test Loss: 5.004 Test Acc: 0.115
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9127991
	speed: 0.2069s/iter; left time: 361.7820s
Epoch: 19 cost time: 9.920250415802002
Epoch: 19, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.978 Vali Acc: 0.114 Test Loss: 3.978 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2607502
	speed: 0.2075s/iter; left time: 330.9077s
Epoch: 20 cost time: 9.488410711288452
Epoch: 20, Steps: 154 | Train Loss: 1.389 Vali Loss: 4.749 Vali Acc: 0.093 Test Loss: 4.749 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36212489862124897
model parameter : 69038
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9859629
	speed: 0.0763s/iter; left time: 344.9559s
Epoch: 1 cost time: 11.022985219955444
Epoch: 1, Steps: 154 | Train Loss: 2.244 Vali Loss: 2.124 Vali Acc: 0.316 Test Loss: 2.124 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7513795
	speed: 0.2426s/iter; left time: 1059.4836s
Epoch: 2 cost time: 12.834710836410522
Epoch: 2, Steps: 154 | Train Loss: 2.060 Vali Loss: 2.123 Vali Acc: 0.326 Test Loss: 2.123 Test Acc: 0.326
Validation loss decreased (-0.315875 --> -0.325607).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8617704
	speed: 0.2594s/iter; left time: 1093.0432s
Epoch: 3 cost time: 13.744150876998901
Epoch: 3, Steps: 154 | Train Loss: 1.992 Vali Loss: 2.027 Vali Acc: 0.342 Test Loss: 2.027 Test Acc: 0.342
Validation loss decreased (-0.325607 --> -0.342234).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8447945
	speed: 0.2679s/iter; left time: 1087.4151s
Epoch: 4 cost time: 12.986878871917725
Epoch: 4, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.063 Vali Acc: 0.345 Test Loss: 2.063 Test Acc: 0.345
Validation loss decreased (-0.342234 --> -0.345073).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1172616
	speed: 0.2277s/iter; left time: 889.1812s
Epoch: 5 cost time: 12.221547603607178
Epoch: 5, Steps: 154 | Train Loss: 1.809 Vali Loss: 2.111 Vali Acc: 0.286 Test Loss: 2.111 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6749117
	speed: 0.2231s/iter; left time: 836.7675s
Epoch: 6 cost time: 11.969840049743652
Epoch: 6, Steps: 154 | Train Loss: 1.741 Vali Loss: 2.347 Vali Acc: 0.191 Test Loss: 2.347 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7218626
	speed: 0.2194s/iter; left time: 789.0196s
Epoch: 7 cost time: 11.834478616714478
Epoch: 7, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.155 Vali Acc: 0.367 Test Loss: 2.155 Test Acc: 0.367
Validation loss decreased (-0.345073 --> -0.366564).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7505939
	speed: 0.2260s/iter; left time: 778.2500s
Epoch: 8 cost time: 11.929335594177246
Epoch: 8, Steps: 154 | Train Loss: 1.636 Vali Loss: 2.299 Vali Acc: 0.376 Test Loss: 2.299 Test Acc: 0.376
Validation loss decreased (-0.366564 --> -0.375484).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1697975
	speed: 0.2264s/iter; left time: 744.6148s
Epoch: 9 cost time: 13.106921434402466
Epoch: 9, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.346 Vali Acc: 0.244 Test Loss: 2.346 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4599942
	speed: 0.2492s/iter; left time: 781.2593s
Epoch: 10 cost time: 12.81666350364685
Epoch: 10, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.453 Vali Acc: 0.194 Test Loss: 2.453 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.2787523
	speed: 0.2469s/iter; left time: 736.0622s
Epoch: 11 cost time: 12.08121109008789
Epoch: 11, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.528 Vali Acc: 0.110 Test Loss: 2.528 Test Acc: 0.110
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3553216
	speed: 0.2593s/iter; left time: 732.9865s
Epoch: 12 cost time: 12.354888916015625
Epoch: 12, Steps: 154 | Train Loss: 1.515 Vali Loss: 2.928 Vali Acc: 0.134 Test Loss: 2.928 Test Acc: 0.134
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2190642
	speed: 0.2504s/iter; left time: 669.3290s
Epoch: 13 cost time: 10.347132205963135
Epoch: 13, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.418 Vali Acc: 0.195 Test Loss: 2.418 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.9435670
	speed: 0.2119s/iter; left time: 533.7119s
Epoch: 14 cost time: 10.157430648803711
Epoch: 14, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.787 Vali Acc: 0.172 Test Loss: 2.787 Test Acc: 0.172
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.2825706
	speed: 0.2097s/iter; left time: 495.8719s
Epoch: 15 cost time: 10.027456045150757
Epoch: 15, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.748 Vali Acc: 0.133 Test Loss: 2.748 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 2.0422471
	speed: 0.2171s/iter; left time: 479.9728s
Epoch: 16 cost time: 10.469505310058594
Epoch: 16, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.396 Vali Acc: 0.082 Test Loss: 3.396 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0973966
	speed: 0.2164s/iter; left time: 445.0594s
Epoch: 17 cost time: 10.647893905639648
Epoch: 17, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.330 Vali Acc: 0.197 Test Loss: 3.330 Test Acc: 0.197
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.3938366
	speed: 0.2443s/iter; left time: 464.9260s
Epoch: 18 cost time: 11.940764427185059
Epoch: 18, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.240 Vali Acc: 0.144 Test Loss: 3.240 Test Acc: 0.144
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 224318
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0614445
	speed: 0.0821s/iter; left time: 371.3736s
Epoch: 1 cost time: 11.260509252548218
Epoch: 1, Steps: 154 | Train Loss: 2.290 Vali Loss: 2.124 Vali Acc: 0.315 Test Loss: 2.124 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0435700
	speed: 0.1890s/iter; left time: 825.4761s
Epoch: 2 cost time: 10.732160806655884
Epoch: 2, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.105 Vali Acc: 0.318 Test Loss: 2.105 Test Acc: 0.318
Validation loss decreased (-0.315064 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9580679
	speed: 0.1782s/iter; left time: 750.6264s
Epoch: 3 cost time: 8.538358449935913
Epoch: 3, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.090 Vali Acc: 0.328 Test Loss: 2.090 Test Acc: 0.328
Validation loss decreased (-0.318308 --> -0.328446).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7202454
	speed: 0.1606s/iter; left time: 651.7057s
Epoch: 4 cost time: 8.150808095932007
Epoch: 4, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.054 Vali Acc: 0.331 Test Loss: 2.054 Test Acc: 0.331
Validation loss decreased (-0.328446 --> -0.330880).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7114656
	speed: 0.1592s/iter; left time: 621.8620s
Epoch: 5 cost time: 7.802811145782471
Epoch: 5, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.041 Vali Acc: 0.349 Test Loss: 2.041 Test Acc: 0.349
Validation loss decreased (-0.330880 --> -0.348722).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5613085
	speed: 0.1666s/iter; left time: 624.7440s
Epoch: 6 cost time: 7.5609095096588135
Epoch: 6, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.077 Vali Acc: 0.354 Test Loss: 2.077 Test Acc: 0.354
Validation loss decreased (-0.348722 --> -0.353588).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5295846
	speed: 0.1624s/iter; left time: 584.0236s
Epoch: 7 cost time: 8.183035850524902
Epoch: 7, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.094 Vali Acc: 0.347 Test Loss: 2.094 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1261513
	speed: 0.1881s/iter; left time: 647.7761s
Epoch: 8 cost time: 8.978990316390991
Epoch: 8, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.248 Vali Acc: 0.141 Test Loss: 2.248 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9553044
	speed: 0.1930s/iter; left time: 634.8517s
Epoch: 9 cost time: 9.327572107315063
Epoch: 9, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.076 Vali Acc: 0.362 Test Loss: 2.076 Test Acc: 0.362
Validation loss decreased (-0.353588 --> -0.362104).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7255688
	speed: 0.1948s/iter; left time: 610.7571s
Epoch: 10 cost time: 9.225452184677124
Epoch: 10, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.027 Vali Acc: 0.377 Test Loss: 2.027 Test Acc: 0.377
Validation loss decreased (-0.362104 --> -0.376703).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4997606
	speed: 0.1948s/iter; left time: 580.7307s
Epoch: 11 cost time: 9.789566993713379
Epoch: 11, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.760 Vali Acc: 0.093 Test Loss: 2.760 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5911711
	speed: 0.1626s/iter; left time: 459.7283s
Epoch: 12 cost time: 8.172712564468384
Epoch: 12, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.082 Vali Acc: 0.359 Test Loss: 2.082 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4749231
	speed: 0.1579s/iter; left time: 422.0163s
Epoch: 13 cost time: 8.128634691238403
Epoch: 13, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.611 Vali Acc: 0.101 Test Loss: 2.611 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.5915482
	speed: 0.1655s/iter; left time: 416.9640s
Epoch: 14 cost time: 8.323957681655884
Epoch: 14, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.832 Vali Acc: 0.124 Test Loss: 2.832 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1284348
	speed: 0.1529s/iter; left time: 361.6542s
Epoch: 15 cost time: 7.750201225280762
Epoch: 15, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.103 Vali Acc: 0.348 Test Loss: 2.103 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2433600
	speed: 0.1649s/iter; left time: 364.4952s
Epoch: 16 cost time: 9.453620672225952
Epoch: 16, Steps: 154 | Train Loss: 1.443 Vali Loss: 2.470 Vali Acc: 0.101 Test Loss: 2.470 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5535060
	speed: 0.1866s/iter; left time: 383.7560s
Epoch: 17 cost time: 9.219070672988892
Epoch: 17, Steps: 154 | Train Loss: 1.423 Vali Loss: 2.356 Vali Acc: 0.105 Test Loss: 2.356 Test Acc: 0.105
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.8337204
	speed: 0.1820s/iter; left time: 346.2766s
Epoch: 18 cost time: 8.462641477584839
Epoch: 18, Steps: 154 | Train Loss: 1.412 Vali Loss: 3.156 Vali Acc: 0.119 Test Loss: 3.156 Test Acc: 0.119
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.0726789
	speed: 0.2237s/iter; left time: 391.2762s
Epoch: 19 cost time: 10.735613107681274
Epoch: 19, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.856 Vali Acc: 0.124 Test Loss: 3.856 Test Acc: 0.124
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.3136461
	speed: 0.2080s/iter; left time: 331.7984s
Epoch: 20 cost time: 10.239501237869263
Epoch: 20, Steps: 154 | Train Loss: 1.383 Vali Loss: 4.620 Vali Acc: 0.087 Test Loss: 4.620 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 69038
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9937392
	speed: 0.0862s/iter; left time: 389.9067s
Epoch: 1 cost time: 12.210713386535645
Epoch: 1, Steps: 154 | Train Loss: 2.246 Vali Loss: 2.114 Vali Acc: 0.316 Test Loss: 2.114 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7390070
	speed: 0.1714s/iter; left time: 748.2982s
Epoch: 2 cost time: 8.961193323135376
Epoch: 2, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.106 Vali Acc: 0.324 Test Loss: 2.106 Test Acc: 0.324
Validation loss decreased (-0.315875 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8618718
	speed: 0.1879s/iter; left time: 791.8292s
Epoch: 3 cost time: 8.047541379928589
Epoch: 3, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.255 Vali Acc: 0.183 Test Loss: 2.255 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9158516
	speed: 0.1832s/iter; left time: 743.5971s
Epoch: 4 cost time: 12.246950387954712
Epoch: 4, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.025 Vali Acc: 0.352 Test Loss: 2.025 Test Acc: 0.352
Validation loss decreased (-0.324391 --> -0.352372).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0802588
	speed: 0.2229s/iter; left time: 870.2617s
Epoch: 5 cost time: 11.168376922607422
Epoch: 5, Steps: 154 | Train Loss: 1.822 Vali Loss: 1.953 Vali Acc: 0.373 Test Loss: 1.953 Test Acc: 0.373
Validation loss decreased (-0.352372 --> -0.373460).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8256334
	speed: 0.2371s/iter; left time: 889.3552s
Epoch: 6 cost time: 10.856909990310669
Epoch: 6, Steps: 154 | Train Loss: 1.760 Vali Loss: 2.144 Vali Acc: 0.369 Test Loss: 2.144 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7629070
	speed: 0.2197s/iter; left time: 790.1441s
Epoch: 7 cost time: 12.241127490997314
Epoch: 7, Steps: 154 | Train Loss: 1.749 Vali Loss: 2.091 Vali Acc: 0.363 Test Loss: 2.091 Test Acc: 0.363
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8966483
	speed: 0.2152s/iter; left time: 740.7963s
Epoch: 8 cost time: 9.87251329421997
Epoch: 8, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.116 Vali Acc: 0.369 Test Loss: 2.116 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2149529
	speed: 0.1934s/iter; left time: 635.9293s
Epoch: 9 cost time: 8.153939723968506
Epoch: 9, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.053 Vali Acc: 0.365 Test Loss: 2.053 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5728505
	speed: 0.1638s/iter; left time: 513.3823s
Epoch: 10 cost time: 9.04985523223877
Epoch: 10, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.467 Vali Acc: 0.106 Test Loss: 2.467 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4119198
	speed: 0.1798s/iter; left time: 535.8415s
Epoch: 11 cost time: 7.3460259437561035
Epoch: 11, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.323 Vali Acc: 0.191 Test Loss: 2.323 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.4887216
	speed: 0.1718s/iter; left time: 485.6742s
Epoch: 12 cost time: 9.387226581573486
Epoch: 12, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.162 Vali Acc: 0.399 Test Loss: 2.162 Test Acc: 0.399
Validation loss decreased (-0.373460 --> -0.398600).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5090404
	speed: 0.1692s/iter; left time: 452.1471s
Epoch: 13 cost time: 7.817947864532471
Epoch: 13, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.122 Vali Acc: 0.209 Test Loss: 2.122 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0841659
	speed: 0.2051s/iter; left time: 516.5780s
Epoch: 14 cost time: 11.36437439918518
Epoch: 14, Steps: 154 | Train Loss: 1.548 Vali Loss: 2.348 Vali Acc: 0.205 Test Loss: 2.348 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.5063088
	speed: 0.2096s/iter; left time: 495.6750s
Epoch: 15 cost time: 10.873553037643433
Epoch: 15, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.347 Vali Acc: 0.222 Test Loss: 2.347 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.9297789
	speed: 0.2242s/iter; left time: 495.7711s
Epoch: 16 cost time: 10.030413627624512
Epoch: 16, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.284 Vali Acc: 0.202 Test Loss: 2.284 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.1226721
	speed: 0.2282s/iter; left time: 469.3123s
Epoch: 17 cost time: 11.966462135314941
Epoch: 17, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.485 Vali Acc: 0.204 Test Loss: 2.485 Test Acc: 0.204
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.5782409
	speed: 0.2062s/iter; left time: 392.4229s
Epoch: 18 cost time: 9.986005067825317
Epoch: 18, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.440 Vali Acc: 0.209 Test Loss: 2.440 Test Acc: 0.209
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.4657640
	speed: 0.1855s/iter; left time: 324.4277s
Epoch: 19 cost time: 7.5123677253723145
Epoch: 19, Steps: 154 | Train Loss: 1.458 Vali Loss: 2.432 Vali Acc: 0.208 Test Loss: 2.432 Test Acc: 0.208
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.2088759
	speed: 0.1682s/iter; left time: 268.3313s
Epoch: 20 cost time: 9.131998777389526
Epoch: 20, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.353 Vali Acc: 0.219 Test Loss: 2.353 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.1987143
	speed: 0.1698s/iter; left time: 244.6307s
Epoch: 21 cost time: 7.507699966430664
Epoch: 21, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.162 Vali Acc: 0.390 Test Loss: 2.162 Test Acc: 0.390
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.3187772
	speed: 0.1728s/iter; left time: 222.3664s
Epoch: 22 cost time: 9.212613582611084
Epoch: 22, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.171 Vali Acc: 0.400 Test Loss: 2.171 Test Acc: 0.400
Validation loss decreased (-0.398600 --> -0.400222).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.4344922
	speed: 0.1681s/iter; left time: 190.5089s
Epoch: 23 cost time: 7.847335577011108
Epoch: 23, Steps: 154 | Train Loss: 1.370 Vali Loss: 3.110 Vali Acc: 0.209 Test Loss: 3.110 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.2835171
	speed: 0.2132s/iter; left time: 208.7374s
Epoch: 24 cost time: 10.351131916046143
Epoch: 24, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.450 Vali Acc: 0.283 Test Loss: 2.450 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.9939204
	speed: 0.2114s/iter; left time: 174.4171s
Epoch: 25 cost time: 11.81803035736084
Epoch: 25, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.278 Vali Acc: 0.131 Test Loss: 3.278 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.2523596
	speed: 0.2109s/iter; left time: 141.5316s
Epoch: 26 cost time: 9.461371898651123
Epoch: 26, Steps: 154 | Train Loss: 1.335 Vali Loss: 4.428 Vali Acc: 0.097 Test Loss: 4.428 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.2320957
	speed: 0.2243s/iter; left time: 115.9729s
Epoch: 27 cost time: 10.835772037506104
Epoch: 27, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.142 Vali Acc: 0.395 Test Loss: 2.142 Test Acc: 0.395
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.7060961
	speed: 0.2040s/iter; left time: 74.0343s
Epoch: 28 cost time: 9.597308874130249
Epoch: 28, Steps: 154 | Train Loss: 1.327 Vali Loss: 2.449 Vali Acc: 0.400 Test Loss: 2.449 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.9211060
	speed: 0.1759s/iter; left time: 36.7640s
Epoch: 29 cost time: 7.418148517608643
Epoch: 29, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.513 Vali Acc: 0.141 Test Loss: 3.513 Test Acc: 0.141
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.4126126
	speed: 0.1694s/iter; left time: 9.3163s
Epoch: 30 cost time: 9.100319385528564
Epoch: 30, Steps: 154 | Train Loss: 1.287 Vali Loss: 5.234 Vali Acc: 0.091 Test Loss: 5.234 Test Acc: 0.091
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4002433090024331
model parameter : 224318
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0614977
	speed: 0.0666s/iter; left time: 300.8868s
Epoch: 1 cost time: 9.471680879592896
Epoch: 1, Steps: 154 | Train Loss: 2.305 Vali Loss: 2.107 Vali Acc: 0.315 Test Loss: 2.107 Test Acc: 0.315
Validation loss decreased (inf --> -0.314659).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0301371
	speed: 0.1483s/iter; left time: 647.4678s
Epoch: 2 cost time: 6.414480924606323
Epoch: 2, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.099 Vali Acc: 0.317 Test Loss: 2.099 Test Acc: 0.317
Validation loss decreased (-0.314659 --> -0.317092).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9592295
	speed: 0.1582s/iter; left time: 666.5278s
Epoch: 3 cost time: 8.606339454650879
Epoch: 3, Steps: 154 | Train Loss: 2.021 Vali Loss: 2.118 Vali Acc: 0.326 Test Loss: 2.118 Test Acc: 0.326
Validation loss decreased (-0.317092 --> -0.326013).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8519186
	speed: 0.1493s/iter; left time: 606.0013s
Epoch: 4 cost time: 7.047905921936035
Epoch: 4, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.066 Vali Acc: 0.331 Test Loss: 2.066 Test Acc: 0.331
Validation loss decreased (-0.326013 --> -0.330880).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7670120
	speed: 0.1627s/iter; left time: 635.2573s
Epoch: 5 cost time: 7.269556522369385
Epoch: 5, Steps: 154 | Train Loss: 1.881 Vali Loss: 2.059 Vali Acc: 0.333 Test Loss: 2.059 Test Acc: 0.333
Validation loss decreased (-0.330880 --> -0.333313).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0048528
	speed: 0.1134s/iter; left time: 425.2367s
Epoch: 6 cost time: 5.957984209060669
Epoch: 6, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.013 Vali Acc: 0.346 Test Loss: 2.013 Test Acc: 0.346
Validation loss decreased (-0.333313 --> -0.346290).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4109110
	speed: 0.1235s/iter; left time: 444.1360s
Epoch: 7 cost time: 8.597937822341919
Epoch: 7, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.064 Vali Acc: 0.345 Test Loss: 2.064 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0565691
	speed: 0.2493s/iter; left time: 858.2577s
Epoch: 8 cost time: 11.896991968154907
Epoch: 8, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.177 Vali Acc: 0.193 Test Loss: 2.177 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7984761
	speed: 0.2564s/iter; left time: 843.4163s
Epoch: 9 cost time: 10.754627227783203
Epoch: 9, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.185 Vali Acc: 0.317 Test Loss: 2.185 Test Acc: 0.317
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.9054079
	speed: 0.2573s/iter; left time: 806.5237s
Epoch: 10 cost time: 12.666643142700195
Epoch: 10, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.094 Vali Acc: 0.366 Test Loss: 2.094 Test Acc: 0.366
Validation loss decreased (-0.346290 --> -0.366159).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7671536
	speed: 0.2447s/iter; left time: 729.4478s
Epoch: 11 cost time: 10.534544229507446
Epoch: 11, Steps: 154 | Train Loss: 1.641 Vali Loss: 2.186 Vali Acc: 0.249 Test Loss: 2.186 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7288324
	speed: 0.2581s/iter; left time: 729.5843s
Epoch: 12 cost time: 10.964891195297241
Epoch: 12, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.104 Vali Acc: 0.359 Test Loss: 2.104 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.4450854
	speed: 0.2418s/iter; left time: 646.3251s
Epoch: 13 cost time: 12.141082763671875
Epoch: 13, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.544 Vali Acc: 0.127 Test Loss: 2.544 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.5491562
	speed: 0.2606s/iter; left time: 656.3617s
Epoch: 14 cost time: 10.572323322296143
Epoch: 14, Steps: 154 | Train Loss: 1.596 Vali Loss: 2.387 Vali Acc: 0.191 Test Loss: 2.387 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1550699
	speed: 0.2533s/iter; left time: 599.1627s
Epoch: 15 cost time: 11.837796926498413
Epoch: 15, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.710 Vali Acc: 0.122 Test Loss: 2.710 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5046856
	speed: 0.2390s/iter; left time: 528.3589s
Epoch: 16 cost time: 9.949654579162598
Epoch: 16, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.414 Vali Acc: 0.350 Test Loss: 2.414 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.7931645
	speed: 0.2030s/iter; left time: 417.5817s
Epoch: 17 cost time: 8.456263303756714
Epoch: 17, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.408 Vali Acc: 0.381 Test Loss: 2.408 Test Acc: 0.381
Validation loss decreased (-0.366159 --> -0.380755).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.6025668
	speed: 0.2218s/iter; left time: 422.1237s
Epoch: 18 cost time: 9.403943300247192
Epoch: 18, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.243 Vali Acc: 0.377 Test Loss: 2.243 Test Acc: 0.377
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.0411724
	speed: 0.2245s/iter; left time: 392.6188s
Epoch: 19 cost time: 10.348309516906738
Epoch: 19, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.595 Vali Acc: 0.380 Test Loss: 2.595 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.3961135
	speed: 0.2175s/iter; left time: 346.9346s
Epoch: 20 cost time: 9.174840450286865
Epoch: 20, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.372 Vali Acc: 0.391 Test Loss: 2.372 Test Acc: 0.391
Validation loss decreased (-0.380755 --> -0.391298).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.8567930
	speed: 0.1905s/iter; left time: 274.4829s
Epoch: 21 cost time: 8.155371189117432
Epoch: 21, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.495 Vali Acc: 0.379 Test Loss: 2.495 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.4910660
	speed: 0.1940s/iter; left time: 249.6787s
Epoch: 22 cost time: 8.212439775466919
Epoch: 22, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.465 Vali Acc: 0.090 Test Loss: 3.465 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.5163047
	speed: 0.1893s/iter; left time: 214.4244s
Epoch: 23 cost time: 8.834138631820679
Epoch: 23, Steps: 154 | Train Loss: 1.435 Vali Loss: 5.089 Vali Acc: 0.068 Test Loss: 5.089 Test Acc: 0.068
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.2931037
	speed: 0.1935s/iter; left time: 189.3970s
Epoch: 24 cost time: 8.074973583221436
Epoch: 24, Steps: 154 | Train Loss: 1.427 Vali Loss: 3.514 Vali Acc: 0.094 Test Loss: 3.514 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.3619844
	speed: 0.2028s/iter; left time: 167.3384s
Epoch: 25 cost time: 8.361740350723267
Epoch: 25, Steps: 154 | Train Loss: 1.402 Vali Loss: 6.477 Vali Acc: 0.069 Test Loss: 6.477 Test Acc: 0.069
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 1.4012096
	speed: 0.1918s/iter; left time: 128.6832s
Epoch: 26 cost time: 8.661725759506226
Epoch: 26, Steps: 154 | Train Loss: 1.383 Vali Loss: 3.258 Vali Acc: 0.131 Test Loss: 3.258 Test Acc: 0.131
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 1.0009233
	speed: 0.1851s/iter; left time: 95.7042s
Epoch: 27 cost time: 8.208140850067139
Epoch: 27, Steps: 154 | Train Loss: 1.377 Vali Loss: 3.247 Vali Acc: 0.133 Test Loss: 3.247 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 1.4479803
	speed: 0.1930s/iter; left time: 70.0428s
Epoch: 28 cost time: 8.145413160324097
Epoch: 28, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.267 Vali Acc: 0.144 Test Loss: 3.267 Test Acc: 0.144
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 1.2729838
	speed: 0.1933s/iter; left time: 40.3983s
Epoch: 29 cost time: 8.746583938598633
Epoch: 29, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.810 Vali Acc: 0.376 Test Loss: 2.810 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 1.2452024
	speed: 0.1931s/iter; left time: 10.6186s
Epoch: 30 cost time: 8.894917964935303
Epoch: 30, Steps: 154 | Train Loss: 1.355 Vali Loss: 2.586 Vali Acc: 0.370 Test Loss: 2.586 Test Acc: 0.370
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3913219789132198
model parameter : 69038
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9229782
	speed: 0.5263s/iter; left time: 2379.2651s
Epoch: 1 cost time: 82.13870668411255
Epoch: 1, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.384 Vali Acc: 0.172 Test Loss: 2.384 Test Acc: 0.172
Validation loss decreased (inf --> -0.172320).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4047033
	speed: 1.4965s/iter; left time: 6535.2655s
Epoch: 2 cost time: 88.69370698928833
Epoch: 2, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.163 Vali Acc: 0.338 Test Loss: 2.163 Test Acc: 0.338
Validation loss decreased (-0.172320 --> -0.338178).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9398830
	speed: 1.5714s/iter; left time: 6620.2954s
Epoch: 3 cost time: 89.4454493522644
Epoch: 3, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.521 Vali Acc: 0.353 Test Loss: 2.521 Test Acc: 0.353
Validation loss decreased (-0.338178 --> -0.353178).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5966389
	speed: 1.5766s/iter; left time: 6399.5354s
Epoch: 4 cost time: 87.55074000358582
Epoch: 4, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.139 Vali Acc: 0.365 Test Loss: 2.139 Test Acc: 0.365
Validation loss decreased (-0.353178 --> -0.364942).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5907241
	speed: 1.4364s/iter; left time: 5609.1585s
Epoch: 5 cost time: 81.74307131767273
Epoch: 5, Steps: 154 | Train Loss: 1.564 Vali Loss: 3.103 Vali Acc: 0.187 Test Loss: 3.103 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2546232
	speed: 1.4031s/iter; left time: 5263.1464s
Epoch: 6 cost time: 80.33569097518921
Epoch: 6, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.428 Vali Acc: 0.230 Test Loss: 2.428 Test Acc: 0.230
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3192176
	speed: 1.3726s/iter; left time: 4937.3193s
Epoch: 7 cost time: 73.17896580696106
Epoch: 7, Steps: 154 | Train Loss: 1.435 Vali Loss: 2.609 Vali Acc: 0.387 Test Loss: 2.609 Test Acc: 0.387
Validation loss decreased (-0.364942 --> -0.387241).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7433321
	speed: 1.3773s/iter; left time: 4742.1467s
Epoch: 8 cost time: 82.62456774711609
Epoch: 8, Steps: 154 | Train Loss: 1.383 Vali Loss: 5.244 Vali Acc: 0.136 Test Loss: 5.244 Test Acc: 0.136
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6292202
	speed: 1.4461s/iter; left time: 4756.0638s
Epoch: 9 cost time: 82.31972789764404
Epoch: 9, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.830 Vali Acc: 0.380 Test Loss: 2.830 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3411390
	speed: 1.4355s/iter; left time: 4500.2872s
Epoch: 10 cost time: 82.1849992275238
Epoch: 10, Steps: 154 | Train Loss: 1.263 Vali Loss: 2.382 Vali Acc: 0.371 Test Loss: 2.382 Test Acc: 0.371
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2154071
	speed: 1.4130s/iter; left time: 4212.1706s
Epoch: 11 cost time: 76.19689273834229
Epoch: 11, Steps: 154 | Train Loss: 1.181 Vali Loss: 2.973 Vali Acc: 0.350 Test Loss: 2.973 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1812564
	speed: 1.2732s/iter; left time: 3599.3823s
Epoch: 12 cost time: 76.88013029098511
Epoch: 12, Steps: 154 | Train Loss: 1.139 Vali Loss: 2.870 Vali Acc: 0.392 Test Loss: 2.870 Test Acc: 0.392
Validation loss decreased (-0.387241 --> -0.391699).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.5687766
	speed: 1.3603s/iter; left time: 3635.9962s
Epoch: 13 cost time: 77.40975904464722
Epoch: 13, Steps: 154 | Train Loss: 1.094 Vali Loss: 6.775 Vali Acc: 0.130 Test Loss: 6.775 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.7639320
	speed: 1.3533s/iter; left time: 3408.9042s
Epoch: 14 cost time: 76.81387782096863
Epoch: 14, Steps: 154 | Train Loss: 1.039 Vali Loss: 3.800 Vali Acc: 0.165 Test Loss: 3.800 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1720043
	speed: 1.4578s/iter; left time: 3447.5797s
Epoch: 15 cost time: 84.68771815299988
Epoch: 15, Steps: 154 | Train Loss: 0.989 Vali Loss: 5.856 Vali Acc: 0.113 Test Loss: 5.856 Test Acc: 0.113
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8168474
	speed: 1.4759s/iter; left time: 3263.2805s
Epoch: 16 cost time: 84.26165008544922
Epoch: 16, Steps: 154 | Train Loss: 0.959 Vali Loss: 4.842 Vali Acc: 0.154 Test Loss: 4.842 Test Acc: 0.154
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9614342
	speed: 1.4815s/iter; left time: 3047.4450s
Epoch: 17 cost time: 84.47118949890137
Epoch: 17, Steps: 154 | Train Loss: 0.915 Vali Loss: 4.585 Vali Acc: 0.214 Test Loss: 4.585 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1278886
	speed: 1.3566s/iter; left time: 2581.7005s
Epoch: 18 cost time: 71.46502637863159
Epoch: 18, Steps: 154 | Train Loss: 0.883 Vali Loss: 4.062 Vali Acc: 0.109 Test Loss: 4.062 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.8489844
	speed: 1.2608s/iter; left time: 2205.1694s
Epoch: 19 cost time: 71.98910570144653
Epoch: 19, Steps: 154 | Train Loss: 0.834 Vali Loss: 5.124 Vali Acc: 0.114 Test Loss: 5.124 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.6910838
	speed: 1.2541s/iter; left time: 2000.2725s
Epoch: 20 cost time: 71.47795701026917
Epoch: 20, Steps: 154 | Train Loss: 0.821 Vali Loss: 4.012 Vali Acc: 0.118 Test Loss: 4.012 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.6058460
	speed: 1.2499s/iter; left time: 1801.0573s
Epoch: 21 cost time: 74.5455014705658
Epoch: 21, Steps: 154 | Train Loss: 0.772 Vali Loss: 4.677 Vali Acc: 0.112 Test Loss: 4.677 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.7810017
	speed: 1.4933s/iter; left time: 1921.8623s
Epoch: 22 cost time: 89.5370032787323
Epoch: 22, Steps: 154 | Train Loss: 0.726 Vali Loss: 3.597 Vali Acc: 0.264 Test Loss: 3.597 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 37558798
model size : 145.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3545411
	speed: 0.2017s/iter; left time: 911.7302s
Epoch: 1 cost time: 30.107275009155273
Epoch: 1, Steps: 154 | Train Loss: 2.071 Vali Loss: 2.204 Vali Acc: 0.333 Test Loss: 2.204 Test Acc: 0.333
Validation loss decreased (inf --> -0.333311).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5326999
	speed: 0.5555s/iter; left time: 2425.9114s
Epoch: 2 cost time: 28.64154362678528
Epoch: 2, Steps: 154 | Train Loss: 1.847 Vali Loss: 2.492 Vali Acc: 0.348 Test Loss: 2.492 Test Acc: 0.348
Validation loss decreased (-0.333311 --> -0.347907).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1803746
	speed: 0.5562s/iter; left time: 2343.2820s
Epoch: 3 cost time: 28.74099040031433
Epoch: 3, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.237 Vali Acc: 0.365 Test Loss: 2.237 Test Acc: 0.365
Validation loss decreased (-0.347907 --> -0.364536).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6697865
	speed: 0.5490s/iter; left time: 2228.2803s
Epoch: 4 cost time: 26.49752116203308
Epoch: 4, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.467 Vali Acc: 0.207 Test Loss: 2.467 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6573995
	speed: 0.4926s/iter; left time: 1923.4562s
Epoch: 5 cost time: 25.360377550125122
Epoch: 5, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.899 Vali Acc: 0.201 Test Loss: 2.899 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5994992
	speed: 0.4932s/iter; left time: 1850.0852s
Epoch: 6 cost time: 25.150041580200195
Epoch: 6, Steps: 154 | Train Loss: 1.456 Vali Loss: 4.086 Vali Acc: 0.114 Test Loss: 4.086 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.7662823
	speed: 0.4892s/iter; left time: 1759.6863s
Epoch: 7 cost time: 25.283682107925415
Epoch: 7, Steps: 154 | Train Loss: 1.409 Vali Loss: 4.405 Vali Acc: 0.121 Test Loss: 4.405 Test Acc: 0.121
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.0939678
	speed: 0.4916s/iter; left time: 1692.5987s
Epoch: 8 cost time: 25.191562175750732
Epoch: 8, Steps: 154 | Train Loss: 1.321 Vali Loss: 2.286 Vali Acc: 0.359 Test Loss: 2.286 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.4607527
	speed: 0.4922s/iter; left time: 1618.8349s
Epoch: 9 cost time: 25.22639298439026
Epoch: 9, Steps: 154 | Train Loss: 1.253 Vali Loss: 5.775 Vali Acc: 0.081 Test Loss: 5.775 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.3829635
	speed: 0.4942s/iter; left time: 1549.3249s
Epoch: 10 cost time: 25.26041865348816
Epoch: 10, Steps: 154 | Train Loss: 1.179 Vali Loss: 4.517 Vali Acc: 0.097 Test Loss: 4.517 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.6911708
	speed: 0.4946s/iter; left time: 1474.4154s
Epoch: 11 cost time: 25.282084941864014
Epoch: 11, Steps: 154 | Train Loss: 1.100 Vali Loss: 4.208 Vali Acc: 0.177 Test Loss: 4.208 Test Acc: 0.177
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.6946656
	speed: 0.4934s/iter; left time: 1394.8498s
Epoch: 12 cost time: 25.259440422058105
Epoch: 12, Steps: 154 | Train Loss: 1.051 Vali Loss: 5.505 Vali Acc: 0.190 Test Loss: 5.505 Test Acc: 0.190
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7555059
	speed: 0.5204s/iter; left time: 1391.0272s
Epoch: 13 cost time: 28.304505586624146
Epoch: 13, Steps: 154 | Train Loss: 1.002 Vali Loss: 6.371 Vali Acc: 0.103 Test Loss: 6.371 Test Acc: 0.103
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36455798864557987
model parameter : 11080718
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9183512
	speed: 0.4151s/iter; left time: 1876.7658s
Epoch: 1 cost time: 62.07899284362793
Epoch: 1, Steps: 154 | Train Loss: 2.064 Vali Loss: 2.300 Vali Acc: 0.174 Test Loss: 2.300 Test Acc: 0.174
Validation loss decreased (inf --> -0.173537).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5164783
	speed: 0.9855s/iter; left time: 4303.8853s
Epoch: 2 cost time: 56.906410932540894
Epoch: 2, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.062 Vali Acc: 0.371 Test Loss: 2.062 Test Acc: 0.371
Validation loss decreased (-0.173537 --> -0.371431).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9788002
	speed: 1.0059s/iter; left time: 4237.8500s
Epoch: 3 cost time: 56.073110580444336
Epoch: 3, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.776 Vali Acc: 0.178 Test Loss: 2.776 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5054022
	speed: 0.9792s/iter; left time: 3974.5955s
Epoch: 4 cost time: 56.347439765930176
Epoch: 4, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.215 Vali Acc: 0.350 Test Loss: 2.215 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.4257379
	speed: 0.9035s/iter; left time: 3528.1191s
Epoch: 5 cost time: 51.31387543678284
Epoch: 5, Steps: 154 | Train Loss: 1.586 Vali Loss: 4.113 Vali Acc: 0.143 Test Loss: 4.113 Test Acc: 0.143
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5447487
	speed: 0.8740s/iter; left time: 3278.4916s
Epoch: 6 cost time: 51.45718002319336
Epoch: 6, Steps: 154 | Train Loss: 1.522 Vali Loss: 2.650 Vali Acc: 0.185 Test Loss: 2.650 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 1.1652137
	speed: 0.8740s/iter; left time: 3143.8961s
Epoch: 7 cost time: 51.40362358093262
Epoch: 7, Steps: 154 | Train Loss: 1.449 Vali Loss: 2.521 Vali Acc: 0.376 Test Loss: 2.521 Test Acc: 0.376
Validation loss decreased (-0.371431 --> -0.375887).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6983138
	speed: 0.8910s/iter; left time: 3067.8259s
Epoch: 8 cost time: 48.00846791267395
Epoch: 8, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.632 Vali Acc: 0.384 Test Loss: 2.632 Test Acc: 0.384
Validation loss decreased (-0.375887 --> -0.384402).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1863358
	speed: 0.9261s/iter; left time: 3045.7878s
Epoch: 9 cost time: 55.25050187110901
Epoch: 9, Steps: 154 | Train Loss: 1.331 Vali Loss: 3.239 Vali Acc: 0.376 Test Loss: 3.239 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3717105
	speed: 1.0267s/iter; left time: 3218.6220s
Epoch: 10 cost time: 60.31860089302063
Epoch: 10, Steps: 154 | Train Loss: 1.297 Vali Loss: 4.481 Vali Acc: 0.116 Test Loss: 4.481 Test Acc: 0.116
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.4019176
	speed: 1.0325s/iter; left time: 3077.9127s
Epoch: 11 cost time: 60.12505888938904
Epoch: 11, Steps: 154 | Train Loss: 1.220 Vali Loss: 3.953 Vali Acc: 0.090 Test Loss: 3.953 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.1480235
	speed: 1.0382s/iter; left time: 2935.0523s
Epoch: 12 cost time: 60.029884576797485
Epoch: 12, Steps: 154 | Train Loss: 1.161 Vali Loss: 3.255 Vali Acc: 0.368 Test Loss: 3.255 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3124151
	speed: 1.0439s/iter; left time: 2790.3275s
Epoch: 13 cost time: 59.639875173568726
Epoch: 13, Steps: 154 | Train Loss: 1.169 Vali Loss: 2.924 Vali Acc: 0.376 Test Loss: 2.924 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.9192067
	speed: 1.0159s/iter; left time: 2558.9635s
Epoch: 14 cost time: 54.991328716278076
Epoch: 14, Steps: 154 | Train Loss: 1.056 Vali Loss: 4.794 Vali Acc: 0.124 Test Loss: 4.794 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.0225127
	speed: 0.9374s/iter; left time: 2217.0430s
Epoch: 15 cost time: 53.86510252952576
Epoch: 15, Steps: 154 | Train Loss: 1.027 Vali Loss: 4.092 Vali Acc: 0.299 Test Loss: 4.092 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.8986087
	speed: 0.9290s/iter; left time: 2054.1239s
Epoch: 16 cost time: 53.58917498588562
Epoch: 16, Steps: 154 | Train Loss: 1.049 Vali Loss: 3.188 Vali Acc: 0.191 Test Loss: 3.188 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.8916388
	speed: 0.9304s/iter; left time: 1913.8538s
Epoch: 17 cost time: 54.11610269546509
Epoch: 17, Steps: 154 | Train Loss: 0.974 Vali Loss: 3.618 Vali Acc: 0.203 Test Loss: 3.618 Test Acc: 0.203
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.0677415
	speed: 0.9327s/iter; left time: 1774.8398s
Epoch: 18 cost time: 54.030784606933594
Epoch: 18, Steps: 154 | Train Loss: 0.939 Vali Loss: 2.976 Vali Acc: 0.102 Test Loss: 2.976 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 37558798
model size : 145.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4080284
	speed: 0.1556s/iter; left time: 703.4073s
Epoch: 1 cost time: 23.53652548789978
Epoch: 1, Steps: 154 | Train Loss: 2.073 Vali Loss: 2.153 Vali Acc: 0.337 Test Loss: 2.153 Test Acc: 0.337
Validation loss decreased (inf --> -0.336556).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6198345
	speed: 0.4169s/iter; left time: 1820.5088s
Epoch: 2 cost time: 22.325188398361206
Epoch: 2, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.403 Vali Acc: 0.343 Test Loss: 2.403 Test Acc: 0.343
Validation loss decreased (-0.336556 --> -0.342636).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9797664
	speed: 0.4137s/iter; left time: 1742.9236s
Epoch: 3 cost time: 20.661643028259277
Epoch: 3, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.334 Vali Acc: 0.367 Test Loss: 2.334 Test Acc: 0.367
Validation loss decreased (-0.342636 --> -0.366968).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2925506
	speed: 0.3795s/iter; left time: 1540.2645s
Epoch: 4 cost time: 20.064610719680786
Epoch: 4, Steps: 154 | Train Loss: 1.642 Vali Loss: 2.873 Vali Acc: 0.189 Test Loss: 2.873 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6129578
	speed: 0.3817s/iter; left time: 1490.4098s
Epoch: 5 cost time: 19.78548240661621
Epoch: 5, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.368 Vali Acc: 0.220 Test Loss: 2.368 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6575489
	speed: 0.3889s/iter; left time: 1458.7209s
Epoch: 6 cost time: 19.634607553482056
Epoch: 6, Steps: 154 | Train Loss: 1.471 Vali Loss: 3.966 Vali Acc: 0.194 Test Loss: 3.966 Test Acc: 0.194
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4819258
	speed: 0.3852s/iter; left time: 1385.5692s
Epoch: 7 cost time: 19.33752942085266
Epoch: 7, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.096 Vali Acc: 0.372 Test Loss: 3.096 Test Acc: 0.372
Validation loss decreased (-0.366968 --> -0.372232).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9353091
	speed: 0.3885s/iter; left time: 1337.6377s
Epoch: 8 cost time: 19.885608196258545
Epoch: 8, Steps: 154 | Train Loss: 1.342 Vali Loss: 2.396 Vali Acc: 0.398 Test Loss: 2.396 Test Acc: 0.398
Validation loss decreased (-0.372232 --> -0.397786).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.4871240
	speed: 0.3924s/iter; left time: 1290.5315s
Epoch: 9 cost time: 20.709243059158325
Epoch: 9, Steps: 154 | Train Loss: 1.272 Vali Loss: 4.440 Vali Acc: 0.210 Test Loss: 4.440 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1678956
	speed: 0.3960s/iter; left time: 1241.4797s
Epoch: 10 cost time: 19.848478317260742
Epoch: 10, Steps: 154 | Train Loss: 1.206 Vali Loss: 5.292 Vali Acc: 0.092 Test Loss: 5.292 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6692747
	speed: 0.3448s/iter; left time: 1027.8178s
Epoch: 11 cost time: 18.419852256774902
Epoch: 11, Steps: 154 | Train Loss: 1.113 Vali Loss: 7.026 Vali Acc: 0.087 Test Loss: 7.026 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.7022113
	speed: 0.3365s/iter; left time: 951.2240s
Epoch: 12 cost time: 17.924715995788574
Epoch: 12, Steps: 154 | Train Loss: 1.048 Vali Loss: 6.001 Vali Acc: 0.094 Test Loss: 6.001 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6655049
	speed: 0.3446s/iter; left time: 921.1426s
Epoch: 13 cost time: 17.871379375457764
Epoch: 13, Steps: 154 | Train Loss: 0.988 Vali Loss: 7.127 Vali Acc: 0.085 Test Loss: 7.127 Test Acc: 0.085
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.9978860
	speed: 0.3384s/iter; left time: 852.5531s
Epoch: 14 cost time: 17.43157196044922
Epoch: 14, Steps: 154 | Train Loss: 0.917 Vali Loss: 9.659 Vali Acc: 0.084 Test Loss: 9.659 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.8866860
	speed: 0.3390s/iter; left time: 801.8370s
Epoch: 15 cost time: 17.294675827026367
Epoch: 15, Steps: 154 | Train Loss: 0.913 Vali Loss: 9.574 Vali Acc: 0.071 Test Loss: 9.574 Test Acc: 0.071
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.7448857
	speed: 0.3378s/iter; left time: 746.8747s
Epoch: 16 cost time: 17.69825053215027
Epoch: 16, Steps: 154 | Train Loss: 0.827 Vali Loss: 7.770 Vali Acc: 0.101 Test Loss: 7.770 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.2851957
	speed: 0.3481s/iter; left time: 716.0435s
Epoch: 17 cost time: 17.88533115386963
Epoch: 17, Steps: 154 | Train Loss: 0.782 Vali Loss: 6.439 Vali Acc: 0.101 Test Loss: 6.439 Test Acc: 0.101
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.8491929
	speed: 0.3441s/iter; left time: 654.8992s
Epoch: 18 cost time: 18.35469388961792
Epoch: 18, Steps: 154 | Train Loss: 0.751 Vali Loss: 7.856 Vali Acc: 0.121 Test Loss: 7.856 Test Acc: 0.121
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3978102189781022
model parameter : 11080718
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9482900
	speed: 0.2051s/iter; left time: 927.4305s
Epoch: 1 cost time: 31.00980234146118
Epoch: 1, Steps: 154 | Train Loss: 2.083 Vali Loss: 2.256 Vali Acc: 0.165 Test Loss: 2.256 Test Acc: 0.165
Validation loss decreased (inf --> -0.165428).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4875704
	speed: 0.5470s/iter; left time: 2388.6831s
Epoch: 2 cost time: 32.302757263183594
Epoch: 2, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.232 Vali Acc: 0.349 Test Loss: 2.232 Test Acc: 0.349
Validation loss decreased (-0.165428 --> -0.348721).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3231342
	speed: 0.5928s/iter; left time: 2497.4977s
Epoch: 3 cost time: 32.84800148010254
Epoch: 3, Steps: 154 | Train Loss: 1.790 Vali Loss: 2.392 Vali Acc: 0.198 Test Loss: 2.392 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5791367
	speed: 0.5662s/iter; left time: 2298.3246s
Epoch: 4 cost time: 33.49949860572815
Epoch: 4, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.386 Vali Acc: 0.354 Test Loss: 2.386 Test Acc: 0.354
Validation loss decreased (-0.348721 --> -0.353991).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2828192
	speed: 0.6023s/iter; left time: 2351.8394s
Epoch: 5 cost time: 33.83327126502991
Epoch: 5, Steps: 154 | Train Loss: 1.634 Vali Loss: 6.134 Vali Acc: 0.072 Test Loss: 6.134 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3043295
	speed: 0.6041s/iter; left time: 2265.8361s
Epoch: 6 cost time: 34.120267152786255
Epoch: 6, Steps: 154 | Train Loss: 1.617 Vali Loss: 3.442 Vali Acc: 0.178 Test Loss: 3.442 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1083665
	speed: 0.5974s/iter; left time: 2149.0229s
Epoch: 7 cost time: 33.7022922039032
Epoch: 7, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.691 Vali Acc: 0.373 Test Loss: 2.691 Test Acc: 0.373
Validation loss decreased (-0.353991 --> -0.373452).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4608935
	speed: 0.6038s/iter; left time: 2078.7688s
Epoch: 8 cost time: 33.77570366859436
Epoch: 8, Steps: 154 | Train Loss: 1.441 Vali Loss: 3.098 Vali Acc: 0.387 Test Loss: 3.098 Test Acc: 0.387
Validation loss decreased (-0.373452 --> -0.387236).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3470207
	speed: 0.5912s/iter; left time: 1944.3863s
Epoch: 9 cost time: 29.810415744781494
Epoch: 9, Steps: 154 | Train Loss: 1.370 Vali Loss: 5.219 Vali Acc: 0.089 Test Loss: 5.219 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.3839359
	speed: 0.5293s/iter; left time: 1659.2492s
Epoch: 10 cost time: 30.089160203933716
Epoch: 10, Steps: 154 | Train Loss: 1.316 Vali Loss: 5.239 Vali Acc: 0.087 Test Loss: 5.239 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1394730
	speed: 0.5257s/iter; left time: 1567.1296s
Epoch: 11 cost time: 29.95133090019226
Epoch: 11, Steps: 154 | Train Loss: 1.271 Vali Loss: 4.222 Vali Acc: 0.091 Test Loss: 4.222 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.2075398
	speed: 0.5298s/iter; left time: 1497.8028s
Epoch: 12 cost time: 29.941792249679565
Epoch: 12, Steps: 154 | Train Loss: 1.158 Vali Loss: 6.144 Vali Acc: 0.119 Test Loss: 6.144 Test Acc: 0.119
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.2239681
	speed: 0.5180s/iter; left time: 1384.6720s
Epoch: 13 cost time: 30.166866540908813
Epoch: 13, Steps: 154 | Train Loss: 1.115 Vali Loss: 9.882 Vali Acc: 0.071 Test Loss: 9.882 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.8197654
	speed: 0.5270s/iter; left time: 1327.6351s
Epoch: 14 cost time: 29.254443168640137
Epoch: 14, Steps: 154 | Train Loss: 1.067 Vali Loss: 8.303 Vali Acc: 0.099 Test Loss: 8.303 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.7241863
	speed: 0.4874s/iter; left time: 1152.6946s
Epoch: 15 cost time: 28.49466633796692
Epoch: 15, Steps: 154 | Train Loss: 1.032 Vali Loss: 10.108 Vali Acc: 0.082 Test Loss: 10.108 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.8841171
	speed: 0.4978s/iter; left time: 1100.5653s
Epoch: 16 cost time: 28.78967308998108
Epoch: 16, Steps: 154 | Train Loss: 1.053 Vali Loss: 13.349 Vali Acc: 0.082 Test Loss: 13.349 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0336434
	speed: 0.5356s/iter; left time: 1101.6885s
Epoch: 17 cost time: 31.818078756332397
Epoch: 17, Steps: 154 | Train Loss: 0.970 Vali Loss: 11.972 Vali Acc: 0.088 Test Loss: 11.972 Test Acc: 0.088
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.2125880
	speed: 0.5614s/iter; left time: 1068.3391s
Epoch: 18 cost time: 31.7830650806427
Epoch: 18, Steps: 154 | Train Loss: 0.907 Vali Loss: 11.022 Vali Acc: 0.079 Test Loss: 11.022 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3872668288726683
model parameter : 37558798
model size : 145.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4140208
	speed: 0.0958s/iter; left time: 433.0737s
Epoch: 1 cost time: 14.061190605163574
Epoch: 1, Steps: 154 | Train Loss: 2.091 Vali Loss: 2.090 Vali Acc: 0.332 Test Loss: 2.090 Test Acc: 0.332
Validation loss decreased (inf --> -0.332096).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5818251
	speed: 0.2741s/iter; left time: 1197.1993s
Epoch: 2 cost time: 12.872492551803589
Epoch: 2, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.453 Vali Acc: 0.344 Test Loss: 2.453 Test Acc: 0.344
Validation loss decreased (-0.332096 --> -0.344258).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9850039
	speed: 0.2809s/iter; left time: 1183.3804s
Epoch: 3 cost time: 12.842248678207397
Epoch: 3, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.436 Vali Acc: 0.358 Test Loss: 2.436 Test Acc: 0.358
Validation loss decreased (-0.344258 --> -0.358451).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6879326
	speed: 0.2788s/iter; left time: 1131.7581s
Epoch: 4 cost time: 13.542923212051392
Epoch: 4, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.658 Vali Acc: 0.189 Test Loss: 2.658 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8532040
	speed: 0.2770s/iter; left time: 1081.5141s
Epoch: 5 cost time: 13.403127431869507
Epoch: 5, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.543 Vali Acc: 0.195 Test Loss: 2.543 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.5879172
	speed: 0.2759s/iter; left time: 1034.8089s
Epoch: 6 cost time: 13.455210447311401
Epoch: 6, Steps: 154 | Train Loss: 1.560 Vali Loss: 3.202 Vali Acc: 0.114 Test Loss: 3.202 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5031345
	speed: 0.2749s/iter; left time: 988.9228s
Epoch: 7 cost time: 13.410298824310303
Epoch: 7, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.257 Vali Acc: 0.156 Test Loss: 3.257 Test Acc: 0.156
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7932488
	speed: 0.2725s/iter; left time: 938.1295s
Epoch: 8 cost time: 13.631242036819458
Epoch: 8, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.839 Vali Acc: 0.392 Test Loss: 2.839 Test Acc: 0.392
Validation loss decreased (-0.358451 --> -0.391699).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3761327
	speed: 0.2668s/iter; left time: 877.6482s
Epoch: 9 cost time: 12.32887578010559
Epoch: 9, Steps: 154 | Train Loss: 1.336 Vali Loss: 5.004 Vali Acc: 0.203 Test Loss: 5.004 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.0869313
	speed: 0.2439s/iter; left time: 764.6609s
Epoch: 10 cost time: 12.183788061141968
Epoch: 10, Steps: 154 | Train Loss: 1.282 Vali Loss: 6.689 Vali Acc: 0.089 Test Loss: 6.689 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.9514017
	speed: 0.2397s/iter; left time: 714.4833s
Epoch: 11 cost time: 11.96816635131836
Epoch: 11, Steps: 154 | Train Loss: 1.182 Vali Loss: 8.317 Vali Acc: 0.080 Test Loss: 8.317 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.7326972
	speed: 0.2349s/iter; left time: 664.0592s
Epoch: 12 cost time: 11.173832416534424
Epoch: 12, Steps: 154 | Train Loss: 1.105 Vali Loss: 12.073 Vali Acc: 0.070 Test Loss: 12.073 Test Acc: 0.070
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.6556153
	speed: 0.2684s/iter; left time: 717.3141s
Epoch: 13 cost time: 15.456467151641846
Epoch: 13, Steps: 154 | Train Loss: 1.112 Vali Loss: 9.422 Vali Acc: 0.074 Test Loss: 9.422 Test Acc: 0.074
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.0520487
	speed: 0.3000s/iter; left time: 755.7225s
Epoch: 14 cost time: 13.215149641036987
Epoch: 14, Steps: 154 | Train Loss: 1.053 Vali Loss: 10.342 Vali Acc: 0.081 Test Loss: 10.342 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.0436721
	speed: 0.3067s/iter; left time: 725.4434s
Epoch: 15 cost time: 15.373155355453491
Epoch: 15, Steps: 154 | Train Loss: 1.007 Vali Loss: 11.982 Vali Acc: 0.063 Test Loss: 11.982 Test Acc: 0.063
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.3461747
	speed: 0.2934s/iter; left time: 648.7970s
Epoch: 16 cost time: 13.352322340011597
Epoch: 16, Steps: 154 | Train Loss: 0.900 Vali Loss: 10.318 Vali Acc: 0.079 Test Loss: 10.318 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.7607431
	speed: 0.3212s/iter; left time: 660.6142s
Epoch: 17 cost time: 15.921109199523926
Epoch: 17, Steps: 154 | Train Loss: 0.878 Vali Loss: 12.434 Vali Acc: 0.072 Test Loss: 12.434 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.8944131
	speed: 0.2857s/iter; left time: 543.7022s
Epoch: 18 cost time: 13.586576461791992
Epoch: 18, Steps: 154 | Train Loss: 0.849 Vali Loss: 14.801 Vali Acc: 0.066 Test Loss: 14.801 Test Acc: 0.066
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 11080718
model size : 44.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7031562
	speed: 0.3262s/iter; left time: 1474.7042s
Epoch: 1 cost time: 51.06136417388916
Epoch: 1, Steps: 154 | Train Loss: 2.106 Vali Loss: 2.255 Vali Acc: 0.335 Test Loss: 2.255 Test Acc: 0.335
Validation loss decreased (inf --> -0.334527).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1467643
	speed: 0.9595s/iter; left time: 4190.0915s
Epoch: 2 cost time: 53.1935830116272
Epoch: 2, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.581 Vali Acc: 0.337 Test Loss: 2.581 Test Acc: 0.337
Validation loss decreased (-0.334527 --> -0.336552).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4493544
	speed: 0.9852s/iter; left time: 4150.8025s
Epoch: 3 cost time: 52.953826904296875
Epoch: 3, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.498 Vali Acc: 0.366 Test Loss: 2.498 Test Acc: 0.366
Validation loss decreased (-0.336552 --> -0.366155).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7224034
	speed: 1.0269s/iter; left time: 4168.1274s
Epoch: 4 cost time: 54.60468578338623
Epoch: 4, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.232 Vali Acc: 0.373 Test Loss: 2.232 Test Acc: 0.373
Validation loss decreased (-0.366155 --> -0.373457).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2768661
	speed: 0.9869s/iter; left time: 3853.7574s
Epoch: 5 cost time: 52.10833430290222
Epoch: 5, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.550 Vali Acc: 0.135 Test Loss: 2.550 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2393973
	speed: 0.9953s/iter; left time: 3733.2444s
Epoch: 6 cost time: 54.375691175460815
Epoch: 6, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.622 Vali Acc: 0.357 Test Loss: 2.622 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5625111
	speed: 0.9809s/iter; left time: 3528.4670s
Epoch: 7 cost time: 49.552401542663574
Epoch: 7, Steps: 154 | Train Loss: 1.398 Vali Loss: 2.989 Vali Acc: 0.135 Test Loss: 2.989 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 2.4590278
	speed: 0.8890s/iter; left time: 3060.9331s
Epoch: 8 cost time: 47.82649087905884
Epoch: 8, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.936 Vali Acc: 0.223 Test Loss: 2.936 Test Acc: 0.223
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.4414927
	speed: 0.9341s/iter; left time: 3072.2615s
Epoch: 9 cost time: 50.29613995552063
Epoch: 9, Steps: 154 | Train Loss: 1.262 Vali Loss: 2.653 Vali Acc: 0.391 Test Loss: 2.653 Test Acc: 0.391
Validation loss decreased (-0.373457 --> -0.390890).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.2421052
	speed: 0.8984s/iter; left time: 2816.5208s
Epoch: 10 cost time: 47.36533832550049
Epoch: 10, Steps: 154 | Train Loss: 1.208 Vali Loss: 7.401 Vali Acc: 0.095 Test Loss: 7.401 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2758783
	speed: 0.9150s/iter; left time: 2727.5484s
Epoch: 11 cost time: 49.77369713783264
Epoch: 11, Steps: 154 | Train Loss: 1.166 Vali Loss: 2.673 Vali Acc: 0.373 Test Loss: 2.673 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1843022
	speed: 0.8412s/iter; left time: 2378.0237s
Epoch: 12 cost time: 44.09139394760132
Epoch: 12, Steps: 154 | Train Loss: 1.133 Vali Loss: 2.751 Vali Acc: 0.155 Test Loss: 2.751 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0106775
	speed: 0.8990s/iter; left time: 2403.0794s
Epoch: 13 cost time: 47.28828763961792
Epoch: 13, Steps: 154 | Train Loss: 1.072 Vali Loss: 3.401 Vali Acc: 0.350 Test Loss: 3.401 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.9224191
	speed: 0.9061s/iter; left time: 2282.3587s
Epoch: 14 cost time: 47.85980987548828
Epoch: 14, Steps: 154 | Train Loss: 1.039 Vali Loss: 2.687 Vali Acc: 0.396 Test Loss: 2.687 Test Acc: 0.396
Validation loss decreased (-0.390890 --> -0.396161).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5970308
	speed: 0.9078s/iter; left time: 2147.0094s
Epoch: 15 cost time: 48.31670689582825
Epoch: 15, Steps: 154 | Train Loss: 0.983 Vali Loss: 2.891 Vali Acc: 0.391 Test Loss: 2.891 Test Acc: 0.391
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.2269270
	speed: 0.8885s/iter; left time: 1964.4655s
Epoch: 16 cost time: 48.47933626174927
Epoch: 16, Steps: 154 | Train Loss: 0.972 Vali Loss: 4.618 Vali Acc: 0.099 Test Loss: 4.618 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.1997434
	speed: 0.8937s/iter; left time: 1838.3959s
Epoch: 17 cost time: 47.608611822128296
Epoch: 17, Steps: 154 | Train Loss: 0.920 Vali Loss: 3.789 Vali Acc: 0.176 Test Loss: 3.789 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.8954842
	speed: 0.8504s/iter; left time: 1618.3717s
Epoch: 18 cost time: 43.91708326339722
Epoch: 18, Steps: 154 | Train Loss: 0.916 Vali Loss: 4.922 Vali Acc: 0.130 Test Loss: 4.922 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.6034589
	speed: 0.8110s/iter; left time: 1418.4708s
Epoch: 19 cost time: 44.31815791130066
Epoch: 19, Steps: 154 | Train Loss: 0.842 Vali Loss: 3.875 Vali Acc: 0.142 Test Loss: 3.875 Test Acc: 0.142
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.4773341
	speed: 0.8013s/iter; left time: 1278.0964s
Epoch: 20 cost time: 43.01548099517822
Epoch: 20, Steps: 154 | Train Loss: 0.818 Vali Loss: 4.409 Vali Acc: 0.135 Test Loss: 4.409 Test Acc: 0.135
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.5107118
	speed: 0.8249s/iter; left time: 1188.7331s
Epoch: 21 cost time: 43.51211071014404
Epoch: 21, Steps: 154 | Train Loss: 0.809 Vali Loss: 3.540 Vali Acc: 0.204 Test Loss: 3.540 Test Acc: 0.204
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.8238816
	speed: 0.8263s/iter; left time: 1063.4497s
Epoch: 22 cost time: 44.143725633621216
Epoch: 22, Steps: 154 | Train Loss: 0.767 Vali Loss: 3.595 Vali Acc: 0.135 Test Loss: 3.595 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.0176541
	speed: 0.8334s/iter; left time: 944.2266s
Epoch: 23 cost time: 48.64714527130127
Epoch: 23, Steps: 154 | Train Loss: 0.737 Vali Loss: 5.296 Vali Acc: 0.129 Test Loss: 5.296 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.8641023
	speed: 0.8997s/iter; left time: 880.8476s
Epoch: 24 cost time: 48.03229570388794
Epoch: 24, Steps: 154 | Train Loss: 0.710 Vali Loss: 3.392 Vali Acc: 0.150 Test Loss: 3.392 Test Acc: 0.150
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3961881589618816
model parameter : 18813966
model size : 74.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1861255
	speed: 0.1426s/iter; left time: 644.7935s
Epoch: 1 cost time: 21.107622146606445
Epoch: 1, Steps: 154 | Train Loss: 2.086 Vali Loss: 2.113 Vali Acc: 0.333 Test Loss: 2.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333312).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9253643
	speed: 0.3738s/iter; left time: 1632.5208s
Epoch: 2 cost time: 19.85773754119873
Epoch: 2, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.285 Vali Acc: 0.344 Test Loss: 2.285 Test Acc: 0.344
Validation loss decreased (-0.333312 --> -0.344259).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6982093
	speed: 0.3839s/iter; left time: 1617.1672s
Epoch: 3 cost time: 18.178886651992798
Epoch: 3, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.593 Vali Acc: 0.363 Test Loss: 2.593 Test Acc: 0.363
Validation loss decreased (-0.344259 --> -0.363316).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2069066
	speed: 0.3951s/iter; left time: 1603.5991s
Epoch: 4 cost time: 17.773388385772705
Epoch: 4, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.912 Vali Acc: 0.351 Test Loss: 2.912 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4322405
	speed: 0.3942s/iter; left time: 1539.4562s
Epoch: 5 cost time: 19.206491231918335
Epoch: 5, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.553 Vali Acc: 0.206 Test Loss: 2.553 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3035356
	speed: 0.3779s/iter; left time: 1417.3473s
Epoch: 6 cost time: 20.448683738708496
Epoch: 6, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.090 Vali Acc: 0.155 Test Loss: 3.090 Test Acc: 0.155
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.5906090
	speed: 0.3627s/iter; left time: 1304.4656s
Epoch: 7 cost time: 17.30315065383911
Epoch: 7, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.400 Vali Acc: 0.154 Test Loss: 2.400 Test Acc: 0.154
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3498433
	speed: 0.3473s/iter; left time: 1195.6552s
Epoch: 8 cost time: 15.795450210571289
Epoch: 8, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.808 Vali Acc: 0.172 Test Loss: 2.808 Test Acc: 0.172
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.2794150
	speed: 0.3532s/iter; left time: 1161.7601s
Epoch: 9 cost time: 16.25358748435974
Epoch: 9, Steps: 154 | Train Loss: 1.236 Vali Loss: 5.717 Vali Acc: 0.089 Test Loss: 5.717 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.2465965
	speed: 0.3479s/iter; left time: 1090.6638s
Epoch: 10 cost time: 18.256511926651
Epoch: 10, Steps: 154 | Train Loss: 1.149 Vali Loss: 5.566 Vali Acc: 0.082 Test Loss: 5.566 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.5672832
	speed: 0.3333s/iter; left time: 993.5588s
Epoch: 11 cost time: 18.125645399093628
Epoch: 11, Steps: 154 | Train Loss: 1.135 Vali Loss: 3.695 Vali Acc: 0.088 Test Loss: 3.695 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.6942931
	speed: 0.3390s/iter; left time: 958.2302s
Epoch: 12 cost time: 16.237346172332764
Epoch: 12, Steps: 154 | Train Loss: 1.084 Vali Loss: 4.428 Vali Acc: 0.112 Test Loss: 4.428 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.1901946
	speed: 0.3499s/iter; left time: 935.1876s
Epoch: 13 cost time: 15.701443672180176
Epoch: 13, Steps: 154 | Train Loss: 0.984 Vali Loss: 3.950 Vali Acc: 0.095 Test Loss: 3.950 Test Acc: 0.095
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3633414436334144
model parameter : 5574670
model size : 23.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7173747
	speed: 0.2285s/iter; left time: 1033.1112s
Epoch: 1 cost time: 35.52388381958008
Epoch: 1, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.220 Vali Acc: 0.334 Test Loss: 2.220 Test Acc: 0.334
Validation loss decreased (inf --> -0.334122).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0944171
	speed: 0.6240s/iter; left time: 2724.8895s
Epoch: 2 cost time: 34.06533241271973
Epoch: 2, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.260 Vali Acc: 0.355 Test Loss: 2.260 Test Acc: 0.355
Validation loss decreased (-0.334122 --> -0.354803).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5389081
	speed: 0.6107s/iter; left time: 2572.7600s
Epoch: 3 cost time: 33.311424255371094
Epoch: 3, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.699 Vali Acc: 0.193 Test Loss: 2.699 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8430288
	speed: 0.6660s/iter; left time: 2703.1524s
Epoch: 4 cost time: 35.145036935806274
Epoch: 4, Steps: 154 | Train Loss: 1.680 Vali Loss: 2.495 Vali Acc: 0.365 Test Loss: 2.495 Test Acc: 0.365
Validation loss decreased (-0.354803 --> -0.364533).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2785070
	speed: 0.6893s/iter; left time: 2691.6925s
Epoch: 5 cost time: 37.4126980304718
Epoch: 5, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.996 Vali Acc: 0.153 Test Loss: 2.996 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1896160
	speed: 0.6831s/iter; left time: 2562.2492s
Epoch: 6 cost time: 36.990092039108276
Epoch: 6, Steps: 154 | Train Loss: 1.448 Vali Loss: 2.425 Vali Acc: 0.386 Test Loss: 2.425 Test Acc: 0.386
Validation loss decreased (-0.364533 --> -0.385621).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5878617
	speed: 0.6718s/iter; left time: 2416.4099s
Epoch: 7 cost time: 35.12485980987549
Epoch: 7, Steps: 154 | Train Loss: 1.425 Vali Loss: 3.075 Vali Acc: 0.134 Test Loss: 3.075 Test Acc: 0.134
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.9955183
	speed: 0.6630s/iter; left time: 2282.7558s
Epoch: 8 cost time: 33.869221687316895
Epoch: 8, Steps: 154 | Train Loss: 1.379 Vali Loss: 3.055 Vali Acc: 0.221 Test Loss: 3.055 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.8484901
	speed: 0.6038s/iter; left time: 1985.8859s
Epoch: 9 cost time: 32.419535398483276
Epoch: 9, Steps: 154 | Train Loss: 1.295 Vali Loss: 3.101 Vali Acc: 0.391 Test Loss: 3.101 Test Acc: 0.391
Validation loss decreased (-0.385621 --> -0.390480).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0561224
	speed: 0.6312s/iter; left time: 1978.7893s
Epoch: 10 cost time: 32.987056016922
Epoch: 10, Steps: 154 | Train Loss: 1.251 Vali Loss: 6.825 Vali Acc: 0.103 Test Loss: 6.825 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7297775
	speed: 0.5504s/iter; left time: 1640.8797s
Epoch: 11 cost time: 29.15338945388794
Epoch: 11, Steps: 154 | Train Loss: 1.222 Vali Loss: 4.829 Vali Acc: 0.219 Test Loss: 4.829 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.9204222
	speed: 0.5538s/iter; left time: 1565.6240s
Epoch: 12 cost time: 30.725542068481445
Epoch: 12, Steps: 154 | Train Loss: 1.191 Vali Loss: 4.620 Vali Acc: 0.108 Test Loss: 4.620 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.4180244
	speed: 0.5520s/iter; left time: 1475.5125s
Epoch: 13 cost time: 29.59304666519165
Epoch: 13, Steps: 154 | Train Loss: 1.141 Vali Loss: 8.318 Vali Acc: 0.094 Test Loss: 8.318 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.9723572
	speed: 0.5454s/iter; left time: 1373.7937s
Epoch: 14 cost time: 30.0011727809906
Epoch: 14, Steps: 154 | Train Loss: 1.084 Vali Loss: 4.368 Vali Acc: 0.388 Test Loss: 4.368 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.7879236
	speed: 0.5599s/iter; left time: 1324.1400s
Epoch: 15 cost time: 30.00302505493164
Epoch: 15, Steps: 154 | Train Loss: 1.046 Vali Loss: 4.670 Vali Acc: 0.198 Test Loss: 4.670 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.2481128
	speed: 0.5420s/iter; left time: 1198.3186s
Epoch: 16 cost time: 29.388702869415283
Epoch: 16, Steps: 154 | Train Loss: 1.009 Vali Loss: 3.707 Vali Acc: 0.133 Test Loss: 3.707 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.2384803
	speed: 0.5631s/iter; left time: 1158.2032s
Epoch: 17 cost time: 30.352163553237915
Epoch: 17, Steps: 154 | Train Loss: 0.966 Vali Loss: 4.568 Vali Acc: 0.160 Test Loss: 4.568 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.0305016
	speed: 0.5831s/iter; left time: 1109.5668s
Epoch: 18 cost time: 32.14392018318176
Epoch: 18, Steps: 154 | Train Loss: 0.921 Vali Loss: 6.863 Vali Acc: 0.089 Test Loss: 6.863 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.4627323
	speed: 0.6200s/iter; left time: 1084.4526s
Epoch: 19 cost time: 33.717801570892334
Epoch: 19, Steps: 154 | Train Loss: 0.868 Vali Loss: 7.271 Vali Acc: 0.083 Test Loss: 7.271 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3905109489051095
model parameter : 18813966
model size : 74.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2099335
	speed: 0.1072s/iter; left time: 484.7147s
Epoch: 1 cost time: 15.751071691513062
Epoch: 1, Steps: 154 | Train Loss: 2.092 Vali Loss: 2.130 Vali Acc: 0.333 Test Loss: 2.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.332501).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9661161
	speed: 0.2702s/iter; left time: 1180.1525s
Epoch: 2 cost time: 13.264042615890503
Epoch: 2, Steps: 154 | Train Loss: 1.862 Vali Loss: 2.222 Vali Acc: 0.345 Test Loss: 2.222 Test Acc: 0.345
Validation loss decreased (-0.332501 --> -0.344666).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8258874
	speed: 0.2849s/iter; left time: 1200.3032s
Epoch: 3 cost time: 12.590217590332031
Epoch: 3, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.466 Vali Acc: 0.365 Test Loss: 2.466 Test Acc: 0.365
Validation loss decreased (-0.344666 --> -0.364533).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3942219
	speed: 0.2859s/iter; left time: 1160.3709s
Epoch: 4 cost time: 13.09607195854187
Epoch: 4, Steps: 154 | Train Loss: 1.601 Vali Loss: 2.661 Vali Acc: 0.358 Test Loss: 2.661 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3639064
	speed: 0.2738s/iter; left time: 1069.2255s
Epoch: 5 cost time: 14.370896816253662
Epoch: 5, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.354 Vali Acc: 0.226 Test Loss: 2.354 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4165425
	speed: 0.2721s/iter; left time: 1020.4976s
Epoch: 6 cost time: 13.52658200263977
Epoch: 6, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.470 Vali Acc: 0.366 Test Loss: 3.470 Test Acc: 0.366
Validation loss decreased (-0.364533 --> -0.365740).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6888045
	speed: 0.2807s/iter; left time: 1009.7448s
Epoch: 7 cost time: 12.591738224029541
Epoch: 7, Steps: 154 | Train Loss: 1.376 Vali Loss: 2.483 Vali Acc: 0.226 Test Loss: 2.483 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1543756
	speed: 0.2475s/iter; left time: 852.2515s
Epoch: 8 cost time: 12.287091493606567
Epoch: 8, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.528 Vali Acc: 0.137 Test Loss: 3.528 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3481634
	speed: 0.2667s/iter; left time: 877.2497s
Epoch: 9 cost time: 11.613858699798584
Epoch: 9, Steps: 154 | Train Loss: 1.301 Vali Loss: 7.681 Vali Acc: 0.090 Test Loss: 7.681 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0561987
	speed: 0.2638s/iter; left time: 827.1039s
Epoch: 10 cost time: 11.722975730895996
Epoch: 10, Steps: 154 | Train Loss: 1.181 Vali Loss: 6.664 Vali Acc: 0.071 Test Loss: 6.664 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.9667475
	speed: 0.2606s/iter; left time: 776.8782s
Epoch: 11 cost time: 12.37268853187561
Epoch: 11, Steps: 154 | Train Loss: 1.159 Vali Loss: 6.090 Vali Acc: 0.077 Test Loss: 6.090 Test Acc: 0.077
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7341439
	speed: 0.2588s/iter; left time: 731.5478s
Epoch: 12 cost time: 13.175220489501953
Epoch: 12, Steps: 154 | Train Loss: 1.083 Vali Loss: 7.577 Vali Acc: 0.092 Test Loss: 7.577 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0872116
	speed: 0.2513s/iter; left time: 671.7743s
Epoch: 13 cost time: 13.029288053512573
Epoch: 13, Steps: 154 | Train Loss: 1.008 Vali Loss: 6.185 Vali Acc: 0.171 Test Loss: 6.185 Test Acc: 0.171
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.2273767
	speed: 0.2530s/iter; left time: 637.3943s
Epoch: 14 cost time: 12.460923433303833
Epoch: 14, Steps: 154 | Train Loss: 0.980 Vali Loss: 9.919 Vali Acc: 0.071 Test Loss: 9.919 Test Acc: 0.071
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1448371
	speed: 0.2605s/iter; left time: 616.1600s
Epoch: 15 cost time: 11.8138747215271
Epoch: 15, Steps: 154 | Train Loss: 0.931 Vali Loss: 9.376 Vali Acc: 0.082 Test Loss: 9.376 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.1544713
	speed: 0.2600s/iter; left time: 574.9579s
Epoch: 16 cost time: 11.730801820755005
Epoch: 16, Steps: 154 | Train Loss: 0.885 Vali Loss: 14.079 Vali Acc: 0.082 Test Loss: 14.079 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3657745336577453
model parameter : 5574670
model size : 23.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7832967
	speed: 0.1401s/iter; left time: 633.4498s
Epoch: 1 cost time: 20.10436511039734
Epoch: 1, Steps: 154 | Train Loss: 2.116 Vali Loss: 2.176 Vali Acc: 0.329 Test Loss: 2.176 Test Acc: 0.329
Validation loss decreased (inf --> -0.329256).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0079339
	speed: 0.3463s/iter; left time: 1512.3779s
Epoch: 2 cost time: 18.56785559654236
Epoch: 2, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.388 Vali Acc: 0.339 Test Loss: 2.388 Test Acc: 0.339
Validation loss decreased (-0.329256 --> -0.338581).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6332413
	speed: 0.3518s/iter; left time: 1482.2369s
Epoch: 3 cost time: 18.00447177886963
Epoch: 3, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.563 Vali Acc: 0.204 Test Loss: 2.563 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7000601
	speed: 0.3476s/iter; left time: 1411.0341s
Epoch: 4 cost time: 17.69929003715515
Epoch: 4, Steps: 154 | Train Loss: 1.668 Vali Loss: 2.027 Vali Acc: 0.390 Test Loss: 2.027 Test Acc: 0.390
Validation loss decreased (-0.338581 --> -0.390085).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3993506
	speed: 0.3801s/iter; left time: 1484.2404s
Epoch: 5 cost time: 19.183411598205566
Epoch: 5, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.923 Vali Acc: 0.215 Test Loss: 2.923 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3968433
	speed: 0.3825s/iter; left time: 1434.6368s
Epoch: 6 cost time: 19.247213125228882
Epoch: 6, Steps: 154 | Train Loss: 1.548 Vali Loss: 3.388 Vali Acc: 0.303 Test Loss: 3.388 Test Acc: 0.303
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6695747
	speed: 0.3813s/iter; left time: 1371.4204s
Epoch: 7 cost time: 19.566858768463135
Epoch: 7, Steps: 154 | Train Loss: 1.464 Vali Loss: 6.553 Vali Acc: 0.082 Test Loss: 6.553 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.9878519
	speed: 0.3782s/iter; left time: 1302.1758s
Epoch: 8 cost time: 19.752248287200928
Epoch: 8, Steps: 154 | Train Loss: 1.415 Vali Loss: 5.447 Vali Acc: 0.107 Test Loss: 5.447 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.0082904
	speed: 0.3808s/iter; left time: 1252.5819s
Epoch: 9 cost time: 19.90059733390808
Epoch: 9, Steps: 154 | Train Loss: 1.355 Vali Loss: 4.270 Vali Acc: 0.222 Test Loss: 4.270 Test Acc: 0.222
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.2392093
	speed: 0.3825s/iter; left time: 1199.2052s
Epoch: 10 cost time: 20.26955485343933
Epoch: 10, Steps: 154 | Train Loss: 1.373 Vali Loss: 8.566 Vali Acc: 0.091 Test Loss: 8.566 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.6130339
	speed: 0.3723s/iter; left time: 1109.7672s
Epoch: 11 cost time: 18.875027894973755
Epoch: 11, Steps: 154 | Train Loss: 1.304 Vali Loss: 7.067 Vali Acc: 0.080 Test Loss: 7.067 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.9226890
	speed: 0.3456s/iter; left time: 976.9037s
Epoch: 12 cost time: 18.50231146812439
Epoch: 12, Steps: 154 | Train Loss: 1.280 Vali Loss: 4.743 Vali Acc: 0.215 Test Loss: 4.743 Test Acc: 0.215
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.9855361
	speed: 0.3523s/iter; left time: 941.6758s
Epoch: 13 cost time: 18.335179328918457
Epoch: 13, Steps: 154 | Train Loss: 1.189 Vali Loss: 6.448 Vali Acc: 0.116 Test Loss: 6.448 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 2.8110614
	speed: 0.3580s/iter; left time: 901.8111s
Epoch: 14 cost time: 19.09417200088501
Epoch: 14, Steps: 154 | Train Loss: 1.151 Vali Loss: 6.807 Vali Acc: 0.094 Test Loss: 6.807 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39010543390105434
model parameter : 18813966
model size : 74.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2085547
	speed: 0.0665s/iter; left time: 300.6351s
Epoch: 1 cost time: 9.682313919067383
Epoch: 1, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.133 Vali Acc: 0.332 Test Loss: 2.133 Test Acc: 0.332
Validation loss decreased (inf --> -0.332095).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0306349
	speed: 0.1810s/iter; left time: 790.2430s
Epoch: 2 cost time: 7.6841816902160645
Epoch: 2, Steps: 154 | Train Loss: 1.906 Vali Loss: 2.177 Vali Acc: 0.342 Test Loss: 2.177 Test Acc: 0.342
Validation loss decreased (-0.332095 --> -0.341827).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8026094
	speed: 0.1806s/iter; left time: 760.6990s
Epoch: 3 cost time: 7.764587879180908
Epoch: 3, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.510 Vali Acc: 0.372 Test Loss: 2.510 Test Acc: 0.372
Validation loss decreased (-0.341827 --> -0.371832).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3203379
	speed: 0.1828s/iter; left time: 742.1567s
Epoch: 4 cost time: 8.269105672836304
Epoch: 4, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.648 Vali Acc: 0.357 Test Loss: 2.648 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6071057
	speed: 0.1798s/iter; left time: 701.9587s
Epoch: 5 cost time: 8.675997734069824
Epoch: 5, Steps: 154 | Train Loss: 1.629 Vali Loss: 3.033 Vali Acc: 0.186 Test Loss: 3.033 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4124749
	speed: 0.1742s/iter; left time: 653.2580s
Epoch: 6 cost time: 8.16041111946106
Epoch: 6, Steps: 154 | Train Loss: 1.515 Vali Loss: 3.299 Vali Acc: 0.339 Test Loss: 3.299 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3184389
	speed: 0.1792s/iter; left time: 644.4430s
Epoch: 7 cost time: 7.66522216796875
Epoch: 7, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.400 Vali Acc: 0.402 Test Loss: 2.400 Test Acc: 0.402
Validation loss decreased (-0.371832 --> -0.402247).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2832050
	speed: 0.1798s/iter; left time: 619.0917s
Epoch: 8 cost time: 7.459089040756226
Epoch: 8, Steps: 154 | Train Loss: 1.414 Vali Loss: 2.570 Vali Acc: 0.385 Test Loss: 2.570 Test Acc: 0.385
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3177081
	speed: 0.1812s/iter; left time: 596.1114s
Epoch: 9 cost time: 8.449929475784302
Epoch: 9, Steps: 154 | Train Loss: 1.334 Vali Loss: 6.219 Vali Acc: 0.076 Test Loss: 6.219 Test Acc: 0.076
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1324474
	speed: 0.1775s/iter; left time: 556.3718s
Epoch: 10 cost time: 8.764299869537354
Epoch: 10, Steps: 154 | Train Loss: 1.281 Vali Loss: 6.568 Vali Acc: 0.082 Test Loss: 6.568 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.7587950
	speed: 0.1753s/iter; left time: 522.4463s
Epoch: 11 cost time: 8.00071907043457
Epoch: 11, Steps: 154 | Train Loss: 1.209 Vali Loss: 6.868 Vali Acc: 0.077 Test Loss: 6.868 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3974260
	speed: 0.1805s/iter; left time: 510.2492s
Epoch: 12 cost time: 7.748121500015259
Epoch: 12, Steps: 154 | Train Loss: 1.206 Vali Loss: 7.863 Vali Acc: 0.076 Test Loss: 7.863 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1587502
	speed: 0.1787s/iter; left time: 477.6510s
Epoch: 13 cost time: 7.943939208984375
Epoch: 13, Steps: 154 | Train Loss: 1.100 Vali Loss: 6.549 Vali Acc: 0.086 Test Loss: 6.549 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.0743011
	speed: 0.1774s/iter; left time: 446.9439s
Epoch: 14 cost time: 8.706072092056274
Epoch: 14, Steps: 154 | Train Loss: 1.064 Vali Loss: 13.480 Vali Acc: 0.075 Test Loss: 13.480 Test Acc: 0.075
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.4599681
	speed: 0.1768s/iter; left time: 418.2190s
Epoch: 15 cost time: 8.36873197555542
Epoch: 15, Steps: 154 | Train Loss: 0.997 Vali Loss: 11.806 Vali Acc: 0.075 Test Loss: 11.806 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.2000771
	speed: 0.1767s/iter; left time: 390.6463s
Epoch: 16 cost time: 8.595617532730103
Epoch: 16, Steps: 154 | Train Loss: 1.016 Vali Loss: 13.917 Vali Acc: 0.073 Test Loss: 13.917 Test Acc: 0.073
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.6791869
	speed: 0.1881s/iter; left time: 386.9573s
Epoch: 17 cost time: 8.166401863098145
Epoch: 17, Steps: 154 | Train Loss: 0.927 Vali Loss: 10.145 Vali Acc: 0.081 Test Loss: 10.145 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40227088402270883
model parameter : 5574670
model size : 23.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9461925
	speed: 0.3636s/iter; left time: 1644.0112s
Epoch: 1 cost time: 55.29608988761902
Epoch: 1, Steps: 154 | Train Loss: 2.103 Vali Loss: 2.090 Vali Acc: 0.325 Test Loss: 2.090 Test Acc: 0.325
Validation loss decreased (inf --> -0.324797).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2649701
	speed: 1.0199s/iter; left time: 4453.8555s
Epoch: 2 cost time: 53.70004892349243
Epoch: 2, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.299 Vali Acc: 0.326 Test Loss: 2.299 Test Acc: 0.326
Validation loss decreased (-0.324797 --> -0.326417).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6373471
	speed: 1.0293s/iter; left time: 4336.6494s
Epoch: 3 cost time: 53.38855695724487
Epoch: 3, Steps: 154 | Train Loss: 1.793 Vali Loss: 2.478 Vali Acc: 0.179 Test Loss: 2.478 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1866236
	speed: 1.0333s/iter; left time: 4194.3619s
Epoch: 4 cost time: 53.48788928985596
Epoch: 4, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.438 Vali Acc: 0.355 Test Loss: 2.438 Test Acc: 0.355
Validation loss decreased (-0.326417 --> -0.355207).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2936600
	speed: 1.0076s/iter; left time: 3934.7795s
Epoch: 5 cost time: 49.86137676239014
Epoch: 5, Steps: 154 | Train Loss: 1.562 Vali Loss: 1.940 Vali Acc: 0.380 Test Loss: 1.940 Test Acc: 0.380
Validation loss decreased (-0.355207 --> -0.379543).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3651279
	speed: 0.9432s/iter; left time: 3537.8054s
Epoch: 6 cost time: 49.45598578453064
Epoch: 6, Steps: 154 | Train Loss: 1.520 Vali Loss: 2.170 Vali Acc: 0.325 Test Loss: 2.170 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9042346
	speed: 0.9277s/iter; left time: 3336.8157s
Epoch: 7 cost time: 49.40423607826233
Epoch: 7, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.796 Vali Acc: 0.192 Test Loss: 2.796 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5240414
	speed: 0.9337s/iter; left time: 3214.6254s
Epoch: 8 cost time: 48.59192252159119
Epoch: 8, Steps: 154 | Train Loss: 1.366 Vali Loss: 2.271 Vali Acc: 0.388 Test Loss: 2.271 Test Acc: 0.388
Validation loss decreased (-0.379543 --> -0.387650).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3643752
	speed: 0.9470s/iter; left time: 3114.6364s
Epoch: 9 cost time: 48.73431134223938
Epoch: 9, Steps: 154 | Train Loss: 1.316 Vali Loss: 3.016 Vali Acc: 0.123 Test Loss: 3.016 Test Acc: 0.123
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1152261
	speed: 0.9338s/iter; left time: 2927.5908s
Epoch: 10 cost time: 50.23066544532776
Epoch: 10, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.276 Vali Acc: 0.166 Test Loss: 3.276 Test Acc: 0.166
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1729650
	speed: 0.9332s/iter; left time: 2781.8680s
Epoch: 11 cost time: 45.53298854827881
Epoch: 11, Steps: 154 | Train Loss: 1.192 Vali Loss: 2.838 Vali Acc: 0.249 Test Loss: 2.838 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.7896258
	speed: 0.8147s/iter; left time: 2303.1242s
Epoch: 12 cost time: 35.268502712249756
Epoch: 12, Steps: 154 | Train Loss: 1.117 Vali Loss: 7.078 Vali Acc: 0.123 Test Loss: 7.078 Test Acc: 0.123
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1980450
	speed: 0.7859s/iter; left time: 2100.7758s
Epoch: 13 cost time: 44.243130683898926
Epoch: 13, Steps: 154 | Train Loss: 1.065 Vali Loss: 5.771 Vali Acc: 0.134 Test Loss: 5.771 Test Acc: 0.134
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.9840387
	speed: 0.8345s/iter; left time: 2102.2180s
Epoch: 14 cost time: 44.05914330482483
Epoch: 14, Steps: 154 | Train Loss: 1.051 Vali Loss: 4.725 Vali Acc: 0.109 Test Loss: 4.725 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.5774794
	speed: 0.7848s/iter; left time: 1856.0515s
Epoch: 15 cost time: 38.43017292022705
Epoch: 15, Steps: 154 | Train Loss: 0.990 Vali Loss: 5.395 Vali Acc: 0.086 Test Loss: 5.395 Test Acc: 0.086
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.7823441
	speed: 0.7230s/iter; left time: 1598.6594s
Epoch: 16 cost time: 38.28007221221924
Epoch: 16, Steps: 154 | Train Loss: 0.936 Vali Loss: 8.283 Vali Acc: 0.092 Test Loss: 8.283 Test Acc: 0.092
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.8193555
	speed: 0.7311s/iter; left time: 1503.9046s
Epoch: 17 cost time: 38.40269184112549
Epoch: 17, Steps: 154 | Train Loss: 0.880 Vali Loss: 5.318 Vali Acc: 0.129 Test Loss: 5.318 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.7001829
	speed: 0.8063s/iter; left time: 1534.4347s
Epoch: 18 cost time: 44.27242469787598
Epoch: 18, Steps: 154 | Train Loss: 0.848 Vali Loss: 6.619 Vali Acc: 0.094 Test Loss: 6.619 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38767234387672345
model parameter : 18780942
model size : 72.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7538514
	speed: 0.1181s/iter; left time: 534.1254s
Epoch: 1 cost time: 17.218045473098755
Epoch: 1, Steps: 154 | Train Loss: 2.087 Vali Loss: 2.087 Vali Acc: 0.335 Test Loss: 2.087 Test Acc: 0.335
Validation loss decreased (inf --> -0.335340).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5448346
	speed: 0.2886s/iter; left time: 1260.1041s
Epoch: 2 cost time: 14.494760274887085
Epoch: 2, Steps: 154 | Train Loss: 1.882 Vali Loss: 2.136 Vali Acc: 0.356 Test Loss: 2.136 Test Acc: 0.356
Validation loss decreased (-0.335340 --> -0.356021).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6432964
	speed: 0.2606s/iter; left time: 1098.0015s
Epoch: 3 cost time: 13.831341028213501
Epoch: 3, Steps: 154 | Train Loss: 1.729 Vali Loss: 2.088 Vali Acc: 0.358 Test Loss: 2.088 Test Acc: 0.358
Validation loss decreased (-0.356021 --> -0.358454).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0305479
	speed: 0.2577s/iter; left time: 1046.1837s
Epoch: 4 cost time: 13.462987661361694
Epoch: 4, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.056 Vali Acc: 0.230 Test Loss: 2.056 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.7939692
	speed: 0.2581s/iter; left time: 1007.8967s
Epoch: 5 cost time: 12.685489654541016
Epoch: 5, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.773 Vali Acc: 0.187 Test Loss: 2.773 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2332746
	speed: 0.2279s/iter; left time: 854.7557s
Epoch: 6 cost time: 12.212624311447144
Epoch: 6, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.266 Vali Acc: 0.254 Test Loss: 2.266 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.4148334
	speed: 0.2735s/iter; left time: 983.8725s
Epoch: 7 cost time: 13.265993118286133
Epoch: 7, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.585 Vali Acc: 0.182 Test Loss: 2.585 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.3500880
	speed: 0.2757s/iter; left time: 949.2762s
Epoch: 8 cost time: 13.232097387313843
Epoch: 8, Steps: 154 | Train Loss: 1.363 Vali Loss: 6.852 Vali Acc: 0.105 Test Loss: 6.852 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.8557190
	speed: 0.3135s/iter; left time: 1031.2265s
Epoch: 9 cost time: 15.993394613265991
Epoch: 9, Steps: 154 | Train Loss: 1.293 Vali Loss: 4.121 Vali Acc: 0.091 Test Loss: 4.121 Test Acc: 0.091
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.2330559
	speed: 0.3179s/iter; left time: 996.7560s
Epoch: 10 cost time: 16.599575757980347
Epoch: 10, Steps: 154 | Train Loss: 1.235 Vali Loss: 4.690 Vali Acc: 0.209 Test Loss: 4.690 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.1725838
	speed: 0.3182s/iter; left time: 948.5759s
Epoch: 11 cost time: 17.03946280479431
Epoch: 11, Steps: 154 | Train Loss: 1.170 Vali Loss: 3.648 Vali Acc: 0.163 Test Loss: 3.648 Test Acc: 0.163
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.8428713
	speed: 0.3148s/iter; left time: 889.8039s
Epoch: 12 cost time: 17.54422664642334
Epoch: 12, Steps: 154 | Train Loss: 1.083 Vali Loss: 5.347 Vali Acc: 0.108 Test Loss: 5.347 Test Acc: 0.108
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.7819028
	speed: 0.3132s/iter; left time: 837.2898s
Epoch: 13 cost time: 16.707459688186646
Epoch: 13, Steps: 154 | Train Loss: 1.027 Vali Loss: 4.248 Vali Acc: 0.175 Test Loss: 4.248 Test Acc: 0.175
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3584752635847526
model parameter : 5541390
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9518894
	speed: 0.1817s/iter; left time: 821.6797s
Epoch: 1 cost time: 28.073960542678833
Epoch: 1, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.086 Vali Acc: 0.330 Test Loss: 2.086 Test Acc: 0.330
Validation loss decreased (inf --> -0.330068).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2478540
	speed: 0.5162s/iter; left time: 2254.3981s
Epoch: 2 cost time: 27.444124698638916
Epoch: 2, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.284 Vali Acc: 0.330 Test Loss: 2.284 Test Acc: 0.330
Validation loss decreased (-0.330068 --> -0.330472).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8796291
	speed: 0.5083s/iter; left time: 2141.3469s
Epoch: 3 cost time: 26.61600947380066
Epoch: 3, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.706 Vali Acc: 0.182 Test Loss: 2.706 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.3090053
	speed: 0.5164s/iter; left time: 2096.2211s
Epoch: 4 cost time: 29.802470922470093
Epoch: 4, Steps: 154 | Train Loss: 1.692 Vali Loss: 3.588 Vali Acc: 0.067 Test Loss: 3.588 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.3390911
	speed: 0.5800s/iter; left time: 2265.0141s
Epoch: 5 cost time: 30.732508182525635
Epoch: 5, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.385 Vali Acc: 0.365 Test Loss: 2.385 Test Acc: 0.365
Validation loss decreased (-0.330472 --> -0.365345).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3338194
	speed: 0.5752s/iter; left time: 2157.5493s
Epoch: 6 cost time: 28.5252468585968
Epoch: 6, Steps: 154 | Train Loss: 1.539 Vali Loss: 3.958 Vali Acc: 0.120 Test Loss: 3.958 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9332536
	speed: 0.5314s/iter; left time: 1911.6155s
Epoch: 7 cost time: 29.169801712036133
Epoch: 7, Steps: 154 | Train Loss: 1.479 Vali Loss: 3.731 Vali Acc: 0.211 Test Loss: 3.731 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5014462
	speed: 0.4746s/iter; left time: 1634.0585s
Epoch: 8 cost time: 24.85843777656555
Epoch: 8, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.662 Vali Acc: 0.360 Test Loss: 2.662 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4872692
	speed: 0.4673s/iter; left time: 1536.9880s
Epoch: 9 cost time: 25.085277318954468
Epoch: 9, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.694 Vali Acc: 0.260 Test Loss: 2.694 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2485232
	speed: 0.4536s/iter; left time: 1421.8959s
Epoch: 10 cost time: 24.48889708518982
Epoch: 10, Steps: 154 | Train Loss: 1.318 Vali Loss: 3.182 Vali Acc: 0.125 Test Loss: 3.182 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.1981244
	speed: 0.4661s/iter; left time: 1389.4669s
Epoch: 11 cost time: 25.00638699531555
Epoch: 11, Steps: 154 | Train Loss: 1.245 Vali Loss: 2.260 Vali Acc: 0.403 Test Loss: 2.260 Test Acc: 0.403
Validation loss decreased (-0.365345 --> -0.403059).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.5522200
	speed: 0.5178s/iter; left time: 1463.9274s
Epoch: 12 cost time: 28.858705282211304
Epoch: 12, Steps: 154 | Train Loss: 1.188 Vali Loss: 7.304 Vali Acc: 0.126 Test Loss: 7.304 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4449078
	speed: 0.5400s/iter; left time: 1443.4506s
Epoch: 13 cost time: 28.973304510116577
Epoch: 13, Steps: 154 | Train Loss: 1.146 Vali Loss: 4.882 Vali Acc: 0.126 Test Loss: 4.882 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2145004
	speed: 0.5356s/iter; left time: 1349.2371s
Epoch: 14 cost time: 29.307598114013672
Epoch: 14, Steps: 154 | Train Loss: 1.115 Vali Loss: 4.014 Vali Acc: 0.112 Test Loss: 4.014 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.6454335
	speed: 0.4972s/iter; left time: 1175.9156s
Epoch: 15 cost time: 24.845536470413208
Epoch: 15, Steps: 154 | Train Loss: 1.033 Vali Loss: 4.112 Vali Acc: 0.131 Test Loss: 4.112 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.7886432
	speed: 0.4586s/iter; left time: 1013.8755s
Epoch: 16 cost time: 25.287458896636963
Epoch: 16, Steps: 154 | Train Loss: 0.971 Vali Loss: 3.767 Vali Acc: 0.180 Test Loss: 3.767 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0011406
	speed: 0.4601s/iter; left time: 946.3960s
Epoch: 17 cost time: 24.764575958251953
Epoch: 17, Steps: 154 | Train Loss: 0.925 Vali Loss: 4.758 Vali Acc: 0.150 Test Loss: 4.758 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.7810561
	speed: 0.4629s/iter; left time: 880.9695s
Epoch: 18 cost time: 25.13047766685486
Epoch: 18, Steps: 154 | Train Loss: 0.896 Vali Loss: 5.718 Vali Acc: 0.103 Test Loss: 5.718 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2940478
	speed: 0.4965s/iter; left time: 868.4026s
Epoch: 19 cost time: 28.47565007209778
Epoch: 19, Steps: 154 | Train Loss: 0.863 Vali Loss: 3.522 Vali Acc: 0.302 Test Loss: 3.522 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.4820001
	speed: 0.5405s/iter; left time: 862.0697s
Epoch: 20 cost time: 29.3044331073761
Epoch: 20, Steps: 154 | Train Loss: 0.790 Vali Loss: 4.704 Vali Acc: 0.104 Test Loss: 4.704 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.3582296
	speed: 0.5282s/iter; left time: 761.1865s
Epoch: 21 cost time: 28.6961452960968
Epoch: 21, Steps: 154 | Train Loss: 0.773 Vali Loss: 2.815 Vali Acc: 0.350 Test Loss: 2.815 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.40308191403081917
model parameter : 18780942
model size : 72.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7884928
	speed: 0.0700s/iter; left time: 316.5020s
Epoch: 1 cost time: 9.963756084442139
Epoch: 1, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.099 Vali Acc: 0.334 Test Loss: 2.099 Test Acc: 0.334
Validation loss decreased (inf --> -0.333718).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6038376
	speed: 0.1790s/iter; left time: 781.8585s
Epoch: 2 cost time: 10.562679529190063
Epoch: 2, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.092 Vali Acc: 0.355 Test Loss: 2.092 Test Acc: 0.355
Validation loss decreased (-0.333718 --> -0.354805).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8503375
	speed: 0.1910s/iter; left time: 804.5965s
Epoch: 3 cost time: 9.980055809020996
Epoch: 3, Steps: 154 | Train Loss: 1.766 Vali Loss: 1.964 Vali Acc: 0.373 Test Loss: 1.964 Test Acc: 0.373
Validation loss decreased (-0.354805 --> -0.373460).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7665792
	speed: 0.1938s/iter; left time: 786.5445s
Epoch: 4 cost time: 10.020958423614502
Epoch: 4, Steps: 154 | Train Loss: 1.637 Vali Loss: 1.959 Vali Acc: 0.381 Test Loss: 1.959 Test Acc: 0.381
Validation loss decreased (-0.373460 --> -0.380759).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7857088
	speed: 0.1975s/iter; left time: 771.3349s
Epoch: 5 cost time: 9.419559001922607
Epoch: 5, Steps: 154 | Train Loss: 1.553 Vali Loss: 5.291 Vali Acc: 0.144 Test Loss: 5.291 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4060484
	speed: 0.1959s/iter; left time: 734.8448s
Epoch: 6 cost time: 9.588130950927734
Epoch: 6, Steps: 154 | Train Loss: 1.466 Vali Loss: 2.091 Vali Acc: 0.410 Test Loss: 2.091 Test Acc: 0.410
Validation loss decreased (-0.380759 --> -0.409549).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4568362
	speed: 0.1994s/iter; left time: 717.3341s
Epoch: 7 cost time: 9.262260675430298
Epoch: 7, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.690 Vali Acc: 0.212 Test Loss: 2.690 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.8306727
	speed: 0.2145s/iter; left time: 738.4563s
Epoch: 8 cost time: 11.360388040542603
Epoch: 8, Steps: 154 | Train Loss: 1.361 Vali Loss: 5.575 Vali Acc: 0.086 Test Loss: 5.575 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.9379514
	speed: 0.2311s/iter; left time: 760.1813s
Epoch: 9 cost time: 11.707160949707031
Epoch: 9, Steps: 154 | Train Loss: 1.311 Vali Loss: 4.167 Vali Acc: 0.091 Test Loss: 4.167 Test Acc: 0.091
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2297430
	speed: 0.2290s/iter; left time: 718.0632s
Epoch: 10 cost time: 11.810818195343018
Epoch: 10, Steps: 154 | Train Loss: 1.311 Vali Loss: 5.067 Vali Acc: 0.216 Test Loss: 5.067 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3306401
	speed: 0.2777s/iter; left time: 827.9117s
Epoch: 11 cost time: 19.7249116897583
Epoch: 11, Steps: 154 | Train Loss: 1.171 Vali Loss: 4.451 Vali Acc: 0.248 Test Loss: 4.451 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.9843071
	speed: 0.4025s/iter; left time: 1137.8238s
Epoch: 12 cost time: 19.935962915420532
Epoch: 12, Steps: 154 | Train Loss: 1.109 Vali Loss: 6.471 Vali Acc: 0.090 Test Loss: 6.471 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0125954
	speed: 0.4018s/iter; left time: 1074.0649s
Epoch: 13 cost time: 19.70097279548645
Epoch: 13, Steps: 154 | Train Loss: 1.075 Vali Loss: 3.444 Vali Acc: 0.399 Test Loss: 3.444 Test Acc: 0.399
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1718682
	speed: 0.3978s/iter; left time: 1002.0312s
Epoch: 14 cost time: 18.3779935836792
Epoch: 14, Steps: 154 | Train Loss: 1.034 Vali Loss: 4.263 Vali Acc: 0.231 Test Loss: 4.263 Test Acc: 0.231
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2395513
	speed: 0.3641s/iter; left time: 861.1142s
Epoch: 15 cost time: 17.446173906326294
Epoch: 15, Steps: 154 | Train Loss: 0.961 Vali Loss: 9.279 Vali Acc: 0.086 Test Loss: 9.279 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.7451995
	speed: 0.3354s/iter; left time: 741.5081s
Epoch: 16 cost time: 15.191800832748413
Epoch: 16, Steps: 154 | Train Loss: 0.937 Vali Loss: 9.139 Vali Acc: 0.083 Test Loss: 9.139 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4095701540957015
model parameter : 5541390
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1231585
	speed: 0.1743s/iter; left time: 787.9281s
Epoch: 1 cost time: 25.91392683982849
Epoch: 1, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.106 Vali Acc: 0.327 Test Loss: 2.106 Test Acc: 0.327
Validation loss decreased (inf --> -0.326824).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2831962
	speed: 0.4513s/iter; left time: 1971.0138s
Epoch: 2 cost time: 23.700958013534546
Epoch: 2, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.245 Vali Acc: 0.329 Test Loss: 2.245 Test Acc: 0.329
Validation loss decreased (-0.326824 --> -0.328850).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7691499
	speed: 0.4619s/iter; left time: 1946.0086s
Epoch: 3 cost time: 24.131126880645752
Epoch: 3, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.344 Vali Acc: 0.353 Test Loss: 2.344 Test Acc: 0.353
Validation loss decreased (-0.328850 --> -0.352775).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1789756
	speed: 0.4633s/iter; left time: 1880.5971s
Epoch: 4 cost time: 25.122009992599487
Epoch: 4, Steps: 154 | Train Loss: 1.688 Vali Loss: 2.430 Vali Acc: 0.360 Test Loss: 2.430 Test Acc: 0.360
Validation loss decreased (-0.352775 --> -0.359668).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5296336
	speed: 0.4621s/iter; left time: 1804.3135s
Epoch: 5 cost time: 23.282055377960205
Epoch: 5, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.074 Vali Acc: 0.382 Test Loss: 2.074 Test Acc: 0.382
Validation loss decreased (-0.359668 --> -0.382380).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1364988
	speed: 0.4704s/iter; left time: 1764.4700s
Epoch: 6 cost time: 26.53897523880005
Epoch: 6, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.858 Vali Acc: 0.206 Test Loss: 2.858 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9649481
	speed: 0.5026s/iter; left time: 1807.8709s
Epoch: 7 cost time: 26.62750506401062
Epoch: 7, Steps: 154 | Train Loss: 1.514 Vali Loss: 3.203 Vali Acc: 0.200 Test Loss: 3.203 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4630495
	speed: 0.5005s/iter; left time: 1723.0798s
Epoch: 8 cost time: 26.345627069473267
Epoch: 8, Steps: 154 | Train Loss: 1.515 Vali Loss: 4.831 Vali Acc: 0.088 Test Loss: 4.831 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5256718
	speed: 0.4978s/iter; left time: 1637.2347s
Epoch: 9 cost time: 24.90332531929016
Epoch: 9, Steps: 154 | Train Loss: 1.414 Vali Loss: 4.416 Vali Acc: 0.107 Test Loss: 4.416 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3223276
	speed: 0.4089s/iter; left time: 1281.7721s
Epoch: 10 cost time: 20.82675075531006
Epoch: 10, Steps: 154 | Train Loss: 1.356 Vali Loss: 5.682 Vali Acc: 0.224 Test Loss: 5.682 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.1551737
	speed: 0.4014s/iter; left time: 1196.5159s
Epoch: 11 cost time: 24.023386001586914
Epoch: 11, Steps: 154 | Train Loss: 1.300 Vali Loss: 4.970 Vali Acc: 0.168 Test Loss: 4.970 Test Acc: 0.168
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 2.2496901
	speed: 0.4554s/iter; left time: 1287.4030s
Epoch: 12 cost time: 23.92304515838623
Epoch: 12, Steps: 154 | Train Loss: 1.221 Vali Loss: 7.030 Vali Acc: 0.084 Test Loss: 7.030 Test Acc: 0.084
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.3653327
	speed: 0.4504s/iter; left time: 1203.7982s
Epoch: 13 cost time: 23.556227445602417
Epoch: 13, Steps: 154 | Train Loss: 1.187 Vali Loss: 6.458 Vali Acc: 0.107 Test Loss: 6.458 Test Acc: 0.107
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0656843
	speed: 0.4515s/iter; left time: 1137.4154s
Epoch: 14 cost time: 23.554834842681885
Epoch: 14, Steps: 154 | Train Loss: 1.139 Vali Loss: 5.121 Vali Acc: 0.230 Test Loss: 5.121 Test Acc: 0.230
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.7069843
	speed: 0.4181s/iter; left time: 988.8983s
Epoch: 15 cost time: 21.332947969436646
Epoch: 15, Steps: 154 | Train Loss: 1.098 Vali Loss: 7.916 Vali Acc: 0.088 Test Loss: 7.916 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3824006488240065
model parameter : 18780942
model size : 72.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8192294
	speed: 0.0996s/iter; left time: 450.2092s
Epoch: 1 cost time: 14.55057406425476
Epoch: 1, Steps: 154 | Train Loss: 2.108 Vali Loss: 2.111 Vali Acc: 0.328 Test Loss: 2.111 Test Acc: 0.328
Validation loss decreased (inf --> -0.327635).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5553819
	speed: 0.2989s/iter; left time: 1305.1220s
Epoch: 2 cost time: 13.177527904510498
Epoch: 2, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.023 Vali Acc: 0.356 Test Loss: 2.023 Test Acc: 0.356
Validation loss decreased (-0.327635 --> -0.356022).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9430937
	speed: 0.2993s/iter; left time: 1261.0592s
Epoch: 3 cost time: 13.437235116958618
Epoch: 3, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.102 Vali Acc: 0.358 Test Loss: 2.102 Test Acc: 0.358
Validation loss decreased (-0.356022 --> -0.358049).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8316215
	speed: 0.2979s/iter; left time: 1209.0074s
Epoch: 4 cost time: 13.402286529541016
Epoch: 4, Steps: 154 | Train Loss: 1.669 Vali Loss: 1.997 Vali Acc: 0.390 Test Loss: 1.997 Test Acc: 0.390
Validation loss decreased (-0.358049 --> -0.390085).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0612187
	speed: 0.2981s/iter; left time: 1163.9074s
Epoch: 5 cost time: 13.25162672996521
Epoch: 5, Steps: 154 | Train Loss: 1.589 Vali Loss: 4.861 Vali Acc: 0.165 Test Loss: 4.861 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3171731
	speed: 0.2859s/iter; left time: 1072.3722s
Epoch: 6 cost time: 11.573325395584106
Epoch: 6, Steps: 154 | Train Loss: 1.516 Vali Loss: 2.523 Vali Acc: 0.221 Test Loss: 2.523 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5298945
	speed: 0.2504s/iter; left time: 900.5877s
Epoch: 7 cost time: 10.265560865402222
Epoch: 7, Steps: 154 | Train Loss: 1.418 Vali Loss: 4.269 Vali Acc: 0.176 Test Loss: 4.269 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6197915
	speed: 0.2440s/iter; left time: 840.1956s
Epoch: 8 cost time: 12.178146839141846
Epoch: 8, Steps: 154 | Train Loss: 1.373 Vali Loss: 4.708 Vali Acc: 0.086 Test Loss: 4.708 Test Acc: 0.086
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 2.0024102
	speed: 0.2671s/iter; left time: 878.5379s
Epoch: 9 cost time: 12.165037155151367
Epoch: 9, Steps: 154 | Train Loss: 1.299 Vali Loss: 4.511 Vali Acc: 0.100 Test Loss: 4.511 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.3080130
	speed: 0.2664s/iter; left time: 835.2546s
Epoch: 10 cost time: 11.80164909362793
Epoch: 10, Steps: 154 | Train Loss: 1.302 Vali Loss: 6.002 Vali Acc: 0.208 Test Loss: 6.002 Test Acc: 0.208
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3221177
	speed: 0.2667s/iter; left time: 795.0714s
Epoch: 11 cost time: 11.72090482711792
Epoch: 11, Steps: 154 | Train Loss: 1.210 Vali Loss: 4.013 Vali Acc: 0.239 Test Loss: 4.013 Test Acc: 0.239
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.7916849
	speed: 0.2675s/iter; left time: 756.1673s
Epoch: 12 cost time: 11.920105457305908
Epoch: 12, Steps: 154 | Train Loss: 1.173 Vali Loss: 9.348 Vali Acc: 0.077 Test Loss: 9.348 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.9513175
	speed: 0.2676s/iter; left time: 715.3406s
Epoch: 13 cost time: 12.13407588005066
Epoch: 13, Steps: 154 | Train Loss: 1.097 Vali Loss: 8.247 Vali Acc: 0.150 Test Loss: 8.247 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.1242024
	speed: 0.2398s/iter; left time: 604.1694s
Epoch: 14 cost time: 10.594698905944824
Epoch: 14, Steps: 154 | Train Loss: 1.052 Vali Loss: 4.826 Vali Acc: 0.225 Test Loss: 4.826 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39010543390105434
model parameter : 5541390
model size : 22.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9959122
	speed: 0.2666s/iter; left time: 1205.3426s
Epoch: 1 cost time: 41.87645745277405
Epoch: 1, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.097 Vali Acc: 0.331 Test Loss: 2.097 Test Acc: 0.331
Validation loss decreased (inf --> -0.330879).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0562644
	speed: 0.8587s/iter; left time: 3750.1049s
Epoch: 2 cost time: 41.709052085876465
Epoch: 2, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.196 Vali Acc: 0.347 Test Loss: 2.196 Test Acc: 0.347
Validation loss decreased (-0.330879 --> -0.347099).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9604027
	speed: 0.8477s/iter; left time: 3571.4571s
Epoch: 3 cost time: 39.824398040771484
Epoch: 3, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.062 Vali Acc: 0.361 Test Loss: 2.062 Test Acc: 0.361
Validation loss decreased (-0.347099 --> -0.360888).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2435519
	speed: 0.7855s/iter; left time: 3188.1768s
Epoch: 4 cost time: 39.38452219963074
Epoch: 4, Steps: 154 | Train Loss: 1.647 Vali Loss: 2.222 Vali Acc: 0.197 Test Loss: 2.222 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5993330
	speed: 0.8032s/iter; left time: 3136.6885s
Epoch: 5 cost time: 39.065518617630005
Epoch: 5, Steps: 154 | Train Loss: 1.570 Vali Loss: 2.522 Vali Acc: 0.205 Test Loss: 2.522 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4337269
	speed: 0.7833s/iter; left time: 2938.1870s
Epoch: 6 cost time: 38.11081671714783
Epoch: 6, Steps: 154 | Train Loss: 1.484 Vali Loss: 3.904 Vali Acc: 0.082 Test Loss: 3.904 Test Acc: 0.082
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3778135
	speed: 0.7309s/iter; left time: 2629.0074s
Epoch: 7 cost time: 32.53887581825256
Epoch: 7, Steps: 154 | Train Loss: 1.429 Vali Loss: 2.886 Vali Acc: 0.191 Test Loss: 2.886 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.1990056
	speed: 0.7428s/iter; left time: 2557.6255s
Epoch: 8 cost time: 37.88290596008301
Epoch: 8, Steps: 154 | Train Loss: 1.385 Vali Loss: 3.484 Vali Acc: 0.128 Test Loss: 3.484 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 2.1692829
	speed: 0.8368s/iter; left time: 2752.2905s
Epoch: 9 cost time: 42.36139917373657
Epoch: 9, Steps: 154 | Train Loss: 1.320 Vali Loss: 4.373 Vali Acc: 0.088 Test Loss: 4.373 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.1976117
	speed: 0.8460s/iter; left time: 2652.2444s
Epoch: 10 cost time: 39.07394099235535
Epoch: 10, Steps: 154 | Train Loss: 1.262 Vali Loss: 2.453 Vali Acc: 0.368 Test Loss: 2.453 Test Acc: 0.368
Validation loss decreased (-0.360888 --> -0.367778).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8062388
	speed: 0.7914s/iter; left time: 2359.1291s
Epoch: 11 cost time: 39.86698007583618
Epoch: 11, Steps: 154 | Train Loss: 1.224 Vali Loss: 3.639 Vali Acc: 0.130 Test Loss: 3.639 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1088910
	speed: 0.8312s/iter; left time: 2349.9202s
Epoch: 12 cost time: 38.642919301986694
Epoch: 12, Steps: 154 | Train Loss: 1.182 Vali Loss: 2.696 Vali Acc: 0.151 Test Loss: 2.696 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2911068
	speed: 0.7898s/iter; left time: 2111.1280s
Epoch: 13 cost time: 39.00079679489136
Epoch: 13, Steps: 154 | Train Loss: 1.131 Vali Loss: 4.293 Vali Acc: 0.097 Test Loss: 4.293 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0476557
	speed: 0.6855s/iter; left time: 1726.8419s
Epoch: 14 cost time: 31.863003730773926
Epoch: 14, Steps: 154 | Train Loss: 1.054 Vali Loss: 6.306 Vali Acc: 0.093 Test Loss: 6.306 Test Acc: 0.093
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3900917
	speed: 0.7328s/iter; left time: 1733.1270s
Epoch: 15 cost time: 36.03773283958435
Epoch: 15, Steps: 154 | Train Loss: 1.052 Vali Loss: 3.297 Vali Acc: 0.216 Test Loss: 3.297 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.5294779
	speed: 0.7474s/iter; left time: 1652.4052s
Epoch: 16 cost time: 38.49509048461914
Epoch: 16, Steps: 154 | Train Loss: 0.932 Vali Loss: 4.689 Vali Acc: 0.110 Test Loss: 4.689 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.5804347
	speed: 0.7885s/iter; left time: 1621.8975s
Epoch: 17 cost time: 35.76741647720337
Epoch: 17, Steps: 154 | Train Loss: 0.954 Vali Loss: 5.336 Vali Acc: 0.096 Test Loss: 5.336 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.7839762
	speed: 0.7579s/iter; left time: 1442.2253s
Epoch: 18 cost time: 38.44407653808594
Epoch: 18, Steps: 154 | Train Loss: 0.883 Vali Loss: 4.042 Vali Acc: 0.114 Test Loss: 4.042 Test Acc: 0.114
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.7636858
	speed: 0.8097s/iter; left time: 1416.2215s
Epoch: 19 cost time: 39.82597851753235
Epoch: 19, Steps: 154 | Train Loss: 0.858 Vali Loss: 6.128 Vali Acc: 0.106 Test Loss: 6.128 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0994468
	speed: 0.7600s/iter; left time: 1212.2777s
Epoch: 20 cost time: 34.849400758743286
Epoch: 20, Steps: 154 | Train Loss: 0.806 Vali Loss: 4.714 Vali Acc: 0.101 Test Loss: 4.714 Test Acc: 0.101
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3678021086780211
model parameter : 9407758
model size : 37.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2392800
	speed: 0.1185s/iter; left time: 535.6948s
Epoch: 1 cost time: 17.105164051055908
Epoch: 1, Steps: 154 | Train Loss: 2.099 Vali Loss: 2.121 Vali Acc: 0.333 Test Loss: 2.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.332907).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7740976
	speed: 0.3374s/iter; left time: 1473.4003s
Epoch: 2 cost time: 16.446600675582886
Epoch: 2, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.254 Vali Acc: 0.345 Test Loss: 2.254 Test Acc: 0.345
Validation loss decreased (-0.332907 --> -0.345476).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5606552
	speed: 0.3380s/iter; left time: 1424.1744s
Epoch: 3 cost time: 15.654565572738647
Epoch: 3, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.333 Vali Acc: 0.270 Test Loss: 2.333 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.1598475
	speed: 0.3430s/iter; left time: 1392.0378s
Epoch: 4 cost time: 15.236078262329102
Epoch: 4, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.138 Vali Acc: 0.386 Test Loss: 2.138 Test Acc: 0.386
Validation loss decreased (-0.345476 --> -0.385623).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.1977664
	speed: 0.3478s/iter; left time: 1358.1282s
Epoch: 5 cost time: 16.17641520500183
Epoch: 5, Steps: 154 | Train Loss: 1.495 Vali Loss: 2.976 Vali Acc: 0.203 Test Loss: 2.976 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1945883
	speed: 0.3270s/iter; left time: 1226.6771s
Epoch: 6 cost time: 16.067351579666138
Epoch: 6, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.675 Vali Acc: 0.214 Test Loss: 2.675 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1430982
	speed: 0.3413s/iter; left time: 1227.4821s
Epoch: 7 cost time: 16.846232652664185
Epoch: 7, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.774 Vali Acc: 0.377 Test Loss: 2.774 Test Acc: 0.377
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2958546
	speed: 0.3782s/iter; left time: 1302.0002s
Epoch: 8 cost time: 16.904216527938843
Epoch: 8, Steps: 154 | Train Loss: 1.300 Vali Loss: 2.412 Vali Acc: 0.250 Test Loss: 2.412 Test Acc: 0.250
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.5131308
	speed: 0.3782s/iter; left time: 1243.9410s
Epoch: 9 cost time: 17.646268367767334
Epoch: 9, Steps: 154 | Train Loss: 1.278 Vali Loss: 5.204 Vali Acc: 0.110 Test Loss: 5.204 Test Acc: 0.110
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.8831607
	speed: 0.3712s/iter; left time: 1163.7546s
Epoch: 10 cost time: 17.84012269973755
Epoch: 10, Steps: 154 | Train Loss: 1.192 Vali Loss: 3.098 Vali Acc: 0.230 Test Loss: 3.098 Test Acc: 0.230
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.9237756
	speed: 0.3756s/iter; left time: 1119.7389s
Epoch: 11 cost time: 17.032212018966675
Epoch: 11, Steps: 154 | Train Loss: 1.161 Vali Loss: 4.993 Vali Acc: 0.090 Test Loss: 4.993 Test Acc: 0.090
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.8602730
	speed: 0.3377s/iter; left time: 954.6963s
Epoch: 12 cost time: 13.758908033370972
Epoch: 12, Steps: 154 | Train Loss: 1.125 Vali Loss: 6.037 Vali Acc: 0.090 Test Loss: 6.037 Test Acc: 0.090
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.1883562
	speed: 0.3005s/iter; left time: 803.2565s
Epoch: 13 cost time: 15.05322551727295
Epoch: 13, Steps: 154 | Train Loss: 1.071 Vali Loss: 10.048 Vali Acc: 0.087 Test Loss: 10.048 Test Acc: 0.087
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0835609
	speed: 0.3366s/iter; left time: 847.9599s
Epoch: 14 cost time: 16.08365249633789
Epoch: 14, Steps: 154 | Train Loss: 1.021 Vali Loss: 7.391 Vali Acc: 0.094 Test Loss: 7.391 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38564476885644766
model parameter : 2787854
model size : 11.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9939604
	speed: 0.1660s/iter; left time: 750.6711s
Epoch: 1 cost time: 25.33521318435669
Epoch: 1, Steps: 154 | Train Loss: 2.105 Vali Loss: 2.084 Vali Acc: 0.335 Test Loss: 2.084 Test Acc: 0.335
Validation loss decreased (inf --> -0.334529).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0356851
	speed: 0.5218s/iter; left time: 2278.5451s
Epoch: 2 cost time: 25.728862047195435
Epoch: 2, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.305 Vali Acc: 0.361 Test Loss: 2.305 Test Acc: 0.361
Validation loss decreased (-0.334529 --> -0.360480).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8847007
	speed: 0.4958s/iter; left time: 2088.7445s
Epoch: 3 cost time: 22.57261824607849
Epoch: 3, Steps: 154 | Train Loss: 1.732 Vali Loss: 2.018 Vali Acc: 0.361 Test Loss: 2.018 Test Acc: 0.361
Validation loss decreased (-0.360480 --> -0.361294).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2767313
	speed: 0.5076s/iter; left time: 2060.2156s
Epoch: 4 cost time: 28.28497290611267
Epoch: 4, Steps: 154 | Train Loss: 1.658 Vali Loss: 2.148 Vali Acc: 0.358 Test Loss: 2.148 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6190454
	speed: 0.5750s/iter; left time: 2245.2503s
Epoch: 5 cost time: 28.629940509796143
Epoch: 5, Steps: 154 | Train Loss: 1.584 Vali Loss: 2.206 Vali Acc: 0.244 Test Loss: 2.206 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4381735
	speed: 0.5760s/iter; left time: 2160.5450s
Epoch: 6 cost time: 28.91558575630188
Epoch: 6, Steps: 154 | Train Loss: 1.526 Vali Loss: 4.060 Vali Acc: 0.080 Test Loss: 4.060 Test Acc: 0.080
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3235594
	speed: 0.5749s/iter; left time: 2068.0418s
Epoch: 7 cost time: 29.001765727996826
Epoch: 7, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.014 Vali Acc: 0.203 Test Loss: 3.014 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.1724883
	speed: 0.5225s/iter; left time: 1798.9100s
Epoch: 8 cost time: 25.902061939239502
Epoch: 8, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.699 Vali Acc: 0.084 Test Loss: 3.699 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.9187270
	speed: 0.5262s/iter; left time: 1730.6796s
Epoch: 9 cost time: 26.886078119277954
Epoch: 9, Steps: 154 | Train Loss: 1.357 Vali Loss: 4.741 Vali Acc: 0.082 Test Loss: 4.741 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.2077433
	speed: 0.5264s/iter; left time: 1650.2608s
Epoch: 10 cost time: 26.79568576812744
Epoch: 10, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.741 Vali Acc: 0.375 Test Loss: 2.741 Test Acc: 0.375
Validation loss decreased (-0.361294 --> -0.374668).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8868321
	speed: 0.5264s/iter; left time: 1569.2832s
Epoch: 11 cost time: 26.508891582489014
Epoch: 11, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.315 Vali Acc: 0.178 Test Loss: 3.315 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3448462
	speed: 0.5210s/iter; left time: 1472.9204s
Epoch: 12 cost time: 25.361387968063354
Epoch: 12, Steps: 154 | Train Loss: 1.203 Vali Loss: 4.119 Vali Acc: 0.094 Test Loss: 4.119 Test Acc: 0.094
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3774762
	speed: 0.4603s/iter; left time: 1230.3958s
Epoch: 13 cost time: 23.159443855285645
Epoch: 13, Steps: 154 | Train Loss: 1.159 Vali Loss: 5.277 Vali Acc: 0.095 Test Loss: 5.277 Test Acc: 0.095
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0066326
	speed: 0.5087s/iter; left time: 1281.3194s
Epoch: 14 cost time: 25.947715997695923
Epoch: 14, Steps: 154 | Train Loss: 1.105 Vali Loss: 6.646 Vali Acc: 0.088 Test Loss: 6.646 Test Acc: 0.088
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5320255
	speed: 0.5188s/iter; left time: 1226.8731s
Epoch: 15 cost time: 26.289380311965942
Epoch: 15, Steps: 154 | Train Loss: 1.043 Vali Loss: 5.489 Vali Acc: 0.147 Test Loss: 5.489 Test Acc: 0.147
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.6106224
	speed: 0.5261s/iter; left time: 1163.2684s
Epoch: 16 cost time: 26.320427894592285
Epoch: 16, Steps: 154 | Train Loss: 0.976 Vali Loss: 5.191 Vali Acc: 0.109 Test Loss: 5.191 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.5767114
	speed: 0.4807s/iter; left time: 988.7489s
Epoch: 17 cost time: 20.113070011138916
Epoch: 17, Steps: 154 | Train Loss: 0.967 Vali Loss: 5.297 Vali Acc: 0.100 Test Loss: 5.297 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8636421
	speed: 0.4517s/iter; left time: 859.5406s
Epoch: 18 cost time: 27.015995502471924
Epoch: 18, Steps: 154 | Train Loss: 0.907 Vali Loss: 6.663 Vali Acc: 0.101 Test Loss: 6.663 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.7173084
	speed: 0.5086s/iter; left time: 889.5535s
Epoch: 19 cost time: 27.873548984527588
Epoch: 19, Steps: 154 | Train Loss: 0.867 Vali Loss: 11.474 Vali Acc: 0.092 Test Loss: 11.474 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0262201
	speed: 0.5621s/iter; left time: 896.6202s
Epoch: 20 cost time: 26.98192048072815
Epoch: 20, Steps: 154 | Train Loss: 0.843 Vali Loss: 11.548 Vali Acc: 0.090 Test Loss: 11.548 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3746958637469586
model parameter : 9407758
model size : 37.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2432811
	speed: 0.1028s/iter; left time: 464.5442s
Epoch: 1 cost time: 15.137686252593994
Epoch: 1, Steps: 154 | Train Loss: 2.107 Vali Loss: 2.121 Vali Acc: 0.333 Test Loss: 2.121 Test Acc: 0.333
Validation loss decreased (inf --> -0.332907).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7930943
	speed: 0.3151s/iter; left time: 1375.9272s
Epoch: 2 cost time: 12.984540462493896
Epoch: 2, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.226 Vali Acc: 0.345 Test Loss: 2.226 Test Acc: 0.345
Validation loss decreased (-0.332907 --> -0.345477).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6110017
	speed: 0.2607s/iter; left time: 1098.4996s
Epoch: 3 cost time: 12.467084646224976
Epoch: 3, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.296 Vali Acc: 0.378 Test Loss: 2.296 Test Acc: 0.378
Validation loss decreased (-0.345477 --> -0.377917).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1849036
	speed: 0.3070s/iter; left time: 1246.3052s
Epoch: 4 cost time: 14.230440139770508
Epoch: 4, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.281 Vali Acc: 0.388 Test Loss: 2.281 Test Acc: 0.388
Validation loss decreased (-0.377917 --> -0.387650).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.2178538
	speed: 0.3116s/iter; left time: 1216.8296s
Epoch: 5 cost time: 13.13875699043274
Epoch: 5, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.868 Vali Acc: 0.199 Test Loss: 2.868 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5294126
	speed: 0.2633s/iter; left time: 987.5545s
Epoch: 6 cost time: 11.538763046264648
Epoch: 6, Steps: 154 | Train Loss: 1.423 Vali Loss: 4.182 Vali Acc: 0.128 Test Loss: 4.182 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2507471
	speed: 0.2740s/iter; left time: 985.7231s
Epoch: 7 cost time: 12.865433692932129
Epoch: 7, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.729 Vali Acc: 0.389 Test Loss: 2.729 Test Acc: 0.389
Validation loss decreased (-0.387650 --> -0.389267).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3394194
	speed: 0.2777s/iter; left time: 956.1338s
Epoch: 8 cost time: 12.402257204055786
Epoch: 8, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.397 Vali Acc: 0.376 Test Loss: 2.397 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6225971
	speed: 0.2375s/iter; left time: 780.9788s
Epoch: 9 cost time: 10.134578704833984
Epoch: 9, Steps: 154 | Train Loss: 1.297 Vali Loss: 4.803 Vali Acc: 0.161 Test Loss: 4.803 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0269723
	speed: 0.2706s/iter; left time: 848.2530s
Epoch: 10 cost time: 12.457058668136597
Epoch: 10, Steps: 154 | Train Loss: 1.241 Vali Loss: 3.537 Vali Acc: 0.199 Test Loss: 3.537 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0028939
	speed: 0.2737s/iter; left time: 815.8254s
Epoch: 11 cost time: 12.082234859466553
Epoch: 11, Steps: 154 | Train Loss: 1.194 Vali Loss: 5.045 Vali Acc: 0.101 Test Loss: 5.045 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.9179960
	speed: 0.2325s/iter; left time: 657.2866s
Epoch: 12 cost time: 9.838188886642456
Epoch: 12, Steps: 154 | Train Loss: 1.137 Vali Loss: 4.313 Vali Acc: 0.091 Test Loss: 4.313 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1016390
	speed: 0.2691s/iter; left time: 719.4037s
Epoch: 13 cost time: 12.511284351348877
Epoch: 13, Steps: 154 | Train Loss: 1.094 Vali Loss: 8.398 Vali Acc: 0.081 Test Loss: 8.398 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.9827507
	speed: 0.2772s/iter; left time: 698.2841s
Epoch: 14 cost time: 12.374328136444092
Epoch: 14, Steps: 154 | Train Loss: 1.030 Vali Loss: 6.465 Vali Acc: 0.095 Test Loss: 6.465 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 2.4135666
	speed: 0.2313s/iter; left time: 547.0815s
Epoch: 15 cost time: 10.525062799453735
Epoch: 15, Steps: 154 | Train Loss: 0.986 Vali Loss: 6.388 Vali Acc: 0.093 Test Loss: 6.388 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1736997
	speed: 0.2793s/iter; left time: 617.6099s
Epoch: 16 cost time: 12.437684535980225
Epoch: 16, Steps: 154 | Train Loss: 0.954 Vali Loss: 7.797 Vali Acc: 0.079 Test Loss: 7.797 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.6011159
	speed: 0.2756s/iter; left time: 566.8366s
Epoch: 17 cost time: 12.103122234344482
Epoch: 17, Steps: 154 | Train Loss: 0.905 Vali Loss: 5.902 Vali Acc: 0.097 Test Loss: 5.902 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 2787854
model size : 11.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9757521
	speed: 0.1327s/iter; left time: 599.9128s
Epoch: 1 cost time: 19.572474718093872
Epoch: 1, Steps: 154 | Train Loss: 2.116 Vali Loss: 2.117 Vali Acc: 0.326 Test Loss: 2.117 Test Acc: 0.326
Validation loss decreased (inf --> -0.326013).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0101976
	speed: 0.3711s/iter; left time: 1620.4730s
Epoch: 2 cost time: 18.257591247558594
Epoch: 2, Steps: 154 | Train Loss: 1.891 Vali Loss: 2.193 Vali Acc: 0.340 Test Loss: 2.193 Test Acc: 0.340
Validation loss decreased (-0.326013 --> -0.340205).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8546456
	speed: 0.3198s/iter; left time: 1347.4954s
Epoch: 3 cost time: 15.471838235855103
Epoch: 3, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.153 Vali Acc: 0.366 Test Loss: 2.153 Test Acc: 0.366
Validation loss decreased (-0.340205 --> -0.365753).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3681988
	speed: 0.3757s/iter; left time: 1524.8911s
Epoch: 4 cost time: 17.74920964241028
Epoch: 4, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.094 Vali Acc: 0.360 Test Loss: 2.094 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5716773
	speed: 0.3653s/iter; left time: 1426.6695s
Epoch: 5 cost time: 15.800835371017456
Epoch: 5, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.241 Vali Acc: 0.209 Test Loss: 2.241 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.4099365
	speed: 0.3254s/iter; left time: 1220.5769s
Epoch: 6 cost time: 17.856230974197388
Epoch: 6, Steps: 154 | Train Loss: 1.568 Vali Loss: 3.223 Vali Acc: 0.190 Test Loss: 3.223 Test Acc: 0.190
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.3043057
	speed: 0.3631s/iter; left time: 1306.0641s
Epoch: 7 cost time: 17.442830324172974
Epoch: 7, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.990 Vali Acc: 0.283 Test Loss: 2.990 Test Acc: 0.283
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.0385065
	speed: 0.3426s/iter; left time: 1179.6773s
Epoch: 8 cost time: 15.308787107467651
Epoch: 8, Steps: 154 | Train Loss: 1.462 Vali Loss: 4.989 Vali Acc: 0.088 Test Loss: 4.989 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.9920615
	speed: 0.3512s/iter; left time: 1154.9680s
Epoch: 9 cost time: 18.29554772377014
Epoch: 9, Steps: 154 | Train Loss: 1.394 Vali Loss: 10.018 Vali Acc: 0.081 Test Loss: 10.018 Test Acc: 0.081
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.1812407
	speed: 0.3777s/iter; left time: 1183.9970s
Epoch: 10 cost time: 18.130070209503174
Epoch: 10, Steps: 154 | Train Loss: 1.301 Vali Loss: 3.795 Vali Acc: 0.383 Test Loss: 3.795 Test Acc: 0.383
Validation loss decreased (-0.365753 --> -0.383174).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.8090698
	speed: 0.2908s/iter; left time: 866.9210s
Epoch: 11 cost time: 14.138362169265747
Epoch: 11, Steps: 154 | Train Loss: 1.299 Vali Loss: 4.033 Vali Acc: 0.122 Test Loss: 4.033 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1850905
	speed: 0.3277s/iter; left time: 926.4094s
Epoch: 12 cost time: 16.68563151359558
Epoch: 12, Steps: 154 | Train Loss: 1.242 Vali Loss: 8.351 Vali Acc: 0.096 Test Loss: 8.351 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3325312
	speed: 0.3266s/iter; left time: 872.9677s
Epoch: 13 cost time: 14.604261636734009
Epoch: 13, Steps: 154 | Train Loss: 1.171 Vali Loss: 9.354 Vali Acc: 0.100 Test Loss: 9.354 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6196947
	speed: 0.2884s/iter; left time: 726.3738s
Epoch: 14 cost time: 16.126128673553467
Epoch: 14, Steps: 154 | Train Loss: 1.096 Vali Loss: 8.598 Vali Acc: 0.096 Test Loss: 8.598 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1702330
	speed: 0.3335s/iter; left time: 788.6404s
Epoch: 15 cost time: 16.000138759613037
Epoch: 15, Steps: 154 | Train Loss: 1.085 Vali Loss: 7.781 Vali Acc: 0.099 Test Loss: 7.781 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 2.0633061
	speed: 0.3003s/iter; left time: 663.9929s
Epoch: 16 cost time: 12.765591859817505
Epoch: 16, Steps: 154 | Train Loss: 1.043 Vali Loss: 8.042 Vali Acc: 0.090 Test Loss: 8.042 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.7878260
	speed: 0.3085s/iter; left time: 634.5250s
Epoch: 17 cost time: 16.052666187286377
Epoch: 17, Steps: 154 | Train Loss: 0.965 Vali Loss: 8.083 Vali Acc: 0.093 Test Loss: 8.083 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3438050
	speed: 0.3355s/iter; left time: 638.3909s
Epoch: 18 cost time: 16.148340702056885
Epoch: 18, Steps: 154 | Train Loss: 0.984 Vali Loss: 7.455 Vali Acc: 0.113 Test Loss: 7.455 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.8071895
	speed: 0.2854s/iter; left time: 499.1131s
Epoch: 19 cost time: 13.684774160385132
Epoch: 19, Steps: 154 | Train Loss: 0.927 Vali Loss: 7.827 Vali Acc: 0.110 Test Loss: 7.827 Test Acc: 0.110
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2450831
	speed: 0.3303s/iter; left time: 526.9077s
Epoch: 20 cost time: 16.55242896080017
Epoch: 20, Steps: 154 | Train Loss: 0.881 Vali Loss: 12.026 Vali Acc: 0.100 Test Loss: 12.026 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38321167883211676
model parameter : 9407758
model size : 37.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2520437
	speed: 0.0693s/iter; left time: 313.3878s
Epoch: 1 cost time: 9.926898002624512
Epoch: 1, Steps: 154 | Train Loss: 2.115 Vali Loss: 2.124 Vali Acc: 0.332 Test Loss: 2.124 Test Acc: 0.332
Validation loss decreased (inf --> -0.331690).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8809371
	speed: 0.2374s/iter; left time: 1036.9256s
Epoch: 2 cost time: 10.36844253540039
Epoch: 2, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.210 Vali Acc: 0.341 Test Loss: 2.210 Test Acc: 0.341
Validation loss decreased (-0.331690 --> -0.341422).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6877099
	speed: 0.2420s/iter; left time: 1019.3602s
Epoch: 3 cost time: 10.4426908493042
Epoch: 3, Steps: 154 | Train Loss: 1.720 Vali Loss: 2.145 Vali Acc: 0.364 Test Loss: 2.145 Test Acc: 0.364
Validation loss decreased (-0.341422 --> -0.364131).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.0200906
	speed: 0.2377s/iter; left time: 964.9075s
Epoch: 4 cost time: 8.626966714859009
Epoch: 4, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.684 Vali Acc: 0.208 Test Loss: 2.684 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.2067261
	speed: 0.2051s/iter; left time: 801.0914s
Epoch: 5 cost time: 9.489819288253784
Epoch: 5, Steps: 154 | Train Loss: 1.533 Vali Loss: 3.407 Vali Acc: 0.185 Test Loss: 3.407 Test Acc: 0.185
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.3075180
	speed: 0.2429s/iter; left time: 911.0833s
Epoch: 6 cost time: 10.24534010887146
Epoch: 6, Steps: 154 | Train Loss: 1.451 Vali Loss: 3.850 Vali Acc: 0.182 Test Loss: 3.850 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.2355068
	speed: 0.2349s/iter; left time: 844.8128s
Epoch: 7 cost time: 9.98434066772461
Epoch: 7, Steps: 154 | Train Loss: 1.455 Vali Loss: 3.210 Vali Acc: 0.217 Test Loss: 3.210 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.2877501
	speed: 0.2198s/iter; left time: 756.9351s
Epoch: 8 cost time: 8.391396284103394
Epoch: 8, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.867 Vali Acc: 0.212 Test Loss: 3.867 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.5509697
	speed: 0.2017s/iter; left time: 663.3806s
Epoch: 9 cost time: 8.876162767410278
Epoch: 9, Steps: 154 | Train Loss: 1.360 Vali Loss: 4.472 Vali Acc: 0.200 Test Loss: 4.472 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.9704326
	speed: 0.1582s/iter; left time: 496.0514s
Epoch: 10 cost time: 7.767550468444824
Epoch: 10, Steps: 154 | Train Loss: 1.296 Vali Loss: 6.041 Vali Acc: 0.080 Test Loss: 6.041 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.3008562
	speed: 0.2525s/iter; left time: 752.6232s
Epoch: 11 cost time: 10.571163654327393
Epoch: 11, Steps: 154 | Train Loss: 1.238 Vali Loss: 8.055 Vali Acc: 0.065 Test Loss: 8.055 Test Acc: 0.065
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.9632692
	speed: 0.2561s/iter; left time: 723.9200s
Epoch: 12 cost time: 10.695212602615356
Epoch: 12, Steps: 154 | Train Loss: 1.193 Vali Loss: 8.876 Vali Acc: 0.081 Test Loss: 8.876 Test Acc: 0.081
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.3064027
	speed: 0.2560s/iter; left time: 684.3411s
Epoch: 13 cost time: 11.096484661102295
Epoch: 13, Steps: 154 | Train Loss: 1.194 Vali Loss: 10.121 Vali Acc: 0.077 Test Loss: 10.121 Test Acc: 0.077
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36415247364152475
model parameter : 2787854
model size : 11.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2571685
	speed: 0.1683s/iter; left time: 760.8132s
Epoch: 1 cost time: 24.233014583587646
Epoch: 1, Steps: 154 | Train Loss: 2.098 Vali Loss: 2.105 Vali Acc: 0.335 Test Loss: 2.105 Test Acc: 0.335
Validation loss decreased (inf --> -0.334529).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8555981
	speed: 0.4792s/iter; left time: 2092.8366s
Epoch: 2 cost time: 23.264101266860962
Epoch: 2, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.130 Vali Acc: 0.348 Test Loss: 2.130 Test Acc: 0.348
Validation loss decreased (-0.334529 --> -0.347911).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7776457
	speed: 0.5412s/iter; left time: 2279.8688s
Epoch: 3 cost time: 24.782435655593872
Epoch: 3, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.452 Vali Acc: 0.193 Test Loss: 2.452 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8596747
	speed: 0.5339s/iter; left time: 2167.0470s
Epoch: 4 cost time: 24.12367606163025
Epoch: 4, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.384 Vali Acc: 0.361 Test Loss: 2.384 Test Acc: 0.361
Validation loss decreased (-0.347911 --> -0.360479).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6064212
	speed: 0.4912s/iter; left time: 1918.0512s
Epoch: 5 cost time: 21.267422914505005
Epoch: 5, Steps: 154 | Train Loss: 1.492 Vali Loss: 2.383 Vali Acc: 0.377 Test Loss: 2.383 Test Acc: 0.377
Validation loss decreased (-0.360479 --> -0.377105).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2562264
	speed: 0.5094s/iter; left time: 1910.8654s
Epoch: 6 cost time: 24.517016172409058
Epoch: 6, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.431 Vali Acc: 0.222 Test Loss: 2.431 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5086044
	speed: 0.5332s/iter; left time: 1917.7495s
Epoch: 7 cost time: 24.023791313171387
Epoch: 7, Steps: 154 | Train Loss: 1.336 Vali Loss: 3.699 Vali Acc: 0.085 Test Loss: 3.699 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.7366096
	speed: 0.5474s/iter; left time: 1884.8041s
Epoch: 8 cost time: 24.32244300842285
Epoch: 8, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.621 Vali Acc: 0.221 Test Loss: 2.621 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2866315
	speed: 0.5291s/iter; left time: 1740.1421s
Epoch: 9 cost time: 26.608919382095337
Epoch: 9, Steps: 154 | Train Loss: 1.268 Vali Loss: 4.346 Vali Acc: 0.097 Test Loss: 4.346 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.1922435
	speed: 0.5872s/iter; left time: 1840.8427s
Epoch: 10 cost time: 26.643983840942383
Epoch: 10, Steps: 154 | Train Loss: 1.229 Vali Loss: 2.807 Vali Acc: 0.122 Test Loss: 2.807 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3829713
	speed: 0.5926s/iter; left time: 1766.6200s
Epoch: 11 cost time: 27.032432317733765
Epoch: 11, Steps: 154 | Train Loss: 1.195 Vali Loss: 4.057 Vali Acc: 0.094 Test Loss: 4.057 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.8851197
	speed: 0.5299s/iter; left time: 1498.1408s
Epoch: 12 cost time: 22.798047065734863
Epoch: 12, Steps: 154 | Train Loss: 1.148 Vali Loss: 2.852 Vali Acc: 0.376 Test Loss: 2.852 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5577853
	speed: 0.5510s/iter; left time: 1472.7873s
Epoch: 13 cost time: 25.62099051475525
Epoch: 13, Steps: 154 | Train Loss: 1.112 Vali Loss: 2.848 Vali Acc: 0.213 Test Loss: 2.848 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.9460524
	speed: 0.5651s/iter; left time: 1423.5654s
Epoch: 14 cost time: 25.728984832763672
Epoch: 14, Steps: 154 | Train Loss: 1.053 Vali Loss: 2.945 Vali Acc: 0.180 Test Loss: 2.945 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.2250779
	speed: 0.5113s/iter; left time: 1209.3378s
Epoch: 15 cost time: 20.255823612213135
Epoch: 15, Steps: 154 | Train Loss: 1.016 Vali Loss: 3.533 Vali Acc: 0.109 Test Loss: 3.533 Test Acc: 0.109
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3771289537712895
model parameter : 4721166
model size : 19.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8765993
	speed: 0.0934s/iter; left time: 422.4784s
Epoch: 1 cost time: 13.703327178955078
Epoch: 1, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.116 Vali Acc: 0.329 Test Loss: 2.116 Test Acc: 0.329
Validation loss decreased (inf --> -0.329257).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8590735
	speed: 0.2756s/iter; left time: 1203.5983s
Epoch: 2 cost time: 12.299049615859985
Epoch: 2, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.210 Vali Acc: 0.334 Test Loss: 2.210 Test Acc: 0.334
Validation loss decreased (-0.329257 --> -0.334122).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7316589
	speed: 0.2752s/iter; left time: 1159.4510s
Epoch: 3 cost time: 12.45811939239502
Epoch: 3, Steps: 154 | Train Loss: 1.723 Vali Loss: 2.120 Vali Acc: 0.352 Test Loss: 2.120 Test Acc: 0.352
Validation loss decreased (-0.334122 --> -0.351560).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9353900
	speed: 0.2626s/iter; left time: 1065.7044s
Epoch: 4 cost time: 10.712740182876587
Epoch: 4, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.406 Vali Acc: 0.371 Test Loss: 2.406 Test Acc: 0.371
Validation loss decreased (-0.351560 --> -0.370617).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9683096
	speed: 0.2382s/iter; left time: 930.2706s
Epoch: 5 cost time: 10.539570331573486
Epoch: 5, Steps: 154 | Train Loss: 1.508 Vali Loss: 2.553 Vali Acc: 0.359 Test Loss: 2.553 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2890567
	speed: 0.2669s/iter; left time: 1001.2663s
Epoch: 6 cost time: 12.39958906173706
Epoch: 6, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.299 Vali Acc: 0.084 Test Loss: 3.299 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5117217
	speed: 0.2760s/iter; left time: 992.8169s
Epoch: 7 cost time: 12.404575109481812
Epoch: 7, Steps: 154 | Train Loss: 1.349 Vali Loss: 4.002 Vali Acc: 0.142 Test Loss: 4.002 Test Acc: 0.142
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2973272
	speed: 0.2776s/iter; left time: 955.7797s
Epoch: 8 cost time: 12.597914457321167
Epoch: 8, Steps: 154 | Train Loss: 1.298 Vali Loss: 3.001 Vali Acc: 0.223 Test Loss: 3.001 Test Acc: 0.223
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.2102123
	speed: 0.2753s/iter; left time: 905.3500s
Epoch: 9 cost time: 12.073382139205933
Epoch: 9, Steps: 154 | Train Loss: 1.225 Vali Loss: 4.364 Vali Acc: 0.103 Test Loss: 4.364 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0243976
	speed: 0.2530s/iter; left time: 793.1072s
Epoch: 10 cost time: 12.40575385093689
Epoch: 10, Steps: 154 | Train Loss: 1.195 Vali Loss: 5.263 Vali Acc: 0.088 Test Loss: 5.263 Test Acc: 0.088
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3239321
	speed: 0.2834s/iter; left time: 844.6691s
Epoch: 11 cost time: 13.446924924850464
Epoch: 11, Steps: 154 | Train Loss: 1.117 Vali Loss: 5.179 Vali Acc: 0.103 Test Loss: 5.179 Test Acc: 0.103
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.0109421
	speed: 0.3042s/iter; left time: 860.0507s
Epoch: 12 cost time: 13.610912799835205
Epoch: 12, Steps: 154 | Train Loss: 1.066 Vali Loss: 4.529 Vali Acc: 0.099 Test Loss: 4.529 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.2851967
	speed: 0.3055s/iter; left time: 816.7297s
Epoch: 13 cost time: 13.5816171169281
Epoch: 13, Steps: 154 | Train Loss: 1.068 Vali Loss: 4.241 Vali Acc: 0.190 Test Loss: 4.241 Test Acc: 0.190
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.1442653
	speed: 0.3050s/iter; left time: 768.4001s
Epoch: 14 cost time: 13.631551742553711
Epoch: 14, Steps: 154 | Train Loss: 0.988 Vali Loss: 6.314 Vali Acc: 0.099 Test Loss: 6.314 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3706407137064071
model parameter : 1411086
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2563903
	speed: 0.1204s/iter; left time: 544.2242s
Epoch: 1 cost time: 17.87567687034607
Epoch: 1, Steps: 154 | Train Loss: 2.106 Vali Loss: 2.101 Vali Acc: 0.335 Test Loss: 2.101 Test Acc: 0.335
Validation loss decreased (inf --> -0.335340).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7828690
	speed: 0.3961s/iter; left time: 1729.9561s
Epoch: 2 cost time: 18.875590324401855
Epoch: 2, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.122 Vali Acc: 0.351 Test Loss: 2.122 Test Acc: 0.351
Validation loss decreased (-0.335340 --> -0.351155).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8739858
	speed: 0.4248s/iter; left time: 1789.7757s
Epoch: 3 cost time: 18.98442578315735
Epoch: 3, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.968 Vali Acc: 0.192 Test Loss: 2.968 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.0039001
	speed: 0.4236s/iter; left time: 1719.4551s
Epoch: 4 cost time: 19.05743098258972
Epoch: 4, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.492 Vali Acc: 0.365 Test Loss: 2.492 Test Acc: 0.365
Validation loss decreased (-0.351155 --> -0.365344).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3567200
	speed: 0.3966s/iter; left time: 1548.7912s
Epoch: 5 cost time: 15.718815088272095
Epoch: 5, Steps: 154 | Train Loss: 1.489 Vali Loss: 3.020 Vali Acc: 0.382 Test Loss: 3.020 Test Acc: 0.382
Validation loss decreased (-0.365344 --> -0.382370).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2608781
	speed: 0.3494s/iter; left time: 1310.7024s
Epoch: 6 cost time: 17.08802556991577
Epoch: 6, Steps: 154 | Train Loss: 1.440 Vali Loss: 2.723 Vali Acc: 0.145 Test Loss: 2.723 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3608065
	speed: 0.3795s/iter; left time: 1364.9070s
Epoch: 7 cost time: 16.98676061630249
Epoch: 7, Steps: 154 | Train Loss: 1.389 Vali Loss: 4.806 Vali Acc: 0.079 Test Loss: 4.806 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.8223613
	speed: 0.3780s/iter; left time: 1301.4500s
Epoch: 8 cost time: 16.779901027679443
Epoch: 8, Steps: 154 | Train Loss: 1.360 Vali Loss: 4.476 Vali Acc: 0.114 Test Loss: 4.476 Test Acc: 0.114
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2884015
	speed: 0.3648s/iter; left time: 1199.8470s
Epoch: 9 cost time: 14.767603874206543
Epoch: 9, Steps: 154 | Train Loss: 1.290 Vali Loss: 5.605 Vali Acc: 0.090 Test Loss: 5.605 Test Acc: 0.090
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3216054
	speed: 0.3167s/iter; left time: 992.7516s
Epoch: 10 cost time: 14.833206176757812
Epoch: 10, Steps: 154 | Train Loss: 1.255 Vali Loss: 2.861 Vali Acc: 0.202 Test Loss: 2.861 Test Acc: 0.202
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3078353
	speed: 0.3796s/iter; left time: 1131.7093s
Epoch: 11 cost time: 16.942244052886963
Epoch: 11, Steps: 154 | Train Loss: 1.198 Vali Loss: 5.470 Vali Acc: 0.092 Test Loss: 5.470 Test Acc: 0.092
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.0913839
	speed: 0.3818s/iter; left time: 1079.3729s
Epoch: 12 cost time: 17.00249457359314
Epoch: 12, Steps: 154 | Train Loss: 1.191 Vali Loss: 3.062 Vali Acc: 0.230 Test Loss: 3.062 Test Acc: 0.230
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5879747
	speed: 0.3787s/iter; left time: 1012.3128s
Epoch: 13 cost time: 16.797950267791748
Epoch: 13, Steps: 154 | Train Loss: 1.146 Vali Loss: 3.169 Vali Acc: 0.206 Test Loss: 3.169 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0724566
	speed: 0.3316s/iter; left time: 835.1769s
Epoch: 14 cost time: 14.638418674468994
Epoch: 14, Steps: 154 | Train Loss: 1.093 Vali Loss: 4.490 Vali Acc: 0.160 Test Loss: 4.490 Test Acc: 0.160
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.1713639
	speed: 0.3401s/iter; left time: 804.2616s
Epoch: 15 cost time: 18.70662260055542
Epoch: 15, Steps: 154 | Train Loss: 1.039 Vali Loss: 5.505 Vali Acc: 0.094 Test Loss: 5.505 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3824006488240065
model parameter : 4721166
model size : 19.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8953871
	speed: 0.0907s/iter; left time: 410.0187s
Epoch: 1 cost time: 13.231926441192627
Epoch: 1, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.143 Vali Acc: 0.326 Test Loss: 2.143 Test Acc: 0.326
Validation loss decreased (inf --> -0.326013).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8102280
	speed: 0.2803s/iter; left time: 1223.9789s
Epoch: 2 cost time: 11.766276121139526
Epoch: 2, Steps: 154 | Train Loss: 1.897 Vali Loss: 2.270 Vali Acc: 0.331 Test Loss: 2.270 Test Acc: 0.331
Validation loss decreased (-0.326013 --> -0.330878).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8473663
	speed: 0.2606s/iter; left time: 1097.9950s
Epoch: 3 cost time: 10.328214645385742
Epoch: 3, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.026 Vali Acc: 0.361 Test Loss: 2.026 Test Acc: 0.361
Validation loss decreased (-0.330878 --> -0.361294).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8856399
	speed: 0.2409s/iter; left time: 977.9549s
Epoch: 4 cost time: 10.601352214813232
Epoch: 4, Steps: 154 | Train Loss: 1.619 Vali Loss: 2.603 Vali Acc: 0.365 Test Loss: 2.603 Test Acc: 0.365
Validation loss decreased (-0.361294 --> -0.365343).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8466321
	speed: 0.2749s/iter; left time: 1073.2936s
Epoch: 5 cost time: 11.711985111236572
Epoch: 5, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.680 Vali Acc: 0.361 Test Loss: 2.680 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4092742
	speed: 0.2803s/iter; left time: 1051.5622s
Epoch: 6 cost time: 11.909578800201416
Epoch: 6, Steps: 154 | Train Loss: 1.442 Vali Loss: 2.724 Vali Acc: 0.087 Test Loss: 2.724 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4416428
	speed: 0.2813s/iter; left time: 1011.8345s
Epoch: 7 cost time: 11.884060382843018
Epoch: 7, Steps: 154 | Train Loss: 1.378 Vali Loss: 3.622 Vali Acc: 0.184 Test Loss: 3.622 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.9956708
	speed: 0.2818s/iter; left time: 970.1128s
Epoch: 8 cost time: 11.88407564163208
Epoch: 8, Steps: 154 | Train Loss: 1.302 Vali Loss: 3.747 Vali Acc: 0.215 Test Loss: 3.747 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.1198303
	speed: 0.2539s/iter; left time: 834.9547s
Epoch: 9 cost time: 10.398289442062378
Epoch: 9, Steps: 154 | Train Loss: 1.223 Vali Loss: 5.605 Vali Acc: 0.086 Test Loss: 5.605 Test Acc: 0.086
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0413661
	speed: 0.2424s/iter; left time: 760.0136s
Epoch: 10 cost time: 11.118989706039429
Epoch: 10, Steps: 154 | Train Loss: 1.186 Vali Loss: 5.052 Vali Acc: 0.120 Test Loss: 5.052 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.2606863
	speed: 0.2537s/iter; left time: 756.2731s
Epoch: 11 cost time: 10.607370138168335
Epoch: 11, Steps: 154 | Train Loss: 1.121 Vali Loss: 6.079 Vali Acc: 0.101 Test Loss: 6.079 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.1862007
	speed: 0.2489s/iter; left time: 703.7004s
Epoch: 12 cost time: 10.435099840164185
Epoch: 12, Steps: 154 | Train Loss: 1.092 Vali Loss: 6.125 Vali Acc: 0.085 Test Loss: 6.125 Test Acc: 0.085
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.1846544
	speed: 0.2501s/iter; left time: 668.4642s
Epoch: 13 cost time: 10.50709080696106
Epoch: 13, Steps: 154 | Train Loss: 1.088 Vali Loss: 4.290 Vali Acc: 0.236 Test Loss: 4.290 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.1370493
	speed: 0.2501s/iter; left time: 629.9361s
Epoch: 14 cost time: 10.514000415802002
Epoch: 14, Steps: 154 | Train Loss: 1.018 Vali Loss: 8.112 Vali Acc: 0.086 Test Loss: 8.112 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3653690186536902
model parameter : 1411086
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2558265
	speed: 0.0808s/iter; left time: 365.3327s
Epoch: 1 cost time: 11.976206064224243
Epoch: 1, Steps: 154 | Train Loss: 2.115 Vali Loss: 2.080 Vali Acc: 0.333 Test Loss: 2.080 Test Acc: 0.333
Validation loss decreased (inf --> -0.333313).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7829970
	speed: 0.2578s/iter; left time: 1125.7758s
Epoch: 2 cost time: 11.199779272079468
Epoch: 2, Steps: 154 | Train Loss: 1.893 Vali Loss: 2.196 Vali Acc: 0.191 Test Loss: 2.196 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9434196
	speed: 0.2596s/iter; left time: 1093.7914s
Epoch: 3 cost time: 11.300012588500977
Epoch: 3, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.350 Vali Acc: 0.194 Test Loss: 2.350 Test Acc: 0.194
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.9975632
	speed: 0.2592s/iter; left time: 1052.0006s
Epoch: 4 cost time: 11.227400064468384
Epoch: 4, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.411 Vali Acc: 0.370 Test Loss: 2.411 Test Acc: 0.370
Validation loss decreased (-0.333313 --> -0.370211).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.3854481
	speed: 0.2624s/iter; left time: 1024.6874s
Epoch: 5 cost time: 10.70173692703247
Epoch: 5, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.558 Vali Acc: 0.371 Test Loss: 2.558 Test Acc: 0.371
Validation loss decreased (-0.370211 --> -0.371021).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4177351
	speed: 0.2182s/iter; left time: 818.2939s
Epoch: 6 cost time: 9.575768232345581
Epoch: 6, Steps: 154 | Train Loss: 1.528 Vali Loss: 3.207 Vali Acc: 0.091 Test Loss: 3.207 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6463207
	speed: 0.2186s/iter; left time: 786.2716s
Epoch: 7 cost time: 11.103110074996948
Epoch: 7, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.829 Vali Acc: 0.391 Test Loss: 2.829 Test Acc: 0.391
Validation loss decreased (-0.371021 --> -0.390888).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7328030
	speed: 0.2694s/iter; left time: 927.6916s
Epoch: 8 cost time: 12.624751567840576
Epoch: 8, Steps: 154 | Train Loss: 1.426 Vali Loss: 3.859 Vali Acc: 0.210 Test Loss: 3.859 Test Acc: 0.210
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2390862
	speed: 0.2925s/iter; left time: 962.1327s
Epoch: 9 cost time: 12.651541233062744
Epoch: 9, Steps: 154 | Train Loss: 1.362 Vali Loss: 4.961 Vali Acc: 0.101 Test Loss: 4.961 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3297778
	speed: 0.2927s/iter; left time: 917.7096s
Epoch: 10 cost time: 12.545948266983032
Epoch: 10, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.472 Vali Acc: 0.206 Test Loss: 3.472 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2770100
	speed: 0.2859s/iter; left time: 852.3071s
Epoch: 11 cost time: 11.462034225463867
Epoch: 11, Steps: 154 | Train Loss: 1.285 Vali Loss: 6.469 Vali Acc: 0.095 Test Loss: 6.469 Test Acc: 0.095
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0584000
	speed: 0.2499s/iter; left time: 706.4118s
Epoch: 12 cost time: 10.970085859298706
Epoch: 12, Steps: 154 | Train Loss: 1.248 Vali Loss: 6.082 Vali Acc: 0.094 Test Loss: 6.082 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.7756379
	speed: 0.2718s/iter; left time: 726.6047s
Epoch: 13 cost time: 12.566142559051514
Epoch: 13, Steps: 154 | Train Loss: 1.193 Vali Loss: 7.562 Vali Acc: 0.078 Test Loss: 7.562 Test Acc: 0.078
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.1964676
	speed: 0.2921s/iter; left time: 735.8311s
Epoch: 14 cost time: 12.708724737167358
Epoch: 14, Steps: 154 | Train Loss: 1.184 Vali Loss: 7.421 Vali Acc: 0.089 Test Loss: 7.421 Test Acc: 0.089
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1597406
	speed: 0.2931s/iter; left time: 693.2890s
Epoch: 15 cost time: 12.666032552719116
Epoch: 15, Steps: 154 | Train Loss: 1.096 Vali Loss: 7.463 Vali Acc: 0.075 Test Loss: 7.463 Test Acc: 0.075
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3061789
	speed: 0.2926s/iter; left time: 646.9700s
Epoch: 16 cost time: 12.648513793945312
Epoch: 16, Steps: 154 | Train Loss: 1.094 Vali Loss: 7.220 Vali Acc: 0.091 Test Loss: 7.220 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.0266969
	speed: 0.2776s/iter; left time: 570.9911s
Epoch: 17 cost time: 10.820974588394165
Epoch: 17, Steps: 154 | Train Loss: 1.051 Vali Loss: 7.299 Vali Acc: 0.084 Test Loss: 7.299 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3909164639091646
model parameter : 4721166
model size : 19.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9216813
	speed: 0.0678s/iter; left time: 306.3955s
Epoch: 1 cost time: 9.834463357925415
Epoch: 1, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.160 Vali Acc: 0.325 Test Loss: 2.160 Test Acc: 0.325
Validation loss decreased (inf --> -0.324796).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8609154
	speed: 0.2225s/iter; left time: 971.7197s
Epoch: 2 cost time: 8.635816097259521
Epoch: 2, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.219 Vali Acc: 0.336 Test Loss: 2.219 Test Acc: 0.336
Validation loss decreased (-0.324796 --> -0.336150).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0558922
	speed: 0.1986s/iter; left time: 836.5489s
Epoch: 3 cost time: 7.952696800231934
Epoch: 3, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.192 Vali Acc: 0.350 Test Loss: 2.192 Test Acc: 0.350
Validation loss decreased (-0.336150 --> -0.350343).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8916807
	speed: 0.2006s/iter; left time: 814.0549s
Epoch: 4 cost time: 8.00676703453064
Epoch: 4, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.346 Vali Acc: 0.367 Test Loss: 2.346 Test Acc: 0.367
Validation loss decreased (-0.350343 --> -0.367373).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2308352
	speed: 0.1996s/iter; left time: 779.3831s
Epoch: 5 cost time: 7.95183539390564
Epoch: 5, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.797 Vali Acc: 0.360 Test Loss: 2.797 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4001293
	speed: 0.1871s/iter; left time: 701.7311s
Epoch: 6 cost time: 6.8809285163879395
Epoch: 6, Steps: 154 | Train Loss: 1.493 Vali Loss: 3.069 Vali Acc: 0.086 Test Loss: 3.069 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3275530
	speed: 0.1696s/iter; left time: 609.9495s
Epoch: 7 cost time: 6.88586950302124
Epoch: 7, Steps: 154 | Train Loss: 1.421 Vali Loss: 5.098 Vali Acc: 0.079 Test Loss: 5.098 Test Acc: 0.079
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2222891
	speed: 0.1886s/iter; left time: 649.3555s
Epoch: 8 cost time: 7.92359185218811
Epoch: 8, Steps: 154 | Train Loss: 1.364 Vali Loss: 4.172 Vali Acc: 0.204 Test Loss: 4.172 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.1307644
	speed: 0.1982s/iter; left time: 651.7932s
Epoch: 9 cost time: 7.860034227371216
Epoch: 9, Steps: 154 | Train Loss: 1.305 Vali Loss: 8.402 Vali Acc: 0.071 Test Loss: 8.402 Test Acc: 0.071
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0545369
	speed: 0.1976s/iter; left time: 619.4086s
Epoch: 10 cost time: 8.006327152252197
Epoch: 10, Steps: 154 | Train Loss: 1.208 Vali Loss: 6.687 Vali Acc: 0.084 Test Loss: 6.687 Test Acc: 0.084
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.2254364
	speed: 0.1994s/iter; left time: 594.3116s
Epoch: 11 cost time: 8.034608125686646
Epoch: 11, Steps: 154 | Train Loss: 1.159 Vali Loss: 9.303 Vali Acc: 0.082 Test Loss: 9.303 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.0982935
	speed: 0.2001s/iter; left time: 565.6060s
Epoch: 12 cost time: 7.883823394775391
Epoch: 12, Steps: 154 | Train Loss: 1.150 Vali Loss: 8.033 Vali Acc: 0.079 Test Loss: 8.033 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.1578227
	speed: 0.1799s/iter; left time: 480.9220s
Epoch: 13 cost time: 6.880040168762207
Epoch: 13, Steps: 154 | Train Loss: 1.145 Vali Loss: 7.672 Vali Acc: 0.115 Test Loss: 7.672 Test Acc: 0.115
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.2626574
	speed: 0.1717s/iter; left time: 432.6338s
Epoch: 14 cost time: 6.752275466918945
Epoch: 14, Steps: 154 | Train Loss: 1.090 Vali Loss: 8.796 Vali Acc: 0.094 Test Loss: 8.796 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36739659367396593
model parameter : 1411086
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0123844
	speed: 0.1452s/iter; left time: 656.3657s
Epoch: 1 cost time: 21.765496969223022
Epoch: 1, Steps: 154 | Train Loss: 2.140 Vali Loss: 2.078 Vali Acc: 0.327 Test Loss: 2.078 Test Acc: 0.327
Validation loss decreased (inf --> -0.327230).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0052245
	speed: 0.4472s/iter; left time: 1953.0807s
Epoch: 2 cost time: 22.72040557861328
Epoch: 2, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.233 Vali Acc: 0.336 Test Loss: 2.233 Test Acc: 0.336
Validation loss decreased (-0.327230 --> -0.336150).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4382110
	speed: 0.4571s/iter; left time: 1925.6384s
Epoch: 3 cost time: 20.66403865814209
Epoch: 3, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.113 Vali Acc: 0.347 Test Loss: 2.113 Test Acc: 0.347
Validation loss decreased (-0.336150 --> -0.346694).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9854615
	speed: 0.4161s/iter; left time: 1688.8488s
Epoch: 4 cost time: 21.76864266395569
Epoch: 4, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.697 Vali Acc: 0.192 Test Loss: 2.697 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3216146
	speed: 0.4664s/iter; left time: 1821.1143s
Epoch: 5 cost time: 22.59302544593811
Epoch: 5, Steps: 154 | Train Loss: 1.605 Vali Loss: 2.009 Vali Acc: 0.365 Test Loss: 2.009 Test Acc: 0.365
Validation loss decreased (-0.346694 --> -0.364943).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4722728
	speed: 0.4701s/iter; left time: 1763.2660s
Epoch: 6 cost time: 22.869454860687256
Epoch: 6, Steps: 154 | Train Loss: 1.528 Vali Loss: 1.991 Vali Acc: 0.378 Test Loss: 1.991 Test Acc: 0.378
Validation loss decreased (-0.364943 --> -0.377515).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1572630
	speed: 0.4587s/iter; left time: 1650.0668s
Epoch: 7 cost time: 20.901395797729492
Epoch: 7, Steps: 154 | Train Loss: 1.438 Vali Loss: 2.361 Vali Acc: 0.178 Test Loss: 2.361 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4025908
	speed: 0.4166s/iter; left time: 1434.3785s
Epoch: 8 cost time: 21.940533876419067
Epoch: 8, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.098 Vali Acc: 0.209 Test Loss: 3.098 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4018691
	speed: 0.4691s/iter; left time: 1542.8049s
Epoch: 9 cost time: 22.854336261749268
Epoch: 9, Steps: 154 | Train Loss: 1.359 Vali Loss: 4.010 Vali Acc: 0.077 Test Loss: 4.010 Test Acc: 0.077
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0595570
	speed: 0.4508s/iter; left time: 1413.3388s
Epoch: 10 cost time: 20.629061460494995
Epoch: 10, Steps: 154 | Train Loss: 1.317 Vali Loss: 2.414 Vali Acc: 0.333 Test Loss: 2.414 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4527715
	speed: 0.4109s/iter; left time: 1224.8203s
Epoch: 11 cost time: 18.390796661376953
Epoch: 11, Steps: 154 | Train Loss: 1.253 Vali Loss: 4.834 Vali Acc: 0.133 Test Loss: 4.834 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0211382
	speed: 0.3727s/iter; left time: 1053.7015s
Epoch: 12 cost time: 19.799221754074097
Epoch: 12, Steps: 154 | Train Loss: 1.198 Vali Loss: 4.498 Vali Acc: 0.144 Test Loss: 4.498 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.5085535
	speed: 0.4217s/iter; left time: 1127.1483s
Epoch: 13 cost time: 20.57804274559021
Epoch: 13, Steps: 154 | Train Loss: 1.177 Vali Loss: 2.626 Vali Acc: 0.339 Test Loss: 2.626 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.2199934
	speed: 0.4190s/iter; left time: 1055.4220s
Epoch: 14 cost time: 20.4555242061615
Epoch: 14, Steps: 154 | Train Loss: 1.115 Vali Loss: 3.810 Vali Acc: 0.174 Test Loss: 3.810 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.7824805
	speed: 0.4068s/iter; left time: 962.0628s
Epoch: 15 cost time: 18.034987926483154
Epoch: 15, Steps: 154 | Train Loss: 1.068 Vali Loss: 4.263 Vali Acc: 0.126 Test Loss: 4.263 Test Acc: 0.126
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.1857808
	speed: 0.3777s/iter; left time: 835.2014s
Epoch: 16 cost time: 20.23411250114441
Epoch: 16, Steps: 154 | Train Loss: 1.033 Vali Loss: 4.612 Vali Acc: 0.106 Test Loss: 4.612 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3775344687753447
model parameter : 4704654
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9341282
	speed: 0.0948s/iter; left time: 428.6599s
Epoch: 1 cost time: 13.94873332977295
Epoch: 1, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.074 Vali Acc: 0.331 Test Loss: 2.074 Test Acc: 0.331
Validation loss decreased (inf --> -0.331285).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8938255
	speed: 0.2759s/iter; left time: 1204.7927s
Epoch: 2 cost time: 12.749056577682495
Epoch: 2, Steps: 154 | Train Loss: 1.914 Vali Loss: 1.968 Vali Acc: 0.355 Test Loss: 1.968 Test Acc: 0.355
Validation loss decreased (-0.331285 --> -0.354806).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8883009
	speed: 0.2904s/iter; left time: 1223.2970s
Epoch: 3 cost time: 12.880831480026245
Epoch: 3, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.200 Vali Acc: 0.206 Test Loss: 2.200 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6829675
	speed: 0.2685s/iter; left time: 1090.0375s
Epoch: 4 cost time: 13.181422233581543
Epoch: 4, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.065 Vali Acc: 0.363 Test Loss: 2.065 Test Acc: 0.363
Validation loss decreased (-0.354806 --> -0.362510).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8317412
	speed: 0.3059s/iter; left time: 1194.6786s
Epoch: 5 cost time: 14.062782049179077
Epoch: 5, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.382 Vali Acc: 0.204 Test Loss: 2.382 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.0691270
	speed: 0.3081s/iter; left time: 1155.8597s
Epoch: 6 cost time: 14.351836919784546
Epoch: 6, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.419 Vali Acc: 0.186 Test Loss: 2.419 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3669877
	speed: 0.3060s/iter; left time: 1100.8210s
Epoch: 7 cost time: 14.156960725784302
Epoch: 7, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.384 Vali Acc: 0.351 Test Loss: 2.384 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3757409
	speed: 0.3079s/iter; left time: 1060.0717s
Epoch: 8 cost time: 13.64718747138977
Epoch: 8, Steps: 154 | Train Loss: 1.415 Vali Loss: 2.756 Vali Acc: 0.129 Test Loss: 2.756 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.2020761
	speed: 0.2689s/iter; left time: 884.5297s
Epoch: 9 cost time: 12.875595808029175
Epoch: 9, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.099 Vali Acc: 0.108 Test Loss: 3.099 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.4430721
	speed: 0.2680s/iter; left time: 840.1811s
Epoch: 10 cost time: 11.137982606887817
Epoch: 10, Steps: 154 | Train Loss: 1.331 Vali Loss: 2.748 Vali Acc: 0.225 Test Loss: 2.748 Test Acc: 0.225
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.9698282
	speed: 0.2261s/iter; left time: 674.1398s
Epoch: 11 cost time: 12.833503723144531
Epoch: 11, Steps: 154 | Train Loss: 1.279 Vali Loss: 4.228 Vali Acc: 0.097 Test Loss: 4.228 Test Acc: 0.097
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.0808754
	speed: 0.2752s/iter; left time: 777.8858s
Epoch: 12 cost time: 12.738488674163818
Epoch: 12, Steps: 154 | Train Loss: 1.234 Vali Loss: 2.960 Vali Acc: 0.208 Test Loss: 2.960 Test Acc: 0.208
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.6274984
	speed: 0.2359s/iter; left time: 630.6631s
Epoch: 13 cost time: 11.075838804244995
Epoch: 13, Steps: 154 | Train Loss: 1.176 Vali Loss: 6.327 Vali Acc: 0.080 Test Loss: 6.327 Test Acc: 0.080
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3815869
	speed: 0.2430s/iter; left time: 612.2099s
Epoch: 14 cost time: 11.369361639022827
Epoch: 14, Steps: 154 | Train Loss: 1.156 Vali Loss: 8.026 Vali Acc: 0.084 Test Loss: 8.026 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36253041362530414
model parameter : 1394446
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0379267
	speed: 0.1099s/iter; left time: 497.0363s
Epoch: 1 cost time: 16.14113759994507
Epoch: 1, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.077 Vali Acc: 0.327 Test Loss: 2.077 Test Acc: 0.327
Validation loss decreased (inf --> -0.327230).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0199499
	speed: 0.2980s/iter; left time: 1301.2064s
Epoch: 2 cost time: 12.68287968635559
Epoch: 2, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.159 Vali Acc: 0.344 Test Loss: 2.159 Test Acc: 0.344
Validation loss decreased (-0.327230 --> -0.343855).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4510676
	speed: 0.2688s/iter; left time: 1132.4124s
Epoch: 3 cost time: 14.70798397064209
Epoch: 3, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.126 Vali Acc: 0.350 Test Loss: 2.126 Test Acc: 0.350
Validation loss decreased (-0.343855 --> -0.349938).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1113877
	speed: 0.3002s/iter; left time: 1218.4751s
Epoch: 4 cost time: 13.22478461265564
Epoch: 4, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.667 Vali Acc: 0.193 Test Loss: 2.667 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.3399501
	speed: 0.2641s/iter; left time: 1031.4663s
Epoch: 5 cost time: 14.772141218185425
Epoch: 5, Steps: 154 | Train Loss: 1.638 Vali Loss: 1.938 Vali Acc: 0.376 Test Loss: 1.938 Test Acc: 0.376
Validation loss decreased (-0.349938 --> -0.375488).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6411654
	speed: 0.3105s/iter; left time: 1164.5485s
Epoch: 6 cost time: 13.764157056808472
Epoch: 6, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.307 Vali Acc: 0.188 Test Loss: 2.307 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1977496
	speed: 0.2605s/iter; left time: 937.1517s
Epoch: 7 cost time: 14.853556871414185
Epoch: 7, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.667 Vali Acc: 0.129 Test Loss: 2.667 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.5515288
	speed: 0.3064s/iter; left time: 1054.9275s
Epoch: 8 cost time: 14.06160283088684
Epoch: 8, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.672 Vali Acc: 0.204 Test Loss: 2.672 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2474189
	speed: 0.2802s/iter; left time: 921.4677s
Epoch: 9 cost time: 15.457499265670776
Epoch: 9, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.134 Vali Acc: 0.392 Test Loss: 2.134 Test Acc: 0.392
Validation loss decreased (-0.375488 --> -0.391706).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.0643352
	speed: 0.3433s/iter; left time: 1076.3522s
Epoch: 10 cost time: 16.1468026638031
Epoch: 10, Steps: 154 | Train Loss: 1.343 Vali Loss: 3.375 Vali Acc: 0.198 Test Loss: 3.375 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5322078
	speed: 0.2919s/iter; left time: 870.0166s
Epoch: 11 cost time: 14.48455023765564
Epoch: 11, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.134 Vali Acc: 0.215 Test Loss: 3.134 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.0043503
	speed: 0.3465s/iter; left time: 979.6450s
Epoch: 12 cost time: 16.354763746261597
Epoch: 12, Steps: 154 | Train Loss: 1.236 Vali Loss: 3.993 Vali Acc: 0.097 Test Loss: 3.993 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.5962722
	speed: 0.3054s/iter; left time: 816.4112s
Epoch: 13 cost time: 13.90648889541626
Epoch: 13, Steps: 154 | Train Loss: 1.217 Vali Loss: 3.561 Vali Acc: 0.206 Test Loss: 3.561 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.2697123
	speed: 0.3380s/iter; left time: 851.4781s
Epoch: 14 cost time: 16.147284269332886
Epoch: 14, Steps: 154 | Train Loss: 1.188 Vali Loss: 2.597 Vali Acc: 0.314 Test Loss: 2.597 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.7257936
	speed: 0.3124s/iter; left time: 738.8764s
Epoch: 15 cost time: 13.564624547958374
Epoch: 15, Steps: 154 | Train Loss: 1.130 Vali Loss: 3.615 Vali Acc: 0.199 Test Loss: 3.615 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.2961938
	speed: 0.3276s/iter; left time: 724.3453s
Epoch: 16 cost time: 16.326573848724365
Epoch: 16, Steps: 154 | Train Loss: 1.079 Vali Loss: 4.889 Vali Acc: 0.107 Test Loss: 4.889 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.1476935
	speed: 0.3239s/iter; left time: 666.3554s
Epoch: 17 cost time: 13.616610765457153
Epoch: 17, Steps: 154 | Train Loss: 1.044 Vali Loss: 5.390 Vali Acc: 0.132 Test Loss: 5.390 Test Acc: 0.132
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.0442997
	speed: 0.3135s/iter; left time: 596.6369s
Epoch: 18 cost time: 14.869688034057617
Epoch: 18, Steps: 154 | Train Loss: 0.990 Vali Loss: 6.210 Vali Acc: 0.089 Test Loss: 6.210 Test Acc: 0.089
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.0332952
	speed: 0.2919s/iter; left time: 510.5539s
Epoch: 19 cost time: 12.034200191497803
Epoch: 19, Steps: 154 | Train Loss: 0.981 Vali Loss: 5.487 Vali Acc: 0.119 Test Loss: 5.487 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 4704654
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9367316
	speed: 0.0750s/iter; left time: 339.2640s
Epoch: 1 cost time: 10.842048168182373
Epoch: 1, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.079 Vali Acc: 0.330 Test Loss: 2.079 Test Acc: 0.330
Validation loss decreased (inf --> -0.330068).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8669866
	speed: 0.1836s/iter; left time: 801.8116s
Epoch: 2 cost time: 8.179542541503906
Epoch: 2, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.031 Vali Acc: 0.351 Test Loss: 2.031 Test Acc: 0.351
Validation loss decreased (-0.330068 --> -0.351156).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9136752
	speed: 0.2081s/iter; left time: 876.6063s
Epoch: 3 cost time: 9.426602363586426
Epoch: 3, Steps: 154 | Train Loss: 1.739 Vali Loss: 2.181 Vali Acc: 0.122 Test Loss: 2.181 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5425547
	speed: 0.1994s/iter; left time: 809.2026s
Epoch: 4 cost time: 8.088354587554932
Epoch: 4, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.138 Vali Acc: 0.369 Test Loss: 2.138 Test Acc: 0.369
Validation loss decreased (-0.351156 --> -0.368997).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8445220
	speed: 0.1866s/iter; left time: 728.6961s
Epoch: 5 cost time: 9.501281499862671
Epoch: 5, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.428 Vali Acc: 0.192 Test Loss: 2.428 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1591994
	speed: 0.2109s/iter; left time: 791.0305s
Epoch: 6 cost time: 9.704349756240845
Epoch: 6, Steps: 154 | Train Loss: 1.513 Vali Loss: 3.526 Vali Acc: 0.106 Test Loss: 3.526 Test Acc: 0.106
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4106070
	speed: 0.1891s/iter; left time: 680.0453s
Epoch: 7 cost time: 7.728252172470093
Epoch: 7, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.570 Vali Acc: 0.336 Test Loss: 2.570 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.5558255
	speed: 0.2002s/iter; left time: 689.3886s
Epoch: 8 cost time: 9.37193751335144
Epoch: 8, Steps: 154 | Train Loss: 1.440 Vali Loss: 4.058 Vali Acc: 0.083 Test Loss: 4.058 Test Acc: 0.083
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.3181081
	speed: 0.2086s/iter; left time: 686.0460s
Epoch: 9 cost time: 8.550206422805786
Epoch: 9, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.417 Vali Acc: 0.094 Test Loss: 3.417 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.4621278
	speed: 0.1828s/iter; left time: 573.0627s
Epoch: 10 cost time: 10.07919454574585
Epoch: 10, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.448 Vali Acc: 0.388 Test Loss: 2.448 Test Acc: 0.388
Validation loss decreased (-0.368997 --> -0.388053).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1709055
	speed: 0.2392s/iter; left time: 713.0210s
Epoch: 11 cost time: 10.479464769363403
Epoch: 11, Steps: 154 | Train Loss: 1.318 Vali Loss: 5.622 Vali Acc: 0.077 Test Loss: 5.622 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0162104
	speed: 0.2230s/iter; left time: 630.5530s
Epoch: 12 cost time: 8.651477813720703
Epoch: 12, Steps: 154 | Train Loss: 1.279 Vali Loss: 6.688 Vali Acc: 0.079 Test Loss: 6.688 Test Acc: 0.079
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6626306
	speed: 0.2164s/iter; left time: 578.4248s
Epoch: 13 cost time: 10.555965662002563
Epoch: 13, Steps: 154 | Train Loss: 1.209 Vali Loss: 4.753 Vali Acc: 0.086 Test Loss: 4.753 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.5158771
	speed: 0.2399s/iter; left time: 604.3698s
Epoch: 14 cost time: 10.380893230438232
Epoch: 14, Steps: 154 | Train Loss: 1.189 Vali Loss: 6.655 Vali Acc: 0.084 Test Loss: 6.655 Test Acc: 0.084
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1526487
	speed: 0.2108s/iter; left time: 498.4773s
Epoch: 15 cost time: 8.933470249176025
Epoch: 15, Steps: 154 | Train Loss: 1.140 Vali Loss: 5.077 Vali Acc: 0.084 Test Loss: 5.077 Test Acc: 0.084
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3217921
	speed: 0.2365s/iter; left time: 522.8719s
Epoch: 16 cost time: 10.894696474075317
Epoch: 16, Steps: 154 | Train Loss: 1.105 Vali Loss: 5.318 Vali Acc: 0.094 Test Loss: 5.318 Test Acc: 0.094
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.6159306
	speed: 0.2404s/iter; left time: 494.4064s
Epoch: 17 cost time: 9.7114896774292
Epoch: 17, Steps: 154 | Train Loss: 1.047 Vali Loss: 3.842 Vali Acc: 0.116 Test Loss: 3.842 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8884806
	speed: 0.2026s/iter; left time: 385.4629s
Epoch: 18 cost time: 9.764904975891113
Epoch: 18, Steps: 154 | Train Loss: 1.007 Vali Loss: 4.840 Vali Acc: 0.100 Test Loss: 4.840 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.6506002
	speed: 0.2429s/iter; left time: 424.8492s
Epoch: 19 cost time: 10.417329788208008
Epoch: 19, Steps: 154 | Train Loss: 0.980 Vali Loss: 6.984 Vali Acc: 0.099 Test Loss: 6.984 Test Acc: 0.099
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.1697670
	speed: 0.2258s/iter; left time: 360.1511s
Epoch: 20 cost time: 8.694264650344849
Epoch: 20, Steps: 154 | Train Loss: 0.952 Vali Loss: 9.290 Vali Acc: 0.088 Test Loss: 9.290 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 1394446
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0538149
	speed: 0.0839s/iter; left time: 379.1391s
Epoch: 1 cost time: 12.019291877746582
Epoch: 1, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.093 Vali Acc: 0.321 Test Loss: 2.093 Test Acc: 0.321
Validation loss decreased (inf --> -0.321147).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9955378
	speed: 0.2148s/iter; left time: 937.8634s
Epoch: 2 cost time: 8.252413749694824
Epoch: 2, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.103 Vali Acc: 0.340 Test Loss: 2.103 Test Acc: 0.340
Validation loss decreased (-0.321147 --> -0.340206).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5385926
	speed: 0.2090s/iter; left time: 880.4319s
Epoch: 3 cost time: 10.519231796264648
Epoch: 3, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.038 Vali Acc: 0.351 Test Loss: 2.038 Test Acc: 0.351
Validation loss decreased (-0.340206 --> -0.351156).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.3726704
	speed: 0.2359s/iter; left time: 957.3385s
Epoch: 4 cost time: 10.39205288887024
Epoch: 4, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.253 Vali Acc: 0.346 Test Loss: 2.253 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5880615
	speed: 0.1900s/iter; left time: 741.8435s
Epoch: 5 cost time: 9.253063201904297
Epoch: 5, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.204 Vali Acc: 0.360 Test Loss: 2.204 Test Acc: 0.360
Validation loss decreased (-0.351156 --> -0.360075).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5209521
	speed: 0.2356s/iter; left time: 883.7787s
Epoch: 6 cost time: 10.376611709594727
Epoch: 6, Steps: 154 | Train Loss: 1.594 Vali Loss: 2.233 Vali Acc: 0.383 Test Loss: 2.233 Test Acc: 0.383
Validation loss decreased (-0.360075 --> -0.382784).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.1620517
	speed: 0.2110s/iter; left time: 758.8118s
Epoch: 7 cost time: 7.953833341598511
Epoch: 7, Steps: 154 | Train Loss: 1.517 Vali Loss: 1.955 Vali Acc: 0.394 Test Loss: 1.955 Test Acc: 0.394
Validation loss decreased (-0.382784 --> -0.393736).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6292874
	speed: 0.2081s/iter; left time: 716.5570s
Epoch: 8 cost time: 10.485660552978516
Epoch: 8, Steps: 154 | Train Loss: 1.502 Vali Loss: 3.675 Vali Acc: 0.198 Test Loss: 3.675 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3921117
	speed: 0.2337s/iter; left time: 768.5455s
Epoch: 9 cost time: 10.37782096862793
Epoch: 9, Steps: 154 | Train Loss: 1.412 Vali Loss: 3.930 Vali Acc: 0.086 Test Loss: 3.930 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 3.2951672
	speed: 0.1874s/iter; left time: 587.4847s
Epoch: 10 cost time: 8.998771667480469
Epoch: 10, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.366 Vali Acc: 0.207 Test Loss: 3.366 Test Acc: 0.207
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3907051
	speed: 0.2332s/iter; left time: 695.2992s
Epoch: 11 cost time: 10.409892797470093
Epoch: 11, Steps: 154 | Train Loss: 1.369 Vali Loss: 4.710 Vali Acc: 0.114 Test Loss: 4.710 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.9799497
	speed: 0.2162s/iter; left time: 611.0791s
Epoch: 12 cost time: 8.487434148788452
Epoch: 12, Steps: 154 | Train Loss: 1.282 Vali Loss: 5.418 Vali Acc: 0.088 Test Loss: 5.418 Test Acc: 0.088
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4927164
	speed: 0.2075s/iter; left time: 554.7700s
Epoch: 13 cost time: 10.913999795913696
Epoch: 13, Steps: 154 | Train Loss: 1.252 Vali Loss: 4.218 Vali Acc: 0.212 Test Loss: 4.218 Test Acc: 0.212
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3409920
	speed: 0.2658s/iter; left time: 669.4460s
Epoch: 14 cost time: 11.802795886993408
Epoch: 14, Steps: 154 | Train Loss: 1.205 Vali Loss: 4.810 Vali Acc: 0.139 Test Loss: 4.810 Test Acc: 0.139
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.9571947
	speed: 0.2210s/iter; left time: 522.6252s
Epoch: 15 cost time: 9.932079553604126
Epoch: 15, Steps: 154 | Train Loss: 1.194 Vali Loss: 4.202 Vali Acc: 0.296 Test Loss: 4.202 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 2.6979036
	speed: 0.2590s/iter; left time: 572.6515s
Epoch: 16 cost time: 11.747708797454834
Epoch: 16, Steps: 154 | Train Loss: 1.135 Vali Loss: 6.878 Vali Acc: 0.079 Test Loss: 6.878 Test Acc: 0.079
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1543258
	speed: 0.2513s/iter; left time: 516.9501s
Epoch: 17 cost time: 9.642828702926636
Epoch: 17, Steps: 154 | Train Loss: 1.100 Vali Loss: 6.997 Vali Acc: 0.085 Test Loss: 6.997 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3937550689375507
model parameter : 4704654
model size : 18.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9524565
	speed: 0.0680s/iter; left time: 307.2914s
Epoch: 1 cost time: 9.80998682975769
Epoch: 1, Steps: 154 | Train Loss: 2.150 Vali Loss: 2.093 Vali Acc: 0.321 Test Loss: 2.093 Test Acc: 0.321
Validation loss decreased (inf --> -0.321147).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8542762
	speed: 0.1971s/iter; left time: 860.9412s
Epoch: 2 cost time: 7.410479545593262
Epoch: 2, Steps: 154 | Train Loss: 1.940 Vali Loss: 1.991 Vali Acc: 0.344 Test Loss: 1.991 Test Acc: 0.344
Validation loss decreased (-0.321147 --> -0.343857).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9371277
	speed: 0.1680s/iter; left time: 707.7791s
Epoch: 3 cost time: 7.7900071144104
Epoch: 3, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.105 Vali Acc: 0.354 Test Loss: 2.105 Test Acc: 0.354
Validation loss decreased (-0.343857 --> -0.354399).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6371149
	speed: 0.2023s/iter; left time: 820.9589s
Epoch: 4 cost time: 8.57743501663208
Epoch: 4, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.150 Vali Acc: 0.367 Test Loss: 2.150 Test Acc: 0.367
Validation loss decreased (-0.354399 --> -0.366564).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8468292
	speed: 0.1992s/iter; left time: 777.8236s
Epoch: 5 cost time: 7.63245964050293
Epoch: 5, Steps: 154 | Train Loss: 1.608 Vali Loss: 2.783 Vali Acc: 0.195 Test Loss: 2.783 Test Acc: 0.195
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.1546975
	speed: 0.1635s/iter; left time: 613.4737s
Epoch: 6 cost time: 7.630297422409058
Epoch: 6, Steps: 154 | Train Loss: 1.564 Vali Loss: 4.317 Vali Acc: 0.113 Test Loss: 4.317 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.3971173
	speed: 0.2022s/iter; left time: 727.2160s
Epoch: 7 cost time: 8.528475284576416
Epoch: 7, Steps: 154 | Train Loss: 1.568 Vali Loss: 2.445 Vali Acc: 0.361 Test Loss: 2.445 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.4080931
	speed: 0.2036s/iter; left time: 701.1040s
Epoch: 8 cost time: 7.419156789779663
Epoch: 8, Steps: 154 | Train Loss: 1.476 Vali Loss: 4.023 Vali Acc: 0.079 Test Loss: 4.023 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.1872474
	speed: 0.1427s/iter; left time: 469.3989s
Epoch: 9 cost time: 6.078739881515503
Epoch: 9, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.554 Vali Acc: 0.164 Test Loss: 3.554 Test Acc: 0.164
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.7494056
	speed: 0.1321s/iter; left time: 414.2774s
Epoch: 10 cost time: 4.938863277435303
Epoch: 10, Steps: 154 | Train Loss: 1.414 Vali Loss: 4.553 Vali Acc: 0.103 Test Loss: 4.553 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3228258
	speed: 0.1717s/iter; left time: 511.7314s
Epoch: 11 cost time: 8.291679859161377
Epoch: 11, Steps: 154 | Train Loss: 1.372 Vali Loss: 5.467 Vali Acc: 0.081 Test Loss: 5.467 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.1131083
	speed: 0.1942s/iter; left time: 548.9823s
Epoch: 12 cost time: 8.18054747581482
Epoch: 12, Steps: 154 | Train Loss: 1.312 Vali Loss: 7.904 Vali Acc: 0.087 Test Loss: 7.904 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.6594342
	speed: 0.1963s/iter; left time: 524.7880s
Epoch: 13 cost time: 8.194391965866089
Epoch: 13, Steps: 154 | Train Loss: 1.275 Vali Loss: 5.328 Vali Acc: 0.097 Test Loss: 5.328 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 3.9559436
	speed: 0.1682s/iter; left time: 423.6823s
Epoch: 14 cost time: 6.6353161334991455
Epoch: 14, Steps: 154 | Train Loss: 1.248 Vali Loss: 7.818 Vali Acc: 0.086 Test Loss: 7.818 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36658556366585565
model parameter : 1394446
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7921306
	speed: 0.1156s/iter; left time: 522.6460s
Epoch: 1 cost time: 17.289087772369385
Epoch: 1, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.097 Vali Acc: 0.325 Test Loss: 2.097 Test Acc: 0.325
Validation loss decreased (inf --> -0.325202).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1045744
	speed: 0.3348s/iter; left time: 1462.2711s
Epoch: 2 cost time: 15.505833864212036
Epoch: 2, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.127 Vali Acc: 0.339 Test Loss: 2.127 Test Acc: 0.339
Validation loss decreased (-0.325202 --> -0.338989).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3443255
	speed: 0.2737s/iter; left time: 1153.0178s
Epoch: 3 cost time: 13.734327554702759
Epoch: 3, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.242 Vali Acc: 0.351 Test Loss: 2.242 Test Acc: 0.351
Validation loss decreased (-0.338989 --> -0.350748).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3835378
	speed: 0.3331s/iter; left time: 1351.9121s
Epoch: 4 cost time: 16.018778562545776
Epoch: 4, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.420 Vali Acc: 0.362 Test Loss: 2.420 Test Acc: 0.362
Validation loss decreased (-0.350748 --> -0.361695).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5676326
	speed: 0.3378s/iter; left time: 1318.9472s
Epoch: 5 cost time: 16.085747241973877
Epoch: 5, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.083 Vali Acc: 0.374 Test Loss: 2.083 Test Acc: 0.374
Validation loss decreased (-0.361695 --> -0.374270).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7321777
	speed: 0.3118s/iter; left time: 1169.5469s
Epoch: 6 cost time: 16.302448511123657
Epoch: 6, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.275 Vali Acc: 0.369 Test Loss: 2.275 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7289790
	speed: 0.3670s/iter; left time: 1319.9490s
Epoch: 7 cost time: 17.420324325561523
Epoch: 7, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.547 Vali Acc: 0.147 Test Loss: 2.547 Test Acc: 0.147
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3513269
	speed: 0.3638s/iter; left time: 1252.5698s
Epoch: 8 cost time: 16.445970058441162
Epoch: 8, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.083 Vali Acc: 0.386 Test Loss: 2.083 Test Acc: 0.386
Validation loss decreased (-0.374270 --> -0.386435).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6502312
	speed: 0.3119s/iter; left time: 1025.6997s
Epoch: 9 cost time: 15.822420835494995
Epoch: 9, Steps: 154 | Train Loss: 1.328 Vali Loss: 2.217 Vali Acc: 0.236 Test Loss: 2.217 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4471427
	speed: 0.3642s/iter; left time: 1141.7801s
Epoch: 10 cost time: 17.545634269714355
Epoch: 10, Steps: 154 | Train Loss: 1.294 Vali Loss: 2.463 Vali Acc: 0.165 Test Loss: 2.463 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5351397
	speed: 0.3613s/iter; left time: 1077.0737s
Epoch: 11 cost time: 15.385767698287964
Epoch: 11, Steps: 154 | Train Loss: 1.251 Vali Loss: 5.174 Vali Acc: 0.098 Test Loss: 5.174 Test Acc: 0.098
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.3840945
	speed: 0.3095s/iter; left time: 874.8779s
Epoch: 12 cost time: 16.545137405395508
Epoch: 12, Steps: 154 | Train Loss: 1.231 Vali Loss: 4.202 Vali Acc: 0.089 Test Loss: 4.202 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1871223
	speed: 0.3657s/iter; left time: 977.6019s
Epoch: 13 cost time: 17.438222885131836
Epoch: 13, Steps: 154 | Train Loss: 1.181 Vali Loss: 5.452 Vali Acc: 0.114 Test Loss: 5.452 Test Acc: 0.114
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.1065885
	speed: 0.3641s/iter; left time: 917.0931s
Epoch: 14 cost time: 16.294008255004883
Epoch: 14, Steps: 154 | Train Loss: 1.146 Vali Loss: 4.105 Vali Acc: 0.118 Test Loss: 4.105 Test Acc: 0.118
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.8178379
	speed: 0.2947s/iter; left time: 696.9785s
Epoch: 15 cost time: 15.74007511138916
Epoch: 15, Steps: 154 | Train Loss: 1.110 Vali Loss: 7.492 Vali Acc: 0.116 Test Loss: 7.492 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.0751524
	speed: 0.3345s/iter; left time: 739.4769s
Epoch: 16 cost time: 16.091721057891846
Epoch: 16, Steps: 154 | Train Loss: 1.112 Vali Loss: 4.234 Vali Acc: 0.099 Test Loss: 4.234 Test Acc: 0.099
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.0218076
	speed: 0.3203s/iter; left time: 658.8462s
Epoch: 17 cost time: 13.801464557647705
Epoch: 17, Steps: 154 | Train Loss: 1.054 Vali Loss: 7.656 Vali Acc: 0.092 Test Loss: 7.656 Test Acc: 0.092
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.8417301
	speed: 0.2917s/iter; left time: 555.1818s
Epoch: 18 cost time: 16.005325078964233
Epoch: 18, Steps: 154 | Train Loss: 1.029 Vali Loss: 6.207 Vali Acc: 0.122 Test Loss: 6.207 Test Acc: 0.122
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.386455798864558
model parameter : 2360974
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4802821
	speed: 0.0812s/iter; left time: 367.2071s
Epoch: 1 cost time: 12.022470474243164
Epoch: 1, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.075 Vali Acc: 0.327 Test Loss: 2.075 Test Acc: 0.327
Validation loss decreased (inf --> -0.327230).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0668361
	speed: 0.2016s/iter; left time: 880.3519s
Epoch: 2 cost time: 9.378181219100952
Epoch: 2, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.027 Vali Acc: 0.345 Test Loss: 2.027 Test Acc: 0.345
Validation loss decreased (-0.327230 --> -0.344667).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6977671
	speed: 0.2236s/iter; left time: 942.0962s
Epoch: 3 cost time: 10.254226684570312
Epoch: 3, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.212 Vali Acc: 0.347 Test Loss: 2.212 Test Acc: 0.347
Validation loss decreased (-0.344667 --> -0.346693).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7943853
	speed: 0.2273s/iter; left time: 922.6784s
Epoch: 4 cost time: 11.040168046951294
Epoch: 4, Steps: 154 | Train Loss: 1.669 Vali Loss: 2.328 Vali Acc: 0.348 Test Loss: 2.328 Test Acc: 0.348
Validation loss decreased (-0.346693 --> -0.347503).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4903848
	speed: 0.2222s/iter; left time: 867.8317s
Epoch: 5 cost time: 9.464289665222168
Epoch: 5, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.206 Vali Acc: 0.375 Test Loss: 2.206 Test Acc: 0.375
Validation loss decreased (-0.347503 --> -0.374674).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1076783
	speed: 0.1994s/iter; left time: 748.0944s
Epoch: 6 cost time: 10.074002742767334
Epoch: 6, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.138 Vali Acc: 0.382 Test Loss: 2.138 Test Acc: 0.382
Validation loss decreased (-0.374674 --> -0.382379).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4268315
	speed: 0.2344s/iter; left time: 842.9644s
Epoch: 7 cost time: 10.773607730865479
Epoch: 7, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.159 Vali Acc: 0.258 Test Loss: 2.159 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1224104
	speed: 0.2460s/iter; left time: 846.9885s
Epoch: 8 cost time: 11.727706670761108
Epoch: 8, Steps: 154 | Train Loss: 1.368 Vali Loss: 3.083 Vali Acc: 0.219 Test Loss: 3.083 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2884558
	speed: 0.2400s/iter; left time: 789.2676s
Epoch: 9 cost time: 10.252252578735352
Epoch: 9, Steps: 154 | Train Loss: 1.304 Vali Loss: 3.223 Vali Acc: 0.219 Test Loss: 3.223 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5031902
	speed: 0.2132s/iter; left time: 668.3977s
Epoch: 10 cost time: 11.012104511260986
Epoch: 10, Steps: 154 | Train Loss: 1.263 Vali Loss: 2.805 Vali Acc: 0.204 Test Loss: 2.805 Test Acc: 0.204
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8647404
	speed: 0.2508s/iter; left time: 747.6520s
Epoch: 11 cost time: 11.717103481292725
Epoch: 11, Steps: 154 | Train Loss: 1.226 Vali Loss: 3.253 Vali Acc: 0.201 Test Loss: 3.253 Test Acc: 0.201
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.6933327
	speed: 0.2520s/iter; left time: 712.4061s
Epoch: 12 cost time: 11.736307859420776
Epoch: 12, Steps: 154 | Train Loss: 1.193 Vali Loss: 3.071 Vali Acc: 0.206 Test Loss: 3.071 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.8633664
	speed: 0.2406s/iter; left time: 643.1856s
Epoch: 13 cost time: 10.20960783958435
Epoch: 13, Steps: 154 | Train Loss: 1.145 Vali Loss: 3.804 Vali Acc: 0.216 Test Loss: 3.804 Test Acc: 0.216
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.3068008
	speed: 0.2257s/iter; left time: 568.6242s
Epoch: 14 cost time: 12.396247148513794
Epoch: 14, Steps: 154 | Train Loss: 1.091 Vali Loss: 4.117 Vali Acc: 0.135 Test Loss: 4.117 Test Acc: 0.135
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.9044389
	speed: 0.2598s/iter; left time: 614.3216s
Epoch: 15 cost time: 12.688883781433105
Epoch: 15, Steps: 154 | Train Loss: 1.066 Vali Loss: 3.936 Vali Acc: 0.221 Test Loss: 3.936 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.7717832
	speed: 0.2594s/iter; left time: 573.4527s
Epoch: 16 cost time: 12.191301345825195
Epoch: 16, Steps: 154 | Train Loss: 1.033 Vali Loss: 7.942 Vali Acc: 0.098 Test Loss: 7.942 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3824006488240065
model parameter : 705806
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8060613
	speed: 0.1026s/iter; left time: 463.8956s
Epoch: 1 cost time: 15.206453084945679
Epoch: 1, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.099 Vali Acc: 0.328 Test Loss: 2.099 Test Acc: 0.328
Validation loss decreased (inf --> -0.328041).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0535197
	speed: 0.2889s/iter; left time: 1261.6317s
Epoch: 2 cost time: 12.099273920059204
Epoch: 2, Steps: 154 | Train Loss: 1.934 Vali Loss: 2.155 Vali Acc: 0.337 Test Loss: 2.155 Test Acc: 0.337
Validation loss decreased (-0.328041 --> -0.337367).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3094351
	speed: 0.2695s/iter; left time: 1135.3164s
Epoch: 3 cost time: 12.176653623580933
Epoch: 3, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.227 Vali Acc: 0.341 Test Loss: 2.227 Test Acc: 0.341
Validation loss decreased (-0.337367 --> -0.340610).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6071986
	speed: 0.2251s/iter; left time: 913.8442s
Epoch: 4 cost time: 10.269203186035156
Epoch: 4, Steps: 154 | Train Loss: 1.672 Vali Loss: 2.204 Vali Acc: 0.354 Test Loss: 2.204 Test Acc: 0.354
Validation loss decreased (-0.340610 --> -0.353587).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5740976
	speed: 0.2624s/iter; left time: 1024.7020s
Epoch: 5 cost time: 12.311851024627686
Epoch: 5, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.202 Vali Acc: 0.363 Test Loss: 2.202 Test Acc: 0.363
Validation loss decreased (-0.353587 --> -0.363319).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7415992
	speed: 0.2672s/iter; left time: 1002.2483s
Epoch: 6 cost time: 12.1092848777771
Epoch: 6, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.188 Vali Acc: 0.356 Test Loss: 2.188 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9195720
	speed: 0.2451s/iter; left time: 881.4869s
Epoch: 7 cost time: 10.117616176605225
Epoch: 7, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.127 Vali Acc: 0.376 Test Loss: 2.127 Test Acc: 0.376
Validation loss decreased (-0.363319 --> -0.376297).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3565726
	speed: 0.2262s/iter; left time: 778.8933s
Epoch: 8 cost time: 12.262524604797363
Epoch: 8, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.354 Vali Acc: 0.388 Test Loss: 2.354 Test Acc: 0.388
Validation loss decreased (-0.376297 --> -0.388054).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7659706
	speed: 0.2695s/iter; left time: 886.3901s
Epoch: 9 cost time: 12.278112173080444
Epoch: 9, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.126 Vali Acc: 0.131 Test Loss: 3.126 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.4686381
	speed: 0.2666s/iter; left time: 835.7897s
Epoch: 10 cost time: 11.642056465148926
Epoch: 10, Steps: 154 | Train Loss: 1.338 Vali Loss: 2.876 Vali Acc: 0.109 Test Loss: 2.876 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.5279628
	speed: 0.2186s/iter; left time: 651.7236s
Epoch: 11 cost time: 10.156287908554077
Epoch: 11, Steps: 154 | Train Loss: 1.307 Vali Loss: 5.274 Vali Acc: 0.097 Test Loss: 5.274 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.5313904
	speed: 0.2605s/iter; left time: 736.5255s
Epoch: 12 cost time: 12.008840084075928
Epoch: 12, Steps: 154 | Train Loss: 1.281 Vali Loss: 6.070 Vali Acc: 0.077 Test Loss: 6.070 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.3860285
	speed: 0.2681s/iter; left time: 716.5625s
Epoch: 13 cost time: 12.454115152359009
Epoch: 13, Steps: 154 | Train Loss: 1.219 Vali Loss: 8.642 Vali Acc: 0.091 Test Loss: 8.642 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.0096221
	speed: 0.2671s/iter; left time: 672.9431s
Epoch: 14 cost time: 11.413343906402588
Epoch: 14, Steps: 154 | Train Loss: 1.195 Vali Loss: 6.576 Vali Acc: 0.101 Test Loss: 6.576 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.1024207
	speed: 0.2592s/iter; left time: 612.9722s
Epoch: 15 cost time: 13.696301221847534
Epoch: 15, Steps: 154 | Train Loss: 1.200 Vali Loss: 10.968 Vali Acc: 0.088 Test Loss: 10.968 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.9850813
	speed: 0.2994s/iter; left time: 661.9773s
Epoch: 16 cost time: 13.67337155342102
Epoch: 16, Steps: 154 | Train Loss: 1.133 Vali Loss: 5.707 Vali Acc: 0.082 Test Loss: 5.707 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.9587197
	speed: 0.2985s/iter; left time: 614.0169s
Epoch: 17 cost time: 13.123932123184204
Epoch: 17, Steps: 154 | Train Loss: 1.086 Vali Loss: 4.675 Vali Acc: 0.093 Test Loss: 4.675 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.8003625
	speed: 0.2493s/iter; left time: 474.3324s
Epoch: 18 cost time: 11.625684261322021
Epoch: 18, Steps: 154 | Train Loss: 1.083 Vali Loss: 4.389 Vali Acc: 0.114 Test Loss: 4.389 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3880778588807786
model parameter : 2360974
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4813092
	speed: 0.0782s/iter; left time: 353.6400s
Epoch: 1 cost time: 11.45574426651001
Epoch: 1, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.080 Vali Acc: 0.326 Test Loss: 2.080 Test Acc: 0.326
Validation loss decreased (inf --> -0.326013).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9576609
	speed: 0.2306s/iter; left time: 1007.1575s
Epoch: 2 cost time: 10.078368902206421
Epoch: 2, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.043 Vali Acc: 0.344 Test Loss: 2.043 Test Acc: 0.344
Validation loss decreased (-0.326013 --> -0.344262).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6960530
	speed: 0.1973s/iter; left time: 831.1136s
Epoch: 3 cost time: 8.256665468215942
Epoch: 3, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.175 Vali Acc: 0.348 Test Loss: 2.175 Test Acc: 0.348
Validation loss decreased (-0.344262 --> -0.347505).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7962438
	speed: 0.2104s/iter; left time: 854.0408s
Epoch: 4 cost time: 9.633543968200684
Epoch: 4, Steps: 154 | Train Loss: 1.681 Vali Loss: 2.217 Vali Acc: 0.353 Test Loss: 2.217 Test Acc: 0.353
Validation loss decreased (-0.347505 --> -0.353181).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5169218
	speed: 0.2289s/iter; left time: 893.8093s
Epoch: 5 cost time: 10.251070022583008
Epoch: 5, Steps: 154 | Train Loss: 1.578 Vali Loss: 2.103 Vali Acc: 0.381 Test Loss: 2.103 Test Acc: 0.381
Validation loss decreased (-0.353181 --> -0.381163).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2097356
	speed: 0.2311s/iter; left time: 866.8480s
Epoch: 6 cost time: 10.253432273864746
Epoch: 6, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.134 Vali Acc: 0.389 Test Loss: 2.134 Test Acc: 0.389
Validation loss decreased (-0.381163 --> -0.389273).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3138239
	speed: 0.1903s/iter; left time: 684.5581s
Epoch: 7 cost time: 7.622133016586304
Epoch: 7, Steps: 154 | Train Loss: 1.424 Vali Loss: 2.658 Vali Acc: 0.162 Test Loss: 2.658 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2817668
	speed: 0.1969s/iter; left time: 677.8513s
Epoch: 8 cost time: 9.266275644302368
Epoch: 8, Steps: 154 | Train Loss: 1.378 Vali Loss: 3.086 Vali Acc: 0.219 Test Loss: 3.086 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2447237
	speed: 0.2086s/iter; left time: 686.1594s
Epoch: 9 cost time: 9.200413227081299
Epoch: 9, Steps: 154 | Train Loss: 1.318 Vali Loss: 2.930 Vali Acc: 0.203 Test Loss: 2.930 Test Acc: 0.203
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5726188
	speed: 0.2113s/iter; left time: 662.3268s
Epoch: 10 cost time: 9.72302532196045
Epoch: 10, Steps: 154 | Train Loss: 1.264 Vali Loss: 2.605 Vali Acc: 0.236 Test Loss: 2.605 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.8939244
	speed: 0.1820s/iter; left time: 542.5677s
Epoch: 11 cost time: 7.674318790435791
Epoch: 11, Steps: 154 | Train Loss: 1.237 Vali Loss: 4.156 Vali Acc: 0.103 Test Loss: 4.156 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.7384545
	speed: 0.1964s/iter; left time: 555.2037s
Epoch: 12 cost time: 9.189327001571655
Epoch: 12, Steps: 154 | Train Loss: 1.209 Vali Loss: 2.310 Vali Acc: 0.248 Test Loss: 2.310 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.7513238
	speed: 0.2055s/iter; left time: 549.2314s
Epoch: 13 cost time: 9.014208316802979
Epoch: 13, Steps: 154 | Train Loss: 1.158 Vali Loss: 4.728 Vali Acc: 0.104 Test Loss: 4.728 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.2463373
	speed: 0.2105s/iter; left time: 530.3550s
Epoch: 14 cost time: 9.261106729507446
Epoch: 14, Steps: 154 | Train Loss: 1.132 Vali Loss: 4.844 Vali Acc: 0.102 Test Loss: 4.844 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.8026393
	speed: 0.1782s/iter; left time: 421.3281s
Epoch: 15 cost time: 7.434966325759888
Epoch: 15, Steps: 154 | Train Loss: 1.084 Vali Loss: 4.076 Vali Acc: 0.207 Test Loss: 4.076 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.7503701
	speed: 0.1978s/iter; left time: 437.3232s
Epoch: 16 cost time: 9.270236015319824
Epoch: 16, Steps: 154 | Train Loss: 1.054 Vali Loss: 6.843 Vali Acc: 0.094 Test Loss: 6.843 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38929440389294406
model parameter : 705806
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8169526
	speed: 0.0710s/iter; left time: 320.8492s
Epoch: 1 cost time: 10.22339940071106
Epoch: 1, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.118 Vali Acc: 0.320 Test Loss: 2.118 Test Acc: 0.320
Validation loss decreased (inf --> -0.319930).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0882111
	speed: 0.1830s/iter; left time: 799.2002s
Epoch: 2 cost time: 7.162646770477295
Epoch: 2, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.192 Vali Acc: 0.333 Test Loss: 2.192 Test Acc: 0.333
Validation loss decreased (-0.319930 --> -0.332906).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3652544
	speed: 0.1698s/iter; left time: 715.5138s
Epoch: 3 cost time: 8.85187840461731
Epoch: 3, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.208 Vali Acc: 0.348 Test Loss: 2.208 Test Acc: 0.348
Validation loss decreased (-0.332906 --> -0.348315).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1664977
	speed: 0.2036s/iter; left time: 826.3012s
Epoch: 4 cost time: 8.870524883270264
Epoch: 4, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.195 Vali Acc: 0.345 Test Loss: 2.195 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6894234
	speed: 0.2057s/iter; left time: 803.1654s
Epoch: 5 cost time: 8.924982070922852
Epoch: 5, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.217 Vali Acc: 0.363 Test Loss: 2.217 Test Acc: 0.363
Validation loss decreased (-0.348315 --> -0.363319).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6932186
	speed: 0.1935s/iter; left time: 725.8873s
Epoch: 6 cost time: 7.391843318939209
Epoch: 6, Steps: 154 | Train Loss: 1.567 Vali Loss: 2.331 Vali Acc: 0.364 Test Loss: 2.331 Test Acc: 0.364
Validation loss decreased (-0.363319 --> -0.364129).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3991318
	speed: 0.1763s/iter; left time: 634.1747s
Epoch: 7 cost time: 8.636998653411865
Epoch: 7, Steps: 154 | Train Loss: 1.536 Vali Loss: 2.916 Vali Acc: 0.391 Test Loss: 2.916 Test Acc: 0.391
Validation loss decreased (-0.364129 --> -0.390482).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7301407
	speed: 0.2080s/iter; left time: 716.3152s
Epoch: 8 cost time: 8.87834119796753
Epoch: 8, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.820 Vali Acc: 0.352 Test Loss: 2.820 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5812873
	speed: 0.2065s/iter; left time: 679.0176s
Epoch: 9 cost time: 8.895813941955566
Epoch: 9, Steps: 154 | Train Loss: 1.444 Vali Loss: 3.999 Vali Acc: 0.095 Test Loss: 3.999 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7377287
	speed: 0.1574s/iter; left time: 493.5841s
Epoch: 10 cost time: 5.994399309158325
Epoch: 10, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.102 Vali Acc: 0.383 Test Loss: 3.102 Test Acc: 0.383
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5144198
	speed: 0.1318s/iter; left time: 392.8171s
Epoch: 11 cost time: 8.270993947982788
Epoch: 11, Steps: 154 | Train Loss: 1.352 Vali Loss: 4.427 Vali Acc: 0.097 Test Loss: 4.427 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.6143116
	speed: 0.1977s/iter; left time: 558.8673s
Epoch: 12 cost time: 8.413655996322632
Epoch: 12, Steps: 154 | Train Loss: 1.310 Vali Loss: 5.878 Vali Acc: 0.076 Test Loss: 5.878 Test Acc: 0.076
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3513939
	speed: 0.1980s/iter; left time: 529.1632s
Epoch: 13 cost time: 8.660971403121948
Epoch: 13, Steps: 154 | Train Loss: 1.281 Vali Loss: 5.032 Vali Acc: 0.090 Test Loss: 5.032 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.0685557
	speed: 0.1832s/iter; left time: 461.3969s
Epoch: 14 cost time: 6.82548451423645
Epoch: 14, Steps: 154 | Train Loss: 1.266 Vali Loss: 4.399 Vali Acc: 0.115 Test Loss: 4.399 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0167875
	speed: 0.1573s/iter; left time: 371.9884s
Epoch: 15 cost time: 8.22205114364624
Epoch: 15, Steps: 154 | Train Loss: 1.224 Vali Loss: 6.084 Vali Acc: 0.094 Test Loss: 6.084 Test Acc: 0.094
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.9272333
	speed: 0.2010s/iter; left time: 444.5048s
Epoch: 16 cost time: 8.66581654548645
Epoch: 16, Steps: 154 | Train Loss: 1.215 Vali Loss: 5.684 Vali Acc: 0.072 Test Loss: 5.684 Test Acc: 0.072
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.0382899
	speed: 0.2000s/iter; left time: 411.4042s
Epoch: 17 cost time: 8.644973278045654
Epoch: 17, Steps: 154 | Train Loss: 1.133 Vali Loss: 5.177 Vali Acc: 0.098 Test Loss: 5.177 Test Acc: 0.098
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3905109489051095
model parameter : 2360974
model size : 9.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.4976854
	speed: 0.0498s/iter; left time: 225.0236s
Epoch: 1 cost time: 6.910573244094849
Epoch: 1, Steps: 154 | Train Loss: 2.149 Vali Loss: 2.091 Vali Acc: 0.322 Test Loss: 2.091 Test Acc: 0.322
Validation loss decreased (inf --> -0.321552).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8883489
	speed: 0.0851s/iter; left time: 371.7138s
Epoch: 2 cost time: 3.593622922897339
Epoch: 2, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.024 Vali Acc: 0.346 Test Loss: 2.024 Test Acc: 0.346
Validation loss decreased (-0.321552 --> -0.346290).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7166713
	speed: 0.0884s/iter; left time: 372.3567s
Epoch: 3 cost time: 5.7471373081207275
Epoch: 3, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.218 Vali Acc: 0.343 Test Loss: 2.218 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8338428
	speed: 0.1321s/iter; left time: 536.2161s
Epoch: 4 cost time: 5.087307691574097
Epoch: 4, Steps: 154 | Train Loss: 1.698 Vali Loss: 2.210 Vali Acc: 0.353 Test Loss: 2.210 Test Acc: 0.353
Validation loss decreased (-0.346290 --> -0.352776).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6242352
	speed: 0.1019s/iter; left time: 397.9540s
Epoch: 5 cost time: 5.688101291656494
Epoch: 5, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.155 Vali Acc: 0.388 Test Loss: 2.155 Test Acc: 0.388
Validation loss decreased (-0.352776 --> -0.388462).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.1539689
	speed: 0.1321s/iter; left time: 495.6101s
Epoch: 6 cost time: 5.15281081199646
Epoch: 6, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.454 Vali Acc: 0.218 Test Loss: 2.454 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2855482
	speed: 0.1022s/iter; left time: 367.7693s
Epoch: 7 cost time: 5.765556812286377
Epoch: 7, Steps: 154 | Train Loss: 1.483 Vali Loss: 2.948 Vali Acc: 0.218 Test Loss: 2.948 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1842380
	speed: 0.1334s/iter; left time: 459.2400s
Epoch: 8 cost time: 5.215668201446533
Epoch: 8, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.412 Vali Acc: 0.210 Test Loss: 3.412 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2853441
	speed: 0.1140s/iter; left time: 374.8548s
Epoch: 9 cost time: 6.602076768875122
Epoch: 9, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.100 Vali Acc: 0.222 Test Loss: 3.100 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5479884
	speed: 0.1460s/iter; left time: 457.7614s
Epoch: 10 cost time: 5.6145100593566895
Epoch: 10, Steps: 154 | Train Loss: 1.350 Vali Loss: 4.198 Vali Acc: 0.212 Test Loss: 4.198 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.9162951
	speed: 0.1131s/iter; left time: 337.2062s
Epoch: 11 cost time: 6.496004819869995
Epoch: 11, Steps: 154 | Train Loss: 1.282 Vali Loss: 3.611 Vali Acc: 0.204 Test Loss: 3.611 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.7603530
	speed: 0.1499s/iter; left time: 423.8420s
Epoch: 12 cost time: 5.722341775894165
Epoch: 12, Steps: 154 | Train Loss: 1.271 Vali Loss: 4.927 Vali Acc: 0.210 Test Loss: 4.927 Test Acc: 0.210
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 2.3339169
	speed: 0.1143s/iter; left time: 305.4993s
Epoch: 13 cost time: 6.492945909500122
Epoch: 13, Steps: 154 | Train Loss: 1.238 Vali Loss: 6.895 Vali Acc: 0.088 Test Loss: 6.895 Test Acc: 0.088
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.3670408
	speed: 0.1507s/iter; left time: 379.5404s
Epoch: 14 cost time: 5.820529222488403
Epoch: 14, Steps: 154 | Train Loss: 1.213 Vali Loss: 5.575 Vali Acc: 0.166 Test Loss: 5.575 Test Acc: 0.166
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.8374220
	speed: 0.1145s/iter; left time: 270.7226s
Epoch: 15 cost time: 6.472487688064575
Epoch: 15, Steps: 154 | Train Loss: 1.140 Vali Loss: 5.419 Vali Acc: 0.208 Test Loss: 5.419 Test Acc: 0.208
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3884833738848337
model parameter : 705806
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7924864
	speed: 0.0819s/iter; left time: 370.1061s
Epoch: 1 cost time: 12.04207158088684
Epoch: 1, Steps: 154 | Train Loss: 2.156 Vali Loss: 2.105 Vali Acc: 0.327 Test Loss: 2.105 Test Acc: 0.327
Validation loss decreased (inf --> -0.327230).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5214825
	speed: 0.1896s/iter; left time: 827.9463s
Epoch: 2 cost time: 9.205242156982422
Epoch: 2, Steps: 154 | Train Loss: 1.948 Vali Loss: 2.089 Vali Acc: 0.338 Test Loss: 2.089 Test Acc: 0.338
Validation loss decreased (-0.327230 --> -0.337773).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5505331
	speed: 0.1939s/iter; left time: 816.9024s
Epoch: 3 cost time: 8.78202199935913
Epoch: 3, Steps: 154 | Train Loss: 1.782 Vali Loss: 2.033 Vali Acc: 0.354 Test Loss: 2.033 Test Acc: 0.354
Validation loss decreased (-0.337773 --> -0.353589).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6114396
	speed: 0.2017s/iter; left time: 818.8662s
Epoch: 4 cost time: 10.45501184463501
Epoch: 4, Steps: 154 | Train Loss: 1.653 Vali Loss: 2.193 Vali Acc: 0.347 Test Loss: 2.193 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4303241
	speed: 0.1837s/iter; left time: 717.2380s
Epoch: 5 cost time: 10.746626138687134
Epoch: 5, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.288 Vali Acc: 0.193 Test Loss: 2.288 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1718066
	speed: 0.1894s/iter; left time: 710.5762s
Epoch: 6 cost time: 8.597578048706055
Epoch: 6, Steps: 154 | Train Loss: 1.513 Vali Loss: 2.233 Vali Acc: 0.217 Test Loss: 2.233 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.6486300
	speed: 0.2250s/iter; left time: 809.3652s
Epoch: 7 cost time: 11.05265736579895
Epoch: 7, Steps: 154 | Train Loss: 1.469 Vali Loss: 2.409 Vali Acc: 0.357 Test Loss: 2.409 Test Acc: 0.357
Validation loss decreased (-0.353589 --> -0.356829).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6757145
	speed: 0.2080s/iter; left time: 716.2546s
Epoch: 8 cost time: 11.677032232284546
Epoch: 8, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.585 Vali Acc: 0.197 Test Loss: 2.585 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3208672
	speed: 0.2098s/iter; left time: 689.9717s
Epoch: 9 cost time: 10.36353349685669
Epoch: 9, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.607 Vali Acc: 0.211 Test Loss: 2.607 Test Acc: 0.211
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1602119
	speed: 0.2275s/iter; left time: 713.2950s
Epoch: 10 cost time: 10.372396230697632
Epoch: 10, Steps: 154 | Train Loss: 1.343 Vali Loss: 2.491 Vali Acc: 0.234 Test Loss: 2.491 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.9159199
	speed: 0.2120s/iter; left time: 632.0557s
Epoch: 11 cost time: 11.808759212493896
Epoch: 11, Steps: 154 | Train Loss: 1.311 Vali Loss: 2.800 Vali Acc: 0.194 Test Loss: 2.800 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.0612578
	speed: 0.1971s/iter; left time: 557.2736s
Epoch: 12 cost time: 9.228261470794678
Epoch: 12, Steps: 154 | Train Loss: 1.246 Vali Loss: 2.471 Vali Acc: 0.379 Test Loss: 2.471 Test Acc: 0.379
Validation loss decreased (-0.356829 --> -0.378726).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9054748
	speed: 0.1951s/iter; left time: 521.6165s
Epoch: 13 cost time: 8.731483459472656
Epoch: 13, Steps: 154 | Train Loss: 1.203 Vali Loss: 2.886 Vali Acc: 0.218 Test Loss: 2.886 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.8207904
	speed: 0.1950s/iter; left time: 491.1293s
Epoch: 14 cost time: 10.673523426055908
Epoch: 14, Steps: 154 | Train Loss: 1.185 Vali Loss: 3.262 Vali Acc: 0.139 Test Loss: 3.262 Test Acc: 0.139
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1908565
	speed: 0.1883s/iter; left time: 445.2114s
Epoch: 15 cost time: 10.85700535774231
Epoch: 15, Steps: 154 | Train Loss: 1.150 Vali Loss: 3.662 Vali Acc: 0.107 Test Loss: 3.662 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.3143169
	speed: 0.1924s/iter; left time: 425.4954s
Epoch: 16 cost time: 8.361695289611816
Epoch: 16, Steps: 154 | Train Loss: 1.108 Vali Loss: 3.296 Vali Acc: 0.174 Test Loss: 3.296 Test Acc: 0.174
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.2803936
	speed: 0.2001s/iter; left time: 411.6888s
Epoch: 17 cost time: 9.763692378997803
Epoch: 17, Steps: 154 | Train Loss: 1.082 Vali Loss: 3.488 Vali Acc: 0.219 Test Loss: 3.488 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.3677400
	speed: 0.1896s/iter; left time: 360.8824s
Epoch: 18 cost time: 11.694587707519531
Epoch: 18, Steps: 154 | Train Loss: 1.060 Vali Loss: 3.969 Vali Acc: 0.157 Test Loss: 3.969 Test Acc: 0.157
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.1080359
	speed: 0.2082s/iter; left time: 364.0979s
Epoch: 19 cost time: 9.709452390670776
Epoch: 19, Steps: 154 | Train Loss: 1.027 Vali Loss: 7.474 Vali Acc: 0.101 Test Loss: 7.474 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.1421988
	speed: 0.1586s/iter; left time: 252.9487s
Epoch: 20 cost time: 10.855750799179077
Epoch: 20, Steps: 154 | Train Loss: 0.995 Vali Loss: 3.507 Vali Acc: 0.191 Test Loss: 3.507 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.2469546
	speed: 0.2643s/iter; left time: 380.7995s
Epoch: 21 cost time: 12.970945835113525
Epoch: 21, Steps: 154 | Train Loss: 0.973 Vali Loss: 3.412 Vali Acc: 0.128 Test Loss: 3.412 Test Acc: 0.128
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.8688785
	speed: 0.2643s/iter; left time: 340.1349s
Epoch: 22 cost time: 12.912136793136597
Epoch: 22, Steps: 154 | Train Loss: 0.945 Vali Loss: 4.002 Vali Acc: 0.131 Test Loss: 4.002 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 1189134
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0840597
	speed: 0.0678s/iter; left time: 306.4909s
Epoch: 1 cost time: 9.82610011100769
Epoch: 1, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.094 Vali Acc: 0.324 Test Loss: 2.094 Test Acc: 0.324
Validation loss decreased (inf --> -0.323580).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3584204
	speed: 0.1778s/iter; left time: 776.5164s
Epoch: 2 cost time: 8.857149362564087
Epoch: 2, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.189 Vali Acc: 0.329 Test Loss: 2.189 Test Acc: 0.329
Validation loss decreased (-0.323580 --> -0.328851).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6959490
	speed: 0.1862s/iter; left time: 784.2780s
Epoch: 3 cost time: 7.83273458480835
Epoch: 3, Steps: 154 | Train Loss: 1.783 Vali Loss: 2.087 Vali Acc: 0.357 Test Loss: 2.087 Test Acc: 0.357
Validation loss decreased (-0.328851 --> -0.356832).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1634990
	speed: 0.1853s/iter; left time: 752.1464s
Epoch: 4 cost time: 9.502403736114502
Epoch: 4, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.240 Vali Acc: 0.365 Test Loss: 2.240 Test Acc: 0.365
Validation loss decreased (-0.356832 --> -0.364941).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4905667
	speed: 0.1923s/iter; left time: 750.8530s
Epoch: 5 cost time: 9.485801458358765
Epoch: 5, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.336 Vali Acc: 0.378 Test Loss: 2.336 Test Acc: 0.378
Validation loss decreased (-0.364941 --> -0.377917).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7272024
	speed: 0.1853s/iter; left time: 695.0943s
Epoch: 6 cost time: 8.650329351425171
Epoch: 6, Steps: 154 | Train Loss: 1.439 Vali Loss: 2.445 Vali Acc: 0.379 Test Loss: 2.445 Test Acc: 0.379
Validation loss decreased (-0.377917 --> -0.378727).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3446537
	speed: 0.1789s/iter; left time: 643.4331s
Epoch: 7 cost time: 9.280864953994751
Epoch: 7, Steps: 154 | Train Loss: 1.390 Vali Loss: 2.393 Vali Acc: 0.247 Test Loss: 2.393 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1421205
	speed: 0.1934s/iter; left time: 665.9848s
Epoch: 8 cost time: 9.450993776321411
Epoch: 8, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.569 Vali Acc: 0.225 Test Loss: 2.569 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3657285
	speed: 0.2132s/iter; left time: 701.2040s
Epoch: 9 cost time: 10.439128398895264
Epoch: 9, Steps: 154 | Train Loss: 1.320 Vali Loss: 3.366 Vali Acc: 0.129 Test Loss: 3.366 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5529575
	speed: 0.2142s/iter; left time: 671.4799s
Epoch: 10 cost time: 9.819285869598389
Epoch: 10, Steps: 154 | Train Loss: 1.288 Vali Loss: 2.253 Vali Acc: 0.395 Test Loss: 2.253 Test Acc: 0.395
Validation loss decreased (-0.378727 --> -0.395355).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3032771
	speed: 0.2010s/iter; left time: 599.1536s
Epoch: 11 cost time: 9.507663011550903
Epoch: 11, Steps: 154 | Train Loss: 1.255 Vali Loss: 2.369 Vali Acc: 0.390 Test Loss: 2.369 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4530194
	speed: 0.1920s/iter; left time: 542.8782s
Epoch: 12 cost time: 8.936556100845337
Epoch: 12, Steps: 154 | Train Loss: 1.210 Vali Loss: 1.961 Vali Acc: 0.403 Test Loss: 1.961 Test Acc: 0.403
Validation loss decreased (-0.395355 --> -0.402657).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7936689
	speed: 0.2040s/iter; left time: 545.3079s
Epoch: 13 cost time: 9.561016082763672
Epoch: 13, Steps: 154 | Train Loss: 1.176 Vali Loss: 3.322 Vali Acc: 0.144 Test Loss: 3.322 Test Acc: 0.144
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.1141027
	speed: 0.2055s/iter; left time: 517.5815s
Epoch: 14 cost time: 9.66447114944458
Epoch: 14, Steps: 154 | Train Loss: 1.144 Vali Loss: 2.602 Vali Acc: 0.272 Test Loss: 2.602 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2748873
	speed: 0.1883s/iter; left time: 445.2638s
Epoch: 15 cost time: 8.744557619094849
Epoch: 15, Steps: 154 | Train Loss: 1.111 Vali Loss: 4.802 Vali Acc: 0.102 Test Loss: 4.802 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.7665421
	speed: 0.1818s/iter; left time: 401.8654s
Epoch: 16 cost time: 8.357915163040161
Epoch: 16, Steps: 154 | Train Loss: 1.096 Vali Loss: 3.332 Vali Acc: 0.169 Test Loss: 3.332 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.9380129
	speed: 0.1774s/iter; left time: 364.9130s
Epoch: 17 cost time: 8.656737565994263
Epoch: 17, Steps: 154 | Train Loss: 1.040 Vali Loss: 6.317 Vali Acc: 0.105 Test Loss: 6.317 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.1838386
	speed: 0.1850s/iter; left time: 352.0312s
Epoch: 18 cost time: 8.895527362823486
Epoch: 18, Steps: 154 | Train Loss: 1.021 Vali Loss: 3.169 Vali Acc: 0.127 Test Loss: 3.169 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9997673
	speed: 0.1957s/iter; left time: 342.3150s
Epoch: 19 cost time: 9.963949918746948
Epoch: 19, Steps: 154 | Train Loss: 0.994 Vali Loss: 7.357 Vali Acc: 0.096 Test Loss: 7.357 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.4024003
	speed: 0.1962s/iter; left time: 312.9237s
Epoch: 20 cost time: 9.392342567443848
Epoch: 20, Steps: 154 | Train Loss: 0.950 Vali Loss: 9.148 Vali Acc: 0.083 Test Loss: 9.148 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.8454768
	speed: 0.1808s/iter; left time: 260.5250s
Epoch: 21 cost time: 8.588124513626099
Epoch: 21, Steps: 154 | Train Loss: 0.935 Vali Loss: 5.784 Vali Acc: 0.102 Test Loss: 5.784 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.1538349
	speed: 0.1852s/iter; left time: 238.4034s
Epoch: 22 cost time: 9.492998361587524
Epoch: 22, Steps: 154 | Train Loss: 0.926 Vali Loss: 7.172 Vali Acc: 0.094 Test Loss: 7.172 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.402676399026764
model parameter : 361486
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7920967
	speed: 0.0818s/iter; left time: 369.6700s
Epoch: 1 cost time: 11.942177772521973
Epoch: 1, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.108 Vali Acc: 0.328 Test Loss: 2.108 Test Acc: 0.328
Validation loss decreased (inf --> -0.328446).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.4951025
	speed: 0.2327s/iter; left time: 1016.1294s
Epoch: 2 cost time: 10.72946047782898
Epoch: 2, Steps: 154 | Train Loss: 1.962 Vali Loss: 2.078 Vali Acc: 0.335 Test Loss: 2.078 Test Acc: 0.335
Validation loss decreased (-0.328446 --> -0.335340).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5235760
	speed: 0.2276s/iter; left time: 958.7394s
Epoch: 3 cost time: 9.840853452682495
Epoch: 3, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.149 Vali Acc: 0.351 Test Loss: 2.149 Test Acc: 0.351
Validation loss decreased (-0.335340 --> -0.350749).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6139536
	speed: 0.2110s/iter; left time: 856.5967s
Epoch: 4 cost time: 10.074740648269653
Epoch: 4, Steps: 154 | Train Loss: 1.644 Vali Loss: 2.308 Vali Acc: 0.350 Test Loss: 2.308 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4608290
	speed: 0.2326s/iter; left time: 908.1592s
Epoch: 5 cost time: 10.722502946853638
Epoch: 5, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.351 Vali Acc: 0.200 Test Loss: 2.351 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.0692497
	speed: 0.2105s/iter; left time: 789.4838s
Epoch: 6 cost time: 9.736281633377075
Epoch: 6, Steps: 154 | Train Loss: 1.521 Vali Loss: 2.239 Vali Acc: 0.378 Test Loss: 2.239 Test Acc: 0.378
Validation loss decreased (-0.350749 --> -0.377918).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6736770
	speed: 0.2056s/iter; left time: 739.6180s
Epoch: 7 cost time: 9.42865252494812
Epoch: 7, Steps: 154 | Train Loss: 1.490 Vali Loss: 2.315 Vali Acc: 0.360 Test Loss: 2.315 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6896918
	speed: 0.1983s/iter; left time: 682.5986s
Epoch: 8 cost time: 9.044344186782837
Epoch: 8, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.483 Vali Acc: 0.201 Test Loss: 2.483 Test Acc: 0.201
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1411299
	speed: 0.1895s/iter; left time: 623.2589s
Epoch: 9 cost time: 9.218765020370483
Epoch: 9, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.495 Vali Acc: 0.220 Test Loss: 2.495 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2863317
	speed: 0.2042s/iter; left time: 640.0310s
Epoch: 10 cost time: 9.390792608261108
Epoch: 10, Steps: 154 | Train Loss: 1.357 Vali Loss: 2.013 Vali Acc: 0.392 Test Loss: 2.013 Test Acc: 0.392
Validation loss decreased (-0.377918 --> -0.391707).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.7927858
	speed: 0.2073s/iter; left time: 618.0765s
Epoch: 11 cost time: 9.530766010284424
Epoch: 11, Steps: 154 | Train Loss: 1.306 Vali Loss: 3.090 Vali Acc: 0.127 Test Loss: 3.090 Test Acc: 0.127
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0077089
	speed: 0.2070s/iter; left time: 585.0980s
Epoch: 12 cost time: 9.621653318405151
Epoch: 12, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.526 Vali Acc: 0.351 Test Loss: 2.526 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2208861
	speed: 0.2185s/iter; left time: 584.0316s
Epoch: 13 cost time: 10.137945652008057
Epoch: 13, Steps: 154 | Train Loss: 1.233 Vali Loss: 2.918 Vali Acc: 0.211 Test Loss: 2.918 Test Acc: 0.211
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.0476439
	speed: 0.2115s/iter; left time: 532.7106s
Epoch: 14 cost time: 10.73152470588684
Epoch: 14, Steps: 154 | Train Loss: 1.201 Vali Loss: 4.948 Vali Acc: 0.097 Test Loss: 4.948 Test Acc: 0.097
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1210519
	speed: 0.2260s/iter; left time: 534.5601s
Epoch: 15 cost time: 10.246717691421509
Epoch: 15, Steps: 154 | Train Loss: 1.177 Vali Loss: 4.062 Vali Acc: 0.109 Test Loss: 4.062 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3382399
	speed: 0.2309s/iter; left time: 510.4248s
Epoch: 16 cost time: 10.20925521850586
Epoch: 16, Steps: 154 | Train Loss: 1.123 Vali Loss: 3.945 Vali Acc: 0.109 Test Loss: 3.945 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.2886554
	speed: 0.2287s/iter; left time: 470.3939s
Epoch: 17 cost time: 10.43429160118103
Epoch: 17, Steps: 154 | Train Loss: 1.102 Vali Loss: 4.681 Vali Acc: 0.161 Test Loss: 4.681 Test Acc: 0.161
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3397666
	speed: 0.2196s/iter; left time: 417.8244s
Epoch: 18 cost time: 9.743208169937134
Epoch: 18, Steps: 154 | Train Loss: 1.099 Vali Loss: 4.053 Vali Acc: 0.146 Test Loss: 4.053 Test Acc: 0.146
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.0339242
	speed: 0.1996s/iter; left time: 349.0550s
Epoch: 19 cost time: 9.710343360900879
Epoch: 19, Steps: 154 | Train Loss: 1.087 Vali Loss: 6.983 Vali Acc: 0.102 Test Loss: 6.983 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2048867
	speed: 0.2082s/iter; left time: 332.0205s
Epoch: 20 cost time: 9.871720314025879
Epoch: 20, Steps: 154 | Train Loss: 1.036 Vali Loss: 3.985 Vali Acc: 0.114 Test Loss: 3.985 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.39172749391727496
model parameter : 1189134
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0863118
	speed: 0.0609s/iter; left time: 275.1957s
Epoch: 1 cost time: 8.648147344589233
Epoch: 1, Steps: 154 | Train Loss: 2.131 Vali Loss: 2.096 Vali Acc: 0.324 Test Loss: 2.096 Test Acc: 0.324
Validation loss decreased (inf --> -0.323580).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3888960
	speed: 0.1616s/iter; left time: 705.5979s
Epoch: 2 cost time: 7.495638847351074
Epoch: 2, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.187 Vali Acc: 0.330 Test Loss: 2.187 Test Acc: 0.330
Validation loss decreased (-0.323580 --> -0.330473).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8449919
	speed: 0.1555s/iter; left time: 655.1819s
Epoch: 3 cost time: 7.427727222442627
Epoch: 3, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.102 Vali Acc: 0.352 Test Loss: 2.102 Test Acc: 0.352
Validation loss decreased (-0.330473 --> -0.351560).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.1969863
	speed: 0.1673s/iter; left time: 678.9965s
Epoch: 4 cost time: 7.359890699386597
Epoch: 4, Steps: 154 | Train Loss: 1.665 Vali Loss: 2.146 Vali Acc: 0.367 Test Loss: 2.146 Test Acc: 0.367
Validation loss decreased (-0.351560 --> -0.366564).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5403581
	speed: 0.1672s/iter; left time: 652.7543s
Epoch: 5 cost time: 7.394284725189209
Epoch: 5, Steps: 154 | Train Loss: 1.544 Vali Loss: 2.377 Vali Acc: 0.358 Test Loss: 2.377 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8671901
	speed: 0.1878s/iter; left time: 704.4469s
Epoch: 6 cost time: 8.699639797210693
Epoch: 6, Steps: 154 | Train Loss: 1.464 Vali Loss: 2.579 Vali Acc: 0.380 Test Loss: 2.579 Test Acc: 0.380
Validation loss decreased (-0.366564 --> -0.379942).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3436463
	speed: 0.1936s/iter; left time: 696.2494s
Epoch: 7 cost time: 8.563225507736206
Epoch: 7, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.700 Vali Acc: 0.202 Test Loss: 2.700 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1628519
	speed: 0.1786s/iter; left time: 614.7680s
Epoch: 8 cost time: 8.802252292633057
Epoch: 8, Steps: 154 | Train Loss: 1.389 Vali Loss: 2.481 Vali Acc: 0.221 Test Loss: 2.481 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6047461
	speed: 0.1763s/iter; left time: 579.8025s
Epoch: 9 cost time: 6.971266269683838
Epoch: 9, Steps: 154 | Train Loss: 1.338 Vali Loss: 3.114 Vali Acc: 0.103 Test Loss: 3.114 Test Acc: 0.103
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.5179600
	speed: 0.0933s/iter; left time: 292.6221s
Epoch: 10 cost time: 5.861910343170166
Epoch: 10, Steps: 154 | Train Loss: 1.303 Vali Loss: 2.236 Vali Acc: 0.411 Test Loss: 2.236 Test Acc: 0.411
Validation loss decreased (-0.379942 --> -0.411170).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3691206
	speed: 0.1551s/iter; left time: 462.4482s
Epoch: 11 cost time: 7.391881942749023
Epoch: 11, Steps: 154 | Train Loss: 1.268 Vali Loss: 2.427 Vali Acc: 0.386 Test Loss: 2.427 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4202266
	speed: 0.1541s/iter; left time: 435.6456s
Epoch: 12 cost time: 6.822222471237183
Epoch: 12, Steps: 154 | Train Loss: 1.225 Vali Loss: 2.126 Vali Acc: 0.412 Test Loss: 2.126 Test Acc: 0.412
Validation loss decreased (-0.411170 --> -0.411982).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.9012591
	speed: 0.1382s/iter; left time: 369.4068s
Epoch: 13 cost time: 6.977660894393921
Epoch: 13, Steps: 154 | Train Loss: 1.191 Vali Loss: 2.443 Vali Acc: 0.325 Test Loss: 2.443 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0194234
	speed: 0.1458s/iter; left time: 367.3735s
Epoch: 14 cost time: 6.687430143356323
Epoch: 14, Steps: 154 | Train Loss: 1.171 Vali Loss: 2.641 Vali Acc: 0.296 Test Loss: 2.641 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.2169251
	speed: 0.1335s/iter; left time: 315.6281s
Epoch: 15 cost time: 6.459781169891357
Epoch: 15, Steps: 154 | Train Loss: 1.136 Vali Loss: 4.659 Vali Acc: 0.089 Test Loss: 4.659 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8631360
	speed: 0.1432s/iter; left time: 316.6384s
Epoch: 16 cost time: 6.866569757461548
Epoch: 16, Steps: 154 | Train Loss: 1.125 Vali Loss: 2.769 Vali Acc: 0.342 Test Loss: 2.769 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.8715225
	speed: 0.1387s/iter; left time: 285.2611s
Epoch: 17 cost time: 6.096009731292725
Epoch: 17, Steps: 154 | Train Loss: 1.075 Vali Loss: 6.124 Vali Acc: 0.093 Test Loss: 6.124 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.0772328
	speed: 0.1407s/iter; left time: 267.7091s
Epoch: 18 cost time: 6.881515264511108
Epoch: 18, Steps: 154 | Train Loss: 1.055 Vali Loss: 2.956 Vali Acc: 0.245 Test Loss: 2.956 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.9480478
	speed: 0.1411s/iter; left time: 246.8466s
Epoch: 19 cost time: 6.129230737686157
Epoch: 19, Steps: 154 | Train Loss: 1.021 Vali Loss: 4.145 Vali Acc: 0.108 Test Loss: 4.145 Test Acc: 0.108
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.3352871
	speed: 0.1422s/iter; left time: 226.7974s
Epoch: 20 cost time: 7.718166828155518
Epoch: 20, Steps: 154 | Train Loss: 0.992 Vali Loss: 5.720 Vali Acc: 0.087 Test Loss: 5.720 Test Acc: 0.087
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.0172174
	speed: 0.1533s/iter; left time: 220.9292s
Epoch: 21 cost time: 7.467214822769165
Epoch: 21, Steps: 154 | Train Loss: 0.978 Vali Loss: 5.531 Vali Acc: 0.090 Test Loss: 5.531 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.1841990
	speed: 0.1433s/iter; left time: 184.4570s
Epoch: 22 cost time: 6.86617374420166
Epoch: 22, Steps: 154 | Train Loss: 0.947 Vali Loss: 5.306 Vali Acc: 0.086 Test Loss: 5.306 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4120032441200324
model parameter : 361486
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8013319
	speed: 0.0528s/iter; left time: 238.7806s
Epoch: 1 cost time: 7.3663411140441895
Epoch: 1, Steps: 154 | Train Loss: 2.165 Vali Loss: 2.121 Vali Acc: 0.321 Test Loss: 2.121 Test Acc: 0.321
Validation loss decreased (inf --> -0.321147).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5218303
	speed: 0.1311s/iter; left time: 572.4240s
Epoch: 2 cost time: 6.081074476242065
Epoch: 2, Steps: 154 | Train Loss: 1.979 Vali Loss: 2.075 Vali Acc: 0.329 Test Loss: 2.075 Test Acc: 0.329
Validation loss decreased (-0.321147 --> -0.329257).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4613049
	speed: 0.1467s/iter; left time: 618.2202s
Epoch: 3 cost time: 6.501843452453613
Epoch: 3, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.024 Vali Acc: 0.363 Test Loss: 2.024 Test Acc: 0.363
Validation loss decreased (-0.329257 --> -0.363321).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5165597
	speed: 0.1403s/iter; left time: 569.6721s
Epoch: 4 cost time: 5.676364898681641
Epoch: 4, Steps: 154 | Train Loss: 1.703 Vali Loss: 2.299 Vali Acc: 0.351 Test Loss: 2.299 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.4158922
	speed: 0.1238s/iter; left time: 483.5300s
Epoch: 5 cost time: 6.075748682022095
Epoch: 5, Steps: 154 | Train Loss: 1.603 Vali Loss: 2.691 Vali Acc: 0.197 Test Loss: 2.691 Test Acc: 0.197
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.1563557
	speed: 0.1337s/iter; left time: 501.4911s
Epoch: 6 cost time: 6.176156759262085
Epoch: 6, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.392 Vali Acc: 0.208 Test Loss: 2.392 Test Acc: 0.208
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 1.7254753
	speed: 0.1199s/iter; left time: 431.4024s
Epoch: 7 cost time: 5.257636308670044
Epoch: 7, Steps: 154 | Train Loss: 1.528 Vali Loss: 2.862 Vali Acc: 0.365 Test Loss: 2.862 Test Acc: 0.365
Validation loss decreased (-0.363321 --> -0.365340).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7619839
	speed: 0.1290s/iter; left time: 444.2425s
Epoch: 8 cost time: 5.948214769363403
Epoch: 8, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.861 Vali Acc: 0.152 Test Loss: 2.861 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3199649
	speed: 0.1339s/iter; left time: 440.5247s
Epoch: 9 cost time: 5.765530586242676
Epoch: 9, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.916 Vali Acc: 0.214 Test Loss: 2.916 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1628374
	speed: 0.1179s/iter; left time: 369.5203s
Epoch: 10 cost time: 5.611694812774658
Epoch: 10, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.417 Vali Acc: 0.372 Test Loss: 2.417 Test Acc: 0.372
Validation loss decreased (-0.365340 --> -0.372239).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9454990
	speed: 0.1284s/iter; left time: 382.7339s
Epoch: 11 cost time: 5.686682224273682
Epoch: 11, Steps: 154 | Train Loss: 1.355 Vali Loss: 3.643 Vali Acc: 0.100 Test Loss: 3.643 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9378664
	speed: 0.1281s/iter; left time: 362.2273s
Epoch: 12 cost time: 5.542281150817871
Epoch: 12, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.502 Vali Acc: 0.210 Test Loss: 3.502 Test Acc: 0.210
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2416596
	speed: 0.1358s/iter; left time: 363.0148s
Epoch: 13 cost time: 6.891147136688232
Epoch: 13, Steps: 154 | Train Loss: 1.270 Vali Loss: 3.157 Vali Acc: 0.232 Test Loss: 3.157 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1776397
	speed: 0.1516s/iter; left time: 381.8642s
Epoch: 14 cost time: 6.781760931015015
Epoch: 14, Steps: 154 | Train Loss: 1.237 Vali Loss: 4.937 Vali Acc: 0.085 Test Loss: 4.937 Test Acc: 0.085
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.2844281
	speed: 0.1357s/iter; left time: 320.9594s
Epoch: 15 cost time: 6.325993537902832
Epoch: 15, Steps: 154 | Train Loss: 1.215 Vali Loss: 4.667 Vali Acc: 0.090 Test Loss: 4.667 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5120988
	speed: 0.1521s/iter; left time: 336.2310s
Epoch: 16 cost time: 6.968773126602173
Epoch: 16, Steps: 154 | Train Loss: 1.164 Vali Loss: 4.985 Vali Acc: 0.105 Test Loss: 4.985 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.3168766
	speed: 0.1537s/iter; left time: 316.2371s
Epoch: 17 cost time: 6.594218730926514
Epoch: 17, Steps: 154 | Train Loss: 1.173 Vali Loss: 5.684 Vali Acc: 0.125 Test Loss: 5.684 Test Acc: 0.125
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.2640445
	speed: 0.1369s/iter; left time: 260.5904s
Epoch: 18 cost time: 6.6969685554504395
Epoch: 18, Steps: 154 | Train Loss: 1.122 Vali Loss: 6.526 Vali Acc: 0.089 Test Loss: 6.526 Test Acc: 0.089
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9443284
	speed: 0.1511s/iter; left time: 264.3563s
Epoch: 19 cost time: 6.793089151382446
Epoch: 19, Steps: 154 | Train Loss: 1.103 Vali Loss: 7.080 Vali Acc: 0.097 Test Loss: 7.080 Test Acc: 0.097
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.1491270
	speed: 0.1331s/iter; left time: 212.2826s
Epoch: 20 cost time: 5.780191421508789
Epoch: 20, Steps: 154 | Train Loss: 1.077 Vali Loss: 4.811 Vali Acc: 0.111 Test Loss: 4.811 Test Acc: 0.111
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3722627737226277
model parameter : 1189134
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0897350
	speed: 0.0466s/iter; left time: 210.8372s
Epoch: 1 cost time: 6.382789611816406
Epoch: 1, Steps: 154 | Train Loss: 2.134 Vali Loss: 2.100 Vali Acc: 0.322 Test Loss: 2.100 Test Acc: 0.322
Validation loss decreased (inf --> -0.321958).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4203775
	speed: 0.1075s/iter; left time: 469.3084s
Epoch: 2 cost time: 4.668331146240234
Epoch: 2, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.180 Vali Acc: 0.330 Test Loss: 2.180 Test Acc: 0.330
Validation loss decreased (-0.321958 --> -0.330067).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8407116
	speed: 0.1215s/iter; left time: 511.7329s
Epoch: 3 cost time: 5.168676137924194
Epoch: 3, Steps: 154 | Train Loss: 1.813 Vali Loss: 2.084 Vali Acc: 0.355 Test Loss: 2.084 Test Acc: 0.355
Validation loss decreased (-0.330067 --> -0.355210).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.2222875
	speed: 0.1173s/iter; left time: 476.0540s
Epoch: 4 cost time: 4.857415437698364
Epoch: 4, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.014 Vali Acc: 0.378 Test Loss: 2.014 Test Acc: 0.378
Validation loss decreased (-0.355210 --> -0.378325).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5568224
	speed: 0.1093s/iter; left time: 426.8705s
Epoch: 5 cost time: 5.226828336715698
Epoch: 5, Steps: 154 | Train Loss: 1.566 Vali Loss: 2.488 Vali Acc: 0.157 Test Loss: 2.488 Test Acc: 0.157
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8610688
	speed: 0.1181s/iter; left time: 442.9232s
Epoch: 6 cost time: 5.1269471645355225
Epoch: 6, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.701 Vali Acc: 0.381 Test Loss: 2.701 Test Acc: 0.381
Validation loss decreased (-0.378325 --> -0.381157).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3288599
	speed: 0.1153s/iter; left time: 414.8198s
Epoch: 7 cost time: 5.202229738235474
Epoch: 7, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.246 Vali Acc: 0.105 Test Loss: 3.246 Test Acc: 0.105
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1542687
	speed: 0.1223s/iter; left time: 421.0348s
Epoch: 8 cost time: 5.919391870498657
Epoch: 8, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.107 Vali Acc: 0.181 Test Loss: 3.107 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5764772
	speed: 0.1302s/iter; left time: 428.3417s
Epoch: 9 cost time: 5.734453201293945
Epoch: 9, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.637 Vali Acc: 0.085 Test Loss: 3.637 Test Acc: 0.085
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6687360
	speed: 0.1190s/iter; left time: 373.1856s
Epoch: 10 cost time: 5.375702619552612
Epoch: 10, Steps: 154 | Train Loss: 1.357 Vali Loss: 3.259 Vali Acc: 0.219 Test Loss: 3.259 Test Acc: 0.219
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.2254437
	speed: 0.1226s/iter; left time: 365.3989s
Epoch: 11 cost time: 5.268699645996094
Epoch: 11, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.345 Vali Acc: 0.154 Test Loss: 3.345 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4761441
	speed: 0.1283s/iter; left time: 362.8015s
Epoch: 12 cost time: 5.701884984970093
Epoch: 12, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.686 Vali Acc: 0.399 Test Loss: 2.686 Test Acc: 0.399
Validation loss decreased (-0.381157 --> -0.398594).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.0885162
	speed: 0.1260s/iter; left time: 336.8579s
Epoch: 13 cost time: 5.067023754119873
Epoch: 13, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.267 Vali Acc: 0.316 Test Loss: 3.267 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.0251511
	speed: 0.1236s/iter; left time: 311.4315s
Epoch: 14 cost time: 6.030937910079956
Epoch: 14, Steps: 154 | Train Loss: 1.247 Vali Loss: 5.202 Vali Acc: 0.080 Test Loss: 5.202 Test Acc: 0.080
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1416584
	speed: 0.1302s/iter; left time: 308.0199s
Epoch: 15 cost time: 5.032133340835571
Epoch: 15, Steps: 154 | Train Loss: 1.235 Vali Loss: 4.363 Vali Acc: 0.097 Test Loss: 4.363 Test Acc: 0.097
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.8130606
	speed: 0.1091s/iter; left time: 241.1998s
Epoch: 16 cost time: 4.811758995056152
Epoch: 16, Steps: 154 | Train Loss: 1.206 Vali Loss: 5.887 Vali Acc: 0.079 Test Loss: 5.887 Test Acc: 0.079
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.0633534
	speed: 0.1175s/iter; left time: 241.6396s
Epoch: 17 cost time: 5.275688886642456
Epoch: 17, Steps: 154 | Train Loss: 1.161 Vali Loss: 6.721 Vali Acc: 0.091 Test Loss: 6.721 Test Acc: 0.091
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 1.2347631
	speed: 0.1210s/iter; left time: 230.2318s
Epoch: 18 cost time: 5.130035638809204
Epoch: 18, Steps: 154 | Train Loss: 1.145 Vali Loss: 4.755 Vali Acc: 0.095 Test Loss: 4.755 Test Acc: 0.095
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.2389408
	speed: 0.1066s/iter; left time: 186.4357s
Epoch: 19 cost time: 4.862589597702026
Epoch: 19, Steps: 154 | Train Loss: 1.106 Vali Loss: 6.443 Vali Acc: 0.088 Test Loss: 6.443 Test Acc: 0.088
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.1413479
	speed: 0.1219s/iter; left time: 194.4853s
Epoch: 20 cost time: 5.185708284378052
Epoch: 20, Steps: 154 | Train Loss: 1.069 Vali Loss: 7.153 Vali Acc: 0.073 Test Loss: 7.153 Test Acc: 0.073
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.0342824
	speed: 0.1168s/iter; left time: 168.3119s
Epoch: 21 cost time: 4.569869756698608
Epoch: 21, Steps: 154 | Train Loss: 1.034 Vali Loss: 7.417 Vali Acc: 0.082 Test Loss: 7.417 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.5534415
	speed: 0.1092s/iter; left time: 140.5009s
Epoch: 22 cost time: 5.157318115234375
Epoch: 22, Steps: 154 | Train Loss: 1.042 Vali Loss: 8.475 Vali Acc: 0.079 Test Loss: 8.475 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3986212489862125
model parameter : 361486
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1264818
	speed: 0.0803s/iter; left time: 363.1194s
Epoch: 1 cost time: 11.884218454360962
Epoch: 1, Steps: 154 | Train Loss: 2.211 Vali Loss: 2.085 Vali Acc: 0.318 Test Loss: 2.085 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7221686
	speed: 0.2244s/iter; left time: 980.1233s
Epoch: 2 cost time: 11.363190174102783
Epoch: 2, Steps: 154 | Train Loss: 1.981 Vali Loss: 2.062 Vali Acc: 0.336 Test Loss: 2.062 Test Acc: 0.336
Validation loss decreased (-0.317903 --> -0.335746).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5870992
	speed: 0.2143s/iter; left time: 903.0446s
Epoch: 3 cost time: 10.358866930007935
Epoch: 3, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.090 Vali Acc: 0.336 Test Loss: 2.090 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7090657
	speed: 0.2169s/iter; left time: 880.2761s
Epoch: 4 cost time: 11.299420356750488
Epoch: 4, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.088 Vali Acc: 0.360 Test Loss: 2.088 Test Acc: 0.360
Validation loss decreased (-0.335746 --> -0.360076).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6812385
	speed: 0.2097s/iter; left time: 818.8636s
Epoch: 5 cost time: 10.314330577850342
Epoch: 5, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.227 Vali Acc: 0.201 Test Loss: 2.227 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3671328
	speed: 0.2115s/iter; left time: 793.3068s
Epoch: 6 cost time: 10.116205215454102
Epoch: 6, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.063 Vali Acc: 0.358 Test Loss: 2.063 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4788883
	speed: 0.1906s/iter; left time: 685.5617s
Epoch: 7 cost time: 9.41632890701294
Epoch: 7, Steps: 154 | Train Loss: 1.588 Vali Loss: 2.216 Vali Acc: 0.199 Test Loss: 2.216 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2877637
	speed: 0.1968s/iter; left time: 677.4455s
Epoch: 8 cost time: 10.478441715240479
Epoch: 8, Steps: 154 | Train Loss: 1.538 Vali Loss: 6.607 Vali Acc: 0.116 Test Loss: 6.607 Test Acc: 0.116
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.1288157
	speed: 0.1919s/iter; left time: 631.2991s
Epoch: 9 cost time: 9.478538513183594
Epoch: 9, Steps: 154 | Train Loss: 1.525 Vali Loss: 6.353 Vali Acc: 0.123 Test Loss: 6.353 Test Acc: 0.123
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.8231573
	speed: 0.1955s/iter; left time: 612.8626s
Epoch: 10 cost time: 10.119695663452148
Epoch: 10, Steps: 154 | Train Loss: 1.476 Vali Loss: 3.310 Vali Acc: 0.124 Test Loss: 3.310 Test Acc: 0.124
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3007717
	speed: 0.1910s/iter; left time: 569.4254s
Epoch: 11 cost time: 9.574434518814087
Epoch: 11, Steps: 154 | Train Loss: 1.445 Vali Loss: 3.690 Vali Acc: 0.115 Test Loss: 3.690 Test Acc: 0.115
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.5178479
	speed: 0.1996s/iter; left time: 564.2422s
Epoch: 12 cost time: 10.596271991729736
Epoch: 12, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.980 Vali Acc: 0.122 Test Loss: 3.980 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.0575808
	speed: 0.2116s/iter; left time: 565.7341s
Epoch: 13 cost time: 10.64459776878357
Epoch: 13, Steps: 154 | Train Loss: 1.348 Vali Loss: 6.612 Vali Acc: 0.130 Test Loss: 6.612 Test Acc: 0.130
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0730946
	speed: 0.2231s/iter; left time: 562.0426s
Epoch: 14 cost time: 11.451350212097168
Epoch: 14, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.532 Vali Acc: 0.123 Test Loss: 3.532 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36009732360097324
model parameter : 1180878
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8280753
	speed: 0.0692s/iter; left time: 312.9182s
Epoch: 1 cost time: 10.03501009941101
Epoch: 1, Steps: 154 | Train Loss: 2.194 Vali Loss: 2.120 Vali Acc: 0.318 Test Loss: 2.120 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5167031
	speed: 0.1781s/iter; left time: 777.8819s
Epoch: 2 cost time: 8.760866641998291
Epoch: 2, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.086 Vali Acc: 0.327 Test Loss: 2.086 Test Acc: 0.327
Validation loss decreased (-0.318308 --> -0.327230).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9575459
	speed: 0.1545s/iter; left time: 650.9848s
Epoch: 3 cost time: 7.001550674438477
Epoch: 3, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.029 Vali Acc: 0.344 Test Loss: 2.029 Test Acc: 0.344
Validation loss decreased (-0.327230 --> -0.344262).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4353549
	speed: 0.1505s/iter; left time: 611.0471s
Epoch: 4 cost time: 9.200664520263672
Epoch: 4, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.334 Vali Acc: 0.079 Test Loss: 2.334 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1975291
	speed: 0.1917s/iter; left time: 748.4032s
Epoch: 5 cost time: 9.297985076904297
Epoch: 5, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.193 Vali Acc: 0.346 Test Loss: 2.193 Test Acc: 0.346
Validation loss decreased (-0.344262 --> -0.345882).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5644987
	speed: 0.1897s/iter; left time: 711.7468s
Epoch: 6 cost time: 9.127750635147095
Epoch: 6, Steps: 154 | Train Loss: 1.565 Vali Loss: 2.253 Vali Acc: 0.320 Test Loss: 2.253 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4927803
	speed: 0.1784s/iter; left time: 641.7826s
Epoch: 7 cost time: 9.004172325134277
Epoch: 7, Steps: 154 | Train Loss: 1.518 Vali Loss: 4.295 Vali Acc: 0.113 Test Loss: 4.295 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1660224
	speed: 0.1904s/iter; left time: 655.5434s
Epoch: 8 cost time: 9.147952795028687
Epoch: 8, Steps: 154 | Train Loss: 1.468 Vali Loss: 4.464 Vali Acc: 0.121 Test Loss: 4.464 Test Acc: 0.121
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.8705418
	speed: 0.1862s/iter; left time: 612.4743s
Epoch: 9 cost time: 8.976211309432983
Epoch: 9, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.256 Vali Acc: 0.365 Test Loss: 2.256 Test Acc: 0.365
Validation loss decreased (-0.345882 --> -0.365346).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3477653
	speed: 0.1867s/iter; left time: 585.3647s
Epoch: 10 cost time: 9.455871820449829
Epoch: 10, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.410 Vali Acc: 0.299 Test Loss: 2.410 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.9528856
	speed: 0.1727s/iter; left time: 514.8745s
Epoch: 11 cost time: 8.102666139602661
Epoch: 11, Steps: 154 | Train Loss: 1.326 Vali Loss: 3.082 Vali Acc: 0.124 Test Loss: 3.082 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1590047
	speed: 0.1964s/iter; left time: 555.3292s
Epoch: 12 cost time: 9.762749910354614
Epoch: 12, Steps: 154 | Train Loss: 1.317 Vali Loss: 5.594 Vali Acc: 0.094 Test Loss: 5.594 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.1160436
	speed: 0.2007s/iter; left time: 536.4697s
Epoch: 13 cost time: 9.331495761871338
Epoch: 13, Steps: 154 | Train Loss: 1.284 Vali Loss: 3.340 Vali Acc: 0.137 Test Loss: 3.340 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3078594
	speed: 0.1949s/iter; left time: 490.9281s
Epoch: 14 cost time: 9.329471111297607
Epoch: 14, Steps: 154 | Train Loss: 1.231 Vali Loss: 6.809 Vali Acc: 0.129 Test Loss: 6.809 Test Acc: 0.129
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.1097908
	speed: 0.1784s/iter; left time: 421.8143s
Epoch: 15 cost time: 9.431172609329224
Epoch: 15, Steps: 154 | Train Loss: 1.217 Vali Loss: 2.834 Vali Acc: 0.228 Test Loss: 2.834 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.5134568
	speed: 0.2005s/iter; left time: 443.2335s
Epoch: 16 cost time: 9.717406034469604
Epoch: 16, Steps: 154 | Train Loss: 1.188 Vali Loss: 5.837 Vali Acc: 0.137 Test Loss: 5.837 Test Acc: 0.137
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.8621172
	speed: 0.1921s/iter; left time: 395.1287s
Epoch: 17 cost time: 9.064542531967163
Epoch: 17, Steps: 154 | Train Loss: 1.166 Vali Loss: 5.243 Vali Acc: 0.131 Test Loss: 5.243 Test Acc: 0.131
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.0756848
	speed: 0.1805s/iter; left time: 343.4266s
Epoch: 18 cost time: 8.570182085037231
Epoch: 18, Steps: 154 | Train Loss: 1.122 Vali Loss: 4.694 Vali Acc: 0.135 Test Loss: 4.694 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.6919060
	speed: 0.1821s/iter; left time: 318.4553s
Epoch: 19 cost time: 8.538917779922485
Epoch: 19, Steps: 154 | Train Loss: 1.123 Vali Loss: 6.640 Vali Acc: 0.131 Test Loss: 6.640 Test Acc: 0.131
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3653690186536902
model parameter : 353166
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1533191
	speed: 0.0748s/iter; left time: 338.0139s
Epoch: 1 cost time: 10.317630767822266
Epoch: 1, Steps: 154 | Train Loss: 2.217 Vali Loss: 2.099 Vali Acc: 0.318 Test Loss: 2.099 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7209736
	speed: 0.1755s/iter; left time: 766.4200s
Epoch: 2 cost time: 8.707456111907959
Epoch: 2, Steps: 154 | Train Loss: 2.000 Vali Loss: 2.067 Vali Acc: 0.335 Test Loss: 2.067 Test Acc: 0.335
Validation loss decreased (-0.318308 --> -0.334529).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6480408
	speed: 0.1964s/iter; left time: 827.4242s
Epoch: 3 cost time: 9.704043865203857
Epoch: 3, Steps: 154 | Train Loss: 1.870 Vali Loss: 2.039 Vali Acc: 0.337 Test Loss: 2.039 Test Acc: 0.337
Validation loss decreased (-0.334529 --> -0.336963).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6265308
	speed: 0.1883s/iter; left time: 764.1346s
Epoch: 4 cost time: 8.96399736404419
Epoch: 4, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.064 Vali Acc: 0.364 Test Loss: 2.064 Test Acc: 0.364
Validation loss decreased (-0.336963 --> -0.364132).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6763687
	speed: 0.1953s/iter; left time: 762.5190s
Epoch: 5 cost time: 8.608012437820435
Epoch: 5, Steps: 154 | Train Loss: 1.709 Vali Loss: 1.996 Vali Acc: 0.356 Test Loss: 1.996 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4939845
	speed: 0.1830s/iter; left time: 686.4079s
Epoch: 6 cost time: 9.289841890335083
Epoch: 6, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.002 Vali Acc: 0.357 Test Loss: 2.002 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4111111
	speed: 0.1962s/iter; left time: 705.8546s
Epoch: 7 cost time: 8.630690097808838
Epoch: 7, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.436 Vali Acc: 0.173 Test Loss: 2.436 Test Acc: 0.173
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3777639
	speed: 0.1680s/iter; left time: 578.2705s
Epoch: 8 cost time: 8.874136924743652
Epoch: 8, Steps: 154 | Train Loss: 1.532 Vali Loss: 3.297 Vali Acc: 0.130 Test Loss: 3.297 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.0372365
	speed: 0.2257s/iter; left time: 742.4702s
Epoch: 9 cost time: 10.082132816314697
Epoch: 9, Steps: 154 | Train Loss: 1.499 Vali Loss: 4.178 Vali Acc: 0.112 Test Loss: 4.178 Test Acc: 0.112
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.8073884
	speed: 0.2394s/iter; left time: 750.5177s
Epoch: 10 cost time: 11.541367053985596
Epoch: 10, Steps: 154 | Train Loss: 1.456 Vali Loss: 5.290 Vali Acc: 0.130 Test Loss: 5.290 Test Acc: 0.130
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.1712643
	speed: 0.2477s/iter; left time: 738.5329s
Epoch: 11 cost time: 11.568897247314453
Epoch: 11, Steps: 154 | Train Loss: 1.423 Vali Loss: 4.669 Vali Acc: 0.130 Test Loss: 4.669 Test Acc: 0.130
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.4634006
	speed: 0.2480s/iter; left time: 701.2224s
Epoch: 12 cost time: 11.43461298942566
Epoch: 12, Steps: 154 | Train Loss: 1.386 Vali Loss: 2.606 Vali Acc: 0.100 Test Loss: 2.606 Test Acc: 0.100
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.9842266
	speed: 0.2324s/iter; left time: 621.1034s
Epoch: 13 cost time: 10.187876224517822
Epoch: 13, Steps: 154 | Train Loss: 1.354 Vali Loss: 8.892 Vali Acc: 0.139 Test Loss: 8.892 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0831436
	speed: 0.2404s/iter; left time: 605.6405s
Epoch: 14 cost time: 11.718220949172974
Epoch: 14, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.230 Vali Acc: 0.107 Test Loss: 3.230 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36415247364152475
model parameter : 1180878
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8351212
	speed: 0.0629s/iter; left time: 284.4604s
Epoch: 1 cost time: 8.987945318222046
Epoch: 1, Steps: 154 | Train Loss: 2.196 Vali Loss: 2.122 Vali Acc: 0.317 Test Loss: 2.122 Test Acc: 0.317
Validation loss decreased (inf --> -0.317092).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5039270
	speed: 0.1662s/iter; left time: 725.7591s
Epoch: 2 cost time: 7.063592195510864
Epoch: 2, Steps: 154 | Train Loss: 2.017 Vali Loss: 2.085 Vali Acc: 0.328 Test Loss: 2.085 Test Acc: 0.328
Validation loss decreased (-0.317092 --> -0.328041).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8876586
	speed: 0.1639s/iter; left time: 690.6026s
Epoch: 3 cost time: 8.047139167785645
Epoch: 3, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.018 Vali Acc: 0.344 Test Loss: 2.018 Test Acc: 0.344
Validation loss decreased (-0.328041 --> -0.343857).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4017802
	speed: 0.1860s/iter; left time: 754.8251s
Epoch: 4 cost time: 9.120282888412476
Epoch: 4, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.278 Vali Acc: 0.339 Test Loss: 2.278 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.3166790
	speed: 0.1828s/iter; left time: 713.7807s
Epoch: 5 cost time: 8.082515716552734
Epoch: 5, Steps: 154 | Train Loss: 1.662 Vali Loss: 2.308 Vali Acc: 0.347 Test Loss: 2.308 Test Acc: 0.347
Validation loss decreased (-0.343857 --> -0.346692).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5152179
	speed: 0.1691s/iter; left time: 634.1088s
Epoch: 6 cost time: 7.0764758586883545
Epoch: 6, Steps: 154 | Train Loss: 1.613 Vali Loss: 2.372 Vali Acc: 0.289 Test Loss: 2.372 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.4552929
	speed: 0.1623s/iter; left time: 583.9516s
Epoch: 7 cost time: 8.00425934791565
Epoch: 7, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.239 Vali Acc: 0.357 Test Loss: 2.239 Test Acc: 0.357
Validation loss decreased (-0.346692 --> -0.356831).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1110004
	speed: 0.1809s/iter; left time: 622.8396s
Epoch: 8 cost time: 8.121997356414795
Epoch: 8, Steps: 154 | Train Loss: 1.472 Vali Loss: 2.704 Vali Acc: 0.102 Test Loss: 2.704 Test Acc: 0.102
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8843120
	speed: 0.1793s/iter; left time: 589.8449s
Epoch: 9 cost time: 8.214990139007568
Epoch: 9, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.528 Vali Acc: 0.124 Test Loss: 2.528 Test Acc: 0.124
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1987795
	speed: 0.1929s/iter; left time: 604.8302s
Epoch: 10 cost time: 8.144952297210693
Epoch: 10, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.307 Vali Acc: 0.377 Test Loss: 2.307 Test Acc: 0.377
Validation loss decreased (-0.356831 --> -0.376700).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.9630802
	speed: 0.1840s/iter; left time: 548.3660s
Epoch: 11 cost time: 8.13943076133728
Epoch: 11, Steps: 154 | Train Loss: 1.335 Vali Loss: 2.540 Vali Acc: 0.226 Test Loss: 2.540 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2314050
	speed: 0.2029s/iter; left time: 573.5999s
Epoch: 12 cost time: 9.070635318756104
Epoch: 12, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.153 Vali Acc: 0.099 Test Loss: 3.153 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0384579
	speed: 0.2043s/iter; left time: 546.0779s
Epoch: 13 cost time: 8.675264120101929
Epoch: 13, Steps: 154 | Train Loss: 1.304 Vali Loss: 2.463 Vali Acc: 0.232 Test Loss: 2.463 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2514919
	speed: 0.2071s/iter; left time: 521.6805s
Epoch: 14 cost time: 9.448542594909668
Epoch: 14, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.431 Vali Acc: 0.139 Test Loss: 3.431 Test Acc: 0.139
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1646106
	speed: 0.1916s/iter; left time: 453.0724s
Epoch: 15 cost time: 8.308019161224365
Epoch: 15, Steps: 154 | Train Loss: 1.214 Vali Loss: 3.156 Vali Acc: 0.101 Test Loss: 3.156 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5714386
	speed: 0.1958s/iter; left time: 432.9271s
Epoch: 16 cost time: 8.947717905044556
Epoch: 16, Steps: 154 | Train Loss: 1.197 Vali Loss: 2.767 Vali Acc: 0.197 Test Loss: 2.767 Test Acc: 0.197
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.8810793
	speed: 0.2026s/iter; left time: 416.7866s
Epoch: 17 cost time: 9.026586055755615
Epoch: 17, Steps: 154 | Train Loss: 1.178 Vali Loss: 2.733 Vali Acc: 0.249 Test Loss: 2.733 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.2210732
	speed: 0.1948s/iter; left time: 370.6450s
Epoch: 18 cost time: 8.018613338470459
Epoch: 18, Steps: 154 | Train Loss: 1.152 Vali Loss: 2.686 Vali Acc: 0.200 Test Loss: 2.686 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.7193089
	speed: 0.1675s/iter; left time: 292.9670s
Epoch: 19 cost time: 6.948629140853882
Epoch: 19, Steps: 154 | Train Loss: 1.142 Vali Loss: 3.067 Vali Acc: 0.122 Test Loss: 3.067 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0158322
	speed: 0.1575s/iter; left time: 251.1395s
Epoch: 20 cost time: 7.245720148086548
Epoch: 20, Steps: 154 | Train Loss: 1.115 Vali Loss: 2.524 Vali Acc: 0.234 Test Loss: 2.524 Test Acc: 0.234
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3767234387672344
model parameter : 353166
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1435478
	speed: 0.0538s/iter; left time: 243.1790s
Epoch: 1 cost time: 7.723179817199707
Epoch: 1, Steps: 154 | Train Loss: 2.218 Vali Loss: 2.083 Vali Acc: 0.319 Test Loss: 2.083 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7242702
	speed: 0.1331s/iter; left time: 581.2814s
Epoch: 2 cost time: 5.681511878967285
Epoch: 2, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.072 Vali Acc: 0.334 Test Loss: 2.072 Test Acc: 0.334
Validation loss decreased (-0.319119 --> -0.334124).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6339943
	speed: 0.1328s/iter; left time: 559.4469s
Epoch: 3 cost time: 6.674894332885742
Epoch: 3, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.094 Vali Acc: 0.333 Test Loss: 2.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6605251
	speed: 0.1367s/iter; left time: 554.8541s
Epoch: 4 cost time: 5.900438547134399
Epoch: 4, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.009 Vali Acc: 0.343 Test Loss: 2.009 Test Acc: 0.343
Validation loss decreased (-0.334124 --> -0.343046).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8267491
	speed: 0.1294s/iter; left time: 505.3109s
Epoch: 5 cost time: 7.775363445281982
Epoch: 5, Steps: 154 | Train Loss: 1.759 Vali Loss: 2.040 Vali Acc: 0.351 Test Loss: 2.040 Test Acc: 0.351
Validation loss decreased (-0.343046 --> -0.350750).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6552467
	speed: 0.1718s/iter; left time: 644.3884s
Epoch: 6 cost time: 8.061845779418945
Epoch: 6, Steps: 154 | Train Loss: 1.733 Vali Loss: 1.979 Vali Acc: 0.358 Test Loss: 1.979 Test Acc: 0.358
Validation loss decreased (-0.350750 --> -0.358050).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5971380
	speed: 0.1550s/iter; left time: 557.5964s
Epoch: 7 cost time: 6.93229079246521
Epoch: 7, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.800 Vali Acc: 0.116 Test Loss: 2.800 Test Acc: 0.116
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5021080
	speed: 0.1671s/iter; left time: 575.2971s
Epoch: 8 cost time: 7.562377691268921
Epoch: 8, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.523 Vali Acc: 0.326 Test Loss: 2.523 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.0890548
	speed: 0.1639s/iter; left time: 538.9088s
Epoch: 9 cost time: 6.7846198081970215
Epoch: 9, Steps: 154 | Train Loss: 1.557 Vali Loss: 2.141 Vali Acc: 0.386 Test Loss: 2.141 Test Acc: 0.386
Validation loss decreased (-0.358050 --> -0.385623).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8307837
	speed: 0.1609s/iter; left time: 504.4149s
Epoch: 10 cost time: 7.706926345825195
Epoch: 10, Steps: 154 | Train Loss: 1.511 Vali Loss: 3.659 Vali Acc: 0.122 Test Loss: 3.659 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3283852
	speed: 0.1696s/iter; left time: 505.5893s
Epoch: 11 cost time: 7.063634872436523
Epoch: 11, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.067 Vali Acc: 0.376 Test Loss: 2.067 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.5229828
	speed: 0.1531s/iter; left time: 432.9392s
Epoch: 12 cost time: 7.386476993560791
Epoch: 12, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.292 Vali Acc: 0.385 Test Loss: 2.292 Test Acc: 0.385
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9950702
	speed: 0.1630s/iter; left time: 435.7842s
Epoch: 13 cost time: 6.433172702789307
Epoch: 13, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.930 Vali Acc: 0.114 Test Loss: 2.930 Test Acc: 0.114
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.0149404
	speed: 0.1329s/iter; left time: 334.6591s
Epoch: 14 cost time: 5.815178155899048
Epoch: 14, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.943 Vali Acc: 0.187 Test Loss: 2.943 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.2709531
	speed: 0.1353s/iter; left time: 320.0212s
Epoch: 15 cost time: 6.59734320640564
Epoch: 15, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.284 Vali Acc: 0.232 Test Loss: 2.284 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.7604932
	speed: 0.1345s/iter; left time: 297.2918s
Epoch: 16 cost time: 5.881067991256714
Epoch: 16, Steps: 154 | Train Loss: 1.268 Vali Loss: 2.159 Vali Acc: 0.396 Test Loss: 2.159 Test Acc: 0.396
Validation loss decreased (-0.385623 --> -0.396167).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.6392118
	speed: 0.1375s/iter; left time: 282.7615s
Epoch: 17 cost time: 6.931686878204346
Epoch: 17, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.400 Vali Acc: 0.388 Test Loss: 2.400 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.4888673
	speed: 0.1361s/iter; left time: 259.0805s
Epoch: 18 cost time: 6.141037464141846
Epoch: 18, Steps: 154 | Train Loss: 1.223 Vali Loss: 3.905 Vali Acc: 0.121 Test Loss: 3.905 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 1.3583964
	speed: 0.1330s/iter; left time: 232.5516s
Epoch: 19 cost time: 6.555732727050781
Epoch: 19, Steps: 154 | Train Loss: 1.215 Vali Loss: 3.756 Vali Acc: 0.226 Test Loss: 3.756 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 1.2776495
	speed: 0.1398s/iter; left time: 223.0448s
Epoch: 20 cost time: 6.646336078643799
Epoch: 20, Steps: 154 | Train Loss: 1.210 Vali Loss: 3.515 Vali Acc: 0.175 Test Loss: 3.515 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 1.2142949
	speed: 0.1286s/iter; left time: 185.3601s
Epoch: 21 cost time: 5.824978351593018
Epoch: 21, Steps: 154 | Train Loss: 1.163 Vali Loss: 2.827 Vali Acc: 0.431 Test Loss: 2.827 Test Acc: 0.431
Validation loss decreased (-0.396167 --> -0.430629).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.1474382
	speed: 0.1376s/iter; left time: 177.0585s
Epoch: 22 cost time: 7.695767402648926
Epoch: 22, Steps: 154 | Train Loss: 1.144 Vali Loss: 3.747 Vali Acc: 0.147 Test Loss: 3.747 Test Acc: 0.147
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.4266502
	speed: 0.1622s/iter; left time: 183.7968s
Epoch: 23 cost time: 6.857421159744263
Epoch: 23, Steps: 154 | Train Loss: 1.127 Vali Loss: 2.562 Vali Acc: 0.378 Test Loss: 2.562 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.4855493
	speed: 0.1649s/iter; left time: 161.4283s
Epoch: 24 cost time: 7.9602789878845215
Epoch: 24, Steps: 154 | Train Loss: 1.098 Vali Loss: 3.539 Vali Acc: 0.196 Test Loss: 3.539 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 1.1179967
	speed: 0.1715s/iter; left time: 141.4912s
Epoch: 25 cost time: 7.265775442123413
Epoch: 25, Steps: 154 | Train Loss: 1.070 Vali Loss: 5.470 Vali Acc: 0.175 Test Loss: 5.470 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.5847158
	speed: 0.1562s/iter; left time: 104.8203s
Epoch: 26 cost time: 7.5936360359191895
Epoch: 26, Steps: 154 | Train Loss: 1.082 Vali Loss: 2.453 Vali Acc: 0.441 Test Loss: 2.453 Test Acc: 0.441
Validation loss decreased (-0.430629 --> -0.441176).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.9837562
	speed: 0.1705s/iter; left time: 88.1542s
Epoch: 27 cost time: 7.589366674423218
Epoch: 27, Steps: 154 | Train Loss: 1.049 Vali Loss: 6.128 Vali Acc: 0.131 Test Loss: 6.128 Test Acc: 0.131
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 1.1385942
	speed: 0.1583s/iter; left time: 57.4608s
Epoch: 28 cost time: 6.8711838722229
Epoch: 28, Steps: 154 | Train Loss: 1.018 Vali Loss: 4.098 Vali Acc: 0.270 Test Loss: 4.098 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 1.0472479
	speed: 0.1626s/iter; left time: 33.9915s
Epoch: 29 cost time: 7.133779048919678
Epoch: 29, Steps: 154 | Train Loss: 1.007 Vali Loss: 7.598 Vali Acc: 0.088 Test Loss: 7.598 Test Acc: 0.088
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 1.0811307
	speed: 0.1604s/iter; left time: 8.8216s
Epoch: 30 cost time: 6.019834756851196
Epoch: 30, Steps: 154 | Train Loss: 1.000 Vali Loss: 3.800 Vali Acc: 0.182 Test Loss: 3.800 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.44120032441200324
model parameter : 1180878
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8489169
	speed: 0.0508s/iter; left time: 229.4865s
Epoch: 1 cost time: 6.884049654006958
Epoch: 1, Steps: 154 | Train Loss: 2.197 Vali Loss: 2.116 Vali Acc: 0.316 Test Loss: 2.116 Test Acc: 0.316
Validation loss decreased (inf --> -0.316281).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5235386
	speed: 0.1181s/iter; left time: 515.7743s
Epoch: 2 cost time: 5.369956731796265
Epoch: 2, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.084 Vali Acc: 0.326 Test Loss: 2.084 Test Acc: 0.326
Validation loss decreased (-0.316281 --> -0.325608).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0240772
	speed: 0.1277s/iter; left time: 537.8269s
Epoch: 3 cost time: 5.701527833938599
Epoch: 3, Steps: 154 | Train Loss: 1.923 Vali Loss: 2.106 Vali Acc: 0.343 Test Loss: 2.106 Test Acc: 0.343
Validation loss decreased (-0.325608 --> -0.343045).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5488893
	speed: 0.1170s/iter; left time: 475.0312s
Epoch: 4 cost time: 4.900349140167236
Epoch: 4, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.176 Vali Acc: 0.337 Test Loss: 2.176 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.4839447
	speed: 0.1258s/iter; left time: 491.3087s
Epoch: 5 cost time: 6.0324928760528564
Epoch: 5, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.213 Vali Acc: 0.350 Test Loss: 2.213 Test Acc: 0.350
Validation loss decreased (-0.343045 --> -0.349937).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5496643
	speed: 0.1252s/iter; left time: 469.7478s
Epoch: 6 cost time: 4.955634593963623
Epoch: 6, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.389 Vali Acc: 0.356 Test Loss: 2.389 Test Acc: 0.356
Validation loss decreased (-0.349937 --> -0.355613).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8125329
	speed: 0.1192s/iter; left time: 428.8050s
Epoch: 7 cost time: 5.8174967765808105
Epoch: 7, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.310 Vali Acc: 0.347 Test Loss: 2.310 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1923540
	speed: 0.1355s/iter; left time: 466.5685s
Epoch: 8 cost time: 6.75921368598938
Epoch: 8, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.114 Vali Acc: 0.190 Test Loss: 3.114 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.3116677
	speed: 0.1393s/iter; left time: 458.3191s
Epoch: 9 cost time: 6.130115509033203
Epoch: 9, Steps: 154 | Train Loss: 1.478 Vali Loss: 3.249 Vali Acc: 0.124 Test Loss: 3.249 Test Acc: 0.124
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1683266
	speed: 0.1551s/iter; left time: 486.3641s
Epoch: 10 cost time: 6.609954118728638
Epoch: 10, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.781 Vali Acc: 0.222 Test Loss: 2.781 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.9547050
	speed: 0.1505s/iter; left time: 448.6548s
Epoch: 11 cost time: 5.86283016204834
Epoch: 11, Steps: 154 | Train Loss: 1.402 Vali Loss: 2.909 Vali Acc: 0.208 Test Loss: 2.909 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4360933
	speed: 0.1442s/iter; left time: 407.6936s
Epoch: 12 cost time: 6.5145041942596436
Epoch: 12, Steps: 154 | Train Loss: 1.360 Vali Loss: 3.908 Vali Acc: 0.189 Test Loss: 3.908 Test Acc: 0.189
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.3739319
	speed: 0.1553s/iter; left time: 415.2310s
Epoch: 13 cost time: 6.320599794387817
Epoch: 13, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.131 Vali Acc: 0.209 Test Loss: 3.131 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4474821
	speed: 0.1400s/iter; left time: 352.6459s
Epoch: 14 cost time: 5.946671724319458
Epoch: 14, Steps: 154 | Train Loss: 1.303 Vali Loss: 4.417 Vali Acc: 0.139 Test Loss: 4.417 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2828234
	speed: 0.1541s/iter; left time: 364.3428s
Epoch: 15 cost time: 6.621753692626953
Epoch: 15, Steps: 154 | Train Loss: 1.286 Vali Loss: 4.072 Vali Acc: 0.102 Test Loss: 4.072 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.4918197
	speed: 0.1486s/iter; left time: 328.5872s
Epoch: 16 cost time: 5.2956860065460205
Epoch: 16, Steps: 154 | Train Loss: 1.281 Vali Loss: 3.249 Vali Acc: 0.273 Test Loss: 3.249 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35563665855636656
model parameter : 353166
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6949420
	speed: 0.0751s/iter; left time: 339.5229s
Epoch: 1 cost time: 10.809264421463013
Epoch: 1, Steps: 154 | Train Loss: 2.168 Vali Loss: 2.112 Vali Acc: 0.316 Test Loss: 2.112 Test Acc: 0.316
Validation loss decreased (inf --> -0.316281).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9141164
	speed: 0.1953s/iter; left time: 852.9775s
Epoch: 2 cost time: 10.451907634735107
Epoch: 2, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.040 Vali Acc: 0.340 Test Loss: 2.040 Test Acc: 0.340
Validation loss decreased (-0.316281 --> -0.339801).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0157351
	speed: 0.1931s/iter; left time: 813.5180s
Epoch: 3 cost time: 9.785738229751587
Epoch: 3, Steps: 154 | Train Loss: 1.834 Vali Loss: 1.992 Vali Acc: 0.354 Test Loss: 1.992 Test Acc: 0.354
Validation loss decreased (-0.339801 --> -0.353995).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8233207
	speed: 0.2081s/iter; left time: 844.8320s
Epoch: 4 cost time: 10.263780355453491
Epoch: 4, Steps: 154 | Train Loss: 1.754 Vali Loss: 1.984 Vali Acc: 0.373 Test Loss: 1.984 Test Acc: 0.373
Validation loss decreased (-0.353995 --> -0.373054).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6219838
	speed: 0.1855s/iter; left time: 724.3143s
Epoch: 5 cost time: 9.261399984359741
Epoch: 5, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.007 Vali Acc: 0.377 Test Loss: 2.007 Test Acc: 0.377
Validation loss decreased (-0.373054 --> -0.377109).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0028064
	speed: 0.2191s/iter; left time: 821.9687s
Epoch: 6 cost time: 13.578198194503784
Epoch: 6, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.677 Vali Acc: 0.100 Test Loss: 2.677 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5572170
	speed: 0.2674s/iter; left time: 961.7130s
Epoch: 7 cost time: 12.938102006912231
Epoch: 7, Steps: 154 | Train Loss: 1.556 Vali Loss: 2.579 Vali Acc: 0.114 Test Loss: 2.579 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9272070
	speed: 0.2353s/iter; left time: 810.0648s
Epoch: 8 cost time: 13.102010726928711
Epoch: 8, Steps: 154 | Train Loss: 1.504 Vali Loss: 2.309 Vali Acc: 0.140 Test Loss: 2.309 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1183650
	speed: 0.2625s/iter; left time: 863.3710s
Epoch: 9 cost time: 13.35910940170288
Epoch: 9, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.390 Vali Acc: 0.356 Test Loss: 2.390 Test Acc: 0.356
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2995539
	speed: 0.2372s/iter; left time: 743.7620s
Epoch: 10 cost time: 11.746347665786743
Epoch: 10, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.084 Vali Acc: 0.380 Test Loss: 2.084 Test Acc: 0.380
Validation loss decreased (-0.377109 --> -0.379947).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4577014
	speed: 0.2622s/iter; left time: 781.7132s
Epoch: 11 cost time: 13.316629648208618
Epoch: 11, Steps: 154 | Train Loss: 1.396 Vali Loss: 4.576 Vali Acc: 0.125 Test Loss: 4.576 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3725805
	speed: 0.2391s/iter; left time: 676.0268s
Epoch: 12 cost time: 9.841814041137695
Epoch: 12, Steps: 154 | Train Loss: 1.350 Vali Loss: 6.000 Vali Acc: 0.128 Test Loss: 6.000 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.3611190
	speed: 0.2153s/iter; left time: 575.4132s
Epoch: 13 cost time: 11.562622308731079
Epoch: 13, Steps: 154 | Train Loss: 1.346 Vali Loss: 7.826 Vali Acc: 0.129 Test Loss: 7.826 Test Acc: 0.129
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4586542
	speed: 0.2232s/iter; left time: 562.2253s
Epoch: 14 cost time: 10.24737024307251
Epoch: 14, Steps: 154 | Train Loss: 1.320 Vali Loss: 6.593 Vali Acc: 0.129 Test Loss: 6.593 Test Acc: 0.129
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5861098
	speed: 0.2102s/iter; left time: 497.1447s
Epoch: 15 cost time: 11.362859010696411
Epoch: 15, Steps: 154 | Train Loss: 1.249 Vali Loss: 6.295 Vali Acc: 0.137 Test Loss: 6.295 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4537605
	speed: 0.2283s/iter; left time: 504.8218s
Epoch: 16 cost time: 10.772538900375366
Epoch: 16, Steps: 154 | Train Loss: 1.254 Vali Loss: 8.576 Vali Acc: 0.127 Test Loss: 8.576 Test Acc: 0.127
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.1971940
	speed: 0.2063s/iter; left time: 424.3668s
Epoch: 17 cost time: 11.168363094329834
Epoch: 17, Steps: 154 | Train Loss: 1.219 Vali Loss: 6.076 Vali Acc: 0.135 Test Loss: 6.076 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.9620382
	speed: 0.2326s/iter; left time: 442.7233s
Epoch: 18 cost time: 11.366282224655151
Epoch: 18, Steps: 154 | Train Loss: 1.183 Vali Loss: 8.090 Vali Acc: 0.127 Test Loss: 8.090 Test Acc: 0.127
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.0259607
	speed: 0.2165s/iter; left time: 378.6151s
Epoch: 19 cost time: 11.512688636779785
Epoch: 19, Steps: 154 | Train Loss: 1.157 Vali Loss: 9.612 Vali Acc: 0.132 Test Loss: 9.612 Test Acc: 0.132
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2199026
	speed: 0.2609s/iter; left time: 416.1187s
Epoch: 20 cost time: 13.304939270019531
Epoch: 20, Steps: 154 | Train Loss: 1.144 Vali Loss: 9.674 Vali Acc: 0.123 Test Loss: 9.674 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 594766
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1926389
	speed: 0.0800s/iter; left time: 361.8254s
Epoch: 1 cost time: 11.719315528869629
Epoch: 1, Steps: 154 | Train Loss: 2.206 Vali Loss: 2.142 Vali Acc: 0.316 Test Loss: 2.142 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7523724
	speed: 0.2186s/iter; left time: 954.8156s
Epoch: 2 cost time: 10.893871307373047
Epoch: 2, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.092 Vali Acc: 0.329 Test Loss: 2.092 Test Acc: 0.329
Validation loss decreased (-0.315875 --> -0.328852).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3906347
	speed: 0.1991s/iter; left time: 838.7414s
Epoch: 3 cost time: 9.097485780715942
Epoch: 3, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.059 Vali Acc: 0.337 Test Loss: 2.059 Test Acc: 0.337
Validation loss decreased (-0.328852 --> -0.336557).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6281683
	speed: 0.2161s/iter; left time: 877.2279s
Epoch: 4 cost time: 10.923938035964966
Epoch: 4, Steps: 154 | Train Loss: 1.807 Vali Loss: 2.117 Vali Acc: 0.339 Test Loss: 2.117 Test Acc: 0.339
Validation loss decreased (-0.336557 --> -0.339395).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8420994
	speed: 0.1881s/iter; left time: 734.4340s
Epoch: 5 cost time: 7.958728790283203
Epoch: 5, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.165 Vali Acc: 0.242 Test Loss: 2.165 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4836845
	speed: 0.1730s/iter; left time: 649.1064s
Epoch: 6 cost time: 9.240404605865479
Epoch: 6, Steps: 154 | Train Loss: 1.670 Vali Loss: 2.151 Vali Acc: 0.367 Test Loss: 2.151 Test Acc: 0.367
Validation loss decreased (-0.339395 --> -0.367375).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1062107
	speed: 0.1919s/iter; left time: 690.3279s
Epoch: 7 cost time: 9.48633885383606
Epoch: 7, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.308 Vali Acc: 0.207 Test Loss: 2.308 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6220652
	speed: 0.1748s/iter; left time: 601.7959s
Epoch: 8 cost time: 7.534555673599243
Epoch: 8, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.982 Vali Acc: 0.113 Test Loss: 2.982 Test Acc: 0.113
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.0202966
	speed: 0.1843s/iter; left time: 606.0277s
Epoch: 9 cost time: 9.393117427825928
Epoch: 9, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.963 Vali Acc: 0.127 Test Loss: 3.963 Test Acc: 0.127
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.8492885
	speed: 0.1803s/iter; left time: 565.2596s
Epoch: 10 cost time: 7.926857233047485
Epoch: 10, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.277 Vali Acc: 0.159 Test Loss: 2.277 Test Acc: 0.159
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3436561
	speed: 0.1748s/iter; left time: 521.1791s
Epoch: 11 cost time: 9.332169532775879
Epoch: 11, Steps: 154 | Train Loss: 1.384 Vali Loss: 2.246 Vali Acc: 0.211 Test Loss: 2.246 Test Acc: 0.211
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1463429
	speed: 0.1958s/iter; left time: 553.6009s
Epoch: 12 cost time: 9.799089193344116
Epoch: 12, Steps: 154 | Train Loss: 1.353 Vali Loss: 3.262 Vali Acc: 0.123 Test Loss: 3.262 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0824413
	speed: 0.1928s/iter; left time: 515.4416s
Epoch: 13 cost time: 9.007605075836182
Epoch: 13, Steps: 154 | Train Loss: 1.329 Vali Loss: 3.784 Vali Acc: 0.136 Test Loss: 3.784 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4614049
	speed: 0.2069s/iter; left time: 521.1360s
Epoch: 14 cost time: 9.938918590545654
Epoch: 14, Steps: 154 | Train Loss: 1.301 Vali Loss: 3.407 Vali Acc: 0.103 Test Loss: 3.407 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1926548
	speed: 0.2063s/iter; left time: 487.8843s
Epoch: 15 cost time: 9.581854104995728
Epoch: 15, Steps: 154 | Train Loss: 1.252 Vali Loss: 5.668 Vali Acc: 0.129 Test Loss: 5.668 Test Acc: 0.129
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.4621108
	speed: 0.1902s/iter; left time: 420.6068s
Epoch: 16 cost time: 8.72387146949768
Epoch: 16, Steps: 154 | Train Loss: 1.235 Vali Loss: 5.690 Vali Acc: 0.092 Test Loss: 5.690 Test Acc: 0.092
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36739659367396593
model parameter : 180878
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7109548
	speed: 0.0758s/iter; left time: 342.5519s
Epoch: 1 cost time: 10.843211650848389
Epoch: 1, Steps: 154 | Train Loss: 2.176 Vali Loss: 2.120 Vali Acc: 0.316 Test Loss: 2.120 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9485406
	speed: 0.1851s/iter; left time: 808.3692s
Epoch: 2 cost time: 8.56072211265564
Epoch: 2, Steps: 154 | Train Loss: 1.993 Vali Loss: 2.056 Vali Acc: 0.336 Test Loss: 2.056 Test Acc: 0.336
Validation loss decreased (-0.315875 --> -0.336151).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0155525
	speed: 0.1467s/iter; left time: 618.1730s
Epoch: 3 cost time: 7.577719449996948
Epoch: 3, Steps: 154 | Train Loss: 1.851 Vali Loss: 1.953 Vali Acc: 0.351 Test Loss: 1.953 Test Acc: 0.351
Validation loss decreased (-0.336151 --> -0.351156).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8200607
	speed: 0.1599s/iter; left time: 648.9724s
Epoch: 4 cost time: 8.086827278137207
Epoch: 4, Steps: 154 | Train Loss: 1.773 Vali Loss: 1.999 Vali Acc: 0.359 Test Loss: 1.999 Test Acc: 0.359
Validation loss decreased (-0.351156 --> -0.359266).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7582742
	speed: 0.1607s/iter; left time: 627.7144s
Epoch: 5 cost time: 8.639038324356079
Epoch: 5, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.006 Vali Acc: 0.341 Test Loss: 2.006 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9603359
	speed: 0.1546s/iter; left time: 579.7850s
Epoch: 6 cost time: 8.251729011535645
Epoch: 6, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.114 Vali Acc: 0.244 Test Loss: 2.114 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.8673506
	speed: 0.1598s/iter; left time: 574.6775s
Epoch: 7 cost time: 7.838792324066162
Epoch: 7, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.214 Vali Acc: 0.094 Test Loss: 2.214 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.8436210
	speed: 0.1661s/iter; left time: 571.8436s
Epoch: 8 cost time: 9.047674179077148
Epoch: 8, Steps: 154 | Train Loss: 1.511 Vali Loss: 2.111 Vali Acc: 0.350 Test Loss: 2.111 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.0595787
	speed: 0.1679s/iter; left time: 552.2436s
Epoch: 9 cost time: 10.204789638519287
Epoch: 9, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.310 Vali Acc: 0.208 Test Loss: 2.310 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.3287797
	speed: 0.1776s/iter; left time: 556.9111s
Epoch: 10 cost time: 7.767206192016602
Epoch: 10, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.213 Vali Acc: 0.377 Test Loss: 2.213 Test Acc: 0.377
Validation loss decreased (-0.359266 --> -0.376701).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5077566
	speed: 0.1851s/iter; left time: 551.7449s
Epoch: 11 cost time: 9.736469507217407
Epoch: 11, Steps: 154 | Train Loss: 1.395 Vali Loss: 2.124 Vali Acc: 0.382 Test Loss: 2.124 Test Acc: 0.382
Validation loss decreased (-0.376701 --> -0.381974).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4747742
	speed: 0.1754s/iter; left time: 495.9166s
Epoch: 12 cost time: 8.744924783706665
Epoch: 12, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.446 Vali Acc: 0.135 Test Loss: 3.446 Test Acc: 0.135
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4453118
	speed: 0.1826s/iter; left time: 488.1020s
Epoch: 13 cost time: 8.882520914077759
Epoch: 13, Steps: 154 | Train Loss: 1.348 Vali Loss: 5.448 Vali Acc: 0.129 Test Loss: 5.448 Test Acc: 0.129
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.4075996
	speed: 0.1847s/iter; left time: 465.3750s
Epoch: 14 cost time: 9.513442754745483
Epoch: 14, Steps: 154 | Train Loss: 1.341 Vali Loss: 4.285 Vali Acc: 0.131 Test Loss: 4.285 Test Acc: 0.131
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4932947
	speed: 0.1797s/iter; left time: 424.8958s
Epoch: 15 cost time: 8.89713430404663
Epoch: 15, Steps: 154 | Train Loss: 1.289 Vali Loss: 2.630 Vali Acc: 0.122 Test Loss: 2.630 Test Acc: 0.122
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.4287357
	speed: 0.1697s/iter; left time: 375.1731s
Epoch: 16 cost time: 7.8397862911224365
Epoch: 16, Steps: 154 | Train Loss: 1.256 Vali Loss: 6.099 Vali Acc: 0.137 Test Loss: 6.099 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1690531
	speed: 0.1560s/iter; left time: 320.8613s
Epoch: 17 cost time: 8.138522624969482
Epoch: 17, Steps: 154 | Train Loss: 1.225 Vali Loss: 4.231 Vali Acc: 0.144 Test Loss: 4.231 Test Acc: 0.144
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.7672457
	speed: 0.1573s/iter; left time: 299.2742s
Epoch: 18 cost time: 8.348541498184204
Epoch: 18, Steps: 154 | Train Loss: 1.204 Vali Loss: 6.109 Vali Acc: 0.135 Test Loss: 6.109 Test Acc: 0.135
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.0904447
	speed: 0.1575s/iter; left time: 275.5296s
Epoch: 19 cost time: 7.440176486968994
Epoch: 19, Steps: 154 | Train Loss: 1.184 Vali Loss: 6.256 Vali Acc: 0.136 Test Loss: 6.256 Test Acc: 0.136
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.4542913
	speed: 0.1572s/iter; left time: 250.7706s
Epoch: 20 cost time: 8.339402675628662
Epoch: 20, Steps: 154 | Train Loss: 1.162 Vali Loss: 8.624 Vali Acc: 0.133 Test Loss: 8.624 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.8154301
	speed: 0.1576s/iter; left time: 227.0423s
Epoch: 21 cost time: 8.16775131225586
Epoch: 21, Steps: 154 | Train Loss: 1.118 Vali Loss: 6.664 Vali Acc: 0.143 Test Loss: 6.664 Test Acc: 0.143
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3819951338199513
model parameter : 594766
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1899140
	speed: 0.0593s/iter; left time: 267.9953s
Epoch: 1 cost time: 8.485100507736206
Epoch: 1, Steps: 154 | Train Loss: 2.211 Vali Loss: 2.141 Vali Acc: 0.315 Test Loss: 2.141 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7768035
	speed: 0.1502s/iter; left time: 655.7352s
Epoch: 2 cost time: 6.885664939880371
Epoch: 2, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.077 Vali Acc: 0.326 Test Loss: 2.077 Test Acc: 0.326
Validation loss decreased (-0.315469 --> -0.325608).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4095895
	speed: 0.1599s/iter; left time: 673.5304s
Epoch: 3 cost time: 7.455866575241089
Epoch: 3, Steps: 154 | Train Loss: 1.896 Vali Loss: 2.063 Vali Acc: 0.335 Test Loss: 2.063 Test Acc: 0.335
Validation loss decreased (-0.325608 --> -0.334529).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6601175
	speed: 0.1574s/iter; left time: 639.0052s
Epoch: 4 cost time: 7.927600145339966
Epoch: 4, Steps: 154 | Train Loss: 1.812 Vali Loss: 2.097 Vali Acc: 0.347 Test Loss: 2.097 Test Acc: 0.347
Validation loss decreased (-0.334529 --> -0.346694).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8680681
	speed: 0.1585s/iter; left time: 618.8064s
Epoch: 5 cost time: 7.2198646068573
Epoch: 5, Steps: 154 | Train Loss: 1.752 Vali Loss: 2.084 Vali Acc: 0.352 Test Loss: 2.084 Test Acc: 0.352
Validation loss decreased (-0.346694 --> -0.351966).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4124780
	speed: 0.1593s/iter; left time: 597.5130s
Epoch: 6 cost time: 7.526200532913208
Epoch: 6, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.172 Vali Acc: 0.362 Test Loss: 2.172 Test Acc: 0.362
Validation loss decreased (-0.351966 --> -0.361698).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2106117
	speed: 0.1555s/iter; left time: 559.5014s
Epoch: 7 cost time: 7.334450960159302
Epoch: 7, Steps: 154 | Train Loss: 1.590 Vali Loss: 2.073 Vali Acc: 0.357 Test Loss: 2.073 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4592313
	speed: 0.1562s/iter; left time: 537.8439s
Epoch: 8 cost time: 6.293520450592041
Epoch: 8, Steps: 154 | Train Loss: 1.535 Vali Loss: 2.118 Vali Acc: 0.378 Test Loss: 2.118 Test Acc: 0.378
Validation loss decreased (-0.361698 --> -0.378324).  Saving model ...
	iters: 100, epoch: 9 | loss: 2.0470860
	speed: 0.1281s/iter; left time: 421.3837s
Epoch: 9 cost time: 5.957513809204102
Epoch: 9, Steps: 154 | Train Loss: 1.477 Vali Loss: 2.314 Vali Acc: 0.264 Test Loss: 2.314 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6562855
	speed: 0.1410s/iter; left time: 441.9953s
Epoch: 10 cost time: 8.813072681427002
Epoch: 10, Steps: 154 | Train Loss: 1.436 Vali Loss: 2.137 Vali Acc: 0.384 Test Loss: 2.137 Test Acc: 0.384
Validation loss decreased (-0.378324 --> -0.384407).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4652607
	speed: 0.1952s/iter; left time: 581.8655s
Epoch: 11 cost time: 8.818376064300537
Epoch: 11, Steps: 154 | Train Loss: 1.403 Vali Loss: 2.281 Vali Acc: 0.218 Test Loss: 2.281 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0789862
	speed: 0.1941s/iter; left time: 548.6881s
Epoch: 12 cost time: 8.919217109680176
Epoch: 12, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.989 Vali Acc: 0.118 Test Loss: 2.989 Test Acc: 0.118
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0747957
	speed: 0.1962s/iter; left time: 524.4275s
Epoch: 13 cost time: 8.788929462432861
Epoch: 13, Steps: 154 | Train Loss: 1.324 Vali Loss: 3.070 Vali Acc: 0.125 Test Loss: 3.070 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.4618859
	speed: 0.1854s/iter; left time: 467.0949s
Epoch: 14 cost time: 8.176382064819336
Epoch: 14, Steps: 154 | Train Loss: 1.310 Vali Loss: 3.446 Vali Acc: 0.099 Test Loss: 3.446 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.1250585
	speed: 0.1776s/iter; left time: 419.9698s
Epoch: 15 cost time: 8.015241861343384
Epoch: 15, Steps: 154 | Train Loss: 1.246 Vali Loss: 2.852 Vali Acc: 0.212 Test Loss: 2.852 Test Acc: 0.212
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4166555
	speed: 0.1931s/iter; left time: 426.8448s
Epoch: 16 cost time: 8.885789155960083
Epoch: 16, Steps: 154 | Train Loss: 1.232 Vali Loss: 4.125 Vali Acc: 0.096 Test Loss: 4.125 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 2.2760246
	speed: 0.2052s/iter; left time: 422.0666s
Epoch: 17 cost time: 9.51365041732788
Epoch: 17, Steps: 154 | Train Loss: 1.210 Vali Loss: 5.831 Vali Acc: 0.099 Test Loss: 5.831 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.9868469
	speed: 0.2221s/iter; left time: 422.7246s
Epoch: 18 cost time: 9.904657363891602
Epoch: 18, Steps: 154 | Train Loss: 1.169 Vali Loss: 3.794 Vali Acc: 0.103 Test Loss: 3.794 Test Acc: 0.103
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1766902
	speed: 0.2201s/iter; left time: 384.9292s
Epoch: 19 cost time: 9.696943998336792
Epoch: 19, Steps: 154 | Train Loss: 1.140 Vali Loss: 4.418 Vali Acc: 0.105 Test Loss: 4.418 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.9023854
	speed: 0.2102s/iter; left time: 335.2766s
Epoch: 20 cost time: 9.097620725631714
Epoch: 20, Steps: 154 | Train Loss: 1.119 Vali Loss: 8.004 Vali Acc: 0.097 Test Loss: 8.004 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3844282238442822
model parameter : 180878
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6940416
	speed: 0.0877s/iter; left time: 396.5664s
Epoch: 1 cost time: 12.543334484100342
Epoch: 1, Steps: 154 | Train Loss: 2.179 Vali Loss: 2.111 Vali Acc: 0.315 Test Loss: 2.111 Test Acc: 0.315
Validation loss decreased (inf --> -0.315470).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9708103
	speed: 0.2276s/iter; left time: 993.7842s
Epoch: 2 cost time: 10.55623984336853
Epoch: 2, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.049 Vali Acc: 0.334 Test Loss: 2.049 Test Acc: 0.334
Validation loss decreased (-0.315470 --> -0.333718).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1501167
	speed: 0.2321s/iter; left time: 978.0163s
Epoch: 3 cost time: 11.258031606674194
Epoch: 3, Steps: 154 | Train Loss: 1.889 Vali Loss: 2.024 Vali Acc: 0.351 Test Loss: 2.024 Test Acc: 0.351
Validation loss decreased (-0.333718 --> -0.350750).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8111416
	speed: 0.2270s/iter; left time: 921.4960s
Epoch: 4 cost time: 9.330865144729614
Epoch: 4, Steps: 154 | Train Loss: 1.799 Vali Loss: 1.951 Vali Acc: 0.358 Test Loss: 1.951 Test Acc: 0.358
Validation loss decreased (-0.350750 --> -0.358050).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7654121
	speed: 0.1759s/iter; left time: 686.8411s
Epoch: 5 cost time: 8.285980701446533
Epoch: 5, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.179 Vali Acc: 0.341 Test Loss: 2.179 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1306124
	speed: 0.1880s/iter; left time: 705.1105s
Epoch: 6 cost time: 9.276673793792725
Epoch: 6, Steps: 154 | Train Loss: 1.656 Vali Loss: 2.047 Vali Acc: 0.348 Test Loss: 2.047 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.9656202
	speed: 0.1972s/iter; left time: 709.3384s
Epoch: 7 cost time: 9.031337261199951
Epoch: 7, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.339 Vali Acc: 0.191 Test Loss: 2.339 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.7720796
	speed: 0.1985s/iter; left time: 683.3793s
Epoch: 8 cost time: 9.395918607711792
Epoch: 8, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.291 Vali Acc: 0.363 Test Loss: 2.291 Test Acc: 0.363
Validation loss decreased (-0.358050 --> -0.362508).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3345783
	speed: 0.1965s/iter; left time: 646.3545s
Epoch: 9 cost time: 8.842418193817139
Epoch: 9, Steps: 154 | Train Loss: 1.542 Vali Loss: 2.484 Vali Acc: 0.343 Test Loss: 2.484 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1494349
	speed: 0.1784s/iter; left time: 559.2085s
Epoch: 10 cost time: 8.002496004104614
Epoch: 10, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.179 Vali Acc: 0.377 Test Loss: 2.179 Test Acc: 0.377
Validation loss decreased (-0.362508 --> -0.377107).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.6773880
	speed: 0.1787s/iter; left time: 532.7652s
Epoch: 11 cost time: 8.85010051727295
Epoch: 11, Steps: 154 | Train Loss: 1.454 Vali Loss: 2.458 Vali Acc: 0.369 Test Loss: 2.458 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6124811
	speed: 0.1939s/iter; left time: 548.2415s
Epoch: 12 cost time: 8.527395486831665
Epoch: 12, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.107 Vali Acc: 0.307 Test Loss: 3.107 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.5441902
	speed: 0.1915s/iter; left time: 511.9167s
Epoch: 13 cost time: 8.50069785118103
Epoch: 13, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.975 Vali Acc: 0.355 Test Loss: 2.975 Test Acc: 0.355
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3456500
	speed: 0.2064s/iter; left time: 519.8665s
Epoch: 14 cost time: 9.73483920097351
Epoch: 14, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.304 Vali Acc: 0.369 Test Loss: 2.304 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5538102
	speed: 0.2096s/iter; left time: 495.6596s
Epoch: 15 cost time: 8.88233757019043
Epoch: 15, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.317 Vali Acc: 0.380 Test Loss: 2.317 Test Acc: 0.380
Validation loss decreased (-0.377107 --> -0.380350).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.4988245
	speed: 0.2022s/iter; left time: 447.1011s
Epoch: 16 cost time: 9.069872856140137
Epoch: 16, Steps: 154 | Train Loss: 1.329 Vali Loss: 2.760 Vali Acc: 0.378 Test Loss: 2.760 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3172141
	speed: 0.2116s/iter; left time: 435.2426s
Epoch: 17 cost time: 9.743905782699585
Epoch: 17, Steps: 154 | Train Loss: 1.282 Vali Loss: 2.524 Vali Acc: 0.389 Test Loss: 2.524 Test Acc: 0.389
Validation loss decreased (-0.380350 --> -0.388864).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.9931489
	speed: 0.2196s/iter; left time: 417.8272s
Epoch: 18 cost time: 9.81493353843689
Epoch: 18, Steps: 154 | Train Loss: 1.262 Vali Loss: 2.838 Vali Acc: 0.386 Test Loss: 2.838 Test Acc: 0.386
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 1.2778598
	speed: 0.2177s/iter; left time: 380.8316s
Epoch: 19 cost time: 9.760379552841187
Epoch: 19, Steps: 154 | Train Loss: 1.258 Vali Loss: 3.032 Vali Acc: 0.386 Test Loss: 3.032 Test Acc: 0.386
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 1.4353530
	speed: 0.2219s/iter; left time: 353.9617s
Epoch: 20 cost time: 9.843998670578003
Epoch: 20, Steps: 154 | Train Loss: 1.225 Vali Loss: 2.811 Vali Acc: 0.378 Test Loss: 2.811 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.8531985
	speed: 0.2058s/iter; left time: 296.5888s
Epoch: 21 cost time: 9.005527019500732
Epoch: 21, Steps: 154 | Train Loss: 1.196 Vali Loss: 2.749 Vali Acc: 0.392 Test Loss: 2.749 Test Acc: 0.392
Validation loss decreased (-0.388864 --> -0.392106).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.8774891
	speed: 0.2016s/iter; left time: 259.5065s
Epoch: 22 cost time: 8.032630920410156
Epoch: 22, Steps: 154 | Train Loss: 1.180 Vali Loss: 3.011 Vali Acc: 0.381 Test Loss: 3.011 Test Acc: 0.381
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 1.0858814
	speed: 0.1866s/iter; left time: 211.4631s
Epoch: 23 cost time: 8.834672451019287
Epoch: 23, Steps: 154 | Train Loss: 1.152 Vali Loss: 4.250 Vali Acc: 0.128 Test Loss: 4.250 Test Acc: 0.128
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 1.0512584
	speed: 0.1890s/iter; left time: 185.0560s
Epoch: 24 cost time: 8.389065742492676
Epoch: 24, Steps: 154 | Train Loss: 1.125 Vali Loss: 3.931 Vali Acc: 0.312 Test Loss: 3.931 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.9912822
	speed: 0.1954s/iter; left time: 161.1990s
Epoch: 25 cost time: 8.729420900344849
Epoch: 25, Steps: 154 | Train Loss: 1.111 Vali Loss: 4.639 Vali Acc: 0.108 Test Loss: 4.639 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 1.3158263
	speed: 0.1918s/iter; left time: 128.6789s
Epoch: 26 cost time: 8.169234275817871
Epoch: 26, Steps: 154 | Train Loss: 1.103 Vali Loss: 3.477 Vali Acc: 0.351 Test Loss: 3.477 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.9060948
	speed: 0.1712s/iter; left time: 88.4908s
Epoch: 27 cost time: 7.572710037231445
Epoch: 27, Steps: 154 | Train Loss: 1.067 Vali Loss: 2.985 Vali Acc: 0.282 Test Loss: 2.985 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 1.9051590
	speed: 0.1773s/iter; left time: 64.3600s
Epoch: 28 cost time: 8.416249990463257
Epoch: 28, Steps: 154 | Train Loss: 1.042 Vali Loss: 4.881 Vali Acc: 0.121 Test Loss: 4.881 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.8342883
	speed: 0.1913s/iter; left time: 39.9761s
Epoch: 29 cost time: 8.566434621810913
Epoch: 29, Steps: 154 | Train Loss: 1.039 Vali Loss: 5.619 Vali Acc: 0.083 Test Loss: 5.619 Test Acc: 0.083
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.9915055
	speed: 0.1884s/iter; left time: 10.3620s
Epoch: 30 cost time: 8.083976984024048
Epoch: 30, Steps: 154 | Train Loss: 1.057 Vali Loss: 6.135 Vali Acc: 0.090 Test Loss: 6.135 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3921330089213301
model parameter : 594766
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1749384
	speed: 0.0561s/iter; left time: 253.5627s
Epoch: 1 cost time: 8.260675430297852
Epoch: 1, Steps: 154 | Train Loss: 2.212 Vali Loss: 2.145 Vali Acc: 0.315 Test Loss: 2.145 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8175336
	speed: 0.1866s/iter; left time: 814.7043s
Epoch: 2 cost time: 8.041055679321289
Epoch: 2, Steps: 154 | Train Loss: 2.029 Vali Loss: 2.073 Vali Acc: 0.324 Test Loss: 2.073 Test Acc: 0.324
Validation loss decreased (-0.315469 --> -0.323986).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4258109
	speed: 0.1963s/iter; left time: 827.1381s
Epoch: 3 cost time: 9.105524063110352
Epoch: 3, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.092 Vali Acc: 0.337 Test Loss: 2.092 Test Acc: 0.337
Validation loss decreased (-0.323986 --> -0.336962).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7924998
	speed: 0.2074s/iter; left time: 841.6341s
Epoch: 4 cost time: 9.055571556091309
Epoch: 4, Steps: 154 | Train Loss: 1.858 Vali Loss: 2.150 Vali Acc: 0.344 Test Loss: 2.150 Test Acc: 0.344
Validation loss decreased (-0.336962 --> -0.343855).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8921927
	speed: 0.2095s/iter; left time: 818.1641s
Epoch: 5 cost time: 9.011226415634155
Epoch: 5, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.144 Vali Acc: 0.303 Test Loss: 2.144 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4752432
	speed: 0.2035s/iter; left time: 763.3431s
Epoch: 6 cost time: 8.544482469558716
Epoch: 6, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.148 Vali Acc: 0.363 Test Loss: 2.148 Test Acc: 0.363
Validation loss decreased (-0.343855 --> -0.362509).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2064837
	speed: 0.1963s/iter; left time: 706.0640s
Epoch: 7 cost time: 8.091609716415405
Epoch: 7, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.260 Vali Acc: 0.354 Test Loss: 2.260 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6418707
	speed: 0.1868s/iter; left time: 643.2773s
Epoch: 8 cost time: 8.03257155418396
Epoch: 8, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.661 Vali Acc: 0.099 Test Loss: 2.661 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.0400832
	speed: 0.1895s/iter; left time: 623.1545s
Epoch: 9 cost time: 8.767327308654785
Epoch: 9, Steps: 154 | Train Loss: 1.541 Vali Loss: 2.167 Vali Acc: 0.401 Test Loss: 2.167 Test Acc: 0.401
Validation loss decreased (-0.362509 --> -0.401033).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7185464
	speed: 0.2032s/iter; left time: 637.0225s
Epoch: 10 cost time: 7.876254081726074
Epoch: 10, Steps: 154 | Train Loss: 1.473 Vali Loss: 3.146 Vali Acc: 0.086 Test Loss: 3.146 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2917885
	speed: 0.1767s/iter; left time: 526.6156s
Epoch: 11 cost time: 7.710452556610107
Epoch: 11, Steps: 154 | Train Loss: 1.452 Vali Loss: 2.835 Vali Acc: 0.215 Test Loss: 2.835 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1054300
	speed: 0.1777s/iter; left time: 502.3150s
Epoch: 12 cost time: 7.478093862533569
Epoch: 12, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.720 Vali Acc: 0.217 Test Loss: 2.720 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.0568773
	speed: 0.1680s/iter; left time: 448.9813s
Epoch: 13 cost time: 6.894365310668945
Epoch: 13, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.724 Vali Acc: 0.212 Test Loss: 2.724 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3175336
	speed: 0.1567s/iter; left time: 394.7198s
Epoch: 14 cost time: 6.756476640701294
Epoch: 14, Steps: 154 | Train Loss: 1.356 Vali Loss: 2.627 Vali Acc: 0.210 Test Loss: 2.627 Test Acc: 0.210
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.0981975
	speed: 0.1724s/iter; left time: 407.7349s
Epoch: 15 cost time: 7.525628089904785
Epoch: 15, Steps: 154 | Train Loss: 1.323 Vali Loss: 3.370 Vali Acc: 0.204 Test Loss: 3.370 Test Acc: 0.204
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.5003227
	speed: 0.1760s/iter; left time: 389.2183s
Epoch: 16 cost time: 7.378178834915161
Epoch: 16, Steps: 154 | Train Loss: 1.297 Vali Loss: 4.063 Vali Acc: 0.169 Test Loss: 4.063 Test Acc: 0.169
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 2.1561377
	speed: 0.1777s/iter; left time: 365.5820s
Epoch: 17 cost time: 7.668561935424805
Epoch: 17, Steps: 154 | Train Loss: 1.268 Vali Loss: 3.986 Vali Acc: 0.180 Test Loss: 3.986 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.0733242
	speed: 0.1778s/iter; left time: 338.2819s
Epoch: 18 cost time: 7.463588237762451
Epoch: 18, Steps: 154 | Train Loss: 1.249 Vali Loss: 4.084 Vali Acc: 0.187 Test Loss: 4.084 Test Acc: 0.187
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.2871621
	speed: 0.1607s/iter; left time: 280.9937s
Epoch: 19 cost time: 6.498932123184204
Epoch: 19, Steps: 154 | Train Loss: 1.208 Vali Loss: 3.929 Vali Acc: 0.199 Test Loss: 3.929 Test Acc: 0.199
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4010543390105434
model parameter : 180878
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2559578
	speed: 0.1096s/iter; left time: 495.7069s
Epoch: 1 cost time: 16.511165618896484
Epoch: 1, Steps: 154 | Train Loss: 2.242 Vali Loss: 2.111 Vali Acc: 0.316 Test Loss: 2.111 Test Acc: 0.316
Validation loss decreased (inf --> -0.316281).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6038775
	speed: 0.2897s/iter; left time: 1265.1734s
Epoch: 2 cost time: 14.69620156288147
Epoch: 2, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.067 Vali Acc: 0.327 Test Loss: 2.067 Test Acc: 0.327
Validation loss decreased (-0.316281 --> -0.326824).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6103262
	speed: 0.2914s/iter; left time: 1227.5355s
Epoch: 3 cost time: 15.114668369293213
Epoch: 3, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.100 Vali Acc: 0.339 Test Loss: 2.100 Test Acc: 0.339
Validation loss decreased (-0.326824 --> -0.339395).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9741809
	speed: 0.2705s/iter; left time: 1097.8403s
Epoch: 4 cost time: 12.3033926486969
Epoch: 4, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.038 Vali Acc: 0.358 Test Loss: 2.038 Test Acc: 0.358
Validation loss decreased (-0.339395 --> -0.358049).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9934452
	speed: 0.2627s/iter; left time: 1025.9101s
Epoch: 5 cost time: 13.908403873443604
Epoch: 5, Steps: 154 | Train Loss: 1.678 Vali Loss: 2.117 Vali Acc: 0.351 Test Loss: 2.117 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.2823021
	speed: 0.2805s/iter; left time: 1052.2073s
Epoch: 6 cost time: 13.927981853485107
Epoch: 6, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.467 Vali Acc: 0.283 Test Loss: 2.467 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5463893
	speed: 0.2778s/iter; left time: 999.3696s
Epoch: 7 cost time: 14.01119613647461
Epoch: 7, Steps: 154 | Train Loss: 1.559 Vali Loss: 3.748 Vali Acc: 0.075 Test Loss: 3.748 Test Acc: 0.075
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.2365937
	speed: 0.2640s/iter; left time: 908.9782s
Epoch: 8 cost time: 11.764009475708008
Epoch: 8, Steps: 154 | Train Loss: 1.517 Vali Loss: 2.610 Vali Acc: 0.092 Test Loss: 2.610 Test Acc: 0.092
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.1793900
	speed: 0.2299s/iter; left time: 756.2660s
Epoch: 9 cost time: 11.19746208190918
Epoch: 9, Steps: 154 | Train Loss: 1.460 Vali Loss: 2.937 Vali Acc: 0.103 Test Loss: 2.937 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.1799304
	speed: 0.2443s/iter; left time: 765.7353s
Epoch: 10 cost time: 12.870100021362305
Epoch: 10, Steps: 154 | Train Loss: 1.421 Vali Loss: 2.210 Vali Acc: 0.273 Test Loss: 2.210 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.9627587
	speed: 0.2480s/iter; left time: 739.1570s
Epoch: 11 cost time: 12.336523056030273
Epoch: 11, Steps: 154 | Train Loss: 1.382 Vali Loss: 5.485 Vali Acc: 0.082 Test Loss: 5.485 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2269908
	speed: 0.2488s/iter; left time: 703.3499s
Epoch: 12 cost time: 12.569525241851807
Epoch: 12, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.797 Vali Acc: 0.086 Test Loss: 2.797 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.8424587
	speed: 0.2396s/iter; left time: 640.5074s
Epoch: 13 cost time: 11.25679349899292
Epoch: 13, Steps: 154 | Train Loss: 1.313 Vali Loss: 3.667 Vali Acc: 0.123 Test Loss: 3.667 Test Acc: 0.123
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.4141883
	speed: 0.2367s/iter; left time: 596.1772s
Epoch: 14 cost time: 12.163773775100708
Epoch: 14, Steps: 154 | Train Loss: 1.302 Vali Loss: 3.000 Vali Acc: 0.102 Test Loss: 3.000 Test Acc: 0.102
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3580697485806975
model parameter : 301710
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0815959
	speed: 0.0869s/iter; left time: 392.8183s
Epoch: 1 cost time: 12.784238338470459
Epoch: 1, Steps: 154 | Train Loss: 2.222 Vali Loss: 2.129 Vali Acc: 0.315 Test Loss: 2.129 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0891950
	speed: 0.2401s/iter; left time: 1048.4923s
Epoch: 2 cost time: 11.665785312652588
Epoch: 2, Steps: 154 | Train Loss: 2.021 Vali Loss: 2.095 Vali Acc: 0.326 Test Loss: 2.095 Test Acc: 0.326
Validation loss decreased (-0.315064 --> -0.325608).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9293519
	speed: 0.2344s/iter; left time: 987.3579s
Epoch: 3 cost time: 11.386838436126709
Epoch: 3, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.076 Vali Acc: 0.336 Test Loss: 2.076 Test Acc: 0.336
Validation loss decreased (-0.325608 --> -0.336151).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7905363
	speed: 0.2280s/iter; left time: 925.6143s
Epoch: 4 cost time: 11.305392503738403
Epoch: 4, Steps: 154 | Train Loss: 1.872 Vali Loss: 2.159 Vali Acc: 0.340 Test Loss: 2.159 Test Acc: 0.340
Validation loss decreased (-0.336151 --> -0.339800).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5405978
	speed: 0.2378s/iter; left time: 928.6866s
Epoch: 5 cost time: 11.538307666778564
Epoch: 5, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.187 Vali Acc: 0.342 Test Loss: 2.187 Test Acc: 0.342
Validation loss decreased (-0.339800 --> -0.341827).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6402125
	speed: 0.2403s/iter; left time: 901.4049s
Epoch: 6 cost time: 11.688735008239746
Epoch: 6, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.341 Vali Acc: 0.346 Test Loss: 2.341 Test Acc: 0.346
Validation loss decreased (-0.341827 --> -0.345881).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6477964
	speed: 0.2431s/iter; left time: 874.3421s
Epoch: 7 cost time: 11.678786277770996
Epoch: 7, Steps: 154 | Train Loss: 1.622 Vali Loss: 2.382 Vali Acc: 0.358 Test Loss: 2.382 Test Acc: 0.358
Validation loss decreased (-0.345881 --> -0.358451).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5082326
	speed: 0.2335s/iter; left time: 803.8268s
Epoch: 8 cost time: 11.006583213806152
Epoch: 8, Steps: 154 | Train Loss: 1.551 Vali Loss: 2.380 Vali Acc: 0.352 Test Loss: 2.380 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8380812
	speed: 0.2132s/iter; left time: 701.1162s
Epoch: 9 cost time: 9.357906579971313
Epoch: 9, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.268 Vali Acc: 0.376 Test Loss: 2.268 Test Acc: 0.376
Validation loss decreased (-0.358451 --> -0.375484).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7735362
	speed: 0.2124s/iter; left time: 665.9070s
Epoch: 10 cost time: 10.375002384185791
Epoch: 10, Steps: 154 | Train Loss: 1.462 Vali Loss: 2.808 Vali Acc: 0.200 Test Loss: 2.808 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2143689
	speed: 0.2177s/iter; left time: 649.0347s
Epoch: 11 cost time: 10.49307918548584
Epoch: 11, Steps: 154 | Train Loss: 1.420 Vali Loss: 3.351 Vali Acc: 0.192 Test Loss: 3.351 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1371039
	speed: 0.2157s/iter; left time: 609.9186s
Epoch: 12 cost time: 10.115336894989014
Epoch: 12, Steps: 154 | Train Loss: 1.388 Vali Loss: 2.573 Vali Acc: 0.238 Test Loss: 2.573 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3818057
	speed: 0.2063s/iter; left time: 551.4644s
Epoch: 13 cost time: 9.819626331329346
Epoch: 13, Steps: 154 | Train Loss: 1.363 Vali Loss: 3.198 Vali Acc: 0.208 Test Loss: 3.198 Test Acc: 0.208
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.7216190
	speed: 0.1975s/iter; left time: 497.4218s
Epoch: 14 cost time: 9.683119058609009
Epoch: 14, Steps: 154 | Train Loss: 1.340 Vali Loss: 2.620 Vali Acc: 0.216 Test Loss: 2.620 Test Acc: 0.216
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4867612
	speed: 0.2107s/iter; left time: 498.3833s
Epoch: 15 cost time: 10.3917555809021
Epoch: 15, Steps: 154 | Train Loss: 1.283 Vali Loss: 3.101 Vali Acc: 0.191 Test Loss: 3.101 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 2.0546031
	speed: 0.2187s/iter; left time: 483.5370s
Epoch: 16 cost time: 10.784610509872437
Epoch: 16, Steps: 154 | Train Loss: 1.297 Vali Loss: 3.032 Vali Acc: 0.220 Test Loss: 3.032 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.9520286
	speed: 0.2222s/iter; left time: 457.0003s
Epoch: 17 cost time: 10.776439428329468
Epoch: 17, Steps: 154 | Train Loss: 1.249 Vali Loss: 2.887 Vali Acc: 0.205 Test Loss: 2.887 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.8972881
	speed: 0.2313s/iter; left time: 440.2292s
Epoch: 18 cost time: 10.788712978363037
Epoch: 18, Steps: 154 | Train Loss: 1.248 Vali Loss: 2.725 Vali Acc: 0.236 Test Loss: 2.725 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.2488204
	speed: 0.2266s/iter; left time: 396.3862s
Epoch: 19 cost time: 11.075913429260254
Epoch: 19, Steps: 154 | Train Loss: 1.193 Vali Loss: 4.485 Vali Acc: 0.079 Test Loss: 4.485 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 94734
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2571039
	speed: 0.0913s/iter; left time: 412.9331s
Epoch: 1 cost time: 13.698375463485718
Epoch: 1, Steps: 154 | Train Loss: 2.249 Vali Loss: 2.116 Vali Acc: 0.317 Test Loss: 2.116 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6038146
	speed: 0.2509s/iter; left time: 1095.8546s
Epoch: 2 cost time: 12.263993978500366
Epoch: 2, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.073 Vali Acc: 0.326 Test Loss: 2.073 Test Acc: 0.326
Validation loss decreased (-0.316686 --> -0.326013).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6113605
	speed: 0.2484s/iter; left time: 1046.6547s
Epoch: 3 cost time: 11.656391143798828
Epoch: 3, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.090 Vali Acc: 0.335 Test Loss: 2.090 Test Acc: 0.335
Validation loss decreased (-0.326013 --> -0.335340).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8269945
	speed: 0.2316s/iter; left time: 939.9474s
Epoch: 4 cost time: 11.41925835609436
Epoch: 4, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.129 Vali Acc: 0.346 Test Loss: 2.129 Test Acc: 0.346
Validation loss decreased (-0.335340 --> -0.346289).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9662755
	speed: 0.2495s/iter; left time: 974.2435s
Epoch: 5 cost time: 12.837779760360718
Epoch: 5, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.202 Vali Acc: 0.351 Test Loss: 2.202 Test Acc: 0.351
Validation loss decreased (-0.346289 --> -0.350748).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2450930
	speed: 0.2345s/iter; left time: 879.6760s
Epoch: 6 cost time: 11.175092458724976
Epoch: 6, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.222 Vali Acc: 0.354 Test Loss: 2.222 Test Acc: 0.354
Validation loss decreased (-0.350748 --> -0.353587).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5223235
	speed: 0.2244s/iter; left time: 807.2896s
Epoch: 7 cost time: 11.039578437805176
Epoch: 7, Steps: 154 | Train Loss: 1.549 Vali Loss: 2.500 Vali Acc: 0.071 Test Loss: 2.500 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2391402
	speed: 0.2139s/iter; left time: 736.3462s
Epoch: 8 cost time: 10.038503646850586
Epoch: 8, Steps: 154 | Train Loss: 1.502 Vali Loss: 2.077 Vali Acc: 0.381 Test Loss: 2.077 Test Acc: 0.381
Validation loss decreased (-0.353587 --> -0.380758).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.1134601
	speed: 0.2028s/iter; left time: 666.8469s
Epoch: 9 cost time: 10.132912397384644
Epoch: 9, Steps: 154 | Train Loss: 1.456 Vali Loss: 2.366 Vali Acc: 0.089 Test Loss: 2.366 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1494598
	speed: 0.2139s/iter; left time: 670.5579s
Epoch: 10 cost time: 10.677571773529053
Epoch: 10, Steps: 154 | Train Loss: 1.418 Vali Loss: 2.266 Vali Acc: 0.387 Test Loss: 2.266 Test Acc: 0.387
Validation loss decreased (-0.380758 --> -0.387244).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.8657422
	speed: 0.2205s/iter; left time: 657.2997s
Epoch: 11 cost time: 11.109344005584717
Epoch: 11, Steps: 154 | Train Loss: 1.381 Vali Loss: 2.647 Vali Acc: 0.180 Test Loss: 2.647 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1479682
	speed: 0.2220s/iter; left time: 627.6883s
Epoch: 12 cost time: 10.653960943222046
Epoch: 12, Steps: 154 | Train Loss: 1.349 Vali Loss: 2.542 Vali Acc: 0.209 Test Loss: 2.542 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6701026
	speed: 0.2168s/iter; left time: 579.5167s
Epoch: 13 cost time: 9.811261653900146
Epoch: 13, Steps: 154 | Train Loss: 1.302 Vali Loss: 2.320 Vali Acc: 0.395 Test Loss: 2.320 Test Acc: 0.395
Validation loss decreased (-0.387244 --> -0.394948).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3360920
	speed: 0.2030s/iter; left time: 511.2659s
Epoch: 14 cost time: 10.372134447097778
Epoch: 14, Steps: 154 | Train Loss: 1.295 Vali Loss: 2.650 Vali Acc: 0.399 Test Loss: 2.650 Test Acc: 0.399
Validation loss decreased (-0.394948 --> -0.398595).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.2288949
	speed: 0.2326s/iter; left time: 549.9837s
Epoch: 15 cost time: 10.853464365005493
Epoch: 15, Steps: 154 | Train Loss: 1.256 Vali Loss: 3.723 Vali Acc: 0.099 Test Loss: 3.723 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1606021
	speed: 0.2460s/iter; left time: 543.8211s
Epoch: 16 cost time: 12.054819822311401
Epoch: 16, Steps: 154 | Train Loss: 1.243 Vali Loss: 4.585 Vali Acc: 0.086 Test Loss: 4.585 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.9887071
	speed: 0.2440s/iter; left time: 502.0071s
Epoch: 17 cost time: 11.613958358764648
Epoch: 17, Steps: 154 | Train Loss: 1.193 Vali Loss: 4.784 Vali Acc: 0.087 Test Loss: 4.784 Test Acc: 0.087
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.3261197
	speed: 0.2418s/iter; left time: 460.2185s
Epoch: 18 cost time: 11.123703718185425
Epoch: 18, Steps: 154 | Train Loss: 1.188 Vali Loss: 4.355 Vali Acc: 0.104 Test Loss: 4.355 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.1919813
	speed: 0.2311s/iter; left time: 404.2811s
Epoch: 19 cost time: 11.42750358581543
Epoch: 19, Steps: 154 | Train Loss: 1.155 Vali Loss: 3.717 Vali Acc: 0.219 Test Loss: 3.717 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.1001385
	speed: 0.2385s/iter; left time: 380.3739s
Epoch: 20 cost time: 11.677650690078735
Epoch: 20, Steps: 154 | Train Loss: 1.132 Vali Loss: 5.189 Vali Acc: 0.083 Test Loss: 5.189 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.4285179
	speed: 0.2462s/iter; left time: 354.7398s
Epoch: 21 cost time: 12.066434860229492
Epoch: 21, Steps: 154 | Train Loss: 1.113 Vali Loss: 5.289 Vali Acc: 0.093 Test Loss: 5.289 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.0658174
	speed: 0.2451s/iter; left time: 315.4945s
Epoch: 22 cost time: 10.491193294525146
Epoch: 22, Steps: 154 | Train Loss: 1.085 Vali Loss: 4.374 Vali Acc: 0.143 Test Loss: 4.374 Test Acc: 0.143
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.9714931
	speed: 0.2121s/iter; left time: 240.3189s
Epoch: 23 cost time: 9.948797464370728
Epoch: 23, Steps: 154 | Train Loss: 1.085 Vali Loss: 6.456 Vali Acc: 0.093 Test Loss: 6.456 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.7269620
	speed: 0.1973s/iter; left time: 193.1414s
Epoch: 24 cost time: 10.047652244567871
Epoch: 24, Steps: 154 | Train Loss: 1.031 Vali Loss: 5.717 Vali Acc: 0.094 Test Loss: 5.717 Test Acc: 0.094
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3986212489862125
model parameter : 301710
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0847208
	speed: 0.0709s/iter; left time: 320.4007s
Epoch: 1 cost time: 10.194782972335815
Epoch: 1, Steps: 154 | Train Loss: 2.226 Vali Loss: 2.132 Vali Acc: 0.315 Test Loss: 2.132 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1122441
	speed: 0.1949s/iter; left time: 851.2977s
Epoch: 2 cost time: 8.919032573699951
Epoch: 2, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.107 Vali Acc: 0.325 Test Loss: 2.107 Test Acc: 0.325
Validation loss decreased (-0.315064 --> -0.324796).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9008007
	speed: 0.1956s/iter; left time: 824.1694s
Epoch: 3 cost time: 9.01166033744812
Epoch: 3, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.089 Vali Acc: 0.336 Test Loss: 2.089 Test Acc: 0.336
Validation loss decreased (-0.324796 --> -0.335746).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9287971
	speed: 0.1900s/iter; left time: 771.3243s
Epoch: 4 cost time: 8.633785009384155
Epoch: 4, Steps: 154 | Train Loss: 1.886 Vali Loss: 2.171 Vali Acc: 0.341 Test Loss: 2.171 Test Acc: 0.341
Validation loss decreased (-0.335746 --> -0.340611).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5203049
	speed: 0.1735s/iter; left time: 677.5479s
Epoch: 5 cost time: 7.881331205368042
Epoch: 5, Steps: 154 | Train Loss: 1.800 Vali Loss: 2.222 Vali Acc: 0.343 Test Loss: 2.222 Test Acc: 0.343
Validation loss decreased (-0.340611 --> -0.342638).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6839901
	speed: 0.1946s/iter; left time: 730.0193s
Epoch: 6 cost time: 8.826618909835815
Epoch: 6, Steps: 154 | Train Loss: 1.712 Vali Loss: 2.319 Vali Acc: 0.344 Test Loss: 2.319 Test Acc: 0.344
Validation loss decreased (-0.342638 --> -0.344259).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7384609
	speed: 0.2080s/iter; left time: 748.2645s
Epoch: 7 cost time: 10.096221446990967
Epoch: 7, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.181 Vali Acc: 0.361 Test Loss: 2.181 Test Acc: 0.361
Validation loss decreased (-0.344259 --> -0.361292).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4605477
	speed: 0.2193s/iter; left time: 755.1904s
Epoch: 8 cost time: 9.874590396881104
Epoch: 8, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.437 Vali Acc: 0.351 Test Loss: 2.437 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7946146
	speed: 0.2128s/iter; left time: 700.0058s
Epoch: 9 cost time: 9.173494338989258
Epoch: 9, Steps: 154 | Train Loss: 1.534 Vali Loss: 2.516 Vali Acc: 0.374 Test Loss: 2.516 Test Acc: 0.374
Validation loss decreased (-0.361292 --> -0.374265).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8112936
	speed: 0.2040s/iter; left time: 639.5830s
Epoch: 10 cost time: 9.053105354309082
Epoch: 10, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.478 Vali Acc: 0.366 Test Loss: 2.478 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.2284325
	speed: 0.2060s/iter; left time: 614.1117s
Epoch: 11 cost time: 9.849323034286499
Epoch: 11, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.653 Vali Acc: 0.213 Test Loss: 2.653 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1658205
	speed: 0.2183s/iter; left time: 617.1064s
Epoch: 12 cost time: 9.64078164100647
Epoch: 12, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.866 Vali Acc: 0.221 Test Loss: 2.866 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3096973
	speed: 0.2190s/iter; left time: 585.4467s
Epoch: 13 cost time: 10.080575704574585
Epoch: 13, Steps: 154 | Train Loss: 1.376 Vali Loss: 3.064 Vali Acc: 0.212 Test Loss: 3.064 Test Acc: 0.212
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.9851534
	speed: 0.2184s/iter; left time: 550.1341s
Epoch: 14 cost time: 9.730656862258911
Epoch: 14, Steps: 154 | Train Loss: 1.362 Vali Loss: 2.880 Vali Acc: 0.335 Test Loss: 2.880 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.4347620
	speed: 0.2095s/iter; left time: 495.3742s
Epoch: 15 cost time: 8.87826657295227
Epoch: 15, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.239 Vali Acc: 0.210 Test Loss: 3.239 Test Acc: 0.210
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.5516090
	speed: 0.1788s/iter; left time: 395.2454s
Epoch: 16 cost time: 8.446649312973022
Epoch: 16, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.274 Vali Acc: 0.222 Test Loss: 3.274 Test Acc: 0.222
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.0391705
	speed: 0.1895s/iter; left time: 389.8307s
Epoch: 17 cost time: 8.860915184020996
Epoch: 17, Steps: 154 | Train Loss: 1.292 Vali Loss: 3.360 Vali Acc: 0.122 Test Loss: 3.360 Test Acc: 0.122
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.9850367
	speed: 0.2004s/iter; left time: 381.4525s
Epoch: 18 cost time: 9.127138137817383
Epoch: 18, Steps: 154 | Train Loss: 1.276 Vali Loss: 3.267 Vali Acc: 0.231 Test Loss: 3.267 Test Acc: 0.231
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.2365088
	speed: 0.1955s/iter; left time: 341.8775s
Epoch: 19 cost time: 8.693027973175049
Epoch: 19, Steps: 154 | Train Loss: 1.227 Vali Loss: 5.124 Vali Acc: 0.076 Test Loss: 5.124 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3742903487429035
model parameter : 94734
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2677612
	speed: 0.0650s/iter; left time: 293.7275s
Epoch: 1 cost time: 9.519727230072021
Epoch: 1, Steps: 154 | Train Loss: 2.252 Vali Loss: 2.105 Vali Acc: 0.317 Test Loss: 2.105 Test Acc: 0.317
Validation loss decreased (inf --> -0.316686).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6124152
	speed: 0.1880s/iter; left time: 821.0115s
Epoch: 2 cost time: 9.748003005981445
Epoch: 2, Steps: 154 | Train Loss: 2.016 Vali Loss: 2.070 Vali Acc: 0.326 Test Loss: 2.070 Test Acc: 0.326
Validation loss decreased (-0.316686 --> -0.326013).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5322040
	speed: 0.2002s/iter; left time: 843.2750s
Epoch: 3 cost time: 9.646430730819702
Epoch: 3, Steps: 154 | Train Loss: 1.885 Vali Loss: 2.181 Vali Acc: 0.171 Test Loss: 2.181 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7944810
	speed: 0.1961s/iter; left time: 796.1340s
Epoch: 4 cost time: 9.267936706542969
Epoch: 4, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.163 Vali Acc: 0.345 Test Loss: 2.163 Test Acc: 0.345
Validation loss decreased (-0.326013 --> -0.345477).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0029550
	speed: 0.2142s/iter; left time: 836.4550s
Epoch: 5 cost time: 11.100292921066284
Epoch: 5, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.215 Vali Acc: 0.361 Test Loss: 2.215 Test Acc: 0.361
Validation loss decreased (-0.345477 --> -0.360886).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.2941728
	speed: 0.2076s/iter; left time: 778.5590s
Epoch: 6 cost time: 9.246244430541992
Epoch: 6, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.144 Vali Acc: 0.352 Test Loss: 2.144 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6234637
	speed: 0.2066s/iter; left time: 743.1442s
Epoch: 7 cost time: 10.096071243286133
Epoch: 7, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.085 Vali Acc: 0.371 Test Loss: 2.085 Test Acc: 0.371
Validation loss decreased (-0.360886 --> -0.371431).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.2585560
	speed: 0.2221s/iter; left time: 764.6204s
Epoch: 8 cost time: 10.36151123046875
Epoch: 8, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.269 Vali Acc: 0.196 Test Loss: 2.269 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2177997
	speed: 0.2249s/iter; left time: 739.6224s
Epoch: 9 cost time: 10.584076881408691
Epoch: 9, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.740 Vali Acc: 0.180 Test Loss: 2.740 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2672629
	speed: 0.2245s/iter; left time: 703.6988s
Epoch: 10 cost time: 10.531141757965088
Epoch: 10, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.717 Vali Acc: 0.176 Test Loss: 2.717 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.1342008
	speed: 0.2151s/iter; left time: 641.2283s
Epoch: 11 cost time: 9.555264711380005
Epoch: 11, Steps: 154 | Train Loss: 1.434 Vali Loss: 2.612 Vali Acc: 0.376 Test Loss: 2.612 Test Acc: 0.376
Validation loss decreased (-0.371431 --> -0.375481).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.3529778
	speed: 0.2032s/iter; left time: 574.5827s
Epoch: 12 cost time: 9.333157062530518
Epoch: 12, Steps: 154 | Train Loss: 1.403 Vali Loss: 3.719 Vali Acc: 0.103 Test Loss: 3.719 Test Acc: 0.103
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.8597798
	speed: 0.2083s/iter; left time: 556.8537s
Epoch: 13 cost time: 9.248901605606079
Epoch: 13, Steps: 154 | Train Loss: 1.350 Vali Loss: 3.207 Vali Acc: 0.082 Test Loss: 3.207 Test Acc: 0.082
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2800239
	speed: 0.1960s/iter; left time: 493.6233s
Epoch: 14 cost time: 9.166970491409302
Epoch: 14, Steps: 154 | Train Loss: 1.345 Vali Loss: 2.738 Vali Acc: 0.212 Test Loss: 2.738 Test Acc: 0.212
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.3143991
	speed: 0.1891s/iter; left time: 447.2376s
Epoch: 15 cost time: 8.54776644706726
Epoch: 15, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.270 Vali Acc: 0.113 Test Loss: 3.270 Test Acc: 0.113
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.0971050
	speed: 0.1929s/iter; left time: 426.5261s
Epoch: 16 cost time: 8.58411431312561
Epoch: 16, Steps: 154 | Train Loss: 1.272 Vali Loss: 3.908 Vali Acc: 0.191 Test Loss: 3.908 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0696801
	speed: 0.1704s/iter; left time: 350.5610s
Epoch: 17 cost time: 7.574323654174805
Epoch: 17, Steps: 154 | Train Loss: 1.254 Vali Loss: 4.249 Vali Acc: 0.086 Test Loss: 4.249 Test Acc: 0.086
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.2199579
	speed: 0.1729s/iter; left time: 328.9987s
Epoch: 18 cost time: 8.636195659637451
Epoch: 18, Steps: 154 | Train Loss: 1.227 Vali Loss: 3.930 Vali Acc: 0.212 Test Loss: 3.930 Test Acc: 0.212
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.2276273
	speed: 0.1367s/iter; left time: 239.0035s
Epoch: 19 cost time: 4.768340110778809
Epoch: 19, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.021 Vali Acc: 0.214 Test Loss: 4.021 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.2333190
	speed: 0.1275s/iter; left time: 203.4096s
Epoch: 20 cost time: 7.338597536087036
Epoch: 20, Steps: 154 | Train Loss: 1.203 Vali Loss: 4.983 Vali Acc: 0.105 Test Loss: 4.983 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.5591933
	speed: 0.1546s/iter; left time: 222.8300s
Epoch: 21 cost time: 7.370667934417725
Epoch: 21, Steps: 154 | Train Loss: 1.169 Vali Loss: 5.193 Vali Acc: 0.120 Test Loss: 5.193 Test Acc: 0.120
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37550689375506896
model parameter : 301710
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0925310
	speed: 0.0592s/iter; left time: 267.8096s
Epoch: 1 cost time: 8.44911003112793
Epoch: 1, Steps: 154 | Train Loss: 2.231 Vali Loss: 2.135 Vali Acc: 0.315 Test Loss: 2.135 Test Acc: 0.315
Validation loss decreased (inf --> -0.315469).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1023428
	speed: 0.1675s/iter; left time: 731.4722s
Epoch: 2 cost time: 6.967856168746948
Epoch: 2, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.102 Vali Acc: 0.324 Test Loss: 2.102 Test Acc: 0.324
Validation loss decreased (-0.315469 --> -0.323580).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9266487
	speed: 0.1530s/iter; left time: 644.6218s
Epoch: 3 cost time: 6.432497024536133
Epoch: 3, Steps: 154 | Train Loss: 1.969 Vali Loss: 2.075 Vali Acc: 0.337 Test Loss: 2.075 Test Acc: 0.337
Validation loss decreased (-0.323580 --> -0.336557).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9210156
	speed: 0.1588s/iter; left time: 644.5187s
Epoch: 4 cost time: 7.12354588508606
Epoch: 4, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.151 Vali Acc: 0.338 Test Loss: 2.151 Test Acc: 0.338
Validation loss decreased (-0.336557 --> -0.338178).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6186976
	speed: 0.1694s/iter; left time: 661.3555s
Epoch: 5 cost time: 7.272608518600464
Epoch: 5, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.159 Vali Acc: 0.335 Test Loss: 2.159 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8405191
	speed: 0.1514s/iter; left time: 567.9849s
Epoch: 6 cost time: 6.39089298248291
Epoch: 6, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.246 Vali Acc: 0.338 Test Loss: 2.246 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7683077
	speed: 0.1647s/iter; left time: 592.5236s
Epoch: 7 cost time: 7.178537845611572
Epoch: 7, Steps: 154 | Train Loss: 1.689 Vali Loss: 2.080 Vali Acc: 0.357 Test Loss: 2.080 Test Acc: 0.357
Validation loss decreased (-0.338178 --> -0.356832).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6469805
	speed: 0.1676s/iter; left time: 576.9917s
Epoch: 8 cost time: 6.794103384017944
Epoch: 8, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.323 Vali Acc: 0.350 Test Loss: 2.323 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7885228
	speed: 0.1375s/iter; left time: 452.1941s
Epoch: 9 cost time: 5.363384485244751
Epoch: 9, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.264 Vali Acc: 0.376 Test Loss: 2.264 Test Acc: 0.376
Validation loss decreased (-0.356832 --> -0.375890).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7898316
	speed: 0.1413s/iter; left time: 442.9926s
Epoch: 10 cost time: 6.341825723648071
Epoch: 10, Steps: 154 | Train Loss: 1.559 Vali Loss: 2.254 Vali Acc: 0.365 Test Loss: 2.254 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.3401682
	speed: 0.1387s/iter; left time: 413.4783s
Epoch: 11 cost time: 5.519665241241455
Epoch: 11, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.718 Vali Acc: 0.191 Test Loss: 2.718 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2688810
	speed: 0.1274s/iter; left time: 360.1579s
Epoch: 12 cost time: 5.9395928382873535
Epoch: 12, Steps: 154 | Train Loss: 1.473 Vali Loss: 2.578 Vali Acc: 0.206 Test Loss: 2.578 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3625623
	speed: 0.1418s/iter; left time: 378.9552s
Epoch: 13 cost time: 6.331667184829712
Epoch: 13, Steps: 154 | Train Loss: 1.443 Vali Loss: 3.507 Vali Acc: 0.203 Test Loss: 3.507 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.9321448
	speed: 0.1361s/iter; left time: 342.8639s
Epoch: 14 cost time: 5.517552852630615
Epoch: 14, Steps: 154 | Train Loss: 1.425 Vali Loss: 2.528 Vali Acc: 0.322 Test Loss: 2.528 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.5903178
	speed: 0.1285s/iter; left time: 303.9027s
Epoch: 15 cost time: 5.709701061248779
Epoch: 15, Steps: 154 | Train Loss: 1.374 Vali Loss: 3.464 Vali Acc: 0.192 Test Loss: 3.464 Test Acc: 0.192
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.3720767
	speed: 0.1384s/iter; left time: 305.9339s
Epoch: 16 cost time: 5.953210115432739
Epoch: 16, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.821 Vali Acc: 0.136 Test Loss: 3.821 Test Acc: 0.136
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.1453117
	speed: 0.1366s/iter; left time: 281.0329s
Epoch: 17 cost time: 5.566468954086304
Epoch: 17, Steps: 154 | Train Loss: 1.342 Vali Loss: 3.195 Vali Acc: 0.186 Test Loss: 3.195 Test Acc: 0.186
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 2.0123682
	speed: 0.1341s/iter; left time: 255.1639s
Epoch: 18 cost time: 5.896759748458862
Epoch: 18, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.562 Vali Acc: 0.100 Test Loss: 3.562 Test Acc: 0.100
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.2262117
	speed: 0.1375s/iter; left time: 240.5606s
Epoch: 19 cost time: 6.11258339881897
Epoch: 19, Steps: 154 | Train Loss: 1.292 Vali Loss: 6.144 Vali Acc: 0.058 Test Loss: 6.144 Test Acc: 0.058
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3759124087591241
model parameter : 94734
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8234740
	speed: 0.0922s/iter; left time: 416.9908s
Epoch: 1 cost time: 13.799651384353638
Epoch: 1, Steps: 154 | Train Loss: 2.178 Vali Loss: 2.109 Vali Acc: 0.318 Test Loss: 2.109 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1467011
	speed: 0.2191s/iter; left time: 956.6866s
Epoch: 2 cost time: 9.337265253067017
Epoch: 2, Steps: 154 | Train Loss: 2.007 Vali Loss: 2.102 Vali Acc: 0.333 Test Loss: 2.102 Test Acc: 0.333
Validation loss decreased (-0.317497 --> -0.332501).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0623965
	speed: 0.1657s/iter; left time: 698.0385s
Epoch: 3 cost time: 10.227728366851807
Epoch: 3, Steps: 154 | Train Loss: 1.913 Vali Loss: 2.047 Vali Acc: 0.337 Test Loss: 2.047 Test Acc: 0.337
Validation loss decreased (-0.332501 --> -0.336963).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0845790
	speed: 0.2055s/iter; left time: 834.2999s
Epoch: 4 cost time: 10.29389238357544
Epoch: 4, Steps: 154 | Train Loss: 1.861 Vali Loss: 2.065 Vali Acc: 0.353 Test Loss: 2.065 Test Acc: 0.353
Validation loss decreased (-0.336963 --> -0.353183).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6895952
	speed: 0.2047s/iter; left time: 799.5171s
Epoch: 5 cost time: 11.223750114440918
Epoch: 5, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.051 Vali Acc: 0.349 Test Loss: 2.051 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.3578386
	speed: 0.2056s/iter; left time: 771.3358s
Epoch: 6 cost time: 10.312698125839233
Epoch: 6, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.056 Vali Acc: 0.369 Test Loss: 2.056 Test Acc: 0.369
Validation loss decreased (-0.353183 --> -0.368998).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0366523
	speed: 0.2118s/iter; left time: 761.8178s
Epoch: 7 cost time: 11.620168447494507
Epoch: 7, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.241 Vali Acc: 0.364 Test Loss: 2.241 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.7355014
	speed: 0.1916s/iter; left time: 659.5388s
Epoch: 8 cost time: 9.323150634765625
Epoch: 8, Steps: 154 | Train Loss: 1.685 Vali Loss: 2.004 Vali Acc: 0.359 Test Loss: 2.004 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.6249516
	speed: 0.1975s/iter; left time: 649.4209s
Epoch: 9 cost time: 10.839013576507568
Epoch: 9, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.067 Vali Acc: 0.360 Test Loss: 2.067 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.2912467
	speed: 0.1820s/iter; left time: 570.5159s
Epoch: 10 cost time: 9.631340026855469
Epoch: 10, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.015 Vali Acc: 0.368 Test Loss: 2.015 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.6717904
	speed: 0.1930s/iter; left time: 575.3786s
Epoch: 11 cost time: 9.584506273269653
Epoch: 11, Steps: 154 | Train Loss: 1.562 Vali Loss: 2.341 Vali Acc: 0.237 Test Loss: 2.341 Test Acc: 0.237
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.7343887
	speed: 0.1850s/iter; left time: 522.9132s
Epoch: 12 cost time: 10.8070547580719
Epoch: 12, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.562 Vali Acc: 0.105 Test Loss: 3.562 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.5772426
	speed: 0.2183s/iter; left time: 583.4199s
Epoch: 13 cost time: 11.194496631622314
Epoch: 13, Steps: 154 | Train Loss: 1.512 Vali Loss: 2.371 Vali Acc: 0.144 Test Loss: 2.371 Test Acc: 0.144
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.9312696
	speed: 0.1940s/iter; left time: 488.6730s
Epoch: 14 cost time: 10.572279214859009
Epoch: 14, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.215 Vali Acc: 0.339 Test Loss: 2.215 Test Acc: 0.339
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.3570452
	speed: 0.2057s/iter; left time: 486.5196s
Epoch: 15 cost time: 10.616353511810303
Epoch: 15, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.799 Vali Acc: 0.109 Test Loss: 2.799 Test Acc: 0.109
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2365469
	speed: 0.2023s/iter; left time: 447.1889s
Epoch: 16 cost time: 11.126439332962036
Epoch: 16, Steps: 154 | Train Loss: 1.435 Vali Loss: 4.315 Vali Acc: 0.123 Test Loss: 4.315 Test Acc: 0.123
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36901865369018655
model parameter : 590830
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0828929
	speed: 0.0677s/iter; left time: 306.1799s
Epoch: 1 cost time: 9.798519134521484
Epoch: 1, Steps: 154 | Train Loss: 2.274 Vali Loss: 2.115 Vali Acc: 0.315 Test Loss: 2.115 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8924190
	speed: 0.1681s/iter; left time: 733.8977s
Epoch: 2 cost time: 7.842074155807495
Epoch: 2, Steps: 154 | Train Loss: 2.046 Vali Loss: 2.101 Vali Acc: 0.325 Test Loss: 2.101 Test Acc: 0.325
Validation loss decreased (-0.315064 --> -0.325202).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1563694
	speed: 0.1565s/iter; left time: 659.1288s
Epoch: 3 cost time: 8.450387001037598
Epoch: 3, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.056 Vali Acc: 0.339 Test Loss: 2.056 Test Acc: 0.339
Validation loss decreased (-0.325202 --> -0.338584).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6869510
	speed: 0.1654s/iter; left time: 671.1587s
Epoch: 4 cost time: 8.22533631324768
Epoch: 4, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.085 Vali Acc: 0.338 Test Loss: 2.085 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0417743
	speed: 0.1654s/iter; left time: 645.9829s
Epoch: 5 cost time: 8.968589782714844
Epoch: 5, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.074 Vali Acc: 0.339 Test Loss: 2.074 Test Acc: 0.339
Validation loss decreased (-0.338584 --> -0.338990).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6227684
	speed: 0.1824s/iter; left time: 684.2698s
Epoch: 6 cost time: 8.882248163223267
Epoch: 6, Steps: 154 | Train Loss: 1.726 Vali Loss: 2.646 Vali Acc: 0.095 Test Loss: 2.646 Test Acc: 0.095
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0945365
	speed: 0.1669s/iter; left time: 600.4216s
Epoch: 7 cost time: 8.834624290466309
Epoch: 7, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.563 Vali Acc: 0.092 Test Loss: 2.563 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1440718
	speed: 0.1821s/iter; left time: 626.8415s
Epoch: 8 cost time: 9.122555494308472
Epoch: 8, Steps: 154 | Train Loss: 1.642 Vali Loss: 3.493 Vali Acc: 0.089 Test Loss: 3.493 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.3322276
	speed: 0.1596s/iter; left time: 525.0630s
Epoch: 9 cost time: 7.7078857421875
Epoch: 9, Steps: 154 | Train Loss: 1.598 Vali Loss: 4.348 Vali Acc: 0.099 Test Loss: 4.348 Test Acc: 0.099
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5170468
	speed: 0.1640s/iter; left time: 514.0849s
Epoch: 10 cost time: 8.15133023262024
Epoch: 10, Steps: 154 | Train Loss: 1.569 Vali Loss: 3.358 Vali Acc: 0.099 Test Loss: 3.358 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3805350
	speed: 0.1541s/iter; left time: 459.4552s
Epoch: 11 cost time: 7.697894096374512
Epoch: 11, Steps: 154 | Train Loss: 1.537 Vali Loss: 4.438 Vali Acc: 0.110 Test Loss: 4.438 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.8471297
	speed: 0.1648s/iter; left time: 465.8630s
Epoch: 12 cost time: 8.57937240600586
Epoch: 12, Steps: 154 | Train Loss: 1.525 Vali Loss: 4.314 Vali Acc: 0.104 Test Loss: 4.314 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.1377198
	speed: 0.1571s/iter; left time: 420.0181s
Epoch: 13 cost time: 7.613117694854736
Epoch: 13, Steps: 154 | Train Loss: 1.477 Vali Loss: 4.670 Vali Acc: 0.095 Test Loss: 4.670 Test Acc: 0.095
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.4521257
	speed: 0.1705s/iter; left time: 429.4936s
Epoch: 14 cost time: 9.073230981826782
Epoch: 14, Steps: 154 | Train Loss: 1.452 Vali Loss: 5.194 Vali Acc: 0.106 Test Loss: 5.194 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.3546897
	speed: 0.1690s/iter; left time: 399.7561s
Epoch: 15 cost time: 8.388931035995483
Epoch: 15, Steps: 154 | Train Loss: 1.429 Vali Loss: 5.913 Vali Acc: 0.115 Test Loss: 5.913 Test Acc: 0.115
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33901054339010545
model parameter : 176846
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8250995
	speed: 0.0863s/iter; left time: 390.2074s
Epoch: 1 cost time: 12.844925880432129
Epoch: 1, Steps: 154 | Train Loss: 2.180 Vali Loss: 2.106 Vali Acc: 0.317 Test Loss: 2.106 Test Acc: 0.317
Validation loss decreased (inf --> -0.317092).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1420906
	speed: 0.2178s/iter; left time: 951.3308s
Epoch: 2 cost time: 10.467871189117432
Epoch: 2, Steps: 154 | Train Loss: 2.014 Vali Loss: 2.101 Vali Acc: 0.333 Test Loss: 2.101 Test Acc: 0.333
Validation loss decreased (-0.317092 --> -0.332907).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0572975
	speed: 0.1981s/iter; left time: 834.4158s
Epoch: 3 cost time: 9.147487163543701
Epoch: 3, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.069 Vali Acc: 0.333 Test Loss: 2.069 Test Acc: 0.333
Validation loss decreased (-0.332907 --> -0.333313).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0081544
	speed: 0.1719s/iter; left time: 697.7045s
Epoch: 4 cost time: 9.719007730484009
Epoch: 4, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.049 Vali Acc: 0.349 Test Loss: 2.049 Test Acc: 0.349
Validation loss decreased (-0.333313 --> -0.348722).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6870703
	speed: 0.2012s/iter; left time: 785.6019s
Epoch: 5 cost time: 10.500555515289307
Epoch: 5, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.035 Vali Acc: 0.354 Test Loss: 2.035 Test Acc: 0.354
Validation loss decreased (-0.348722 --> -0.354400).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.3919518
	speed: 0.1948s/iter; left time: 730.6081s
Epoch: 6 cost time: 9.814977169036865
Epoch: 6, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.063 Vali Acc: 0.365 Test Loss: 2.063 Test Acc: 0.365
Validation loss decreased (-0.354400 --> -0.364943).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0474167
	speed: 0.1716s/iter; left time: 617.3648s
Epoch: 7 cost time: 8.679576396942139
Epoch: 7, Steps: 154 | Train Loss: 1.717 Vali Loss: 2.187 Vali Acc: 0.356 Test Loss: 2.187 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.8614777
	speed: 0.1865s/iter; left time: 641.9686s
Epoch: 8 cost time: 10.183131217956543
Epoch: 8, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.075 Vali Acc: 0.348 Test Loss: 2.075 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.7507083
	speed: 0.1977s/iter; left time: 650.1996s
Epoch: 9 cost time: 10.472615242004395
Epoch: 9, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.096 Vali Acc: 0.334 Test Loss: 2.096 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 2.2549047
	speed: 0.2016s/iter; left time: 631.9124s
Epoch: 10 cost time: 9.5945565700531
Epoch: 10, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.046 Vali Acc: 0.365 Test Loss: 2.046 Test Acc: 0.365
Validation loss decreased (-0.364943 --> -0.365349).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5414606
	speed: 0.1829s/iter; left time: 545.3389s
Epoch: 11 cost time: 9.912899255752563
Epoch: 11, Steps: 154 | Train Loss: 1.573 Vali Loss: 2.540 Vali Acc: 0.094 Test Loss: 2.540 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.7987083
	speed: 0.2088s/iter; left time: 590.2046s
Epoch: 12 cost time: 10.869184970855713
Epoch: 12, Steps: 154 | Train Loss: 1.540 Vali Loss: 2.293 Vali Acc: 0.311 Test Loss: 2.293 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6606255
	speed: 0.2064s/iter; left time: 551.7672s
Epoch: 13 cost time: 10.646676063537598
Epoch: 13, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.144 Vali Acc: 0.271 Test Loss: 2.144 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 2.1152425
	speed: 0.1954s/iter; left time: 492.1908s
Epoch: 14 cost time: 9.306655645370483
Epoch: 14, Steps: 154 | Train Loss: 1.468 Vali Loss: 2.837 Vali Acc: 0.100 Test Loss: 2.837 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4062059
	speed: 0.1859s/iter; left time: 439.5672s
Epoch: 15 cost time: 10.220924139022827
Epoch: 15, Steps: 154 | Train Loss: 1.465 Vali Loss: 2.276 Vali Acc: 0.239 Test Loss: 2.276 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0823270
	speed: 0.1936s/iter; left time: 428.1466s
Epoch: 16 cost time: 9.466126441955566
Epoch: 16, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.271 Vali Acc: 0.193 Test Loss: 2.271 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.3621817
	speed: 0.1829s/iter; left time: 376.3270s
Epoch: 17 cost time: 8.078525066375732
Epoch: 17, Steps: 154 | Train Loss: 1.419 Vali Loss: 2.771 Vali Acc: 0.098 Test Loss: 2.771 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.0567739
	speed: 0.1603s/iter; left time: 305.0120s
Epoch: 18 cost time: 8.123630046844482
Epoch: 18, Steps: 154 | Train Loss: 1.384 Vali Loss: 3.156 Vali Acc: 0.113 Test Loss: 3.156 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.5869130
	speed: 0.1967s/iter; left time: 344.1107s
Epoch: 19 cost time: 10.241204738616943
Epoch: 19, Steps: 154 | Train Loss: 1.380 Vali Loss: 3.477 Vali Acc: 0.121 Test Loss: 3.477 Test Acc: 0.121
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.7239907
	speed: 0.1950s/iter; left time: 311.0024s
Epoch: 20 cost time: 9.683162450790405
Epoch: 20, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.306 Vali Acc: 0.243 Test Loss: 2.306 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3653690186536902
model parameter : 590830
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0846963
	speed: 0.0708s/iter; left time: 319.9926s
Epoch: 1 cost time: 10.390153884887695
Epoch: 1, Steps: 154 | Train Loss: 2.278 Vali Loss: 2.113 Vali Acc: 0.315 Test Loss: 2.113 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8773417
	speed: 0.1834s/iter; left time: 800.8832s
Epoch: 2 cost time: 8.732467651367188
Epoch: 2, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.100 Vali Acc: 0.324 Test Loss: 2.100 Test Acc: 0.324
Validation loss decreased (-0.315064 --> -0.324391).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0930285
	speed: 0.1865s/iter; left time: 785.5951s
Epoch: 3 cost time: 9.473513126373291
Epoch: 3, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.059 Vali Acc: 0.339 Test Loss: 2.059 Test Acc: 0.339
Validation loss decreased (-0.324391 --> -0.339395).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7072033
	speed: 0.1598s/iter; left time: 648.6425s
Epoch: 4 cost time: 7.334407567977905
Epoch: 4, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.105 Vali Acc: 0.337 Test Loss: 2.105 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.0184951
	speed: 0.1551s/iter; left time: 605.5954s
Epoch: 5 cost time: 9.080069541931152
Epoch: 5, Steps: 154 | Train Loss: 1.780 Vali Loss: 2.106 Vali Acc: 0.338 Test Loss: 2.106 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.6274730
	speed: 0.1713s/iter; left time: 642.7016s
Epoch: 6 cost time: 8.54762578010559
Epoch: 6, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.659 Vali Acc: 0.108 Test Loss: 2.659 Test Acc: 0.108
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.2160428
	speed: 0.1710s/iter; left time: 614.9972s
Epoch: 7 cost time: 7.895849227905273
Epoch: 7, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.642 Vali Acc: 0.100 Test Loss: 2.642 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 1.1142570
	speed: 0.1440s/iter; left time: 495.7555s
Epoch: 8 cost time: 6.368643760681152
Epoch: 8, Steps: 154 | Train Loss: 1.650 Vali Loss: 2.454 Vali Acc: 0.103 Test Loss: 2.454 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 1.3500541
	speed: 0.1427s/iter; left time: 469.3351s
Epoch: 9 cost time: 8.011462688446045
Epoch: 9, Steps: 154 | Train Loss: 1.614 Vali Loss: 3.565 Vali Acc: 0.098 Test Loss: 3.565 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 1.5906909
	speed: 0.1697s/iter; left time: 532.1633s
Epoch: 10 cost time: 8.277354001998901
Epoch: 10, Steps: 154 | Train Loss: 1.580 Vali Loss: 3.078 Vali Acc: 0.102 Test Loss: 3.078 Test Acc: 0.102
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 1.3003836
	speed: 0.1686s/iter; left time: 502.5347s
Epoch: 11 cost time: 8.03592038154602
Epoch: 11, Steps: 154 | Train Loss: 1.550 Vali Loss: 4.106 Vali Acc: 0.101 Test Loss: 4.106 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 1.8093580
	speed: 0.1447s/iter; left time: 409.1166s
Epoch: 12 cost time: 6.725738525390625
Epoch: 12, Steps: 154 | Train Loss: 1.528 Vali Loss: 4.284 Vali Acc: 0.104 Test Loss: 4.284 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 1.2149172
	speed: 0.1613s/iter; left time: 431.1013s
Epoch: 13 cost time: 8.864941358566284
Epoch: 13, Steps: 154 | Train Loss: 1.493 Vali Loss: 3.932 Vali Acc: 0.097 Test Loss: 3.932 Test Acc: 0.097
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33941605839416056
model parameter : 176846
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8282919
	speed: 0.0748s/iter; left time: 338.3368s
Epoch: 1 cost time: 11.165080785751343
Epoch: 1, Steps: 154 | Train Loss: 2.202 Vali Loss: 2.097 Vali Acc: 0.315 Test Loss: 2.097 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1432128
	speed: 0.1680s/iter; left time: 733.5892s
Epoch: 2 cost time: 7.986079454421997
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.103 Vali Acc: 0.325 Test Loss: 2.103 Test Acc: 0.325
Validation loss decreased (-0.315064 --> -0.324796).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2098596
	speed: 0.1548s/iter; left time: 651.9619s
Epoch: 3 cost time: 9.85597538948059
Epoch: 3, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.119 Vali Acc: 0.333 Test Loss: 2.119 Test Acc: 0.333
Validation loss decreased (-0.324796 --> -0.332907).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0547719
	speed: 0.1855s/iter; left time: 752.8275s
Epoch: 4 cost time: 8.461151361465454
Epoch: 4, Steps: 154 | Train Loss: 1.922 Vali Loss: 2.019 Vali Acc: 0.351 Test Loss: 2.019 Test Acc: 0.351
Validation loss decreased (-0.332907 --> -0.350750).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6433042
	speed: 0.1656s/iter; left time: 646.6088s
Epoch: 5 cost time: 7.933934211730957
Epoch: 5, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.068 Vali Acc: 0.345 Test Loss: 2.068 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.5349224
	speed: 0.1399s/iter; left time: 524.6105s
Epoch: 6 cost time: 6.246551275253296
Epoch: 6, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.205 Vali Acc: 0.265 Test Loss: 2.205 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.0874102
	speed: 0.1433s/iter; left time: 515.5919s
Epoch: 7 cost time: 7.896105051040649
Epoch: 7, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.113 Vali Acc: 0.364 Test Loss: 2.113 Test Acc: 0.364
Validation loss decreased (-0.350750 --> -0.364131).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.2005270
	speed: 0.1622s/iter; left time: 558.5535s
Epoch: 8 cost time: 7.7766900062561035
Epoch: 8, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.016 Vali Acc: 0.363 Test Loss: 2.016 Test Acc: 0.363
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6710297
	speed: 0.1645s/iter; left time: 541.1530s
Epoch: 9 cost time: 7.846449375152588
Epoch: 9, Steps: 154 | Train Loss: 1.671 Vali Loss: 2.197 Vali Acc: 0.352 Test Loss: 2.197 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 6.7154598
	speed: 0.1373s/iter; left time: 430.3893s
Epoch: 10 cost time: 6.209068298339844
Epoch: 10, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.099 Vali Acc: 0.358 Test Loss: 2.099 Test Acc: 0.358
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.7705265
	speed: 0.1342s/iter; left time: 400.1870s
Epoch: 11 cost time: 7.862969636917114
Epoch: 11, Steps: 154 | Train Loss: 1.634 Vali Loss: 2.235 Vali Acc: 0.358 Test Loss: 2.235 Test Acc: 0.358
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5551378
	speed: 0.1801s/iter; left time: 509.2355s
Epoch: 12 cost time: 8.946501970291138
Epoch: 12, Steps: 154 | Train Loss: 1.630 Vali Loss: 2.287 Vali Acc: 0.356 Test Loss: 2.287 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4564732
	speed: 0.1796s/iter; left time: 480.1468s
Epoch: 13 cost time: 8.740684986114502
Epoch: 13, Steps: 154 | Train Loss: 1.550 Vali Loss: 2.073 Vali Acc: 0.266 Test Loss: 2.073 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 2.1248398
	speed: 0.1576s/iter; left time: 397.0278s
Epoch: 14 cost time: 6.901890277862549
Epoch: 14, Steps: 154 | Train Loss: 1.523 Vali Loss: 1.930 Vali Acc: 0.378 Test Loss: 1.930 Test Acc: 0.378
Validation loss decreased (-0.364131 --> -0.378326).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.4714113
	speed: 0.1542s/iter; left time: 364.7027s
Epoch: 15 cost time: 8.135623216629028
Epoch: 15, Steps: 154 | Train Loss: 1.528 Vali Loss: 1.956 Vali Acc: 0.374 Test Loss: 1.956 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1519959
	speed: 0.1830s/iter; left time: 404.6963s
Epoch: 16 cost time: 8.706467151641846
Epoch: 16, Steps: 154 | Train Loss: 1.487 Vali Loss: 2.023 Vali Acc: 0.376 Test Loss: 2.023 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.4854605
	speed: 0.1725s/iter; left time: 354.7530s
Epoch: 17 cost time: 7.429393768310547
Epoch: 17, Steps: 154 | Train Loss: 1.459 Vali Loss: 2.218 Vali Acc: 0.376 Test Loss: 2.218 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2080013
	speed: 0.1453s/iter; left time: 276.4881s
Epoch: 18 cost time: 6.370402097702026
Epoch: 18, Steps: 154 | Train Loss: 1.440 Vali Loss: 1.971 Vali Acc: 0.355 Test Loss: 1.971 Test Acc: 0.355
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.3561095
	speed: 0.1325s/iter; left time: 231.7730s
Epoch: 19 cost time: 6.725890636444092
Epoch: 19, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.126 Vali Acc: 0.379 Test Loss: 2.126 Test Acc: 0.379
Validation loss decreased (-0.378326 --> -0.379135).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.8214705
	speed: 0.1642s/iter; left time: 261.9018s
Epoch: 20 cost time: 7.868145227432251
Epoch: 20, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.240 Vali Acc: 0.372 Test Loss: 2.240 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.2117512
	speed: 0.1605s/iter; left time: 231.3254s
Epoch: 21 cost time: 7.674188613891602
Epoch: 21, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.052 Vali Acc: 0.380 Test Loss: 2.052 Test Acc: 0.380
Validation loss decreased (-0.379135 --> -0.379542).  Saving model ...
	iters: 100, epoch: 22 | loss: 1.9192678
	speed: 0.1444s/iter; left time: 185.8172s
Epoch: 22 cost time: 6.423918724060059
Epoch: 22, Steps: 154 | Train Loss: 1.373 Vali Loss: 2.029 Vali Acc: 0.403 Test Loss: 2.029 Test Acc: 0.403
Validation loss decreased (-0.379542 --> -0.403467).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.1346940
	speed: 0.1324s/iter; left time: 149.9709s
Epoch: 23 cost time: 6.564916133880615
Epoch: 23, Steps: 154 | Train Loss: 1.353 Vali Loss: 2.034 Vali Acc: 0.393 Test Loss: 2.034 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 1.2081048
	speed: 0.1539s/iter; left time: 150.6434s
Epoch: 24 cost time: 6.843040943145752
Epoch: 24, Steps: 154 | Train Loss: 1.325 Vali Loss: 2.187 Vali Acc: 0.375 Test Loss: 2.187 Test Acc: 0.375
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.4818928
	speed: 0.1686s/iter; left time: 139.0874s
Epoch: 25 cost time: 8.389178037643433
Epoch: 25, Steps: 154 | Train Loss: 1.326 Vali Loss: 2.290 Vali Acc: 0.396 Test Loss: 2.290 Test Acc: 0.396
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 1.2838650
	speed: 0.1673s/iter; left time: 112.2480s
Epoch: 26 cost time: 7.012570381164551
Epoch: 26, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.215 Vali Acc: 0.403 Test Loss: 2.215 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.7896845
	speed: 0.1535s/iter; left time: 79.3747s
Epoch: 27 cost time: 6.797733306884766
Epoch: 27, Steps: 154 | Train Loss: 1.297 Vali Loss: 1.838 Vali Acc: 0.388 Test Loss: 1.838 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.9619855
	speed: 0.1661s/iter; left time: 60.2768s
Epoch: 28 cost time: 8.077311515808105
Epoch: 28, Steps: 154 | Train Loss: 1.260 Vali Loss: 2.300 Vali Acc: 0.234 Test Loss: 2.300 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.1322329
	speed: 0.1707s/iter; left time: 35.6763s
Epoch: 29 cost time: 7.652494668960571
Epoch: 29, Steps: 154 | Train Loss: 1.258 Vali Loss: 2.085 Vali Acc: 0.408 Test Loss: 2.085 Test Acc: 0.408
Validation loss decreased (-0.403467 --> -0.407522).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.6575063
	speed: 0.1754s/iter; left time: 9.6479s
Epoch: 30 cost time: 7.458874464035034
Epoch: 30, Steps: 154 | Train Loss: 1.219 Vali Loss: 2.134 Vali Acc: 0.422 Test Loss: 2.134 Test Acc: 0.422
Validation loss decreased (-0.407522 --> -0.422120).  Saving model ...
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4221411192214112
model parameter : 590830
model size : 2.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1038773
	speed: 0.0574s/iter; left time: 259.4602s
Epoch: 1 cost time: 8.32797360420227
Epoch: 1, Steps: 154 | Train Loss: 2.310 Vali Loss: 2.110 Vali Acc: 0.315 Test Loss: 2.110 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8903873
	speed: 0.1544s/iter; left time: 674.2939s
Epoch: 2 cost time: 7.080779790878296
Epoch: 2, Steps: 154 | Train Loss: 2.070 Vali Loss: 2.099 Vali Acc: 0.316 Test Loss: 2.099 Test Acc: 0.316
Validation loss decreased (-0.315064 --> -0.316281).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1421638
	speed: 0.1523s/iter; left time: 641.8232s
Epoch: 3 cost time: 6.376564264297485
Epoch: 3, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.043 Vali Acc: 0.335 Test Loss: 2.043 Test Acc: 0.335
Validation loss decreased (-0.316281 --> -0.334529).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8321292
	speed: 0.1196s/iter; left time: 485.3475s
Epoch: 4 cost time: 5.199352264404297
Epoch: 4, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.124 Vali Acc: 0.330 Test Loss: 2.124 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9736904
	speed: 0.1278s/iter; left time: 499.2358s
Epoch: 5 cost time: 6.820348501205444
Epoch: 5, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.172 Vali Acc: 0.330 Test Loss: 2.172 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.7353830
	speed: 0.1494s/iter; left time: 560.3820s
Epoch: 6 cost time: 6.783381223678589
Epoch: 6, Steps: 154 | Train Loss: 1.810 Vali Loss: 2.111 Vali Acc: 0.329 Test Loss: 2.111 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 2.1336775
	speed: 0.1495s/iter; left time: 537.6754s
Epoch: 7 cost time: 7.028071165084839
Epoch: 7, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.153 Vali Acc: 0.346 Test Loss: 2.153 Test Acc: 0.346
Validation loss decreased (-0.334529 --> -0.346288).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3843904
	speed: 0.1461s/iter; left time: 503.0109s
Epoch: 8 cost time: 6.048788070678711
Epoch: 8, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.169 Vali Acc: 0.343 Test Loss: 2.169 Test Acc: 0.343
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4720526
	speed: 0.1400s/iter; left time: 460.4500s
Epoch: 9 cost time: 7.116470575332642
Epoch: 9, Steps: 154 | Train Loss: 1.709 Vali Loss: 2.180 Vali Acc: 0.337 Test Loss: 2.180 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.7096400
	speed: 0.1664s/iter; left time: 521.5282s
Epoch: 10 cost time: 7.541778087615967
Epoch: 10, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.237 Vali Acc: 0.331 Test Loss: 2.237 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4295307
	speed: 0.1633s/iter; left time: 486.8639s
Epoch: 11 cost time: 7.408789157867432
Epoch: 11, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.113 Vali Acc: 0.335 Test Loss: 2.113 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.9602294
	speed: 0.1603s/iter; left time: 453.2544s
Epoch: 12 cost time: 6.317915439605713
Epoch: 12, Steps: 154 | Train Loss: 1.640 Vali Loss: 2.049 Vali Acc: 0.341 Test Loss: 2.049 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2788620
	speed: 0.1361s/iter; left time: 363.7314s
Epoch: 13 cost time: 6.050794363021851
Epoch: 13, Steps: 154 | Train Loss: 1.615 Vali Loss: 2.079 Vali Acc: 0.343 Test Loss: 2.079 Test Acc: 0.343
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.5564799
	speed: 0.1442s/iter; left time: 363.2572s
Epoch: 14 cost time: 6.754348039627075
Epoch: 14, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.156 Vali Acc: 0.348 Test Loss: 2.156 Test Acc: 0.348
Validation loss decreased (-0.346288 --> -0.347505).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.3880682
	speed: 0.1499s/iter; left time: 354.4789s
Epoch: 15 cost time: 6.6941657066345215
Epoch: 15, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.121 Vali Acc: 0.345 Test Loss: 2.121 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.8985040
	speed: 0.1435s/iter; left time: 317.1765s
Epoch: 16 cost time: 5.681215286254883
Epoch: 16, Steps: 154 | Train Loss: 1.537 Vali Loss: 2.015 Vali Acc: 0.354 Test Loss: 2.015 Test Acc: 0.354
Validation loss decreased (-0.347505 --> -0.353994).  Saving model ...
	iters: 100, epoch: 17 | loss: 1.4964992
	speed: 0.1161s/iter; left time: 238.8162s
Epoch: 17 cost time: 5.660312652587891
Epoch: 17, Steps: 154 | Train Loss: 1.523 Vali Loss: 2.273 Vali Acc: 0.353 Test Loss: 2.273 Test Acc: 0.353
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 1.7785500
	speed: 0.1323s/iter; left time: 251.8256s
Epoch: 18 cost time: 6.630521535873413
Epoch: 18, Steps: 154 | Train Loss: 1.510 Vali Loss: 2.039 Vali Acc: 0.372 Test Loss: 2.039 Test Acc: 0.372
Validation loss decreased (-0.353994 --> -0.372242).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.6532385
	speed: 0.1438s/iter; left time: 251.4563s
Epoch: 19 cost time: 5.9343767166137695
Epoch: 19, Steps: 154 | Train Loss: 1.474 Vali Loss: 2.656 Vali Acc: 0.233 Test Loss: 2.656 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1827770
	speed: 0.1471s/iter; left time: 234.5906s
Epoch: 20 cost time: 6.7149927616119385
Epoch: 20, Steps: 154 | Train Loss: 1.450 Vali Loss: 2.129 Vali Acc: 0.368 Test Loss: 2.129 Test Acc: 0.368
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.9612909
	speed: 0.1215s/iter; left time: 175.0565s
Epoch: 21 cost time: 5.373719692230225
Epoch: 21, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.204 Vali Acc: 0.364 Test Loss: 2.204 Test Acc: 0.364
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.1797715
	speed: 0.1342s/iter; left time: 172.7578s
Epoch: 22 cost time: 6.431299448013306
Epoch: 22, Steps: 154 | Train Loss: 1.407 Vali Loss: 2.140 Vali Acc: 0.373 Test Loss: 2.140 Test Acc: 0.373
Validation loss decreased (-0.372242 --> -0.373458).  Saving model ...
	iters: 100, epoch: 23 | loss: 1.5695286
	speed: 0.0955s/iter; left time: 108.1689s
Epoch: 23 cost time: 4.0247962474823
Epoch: 23, Steps: 154 | Train Loss: 1.400 Vali Loss: 3.460 Vali Acc: 0.077 Test Loss: 3.460 Test Acc: 0.077
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.9187067
	speed: 0.0716s/iter; left time: 70.0527s
Epoch: 24 cost time: 4.645649433135986
Epoch: 24, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.650 Vali Acc: 0.336 Test Loss: 2.650 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 1.2327451
	speed: 0.1139s/iter; left time: 93.9557s
Epoch: 25 cost time: 5.412493944168091
Epoch: 25, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.281 Vali Acc: 0.359 Test Loss: 2.281 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.9475462
	speed: 0.1027s/iter; left time: 68.9370s
Epoch: 26 cost time: 4.923076391220093
Epoch: 26, Steps: 154 | Train Loss: 1.351 Vali Loss: 2.930 Vali Acc: 0.367 Test Loss: 2.930 Test Acc: 0.367
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 1.1979373
	speed: 0.1118s/iter; left time: 57.7941s
Epoch: 27 cost time: 5.620343208312988
Epoch: 27, Steps: 154 | Train Loss: 1.312 Vali Loss: 2.329 Vali Acc: 0.363 Test Loss: 2.329 Test Acc: 0.363
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 1.6105375
	speed: 0.1096s/iter; left time: 39.8023s
Epoch: 28 cost time: 4.9230077266693115
Epoch: 28, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.244 Vali Acc: 0.352 Test Loss: 2.244 Test Acc: 0.352
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 1.1183424
	speed: 0.0986s/iter; left time: 20.6115s
Epoch: 29 cost time: 4.898260831832886
Epoch: 29, Steps: 154 | Train Loss: 1.291 Vali Loss: 2.308 Vali Acc: 0.366 Test Loss: 2.308 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 1.2513418
	speed: 0.1061s/iter; left time: 5.8332s
Epoch: 30 cost time: 4.477612733840942
Epoch: 30, Steps: 154 | Train Loss: 1.286 Vali Loss: 2.270 Vali Acc: 0.345 Test Loss: 2.270 Test Acc: 0.345
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3734793187347932
model parameter : 176846
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7597015
	speed: 0.0733s/iter; left time: 331.3654s
Epoch: 1 cost time: 10.667832374572754
Epoch: 1, Steps: 154 | Train Loss: 2.217 Vali Loss: 2.153 Vali Acc: 0.315 Test Loss: 2.153 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8028864
	speed: 0.1752s/iter; left time: 764.9556s
Epoch: 2 cost time: 9.837437391281128
Epoch: 2, Steps: 154 | Train Loss: 2.059 Vali Loss: 2.124 Vali Acc: 0.319 Test Loss: 2.124 Test Acc: 0.319
Validation loss decreased (-0.314658 --> -0.318714).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6162112
	speed: 0.1805s/iter; left time: 760.5899s
Epoch: 3 cost time: 9.900140047073364
Epoch: 3, Steps: 154 | Train Loss: 1.979 Vali Loss: 2.136 Vali Acc: 0.326 Test Loss: 2.136 Test Acc: 0.326
Validation loss decreased (-0.318714 --> -0.326013).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1532819
	speed: 0.1926s/iter; left time: 781.7143s
Epoch: 4 cost time: 10.346560001373291
Epoch: 4, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.086 Vali Acc: 0.328 Test Loss: 2.086 Test Acc: 0.328
Validation loss decreased (-0.326013 --> -0.327635).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.2761171
	speed: 0.1916s/iter; left time: 748.2477s
Epoch: 5 cost time: 11.12933874130249
Epoch: 5, Steps: 154 | Train Loss: 1.853 Vali Loss: 2.123 Vali Acc: 0.336 Test Loss: 2.123 Test Acc: 0.336
Validation loss decreased (-0.327635 --> -0.336151).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7640338
	speed: 0.1858s/iter; left time: 697.0729s
Epoch: 6 cost time: 9.715656042098999
Epoch: 6, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.146 Vali Acc: 0.333 Test Loss: 2.146 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9036386
	speed: 0.1760s/iter; left time: 633.0178s
Epoch: 7 cost time: 9.549630165100098
Epoch: 7, Steps: 154 | Train Loss: 1.706 Vali Loss: 2.101 Vali Acc: 0.348 Test Loss: 2.101 Test Acc: 0.348
Validation loss decreased (-0.336151 --> -0.348316).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6217158
	speed: 0.1693s/iter; left time: 582.8072s
Epoch: 8 cost time: 9.467724084854126
Epoch: 8, Steps: 154 | Train Loss: 1.654 Vali Loss: 2.187 Vali Acc: 0.337 Test Loss: 2.187 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6424819
	speed: 0.1693s/iter; left time: 556.8536s
Epoch: 9 cost time: 8.078402519226074
Epoch: 9, Steps: 154 | Train Loss: 1.611 Vali Loss: 2.105 Vali Acc: 0.356 Test Loss: 2.105 Test Acc: 0.356
Validation loss decreased (-0.348316 --> -0.356427).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5113859
	speed: 0.1767s/iter; left time: 553.8923s
Epoch: 10 cost time: 10.123088836669922
Epoch: 10, Steps: 154 | Train Loss: 1.592 Vali Loss: 3.279 Vali Acc: 0.098 Test Loss: 3.279 Test Acc: 0.098
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5084276
	speed: 0.1825s/iter; left time: 543.9538s
Epoch: 11 cost time: 9.617713928222656
Epoch: 11, Steps: 154 | Train Loss: 1.546 Vali Loss: 2.648 Vali Acc: 0.071 Test Loss: 2.648 Test Acc: 0.071
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.2468706
	speed: 0.1715s/iter; left time: 484.8763s
Epoch: 12 cost time: 8.702675819396973
Epoch: 12, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.398 Vali Acc: 0.341 Test Loss: 2.398 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.7160403
	speed: 0.1864s/iter; left time: 498.3490s
Epoch: 13 cost time: 10.24973177909851
Epoch: 13, Steps: 154 | Train Loss: 1.514 Vali Loss: 2.982 Vali Acc: 0.101 Test Loss: 2.982 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.5622563
	speed: 0.1863s/iter; left time: 469.1995s
Epoch: 14 cost time: 10.119584560394287
Epoch: 14, Steps: 154 | Train Loss: 1.478 Vali Loss: 2.694 Vali Acc: 0.106 Test Loss: 2.694 Test Acc: 0.106
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3168471
	speed: 0.1909s/iter; left time: 451.5355s
Epoch: 15 cost time: 9.943304061889648
Epoch: 15, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.294 Vali Acc: 0.074 Test Loss: 3.294 Test Acc: 0.074
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.5003207
	speed: 0.1715s/iter; left time: 379.2092s
Epoch: 16 cost time: 9.169753074645996
Epoch: 16, Steps: 154 | Train Loss: 1.411 Vali Loss: 3.461 Vali Acc: 0.095 Test Loss: 3.461 Test Acc: 0.095
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.6751195
	speed: 0.1668s/iter; left time: 343.2011s
Epoch: 17 cost time: 8.600949764251709
Epoch: 17, Steps: 154 | Train Loss: 1.375 Vali Loss: 2.776 Vali Acc: 0.213 Test Loss: 2.776 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.2122048
	speed: 0.1724s/iter; left time: 328.0674s
Epoch: 18 cost time: 8.79085636138916
Epoch: 18, Steps: 154 | Train Loss: 1.359 Vali Loss: 2.750 Vali Acc: 0.153 Test Loss: 2.750 Test Acc: 0.153
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.0038034
	speed: 0.1612s/iter; left time: 282.0245s
Epoch: 19 cost time: 8.586044073104858
Epoch: 19, Steps: 154 | Train Loss: 1.337 Vali Loss: 2.185 Vali Acc: 0.391 Test Loss: 2.185 Test Acc: 0.391
Validation loss decreased (-0.356427 --> -0.390489).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.4015353
	speed: 0.1658s/iter; left time: 264.4005s
Epoch: 20 cost time: 8.302890539169312
Epoch: 20, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.763 Vali Acc: 0.082 Test Loss: 3.763 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.4118835
	speed: 0.1731s/iter; left time: 249.4665s
Epoch: 21 cost time: 9.650276184082031
Epoch: 21, Steps: 154 | Train Loss: 1.291 Vali Loss: 5.285 Vali Acc: 0.086 Test Loss: 5.285 Test Acc: 0.086
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.3312154
	speed: 0.1817s/iter; left time: 233.8954s
Epoch: 22 cost time: 10.107547760009766
Epoch: 22, Steps: 154 | Train Loss: 1.262 Vali Loss: 3.592 Vali Acc: 0.102 Test Loss: 3.592 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.3919382
	speed: 0.1821s/iter; left time: 206.3098s
Epoch: 23 cost time: 7.799914360046387
Epoch: 23, Steps: 154 | Train Loss: 1.236 Vali Loss: 2.768 Vali Acc: 0.147 Test Loss: 2.768 Test Acc: 0.147
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.0968972
	speed: 0.1791s/iter; left time: 175.3662s
Epoch: 24 cost time: 10.34115195274353
Epoch: 24, Steps: 154 | Train Loss: 1.237 Vali Loss: 6.535 Vali Acc: 0.119 Test Loss: 6.535 Test Acc: 0.119
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1923587
	speed: 0.1706s/iter; left time: 140.7652s
Epoch: 25 cost time: 8.781069040298462
Epoch: 25, Steps: 154 | Train Loss: 1.222 Vali Loss: 2.778 Vali Acc: 0.285 Test Loss: 2.778 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.9422657
	speed: 0.1667s/iter; left time: 111.8399s
Epoch: 26 cost time: 7.996263265609741
Epoch: 26, Steps: 154 | Train Loss: 1.196 Vali Loss: 5.040 Vali Acc: 0.093 Test Loss: 5.040 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.4205066
	speed: 0.1668s/iter; left time: 86.2488s
Epoch: 27 cost time: 8.934203624725342
Epoch: 27, Steps: 154 | Train Loss: 1.192 Vali Loss: 3.065 Vali Acc: 0.161 Test Loss: 3.065 Test Acc: 0.161
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.0973219
	speed: 0.1656s/iter; left time: 60.1275s
Epoch: 28 cost time: 8.37073040008545
Epoch: 28, Steps: 154 | Train Loss: 1.179 Vali Loss: 3.373 Vali Acc: 0.102 Test Loss: 3.373 Test Acc: 0.102
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.9088320
	speed: 0.1736s/iter; left time: 36.2742s
Epoch: 29 cost time: 9.027016639709473
Epoch: 29, Steps: 154 | Train Loss: 1.149 Vali Loss: 3.967 Vali Acc: 0.106 Test Loss: 3.967 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3905109489051095
model parameter : 297582
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7015365
	speed: 0.0636s/iter; left time: 287.7217s
Epoch: 1 cost time: 9.247027158737183
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.125 Vali Acc: 0.315 Test Loss: 2.125 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0651591
	speed: 0.1668s/iter; left time: 728.4639s
Epoch: 2 cost time: 8.88871431350708
Epoch: 2, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.115 Vali Acc: 0.319 Test Loss: 2.115 Test Acc: 0.319
Validation loss decreased (-0.314658 --> -0.318714).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3852832
	speed: 0.1583s/iter; left time: 667.0104s
Epoch: 3 cost time: 7.942632675170898
Epoch: 3, Steps: 154 | Train Loss: 1.996 Vali Loss: 2.076 Vali Acc: 0.329 Test Loss: 2.076 Test Acc: 0.329
Validation loss decreased (-0.318714 --> -0.329257).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9816686
	speed: 0.1190s/iter; left time: 483.1396s
Epoch: 4 cost time: 7.151432514190674
Epoch: 4, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.081 Vali Acc: 0.334 Test Loss: 2.081 Test Acc: 0.334
Validation loss decreased (-0.329257 --> -0.334124).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7273902
	speed: 0.1802s/iter; left time: 703.5812s
Epoch: 5 cost time: 8.986196994781494
Epoch: 5, Steps: 154 | Train Loss: 1.828 Vali Loss: 2.039 Vali Acc: 0.346 Test Loss: 2.039 Test Acc: 0.346
Validation loss decreased (-0.334124 --> -0.345884).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7882066
	speed: 0.1674s/iter; left time: 627.7737s
Epoch: 6 cost time: 7.7791666984558105
Epoch: 6, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.088 Vali Acc: 0.352 Test Loss: 2.088 Test Acc: 0.352
Validation loss decreased (-0.345884 --> -0.351966).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0466938
	speed: 0.1780s/iter; left time: 640.2363s
Epoch: 7 cost time: 8.871995449066162
Epoch: 7, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.145 Vali Acc: 0.363 Test Loss: 2.145 Test Acc: 0.363
Validation loss decreased (-0.351966 --> -0.362914).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6269255
	speed: 0.1646s/iter; left time: 566.5554s
Epoch: 8 cost time: 7.596816062927246
Epoch: 8, Steps: 154 | Train Loss: 1.645 Vali Loss: 2.157 Vali Acc: 0.361 Test Loss: 2.157 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.2827215
	speed: 0.1771s/iter; left time: 582.5303s
Epoch: 9 cost time: 8.85127878189087
Epoch: 9, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.356 Vali Acc: 0.365 Test Loss: 2.356 Test Acc: 0.365
Validation loss decreased (-0.362914 --> -0.364940).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8105798
	speed: 0.1722s/iter; left time: 539.9498s
Epoch: 10 cost time: 8.805827140808105
Epoch: 10, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.301 Vali Acc: 0.373 Test Loss: 2.301 Test Acc: 0.373
Validation loss decreased (-0.364940 --> -0.372645).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0163776
	speed: 0.2014s/iter; left time: 600.3270s
Epoch: 11 cost time: 10.128317594528198
Epoch: 11, Steps: 154 | Train Loss: 1.500 Vali Loss: 2.115 Vali Acc: 0.398 Test Loss: 2.115 Test Acc: 0.398
Validation loss decreased (-0.372645 --> -0.397789).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.6990921
	speed: 0.1877s/iter; left time: 530.5953s
Epoch: 12 cost time: 8.884573221206665
Epoch: 12, Steps: 154 | Train Loss: 1.480 Vali Loss: 2.104 Vali Acc: 0.379 Test Loss: 2.104 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5226735
	speed: 0.1866s/iter; left time: 498.7369s
Epoch: 13 cost time: 10.131838083267212
Epoch: 13, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.343 Vali Acc: 0.377 Test Loss: 2.343 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2222704
	speed: 0.1982s/iter; left time: 499.1613s
Epoch: 14 cost time: 9.177042245864868
Epoch: 14, Steps: 154 | Train Loss: 1.410 Vali Loss: 2.377 Vali Acc: 0.219 Test Loss: 2.377 Test Acc: 0.219
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.5498837
	speed: 0.1772s/iter; left time: 419.0351s
Epoch: 15 cost time: 9.270057916641235
Epoch: 15, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.664 Vali Acc: 0.376 Test Loss: 2.664 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.1340930
	speed: 0.1757s/iter; left time: 388.3890s
Epoch: 16 cost time: 7.838109731674194
Epoch: 16, Steps: 154 | Train Loss: 1.364 Vali Loss: 2.574 Vali Acc: 0.221 Test Loss: 2.574 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.1597875
	speed: 0.1675s/iter; left time: 344.5163s
Epoch: 17 cost time: 9.0908203125
Epoch: 17, Steps: 154 | Train Loss: 1.334 Vali Loss: 2.915 Vali Acc: 0.217 Test Loss: 2.915 Test Acc: 0.217
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 1.3611711
	speed: 0.1775s/iter; left time: 337.7238s
Epoch: 18 cost time: 8.248491048812866
Epoch: 18, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.236 Vali Acc: 0.395 Test Loss: 2.236 Test Acc: 0.395
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.1901753
	speed: 0.1687s/iter; left time: 295.1141s
Epoch: 19 cost time: 9.05765962600708
Epoch: 19, Steps: 154 | Train Loss: 1.288 Vali Loss: 2.473 Vali Acc: 0.356 Test Loss: 2.473 Test Acc: 0.356
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0393996
	speed: 0.1828s/iter; left time: 291.6372s
Epoch: 20 cost time: 8.775879621505737
Epoch: 20, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.797 Vali Acc: 0.113 Test Loss: 2.797 Test Acc: 0.113
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.1414104
	speed: 0.1736s/iter; left time: 250.2013s
Epoch: 21 cost time: 10.041861772537231
Epoch: 21, Steps: 154 | Train Loss: 1.287 Vali Loss: 2.763 Vali Acc: 0.154 Test Loss: 2.763 Test Acc: 0.154
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3978102189781022
model parameter : 90574
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7592770
	speed: 0.0613s/iter; left time: 277.2372s
Epoch: 1 cost time: 9.661818742752075
Epoch: 1, Steps: 154 | Train Loss: 2.216 Vali Loss: 2.151 Vali Acc: 0.315 Test Loss: 2.151 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8139893
	speed: 0.1971s/iter; left time: 860.7937s
Epoch: 2 cost time: 10.227603912353516
Epoch: 2, Steps: 154 | Train Loss: 2.064 Vali Loss: 2.120 Vali Acc: 0.318 Test Loss: 2.120 Test Acc: 0.318
Validation loss decreased (-0.314658 --> -0.318308).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6364518
	speed: 0.1682s/iter; left time: 708.7182s
Epoch: 3 cost time: 7.828341960906982
Epoch: 3, Steps: 154 | Train Loss: 1.982 Vali Loss: 2.110 Vali Acc: 0.327 Test Loss: 2.110 Test Acc: 0.327
Validation loss decreased (-0.318308 --> -0.326824).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1922221
	speed: 0.1741s/iter; left time: 706.4945s
Epoch: 4 cost time: 9.19641900062561
Epoch: 4, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.126 Vali Acc: 0.322 Test Loss: 2.126 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.2032695
	speed: 0.1693s/iter; left time: 660.9559s
Epoch: 5 cost time: 8.178995370864868
Epoch: 5, Steps: 154 | Train Loss: 1.855 Vali Loss: 2.146 Vali Acc: 0.333 Test Loss: 2.146 Test Acc: 0.333
Validation loss decreased (-0.326824 --> -0.333312).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7827406
	speed: 0.1687s/iter; left time: 632.8719s
Epoch: 6 cost time: 9.356075048446655
Epoch: 6, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.152 Vali Acc: 0.328 Test Loss: 2.152 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9868926
	speed: 0.1709s/iter; left time: 614.8032s
Epoch: 7 cost time: 7.2646872997283936
Epoch: 7, Steps: 154 | Train Loss: 1.725 Vali Loss: 2.191 Vali Acc: 0.341 Test Loss: 2.191 Test Acc: 0.341
Validation loss decreased (-0.333312 --> -0.341422).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6882960
	speed: 0.1430s/iter; left time: 492.2474s
Epoch: 8 cost time: 8.273344039916992
Epoch: 8, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.200 Vali Acc: 0.335 Test Loss: 2.200 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7347362
	speed: 0.1796s/iter; left time: 590.7282s
Epoch: 9 cost time: 9.584822654724121
Epoch: 9, Steps: 154 | Train Loss: 1.617 Vali Loss: 2.160 Vali Acc: 0.351 Test Loss: 2.160 Test Acc: 0.351
Validation loss decreased (-0.341422 --> -0.351154).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4608922
	speed: 0.1628s/iter; left time: 510.4359s
Epoch: 10 cost time: 9.279221773147583
Epoch: 10, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.061 Vali Acc: 0.361 Test Loss: 2.061 Test Acc: 0.361
Validation loss decreased (-0.351154 --> -0.360482).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5398549
	speed: 0.1945s/iter; left time: 579.9007s
Epoch: 11 cost time: 10.192689180374146
Epoch: 11, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.344 Vali Acc: 0.322 Test Loss: 2.344 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1879833
	speed: 0.1723s/iter; left time: 487.0802s
Epoch: 12 cost time: 8.63830280303955
Epoch: 12, Steps: 154 | Train Loss: 1.525 Vali Loss: 2.345 Vali Acc: 0.301 Test Loss: 2.345 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.6704633
	speed: 0.1958s/iter; left time: 523.3643s
Epoch: 13 cost time: 10.145366907119751
Epoch: 13, Steps: 154 | Train Loss: 1.506 Vali Loss: 2.153 Vali Acc: 0.346 Test Loss: 2.153 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.6128426
	speed: 0.1806s/iter; left time: 454.9468s
Epoch: 14 cost time: 7.751110076904297
Epoch: 14, Steps: 154 | Train Loss: 1.488 Vali Loss: 2.547 Vali Acc: 0.148 Test Loss: 2.547 Test Acc: 0.148
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.4334220
	speed: 0.1609s/iter; left time: 380.6081s
Epoch: 15 cost time: 8.248485326766968
Epoch: 15, Steps: 154 | Train Loss: 1.446 Vali Loss: 2.531 Vali Acc: 0.244 Test Loss: 2.531 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5779861
	speed: 0.1668s/iter; left time: 368.8989s
Epoch: 16 cost time: 8.085474014282227
Epoch: 16, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.434 Vali Acc: 0.298 Test Loss: 2.434 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.6349165
	speed: 0.1585s/iter; left time: 326.0528s
Epoch: 17 cost time: 9.122751712799072
Epoch: 17, Steps: 154 | Train Loss: 1.372 Vali Loss: 3.315 Vali Acc: 0.083 Test Loss: 3.315 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3816010
	speed: 0.1796s/iter; left time: 341.8697s
Epoch: 18 cost time: 8.68013310432434
Epoch: 18, Steps: 154 | Train Loss: 1.370 Vali Loss: 2.830 Vali Acc: 0.170 Test Loss: 2.830 Test Acc: 0.170
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9850076
	speed: 0.1579s/iter; left time: 276.1523s
Epoch: 19 cost time: 8.467065811157227
Epoch: 19, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.224 Vali Acc: 0.379 Test Loss: 2.224 Test Acc: 0.379
Validation loss decreased (-0.360482 --> -0.378729).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.2419134
	speed: 0.1908s/iter; left time: 304.3643s
Epoch: 20 cost time: 10.179226636886597
Epoch: 20, Steps: 154 | Train Loss: 1.332 Vali Loss: 3.100 Vali Acc: 0.109 Test Loss: 3.100 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 1.3494833
	speed: 0.1649s/iter; left time: 237.6331s
Epoch: 21 cost time: 8.617111921310425
Epoch: 21, Steps: 154 | Train Loss: 1.288 Vali Loss: 3.841 Vali Acc: 0.098 Test Loss: 3.841 Test Acc: 0.098
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 1.2394966
	speed: 0.1917s/iter; left time: 246.6549s
Epoch: 22 cost time: 10.049262762069702
Epoch: 22, Steps: 154 | Train Loss: 1.283 Vali Loss: 4.772 Vali Acc: 0.120 Test Loss: 4.772 Test Acc: 0.120
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 1.4694152
	speed: 0.1758s/iter; left time: 199.1351s
Epoch: 23 cost time: 8.40989065170288
Epoch: 23, Steps: 154 | Train Loss: 1.247 Vali Loss: 2.114 Vali Acc: 0.368 Test Loss: 2.114 Test Acc: 0.368
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 1.0982273
	speed: 0.1792s/iter; left time: 175.4241s
Epoch: 24 cost time: 9.784215927124023
Epoch: 24, Steps: 154 | Train Loss: 1.240 Vali Loss: 8.717 Vali Acc: 0.125 Test Loss: 8.717 Test Acc: 0.125
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 1.1382350
	speed: 0.1784s/iter; left time: 147.1996s
Epoch: 25 cost time: 7.993762016296387
Epoch: 25, Steps: 154 | Train Loss: 1.214 Vali Loss: 3.535 Vali Acc: 0.169 Test Loss: 3.535 Test Acc: 0.169
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.8517411
	speed: 0.1632s/iter; left time: 109.5036s
Epoch: 26 cost time: 9.073071002960205
Epoch: 26, Steps: 154 | Train Loss: 1.204 Vali Loss: 2.876 Vali Acc: 0.175 Test Loss: 2.876 Test Acc: 0.175
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 1.4802614
	speed: 0.1796s/iter; left time: 92.8615s
Epoch: 27 cost time: 8.298262357711792
Epoch: 27, Steps: 154 | Train Loss: 1.177 Vali Loss: 3.821 Vali Acc: 0.109 Test Loss: 3.821 Test Acc: 0.109
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 1.1254319
	speed: 0.1545s/iter; left time: 56.0674s
Epoch: 28 cost time: 8.855181217193604
Epoch: 28, Steps: 154 | Train Loss: 1.165 Vali Loss: 3.052 Vali Acc: 0.093 Test Loss: 3.052 Test Acc: 0.093
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 1.0048301
	speed: 0.1796s/iter; left time: 37.5276s
Epoch: 29 cost time: 9.044440746307373
Epoch: 29, Steps: 154 | Train Loss: 1.142 Vali Loss: 3.895 Vali Acc: 0.106 Test Loss: 3.895 Test Acc: 0.106
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37875101378751014
model parameter : 297582
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7086619
	speed: 0.0449s/iter; left time: 202.8710s
Epoch: 1 cost time: 6.7199366092681885
Epoch: 1, Steps: 154 | Train Loss: 2.213 Vali Loss: 2.126 Vali Acc: 0.315 Test Loss: 2.126 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0646634
	speed: 0.1171s/iter; left time: 511.5629s
Epoch: 2 cost time: 5.65000057220459
Epoch: 2, Steps: 154 | Train Loss: 2.073 Vali Loss: 2.117 Vali Acc: 0.318 Test Loss: 2.117 Test Acc: 0.318
Validation loss decreased (-0.314658 --> -0.317903).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3912148
	speed: 0.1032s/iter; left time: 434.6606s
Epoch: 3 cost time: 6.072447776794434
Epoch: 3, Steps: 154 | Train Loss: 2.003 Vali Loss: 2.079 Vali Acc: 0.330 Test Loss: 2.079 Test Acc: 0.330
Validation loss decreased (-0.317903 --> -0.329663).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9904915
	speed: 0.1364s/iter; left time: 553.6380s
Epoch: 4 cost time: 8.272011756896973
Epoch: 4, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.064 Vali Acc: 0.335 Test Loss: 2.064 Test Acc: 0.335
Validation loss decreased (-0.329663 --> -0.334935).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7249765
	speed: 0.1650s/iter; left time: 644.4535s
Epoch: 5 cost time: 7.26470422744751
Epoch: 5, Steps: 154 | Train Loss: 1.825 Vali Loss: 2.039 Vali Acc: 0.344 Test Loss: 2.039 Test Acc: 0.344
Validation loss decreased (-0.334935 --> -0.343856).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8764018
	speed: 0.1628s/iter; left time: 610.5111s
Epoch: 6 cost time: 8.497085571289062
Epoch: 6, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.076 Vali Acc: 0.351 Test Loss: 2.076 Test Acc: 0.351
Validation loss decreased (-0.343856 --> -0.351155).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0379848
	speed: 0.1639s/iter; left time: 589.6327s
Epoch: 7 cost time: 7.630245923995972
Epoch: 7, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.141 Vali Acc: 0.361 Test Loss: 2.141 Test Acc: 0.361
Validation loss decreased (-0.351155 --> -0.361292).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6615397
	speed: 0.1687s/iter; left time: 580.7586s
Epoch: 8 cost time: 8.020374059677124
Epoch: 8, Steps: 154 | Train Loss: 1.659 Vali Loss: 2.096 Vali Acc: 0.358 Test Loss: 2.096 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4760075
	speed: 0.1618s/iter; left time: 532.1748s
Epoch: 9 cost time: 8.603793144226074
Epoch: 9, Steps: 154 | Train Loss: 1.604 Vali Loss: 2.313 Vali Acc: 0.365 Test Loss: 2.313 Test Acc: 0.365
Validation loss decreased (-0.361292 --> -0.364940).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8263525
	speed: 0.1714s/iter; left time: 537.2812s
Epoch: 10 cost time: 7.393019199371338
Epoch: 10, Steps: 154 | Train Loss: 1.576 Vali Loss: 2.275 Vali Acc: 0.373 Test Loss: 2.275 Test Acc: 0.373
Validation loss decreased (-0.364940 --> -0.373051).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1295437
	speed: 0.1638s/iter; left time: 488.2619s
Epoch: 11 cost time: 8.156360864639282
Epoch: 11, Steps: 154 | Train Loss: 1.511 Vali Loss: 1.995 Vali Acc: 0.388 Test Loss: 1.995 Test Acc: 0.388
Validation loss decreased (-0.373051 --> -0.388463).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.7536049
	speed: 0.1593s/iter; left time: 450.2583s
Epoch: 12 cost time: 7.257932186126709
Epoch: 12, Steps: 154 | Train Loss: 1.484 Vali Loss: 2.203 Vali Acc: 0.380 Test Loss: 2.203 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4845483
	speed: 0.1678s/iter; left time: 448.5562s
Epoch: 13 cost time: 8.175286293029785
Epoch: 13, Steps: 154 | Train Loss: 1.453 Vali Loss: 2.357 Vali Acc: 0.377 Test Loss: 2.357 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.2721666
	speed: 0.1515s/iter; left time: 381.5704s
Epoch: 14 cost time: 6.905432224273682
Epoch: 14, Steps: 154 | Train Loss: 1.420 Vali Loss: 2.481 Vali Acc: 0.220 Test Loss: 2.481 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.5249689
	speed: 0.1535s/iter; left time: 363.0227s
Epoch: 15 cost time: 6.865559339523315
Epoch: 15, Steps: 154 | Train Loss: 1.399 Vali Loss: 2.409 Vali Acc: 0.390 Test Loss: 2.409 Test Acc: 0.390
Validation loss decreased (-0.388463 --> -0.389676).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1065887
	speed: 0.1375s/iter; left time: 304.1219s
Epoch: 16 cost time: 6.937739372253418
Epoch: 16, Steps: 154 | Train Loss: 1.354 Vali Loss: 2.728 Vali Acc: 0.208 Test Loss: 2.728 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.1319246
	speed: 0.1427s/iter; left time: 293.4453s
Epoch: 17 cost time: 6.331916093826294
Epoch: 17, Steps: 154 | Train Loss: 1.344 Vali Loss: 2.676 Vali Acc: 0.217 Test Loss: 2.676 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.4538299
	speed: 0.1508s/iter; left time: 286.9561s
Epoch: 18 cost time: 7.19611668586731
Epoch: 18, Steps: 154 | Train Loss: 1.323 Vali Loss: 2.139 Vali Acc: 0.393 Test Loss: 2.139 Test Acc: 0.393
Validation loss decreased (-0.389676 --> -0.393328).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.2398440
	speed: 0.1406s/iter; left time: 245.9129s
Epoch: 19 cost time: 6.570138931274414
Epoch: 19, Steps: 154 | Train Loss: 1.291 Vali Loss: 2.417 Vali Acc: 0.300 Test Loss: 2.417 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1440374
	speed: 0.1507s/iter; left time: 240.3071s
Epoch: 20 cost time: 6.2165350914001465
Epoch: 20, Steps: 154 | Train Loss: 1.274 Vali Loss: 2.816 Vali Acc: 0.140 Test Loss: 2.816 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.2464861
	speed: 0.1472s/iter; left time: 212.0796s
Epoch: 21 cost time: 7.563304662704468
Epoch: 21, Steps: 154 | Train Loss: 1.275 Vali Loss: 2.375 Vali Acc: 0.318 Test Loss: 2.375 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4125187
	speed: 0.1520s/iter; left time: 195.5696s
Epoch: 22 cost time: 6.679481744766235
Epoch: 22, Steps: 154 | Train Loss: 1.231 Vali Loss: 2.469 Vali Acc: 0.312 Test Loss: 2.469 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.9549149
	speed: 0.1599s/iter; left time: 181.1124s
Epoch: 23 cost time: 7.29329514503479
Epoch: 23, Steps: 154 | Train Loss: 1.221 Vali Loss: 3.303 Vali Acc: 0.094 Test Loss: 3.303 Test Acc: 0.094
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.4906071
	speed: 0.1455s/iter; left time: 142.4534s
Epoch: 24 cost time: 7.209167242050171
Epoch: 24, Steps: 154 | Train Loss: 1.192 Vali Loss: 2.393 Vali Acc: 0.390 Test Loss: 2.393 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.3184290
	speed: 0.1554s/iter; left time: 128.2205s
Epoch: 25 cost time: 6.5352208614349365
Epoch: 25, Steps: 154 | Train Loss: 1.170 Vali Loss: 3.679 Vali Acc: 0.096 Test Loss: 3.679 Test Acc: 0.096
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.5073636
	speed: 0.1558s/iter; left time: 104.5609s
Epoch: 26 cost time: 8.016195297241211
Epoch: 26, Steps: 154 | Train Loss: 1.174 Vali Loss: 3.426 Vali Acc: 0.118 Test Loss: 3.426 Test Acc: 0.118
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.3910975
	speed: 0.1601s/iter; left time: 82.7813s
Epoch: 27 cost time: 7.699822425842285
Epoch: 27, Steps: 154 | Train Loss: 1.141 Vali Loss: 2.382 Vali Acc: 0.359 Test Loss: 2.382 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.9298360
	speed: 0.1717s/iter; left time: 62.3214s
Epoch: 28 cost time: 7.583708763122559
Epoch: 28, Steps: 154 | Train Loss: 1.139 Vali Loss: 2.926 Vali Acc: 0.214 Test Loss: 2.926 Test Acc: 0.214
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3933495539334955
model parameter : 90574
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7776153
	speed: 0.0639s/iter; left time: 288.7297s
Epoch: 1 cost time: 8.899904727935791
Epoch: 1, Steps: 154 | Train Loss: 2.230 Vali Loss: 2.130 Vali Acc: 0.315 Test Loss: 2.130 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8626420
	speed: 0.1596s/iter; left time: 696.8088s
Epoch: 2 cost time: 8.607982873916626
Epoch: 2, Steps: 154 | Train Loss: 2.076 Vali Loss: 2.122 Vali Acc: 0.316 Test Loss: 2.122 Test Acc: 0.316
Validation loss decreased (-0.314658 --> -0.315875).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6512864
	speed: 0.1602s/iter; left time: 674.8213s
Epoch: 3 cost time: 7.270726203918457
Epoch: 3, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.097 Vali Acc: 0.324 Test Loss: 2.097 Test Acc: 0.324
Validation loss decreased (-0.315875 --> -0.323986).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.2765179
	speed: 0.1339s/iter; left time: 543.6763s
Epoch: 4 cost time: 5.755566835403442
Epoch: 4, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.132 Vali Acc: 0.327 Test Loss: 2.132 Test Acc: 0.327
Validation loss decreased (-0.323986 --> -0.327229).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3409698
	speed: 0.1709s/iter; left time: 667.2667s
Epoch: 5 cost time: 9.740520477294922
Epoch: 5, Steps: 154 | Train Loss: 1.901 Vali Loss: 2.141 Vali Acc: 0.329 Test Loss: 2.141 Test Acc: 0.329
Validation loss decreased (-0.327229 --> -0.329257).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7376881
	speed: 0.2018s/iter; left time: 756.9341s
Epoch: 6 cost time: 9.66329312324524
Epoch: 6, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.098 Vali Acc: 0.329 Test Loss: 2.098 Test Acc: 0.329
Validation loss decreased (-0.329257 --> -0.329257).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.0061724
	speed: 0.1954s/iter; left time: 702.7291s
Epoch: 7 cost time: 8.751226425170898
Epoch: 7, Steps: 154 | Train Loss: 1.778 Vali Loss: 2.112 Vali Acc: 0.339 Test Loss: 2.112 Test Acc: 0.339
Validation loss decreased (-0.329257 --> -0.338584).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.5725747
	speed: 0.1745s/iter; left time: 600.8848s
Epoch: 8 cost time: 7.881839275360107
Epoch: 8, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.129 Vali Acc: 0.340 Test Loss: 2.129 Test Acc: 0.340
Validation loss decreased (-0.338584 --> -0.340206).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7431362
	speed: 0.1717s/iter; left time: 564.6505s
Epoch: 9 cost time: 8.208016157150269
Epoch: 9, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.214 Vali Acc: 0.342 Test Loss: 2.214 Test Acc: 0.342
Validation loss decreased (-0.340206 --> -0.342233).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.7397037
	speed: 0.1732s/iter; left time: 542.9100s
Epoch: 10 cost time: 8.069893836975098
Epoch: 10, Steps: 154 | Train Loss: 1.639 Vali Loss: 2.086 Vali Acc: 0.348 Test Loss: 2.086 Test Acc: 0.348
Validation loss decreased (-0.342233 --> -0.348317).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.9844352
	speed: 0.1746s/iter; left time: 520.4438s
Epoch: 11 cost time: 7.661592960357666
Epoch: 11, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.113 Vali Acc: 0.206 Test Loss: 2.113 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0438292
	speed: 0.1658s/iter; left time: 468.7911s
Epoch: 12 cost time: 7.42698073387146
Epoch: 12, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.247 Vali Acc: 0.344 Test Loss: 2.247 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7287900
	speed: 0.1675s/iter; left time: 447.6900s
Epoch: 13 cost time: 8.436259031295776
Epoch: 13, Steps: 154 | Train Loss: 1.579 Vali Loss: 2.102 Vali Acc: 0.350 Test Loss: 2.102 Test Acc: 0.350
Validation loss decreased (-0.348317 --> -0.350344).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.5570538
	speed: 0.1781s/iter; left time: 448.5178s
Epoch: 14 cost time: 8.185025691986084
Epoch: 14, Steps: 154 | Train Loss: 1.505 Vali Loss: 2.208 Vali Acc: 0.367 Test Loss: 2.208 Test Acc: 0.367
Validation loss decreased (-0.350344 --> -0.366969).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.1846232
	speed: 0.1686s/iter; left time: 398.6803s
Epoch: 15 cost time: 7.681348562240601
Epoch: 15, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.265 Vali Acc: 0.359 Test Loss: 2.265 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.5732119
	speed: 0.1658s/iter; left time: 366.6444s
Epoch: 16 cost time: 7.675224542617798
Epoch: 16, Steps: 154 | Train Loss: 1.457 Vali Loss: 2.322 Vali Acc: 0.358 Test Loss: 2.322 Test Acc: 0.358
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.6615613
	speed: 0.1698s/iter; left time: 349.2655s
Epoch: 17 cost time: 8.097797632217407
Epoch: 17, Steps: 154 | Train Loss: 1.416 Vali Loss: 2.058 Vali Acc: 0.368 Test Loss: 2.058 Test Acc: 0.368
Validation loss decreased (-0.366969 --> -0.367782).  Saving model ...
	iters: 100, epoch: 18 | loss: 1.1435524
	speed: 0.1734s/iter; left time: 329.9873s
Epoch: 18 cost time: 7.5944249629974365
Epoch: 18, Steps: 154 | Train Loss: 1.406 Vali Loss: 2.450 Vali Acc: 0.371 Test Loss: 2.450 Test Acc: 0.371
Validation loss decreased (-0.367782 --> -0.371427).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.9422866
	speed: 0.1686s/iter; left time: 294.8393s
Epoch: 19 cost time: 7.4004456996917725
Epoch: 19, Steps: 154 | Train Loss: 1.380 Vali Loss: 2.542 Vali Acc: 0.387 Test Loss: 2.542 Test Acc: 0.387
Validation loss decreased (-0.371427 --> -0.386836).  Saving model ...
	iters: 100, epoch: 20 | loss: 1.3815238
	speed: 0.1682s/iter; left time: 268.2745s
Epoch: 20 cost time: 7.698403596878052
Epoch: 20, Steps: 154 | Train Loss: 1.413 Vali Loss: 2.220 Vali Acc: 0.388 Test Loss: 2.220 Test Acc: 0.388
Validation loss decreased (-0.386836 --> -0.387650).  Saving model ...
	iters: 100, epoch: 21 | loss: 1.4158735
	speed: 0.1671s/iter; left time: 240.8282s
Epoch: 21 cost time: 8.07561707496643
Epoch: 21, Steps: 154 | Train Loss: 1.332 Vali Loss: 2.215 Vali Acc: 0.384 Test Loss: 2.215 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 1.3787988
	speed: 0.1766s/iter; left time: 227.3179s
Epoch: 22 cost time: 8.493093252182007
Epoch: 22, Steps: 154 | Train Loss: 1.330 Vali Loss: 2.465 Vali Acc: 0.353 Test Loss: 2.465 Test Acc: 0.353
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 1.4350498
	speed: 0.1903s/iter; left time: 215.6615s
Epoch: 23 cost time: 8.360298156738281
Epoch: 23, Steps: 154 | Train Loss: 1.358 Vali Loss: 2.331 Vali Acc: 0.387 Test Loss: 2.331 Test Acc: 0.387
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 1.1305126
	speed: 0.1860s/iter; left time: 182.0630s
Epoch: 24 cost time: 8.588642358779907
Epoch: 24, Steps: 154 | Train Loss: 1.293 Vali Loss: 2.553 Vali Acc: 0.354 Test Loss: 2.553 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 1.3559215
	speed: 0.1837s/iter; left time: 151.5218s
Epoch: 25 cost time: 8.695542573928833
Epoch: 25, Steps: 154 | Train Loss: 1.296 Vali Loss: 2.236 Vali Acc: 0.410 Test Loss: 2.236 Test Acc: 0.410
Validation loss decreased (-0.387650 --> -0.409953).  Saving model ...
	iters: 100, epoch: 26 | loss: 1.0929102
	speed: 0.1874s/iter; left time: 125.7672s
Epoch: 26 cost time: 8.458618402481079
Epoch: 26, Steps: 154 | Train Loss: 1.260 Vali Loss: 2.948 Vali Acc: 0.168 Test Loss: 2.948 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 1.3445635
	speed: 0.1865s/iter; left time: 96.4019s
Epoch: 27 cost time: 8.517026901245117
Epoch: 27, Steps: 154 | Train Loss: 1.236 Vali Loss: 2.347 Vali Acc: 0.377 Test Loss: 2.347 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 1.0963072
	speed: 0.1859s/iter; left time: 67.4921s
Epoch: 28 cost time: 8.232728481292725
Epoch: 28, Steps: 154 | Train Loss: 1.243 Vali Loss: 2.439 Vali Acc: 0.352 Test Loss: 2.439 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 1.2375252
	speed: 0.1855s/iter; left time: 38.7798s
Epoch: 29 cost time: 8.658004999160767
Epoch: 29, Steps: 154 | Train Loss: 1.227 Vali Loss: 2.502 Vali Acc: 0.391 Test Loss: 2.502 Test Acc: 0.391
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 2.4995313
	speed: 0.1897s/iter; left time: 10.4343s
Epoch: 30 cost time: 8.609866380691528
Epoch: 30, Steps: 154 | Train Loss: 1.209 Vali Loss: 2.729 Vali Acc: 0.361 Test Loss: 2.729 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4099756690997567
model parameter : 297582
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7064319
	speed: 0.0635s/iter; left time: 286.8888s
Epoch: 1 cost time: 9.271519660949707
Epoch: 1, Steps: 154 | Train Loss: 2.219 Vali Loss: 2.123 Vali Acc: 0.315 Test Loss: 2.123 Test Acc: 0.315
Validation loss decreased (inf --> -0.314658).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0627780
	speed: 0.1789s/iter; left time: 781.1238s
Epoch: 2 cost time: 8.081278085708618
Epoch: 2, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.111 Vali Acc: 0.318 Test Loss: 2.111 Test Acc: 0.318
Validation loss decreased (-0.314658 --> -0.317497).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3814039
	speed: 0.1776s/iter; left time: 748.2746s
Epoch: 3 cost time: 7.7676825523376465
Epoch: 3, Steps: 154 | Train Loss: 2.011 Vali Loss: 2.067 Vali Acc: 0.326 Test Loss: 2.067 Test Acc: 0.326
Validation loss decreased (-0.317497 --> -0.325608).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0182931
	speed: 0.1679s/iter; left time: 681.3478s
Epoch: 4 cost time: 7.697057247161865
Epoch: 4, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.073 Vali Acc: 0.330 Test Loss: 2.073 Test Acc: 0.330
Validation loss decreased (-0.325608 --> -0.329663).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8049166
	speed: 0.1600s/iter; left time: 624.7009s
Epoch: 5 cost time: 6.783130407333374
Epoch: 5, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.037 Vali Acc: 0.338 Test Loss: 2.037 Test Acc: 0.338
Validation loss decreased (-0.329663 --> -0.338179).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8464780
	speed: 0.1590s/iter; left time: 596.4092s
Epoch: 6 cost time: 6.526898384094238
Epoch: 6, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.025 Vali Acc: 0.349 Test Loss: 2.025 Test Acc: 0.349
Validation loss decreased (-0.338179 --> -0.348723).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9679235
	speed: 0.1597s/iter; left time: 574.6151s
Epoch: 7 cost time: 7.427783966064453
Epoch: 7, Steps: 154 | Train Loss: 1.755 Vali Loss: 2.130 Vali Acc: 0.359 Test Loss: 2.130 Test Acc: 0.359
Validation loss decreased (-0.348723 --> -0.359265).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7105759
	speed: 0.1595s/iter; left time: 549.1261s
Epoch: 8 cost time: 6.867059946060181
Epoch: 8, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.049 Vali Acc: 0.362 Test Loss: 2.049 Test Acc: 0.362
Validation loss decreased (-0.359265 --> -0.362104).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.2707458
	speed: 0.1584s/iter; left time: 520.8544s
Epoch: 9 cost time: 6.627383232116699
Epoch: 9, Steps: 154 | Train Loss: 1.651 Vali Loss: 2.346 Vali Acc: 0.185 Test Loss: 2.346 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8397890
	speed: 0.1564s/iter; left time: 490.1922s
Epoch: 10 cost time: 6.581982374191284
Epoch: 10, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.067 Vali Acc: 0.389 Test Loss: 2.067 Test Acc: 0.389
Validation loss decreased (-0.362104 --> -0.388868).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1203916
	speed: 0.1606s/iter; left time: 478.6630s
Epoch: 11 cost time: 7.223436117172241
Epoch: 11, Steps: 154 | Train Loss: 1.543 Vali Loss: 2.244 Vali Acc: 0.206 Test Loss: 2.244 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.8788903
	speed: 0.1642s/iter; left time: 464.0542s
Epoch: 12 cost time: 7.488763809204102
Epoch: 12, Steps: 154 | Train Loss: 1.524 Vali Loss: 2.250 Vali Acc: 0.351 Test Loss: 2.250 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.7094438
	speed: 0.1633s/iter; left time: 436.5373s
Epoch: 13 cost time: 7.169557571411133
Epoch: 13, Steps: 154 | Train Loss: 1.493 Vali Loss: 2.283 Vali Acc: 0.290 Test Loss: 2.283 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3263040
	speed: 0.1569s/iter; left time: 395.1958s
Epoch: 14 cost time: 6.848526477813721
Epoch: 14, Steps: 154 | Train Loss: 1.455 Vali Loss: 2.263 Vali Acc: 0.223 Test Loss: 2.263 Test Acc: 0.223
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5422883
	speed: 0.1596s/iter; left time: 377.3633s
Epoch: 15 cost time: 7.343789339065552
Epoch: 15, Steps: 154 | Train Loss: 1.444 Vali Loss: 2.452 Vali Acc: 0.235 Test Loss: 2.452 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.0459027
	speed: 0.1616s/iter; left time: 357.1974s
Epoch: 16 cost time: 6.935426235198975
Epoch: 16, Steps: 154 | Train Loss: 1.417 Vali Loss: 2.417 Vali Acc: 0.200 Test Loss: 2.417 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.3750334
	speed: 0.1618s/iter; left time: 332.8586s
Epoch: 17 cost time: 6.6656060218811035
Epoch: 17, Steps: 154 | Train Loss: 1.401 Vali Loss: 2.368 Vali Acc: 0.245 Test Loss: 2.368 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.5082442
	speed: 0.1649s/iter; left time: 313.8763s
Epoch: 18 cost time: 7.934709548950195
Epoch: 18, Steps: 154 | Train Loss: 1.387 Vali Loss: 2.361 Vali Acc: 0.418 Test Loss: 2.361 Test Acc: 0.418
Validation loss decreased (-0.388868 --> -0.418062).  Saving model ...
	iters: 100, epoch: 19 | loss: 1.3602519
	speed: 0.1759s/iter; left time: 307.7066s
Epoch: 19 cost time: 8.016918659210205
Epoch: 19, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.439 Vali Acc: 0.106 Test Loss: 3.439 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 1.1072457
	speed: 0.1793s/iter; left time: 285.9747s
Epoch: 20 cost time: 7.8795928955078125
Epoch: 20, Steps: 154 | Train Loss: 1.360 Vali Loss: 3.374 Vali Acc: 0.121 Test Loss: 3.374 Test Acc: 0.121
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 1.1620924
	speed: 0.1806s/iter; left time: 260.1908s
Epoch: 21 cost time: 8.015527725219727
Epoch: 21, Steps: 154 | Train Loss: 1.347 Vali Loss: 2.804 Vali Acc: 0.154 Test Loss: 2.804 Test Acc: 0.154
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 1.4176077
	speed: 0.1742s/iter; left time: 224.1603s
Epoch: 22 cost time: 7.679969072341919
Epoch: 22, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.620 Vali Acc: 0.394 Test Loss: 2.620 Test Acc: 0.394
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.9650996
	speed: 0.1762s/iter; left time: 199.6746s
Epoch: 23 cost time: 7.85897421836853
Epoch: 23, Steps: 154 | Train Loss: 1.350 Vali Loss: 2.870 Vali Acc: 0.182 Test Loss: 2.870 Test Acc: 0.182
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 1.7283885
	speed: 0.1807s/iter; left time: 176.9054s
Epoch: 24 cost time: 7.970056772232056
Epoch: 24, Steps: 154 | Train Loss: 1.310 Vali Loss: 2.942 Vali Acc: 0.221 Test Loss: 2.942 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 1.4295754
	speed: 0.1827s/iter; left time: 150.7191s
Epoch: 25 cost time: 7.979556560516357
Epoch: 25, Steps: 154 | Train Loss: 1.298 Vali Loss: 2.831 Vali Acc: 0.210 Test Loss: 2.831 Test Acc: 0.210
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 1.6155561
	speed: 0.1774s/iter; left time: 119.0205s
Epoch: 26 cost time: 7.711705923080444
Epoch: 26, Steps: 154 | Train Loss: 1.280 Vali Loss: 3.611 Vali Acc: 0.177 Test Loss: 3.611 Test Acc: 0.177
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 2.1343384
	speed: 0.1760s/iter; left time: 90.9706s
Epoch: 27 cost time: 7.521640062332153
Epoch: 27, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.342 Vali Acc: 0.112 Test Loss: 3.342 Test Acc: 0.112
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 1.0645862
	speed: 0.1771s/iter; left time: 64.2738s
Epoch: 28 cost time: 7.825446844100952
Epoch: 28, Steps: 154 | Train Loss: 1.278 Vali Loss: 3.463 Vali Acc: 0.199 Test Loss: 3.463 Test Acc: 0.199
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.4180859691808597
model parameter : 90574
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9708388
	speed: 0.0893s/iter; left time: 403.8527s
Epoch: 1 cost time: 13.114158868789673
Epoch: 1, Steps: 154 | Train Loss: 2.268 Vali Loss: 2.117 Vali Acc: 0.316 Test Loss: 2.117 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1923773
	speed: 0.2443s/iter; left time: 1066.7448s
Epoch: 2 cost time: 12.652943849563599
Epoch: 2, Steps: 154 | Train Loss: 2.040 Vali Loss: 2.075 Vali Acc: 0.322 Test Loss: 2.075 Test Acc: 0.322
Validation loss decreased (-0.315875 --> -0.321553).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4676203
	speed: 0.2496s/iter; left time: 1051.6492s
Epoch: 3 cost time: 12.9746572971344
Epoch: 3, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.090 Vali Acc: 0.326 Test Loss: 2.090 Test Acc: 0.326
Validation loss decreased (-0.321553 --> -0.326013).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9436892
	speed: 0.2435s/iter; left time: 988.1998s
Epoch: 4 cost time: 11.562812328338623
Epoch: 4, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.115 Vali Acc: 0.334 Test Loss: 2.115 Test Acc: 0.334
Validation loss decreased (-0.326013 --> -0.334123).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7563705
	speed: 0.2435s/iter; left time: 950.9841s
Epoch: 5 cost time: 12.688590049743652
Epoch: 5, Steps: 154 | Train Loss: 1.768 Vali Loss: 2.291 Vali Acc: 0.315 Test Loss: 2.291 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4615004
	speed: 0.2419s/iter; left time: 907.3496s
Epoch: 6 cost time: 11.86368179321289
Epoch: 6, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.289 Vali Acc: 0.174 Test Loss: 2.289 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.1155078
	speed: 0.2340s/iter; left time: 841.5753s
Epoch: 7 cost time: 11.486791133880615
Epoch: 7, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.053 Vali Acc: 0.358 Test Loss: 2.053 Test Acc: 0.358
Validation loss decreased (-0.334123 --> -0.357644).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0738643
	speed: 0.2361s/iter; left time: 812.9183s
Epoch: 8 cost time: 12.21885061264038
Epoch: 8, Steps: 154 | Train Loss: 1.628 Vali Loss: 2.610 Vali Acc: 0.097 Test Loss: 2.610 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6942226
	speed: 0.2422s/iter; left time: 796.4626s
Epoch: 9 cost time: 12.499952554702759
Epoch: 9, Steps: 154 | Train Loss: 1.582 Vali Loss: 2.762 Vali Acc: 0.202 Test Loss: 2.762 Test Acc: 0.202
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2606115
	speed: 0.2346s/iter; left time: 735.5039s
Epoch: 10 cost time: 10.955774068832397
Epoch: 10, Steps: 154 | Train Loss: 1.555 Vali Loss: 2.321 Vali Acc: 0.209 Test Loss: 2.321 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1208842
	speed: 0.2333s/iter; left time: 695.4527s
Epoch: 11 cost time: 12.518132448196411
Epoch: 11, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.170 Vali Acc: 0.064 Test Loss: 3.170 Test Acc: 0.064
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2781689
	speed: 0.2560s/iter; left time: 723.6990s
Epoch: 12 cost time: 13.20075798034668
Epoch: 12, Steps: 154 | Train Loss: 1.499 Vali Loss: 2.307 Vali Acc: 0.223 Test Loss: 2.307 Test Acc: 0.223
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4326855
	speed: 0.2561s/iter; left time: 684.4701s
Epoch: 13 cost time: 12.68484354019165
Epoch: 13, Steps: 154 | Train Loss: 1.481 Vali Loss: 2.229 Vali Acc: 0.213 Test Loss: 2.229 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4881115
	speed: 0.2560s/iter; left time: 644.7393s
Epoch: 14 cost time: 12.461684226989746
Epoch: 14, Steps: 154 | Train Loss: 1.433 Vali Loss: 2.270 Vali Acc: 0.206 Test Loss: 2.270 Test Acc: 0.206
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0867485
	speed: 0.2006s/iter; left time: 474.3535s
Epoch: 15 cost time: 11.309321403503418
Epoch: 15, Steps: 154 | Train Loss: 1.431 Vali Loss: 2.274 Vali Acc: 0.251 Test Loss: 2.274 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4959754
	speed: 0.2148s/iter; left time: 474.9438s
Epoch: 16 cost time: 10.874834060668945
Epoch: 16, Steps: 154 | Train Loss: 1.412 Vali Loss: 2.780 Vali Acc: 0.208 Test Loss: 2.780 Test Acc: 0.208
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.3547989
	speed: 0.2160s/iter; left time: 444.3271s
Epoch: 17 cost time: 11.549665212631226
Epoch: 17, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.084 Vali Acc: 0.081 Test Loss: 3.084 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35766423357664234
model parameter : 150958
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0670357
	speed: 0.0729s/iter; left time: 329.6161s
Epoch: 1 cost time: 10.648579359054565
Epoch: 1, Steps: 154 | Train Loss: 2.264 Vali Loss: 2.116 Vali Acc: 0.315 Test Loss: 2.116 Test Acc: 0.315
Validation loss decreased (inf --> -0.315470).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8227617
	speed: 0.1946s/iter; left time: 849.8220s
Epoch: 2 cost time: 9.723177433013916
Epoch: 2, Steps: 154 | Train Loss: 2.054 Vali Loss: 2.098 Vali Acc: 0.324 Test Loss: 2.098 Test Acc: 0.324
Validation loss decreased (-0.315470 --> -0.323986).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6355789
	speed: 0.1780s/iter; left time: 749.8129s
Epoch: 3 cost time: 8.4086012840271
Epoch: 3, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.104 Vali Acc: 0.334 Test Loss: 2.104 Test Acc: 0.334
Validation loss decreased (-0.323986 --> -0.334123).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7003247
	speed: 0.1771s/iter; left time: 718.9963s
Epoch: 4 cost time: 8.892101764678955
Epoch: 4, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.093 Vali Acc: 0.339 Test Loss: 2.093 Test Acc: 0.339
Validation loss decreased (-0.334123 --> -0.338584).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7131116
	speed: 0.1735s/iter; left time: 677.5737s
Epoch: 5 cost time: 7.934753179550171
Epoch: 5, Steps: 154 | Train Loss: 1.803 Vali Loss: 2.104 Vali Acc: 0.352 Test Loss: 2.104 Test Acc: 0.352
Validation loss decreased (-0.338584 --> -0.351966).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0135429
	speed: 0.1749s/iter; left time: 656.0823s
Epoch: 6 cost time: 8.888987302780151
Epoch: 6, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.099 Vali Acc: 0.345 Test Loss: 2.099 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.5545559
	speed: 0.1706s/iter; left time: 613.6391s
Epoch: 7 cost time: 7.782145023345947
Epoch: 7, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.089 Vali Acc: 0.366 Test Loss: 2.089 Test Acc: 0.366
Validation loss decreased (-0.351966 --> -0.366159).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1388688
	speed: 0.1772s/iter; left time: 610.0352s
Epoch: 8 cost time: 9.063412427902222
Epoch: 8, Steps: 154 | Train Loss: 1.638 Vali Loss: 2.121 Vali Acc: 0.355 Test Loss: 2.121 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5612333
	speed: 0.1747s/iter; left time: 574.6468s
Epoch: 9 cost time: 8.129383563995361
Epoch: 9, Steps: 154 | Train Loss: 1.602 Vali Loss: 2.572 Vali Acc: 0.105 Test Loss: 2.572 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5276971
	speed: 0.1738s/iter; left time: 544.9345s
Epoch: 10 cost time: 8.681611061096191
Epoch: 10, Steps: 154 | Train Loss: 1.563 Vali Loss: 2.177 Vali Acc: 0.261 Test Loss: 2.177 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.1501718
	speed: 0.1806s/iter; left time: 538.2898s
Epoch: 11 cost time: 8.928349018096924
Epoch: 11, Steps: 154 | Train Loss: 1.532 Vali Loss: 2.376 Vali Acc: 0.096 Test Loss: 2.376 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7615904
	speed: 0.1760s/iter; left time: 497.6577s
Epoch: 12 cost time: 9.11905574798584
Epoch: 12, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.532 Vali Acc: 0.097 Test Loss: 2.532 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1793889
	speed: 0.1848s/iter; left time: 494.0131s
Epoch: 13 cost time: 9.188579082489014
Epoch: 13, Steps: 154 | Train Loss: 1.494 Vali Loss: 2.800 Vali Acc: 0.103 Test Loss: 2.800 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2353264
	speed: 0.1842s/iter; left time: 463.8843s
Epoch: 14 cost time: 8.658889532089233
Epoch: 14, Steps: 154 | Train Loss: 1.462 Vali Loss: 3.289 Vali Acc: 0.114 Test Loss: 3.289 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 2.4908729
	speed: 0.1868s/iter; left time: 441.7099s
Epoch: 15 cost time: 9.185786724090576
Epoch: 15, Steps: 154 | Train Loss: 1.442 Vali Loss: 3.320 Vali Acc: 0.082 Test Loss: 3.320 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3657489
	speed: 0.1829s/iter; left time: 404.4490s
Epoch: 16 cost time: 8.538352966308594
Epoch: 16, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.093 Vali Acc: 0.116 Test Loss: 3.093 Test Acc: 0.116
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.4733891
	speed: 0.1833s/iter; left time: 377.1344s
Epoch: 17 cost time: 9.20070195198059
Epoch: 17, Steps: 154 | Train Loss: 1.393 Vali Loss: 4.104 Vali Acc: 0.086 Test Loss: 4.104 Test Acc: 0.086
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3661800486618005
model parameter : 47438
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9691199
	speed: 0.0744s/iter; left time: 336.5054s
Epoch: 1 cost time: 10.915010690689087
Epoch: 1, Steps: 154 | Train Loss: 2.271 Vali Loss: 2.116 Vali Acc: 0.316 Test Loss: 2.116 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1909609
	speed: 0.1858s/iter; left time: 811.5061s
Epoch: 2 cost time: 10.148923635482788
Epoch: 2, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.080 Vali Acc: 0.321 Test Loss: 2.080 Test Acc: 0.321
Validation loss decreased (-0.315875 --> -0.321147).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4541360
	speed: 0.1867s/iter; left time: 786.3661s
Epoch: 3 cost time: 9.345892429351807
Epoch: 3, Steps: 154 | Train Loss: 1.950 Vali Loss: 2.077 Vali Acc: 0.330 Test Loss: 2.077 Test Acc: 0.330
Validation loss decreased (-0.321147 --> -0.329663).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9662265
	speed: 0.1666s/iter; left time: 676.2614s
Epoch: 4 cost time: 9.072869062423706
Epoch: 4, Steps: 154 | Train Loss: 1.844 Vali Loss: 2.108 Vali Acc: 0.333 Test Loss: 2.108 Test Acc: 0.333
Validation loss decreased (-0.329663 --> -0.332907).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7676164
	speed: 0.1598s/iter; left time: 624.0997s
Epoch: 5 cost time: 8.113068103790283
Epoch: 5, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.195 Vali Acc: 0.238 Test Loss: 2.195 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.4558784
	speed: 0.1611s/iter; left time: 604.3505s
Epoch: 6 cost time: 8.72723126411438
Epoch: 6, Steps: 154 | Train Loss: 1.722 Vali Loss: 2.253 Vali Acc: 0.195 Test Loss: 2.253 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2456656
	speed: 0.1634s/iter; left time: 587.8835s
Epoch: 7 cost time: 8.396708965301514
Epoch: 7, Steps: 154 | Train Loss: 1.675 Vali Loss: 2.060 Vali Acc: 0.365 Test Loss: 2.060 Test Acc: 0.365
Validation loss decreased (-0.332907 --> -0.365348).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0671297
	speed: 0.1665s/iter; left time: 573.2879s
Epoch: 8 cost time: 8.706459045410156
Epoch: 8, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.314 Vali Acc: 0.184 Test Loss: 2.314 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7480527
	speed: 0.1560s/iter; left time: 513.1384s
Epoch: 9 cost time: 7.741246938705444
Epoch: 9, Steps: 154 | Train Loss: 1.591 Vali Loss: 2.495 Vali Acc: 0.207 Test Loss: 2.495 Test Acc: 0.207
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3039290
	speed: 0.1605s/iter; left time: 503.2605s
Epoch: 10 cost time: 8.015689373016357
Epoch: 10, Steps: 154 | Train Loss: 1.561 Vali Loss: 2.253 Vali Acc: 0.210 Test Loss: 2.253 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.1561602
	speed: 0.1531s/iter; left time: 456.5085s
Epoch: 11 cost time: 8.096927881240845
Epoch: 11, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.117 Vali Acc: 0.067 Test Loss: 3.117 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2785796
	speed: 0.1650s/iter; left time: 466.5404s
Epoch: 12 cost time: 8.551358461380005
Epoch: 12, Steps: 154 | Train Loss: 1.496 Vali Loss: 2.298 Vali Acc: 0.356 Test Loss: 2.298 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3879107
	speed: 0.1638s/iter; left time: 437.9146s
Epoch: 13 cost time: 8.200955629348755
Epoch: 13, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.112 Vali Acc: 0.340 Test Loss: 2.112 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.5528964
	speed: 0.1583s/iter; left time: 398.8523s
Epoch: 14 cost time: 8.766812086105347
Epoch: 14, Steps: 154 | Train Loss: 1.426 Vali Loss: 2.237 Vali Acc: 0.299 Test Loss: 2.237 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1407828
	speed: 0.1719s/iter; left time: 406.4503s
Epoch: 15 cost time: 9.247238874435425
Epoch: 15, Steps: 154 | Train Loss: 1.422 Vali Loss: 2.555 Vali Acc: 0.086 Test Loss: 2.555 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4636253
	speed: 0.1815s/iter; left time: 401.2880s
Epoch: 16 cost time: 9.6426100730896
Epoch: 16, Steps: 154 | Train Loss: 1.408 Vali Loss: 2.130 Vali Acc: 0.216 Test Loss: 2.130 Test Acc: 0.216
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.3356379
	speed: 0.1788s/iter; left time: 367.7537s
Epoch: 17 cost time: 9.37818694114685
Epoch: 17, Steps: 154 | Train Loss: 1.367 Vali Loss: 3.863 Vali Acc: 0.074 Test Loss: 3.863 Test Acc: 0.074
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3653690186536902
model parameter : 150958
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0662520
	speed: 0.0659s/iter; left time: 297.9160s
Epoch: 1 cost time: 9.466984510421753
Epoch: 1, Steps: 154 | Train Loss: 2.266 Vali Loss: 2.116 Vali Acc: 0.316 Test Loss: 2.116 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8237531
	speed: 0.1619s/iter; left time: 707.1704s
Epoch: 2 cost time: 7.855247497558594
Epoch: 2, Steps: 154 | Train Loss: 2.058 Vali Loss: 2.098 Vali Acc: 0.323 Test Loss: 2.098 Test Acc: 0.323
Validation loss decreased (-0.315875 --> -0.322769).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6483405
	speed: 0.1583s/iter; left time: 666.8632s
Epoch: 3 cost time: 7.885781764984131
Epoch: 3, Steps: 154 | Train Loss: 1.971 Vali Loss: 2.099 Vali Acc: 0.335 Test Loss: 2.099 Test Acc: 0.335
Validation loss decreased (-0.322769 --> -0.335340).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7342651
	speed: 0.1579s/iter; left time: 641.0117s
Epoch: 4 cost time: 7.520833253860474
Epoch: 4, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.094 Vali Acc: 0.338 Test Loss: 2.094 Test Acc: 0.338
Validation loss decreased (-0.335340 --> -0.337773).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7741534
	speed: 0.1578s/iter; left time: 616.2366s
Epoch: 5 cost time: 7.793910503387451
Epoch: 5, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.104 Vali Acc: 0.357 Test Loss: 2.104 Test Acc: 0.357
Validation loss decreased (-0.337773 --> -0.356832).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0131128
	speed: 0.1585s/iter; left time: 594.3530s
Epoch: 6 cost time: 7.908912658691406
Epoch: 6, Steps: 154 | Train Loss: 1.743 Vali Loss: 2.122 Vali Acc: 0.347 Test Loss: 2.122 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6034321
	speed: 0.1551s/iter; left time: 557.9278s
Epoch: 7 cost time: 6.8863019943237305
Epoch: 7, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.088 Vali Acc: 0.364 Test Loss: 2.088 Test Acc: 0.364
Validation loss decreased (-0.356832 --> -0.364132).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1098359
	speed: 0.1442s/iter; left time: 496.4856s
Epoch: 8 cost time: 7.0893237590789795
Epoch: 8, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.096 Vali Acc: 0.352 Test Loss: 2.096 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5094635
	speed: 0.1395s/iter; left time: 458.8775s
Epoch: 9 cost time: 6.990601301193237
Epoch: 9, Steps: 154 | Train Loss: 1.600 Vali Loss: 2.197 Vali Acc: 0.084 Test Loss: 2.197 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5274769
	speed: 0.1447s/iter; left time: 453.4873s
Epoch: 10 cost time: 7.066116809844971
Epoch: 10, Steps: 154 | Train Loss: 1.558 Vali Loss: 2.146 Vali Acc: 0.323 Test Loss: 2.146 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 2.1079290
	speed: 0.1448s/iter; left time: 431.6410s
Epoch: 11 cost time: 7.209640979766846
Epoch: 11, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.389 Vali Acc: 0.107 Test Loss: 2.389 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.9053034
	speed: 0.1418s/iter; left time: 400.8743s
Epoch: 12 cost time: 6.69396185874939
Epoch: 12, Steps: 154 | Train Loss: 1.482 Vali Loss: 2.137 Vali Acc: 0.323 Test Loss: 2.137 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0896660
	speed: 0.1392s/iter; left time: 372.1971s
Epoch: 13 cost time: 7.011637449264526
Epoch: 13, Steps: 154 | Train Loss: 1.486 Vali Loss: 2.635 Vali Acc: 0.110 Test Loss: 2.635 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3402874
	speed: 0.1391s/iter; left time: 350.3604s
Epoch: 14 cost time: 6.77945613861084
Epoch: 14, Steps: 154 | Train Loss: 1.461 Vali Loss: 2.852 Vali Acc: 0.114 Test Loss: 2.852 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 2.6737719
	speed: 0.1412s/iter; left time: 333.8702s
Epoch: 15 cost time: 6.5864245891571045
Epoch: 15, Steps: 154 | Train Loss: 1.439 Vali Loss: 3.045 Vali Acc: 0.084 Test Loss: 3.045 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.3654732
	speed: 0.1449s/iter; left time: 320.2673s
Epoch: 16 cost time: 7.551118612289429
Epoch: 16, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.845 Vali Acc: 0.106 Test Loss: 2.845 Test Acc: 0.106
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.3973788
	speed: 0.1404s/iter; left time: 288.7179s
Epoch: 17 cost time: 6.868139982223511
Epoch: 17, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.633 Vali Acc: 0.082 Test Loss: 3.633 Test Acc: 0.082
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36415247364152475
model parameter : 47438
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9823259
	speed: 0.0560s/iter; left time: 253.0493s
Epoch: 1 cost time: 8.281487941741943
Epoch: 1, Steps: 154 | Train Loss: 2.285 Vali Loss: 2.121 Vali Acc: 0.315 Test Loss: 2.121 Test Acc: 0.315
Validation loss decreased (inf --> -0.315064).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1592348
	speed: 0.1541s/iter; left time: 673.0369s
Epoch: 2 cost time: 7.400363206863403
Epoch: 2, Steps: 154 | Train Loss: 2.053 Vali Loss: 2.103 Vali Acc: 0.322 Test Loss: 2.103 Test Acc: 0.322
Validation loss decreased (-0.315064 --> -0.321958).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.5401644
	speed: 0.1552s/iter; left time: 654.0440s
Epoch: 3 cost time: 8.032861232757568
Epoch: 3, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.101 Vali Acc: 0.333 Test Loss: 2.101 Test Acc: 0.333
Validation loss decreased (-0.321958 --> -0.333312).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9194405
	speed: 0.1561s/iter; left time: 633.6669s
Epoch: 4 cost time: 7.581060409545898
Epoch: 4, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.137 Vali Acc: 0.333 Test Loss: 2.137 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8201381
	speed: 0.1528s/iter; left time: 596.5910s
Epoch: 5 cost time: 7.2271997928619385
Epoch: 5, Steps: 154 | Train Loss: 1.802 Vali Loss: 1.985 Vali Acc: 0.344 Test Loss: 1.985 Test Acc: 0.344
Validation loss decreased (-0.333312 --> -0.344262).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4364846
	speed: 0.1512s/iter; left time: 567.0456s
Epoch: 6 cost time: 7.625438451766968
Epoch: 6, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.058 Vali Acc: 0.361 Test Loss: 2.058 Test Acc: 0.361
Validation loss decreased (-0.344262 --> -0.360888).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4736066
	speed: 0.1538s/iter; left time: 553.0396s
Epoch: 7 cost time: 7.39802622795105
Epoch: 7, Steps: 154 | Train Loss: 1.694 Vali Loss: 2.346 Vali Acc: 0.180 Test Loss: 2.346 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2904435
	speed: 0.1547s/iter; left time: 532.5869s
Epoch: 8 cost time: 7.771198272705078
Epoch: 8, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.723 Vali Acc: 0.115 Test Loss: 2.723 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 2.0315413
	speed: 0.1591s/iter; left time: 523.2647s
Epoch: 9 cost time: 7.911475419998169
Epoch: 9, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.479 Vali Acc: 0.188 Test Loss: 2.479 Test Acc: 0.188
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3286557
	speed: 0.1520s/iter; left time: 476.4850s
Epoch: 10 cost time: 7.012348175048828
Epoch: 10, Steps: 154 | Train Loss: 1.599 Vali Loss: 2.283 Vali Acc: 0.367 Test Loss: 2.283 Test Acc: 0.367
Validation loss decreased (-0.360888 --> -0.366563).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1413186
	speed: 0.1489s/iter; left time: 443.9750s
Epoch: 11 cost time: 7.340948104858398
Epoch: 11, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.198 Vali Acc: 0.200 Test Loss: 2.198 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3135808
	speed: 0.1462s/iter; left time: 413.3514s
Epoch: 12 cost time: 6.612121105194092
Epoch: 12, Steps: 154 | Train Loss: 1.519 Vali Loss: 2.416 Vali Acc: 0.373 Test Loss: 2.416 Test Acc: 0.373
Validation loss decreased (-0.366563 --> -0.373050).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.3065197
	speed: 0.1339s/iter; left time: 357.8349s
Epoch: 13 cost time: 6.1129679679870605
Epoch: 13, Steps: 154 | Train Loss: 1.501 Vali Loss: 2.157 Vali Acc: 0.382 Test Loss: 2.157 Test Acc: 0.382
Validation loss decreased (-0.373050 --> -0.382379).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.7483954
	speed: 0.1280s/iter; left time: 322.3132s
Epoch: 14 cost time: 6.339670419692993
Epoch: 14, Steps: 154 | Train Loss: 1.476 Vali Loss: 2.103 Vali Acc: 0.391 Test Loss: 2.103 Test Acc: 0.391
Validation loss decreased (-0.382379 --> -0.391301).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.0497291
	speed: 0.1320s/iter; left time: 312.0777s
Epoch: 15 cost time: 6.2810914516448975
Epoch: 15, Steps: 154 | Train Loss: 1.463 Vali Loss: 2.275 Vali Acc: 0.395 Test Loss: 2.275 Test Acc: 0.395
Validation loss decreased (-0.391301 --> -0.395354).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.5769112
	speed: 0.1297s/iter; left time: 286.7938s
Epoch: 16 cost time: 5.791041374206543
Epoch: 16, Steps: 154 | Train Loss: 1.437 Vali Loss: 2.235 Vali Acc: 0.389 Test Loss: 2.235 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3951114
	speed: 0.1191s/iter; left time: 245.0384s
Epoch: 17 cost time: 5.0775792598724365
Epoch: 17, Steps: 154 | Train Loss: 1.391 Vali Loss: 2.375 Vali Acc: 0.377 Test Loss: 2.375 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.5370007
	speed: 0.1400s/iter; left time: 266.4034s
Epoch: 18 cost time: 7.604671955108643
Epoch: 18, Steps: 154 | Train Loss: 1.396 Vali Loss: 2.934 Vali Acc: 0.291 Test Loss: 2.934 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.3245171
	speed: 0.1613s/iter; left time: 282.1324s
Epoch: 19 cost time: 7.538689613342285
Epoch: 19, Steps: 154 | Train Loss: 1.371 Vali Loss: 2.384 Vali Acc: 0.382 Test Loss: 2.384 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.8167122
	speed: 0.1577s/iter; left time: 251.5909s
Epoch: 20 cost time: 6.873147487640381
Epoch: 20, Steps: 154 | Train Loss: 1.352 Vali Loss: 2.296 Vali Acc: 0.389 Test Loss: 2.296 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.5667623
	speed: 0.1561s/iter; left time: 224.9216s
Epoch: 21 cost time: 7.411155462265015
Epoch: 21, Steps: 154 | Train Loss: 1.333 Vali Loss: 2.235 Vali Acc: 0.236 Test Loss: 2.235 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.0421997
	speed: 0.1619s/iter; left time: 208.3701s
Epoch: 22 cost time: 7.657354116439819
Epoch: 22, Steps: 154 | Train Loss: 1.296 Vali Loss: 2.384 Vali Acc: 0.375 Test Loss: 2.384 Test Acc: 0.375
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.3415351
	speed: 0.1579s/iter; left time: 178.9554s
Epoch: 23 cost time: 6.814651012420654
Epoch: 23, Steps: 154 | Train Loss: 1.274 Vali Loss: 4.474 Vali Acc: 0.098 Test Loss: 4.474 Test Acc: 0.098
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.2194594
	speed: 0.1573s/iter; left time: 153.9630s
Epoch: 24 cost time: 7.726038932800293
Epoch: 24, Steps: 154 | Train Loss: 1.269 Vali Loss: 3.165 Vali Acc: 0.171 Test Loss: 3.165 Test Acc: 0.171
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 1.0136172
	speed: 0.1633s/iter; left time: 134.7461s
Epoch: 25 cost time: 7.563341856002808
Epoch: 25, Steps: 154 | Train Loss: 1.251 Vali Loss: 3.159 Vali Acc: 0.099 Test Loss: 3.159 Test Acc: 0.099
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3953771289537713
model parameter : 150958
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1021683
	speed: 0.0611s/iter; left time: 276.3028s
Epoch: 1 cost time: 8.294643878936768
Epoch: 1, Steps: 154 | Train Loss: 2.279 Vali Loss: 2.112 Vali Acc: 0.316 Test Loss: 2.112 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8196943
	speed: 0.1719s/iter; left time: 750.8575s
Epoch: 2 cost time: 8.12994933128357
Epoch: 2, Steps: 154 | Train Loss: 2.073 Vali Loss: 2.109 Vali Acc: 0.320 Test Loss: 2.109 Test Acc: 0.320
Validation loss decreased (-0.315875 --> -0.319525).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7406456
	speed: 0.1765s/iter; left time: 743.7926s
Epoch: 3 cost time: 7.980741024017334
Epoch: 3, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.069 Vali Acc: 0.330 Test Loss: 2.069 Test Acc: 0.330
Validation loss decreased (-0.319525 --> -0.330474).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6845176
	speed: 0.1636s/iter; left time: 664.1349s
Epoch: 4 cost time: 7.212087869644165
Epoch: 4, Steps: 154 | Train Loss: 1.908 Vali Loss: 2.092 Vali Acc: 0.337 Test Loss: 2.092 Test Acc: 0.337
Validation loss decreased (-0.330474 --> -0.337368).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7497749
	speed: 0.1673s/iter; left time: 653.2656s
Epoch: 5 cost time: 7.644705295562744
Epoch: 5, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.032 Vali Acc: 0.352 Test Loss: 2.032 Test Acc: 0.352
Validation loss decreased (-0.337368 --> -0.351561).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0160978
	speed: 0.1710s/iter; left time: 641.4748s
Epoch: 6 cost time: 7.793461561203003
Epoch: 6, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.138 Vali Acc: 0.346 Test Loss: 2.138 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6894779
	speed: 0.1639s/iter; left time: 589.5792s
Epoch: 7 cost time: 7.13440728187561
Epoch: 7, Steps: 154 | Train Loss: 1.733 Vali Loss: 2.215 Vali Acc: 0.187 Test Loss: 2.215 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.3734077
	speed: 0.1565s/iter; left time: 538.9265s
Epoch: 8 cost time: 6.9278833866119385
Epoch: 8, Steps: 154 | Train Loss: 1.684 Vali Loss: 2.188 Vali Acc: 0.340 Test Loss: 2.188 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4561995
	speed: 0.1718s/iter; left time: 564.9692s
Epoch: 9 cost time: 7.546477317810059
Epoch: 9, Steps: 154 | Train Loss: 1.646 Vali Loss: 2.594 Vali Acc: 0.108 Test Loss: 2.594 Test Acc: 0.108
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5744553
	speed: 0.1739s/iter; left time: 545.0562s
Epoch: 10 cost time: 7.412792682647705
Epoch: 10, Steps: 154 | Train Loss: 1.616 Vali Loss: 2.203 Vali Acc: 0.361 Test Loss: 2.203 Test Acc: 0.361
Validation loss decreased (-0.351561 --> -0.360886).  Saving model ...
	iters: 100, epoch: 11 | loss: 2.2555134
	speed: 0.1586s/iter; left time: 472.7814s
Epoch: 11 cost time: 6.940196514129639
Epoch: 11, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.200 Vali Acc: 0.202 Test Loss: 2.200 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.6774931
	speed: 0.1520s/iter; left time: 429.5776s
Epoch: 12 cost time: 6.525189399719238
Epoch: 12, Steps: 154 | Train Loss: 1.552 Vali Loss: 2.281 Vali Acc: 0.199 Test Loss: 2.281 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1977038
	speed: 0.1505s/iter; left time: 402.2709s
Epoch: 13 cost time: 6.566540241241455
Epoch: 13, Steps: 154 | Train Loss: 1.545 Vali Loss: 2.237 Vali Acc: 0.380 Test Loss: 2.237 Test Acc: 0.380
Validation loss decreased (-0.360886 --> -0.379540).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3514582
	speed: 0.1458s/iter; left time: 367.3848s
Epoch: 14 cost time: 6.151313304901123
Epoch: 14, Steps: 154 | Train Loss: 1.503 Vali Loss: 2.177 Vali Acc: 0.379 Test Loss: 2.177 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 2.7003765
	speed: 0.1449s/iter; left time: 342.7073s
Epoch: 15 cost time: 6.822923898696899
Epoch: 15, Steps: 154 | Train Loss: 1.498 Vali Loss: 2.399 Vali Acc: 0.209 Test Loss: 2.399 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.3869967
	speed: 0.1515s/iter; left time: 335.0490s
Epoch: 16 cost time: 6.674531936645508
Epoch: 16, Steps: 154 | Train Loss: 1.491 Vali Loss: 2.204 Vali Acc: 0.369 Test Loss: 2.204 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3937089
	speed: 0.1469s/iter; left time: 302.1093s
Epoch: 17 cost time: 5.8813862800598145
Epoch: 17, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.735 Vali Acc: 0.077 Test Loss: 3.735 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.4162639
	speed: 0.1401s/iter; left time: 266.5874s
Epoch: 18 cost time: 6.226811408996582
Epoch: 18, Steps: 154 | Train Loss: 1.445 Vali Loss: 2.266 Vali Acc: 0.379 Test Loss: 2.266 Test Acc: 0.379
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.7161516
	speed: 0.1514s/iter; left time: 264.7574s
Epoch: 19 cost time: 6.627055644989014
Epoch: 19, Steps: 154 | Train Loss: 1.430 Vali Loss: 2.199 Vali Acc: 0.378 Test Loss: 2.199 Test Acc: 0.378
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 1.5966971
	speed: 0.1527s/iter; left time: 243.6295s
Epoch: 20 cost time: 6.553999900817871
Epoch: 20, Steps: 154 | Train Loss: 1.425 Vali Loss: 3.211 Vali Acc: 0.101 Test Loss: 3.211 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.8123886
	speed: 0.1416s/iter; left time: 204.1128s
Epoch: 21 cost time: 6.056198835372925
Epoch: 21, Steps: 154 | Train Loss: 1.392 Vali Loss: 2.997 Vali Acc: 0.183 Test Loss: 2.997 Test Acc: 0.183
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.4536332
	speed: 0.1482s/iter; left time: 190.7812s
Epoch: 22 cost time: 6.667627811431885
Epoch: 22, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.177 Vali Acc: 0.161 Test Loss: 3.177 Test Acc: 0.161
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.3021636
	speed: 0.1522s/iter; left time: 172.4662s
Epoch: 23 cost time: 6.793004751205444
Epoch: 23, Steps: 154 | Train Loss: 1.380 Vali Loss: 4.479 Vali Acc: 0.087 Test Loss: 4.479 Test Acc: 0.087
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_TimesNet_UEA_ftM_sl36_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3795620437956204
model parameter : 47438
model size : 0.35MB
